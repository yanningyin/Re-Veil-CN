(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors"],{"00f6":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},"00fd":function(t,e,n){var r=n("9e69"),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,s=r?r.toStringTag:void 0;function u(t){var e=i.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(u){}var a=o.call(t);return r&&(e?t[s]=n:delete t[s]),a}t.exports=u},"0155":function(t,e){},"0233":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=Object(o["a"])(t,"a","sub"),s=Object(o["a"])(e,"b","sub");[n,s]=Object(i["makeTypesMatch"])(n,s);const u={a:n,b:s};return r["a"].runKernel(a["ed"],u)}const c=Object(s["b"])({sub_:u})},"0234":function(t,e,n){"use strict";function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t){return o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}Object.defineProperty(e,"__esModule",{value:!0}),e._setTarget=void 0,e.popParams=d,e.pushParams=l,e.target=void 0,e.withParams=m;var s=[],u=null;e.target=u;var c=function(t){e.target=u=t};function l(){null!==u&&s.push(u),e.target=u={}}function d(){var t=u,n=e.target=u=s.pop()||null;return n&&(Array.isArray(n.$sub)||(n.$sub=[]),n.$sub.push(t)),t}function h(t){if("object"!==o(t)||Array.isArray(t))throw new Error("params must be an object");e.target=u=a(a({},u),t)}function p(t,e){return f((function(n){return function(){n(t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return e.apply(this,a)}}))}function f(t){var e=t(h);return function(){l();try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(this,n)}finally{d()}}}function m(t,e){return"object"===o(t)&&void 0!==e?p(t,e):f(t)}e._setTarget=c},"03dd":function(t,e,n){var r=n("eac5"),a=n("57a5"),i=Object.prototype,o=i.hasOwnProperty;function s(t){if(!r(t))return a(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}t.exports=s},"0435":function(t,e){},"04d3":function(t,e){},"050a":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","cosh","float32"),n={x:e};return r["a"].runKernel(a["K"],n)}const u=Object(o["b"])({cosh_:s})},"0621":function(t,e,n){var r=n("9e69"),a=n("d370"),i=n("6747"),o=r?r.isConcatSpreadable:void 0;function s(t){return i(t)||a(t)||!!(o&&t&&t[o])}t.exports=s},"06f5":function(t,e,n){"use strict";n.r(e);n("393f"),n("e65a");const r={moveTickSize:50,videoContainerId:"webgazerVideoContainer",videoElementId:"webgazerVideoFeed",videoElementCanvasId:"webgazerVideoCanvas",faceOverlayId:"webgazerFaceOverlay",faceFeedbackBoxId:"webgazerFaceFeedbackBox",gazeDotId:"webgazerGazeDot",videoViewerWidth:320,videoViewerHeight:240,faceFeedbackBoxRatio:.66,showVideo:!0,mirrorVideo:!0,showFaceOverlay:!0,showFaceFeedbackBox:!0,showGazeDot:!0,camConstraints:{video:{width:{min:320,ideal:640,max:1920},height:{min:240,ideal:480,max:1080},facingMode:"user"}},dataTimestep:50,showVideoPreview:!0,applyKalmanFilter:!0,saveDataAcrossSessions:!0,storingPoints:!1};var a=r,i=(n("35bd"),n("a002")),o=n.n(i),s=n("1517");const u=function(){this.model=s["load"]({maxFaces:1}),this.predictionReady=!1};u.prototype.positionsArray=null,u.prototype.getEyePatches=async function(t,e,n){if(0===t.width)return null;const r=await this.model,a=await r.estimateFaces(t);if(0==a.length)return!1;this.positionsArray=a[0].scaledMesh;const i=this.positionsArray;var o=Math.round(Math.min(i[247][0],i[130][0],i[25][0])),s=Math.round(Math.min(i[247][1],i[27][1],i[190][1])),u=Math.round(Math.max(i[190][0],i[243][0],i[233][0])-o),c=Math.round(Math.max(i[25][1],i[23][1],i[112][1])-s),l=Math.round(Math.min(i[414][0],i[463][0],i[453][0])),d=Math.round(Math.min(i[414][1],i[257][1],i[467][1])),h=Math.round(Math.max(i[467][0],i[359][0],i[255][0])-l),p=Math.round(Math.max(i[341][1],i[253][1],i[255][1])-d);if(0===u||0===h)return console.log("an eye patch had zero width"),null;if(0===c||0===p)return console.log("an eye patch had zero height"),null;var f={},m=t.getContext("2d").getImageData(o,s,u,c);f.left={patch:m,imagex:o,imagey:s,width:u,height:c};var g=t.getContext("2d").getImageData(l,d,h,p);return f.right={patch:g,imagex:l,imagey:d,width:h,height:p},this.predictionReady=!0,f},u.prototype.getPositions=function(){return this.positionsArray},u.prototype.reset=function(){console.log("Unimplemented; Tracking.js has no obvious reset function")},u.prototype.drawFaceOverlay=function(t,e){if(e){t.fillStyle="#32EEDB",t.strokeStyle="#32EEDB",t.lineWidth=.5;for(let n=0;n<e.length;n++){const r=e[n][0],a=e[n][1];t.beginPath(),t.arc(r,a,1,0,2*Math.PI),t.closePath(),t.fill()}}},u.prototype.name="TFFaceMesh";var c=u;const l={transpose:function(t){for(var e=t.length,n=t[0].length,r=new Array(n),a=0;a<e;a++)for(var i=0;i<n;i++)0===a&&(r[i]=new Array(e)),r[i][a]=t[a][i];return r},getMatrix:function(t,e,n,r){for(var a=new Array(e.length),i=r-n+1,o=0;o<e.length;o++){a[o]=new Array(i);for(var s=n;s<=r;s++)a[o][s-n]=t[e[o]][s]}return a},getSubMatrix:function(t,e,n,r,a){for(var i=a-r+1,o=new Array(n-e+1),s=e;s<=n;s++){var u=s-e;o[u]=new Array(i);for(var c=r;c<=a;c++)o[u][c-r]=t[s][c]}return o},mult:function(t,e){e.length!=t[0].length&&console.log("Matrix inner dimensions must agree:");for(var n=new Array(t.length),r=new Array(t[0].length),a=0;a<e[0].length;a++){for(var i=0;i<t[0].length;i++)r[i]=e[i][a];for(var o=0;o<t.length;o++){0===a&&(n[o]=new Array(e[0].length));var s=t[o],u=0;for(i=0;i<t[0].length;i++)u+=s[i]*r[i];n[o][a]=u}}return n},LUDecomposition:function(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++){n[r]=new Array(t[0].length);for(var a=0;a<t[0].length;a++)n[r][a]=t[r][a]}var i=t.length,o=t[0].length,s=new Array(i);for(r=0;r<i;r++)s[r]=r;var u=1,c=new Array,l=new Array(i);for(a=0;a<o;a++){for(r=0;r<i;r++)l[r]=n[r][a];for(r=0;r<i;r++){c=n[r];for(var d=Math.min(r,a),h=0,p=0;p<d;p++)h+=c[p]*l[p];c[a]=l[r]-=h}var f=a;for(r=a+1;r<i;r++)Math.abs(l[r])>Math.abs(l[f])&&(f=r);if(f!=a){for(p=0;p<o;p++){var m=n[f][p];n[f][p]=n[a][p],n[a][p]=m}p=s[f];s[f]=s[a],s[a]=p,u=-u}if(a<i&0!=n[a][a])for(r=a+1;r<i;r++)n[r][a]/=n[a][a]}e.length!=i&&console.log("Matrix row dimensions must agree.");for(a=0;a<o;a++)0===n[a][a]&&console.log("Matrix is singular.");var g=e[0].length,b=self.webgazer.mat.getMatrix(e,s,0,g-1);for(p=0;p<o;p++)for(r=p+1;r<o;r++)for(a=0;a<g;a++)b[r][a]-=b[p][a]*n[r][p];for(p=o-1;p>=0;p--){for(a=0;a<g;a++)b[p][a]/=n[p][p];for(r=0;r<p;r++)for(a=0;a<g;a++)b[r][a]-=b[p][a]*n[r][p]}return b},QRDecomposition:function(t,e){for(var n=new Array(t.length),r=0;r<t.length;r++){n[r]=new Array(t[0].length);for(var a=0;a<t[0].length;a++)n[r][a]=t[r][a]}for(var i,o=t.length,s=t[0].length,u=new Array(s),c=0;c<s;c++){i=0;for(r=c;r<o;r++)i=Math.hypot(i,n[r][c]);if(0!=i){n[c][c]<0&&(i=-i);for(r=c;r<o;r++)n[r][c]/=i;n[c][c]+=1;for(a=c+1;a<s;a++){var d=0;for(r=c;r<o;r++)d+=n[r][c]*n[r][a];d=-d/n[c][c];for(r=c;r<o;r++)n[r][a]+=d*n[r][c]}}u[c]=-i}e.length!=o&&console.log("Matrix row dimensions must agree.");for(a=0;a<s;a++)0===u[a]&&console.log("Matrix is rank deficient");var h=e[0].length,p=new Array(e.length);for(r=0;r<e.length;r++)p[r]=new Array(e[0].length);for(r=0;r<e.length;r++)for(a=0;a<e[0].length;a++)p[r][a]=e[r][a];for(c=0;c<s;c++)for(a=0;a<h;a++){for(d=0,r=c;r<o;r++)d+=n[r][c]*p[r][a];d=-d/n[c][c];for(r=c;r<o;r++)p[r][a]+=d*n[r][c]}for(c=s-1;c>=0;c--){for(a=0;a<h;a++)p[c][a]/=u[c];for(r=0;r<c;r++)for(a=0;a<h;a++)p[r][a]-=p[c][a]*n[r][c]}return l.getSubMatrix(p,0,s-1,0,h-1)}};var d=l,h=n("cb27"),p=n.n(h);const f={};var m=10,g=6;function b(t,e){var n="";for(var r in e)n+=r+": "+e[r]+"\n";t.innerText=n}f.Eye=function(t,e,n,r,a){this.patch=t,this.imagex=e,this.imagey=n,this.width=r,this.height=a},f.getEyeFeats=function(t){var e=this.resizeEye(t.left,m,g),n=this.resizeEye(t.right,m,g),r=this.grayscale(e.data,e.width,e.height),a=this.grayscale(n.data,n.width,n.height),i=[];this.equalizeHistogram(r,5,i);var o=[];this.equalizeHistogram(a,5,o);Array.prototype.slice.call(i),Array.prototype.slice.call(o);return i.concat(o)},f.DataWindow=function(t,e){this.data=[],this.windowSize=t,this.index=0,this.length=0,e&&(this.data=e.slice(e.length-t,e.length),this.length=this.data.length)},f.DataWindow.prototype.push=function(t){return this.data.length<this.windowSize?(this.data.push(t),this.length=this.data.length,this):(this.data[this.index]=t,this.index=(this.index+1)%this.windowSize,this)},f.DataWindow.prototype.get=function(t){return this.data[this.getTrueIndex(t)]},f.DataWindow.prototype.getTrueIndex=function(t){return this.data.length<this.windowSize?t:(t+this.index)%this.windowSize},f.DataWindow.prototype.addAll=function(t){for(var e=0;e<t.length;e++)this.push(t[e])},f.grayscale=function(t,e,n){for(var r=new Uint8ClampedArray(t.length>>2),a=0,i=0,o=0;o<n;o++)for(var s=0;s<e;s++){var u=.299*t[i]+.587*t[i+1]+.114*t[i+2];r[a++]=u,i+=4}return r},f.equalizeHistogram=function(t,e,n){var r=t.length;n||(n=t),e||(e=5);for(var a=Array(256).fill(0),i=0;i<r;i+=e)++a[t[i]];var o=255*e/r,s=0;for(i=0;i<256;++i){var u=a[i];s=u+=s,a[i]=u*o}for(i=0;i<r;++i)n[i]=a[t[i]];return n},f.threshold=function(t,e){for(let n=0;n<t.length;n++)t[n]=t[n]>e?255:0;return t},f.correlation=function(t,e){const n=Math.min(t.length,e.length);let r=0;for(let a=0;a<n;a++)t[a]===e[a]&&r++;return r/Math.max(t.length,e.length)},f.resizeEye=function(t,e,n){var r=document.createElement("canvas");r.width=t.width,r.height=t.height,r.getContext("2d").putImageData(t.patch,0,0);var a=document.createElement("canvas");return a.width=e,a.height=n,a.getContext("2d").drawImage(r,0,0,r.width,r.height,0,0,e,n),a.getContext("2d").getImageData(0,0,e,n)},f.bound=function(t){t.x<0&&(t.x=0),t.y<0&&(t.y=0);var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n=Math.max(document.documentElement.clientHeight,window.innerHeight||0);return t.x>e&&(t.x=e),t.y>n&&(t.y=n),t},f.DebugBox=function(t){this.para=document.createElement("p"),this.div=document.createElement("div"),this.div.appendChild(this.para),document.body.appendChild(this.div),this.buttons={},this.canvas={},this.stats={};var e=t||300;(function(t){setInterval((function(){b(t.para,t.stats)}),e)})(this)},f.DebugBox.prototype.set=function(t,e){this.stats[t]=e},f.DebugBox.prototype.inc=function(t,e,n){this.stats[t]||(this.stats[t]=n||0),this.stats[t]+=e||1},f.DebugBox.prototype.addButton=function(t,e){this.buttons[t]||(this.buttons[t]=document.createElement("button"),this.div.appendChild(this.buttons[t]));var n=this.buttons[t];this.buttons[t]=n,n.addEventListener("click",e),n.innerText=t},f.DebugBox.prototype.show=function(t,e){this.canvas[t]||(this.canvas[t]=document.createElement("canvas"),this.div.appendChild(this.canvas[t]));var n=this.canvas[t];n.getContext("2d").clearRect(0,0,n.width,n.height),e(n)};var y=f;const v={InitRegression:function(){var t=700,e=10;this.ridgeParameter=Math.pow(10,-5),this.errorXArray=new y.DataWindow(t),this.errorYArray=new y.DataWindow(t),this.screenXClicksArray=new y.DataWindow(t),this.screenYClicksArray=new y.DataWindow(t),this.eyeFeaturesClicks=new y.DataWindow(t),this.trailTime=1e3,this.trailDataWindow=this.trailTime/a.moveTickSize,this.screenXTrailArray=new y.DataWindow(e),this.screenYTrailArray=new y.DataWindow(e),this.eyeFeaturesTrail=new y.DataWindow(e),this.trailTimes=new y.DataWindow(e),this.dataClicks=new y.DataWindow(t),this.dataTrail=new y.DataWindow(e);var n=[[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],r=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]],i=.1;r=p.a.mul(r,i);var o=[[1,0,0,0,0,0],[0,1,0,0,0,0],[0,0,1,0,0,0],[0,0,0,1,0,0]],s=(o=[[1,0,0,0],[0,1,0,0]],47),u=p.a.mul(p.a.identity(2),s),c=p.a.mul(p.a.identity(4),1e-4),l=[[500],[500],[0],[0]];this.kalman=new v.KalmanFilter(n,o,r,u,c,l)},KalmanFilter:function(t,e,n,r,a,i){this.F=t,this.Q=n,this.H=e,this.R=r,this.P=a,this.X=i}};v.KalmanFilter.prototype.update=function(t){for(var e=p.a.add,n=p.a.sub,r=p.a.inv,a=p.a.identity,i=d.mult,o=d.transpose,s=i(this.F,this.X),u=e(i(i(this.F,this.P),o(this.F)),this.Q),c=n(t,i(this.H,s)),l=e(i(i(this.H,u),o(this.H)),this.R),h=i(u,i(o(this.H),r(l))),f=0;f<c.length;f++)c[f]=[c[f]];return this.X=e(s,i(h,c)),this.P=i(n(a(h.length),i(h,this.H)),u),o(i(this.H,this.X))[0]},v.ridge=function(t,e,n){var r=e[0].length,a=new Array(r),i=d.transpose(e),o=new Array,s=!0;do{for(var u=d.mult(i,e),c=0;c<r;c++)u[c][c]=u[c][c]+n;var l=d.mult(i,t);for(c=0;c<r;c++)a[c]=l[c][0];try{var h=0!==a.length?a.length/a.length:0;a.length*h!==a.length&&console.log("Array length must be a multiple of m"),o=u.length===u[0].length?p.a.LUsolve(p.a.LU(u,!0),l):webgazer.mat.QRDecomposition(u,l);for(c=0;c<r;c++)a[c]=o[c];s=!0}catch(f){n*=10,console.log(f),s=!1}}while(!s);return a},v.setData=function(t){for(var e=0;e<t.length;e++){var n=new Uint8ClampedArray(t[e].eyes.left.patch.data),r=new Uint8ClampedArray(t[e].eyes.right.patch.data);t[e].eyes.left.patch=new ImageData(n,t[e].eyes.left.width,t[e].eyes.left.height),t[e].eyes.right.patch=new ImageData(r,t[e].eyes.right.width,t[e].eyes.right.height),this.addData(t[e].eyes,t[e].screenPos,t[e].type)}},v.getCurrentFixationIndex=function(){for(var t=this.screenXTrailArray.get(0),e=this.screenYTrailArray.get(0),n=this.screenXTrailArray.length-1;n>=0;n--){var r=this.screenXTrailArray.get(n),a=this.screenYTrailArray.get(n),i=Math.sqrt(Math.pow(r-t,2)+Math.pow(a-e,2));if(i>72)return n+1}return n},v.addData=function(t,e,n){t&&("click"===n?(this.screenXClicksArray.push([e[0]]),this.screenYClicksArray.push([e[1]]),this.eyeFeaturesClicks.push(y.getEyeFeats(t)),this.dataClicks.push({eyes:t,screenPos:e,type:n})):"move"===n&&(this.screenXTrailArray.push([e[0]]),this.screenYTrailArray.push([e[1]]),this.eyeFeaturesTrail.push(y.getEyeFeats(t)),this.trailTimes.push(performance.now()),this.dataTrail.push({eyes:t,screenPos:e,type:n})))};var x=v;const w={RidgeReg:function(){this.init()}};w.RidgeReg.prototype.init=x.InitRegression,w.RidgeReg.prototype.addData=x.addData,w.RidgeReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],i=[],o=0;o<this.trailDataWindow;o++)this.trailTimes.get(o)>e&&(n.push(this.screenXTrailArray.get(o)),r.push(this.screenYTrailArray.get(o)),i.push(this.eyeFeaturesTrail.get(o)));var s=this.screenXClicksArray.data.concat(n),u=this.screenYClicksArray.data.concat(r),c=this.eyeFeaturesClicks.data.concat(i),l=x.ridge(s,c,this.ridgeParameter),d=x.ridge(u,c,this.ridgeParameter),h=y.getEyeFeats(t),p=0;for(o=0;o<h.length;o++)p+=h[o]*l[o];var f=0;for(o=0;o<h.length;o++)f+=h[o]*d[o];if(p=Math.floor(p),f=Math.floor(f),a.applyKalmanFilter){var m=[p,f];return m=this.kalman.update(m),{x:m[0],y:m[1]}}return{x:p,y:f}},w.RidgeReg.prototype.setData=x.setData,w.RidgeReg.prototype.getData=function(){return this.dataClicks.data},w.RidgeReg.prototype.name="ridge";var k=w;const S={RidgeWeightedReg:function(){this.init()}};S.RidgeWeightedReg.prototype.init=x.InitRegression,S.RidgeWeightedReg.prototype.addData=x.addData,S.RidgeWeightedReg.prototype.predict=function(t){if(!t||0===this.eyeFeaturesClicks.length)return null;for(var e=performance.now()-this.trailTime,n=[],r=[],i=[],o=0;o<this.trailDataWindow;o++)this.trailTimes.get(o)>e&&(n.push(this.screenXTrailArray.get(o)),r.push(this.screenYTrailArray.get(o)),i.push(this.eyeFeaturesTrail.get(o)));var s=this.eyeFeaturesClicks.data.length,u=Array(s),c=Array(s),l=Array(s);for(o=0;o<s;o++){for(var d=Math.sqrt(1/(s-o)),h=this.eyeFeaturesClicks.getTrueIndex(o),p=0;p<this.eyeFeaturesClicks.data[h].length;p++){var f=this.eyeFeaturesClicks.data[h][p]*d;void 0!==u[h]?u[h].push(f):u[h]=[f]}c[h]=this.screenXClicksArray.get(o).slice(0,this.screenXClicksArray.get(o).length),l[h]=this.screenYClicksArray.get(o).slice(0,this.screenYClicksArray.get(o).length),c[o][0]=c[o][0]*d,l[o][0]=l[o][0]*d}var m=c.concat(n),g=l.concat(r),b=u.concat(i),v=x.ridge(m,b,this.ridgeParameter),w=x.ridge(g,b,this.ridgeParameter),k=y.getEyeFeats(t),S=0;for(o=0;o<k.length;o++)S+=k[o]*v[o];var O=0;for(o=0;o<k.length;o++)O+=k[o]*w[o];if(S=Math.floor(S),O=Math.floor(O),a.applyKalmanFilter){var _=[S,O];return _=this.kalman.update(_),{x:_[0],y:_[1]}}return{x:S,y:O}},S.RidgeWeightedReg.prototype.setData=x.setData,S.RidgeWeightedReg.prototype.getData=function(){return this.dataClicks.data},S.RidgeWeightedReg.prototype.name="ridgeWeighted";var O=S;const _={};Math.pow(10,-5);var C=700,T={X:[0],Y:[0]},I=10;_.RidgeRegThreaded=function(){this.init()},_.RidgeRegThreaded.prototype.init=function(){this.screenXClicksArray=new y.DataWindow(C),this.screenYClicksArray=new y.DataWindow(C),this.eyeFeaturesClicks=new y.DataWindow(C),this.screenXTrailArray=new y.DataWindow(I),this.screenYTrailArray=new y.DataWindow(I),this.eyeFeaturesTrail=new y.DataWindow(I),this.dataClicks=new y.DataWindow(C),this.dataTrail=new y.DataWindow(C),this.worker||(this.worker=new Worker("ridgeWorker.mjs"),this.worker.onerror=function(t){console.log(t.message)},this.worker.onmessage=function(t){T.X=t.data.X,T.Y=t.data.Y},console.log("initialized worker"));var t=[[1,0,1,0],[0,1,0,1],[0,0,1,0],[0,0,0,1]],e=[[1/4,0,.5,0],[0,1/4,0,.5],[.5,0,1,0],[0,.5,0,1]],n=.1;e=p.a.mul(e,n);var r=[[1,0,0,0,0,0],[0,1,0,0,0,0],[0,0,1,0,0,0],[0,0,0,1,0,0]],a=(r=[[1,0,0,0],[0,1,0,0]],47),i=p.a.mul(p.a.identity(2),a),o=p.a.mul(p.a.identity(4),1e-4),s=[[500],[500],[0],[0]];this.kalman=new x.KalmanFilter(t,r,e,i,o,s)},_.RidgeRegThreaded.prototype.addData=function(t,e,n){t&&this.worker.postMessage({eyes:y.getEyeFeats(t),screenPos:e,type:n})},_.RidgeRegThreaded.prototype.predict=function(t){if(!t)return null;for(var e=T.X,n=T.Y,r=y.getEyeFeats(t),i=0,o=0,s=0;s<r.length;s++)i+=r[s]*e[s],o+=r[s]*n[s];if(i=Math.floor(i),o=Math.floor(o),a.applyKalmanFilter){var u=[i,o];return u=this.kalman.update(u),{x:u[0],y:u[1]}}return{x:i,y:o}},_.RidgeRegThreaded.prototype.setData=x.setData,_.RidgeRegThreaded.prototype.getData=function(){return this.dataClicks.data},_.RidgeRegThreaded.prototype.name="ridge";var N=_;const E={tracker:{}};E.tracker.TFFaceMesh=c,E.reg=k,E.reg.RidgeWeightedReg=O.RidgeWeightedReg,E.reg.RidgeRegThreaded=N.RidgeRegThreaded,E.util=y,E.params=a;var A=null,R=null,j=null,D=null,F=null,M=null,P=null,$="",L=new Array(50),B=new Array(50),z=performance.now(),W=null,V=null,U=!1,G=function(t,e){},H=G,q=["click","move"],K=performance.now(),X=new E.tracker.TFFaceMesh,Y=[new E.reg.RidgeReg],J={TFFacemesh:function(){return new E.tracker.TFFaceMesh}},Z={ridge:function(){return new E.reg.RidgeReg},weightedRidge:function(){return new E.reg.RidgeWeightedReg},threadedRidge:function(){return new E.reg.RidgeRegThreaded}},Q="webgazerGlobalData",tt="webgazerGlobalSettings",et={},nt=[],rt={data:[],settings:{}};function at(){if(null!=M&&W){var t=j.videoWidth,e=j.videoHeight,n=Math.min(t,e),r=n*E.params.faceFeedbackBoxRatio,a=(e-r)/2,i=(t-r)/2,o=i+r,s=a+r,u=W.left.imagex,c=W.left.imagey,l=W.right.imagex,d=W.right.imagey,h=!1,p=!1;u>i&&u<o&&l>i&&l<o&&(h=!0),c>a&&c<s&&d>a&&d<s&&(p=!0),M.style.border=h&&p?"solid green":"solid red"}else M.style.border="solid black"}function it(t,e,n){var r=document.getElementById("plotting_canvas").getContext("2d");r.fillStyle=t,r.beginPath(),r.arc(e,n,5,0,2*Math.PI,!0),r.fill()}function ot(t,e,n){if(t)try{return X.getEyePatches(t,e,n)}catch(r){return console.log("can't get pupil features ",r),null}}function st(t,e,n){t.width!=e&&(t.width=e),t.height!=n&&(t.height=n);var r=t.getContext("2d");r.drawImage(j,0,0,t.width,t.height)}async function ut(t){var e=[];if(W=await ot(D,D.width,D.height),0===Y.length)return console.log("regression not set, call setRegression()"),null;for(var n in Y)e.push(Y[n].predict(W));return void 0!==t?null===e[t]?null:{x:e[t].x,y:e[t].y,eyeFeatures:W}:0===e.length||null===e[0]?null:{x:e[0].x,y:e[0].y,eyeFeatures:W,all:e}}E.computeValidationBoxSize=function(){var t=j.videoWidth,e=j.videoHeight,n=parseInt(j.style.width),r=parseInt(j.style.height),a=Math.min(t,e),i=Math.max(t,e),o=t==i?n/t:r/e,s=a*E.params.faceFeedbackBoxRatio*o,u=(r-s)/2,c=(n-s)/2;return[u,c,s,s]};var ct=new y.DataWindow(4),lt=0;async function dt(){if(!U){st(D,D.width,D.height),V=ut();var t=performance.now()-z;if(E.params.showFaceOverlay){var e=E.getTracker();F.getContext("2d").clearRect(0,0,j.videoWidth,j.videoHeight),e.drawFaceOverlay(F.getContext("2d"),e.getPositions())}if(E.params.showFaceFeedbackBox&&at(),V=await V,H(V,t),V){ct.push(V);var n=0,r=0,a=ct.length;for(var i in ct.data)n+=ct.get(i).x,r+=ct.get(i).y;var o=y.bound({x:n/a,y:r/a});E.params.storingPoints&&(it("blue",o.x,o.y),E.storePoints(o.x,o.y,lt),lt++,50==lt&&(lt=0)),E.params.showGazeDot&&(P.style.display="block"),P.style.transform="translate3d("+o.x+"px,"+o.y+"px,0)"}else P.style.display="none";requestAnimationFrame(dt)}}var ht=function(t,e,n){if(!U){if(0===Y.length)return console.log("regression not set, call setRegression()"),null;for(var r in Y)W&&Y[r].addData(W,[t,e],n)}},pt=async function(t){ht(t.clientX,t.clientY,q[0]),E.params.saveDataAcrossSessions&&await yt()},ft=function(t){if(!U){var e=performance.now();e<K+E.params.moveTickSize||(K=e,ht(t.clientX,t.clientY,q[1]))}},mt=function(){document.addEventListener("click",pt,!0),document.addEventListener("mousemove",ft,!0)},gt=function(){document.removeEventListener("click",pt,!0),document.removeEventListener("mousemove",ft,!0)};async function bt(){et=await o.a.getItem(tt),et=et||rt;var t=await o.a.getItem(Q);for(var e in t=t||rt,nt=t,Y)Y[e].setData(t);console.log("loaded stored data into regression model")}async function yt(){var t=Y[0].getData()||nt;o.a.setItem(tt,et),o.a.setItem(Q,t)}function vt(){for(var t in o.a.clear(),Y)Y[t].init()}async function xt(t){var e="0px",n="0px";function r(t){St(j.videoWidth,j.videoHeight),E.setVideoViewerSize(E.params.videoViewerWidth,E.params.videoViewerHeight),R.appendChild(D),R.appendChild(F),R.appendChild(M),document.body.appendChild(P),t.target.removeEventListener(t.type,r)}A=t,R=document.createElement("div"),R.id=E.params.videoContainerId,R.style.position="fixed",R.style.top=e,R.style.left=n,R.style.width=E.params.videoViewerWidth+"px",R.style.height=E.params.videoViewerHeight+"px",kt(R),j=document.createElement("video"),j.setAttribute("playsinline",""),j.id=E.params.videoElementId,j.srcObject=t,j.autoplay=!0,j.style.position="absolute",j.style.width=E.params.videoViewerWidth+"px",j.style.height=E.params.videoViewerHeight+"px",kt(j),D=document.createElement("canvas"),D.id=E.params.videoElementCanvasId,D.style.display="none",F=document.createElement("canvas"),F.id=E.params.faceOverlayId,F.style.display=E.params.showFaceOverlay?"block":"none",F.style.position="absolute",E.params.mirrorVideo&&(j.style.setProperty("-moz-transform","scale(-1, 1)"),j.style.setProperty("-webkit-transform","scale(-1, 1)"),j.style.setProperty("-o-transform","scale(-1, 1)"),j.style.setProperty("transform","scale(-1, 1)"),j.style.setProperty("filter","FlipH"),F.style.setProperty("-moz-transform","scale(-1, 1)"),F.style.setProperty("-webkit-transform","scale(-1, 1)"),F.style.setProperty("-o-transform","scale(-1, 1)"),F.style.setProperty("transform","scale(-1, 1)"),F.style.setProperty("filter","FlipH")),M=document.createElement("canvas"),M.id=E.params.faceFeedbackBoxId,M.style.display=E.params.showFaceFeedbackBox?"block":"none",M.style.border="solid",M.style.position="absolute",P=document.createElement("div"),P.id=E.params.gazeDotId,P.style.display=E.params.showGazeDot?"block":"none",P.style.position="fixed",P.style.zIndex=99999,P.style.left="-5px",P.style.top="-5px",P.style.background="red",P.style.borderRadius="100%",P.style.opacity="0.7",P.style.width="10px",P.style.height="10px",R.appendChild(j),document.body.appendChild(R),j.addEventListener("timeupdate",r),mt(),U=!1,z=performance.now(),await dt()}function wt(){void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(t){var e=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return e?new Promise((function(n,r){e.call(navigator,t,n,r)})):Promise.reject(new Error("Unfortunately, your browser does not support access to the webcam through the getUserMedia API. Try to use the latest version of Google Chrome, Mozilla Firefox, Opera, or Microsoft Edge instead."))})}function kt(t){navigator.vendor&&navigator.vendor.indexOf("Apple")>-1?(t.style.opacity=E.params.showVideo?"1":"0",t.style.display="block"):t.style.display=E.params.showVideo?"block":"none"}function St(t,e){D&&(D.width=t,D.height=e),F&&(F.width=t,F.height=e)}E.begin=function(t){return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&window.chrome&&alert("WebGazer works only over https. If you are doing local development, you need to run a local server."),E.params.saveDataAcrossSessions&&bt(),t=t||function(){console.log("No stream")},$?(xt($),E):(wt(),new Promise(async(e,n)=>{let r;try{r=await navigator.mediaDevices.getUserMedia(E.params.camConstraints),xt(r),e(E)}catch(a){t(),j=null,r=null,n(a)}}))},E.isReady=function(){return null!==D&&D.width>0},E.pause=function(){return U=!0,E},E.resume=async function(){return U?(U=!1,await dt(),E):E},E.end=function(){return U=!0,R.remove(),E},E.stopVideo=function(){return A.getTracks()[0].stop(),R.removeChild(F),R.removeChild(M),E},E.detectCompatibility=function(){var t=navigator.mediaDevices.getUserMedia||navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return void 0!==t},E.showVideoPreview=function(t){return E.params.showVideoPreview=t,E.showVideo(t&&E.params.showVideo),E.showFaceOverlay(t&&E.params.showFaceOverlay),E.showFaceFeedbackBox(t&&E.params.showFaceFeedbackBox),E},E.showVideo=function(t){return E.params.showVideo=t,j&&kt(j),R&&kt(R),E},E.showFaceOverlay=function(t){return E.params.showFaceOverlay=t,F&&(F.style.display=t?"block":"none"),E},E.showFaceFeedbackBox=function(t){return E.params.showFaceFeedbackBox=t,M&&(M.style.display=t?"block":"none"),E},E.showPredictionPoints=function(t){return E.params.showGazeDot=t,P&&(P.style.display=t?"block":"none"),E},E.saveDataAcrossSessions=function(t){return E.params.saveDataAcrossSessions=t,E},E.applyKalmanFilter=function(t){return E.params.applyKalmanFilter=t,E},E.setCameraConstraints=async function(t){var e,n;if(E.params.camConstraints=t,A){E.pause(),e=A.getVideoTracks()[0];try{await e.applyConstraints(E.params.camConstraints),n=e.getSettings(),St(n.width,n.height)}catch(r){return void console.log(r)}E.setVideoViewerSize(E.params.videoViewerWidth,E.params.videoViewerHeight),E.getTracker().reset(),await E.resume()}},E.setStaticVideo=function(t){return $=t,E},E.setVideoViewerSize=function(t,e){E.params.videoViewerWidth=t,E.params.videoViewerHeight=e,j.style.width=t+"px",j.style.height=e+"px",R.style.width=t+"px",R.style.height=e+"px",F.style.width=t+"px",F.style.height=e+"px";var n=E.computeValidationBoxSize();M.style.top=n[0]+"px",M.style.left=n[1]+"px",M.style.width=n[2]+"px",M.style.height=n[3]+"px"},E.addMouseEventListeners=function(){return mt(),E},E.removeMouseEventListeners=function(){return gt(),E},E.recordScreenPosition=function(t,e,n){return ht(t,e,n||q[0]),E},E.storePoints=function(t,e,n){L[n]=t,B[n]=e},E.setTracker=function(t){if(void 0===J[t]){for(var e in console.log("Invalid tracker selection"),console.log("Options are: "),J)console.log(e);return E}return X=J[t](),E},E.setRegression=function(t){if(void 0===Z[t]){for(var e in console.log("Invalid regression selection"),console.log("Options are: "),Z)console.log(e);return E}return nt=Y[0].getData(),Y=[Z[t]()],Y[0].setData(nt),E},E.addTrackerModule=function(t,e){J[t]=function(){return new e}},E.addRegressionModule=function(t,e){Z[t]=function(){return new e}},E.addRegression=function(t){var e=Z[t]();return nt=Y[0].getData(),e.setData(nt),Y.push(e),E},E.setGazeListener=function(t){return H=t,E},E.clearGazeListener=function(){return H=G,E},E.setVideoElementCanvas=function(t){return D=t,D},E.clearData=async function(){vt()},E.getTracker=function(){return X},E.getRegression=function(){return Y},E.getCurrentPrediction=function(t){return ut(t)},E.params.getEventTypes=function(){return q.slice()},E.getVideoElementCanvas=function(){return D},E.getVideoPreviewToCameraResolutionRatio=function(){return[E.params.videoViewerWidth/j.videoWidth,E.params.videoViewerHeight/j.videoHeight]},E.getStoredPoints=function(){return[L,B]};e["default"]=E},"06f8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;var r=n("9cb8"),a=n("ed3d"),i=n("4971"),o=n("d777"),s={node:1,duration:1,easing:1,onFinish:1,yoyo:1},u=1,c=2,l=3,d=0,h=["fill","stroke","shadowColor"],p=function(){function t(t,e,n,r,a,i,o){this.prop=t,this.propFunc=e,this.begin=r,this._pos=r,this.duration=i,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=a-this.begin,this.pause()}return t.prototype.fire=function(t){var e=this[t];e&&e()},t.prototype.setTime=function(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())},t.prototype.getTime=function(){return this._time},t.prototype.setPosition=function(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t},t.prototype.getPosition=function(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)},t.prototype.play=function(){this.state=c,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},t.prototype.reverse=function(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},t.prototype.seek=function(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")},t.prototype.reset=function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},t.prototype.finish=function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},t.prototype.update=function(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")},t.prototype.onEnterFrame=function(){var t=this.getTimer()-this._startTime;this.state===c?this.setTime(t):this.state===l&&this.setTime(this.duration-t)},t.prototype.pause=function(){this.state=u,this.fire("onPause")},t.prototype.getTimer=function(){return(new Date).getTime()},t}(),f=function(){function t(n){var i,u,c=this,l=n.node,h=l._id,f=n.easing||e.Easings.Linear,m=!!n.yoyo;i="undefined"===typeof n.duration?.3:0===n.duration?.001:n.duration,this.node=l,this._id=d++;var g=l.getLayer()||(l instanceof o.Konva["Stage"]?l.getLayers():null);for(u in g||r.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new a.Animation((function(){c.tween.onEnterFrame()}),g),this.tween=new p(u,(function(t){c._tweenFunc(t)}),f,0,1,1e3*i,m),this._addListeners(),t.attrs[h]||(t.attrs[h]={}),t.attrs[h][this._id]||(t.attrs[h][this._id]={}),t.tweens[h]||(t.tweens[h]={}),n)void 0===s[u]&&this._addAttr(u,n[u]);this.reset(),this.onFinish=n.onFinish,this.onReset=n.onReset,this.onUpdate=n.onUpdate}return t.prototype._addAttr=function(e,n){var a,i,o,s,u,c,l,d,p=this.node,f=p._id;if(o=t.tweens[f][e],o&&delete t.attrs[f][o][e],a=p.getAttr(e),r.Util._isArray(n))if(i=[],u=Math.max(n.length,a.length),"points"===e&&n.length!==a.length&&(n.length>a.length?(l=a,a=r.Util._prepareArrayForTween(a,n,p.closed())):(c=n,n=r.Util._prepareArrayForTween(n,a,p.closed()))),0===e.indexOf("fill"))for(s=0;s<u;s++)if(s%2===0)i.push(n[s]-a[s]);else{var m=r.Util.colorToRGBA(a[s]);d=r.Util.colorToRGBA(n[s]),a[s]=m,i.push({r:d.r-m.r,g:d.g-m.g,b:d.b-m.b,a:d.a-m.a})}else for(s=0;s<u;s++)i.push(n[s]-a[s]);else-1!==h.indexOf(e)?(a=r.Util.colorToRGBA(a),d=r.Util.colorToRGBA(n),i={r:d.r-a.r,g:d.g-a.g,b:d.b-a.b,a:d.a-a.a}):i=n-a;t.attrs[f][this._id][e]={start:a,diff:i,end:n,trueEnd:c,trueStart:l},t.tweens[f][e]=this._id},t.prototype._tweenFunc=function(e){var n,a,i,o,s,u,c,l,d=this.node,p=t.attrs[d._id][this._id];for(n in p){if(a=p[n],i=a.start,o=a.diff,l=a.end,r.Util._isArray(i))if(s=[],c=Math.max(i.length,l.length),0===n.indexOf("fill"))for(u=0;u<c;u++)u%2===0?s.push((i[u]||0)+o[u]*e):s.push("rgba("+Math.round(i[u].r+o[u].r*e)+","+Math.round(i[u].g+o[u].g*e)+","+Math.round(i[u].b+o[u].b*e)+","+(i[u].a+o[u].a*e)+")");else for(u=0;u<c;u++)s.push((i[u]||0)+o[u]*e);else s=-1!==h.indexOf(n)?"rgba("+Math.round(i.r+o.r*e)+","+Math.round(i.g+o.g*e)+","+Math.round(i.b+o.b*e)+","+(i.a+o.a*e)+")":i+o*e;d.setAttr(n,s)}},t.prototype._addListeners=function(){var e=this;this.tween.onPlay=function(){e.anim.start()},this.tween.onReverse=function(){e.anim.start()},this.tween.onPause=function(){e.anim.stop()},this.tween.onFinish=function(){var n=e.node,r=t.attrs[n._id][e._id];r.points&&r.points.trueEnd&&n.setAttr("points",r.points.trueEnd),e.onFinish&&e.onFinish.call(e)},this.tween.onReset=function(){var n=e.node,r=t.attrs[n._id][e._id];r.points&&r.points.trueStart&&n.points(r.points.trueStart),e.onReset&&e.onReset()},this.tween.onUpdate=function(){e.onUpdate&&e.onUpdate.call(e)}},t.prototype.play=function(){return this.tween.play(),this},t.prototype.reverse=function(){return this.tween.reverse(),this},t.prototype.reset=function(){return this.tween.reset(),this},t.prototype.seek=function(t){return this.tween.seek(1e3*t),this},t.prototype.pause=function(){return this.tween.pause(),this},t.prototype.finish=function(){return this.tween.finish(),this},t.prototype.destroy=function(){var e,n=this.node._id,r=this._id,a=t.tweens[n];for(e in this.pause(),a)delete t.tweens[n][e];delete t.attrs[n][r]},t.attrs={},t.tweens={},t}();e.Tween=f,i.Node.prototype.to=function(t){var e=t.onFinish;t.node=this,t.onFinish=function(){this.destroy(),e&&e()};var n=new f(t);n.play()},e.Easings={BackEaseIn:function(t,e,n,r){var a=1.70158;return n*(t/=r)*t*((a+1)*t-a)+e},BackEaseOut:function(t,e,n,r){var a=1.70158;return n*((t=t/r-1)*t*((a+1)*t+a)+1)+e},BackEaseInOut:function(t,e,n,r){var a=1.70158;return(t/=r/2)<1?n/2*(t*t*((1+(a*=1.525))*t-a))+e:n/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e},ElasticEaseIn:function(t,e,n,r,a,i){var o=0;return 0===t?e:1===(t/=r)?e+n:(i||(i=.3*r),!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/i)+e)},ElasticEaseOut:function(t,e,n,r,a,i){var o=0;return 0===t?e:1===(t/=r)?e+n:(i||(i=.3*r),!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),a*Math.pow(2,-10*t)*Math.sin((t*r-o)*(2*Math.PI)/i)+n+e)},ElasticEaseInOut:function(t,e,n,r,a,i){var o=0;return 0===t?e:2===(t/=r/2)?e+n:(i||(i=r*(.3*1.5)),!a||a<Math.abs(n)?(a=n,o=i/4):o=i/(2*Math.PI)*Math.asin(n/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/i)*-.5+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*r-o)*(2*Math.PI)/i)*.5+n+e)},BounceEaseOut:function(t,e,n,r){return(t/=r)<1/2.75?n*(7.5625*t*t)+e:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+e:n*(7.5625*(t-=2.625/2.75)*t+.984375)+e},BounceEaseIn:function(t,n,r,a){return r-e.Easings.BounceEaseOut(a-t,0,r,a)+n},BounceEaseInOut:function(t,n,r,a){return t<a/2?.5*e.Easings.BounceEaseIn(2*t,0,r,a)+n:.5*e.Easings.BounceEaseOut(2*t-a,0,r,a)+.5*r+n},EaseIn:function(t,e,n,r){return n*(t/=r)*t+e},EaseOut:function(t,e,n,r){return-n*(t/=r)*(t-2)+e},EaseInOut:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t+e:-n/2*(--t*(t-2)-1)+e},StrongEaseIn:function(t,e,n,r){return n*(t/=r)*t*t*t*t+e},StrongEaseOut:function(t,e,n,r){return n*((t=t/r-1)*t*t*t*t+1)+e},StrongEaseInOut:function(t,e,n,r){return(t/=r/2)<1?n/2*t*t*t*t*t+e:n/2*((t-=2)*t*t*t*t+2)+e},Linear:function(t,e,n,r){return n*t/r+e}}},"07c7":function(t,e){function n(){return!1}t.exports=n},"07d6":function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},"086c":function(t,e,n){"use strict";n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return i})),n.d(e,"g",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return d})),n.d(e,"j",(function(){return y})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return x})),n.d(e,"a",(function(){return w}));var r=n("df00");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,r,a="NHWC",i){const o=t[3],u=[...e,o],c=x(a);return s(t,u,n,i,r,null,null,c)}function i(t,e,n,r,a,i,o="channelsLast"){const[u,c]=h(e);let l;if("channelsLast"===o)l=[u,c,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);l=[u,c,t[1],t[1]]}return s(t,l,n,r,a,i,!1,o)}function o(t,e,n,r,a,i,o="NDHWC"){const[s,c,l]=p(e);let d,h;if("NDHWC"===o)h="channelsLast",d=[s,c,l,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);h="channelsFirst",d=[s,c,l,t[1],t[1]]}return u(t,d,n,r,a,!1,h,i)}function s(t,e,n,r,a,i,o=!1,s="channelsLast"){let[u,c,l,d]=[-1,-1,-1,-1];if("channelsLast"===s)[u,c,l,d]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);[u,d,c,l]=t}const[p,g,,b]=e,[y,v]=h(n),[x,w]=h(r),k=f(p,x),S=f(g,w),{padInfo:O,outHeight:_,outWidth:C}=m(a,c,l,y,v,k,S,i,s),T=o?b*d:b;let I;return"channelsFirst"===s?I=[u,T,_,C]:"channelsLast"===s&&(I=[u,_,C,T]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:d,outHeight:_,outWidth:C,outChannels:T,padInfo:O,strideHeight:y,strideWidth:v,filterHeight:p,filterWidth:g,effectiveFilterHeight:k,effectiveFilterWidth:S,dilationHeight:x,dilationWidth:w,inShape:t,outShape:I,filterShape:e}}function u(t,e,n,r,a,i=!1,o="channelsLast",s){let[u,c,l,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===o)[u,c,l,d,h]=t;else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);[u,h,c,l,d]=t}const[m,b,y,,v]=e,[x,w,k]=p(n),[S,O,_]=p(r),C=f(m,S),T=f(b,O),I=f(y,_),{padInfo:N,outDepth:E,outHeight:A,outWidth:R}=g(a,c,l,d,x,w,k,C,T,I,s),j=i?v*h:v;let D;return"channelsFirst"===o?D=[u,j,E,A,R]:"channelsLast"===o&&(D=[u,E,A,R,j]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:d,inChannels:h,outDepth:E,outHeight:A,outWidth:R,outChannels:j,padInfo:N,strideDepth:x,strideHeight:w,strideWidth:k,filterDepth:m,filterHeight:b,filterWidth:y,effectiveFilterDepth:C,effectiveFilterHeight:T,effectiveFilterWidth:I,dilationDepth:S,dilationHeight:O,dilationWidth:_,inShape:t,outShape:D,filterShape:e}}function c(t,e,n,r,a){null==r&&(r=d(t,e,n));const i=t[0],o=t[1],s=b((i-e+2*r)/n+1,a),u=b((o-e+2*r)/n+1,a);return[s,u]}function l(t,e,n,r,a,i){null==a&&(a=d(t,e,r));const o=t[0],s=t[1],u=t[2],c=b((o-e+2*a)/r+1,i),l=b((s-e+2*a)/r+1,i),h=b((u-e+2*a)/r+1,i);return[c,l,h,n]}function d(t,e,n,r=1){const a=f(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function h(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function p(t){return"number"===typeof t?[t,t,t]:t}function f(t,e){return e<=1?t:t+(t-1)*(e-1)}function m(t,e,n,r,a,i,o,s,u){let l,d,h;if("number"===typeof t){const a=0===t?"VALID":"NUMBER";l={top:t,bottom:t,left:t,right:t,type:a};const o=c([e,n],i,r,t,s);d=o[0],h=o[1]}else if("same"===t){d=Math.ceil(e/r),h=Math.ceil(n/a);const t=Math.max(0,(d-1)*r+i-e),s=Math.max(0,(h-1)*a+o-n),u=Math.floor(t/2),c=t-u,p=Math.floor(s/2),f=s-p;l={top:u,bottom:c,left:p,right:f,type:"SAME"}}else if("valid"===t)l={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof t)throw Error("Unknown padding parameter: "+t);{const c="channelsLast"===u?t[1][0]:t[2][0],p="channelsLast"===u?t[1][1]:t[2][1],f="channelsLast"===u?t[2][0]:t[3][0],m="channelsLast"===u?t[2][1]:t[3][1],g=0===c&&0===p&&0===f&&0===m?"VALID":"EXPLICIT";l={top:c,bottom:p,left:f,right:m,type:g},d=b((e-i+c+p)/r+1,s),h=b((n-o+f+m)/a+1,s)}}return{padInfo:l,outHeight:d,outWidth:h}}function g(t,e,n,r,a,i,o,s,u,c,d){let h,p,f,m;if("number"===typeof t){const i=0===t?"VALID":"NUMBER";h={top:t,bottom:t,left:t,right:t,front:t,back:t,type:i};const o=l([e,n,r,1],s,1,a,t,d);p=o[0],f=o[1],m=o[2]}else if("same"===t){p=Math.ceil(e/a),f=Math.ceil(n/i),m=Math.ceil(r/o);const t=(p-1)*a+s-e,l=(f-1)*i+u-n,d=(m-1)*o+c-r,g=Math.floor(t/2),b=t-g,y=Math.floor(l/2),v=l-y,x=Math.floor(d/2),w=d-x;h={top:y,bottom:v,left:x,right:w,front:g,back:b,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/a),f=Math.ceil((n-u+1)/i),m=Math.ceil((r-c+1)/o)}return{padInfo:h,outDepth:p,outHeight:f,outWidth:m}}function b(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function y(t){const[e,n,r]=h(t);return 1===e&&1===n&&1===r}function v(t,e){return y(t)||y(e)}function x(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function w(t,e,n){if(null!=n){if("string"===typeof e)throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if("number"===typeof e)r["b"](r["v"](e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else{if("object"!==typeof e)throw Error(`Error in ${t}: Unknown padding parameter: ${e}`);e.forEach(e=>{e.forEach(e=>{r["b"](r["v"](e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`)})})}}}},"087d":function(t,e){function n(t,e){var n=-1,r=e.length,a=t.length;while(++n<r)t[a+n]=e[n];return t}t.exports=n},"08cc":function(t,e,n){var r=n("1a8c");function a(t){return t===t&&!r(t)}t.exports=a},"0960":function(t,e,n){t.exports=n("b19a")},"099a":function(t,e){function n(t,e,n){var r=n-1,a=t.length;while(++r<a)if(t[r]===e)return r;return-1}t.exports=n},"0a08":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.floor(t)),s=Object(i["b"])(r["Floor"],o),u={kernelName:r["Floor"],backendName:"cpu",kernelFunc:s}},"0abf":function(t,e,n){"use strict";n("1bec")},"0ae3":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","relu"),n={x:e};return r["a"].runKernel(a["tc"],n)}const u=Object(o["b"])({relu_:s})},"0b07":function(t,e,n){var r=n("34ac"),a=n("3698");function i(t,e){var n=a(t,e);return r(n)?n:void 0}t.exports=i},"0b61":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("4e1f"),s=n("f947"),u=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(i["a"])(t,"broadcastTo","x");const s=n.shape;if(e.some(t=>!(t>0)||t%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();while(t.length<e.length)t.unshift(1);n=Object(u["a"])(n,t)}const c=n.shape,l=Array.from(e);for(let r=e.length-1;r>=0;r--)if(c[r]===e[r])l[r]=1;else if(1!==n.shape[r])throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);const d=l.map((t,e)=>t>1?e:-1).filter(t=>t>=0);if(0===d.length)return Object(o["a"])(n);const h={x:n},p={reps:l};return r["a"].runKernel(a["id"],h,p)}const l=Object(s["b"])({broadcastTo_:c})},"0d24":function(t,e,n){(function(t){var r=n("2b3e"),a=n("07c7"),i=e&&!e.nodeType&&e,o=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===i,u=s?r.Buffer:void 0,c=u?u.isBuffer:void 0,l=c||a;t.exports=l}).call(this,n("62e4")(t))},"0d7e":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e=0){const n=Object(i["a"])(t,"x","expandDims","string_or_numeric");o["b"](e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},u={dim:e};return r["a"].runKernel(a["db"],s,u)}const c=Object(s["b"])({expandDims_:u})},"0db7":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=Object(o["a"])(t,"a","mul"),s=Object(o["a"])(e,"b","mul");[n,s]=Object(i["makeTypesMatch"])(n,s);const u={a:n,b:s};return r["a"].runKernel(a["Zb"],u)}const c=Object(s["b"])({mul_:u})},"0e1b":function(t,e,n){"use strict";n.r(e),n.d(e,"version_webgl",(function(){return Pr})),n.d(e,"MathBackendWebGL",(function(){return Fr})),n.d(e,"setWebGLContext",(function(){return u})),n.d(e,"GPGPUContext",(function(){return nn})),n.d(e,"gpgpu_util",(function(){return a})),n.d(e,"webgl_util",(function(){return r})),n.d(e,"forceHalfFloat",(function(){return $r})),n.d(e,"webgl",(function(){return Lr}));var r={};n.r(r),n.d(r,"callAndCheck",(function(){return w})),n.d(r,"canBeRepresented",(function(){return _})),n.d(r,"getWebGLErrorMessage",(function(){return C})),n.d(r,"getExtensionOrThrow",(function(){return T})),n.d(r,"createVertexShader",(function(){return I})),n.d(r,"createFragmentShader",(function(){return N})),n.d(r,"logShaderSourceAndInfoLog",(function(){return A})),n.d(r,"createProgram",(function(){return R})),n.d(r,"linkProgram",(function(){return j})),n.d(r,"validateProgram",(function(){return D})),n.d(r,"createStaticVertexBuffer",(function(){return F})),n.d(r,"createStaticIndexBuffer",(function(){return M})),n.d(r,"getNumChannels",(function(){return P})),n.d(r,"createTexture",(function(){return $})),n.d(r,"validateTextureSize",(function(){return L})),n.d(r,"createFramebuffer",(function(){return B})),n.d(r,"bindVertexBufferToProgramAttribute",(function(){return z})),n.d(r,"bindTextureUnit",(function(){return W})),n.d(r,"unbindTextureUnit",(function(){return V})),n.d(r,"getProgramUniformLocationOrThrow",(function(){return U})),n.d(r,"getProgramUniformLocation",(function(){return G})),n.d(r,"bindTextureToProgramUniformSampler",(function(){return H})),n.d(r,"bindCanvasToFramebuffer",(function(){return q})),n.d(r,"bindColorTextureToFramebuffer",(function(){return K})),n.d(r,"unbindColorTextureFromFramebuffer",(function(){return X})),n.d(r,"validateFramebuffer",(function(){return Y})),n.d(r,"getFramebufferErrorMessage",(function(){return J})),n.d(r,"getBatchDim",(function(){return tt})),n.d(r,"getRowsCols",(function(){return et})),n.d(r,"getShapeAs3D",(function(){return nt})),n.d(r,"getTextureShapeFromLogicalShape",(function(){return rt})),n.d(r,"isReshapeFree",(function(){return it})),n.d(r,"getWebGLMaxTextureSize",(function(){return ut})),n.d(r,"resetMaxTextureSize",(function(){return ct})),n.d(r,"resetMaxTexturesInShader",(function(){return lt})),n.d(r,"getMaxTexturesInShader",(function(){return dt})),n.d(r,"getWebGLDisjointQueryTimerVersion",(function(){return ht})),n.d(r,"hasExtension",(function(){return pt})),n.d(r,"isWebGLVersionEnabled",(function(){return ft})),n.d(r,"isCapableOfRenderingToFloatTexture",(function(){return mt})),n.d(r,"isDownloadFloatTextureEnabled",(function(){return gt})),n.d(r,"isWebGLFenceEnabled",(function(){return vt})),n.d(r,"assertNotComplex",(function(){return xt}));var a={};n.r(a),n.d(a,"createVertexShader",(function(){return De})),n.d(a,"createVertexBuffer",(function(){return Fe})),n.d(a,"createIndexBuffer",(function(){return Me})),n.d(a,"getInternalFormatForFloat32MatrixTexture",(function(){return $e})),n.d(a,"createFloat32MatrixTexture",(function(){return Le})),n.d(a,"getInternalFormatForFloat16MatrixTexture",(function(){return Be})),n.d(a,"createFloat16MatrixTexture",(function(){return ze})),n.d(a,"getInternalFormatForUnsignedBytesMatrixTexture",(function(){return We})),n.d(a,"createUnsignedBytesMatrixTexture",(function(){return Ve})),n.d(a,"getInternalFormatForPackedMatrixTexture",(function(){return Ue})),n.d(a,"createPackedMatrixTexture",(function(){return Ge})),n.d(a,"getInternalFormatForFloat16PackedMatrixTexture",(function(){return He})),n.d(a,"createFloat16PackedMatrixTexture",(function(){return qe})),n.d(a,"bindVertexProgramAttributeStreams",(function(){return Ke})),n.d(a,"uploadDenseMatrixToTexture",(function(){return Xe})),n.d(a,"uploadPixelDataToTexture",(function(){return Ye})),n.d(a,"createBufferFromOutputTexture",(function(){return Je})),n.d(a,"downloadFloat32MatrixFromBuffer",(function(){return Ze})),n.d(a,"downloadByteEncodedFloatMatrixFromOutputTexture",(function(){return Qe})),n.d(a,"downloadPackedMatrixFromBuffer",(function(){return tn})),n.d(a,"downloadMatrixFromPackedOutputTexture",(function(){return en}));var i=n("2ca8");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o={},s={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function u(t,e){o[t]=e}function c(t,e){if(!(t in o)||null!=e){const n=d(t,e);if(null===n)return console.log("Could not get context for WebGL version",t),null;o[t]=n}const n=o[t];return null==n||n.isContextLost()?(delete o[t],c(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),o[t])}function l(t){if("undefined"!==typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function d(t,e){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==e?l(t):e;return n.addEventListener("webglcontextlost",e=>{e.preventDefault(),delete o[t]},!1),Object(i["env"])().getBool("SOFTWARE_WEBGL_ENABLED")&&(s.failIfMajorPerformanceCaveat=!1),1===t?n.getContext("webgl",s)||n.getContext("experimental-webgl",s):n.getContext("webgl2",s)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var h,p,f;function m(t,e){return[e,t]}function g(t,e){return t*e}function b(t){const e=i["util"].sizeFromShape(t),n=Math.ceil(e/4);return i["util"].sizeToSquarishShape(n)}function y(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function v(t,e){const[n,r]=y(t,e);return n*r*4}function x(t,e){const n=t;let r,a,o,s,u,c,l,d,h,p;return 2===Object(i["env"])().getNumber("WEBGL_VERSION")?(r=n.R32F,a=n.R16F,o=n.RGBA16F,s=n.RGBA32F,u=n.RED,l=4,d=1,h=n.HALF_FLOAT,p=n.FLOAT,c=n.RGBA8):(r=t.RGBA,a=t.RGBA,o=t.RGBA,s=n.RGBA,u=t.RGBA,l=4,d=4,h=null!=e?e.HALF_FLOAT_OES:null,p=t.FLOAT,c=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:s,textureFormatFloat:u,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:d,textureTypeHalfFloat:h,textureTypeFloat:p}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w(t,e){const n=e();return Object(i["env"])().getBool("DEBUG")&&k(t),n}function k(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+C(t,e))}(function(t){t[t["DENSE"]=0]="DENSE",t[t["SHARED_BATCH"]=1]="SHARED_BATCH"})(h||(h={})),function(t){t[t["RENDER"]=0]="RENDER",t[t["UPLOAD"]=1]="UPLOAD",t[t["PIXELS"]=2]="PIXELS",t[t["DOWNLOAD"]=3]="DOWNLOAD"}(p||(p={})),function(t){t[t["UNPACKED_FLOAT16"]=0]="UNPACKED_FLOAT16",t[t["UNPACKED_FLOAT32"]=1]="UNPACKED_FLOAT32",t[t["PACKED_4X1_UNSIGNED_BYTE"]=2]="PACKED_4X1_UNSIGNED_BYTE",t[t["PACKED_2X2_FLOAT32"]=3]="PACKED_2X2_FLOAT32",t[t["PACKED_2X2_FLOAT16"]=4]="PACKED_2X2_FLOAT16"}(f||(f={}));const S=5.96e-8,O=65504;function _(t){return!!(Object(i["env"])().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||S<Math.abs(t)&&Math.abs(t)<O)}function C(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function T(t,e){return Z(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function I(t,e){const n=Z(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(w(t,()=>t.shaderSource(n,e)),w(t,()=>t.compileShader(n)),!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function N(t,e){const n=Z(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(w(t,()=>t.shaderSource(n,e)),w(t,()=>t.compileShader(n)),Object(i["env"])().get("ENGINE_COMPILE_ONLY"))return n;if(!1===t.getShaderParameter(n,t.COMPILE_STATUS))throw A(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const E=/ERROR: [0-9]+:([0-9]+):/g;function A(t,e){const n=E.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);const r=+n[1],a=t.split("\n"),o=a.length.toString().length+2,s=a.map((t,e)=>i["util"].rightPad((e+1).toString(),o)+t);let u=0;for(let i=0;i<s.length;i++)u=Math.max(s[i].length,u);const c=s.slice(0,r-1),l=s.slice(r-1,r),d=s.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+i["util"].rightPad(l[0],u),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}function R(t){return Z(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function j(t,e){if(w(t,()=>t.linkProgram(e)),!Object(i["env"])().get("ENGINE_COMPILE_ONLY")&&!1===t.getProgramParameter(e,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function D(t,e){if(w(t,()=>t.validateProgram(e)),!1===t.getProgramParameter(e,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function F(t,e){const n=Z(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return w(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),w(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function M(t,e){const n=Z(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return w(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),w(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function P(){return 2===Object(i["env"])().getNumber("WEBGL_VERSION")?1:4}function $(t){return Z(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function L(t,e){const n=Object(i["env"])().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const n=`[${t}x${e}]`;throw new Error("Requested texture size "+n+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function B(t){return Z(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function z(t,e,n,r,a,i,o){const s=t.getAttribLocation(e,n);return-1!==s&&(w(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),w(t,()=>t.vertexAttribPointer(s,a,t.FLOAT,!1,i,o)),w(t,()=>t.enableVertexAttribArray(s)),!0)}function W(t,e,n){Q(t,n),w(t,()=>t.activeTexture(t.TEXTURE0+n)),w(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function V(t,e){Q(t,e),w(t,()=>t.activeTexture(t.TEXTURE0+e)),w(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function U(t,e,n){return Z(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function G(t,e,n){return t.getUniformLocation(e,n)}function H(t,e,n,r){w(t,()=>W(t,e,r)),w(t,()=>t.uniform1i(n,r))}function q(t){w(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),w(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),w(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function K(t,e,n){w(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),w(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function X(t,e){w(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),w(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Y(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+J(t,e))}function J(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Z(t,e,n){const r=w(t,()=>e());if(null==r)throw new Error(n);return r}function Q(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const t=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${t}.`)}}function tt(t,e=2){return i["util"].sizeFromShape(t.slice(0,t.length-e))}function et(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function nt(t){let e=[1,1,1];const n=0===t.length||1===t.length&&1===t[0];return n||(e=[tt(t),...et(t)]),e}function rt(t,e=!1){let n=Object(i["env"])().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Object(i["env"])().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(r===1/0&&Object(i["env"])().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n*=2,r*=2,t=t.map((e,n)=>n>=t.length-2?i["util"].nearestLargerEven(t[n]):t[n]),1===t.length&&(t=[2,t[0]])),2!==t.length){const e=i["util"].squeezeShape(t);t=e.newShape}let a=i["util"].sizeFromShape(t),o=null;t.length<=1&&a<=n?o=[1,a]:2===t.length&&t[0]<=n&&t[1]<=n?o=t:3===t.length&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:4===t.length&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const s=null!=o&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(null==o||s)if(e){const e=tt(t);let n=2,r=2;t.length&&([n,r]=et(t)),a=e*(n/2)*(r/2),o=i["util"].sizeToSquarishShape(a).map(t=>2*t)}else o=i["util"].sizeToSquarishShape(a);return o}function at(t){return t%2===0}function it(t,e){if(t=t.slice(-2),e=e.slice(-2),i["util"].arraysEqual(t,e))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(at(n)&&at(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&at(t[0])&&at(e[0])}let ot,st;function ut(t){if(null==ot){const e=c(t);ot=e.getParameter(e.MAX_TEXTURE_SIZE)}return ot}function ct(){ot=null}function lt(){st=null}function dt(t){if(null==st){const e=c(t);st=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,st)}function ht(t){if(0===t)return 0;let e;const n=c(t);return e=pt(n,"EXT_disjoint_timer_query_webgl2")&&2===t?2:pt(n,"EXT_disjoint_timer_query")?1:0,e}function pt(t,e){const n=t.getExtension(e);return null!=n}function ft(t){try{const e=c(t);if(null!=e)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function mt(t){if(0===t)return!1;const e=c(t);if(1===t){if(!pt(e,"OES_texture_float"))return!1}else if(!pt(e,"EXT_color_buffer_float"))return!1;const n=bt(e);return n}function gt(t){if(0===t)return!1;const e=c(t);if(1!==t){if(pt(e,"EXT_color_buffer_float"))return bt(e);const t="EXT_color_buffer_half_float";if(pt(e,t)){const n=e.getExtension(t);return yt(e,n)}return!1}if(!pt(e,"OES_texture_float"))return!1;if(!pt(e,"WEBGL_color_buffer_float"))return!1;const n=bt(e);return n}function bt(t){const e=x(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,a=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,a,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function yt(t,e){const n=x(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const a=1,i=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),s}function vt(t){if(2!==t)return!1;const e=c(t),n=null!=e.fenceSync;return n}function xt(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&i["util"].assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the WebGL backend.")})}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wt=Object(i["env"])();
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kt(){let t,e,n,r,a,o,s,u,c,l;return 2===Object(i["env"])().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",a="texture",o="outputColor",s="out vec4 outputColor;",u=Object(i["env"])().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",c="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",s="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:s,defineSpecialNaN:u,defineSpecialInf:c,defineRound:l}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function St(t,e,n="index"){const r=i["util"].computeStrides(e);return r.map((e,a)=>{const i=`int ${t[a]} = ${n} / ${e}`,o=a===r.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${e}`:`index -= ${t[a]} * ${e}`;return`${i}; ${o};`}).join("")}function Ot(t,e,n="index"){const r=i["util"].computeStrides(e);return r.map((e,a)=>{const i=`int ${t[a]} = ${n} / outShapeStrides[${a}]`,o=a===r.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * outShapeStrides[${a}]`:`index -= ${t[a]} * outShapeStrides[${a}]`;return`${i}; ${o};`}).join("")}function _t(t,e){const n=t.length,r=t.map(t=>`${e}[${t}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}function Ct(t,e,n="index"){const r=t.map((t,e)=>e),a=_t(r,e);return a.map((e,r)=>{const i=`int ${t[r]} = ${n} / ${a[r]}`,o=r===a.length-1?`int ${t[r+1]} = ${n} - ${t[r]} * ${a[r]}`:`index -= ${t[r]} * ${a[r]}`;return`${i}; ${o};`}).join("")}function Tt(t){const e=i["util"].computeStrides(t).map(t=>t.toString());return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;\n  }\n`}function It(){return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n"}wt.registerFlag("HAS_WEBGL",()=>wt.getNumber("WEBGL_VERSION")>0),wt.registerFlag("WEBGL_VERSION",()=>ft(2)?2:ft(1)?1:0),wt.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),wt.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>2===wt.get("WEBGL_VERSION")),wt.registerFlag("WEBGL_CPU_FORWARD",()=>!0),wt.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),wt.registerFlag("WEBGL_PACK",()=>wt.getBool("HAS_WEBGL")),wt.registerFlag("WEBGL_PACK_NORMALIZATION",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_CLIP",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_PACK_REDUCE",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_LAZILY_UNPACK",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_CONV_IM2COL",()=>wt.getBool("WEBGL_PACK")),wt.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>ut(wt.getNumber("WEBGL_VERSION"))),wt.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>dt(wt.getNumber("WEBGL_VERSION"))),wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=wt.getNumber("WEBGL_VERSION");return 0===t?0:ht(t)}),wt.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>wt.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!i["device_util"].isMobile()),wt.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>mt(wt.getNumber("WEBGL_VERSION"))),wt.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>!wt.getBool("WEBGL_FORCE_F16_TEXTURES")&&wt.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),wt.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>gt(wt.getNumber("WEBGL_VERSION"))),wt.registerFlag("WEBGL_FENCE_API_ENABLED",()=>vt(wt.getNumber("WEBGL_VERSION"))),wt.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>{const t=wt.getBool("WEBGL_RENDER_FLOAT32_ENABLED");return t?4:0}),wt.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&-1!==t)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)}),wt.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>i["device_util"].isMobile()?1:-1,t=>{if(t<0&&-1!==t)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)}),wt.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),wt.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),wt.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),wt.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),wt.registerFlag("WEBGL_EXP_CONV",()=>!1),wt.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>wt.getBool("IS_TEST")),wt.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),wt.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),wt.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);const Nt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:Et}=i["backend_util"];
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function At(t,e,n){const r=[];if(t.forEach(t=>{const e=i["util"].sizeFromShape(t.shapeInfo.logicalShape);if(t.shapeInfo.isUniform?r.push(`uniform float ${t.name}${e>1?`[${e}]`:""};`):(r.push(`uniform sampler2D ${t.name};`),r.push(`uniform int offset${t.name};`)),n.enableShapeUniforms){const{uniformShape:e}=ve(n.packedInputs,t.shapeInfo.logicalShape,t.shapeInfo.texShape);switch(e.length){case 1:r.push(`uniform int ${t.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${t.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${t.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${t.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${t.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break;default:break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(t=>{r.push(`uniform ${t.type} ${t.name}${t.arrayIndex?`[${t.arrayIndex}]`:""};`)});const a=r.join("\n"),o=t.map(t=>Dt(t,e,n.packedInputs,n.enableShapeUniforms)).join("\n"),s=e.texShape,u=kt(),c=Pt(u);let l,d,h=Bt(u);e.isPacked?(l=Ft(e.logicalShape,s,n.enableShapeUniforms),d=Lt(u)):(l=Mt(e.logicalShape,s,n.enableShapeUniforms),d=$t(u)),n.packedInputs&&(h+=Ut);const p=[h,c,d,a,l,o,n.userCode].join("\n");return p}function Rt(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return ae(t,e);case 1:return oe(t,e);case 2:return ue(t,e);case 3:return le(t,e);case 4:return he(t,e);case 5:return pe(t);case 6:return fe(t);default:throw new Error(n.length+"-D input sampling is not yet supported")}}function jt(t,e){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return re(t);case 1:return ie(t,e);case 2:return se(t,e);case 3:return ce(t,e);default:return de(t,e)}}function Dt(t,e,n=!1,r){let a="";a+=n?jt(t,r):Rt(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(a+=n?ge(t,e):be(t,e)),a}function Ft(t,e,n){switch(t.length){case 0:return Gt();case 1:return Ht(t,e,n);case 2:return te(t,e,n);case 3:return Kt(t,e,n);default:return Yt(t,e,n)}}function Mt(t,e,n){switch(t.length){case 0:return Gt();case 1:return qt(t,e,n);case 2:return ee(t,e,n);case 3:return Xt(t,e,n);case 4:return Jt(t,e,n);case 5:return Zt(t,e);case 6:return Qt(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}}function Pt(t){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${t.texture2D}(textureSampler, uv).r;\n    }\n  `}function $t(t){return`\n    void setOutput(float val) {\n      ${t.output} = vec4(val, 0, 0, 0);\n    }\n  `}function Lt(t){return`\n    void setOutput(vec4 val) {\n      ${t.output} = val;\n    }\n  `}function Bt(t){const e=`${t.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${t.varyingFs} vec2 resultUV;\n    ${t.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${t.defineSpecialNaN}\n    ${t.defineSpecialInf}\n    ${t.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${zt}\n    ${Wt}\n    ${Vt}\n  `;return e}const zt="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Wt="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Vt="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ut="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Gt(){return"\n    int getOutputCoords() {\n      return 0;\n    }\n  "}function Ht(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}function qt(t,e,n){return 1===e[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${e[1]}.0);\n      }\n    `:1===e[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${e[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      return resTexRC.x * ${e[1]} + resTexRC.y;\n    }\n  `}function Kt(t,e,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),i=a*Math.ceil(t[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}function Xt(t,e,n){if(n){const e=Ot(["r","c","d"],t);return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${e}\n    return ivec3(r, c, d);\n  }\n`}const r=St(["r","c","d"],t);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}function Yt(t,e,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),i=a*Math.ceil(t[t.length-2]/2);let o=i,s="",u="b, r, c";for(let c=2;c<t.length-1;c++)o*=t[t.length-c-1],s=`\n      int b${c} = index / ${o};\n      index -= b${c} * ${o};\n    `+s,u=`b${c}, `+u;return`\n    ivec${t.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${s}\n\n      int b = index / ${i};\n      index -= b * ${i};\n\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec${t.length}(${u});\n    }\n  `}function Jt(t,e,n){if(n){const e=Ot(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${e}\n      return ivec4(r, c, d, d2);\n    }\n  `}const r=St(["r","c","d","d2"],t);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}function Zt(t,e){const n=St(["r","c","d","d2","d3"],t);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},\n                             ${e[1]}));\n\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}function Qt(t,e){const n=St(["r","c","d","d2","d3","d4"],t);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}function te(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(i["util"].arraysEqual(t,e))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const a=Math.ceil(t[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${a});\n      int c = imod(index, ${a}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}function ee(t,e,n){return i["util"].arraysEqual(t,e)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));\n      }\n    `:1===t[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===t[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${e[0]}, ${e[1]}));\n        int index = resTexRC.x * ${e[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${e[0]}, ${e[1]}));\n      int index = resTexRC.x * ${e[1]} + resTexRC.y;\n      int r = index / ${t[1]};\n      int c = index - r * ${t[1]};\n      return ivec2(r, c);\n    }\n  `}function ne(t){return"offset"+t}function re(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=kt();return`\n    vec4 ${n}() {\n      return ${r.texture2D}(${e}, halfCR);\n    }\n  `}function ae(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[a,i]=t.shapeInfo.texShape;if(1===a&&1===i)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const o=ne(n);if(e)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[s,u]=t.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${s}, ${u}, ${o});\n      return sampleTexture(${n}, uv);\n    }\n  `}function ie(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=kt();if(e)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `;const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${o[0]}, ${o[1]}, index);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}function oe(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${me(t)}\n      }\n    `;const a=t.shapeInfo.texShape,i=a[0],o=a[1];if(1===o&&1===i)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const s=ne(n);return 1===o?e?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${i}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:1===i?e?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${o}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:e?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${i}, ${o}, index + ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `}function se(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,s=o[0],u=o[1],c=kt();if(null!=o&&i["util"].arraysEqual(n,o))return e?`\n      vec4 ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${u}.0, ${s}.0);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `;if(e)return`\n    vec4 ${a}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `;const l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],d=Math.ceil(n[1]/2);return`\n    vec4 ${a}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${d}, ${l[0]}, ${l[1]}, row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `}function ue(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(null!=o&&i["util"].arraysEqual(n,o)){if(e)return`\n      float ${a}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const t=o[0],n=o[1];return`\n    float ${a}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}.0, ${t}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:s,keptDims:u}=i["util"].squeezeShape(n),c=s;if(c.length<n.length){const n=xe(t,c),r=["row","col"];return`\n      ${Rt(n,e)}\n      float ${a}(int row, int col) {\n        return ${a}(${we(r,u)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${a}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${me(t)}\n      }\n    `;const l=o[0],d=o[1],h=ne(r);return 1===d?e?`\n      float ${a}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===l?e?`\n      float ${a}(int row, int col) {\n        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col) {\n      float index = dot(vec3(row, col, ${h}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:e?`\n      float ${a}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${h};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${a}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${h};\n    vec2 uv = uvFromFlat(${l}, ${d}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}function ce(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){const r=n.slice(1),i=[1,2],o=xe(t,r),s=["b","row","col"];return`\n        ${jt(o,e)}\n        vec4 ${a}(int b, int row, int col) {\n          return ${a}(${we(s,i)});\n        }\n      `}const s=kt();if(e)return`\n    vec4 ${a}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `;const u=o[0],c=o[1],l=Math.ceil(n[2]/2),d=l*Math.ceil(n[1]/2);return`\n    vec4 ${a}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${u}, ${c}, ${d}, ${l}, b, row, col);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `}function le(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],{newShape:u,keptDims:c}=i["util"].squeezeShape(n),l=u;if(l.length<n.length){const n=xe(t,l),r=["row","col","depth"];return`\n        ${Rt(n,e)}\n        float ${a}(int row, int col, int depth) {\n          return ${a}(${we(r,c)});\n        }\n      `}if(t.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${o}, ${s}, 1)));\n        ${me(t)}\n      }\n    `;const d=t.shapeInfo.texShape,h=d[0],p=d[1],f=t.shapeInfo.flatOffset;if(p===o&&null==f)return e?`\n      float ${a}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${a}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${s}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${p}.0, ${h}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(p===s&&null==f)return e?`\n      float ${a}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${a}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${h}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const m=ne(r);return e?`\n    float ${a}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${m};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${a}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${o} + col * ${s} + depth + ${m};\n        vec2 uv = uvFromFlat(${h}, ${p}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}function de(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=kt();if(e)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);\n    }\n  `;const i=t.shapeInfo.logicalShape,o=i.length,s=t.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],c=u[0],l=u[1],d=Math.ceil(i[o-1]/2);let h=d*Math.ceil(i[o-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<o-1;m++)p=`int b${m}, `+p,h*=i[o-m-1],f=`b${m} * ${h} + `+f;return`\n    vec4 ${r}(${p}) {\n      int index = ${f};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${c});\n      return ${a.texture2D}(${n}, uv);\n    }\n  `}function he(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,{newShape:c,keptDims:l}=i["util"].squeezeShape(n);if(c.length<n.length){const n=xe(t,c),r=["row","col","depth","depth2"];return`\n      ${Rt(n,e)}\n      float ${a}(int row, int col, int depth, int depth2) {\n        return ${a}(${we(r,l)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${a}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${u}, ${s}, ${o}, 1)));\n        ${me(t)}\n      }\n    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1],m=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,b=`int stride0 = ${r}Shape[1] * stride1;`;if(f===u&&null==d)return e?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        ${m}\n        ${g}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${s}, ${o}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(f===o&&null==d)return e?`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${a}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const y=ne(r);return e?`\n    float ${a}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${m}\n      ${g}\n      ${b}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${a}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${u} + col * ${s} +\n          depth * ${o} + depth2;\n      vec2 uv = uvFromFlat(${p}, ${f}, index + ${y});\n      return sampleTexture(${r}, uv);\n    }\n  `}function pe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],o=e[3]*a,s=e[2]*o,u=e[1]*s,{newShape:c,keptDims:l}=i["util"].squeezeShape(e);if(c.length<e.length){const e=xe(t,c),n=["row","col","depth","depth2","depth3"];return`\n      ${Rt(e)}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${we(n,l)});\n      }\n    `}if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${u}, ${s}, ${o}, ${a})) +\n          depth3;\n        ${me(t)}\n      }\n    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===u&&null==d)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${s}, ${o}, ${a}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(f===a&&null==d)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]},\n               ${e[2]*e[3]}, ${e[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const m=ne(n);return`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${u} + col * ${s} + depth * ${o} +\n          depth2 * ${a} + depth3 + ${m};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}function fe(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:o}=i["util"].squeezeShape(e);if(a.length<e.length){const e=xe(t,a),n=["row","col","depth","depth2","depth3","depth4"];return`\n      ${Rt(e)}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${we(n,o)});\n      }\n    `}const s=e[5],u=e[4]*s,c=e[3]*u,l=e[2]*c,d=e[1]*l;if(t.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${d}, ${l}, ${c}, ${u})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${s}, 1)));\n        ${me(t)}\n      }\n    `;const h=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];if(m===d&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${l}, ${c}, ${u}, ${s})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${m}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(m===s&&null==h)return`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${e[1]*e[2]*e[3]*e[4]},\n               ${e[2]*e[3]*e[4]},\n               ${e[3]*e[4]},\n               ${e[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${m}.0, ${f}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const g=ne(n);return`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${d} + col * ${l} + depth * ${c} +\n          depth2 * ${u} + depth3 * ${s} + depth4 + ${g};\n      vec2 uv = uvFromFlat(${f}, ${m}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}function me(t){const e=t.name,n=i["util"].sizeFromShape(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${e}[i];\n      }\n    }\n  `}function ge(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=Et(t.shapeInfo.logicalShape,e.logicalShape),c=ye(s),l=s-o;let d;const h=["x","y","z","w","u","v"];d=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map(t=>`coords.${h[t+l]} = 0;`).join("\n");let p="";p=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+h[e+l]).join(", ");let f="return outputValue;";const m=i["util"].sizeFromShape(t.shapeInfo.logicalShape),g=1===m,b=i["util"].sizeFromShape(e.logicalShape),y=1===b;if(1!==o||g||y){if(g&&!y)f=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){const t=o-2,e=o-1;u.indexOf(t)>-1&&u.indexOf(e)>-1?f="return vec4(outputValue.x);":u.indexOf(t)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(e)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}}else f="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${a}() {\n      ${c} coords = getOutputCoords();\n      ${d}\n      vec4 outputValue = get${r}(${p});\n      ${f}\n    }\n  `}function be(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=e.texShape,s=t.shapeInfo.texShape,u=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&u===c&&null==t.shapeInfo.flatOffset&&i["util"].arraysEqual(s,o))return`\n      float ${a}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const l=ye(c),d=Et(t.shapeInfo.logicalShape,e.logicalShape),h=c-u;let p;const f=["x","y","z","w","u","v"];p=0===u?"":c<2&&d.length>=1?"coords = 0;":d.map(t=>`coords.${f[t+h]} = 0;`).join("\n");let m="";return m=c<2&&u>0?"coords":t.shapeInfo.logicalShape.map((t,e)=>"coords."+f[e+h]).join(", "),`\n    float ${a}() {\n      ${l} coords = getOutputCoords();\n      ${p}\n      return get${r}(${m});\n    }\n  `}function ye(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function ve(t,e,n){const{newShape:r,keptDims:a}=i["util"].squeezeShape(e),o=e.length,s=t&&3===o&&1===e[0],u=s?e.slice(1):r,c=!t&&o>1&&!i["util"].arraysEqual(e,n)&&r.length<o||s,l=c?u:e;return{useSqueezeShape:c,uniformShape:l,keptDims:a}}function xe(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function we(t,e){return e.map(e=>t[e]).join(", ")}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ke(t,e,n,r){const a=n.map((t,n)=>{const r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}}),o=a.map(t=>t.shapeInfo),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=At(a,s,e),c=N(t.gl,u),l=t.createProgram(c);return Object(i["env"])().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:u,webGLProgram:l,inShapeInfos:o,outShapeInfo:s,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:c,source:u,webGLProgram:l,inShapeInfos:o,outShapeInfo:s},Se(t,e,l))}function Se(t,e,n){const r={},a={},o={},s=[];let u,c,l,d=null,h=null;h=t.getUniformLocation(n,"NAN",!1),1===Object(i["env"])().getNumber("WEBGL_VERSION")&&(d=t.getUniformLocation(n,"INFINITY",!1));const p=!1;for(let i=0;i<e.variableNames.length;i++){const s=e.variableNames[i];r[s]=t.getUniformLocation(n,s,p),r["offset"+s]=t.getUniformLocation(n,"offset"+s,p),e.enableShapeUniforms&&(a[s+"Shape"]=t.getUniformLocation(n,s+"Shape",p),o[s+"TexShape"]=t.getUniformLocation(n,s+"TexShape",p))}return e.enableShapeUniforms&&(u=t.getUniformLocation(n,"outShape",p),l=t.getUniformLocation(n,"outShapeStrides",p),c=t.getUniformLocation(n,"outTexShape",p)),e.customUniforms&&e.customUniforms.forEach((e,r)=>{s[r]=t.getUniformLocation(n,e.name,p)}),{uniformLocations:r,customUniformLocations:s,infLoc:d,nanLoc:h,inShapesLocations:a,inTexShapesLocations:o,outShapeLocation:u,outShapeStridesLocation:l,outTexShapeLocation:c}}function Oe(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((t,n)=>{const r=t.logicalShape,a=e[n],o=a.shape;if(!i["util"].arraysEqual(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(t.isUniform&&a.isUniform)return;const s=t.texShape,u=a.isUniform?null:a.texData.texShape;if(!i["util"].arraysEqual(s,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${u} must match`)})}function _e(t,e,n,r,a){e.program.enableShapeUniforms||(Oe(e.inShapeInfos,n),Oe([e.outShapeInfo],[r]));const o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,s[0],s[1]):t.setOutputMatrixTexture(o.texture,s[0],s[1]),t.setProgram(e.webGLProgram),1===Object(i["env"])().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((n,r)=>{const a=e.program.variableNames[r],o=e.uniformLocations[a],s=e.uniformLocations["offset"+a],u=e.inShapesLocations[a+"Shape"],c=e.inTexShapesLocations[a+"TexShape"];if(u){const{uniformShape:r}=ve(e.program.packedInputs,n.shape,n.texData.texShape);switch(r.length){case 1:t.gl.uniform1iv(u,new Int32Array(r));break;case 2:t.gl.uniform2iv(u,new Int32Array(r));break;case 3:t.gl.uniform3iv(u,new Int32Array(r));break;case 4:t.gl.uniform4iv(u,new Int32Array(r));break;default:break}}if(c&&t.gl.uniform2i(c,n.texData.texShape[0],n.texData.texShape[1]),null!=o)if(n.isUniform)if(i["util"].sizeFromShape(n.shape)<2)t.gl.uniform1f(o,n.uniformValues[0]);else{let e=n.uniformValues;e instanceof Float32Array||(e=new Float32Array(e)),t.gl.uniform1fv(o,e)}else null!=n.texData.slice&&null!=s&&t.gl.uniform1i(s,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture.texture,o,r)});const u=e.outShapeLocation;if(u)switch(r.shape.length){case 1:t.gl.uniform1iv(u,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(u,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(u,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(u,new Int32Array(r.shape));break;default:break}if(e.outShapeStridesLocation){const n=i["util"].computeStrides(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(n));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(n));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(n));break;default:break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a&&e.program.customUniforms.forEach((n,r)=>{const i=e.customUniformLocations[r],o=a[r];if("float"===n.type)t.gl.uniform1fv(i,o);else if("vec2"===n.type)t.gl.uniform2fv(i,o);else if("vec3"===n.type)t.gl.uniform3fv(i,o);else if("vec4"===n.type)t.gl.uniform4fv(i,o);else if("int"===n.type)t.gl.uniform1iv(i,o);else if("ivec2"===n.type)t.gl.uniform2iv(i,o);else if("ivec3"===n.type)t.gl.uniform3iv(i,o);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);t.gl.uniform4iv(i,o)}}),t.executeProgram()}function Ce(t,e,n){let r="";e.concat(n).forEach(e=>{const a=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!e.isUniform){const o=e.texData.texShape,{useSqueezeShape:s,uniformShape:u,keptDims:c}=ve(t.packedInputs,e.shape,o);let l="",d="",h="";if(1===u.length&&t.packedInputs){const t=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];l=`${t[0]>1}_${t[1]>1}`}else if(2!==u.length||t.packedInputs){if(u.length>2&&!t.packedInputs){const t=i["util"].computeStrides(u);h=`${t[0]===o[1]}_${t[t.length-1]===o[1]}`}}else d=`${u[0]>1}_${u[1]>1}`;const p=e.shape.length,f=2===u.length&&i["util"].arraysEqual(e.shape,o),m=1===i["util"].sizeFromShape(e.shape),g=i["backend_util"].getBroadcastDims(e.shape,n.shape),b=!t.packedInputs&&p===n.shape.length&&i["util"].arraysEqual(o,n.texData.texShape),y=t.packedInputs||u.length>2?"":`${o[0]>1}_${o[1]>1}`;r+=`${p}_${b}_${s?c:""}_${u.length}_${m}_${g}_${f}_${l}_${d}_${h}_${y}_${a}`}else{const t=e.isUniform?"uniform":e.texData.texShape;r+=`${e.shape}_${t}_${a}`}});const a=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+a+Object(i["env"])().getNumber("WEBGL_VERSION"),o}function Te(t){return Object(i["env"])().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ie{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=h.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=kt();this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Ot(["r","c","d"],t):St(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ne{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=h.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const e=kt();this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Ot(["r","c","d"],t):St(["r","c","d"],t)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ee{constructor(t){this.variableNames=["A"],this.outTexUsage=p.DOWNLOAD;const e=kt();this.outputShape=t,this.userCode=`\n      ${Nt}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ae{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=p.DOWNLOAD;const e=kt();this.outputShape=t,this.userCode=`\n      ${Nt}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${e.output} = encode_float(x);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Re{constructor(t,e=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=kt();this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length);let r="result";e&&(r="floor(result * 255. + 0.5)"),this.userCode=`\n      ${this.enableShapeUniforms?It():Tt(t)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / texShape[1];\n        int c = imod(flatIndex, texShape[1]);\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n        vec4 values = ${n.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${n.output} = vec4(${r}, 0., 0., 0.);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class je{constructor(t,e=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=kt();this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length);let r="",a="result";e&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let e=0;e<=1;e++){const a=2*i+e;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${e} < ${this.enableShapeUniforms?"outShape[2]":""+t[2]}) {\n          localCoords[2] += ${e};\n          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":""+t[1]}) {\n            localCoords[1] += ${i};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${a}] = values[0];\n            } else if (offset == 1) {\n              result[${a}] = values[1];\n            } else if (offset == 2) {\n              result[${a}] = values[2];\n            } else {\n              result[${a}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?It():Tt(t)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${a};\n        }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function De(t){const e=kt(),n=`${e.version}\n    precision highp float;\n    ${e.attribute} vec3 clipSpacePos;\n    ${e.attribute} vec2 uv;\n    ${e.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`;return I(t,n)}function Fe(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return F(t,e)}function Me(t){const e=new Uint16Array([0,1,2,2,1,3]);return M(t,e)}function Pe(t,e,n,r,a,o){L(e,n);const s=$(t),u=t.TEXTURE_2D;return w(t,()=>t.bindTexture(u,s)),w(t,()=>t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),w(t,()=>t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),w(t,()=>t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)),w(t,()=>t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)),1===Object(i["env"])().getNumber("WEBGL_VERSION")?w(t,()=>t.texImage2D(u,0,r,e,n,0,a,o,null)):w(t,()=>t.texStorage2D(u,1,r,e,n)),w(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:s,texShape:[n,e]}}function $e(t){return t.internalFormatFloat}function Le(t,e,n,r){const[a,i]=m(e,n);return Pe(t,a,i,$e(r),r.textureFormatFloat,t.FLOAT)}function Be(t){return t.internalFormatHalfFloat}function ze(t,e,n,r){const[a,i]=m(e,n);return Pe(t,a,i,Be(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function We(t){return t.downloadTextureFormat}function Ve(t,e,n,r){const[a,i]=m(e,n);return Pe(t,a,i,We(r),t.RGBA,t.UNSIGNED_BYTE)}function Ue(t){return t.internalFormatPackedFloat}function Ge(t,e,n,r){const[a,i]=y(e,n);return Pe(t,a,i,Ue(r),t.RGBA,t.FLOAT)}function He(t){return t.internalFormatPackedHalfFloat}function qe(t,e,n,r){const[a,i]=y(e,n);return Pe(t,a,i,He(r),t.RGBA,r.textureTypeHalfFloat)}function Ke(t,e,n){const r=0,a=12,i=20;w(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n));const o=z(t,e,"clipSpacePos",n,3,i,r);return o&&z(t,e,"uv",n,2,i,a)}function Xe(t,e,n,r,a,o){let s,u,c;w(t,()=>t.bindTexture(t.TEXTURE_2D,e)),a instanceof Uint8Array?(s=new Uint8Array(n*r*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(n*r*4),u=t.FLOAT,c=o.internalFormatPackedFloat),s.set(a),2===Object(i["env"])().getNumber("WEBGL_VERSION")?w(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,u,s)):w(t,()=>t.texImage2D(t.TEXTURE_2D,0,c,n,r,0,t.RGBA,u,s)),w(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Ye(t,e,n){w(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?2===Object(i["env"])().getNumber("WEBGL_VERSION")?w(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):w(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):2===Object(i["env"])().getNumber("WEBGL_VERSION")?w(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):w(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),w(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Je(t,e,n,r){const a=t.createBuffer();w(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const i=4,o=4,s=i*o*e*n;return w(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,s,t.STREAM_READ)),w(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),w(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function Ze(t,e,n){const r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function Qe(t,e,n,r){const[a,i]=m(e,n),o=4,s=new Uint8Array(g(e*n,o));return w(t,()=>t.readPixels(0,0,a,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function tn(t,e,n,r,a,i,o,s){const u=t,c=new Float32Array(v(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function en(t,e,n){const r=new Float32Array(e*n*4);return w(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nn{constructor(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const e=Object(i["env"])().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,u(e,t)):this.gl=c(e);let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===Object(i["env"])().getNumber("WEBGL_VERSION")){const t="OES_texture_float",e="OES_texture_half_float";if(this.textureFloatExtension=T(this.gl,t),pt(this.gl,e))this.textureHalfFloatExtension=T(this.gl,e);else if(Object(i["env"])().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),pt(this.gl,r))this.colorBufferHalfFloatExtension=T(this.gl,r);else if(Object(i["env"])().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",pt(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!pt(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=Fe(this.gl),this.indexBuffer=Me(this.gl),this.framebuffer=B(this.gl),this.textureConfig=x(this.gl,this.textureHalfFloatExtension)}get debug(){return Object(i["env"])().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const t=this.gl;w(t,()=>t.finish()),w(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),w(t,()=>t.deleteFramebuffer(this.framebuffer)),w(t,()=>t.bindBuffer(t.ARRAY_BUFFER,null)),w(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)),w(t,()=>t.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(t,e){return this.throwIfDisposed(),Le(this.gl,t,e,this.textureConfig)}createFloat16MatrixTexture(t,e){return this.throwIfDisposed(),ze(this.gl,t,e,this.textureConfig)}createUnsignedBytesMatrixTexture(t,e){return this.throwIfDisposed(),Ve(this.gl,t,e,this.textureConfig)}uploadPixelDataToTexture(t,e){this.throwIfDisposed(),Ye(this.gl,t,e)}uploadDenseMatrixToTexture(t,e,n,r){this.throwIfDisposed(),Xe(this.gl,t,e,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(t,e){return this.throwIfDisposed(),qe(this.gl,t,e,this.textureConfig)}createPackedMatrixTexture(t,e){return this.throwIfDisposed(),Ge(this.gl,t,e,this.textureConfig)}deleteMatrixTexture(t){this.throwIfDisposed(),this.outputTexture===t&&(X(this.gl,this.framebuffer),this.outputTexture=null),w(this.gl,()=>this.gl.deleteTexture(t))}downloadByteEncodedFloatMatrixFromOutputTexture(t,e,n){return this.downloadMatrixDriver(t,()=>Qe(this.gl,e,n,this.textureConfig))}downloadPackedMatrixFromBuffer(t,e,n,r,a,i){return tn(this.gl,t,e,n,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(t,e){return Ze(this.gl,t,e)}createBufferFromTexture(t,e,n){this.bindTextureToFrameBuffer(t);const r=Je(this.gl,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const t=this.createFence(this.gl);return this.pollFence(t)}createFence(t){let e,n;if(Object(i["env"])().getBool("WEBGL_FENCE_API_ENABLED")){const r=t,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=()=>{const t=r.clientWaitSync(a,0,0);return t===r.ALREADY_SIGNALED||t===r.CONDITION_SATISFIED},e=a}else Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(e,Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:e,isFencePassed:n}}downloadMatrixFromPackedTexture(t,e,n){return this.downloadMatrixDriver(t,()=>en(this.gl,e,n))}createProgram(t){this.throwIfDisposed();const e=this.gl;null==this.vertexShader&&(this.vertexShader=De(e));const n=R(e);return w(e,()=>e.attachShader(n,this.vertexShader)),w(e,()=>e.attachShader(n,t)),j(e,n),this.debug&&D(e,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=Ke(e,this.program,this.vertexBuffer)),n}deleteProgram(t){this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&w(this.gl,()=>this.gl.deleteProgram(t))}setProgram(t){this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&D(this.gl,this.program),w(this.gl,()=>this.gl.useProgram(t))}getUniformLocation(t,e,n=!0){return this.throwIfDisposed(),n?U(this.gl,t,e):G(this.gl,t,e)}getAttributeLocation(t,e){return this.throwIfDisposed(),w(this.gl,()=>this.gl.getAttribLocation(t,e))}getUniformLocationNoThrow(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)}setInputMatrixTexture(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),H(this.gl,t,e,n)}setOutputMatrixTexture(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)}setOutputPackedMatrixTexture(t,e,n){this.throwIfDisposed();const[r,a]=y(e,n);this.setOutputMatrixTextureDriver(t,r,a)}setOutputMatrixWriteRegion(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)}setOutputPackedMatrixWriteRegion(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&D(this.gl,this.program),Y(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const t=this.gl;this.debug&&this.debugValidate(),w(t,()=>t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),w(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=T(this.gl,2===Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}const t=this.getQueryTimerExtensionWebGL1(),e=t.createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,e),e}endQuery(){if(2===Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const t=this.gl,e=this.getQueryTimerExtensionWebGL2();return void t.endQuery(e.TIME_ELAPSED_EXT)}const t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(t){return await i["util"].repeatedTry(()=>this.disposed||this.isQueryAvailable(t,Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(t,Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(t,e){if(0===e)return null;if(2===e){const e=this.gl,n=e.getQueryParameter(t,e.QUERY_RESULT);return n/1e6}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_EXT);return n/1e6}}isQueryAvailable(t,e){if(0===e)return!0;if(2===e){const e=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=e.getQueryParameter(t,e.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const e=this.getQueryTimerExtensionWebGL1(),n=e.getQueryObjectEXT(t,e.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(e.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(t){return new Promise(e=>{this.addItemToPoll(()=>t.isFencePassed(),()=>e())})}pollItems(){const t=rn(this.itemsToPoll.map(t=>t.isDoneFn));for(let e=0;e<=t;++e){const{resolveFn:t}=this.itemsToPoll[e];t()}this.itemsToPoll=this.itemsToPoll.slice(t+1)}addItemToPoll(t,e){if(this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1)return;let n=void 0;"setTimeoutCustom"in Object(i["env"])().platform&&(n=Object(i["env"])().platform.setTimeoutCustom.bind(Object(i["env"])().platform)),i["util"].repeatedTry(()=>(this.pollItems(),0===this.itemsToPoll.length),()=>0,null,n)}bindTextureToFrameBuffer(t){this.throwIfDisposed(),K(this.gl,t,this.framebuffer),this.debug&&Y(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(K(this.gl,this.outputTexture,this.framebuffer),this.debug&&Y(this.gl)):X(this.gl,this.framebuffer)}downloadMatrixDriver(t,e){this.bindTextureToFrameBuffer(t);const n=e();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(t,e,n){this.throwIfDisposed();const r=this.gl;K(r,t,this.framebuffer),this.debug&&Y(r),this.outputTexture=t,w(r,()=>r.viewport(0,0,e,n)),w(r,()=>r.scissor(0,0,e,n))}setOutputMatrixWriteRegionDriver(t,e,n,r){this.throwIfDisposed(),w(this.gl,()=>this.gl.scissor(t,e,n,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function rn(t){let e=0;for(;e<t.length;++e){const n=t[e]();if(!n)break}return e-1}var an=n("15e3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:on,bincountImpl:sn,bincountReduceImpl:un,castImpl:cn,ceilImpl:ln,concatImpl:dn,equalImpl:hn,expImpl:pn,expm1Impl:fn,floorImpl:mn,gatherNdImpl:gn,gatherV2Impl:bn,greaterImpl:yn,greaterEqualImpl:vn,lessImpl:xn,lessEqualImpl:wn,linSpaceImpl:kn,logImpl:Sn,maxImpl:On,maximumImpl:_n,minimumImpl:Cn,multiplyImpl:Tn,negImpl:In,notEqualImpl:Nn,prodImpl:En,raggedGatherImpl:An,raggedTensorToTensorImpl:Rn,rangeImpl:jn,rsqrtImpl:Dn,scatterImpl:Fn,sigmoidImpl:Mn,simpleAbsImpl:Pn,sliceImpl:$n,sparseFillEmptyRowsImpl:Ln,sparseReshapeImpl:Bn,sparseSegmentReductionImpl:zn,sqrtImpl:Wn,stridedSliceImpl:Vn,stringNGramsImpl:Un,stringSplitImpl:Gn,stringToHashBucketFastImpl:Hn,subImpl:qn,tileImpl:Kn,topKImpl:Xn,transposeImpl:Yn,uniqueImpl:Jn}=an;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t,e){return["x","y","z","w","u","v"].slice(0,e).map(e=>`${t}.${e}`)}function Qn(t,e){return 1===e?[t]:Zn(t,e)}function tr(t,e){if(1===t)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class er{constructor(t){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.enableShapeUniforms=Te(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const t=Qn("rc",this.rank),e=ye(this.rank),n=this.getOutOfBoundsCondition(t),r=this.getSetup(t),a=this.getOutput(t);this.userCode=`\n        void main() {\n          ${e} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${a}));\n          }\n        }\n      `}}getSourceCoordsArr(t){const e=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let a=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let e=2;e<this.rank;e++)a=t[t.length-1-e]+","+a;e.push(a)}return e}getOutOfBoundsCondition(t){if(1===this.rank)return"rc > "+(this.enableShapeUniforms?"outShape":this.outputShape[0]);let e="";for(let n=this.rank-2;n<this.rank;n++)e+=`${t[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(e+="||");return e}getSetup(t){if(1===this.rank)return"";const e=t.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${e[0]};\n      int c = ${e[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(t){const e=this.getSourceCoordsArr(t);if(1===this.rank){const t=this.enableShapeUniforms?"outShape":this.outputShape[0];return`getA(rc), (rc + 1 >= ${t} ? 0. : getA(rc + 1)), 0, 0`}return`getA(${e[0]}),\n            cEdge ? 0. : getA(${e[1]}),\n            rEdge ? 0. : getA(${e[2]}),\n            rEdge || cEdge ? 0. : getA(${e[3]})`}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nr{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length);let n="";for(let r=0;r<4;r++){let t="thisRC = rc;";r%2===1&&(t+="thisRC.z += 1;"),r>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${r}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${r>0?"}":""}\n      `}this.userCode=`\n      ${rr(e,this.enableShapeUniforms)}\n      ${this.enableShapeUniforms?It():Tt(t)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":t[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":t[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}function rr(t,e){const n=e?Ct(["r","c","d"],"inputShape"):St(["r","c","d"],t);return`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ar{constructor(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(t,e,n){const r=cr(e,n),a=lr(t,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=or(t,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const t=this.freeTextures[a].shift();return this.usedTextures[a].push(t),t}let o;return r===f.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):r===f.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):r===f.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):r===f.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):r===f.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}releaseTexture(t,e,n,r){if(null==this.freeTextures)return;const a=cr(n,r),o=lr(e,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);const s=or(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=Object(i["env"])().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(t.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(t),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const c=this.usedTextures[o],l=c.indexOf(t);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(l,1),this.log()}log(){if(!this.logEnabled)return;const t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${t})`);const e=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: "+this._numBytesAllocated),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*e)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const t in this.freeTextures)this.freeTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const t in this.usedTextures)this.usedTextures[t].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function ir(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error("Unknown internal format "+e)}function or(t,e,n,r,a){const i=sr(e,r);let o;if(a){const[e,n]=y(t[0],t[1]);o=e*n}else{const[e,n]=m(t[0],t[1]);o=e*n}const s=ir(n,i);return o*s}function sr(t,e){switch(t){case f.PACKED_2X2_FLOAT32:return Ue(e);case f.PACKED_2X2_FLOAT16:return He(e);case f.UNPACKED_FLOAT32:return $e(e);case f.UNPACKED_FLOAT16:return Be(e);case f.PACKED_4X1_UNSIGNED_BYTE:return We(e);default:throw new Error("Unknown physical texture type "+t)}}function ur(t){return Object(i["env"])().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?f.PACKED_2X2_FLOAT32:f.UNPACKED_FLOAT32:t?f.PACKED_2X2_FLOAT16:f.UNPACKED_FLOAT16}function cr(t,e){if(t===p.UPLOAD)return f.PACKED_2X2_FLOAT32;if(t===p.RENDER||null==t)return ur(e);if(t===p.DOWNLOAD||t===p.PIXELS)return f.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function lr(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dr{constructor(t,e){this.variableNames=["A"],this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${e}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const hr="if (isnan(x)) return x;",pr="return x;",fr="return abs(x);";const mr="return (x >= 0.0) ? x : (exp(x) - 1.0);",gr=hr+"\n  return (x < 0.0) ? 0.0 : x;\n",br=hr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",yr="return x;",vr="return 1.0 / (1.0 + exp(-1.0 * x));",xr="return x;",wr="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kr="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Sr="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Or="return 1.0 / (1.0 + exp(-1.0 * x));";class _r{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${e}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cr{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length);const e=t.length,n=Qn("rc",e),r=ye(e),a=tr(e,n),i=n.slice(-2),o=e<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${a});\n\n        setOutput(getChannel(packedInput, ${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tr=i["kernel_impls"].whereImpl,Ir=1e-7,Nr=1e-4,Er={};function Ar(t){return t in Er||(Er[t]={}),Er[t]}const Rr=Object(i["env"])().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),jr=600;function Dr(){return null==Object(i["env"])().global.screen?1024:Object(i["env"])().global.screen.height*Object(i["env"])().global.screen.width*window.devicePixelRatio*jr/1024/1024}class Fr extends i["KernelBackend"]{constructor(t){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Object(i["env"])().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let e;if(null!=t){if(t instanceof nn)e=t;else{const n=c(Object(i["env"])().getNumber("WEBGL_VERSION"),t);e=new nn(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const t=c(Object(i["env"])().getNumber("WEBGL_VERSION"));e=new nn(t),this.binaryCache=Ar(Object(i["env"])().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=e,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new ar(this.gpgpu),this.numMBBeforeWarning=Dr(),this.texData=new i["DataStorage"](this,Object(i["engine"])())}nextDataId(){return Fr.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(t,e,n){if((Object(i["env"])().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(i["env"])().getBool("DEBUG"))&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:p.UPLOAD,refCount:1}),r}refCount(t){if(this.texData.has(t)){const e=this.texData.get(t);return e.refCount}return 0}incRef(t){const e=this.texData.get(t);e.refCount++}decRef(t){if(this.texData.has(t)){const e=this.texData.get(t);e.refCount--}}move(t,e,n,r,a){if(Object(i["env"])().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:p.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}readSync(t){const e=this.texData.get(t),{values:n,dtype:r,complexTensorInfos:a,slice:o,shape:s,isPacked:u}=e;if(null!=o){let e;e=u?new _r(s,yr):new dr(s,yr);const n=this.runWebGLProgram(e,[{dataId:t,shape:s,dtype:r}],r),a=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;const c=null!=this.activeTimers;let l,d;if(c&&(l=i["util"].now()),"complex64"===r){const t=this.readSync(a.real.dataId),e=this.readSync(a.imag.dataId);d=i["backend_util"].mergeRealAndImagArrays(t,e)}else d=this.getValuesFromTexture(t);return c&&(this.downloadWaitMs+=i["util"].now()-l),this.convertAndCacheOnCPU(t,d)}async read(t){if(this.pendingRead.has(t)){const e=this.pendingRead.get(t);return new Promise(t=>e.push(t))}const e=this.texData.get(t),{values:n,shape:r,slice:a,dtype:o,complexTensorInfos:s,isPacked:u}=e;if(null!=a){let e;e=u?new _r(r,yr):new dr(r,yr);const n=this.runWebGLProgram(e,[{dataId:t,shape:r,dtype:o}],o),a=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),a}if(null!=n)return this.convertAndCacheOnCPU(t);if(Object(i["env"])().getBool("DEBUG")&&!Object(i["env"])().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===Object(i["env"])().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,l,d=null;if("complex64"!==o&&Object(i["env"])().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(t);const e=this.texData.get(c.dataId);d=this.gpgpu.createBufferFromTexture(e.texture.texture,...b(r))}if(this.pendingRead.set(t,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const t=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),e=t[0],n=t[1];l=i["backend_util"].mergeRealAndImagArrays(e,n)}else if(null==d)l=this.getValuesFromTexture(t);else{const t=i["util"].sizeFromShape(r);l=this.gpgpu.downloadFloat32MatrixFromBuffer(d,t)}if(null!=c&&this.disposeIntermediateTensorInfo(c),null!=d){const t=this.gpgpu.gl;w(t,()=>t.deleteBuffer(d))}const h=this.convertAndCacheOnCPU(t,l),p=this.pendingRead.get(t);return this.pendingRead.delete(t),p.forEach(t=>t(h)),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Object(i["engine"])().removeDataId(t,this),this.pendingDeletes--),h}readToGPU(t,e={}){const n=this.texData.get(t),{values:r,shape:a,slice:o,dtype:s,isPacked:u,texture:c}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=u?new _r(a,yr):new dr(a,yr);const r=this.runWebGLProgram(n,[{dataId:t,shape:a,dtype:s}],s),i=this.readToGPU(r,e);return this.disposeIntermediateTensorInfo(r),i}if(null==c)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(t,e.customTexShape),d=Object(i["engine"])().makeTensorFromTensorInfo(l),h=this.texData.get(l.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map(t=>i["util"].decodeString(t));return Object(i["buffer"])(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(i["buffer"])(t.shape,t.dtype,e)}checkNumericalProblems(t){if(null!=t)for(let e=0;e<t.length;e++){const n=t[e];if(!_(n)){if(Object(i["env"])().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(t){const{shape:e,dtype:n,isPacked:r}=this.texData.get(t),a=i["util"].sizeFromShape(e);if(Object(i["env"])().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(t),r=this.texData.get(n.dataId),i=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...b(e)).subarray(0,a);return this.disposeIntermediateTensorInfo(n),i}const o=Object(i["env"])().getBool("WEBGL_PACK")&&!0===r,s=o?nt(e):e,u=o?new Ae(s):new Ee(s),c=this.runWebGLProgram(u,[{shape:s,dtype:n,dataId:t}],"float32"),l=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(t){const e=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t();const a=i["util"].flatten(this.activeTimers.map(t=>t.query)).filter(t=>null!=t),o=i["util"].flatten(this.activeTimers.map(t=>t.name)).filter(t=>null!=t);this.activeTimers=e,r&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const t=await Promise.all(a);s["kernelMs"]=i["util"].sum(t),s["getExtraProfileInfo"]=()=>t.map((t,e)=>({name:o[e],ms:t})).map(t=>`${t.name}: ${t.ms}`).join(", ")}else s["kernelMs"]={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:i["util"].now(),endMs:null}}endTimer(t){return Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=i["util"].now(),t)}async getQueryTime(t){if(Object(i["env"])().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(t);const e=t;return e.endMs-e.startMs}disposeData(t,e=!1){if(this.pendingDisposal.has(t))return!1;if(!this.texData.has(t))return!0;if(e?this.texData.get(t).refCount=0:this.texData.get(t).refCount--,!e&&this.texData.get(t).refCount>0)return!1;if(this.pendingRead.has(t))return this.pendingDisposal.add(t),this.pendingDeletes++,!1;this.releaseGPUData(t);const{complexTensorInfos:n}=this.texData.get(t);return null!=n&&(this.disposeData(n.real.dataId,e),this.disposeData(n.imag.dataId,e)),this.texData.delete(t),!0}releaseGPUData(t){const{texture:e,dtype:n,texShape:r,usage:a,isPacked:i,slice:o}=this.texData.get(t),s=o&&o.origDataId||t,u=this.dataRefCount.get(s);u>1?this.dataRefCount.set(s,u-1):(this.dataRefCount.delete(s),null!=e&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(e,r,a,i)));const c=this.texData.get(t);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(t){return this.uploadToGPU(t),this.texData.get(t).texture.texture}getDataInfo(t){return this.texData.get(t)}shouldExecuteOnCPU(t,e=Rr){return Object(i["env"])().getBool("WEBGL_CPU_FORWARD")&&t.every(t=>null==this.texData.get(t.dataId).texture&&i["util"].sizeFromShape(t.shape)<e)}getGPGPUContext(){return this.gpgpu}where(t){i["backend_util"].warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const e=t.dataSync();return Tr(t.shape,e)}packedUnaryOp(t,e,n){const r=new _r(t.shape,e),a=this.compileAndRun(r,[t],n);return Object(i["engine"])().makeTensorFromTensorInfo(a)}abs(t){if(this.shouldExecuteOnCPU([t])&&"complex64"!==t.dtype){const e=Pn(this.texData.get(t.dataId).values);return this.makeOutput(t.shape,t.dtype,e)}if(Object(i["env"])().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,fr,t.dtype);const e=new dr(t.shape,fr),n=this.compileAndRun(e,[t]);return Object(i["engine"])().makeTensorFromTensorInfo(n)}makeTensorInfo(t,e,n){let r;if("string"===e&&null!=n&&n.length>0&&i["util"].isString(n[0])){const a=n.map(t=>i["util"].encodeString(t));r=this.write(a,t,e)}else r=this.write(n,t,e);return this.texData.get(r).usage=null,{dataId:r,shape:t,dtype:e}}makeOutput(t,e,n){return Object(i["engine"])().makeTensorFromTensorInfo(this.makeTensorInfo(t,e,n),this)}unpackTensor(t){const e=new Cr(t.shape);return this.runWebGLProgram(e,[t],t.dtype)}packTensor(t){const e=new er(t.shape),n=!0;return this.runWebGLProgram(e,[t],t.dtype,null,n)}packedReshape(t,e){const n=[tt(t.shape),...et(t.shape)],r={dtype:t.dtype,shape:n,dataId:t.dataId},a=[tt(e),...et(e)],i=new nr(a,n),o=!0,s=[n],u=this.runWebGLProgram(i,[r],t.dtype,s,o);return{dataId:u.dataId,shape:e,dtype:u.dtype}}decode(t,e){const n=this.texData.get(t),{isPacked:r,shape:a,dtype:o}=n;if(null!=e){const t=i["util"].sizeFromShape(a),n=e[0]*e[1]*4;i["util"].assert(t<=n,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const s=nt(a);let u;u=r?new Ne(s):new Ie(s);const c=!0,l=[null!=e?e:b(s)],d=this.runWebGLProgram(u,[{shape:s,dtype:o,dataId:t}],o,l,c,e);return{dtype:o,shape:a,dataId:d.dataId}}runWebGLProgram(t,e,n,r,a=!1,o){const s=this.makeTensorInfo(t.outputShape,n),u=this.texData.get(s.dataId);if(t.packedOutput&&(u.isPacked=!0),t.outPackingScheme===h.DENSE){const e=null!=o?o:b(t.outputShape);u.texShape=e.map(t=>2*t)}if(null!=t.outTexUsage&&(u.usage=t.outTexUsage),0===i["util"].sizeFromShape(s.shape))return u.values=i["util"].getTypedArrayFromDType(s.dtype,0),s;const c=[],l=e.map(e=>{if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&i["util"].sizeFromShape(e.shape)<=Object(i["env"])().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}if(this.uploadToGPU(e.dataId),!!n.isPacked!==!!t.packedInputs)e=n.isPacked?this.unpackTensor(e):this.packTensor(e),c.push(e),n=this.texData.get(e.dataId);else if(n.isPacked&&!it(n.shape,e.shape)){const t=e,r=e.shape;e.shape=n.shape,e=this.packedReshape(e,r),c.push(e),n=this.texData.get(e.dataId),t.shape=r}return{shape:e.shape,texData:n,isUniform:!1}});this.uploadToGPU(s.dataId);const d={shape:s.shape,texData:u,isUniform:!1},p=Ce(t,l,d),f=this.getAndSaveBinary(p,()=>ke(this.gpgpu,t,l,d)),m=null!=this.activeTimers;let g;m&&(g=this.startTimer()),Object(i["env"])().get("ENGINE_COMPILE_ONLY")||_e(this.gpgpu,f,l,d,r),c.forEach(t=>this.disposeIntermediateTensorInfo(t)),m&&(g=this.endTimer(g),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(g)}));const y=Object(i["env"])().get("WEBGL_FLUSH_THRESHOLD");if(y>0){const t=i["util"].now();t-this.lastGlFlushTime>y&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=t)}if(!Object(i["env"])().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===a){const t=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),t}return s}compileAndRun(t,e,n,r,a=!1){n=n||e[0].dtype;const i=this.runWebGLProgram(t,e,n,r,a);return i}getAndSaveBinary(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]}getTextureManager(){return this.textureManager}dispose(){if(!this.disposed){if(!Object(i["env"])().getBool("IS_TEST")){const t=Object.keys(this.binaryCache);t.forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]})}this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(i["tidy"])(()=>{if(!Object(i["env"])().get("WEBGL_RENDER_FLOAT32_ENABLED")){const t=Object(i["env"])().getBool("DEBUG");Object(i["env"])().set("DEBUG",!1);const e=this.abs(Object(i["scalar"])(1e-8)).dataSync()[0];if(Object(i["env"])().set("DEBUG",t),e>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?Ir:Nr}uploadToGPU(t){const e=this.texData.get(t),{shape:n,dtype:r,values:a,texture:o,usage:s,isPacked:u}=e;if(null!=o)return;const c=null!=this.activeTimers;let l;c&&(l=i["util"].now());let d=e.texShape;if(null==d&&(d=rt(n,u),e.texShape=d),null!=a){const t=nt(n);let o,s=d[1],h=d[0];const f=a instanceof Uint8Array||a instanceof Uint8ClampedArray;!u&&f||([s,h]=y(d[0],d[1])),o=u?new je(t,f):new Re(t,f);const m=f?[h,s]:d,g=this.makeTensorInfo(m,r),b=this.texData.get(g.dataId);b.usage=f?p.PIXELS:p.UPLOAD,b.texShape=m,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),s,h,a);const v=[[h,s]],x=!0,w=this.runWebGLProgram(o,[g],r,v,x),k=this.texData.get(w.dataId);e.texShape=k.texShape,e.isPacked=k.isPacked,e.usage=k.usage,Object(i["env"])().get("ENGINE_COMPILE_ONLY")?this.disposeData(w.dataId):(e.texture=k.texture,e.values=null,this.texData.delete(w.dataId)),this.disposeIntermediateTensorInfo(g),c&&(this.uploadWaitMs+=i["util"].now()-l)}else{const t=this.acquireTexture(d,s,r,u);e.texture=t}}convertAndCacheOnCPU(t,e){const n=this.texData.get(t),{dtype:r}=n;return this.releaseGPUData(t),null!=e&&(n.values=Mr(e,r)),n.values}acquireTexture(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const t=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${t} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(t,e,r)}computeBytes(t,e){return t[0]*t[1]*i["util"].bytesPerElement(e)}checkCompileCompletion(){for(const[,t]of Object.entries(this.binaryCache))this.checkCompletion_(t)}async checkCompileCompletionAsync(){const t=[];if(this.gpgpu.parallelCompilationExtension){for(const[,e]of Object.entries(this.binaryCache))t.push(this.checkCompletionAsync_(e));return Promise.all(t)}for(const[,e]of Object.entries(this.binaryCache)){const n=new Promise(t=>{try{this.checkCompletion_(e),t(!0)}catch(n){throw n}});t.push(n)}return Promise.all(t)}async checkCompletionAsync_(t){return this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(t):(await Object(i["nextFrame"])(),this.checkCompletionAsync_(t))}checkCompletion_(t){if(!1===this.gpgpu.gl.getProgramParameter(t.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(t.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(t.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw A(t.source,this.gpgpu.gl.getShaderInfoLog(t.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const[,t]of Object.entries(this.binaryCache)){const{uniformLocations:e,customUniformLocations:n,infLoc:r,nanLoc:a,inShapesLocations:i,inTexShapesLocations:o,outShapeLocation:s,outShapeStridesLocation:u,outTexShapeLocation:c}=Se(this.gpgpu,t.program,t.webGLProgram);t.uniformLocations=e,t.customUniformLocations=n,t.infLoc=r,t.nanLoc=a,t.inShapesLocations=i,t.inTexShapesLocations=o,t.outShapeLocation=s,t.outShapeStridesLocation=u,t.outTexShapeLocation=c}}}function Mr(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){const n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length);for(let e=0;e<n.length;++e)n[e]=Math.round(t[e]);return n}throw new Error("Unknown dtype "+e)}
/** @license See the LICENSE file. */Fr.nextDataId=0;const Pr="3.21.0";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(){Object(i["env"])().set("WEBGL_FORCE_F16_TEXTURES",!0)}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */i["device_util"].isBrowser()&&Object(i["registerBackend"])("webgl",()=>new Fr,2);const Lr={forceHalfFloat:$r},Br="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zr{constructor(t,e,n){this.variableNames=["A","B"],this.outputShape=i["backend_util"].assertAndGetBroadcastShape(e,n),this.enableShapeUniforms=Te(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${t}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wr="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Vr{constructor(t,e,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i["backend_util"].assertAndGetBroadcastShape(e,n);const a=this.outputShape.length;this.enableShapeUniforms=Te(a);let o="";if(r)if(0===a||1===i["util"].sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{const t=ye(a);if(o=`\n          ${t} coords = getOutputCoords();\n        `,1===a)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const t=Qn("coords",a);this.enableShapeUniforms?o+=`\n            bool nextRowOutOfBounds =\n              (${t[a-2]} + 1) >= outShape[${a} - 2];\n            bool nextColOutOfBounds =\n              (${t[a-1]} + 1) >= outShape[${a} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:o+=`\n            bool nextRowOutOfBounds =\n              (${t[a-2]} + 1) >= ${this.outputShape[a-2]};\n            bool nextColOutOfBounds =\n              (${t[a-1]} + 1) >= ${this.outputShape[a-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${t}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ur(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Gr={kernelName:i["Identity"],backendName:"webgl",kernelFunc:Ur};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hr(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Ur({inputs:{x:r},backend:n}),u=Ur({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:u},i}const qr={kernelName:i["Complex"],backendName:"webgl",kernelFunc:Hr},Kr="return (a < 0.) ? b * a : a;",Xr="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yr(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:o}=r,s=n.makeTensorInfo([],"float32",i["util"].createScalarValue(o,"float32")),u=Object(i["env"])().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vr(Xr,a.shape,s.shape):new zr(Kr,a.shape,s.shape),c=n.runWebGLProgram(u,[a,s],"float32");return n.disposeIntermediateTensorInfo(s),c}const Jr={kernelName:i["LeakyRelu"],backendName:"webgl",kernelFunc:Yr},Zr="return (a < 0.) ? b * a : a;",Qr="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ta(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,o=Object(i["env"])().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vr(Qr,r.shape,a.shape):new zr(Zr,r.shape,a.shape);return n.runWebGLProgram(o,[r,a],"float32")}const ea={kernelName:i["Prelu"],backendName:"webgl",kernelFunc:ta},na="if (isnan(x)) return x;";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ra({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:o})=>{const{x:s}=a,u=o,c=r||s.dtype;if(u.shouldExecuteOnCPU([s])&&null!=n){const t=u.texData.get(s.dataId),e=n(t.values,c);return u.makeTensorInfo(s.shape,c,e)}const l=Object(i["env"])().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=e;let d;return d=l?new _r(s.shape,e):new dr(s.shape,t),u.runWebGLProgram(d,[s],c)}}function aa({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:o}){return({inputs:s,backend:u})=>{const{a:c,b:l}=s,d=u;if(r&&"complex64"===c.dtype){const e=d.texData.get(c.dataId),n=d.texData.get(l.dataId),[r,a]=[[e.complexTensorInfos.real,n.complexTensorInfos.real],[e.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(e=>{const[n,r]=e,a={dataId:n.dataId,dtype:n.dtype,shape:c.shape},o={dataId:r.dataId,dtype:r.dtype,shape:l.shape},s=new zr(t,c.shape,l.shape);return d.runWebGLProgram(s,[a,o],Object(i["upcastType"])(n.dtype,r.dtype))}),o=Hr({inputs:{real:r,imag:a},backend:d});return d.disposeIntermediateTensorInfo(r),d.disposeIntermediateTensorInfo(a),o}const h=o||Object(i["upcastType"])(c.dtype,l.dtype);if(("string"===c.dtype||"string"===l.dtype||d.shouldExecuteOnCPU([c,l]))&&null!=a){const t=d.texData.get(c.dataId).values,e=d.texData.get(l.dataId).values,n="string"===c.dtype?i["backend_util"].fromUint8ToStringArray(t):t,r="string"===c.dtype?i["backend_util"].fromUint8ToStringArray(e):e,[o,s]=a(c.shape,l.shape,n,r,h),u=d.makeTensorInfo(s,h),p=d.texData.get(u.dataId);return p.values=o,u}const p=Object(i["env"])().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=e;let f;return f=p?new Vr(e,c.shape,l.shape,n):new zr(t,c.shape,l.shape),d.runWebGLProgram(f,[c,l],h)}}function ia(t,e=!1){if("linear"===t)return e?xr:pr;if("relu"===t)return e?kr:gr;if("elu"===t)return e?wr:mr;if("relu6"===t)return e?Sr:br;if("prelu"===t)return e?Qr:Zr;if("leakyrelu"===t)return e?Xr:Kr;if("sigmoid"===t)return e?Or:vr;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oa{constructor(t,e,n,r=!1,a=!1,i=!1,o=null,s=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Te(this.outputShape.length);const c=r?t[1]:t[2],l=Math.ceil(c/2),d=r?"i * 2, rc.y":"rc.y, i * 2",h=a?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",g="";o&&(m=s?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${o}\n        }`:u?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${o}\n        }`:`vec4 activation(vec4 x) {\n          ${o}\n        }`,g="result = activation(result);");const b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let y="rc.x",v="rc.x";t[0]<e[0]?y=`int(min(float(rc.x), ${t[0]-1}.))`:e[0]<t[0]&&(v=`int(min(float(rc.x), ${e[0]-1}.))`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${l}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${l}; i++) {\n          int batchA = ${y};\n          int batchB = ${v};\n          vec4 a = getMatrixA(batchA, ${d});\n          vec4 b = getMatrixB(batchB, ${h});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${b}\n\n        ${g}\n\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sa={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class ua{constructor(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=i["backend_util"].assertAndGetBroadcastShape(e,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${t}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ca="return a * b;";function la(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,o=i["backend_util"].upcastType(r.dtype,a.dtype);if("complex64"===r.dtype){const t=n.texData.get(r.dataId),e=n.texData.get(a.dataId),i=new ua(sa.REAL,r.shape,a.shape),o=new ua(sa.IMAG,r.shape,a.shape),s=[{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:r.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:a.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:a.shape}],u=n.runWebGLProgram(i,s,"float32"),c=n.runWebGLProgram(o,s,"float32"),l=Hr({inputs:{real:u,imag:c},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}if(n.shouldExecuteOnCPU([r,a])){const t=n.texData.get(r.dataId),e=n.texData.get(a.dataId),[i,s]=Tn(r.shape,a.shape,t.values,e.values,o),u=n.makeTensorInfo(s,o),c=n.texData.get(u.dataId);return c.values=i,u}let s;return s=Object(i["env"])().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vr(ca,r.shape,a.shape):new zr(ca,r.shape,a.shape),n.runWebGLProgram(s,[r,a],o)}const da={kernelName:i["Multiply"],backendName:"webgl",kernelFunc:la};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ha(t,e,n){const r=[tt(t.shape),...et(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},i=[tt(e),...et(e)],o=new nr(i,r),s=!0,u=[r],c=n.runWebGLProgram(o,[a],t.dtype,u,s);return{dataId:c.dataId,shape:e,dtype:c.dtype}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pa(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:o}=r,s=n,u=i["util"].sizeFromShape(a.shape),c=i["util"].inferFromImplicitShape(o,u),l=i["util"].sizeFromShape(c);i["util"].assert(u===l,()=>`The new shape (${c}) has ${l} elements and the old shape (${a.shape}) has ${u} elements. The new shape and old shape must have the same number of elements.`);const d=s.texData.get(a.dataId);return!d.isPacked||it(a.shape,c)||null!==d.texture&&it(d.shape,c)?(s.incRef(a.dataId),{dataId:a.dataId,shape:c,dtype:a.dtype}):ha(a,c,s)}const fa={kernelName:i["Reshape"],backendName:"webgl",kernelFunc:pa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ma{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:o}=t;this.outputShape=[r,o];const s=4*Math.floor(n/4),u=n%4;let c="sumValue += dot(values, ones);";if(null!=e){const t=1/e;c=`sumValue += dot(values * ${i["util"].isInt(t)?t.toPrecision(2):t}, ones);`}let l="";a%n>0&&(l=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${l}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===u}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${c}\n        } else if (${2===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${c}\n        } else if (${3===u}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${c}\n        }\n        setOutput(sumValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ga{constructor(t,e){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:a,outSize:i}=t;this.outputShape=[r,i];let o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");let u=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");const c=4*Math.floor(n/4),l=n%4;let d=`\n      if (${"sum"===e}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===e}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${s}(values, minMaxValue);\n        if (${"min"===e} || ${"max"===e}) {\n          minMaxValue = ${s}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,h="vec4";"all"===e?(o="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===e&&(o="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";a%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${o};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${o});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${c}; i += 4) {\n          int inIdx = inOffset + i;\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${c};\n        if (${1===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${2===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${3===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${d}\n        }\n        setOutput(${u});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(t){const e=[];while(0===e.length||1!==e[e.length-1].outSize){const n=e.length?e[e.length-1].outSize:t[1],r=i["backend_util"].computeOptimalWindowSize(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function ya(t,e,n,r){const a=ba(t.shape);let i=t;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:u,outSize:c}=a[o];let l,d;l="mean"===n?0===o?new ma({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c},s):new ma({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c}):new ga({windowSize:u,inSize:s,batchSize:t.shape[0],outSize:c},n),d=i,i=r.runWebGLProgram(l,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class va{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[e[i]];this.outputShape=n,this.rank=n.length;const r=ye(this.rank),a=xa(e);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${a}));\n    }\n    `}}function xa(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wa{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(t.length);for(let c=0;c<n.length;c++)n[c]=t[e[c]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=ye(this.rank),a=Zn("rc",this.rank),i=new Array(this.rank);for(let c=0;c<e.length;c++)i[e[c]]=a[c];const o=`vec2(${i.slice(-2).join()})`,s=`++${a[this.rank-1]} < ${n[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${o})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${u};\n      if(${s}) {\n        result[1] = ${u};\n      }\n      --${a[this.rank-1]};\n      if(++${a[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${u};\n        if(${s}) {\n          result[3] = ${u};\n        }\n      }\n      setOutput(result);\n    }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ka(t,e,n){const r=Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new wa(t.shape,e):new va(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(t,e,n,r){const a=e,o=t.shape.length,s=i["util"].parseAxisParam(a,t.shape);let u=s;const c=i["backend_util"].getAxesPermutation(u,o),l=null!=c;let d=t;l&&(d=ka(t,c,r),u=i["backend_util"].getInnerMostAxes(u.length,o)),i["backend_util"].assertAxesAreInnerMostDims("sum",u,o);const[h,p]=i["backend_util"].computeOutAndReduceShapes(d.shape,u);let f=h;n&&(f=i["backend_util"].expandShapeToKeepDim(h,s));const m=i["util"].sizeFromShape(p),g=i["util"].sizeFromShape(t.shape),b=g/m,y=pa({inputs:{x:d},attrs:{shape:[b,m]},backend:r}),v=Object(i["sumOutType"])(t.dtype),x=ya(y,v,"sum",r),w=pa({inputs:{x:x},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),l&&r.disposeIntermediateTensorInfo(d),w}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;return Sa(a,i,o,n)}const _a={kernelName:i["Sum"],backendName:"webgl",kernelFunc:Oa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:i}=r,o=n,s=a.shape.length,u=new Array(s);for(let l=0;l<u.length;l++)u[l]=a.shape[i[l]];let c;if(o.shouldExecuteOnCPU([a])){const t=o.texData.get(a.dataId),e=t.values,n=Yn(e,a.shape,a.dtype,i,u);c=o.makeTensorInfo(u,a.dtype);const r=o.texData.get(c.dataId);r.values=n}else c=ka(a,i,o);return c}const Ta={kernelName:i["Transpose"],backendName:"webgl",kernelFunc:Ca},Ia=1e3;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na({a:t,b:e,transposeA:n,transposeB:r,backend:a,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:u=0,activation:c=null}){const l=t.shape.length,d=e.shape.length,h=n?t.shape[l-2]:t.shape[l-1],p=r?e.shape[d-1]:e.shape[d-2],f=n?t.shape[l-1]:t.shape[l-2],m=r?e.shape[d-2]:e.shape[d-1],g=t.shape.slice(0,-2),b=e.shape.slice(0,-2),y=i["util"].sizeFromShape(g),v=i["util"].sizeFromShape(b),x=i["broadcast_util"].assertAndGetBroadcastShape(t.shape.slice(0,-2),e.shape.slice(0,-2)),w=x.concat([f,m]);i["util"].assert(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const k=n?[y,h,f]:[y,f,h],S=r?[v,m,p]:[v,p,m],O=pa({inputs:{x:t},backend:a,attrs:{shape:k}}),_=pa({inputs:{x:e},backend:a,attrs:{shape:S}}),C=[O,_],T=Math.max(y,v),I=n?O.shape[1]:O.shape[2],N=null!=o,E=null!=s,A="leakyrelu"===c,R=null!=c?ia(c,!0):null,j=N||E||A||null!=R;let D;if((1===f||1===m)&&I>Ia&&!1===j){let t=O,e=_;n&&(t=Ca({inputs:{x:O},backend:a,attrs:{perm:[0,2,1]}}),C.push(t)),r&&(e=Ca({inputs:{x:_},backend:a,attrs:{perm:[0,2,1]}}),C.push(e));const i=1!==m,o=1===m;let s=t;i&&(s=pa({inputs:{x:t},backend:a,attrs:{shape:[T,I,1]}}),C.push(s));const u=1===m?2:1;let c=e;o&&(c=pa({inputs:{x:e},backend:a,attrs:{shape:[T,1,I]}}),C.push(c));const l=la({inputs:{a:s,b:c},backend:a});D=Oa({inputs:{x:l},backend:a,attrs:{axis:u,keepDims:!0}}),C.push(l)}else{const c=Object(i["upcastType"])(t.dtype,e.dtype),l=new oa(k,S,[T,f,m],n,r,N,R,E,A),d=[O,_];if(null!=o&&d.push(o),E&&d.push(s),A){const t=a.makeTensorInfo([],"float32",i["util"].createScalarValue(u,"float32"));d.push(t),C.push(t)}D=a.runWebGLProgram(l,d,c)}const F=pa({inputs:{x:D},backend:a,attrs:{shape:w}});C.push(D);for(const i of C)a.disposeIntermediateTensorInfo(i);return F}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r;return Na({a:a,b:i,transposeA:u,transposeB:c,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:l})}const Aa={kernelName:i["_FusedMatMul"],backendName:"webgl",kernelFunc:Ea},Ra="return abs(x);";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ja(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&"complex64"!==r.dtype){const t=n.texData.get(r.dataId),e=Pn(t.values);return n.makeTensorInfo(r.shape,r.dtype,e)}let a;return a=Object(i["env"])().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new _r(r.shape,Ra):new dr(r.shape,Ra),n.runWebGLProgram(a,[r],r.dtype)}const Da={kernelName:i["Abs"],backendName:"webgl",kernelFunc:ja},Fa=hr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",Ma=ra({opSnippet:Fa}),Pa={kernelName:i["Acos"],backendName:"webgl",kernelFunc:Ma},$a=hr+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));",La=ra({opSnippet:$a}),Ba={kernelName:i["Acosh"],backendName:"webgl",kernelFunc:La},za="return a + b;",Wa=aa({opSnippet:za,packedOpSnippet:za,supportsComplex:!0,cpuKernelImpl:on}),Va={kernelName:i["Add"],backendName:"webgl",kernelFunc:Wa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ua{constructor(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`float v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        float result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ga{constructor(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((t,e)=>"T"+e);const n=[];this.variableNames.forEach(t=>{n.push(`vec4 v${t} = get${t}AtOutCoords();`)});const r=this.variableNames.map(t=>"v"+t).join(" + ");this.userCode=`\n      void main() {\n        ${n.join("\n        ")}\n\n        vec4 result = ${r};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(t){const{inputs:e,backend:n}=t,r=e;if(1===r.length)return Ur({inputs:{x:r[0]},backend:n});if(r.length>Object(i["env"])().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(r.length/2),e=Ha({inputs:r.slice(0,t),backend:n}),a=Ha({inputs:r.slice(t),backend:n});return Ha({inputs:[e,a],backend:n})}const a=r.map(t=>t.dtype).reduce((t,e)=>Object(i["upcastType"])(t,e)),o=r.map(t=>t.shape),s=Object(i["env"])().getBool("WEBGL_PACK"),u=s?new Ga(r[0].shape,o):new Ua(r[0].shape,o);return n.runWebGLProgram(u,r,a)}const qa={kernelName:i["AddN"],backendName:"webgl",kernelFunc:Ha};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ka(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o,keepDims:s}=r,u=a.shape.length,c=i["util"].parseAxisParam(o,a.shape);let l=c;const d=i["backend_util"].getAxesPermutation(l,u);let h=a;null!=d&&(h=Ca({inputs:{x:a},backend:n,attrs:{perm:d}}),l=i["backend_util"].getInnerMostAxes(l.length,u)),i["backend_util"].assertAxesAreInnerMostDims("all",l,u);const[p,f]=i["backend_util"].computeOutAndReduceShapes(h.shape,l),m=i["util"].sizeFromShape(f),g=pa({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),b=ya(g,g.dtype,"all",n);let y;if(s){const t=i["backend_util"].expandShapeToKeepDim(p,c);y=pa({inputs:{x:b},backend:n,attrs:{shape:t}})}else y=pa({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),null!=d&&n.disposeIntermediateTensorInfo(h),y}const Xa={kernelName:i["All"],backendName:"webgl",kernelFunc:Ka};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ya(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o,keepDims:s}=r,u=a.shape.length,c=i["util"].parseAxisParam(o,a.shape);let l=c;const d=i["backend_util"].getAxesPermutation(l,u);let h=a;null!=d&&(h=Ca({inputs:{x:a},backend:n,attrs:{perm:d}}),l=i["backend_util"].getInnerMostAxes(l.length,u)),i["backend_util"].assertAxesAreInnerMostDims("any",l,u);const[p,f]=i["backend_util"].computeOutAndReduceShapes(h.shape,l),m=i["util"].sizeFromShape(f),g=pa({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),b=ya(g,g.dtype,"any",n);let y;if(s){const t=i["backend_util"].expandShapeToKeepDim(p,c);y=pa({inputs:{x:b},backend:n,attrs:{shape:t}})}else y=pa({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),null!=d&&n.disposeIntermediateTensorInfo(h),y}const Ja={kernelName:i["Any"],backendName:"webgl",kernelFunc:Ya};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Za{constructor(t,e,n){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=t;n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const o="max"===e?">":"<",s=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${s};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${o} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qa{constructor(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,i["util"].assert(t.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);const a=t[t.length-1],o=Math.ceil(a/e);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const s=this.outputShape,u=s.length,c=ye(u),l=Qn("coords",u);let d,h;if(1===o){h=u+1;const t=ye(h);d=`\n        ${t} sourceLocR = ${t}(${l.join()}, 0);\n        ++${l[u-1]};\n        ${t} sourceLocG = ${t}(${l.join()}, 0);\n        ++${l[u-2]};\n        ${t} sourceLocA = ${t}(${l.join()}, 0);\n        --${l[u-1]};\n        ${t} sourceLocB = ${t}(${l.join()}, 0);\n        --${l[u-2]};`}else h=u,d=`\n        ${c} sourceLocR = coords;\n        ++${l[u-1]};\n        ${c} sourceLocG = coords;\n        ++${l[u-2]};\n        ${c} sourceLocA = coords;\n        --${l[u-1]};\n        ${c} sourceLocB = coords;\n        --${l[u-2]};`;const p=["x","y","z","w","u","v"].slice(0,h),f="."+p[h-1],m=p.map(t=>"int "+t),g=Qn("sourceLocR",h-1).concat("inIdx.r"),b=Qn("sourceLocG",h-1).concat("inIdx.g"),y=Qn("sourceLocB",h-1).concat("inIdx.b"),v=Qn("sourceLocA",h-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${b.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,k=`vec4(\n            getAChannel(${g.join()}),\n            hasNextCol ? getAChannel(${b.join()}) : 0.,\n            hasNextRow ? getAChannel(${y.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,S=r?"":`\n      float getBestIndicesAChannel(${m.join()}) {\n        return getChannel(getBestIndicesA(${p.join()}),\n                                          vec2(${p.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${m.join()}) {\n        return getChannel(getA(${p.join()}),\n                               vec2(${p.slice(-2).join()}));\n      }\n      ${S}\n      void main() {\n        ${c} coords = getOutputCoords();\n        bool hasNextCol = ${l[u-1]} < ${s[u-1]-1};\n        bool hasNextRow = ${l[u-2]} < ${s[u-2]-1};\n        ${d}\n        ivec4 srcIdx = ivec4(sourceLocR${f}, sourceLocG${f},\n          sourceLocB${f}, sourceLocA${f}) * ${e};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${k};\n\n        for (int i = 0; i < ${e}; i++) {\n          inIdx = srcIdx;\n          ${w}\n          vec4 candidate = ${k};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${x}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(t,e,n,r=null){let a=e.shape[0],o=e.shape[1];null!=r&&(a=r.shape[0],o=r.shape[1]);const s=i["backend_util"].computeOptimalWindowSize(o),u={windowSize:s,inSize:o,batchSize:a,outSize:Math.ceil(o/s)},c=new Za(u,n,null==r),l=[e];null!=r&&l.push(r);const d=t.runWebGLProgram(c,l,"int32");if(1===d.shape[1])return d;const h=ti(t,e,n,d);return t.disposeIntermediateTensorInfo(d),h}function ei(t,e,n,r=null){const a=null!=r?r.shape:e.shape,o=a[a.length-1],s=i["backend_util"].computeOptimalWindowSize(o),u=new Qa(a,s,n,null==r),c=null==r?[e]:[e,r],l=t.runWebGLProgram(u,c,"int32");if(l.shape.length===e.shape.length){const r=ei(t,e,n,l);return t.disposeIntermediateTensorInfo(l),r}return l}function ni(t,e,n,r){const a=[n];if(i["backend_util"].assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!Object(i["env"])().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const n=[],o=t.texData.get(e.dataId),s=null!==o&&o.isPacked;let u=e;s&&(u=t.unpackTensor(e),n.push(u));const[c,l]=i["backend_util"].computeOutAndReduceShapes(u.shape,a),d=i["util"].sizeFromShape(l),h=pa({inputs:{x:u},backend:t,attrs:{shape:[-1,d]}});n.push(h);const p=ti(t,h,r);n.push(p);const f=pa({inputs:{x:p},backend:t,attrs:{shape:c}});return n.forEach(e=>t.disposeIntermediateTensorInfo(e)),f}return ei(t,e,r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ri(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o}=r;let s=i["util"].parseAxisParam(o,a.shape);const u=i["backend_util"].getAxesPermutation(s,a.shape.length);let c=a;const l=[];null!=u&&(c=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=i["backend_util"].getInnerMostAxes(s.length,c.shape.length)),i["backend_util"].assertAxesAreInnerMostDims("argMax",[s[0]],c.shape.length);const d=ni(n,c,s[0],"max");return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),d}const ai={kernelName:i["ArgMax"],backendName:"webgl",kernelFunc:ri};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o}=r;let s=i["util"].parseAxisParam(o,a.shape);const u=i["backend_util"].getAxesPermutation(s,a.shape.length);let c=a;const l=[];null!=u&&(c=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),l.push(c),s=i["backend_util"].getInnerMostAxes(s.length,c.shape.length)),i["backend_util"].assertAxesAreInnerMostDims("argMin",[s[0]],c.shape.length);const d=ni(n,c,s[0],"min");return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),d}const oi={kernelName:i["ArgMin"],backendName:"webgl",kernelFunc:ii},si=hr+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",ui=ra({opSnippet:si}),ci={kernelName:i["Asin"],backendName:"webgl",kernelFunc:ui},li=hr+"return log(x + sqrt(x * x + 1.0));",di=ra({opSnippet:li}),hi={kernelName:i["Asinh"],backendName:"webgl",kernelFunc:di},pi=hr+"\n  return atan(x);\n",fi=ra({opSnippet:pi}),mi={kernelName:i["Atan"],backendName:"webgl",kernelFunc:fi},gi=Br+"\n  return atan(a, b);\n",bi="\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Wr+"\n  return result;\n",yi=aa({opSnippet:gi,packedOpSnippet:bi}),vi={kernelName:i["Atan2"],backendName:"webgl",kernelFunc:yi},xi=hr+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;",wi=ra({opSnippet:xi}),ki={kernelName:i["Atanh"],backendName:"webgl",kernelFunc:wi};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Si{constructor(t,e,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;const f="avg"===e,m=`((batch  * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + d`,g=`(xR * ${t.inWidth} + xC) * ${t.inChannels} + d`;let b="0.0";if(f||(b="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${o}, ${s});\n        const ivec2 pads = ivec2(${h}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${l};\n              wR += ${u}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d};\n                wC += ${c}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${e} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?a?m:g:`wR * ${d} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}const y="max";let v=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(v="avgValue / count");const x=4*Math.floor(i/4),w=i%4,k=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ${y}(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${s});\n      const ivec2 pads = ivec2(${h}, ${p});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${l};\n            wR += ${u}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${x}; wC += 4) {\n            int xC = xCCorner + wC * ${c};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              getValue(batch, xR, xC + 2 * ${c}, d),\n              getValue(batch, xR, xC + 3 * ${c}, d)\n            );\n\n            ${k}\n          }\n\n          int xC = xCCorner + ${x};\n          if (${1===w}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${k}\n          } else if (${2===w}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${k}\n          } else if (${3===w}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${c}, d),\n              getValue(batch, xR, xC + 2 * ${c}, d),\n              initializationValue\n            );\n\n            ${k}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class Oi{constructor(t,e,n,r=!1,a=!1){if(this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");const i=t.filterWidth,o=t.strideDepth,s=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;const y="avg"===e;let v="0.0";if(y||(v="-1.0 / 1e-20"),n){const e=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${o}, ${s}, ${u});\n        const ivec3 pads = ivec3(${m}, ${g}, ${b});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${h};\n              wD += ${c}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${l}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${d}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${e} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${r?a?`(((batch * ${t.inDepth} + xD) * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`((xD * ${t.inHeight} + xR) * ${t.inWidth} + xC) * ${t.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}const x="max";let w=`${e}(${e}(${e}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===e&&(w="avgValue / count");const k=4*Math.floor(i/4),S=i%4,O=`\n      if (${y}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ${x}(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${o}, ${s}, ${u});\n      const ivec3 pads = ivec3(${m}, ${g}, ${b});\n      const float initializationValue = ${v};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${t.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${v});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${h};\n            wD += ${c}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${k}; wC += 4) {\n              int xC = xCCorner + wC * ${d};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${d}, ch)\n              );\n\n              ${O}\n            }\n\n            int xC = xCCorner + ${k};\n            if (${1===S}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${O}\n            } else if (${2===S}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${O}\n            } else if (${3===S}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                initializationValue\n              );\n\n              ${O}\n            }\n          }\n          setOutput(${w});\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;xt(a,"avgPool");const{filterSize:o,strides:s,pad:u,dimRoundingMode:c}=r,l=1;i["util"].assert(i["backend_util"].eitherStridesOrDilationsAreOne(s,l),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`);const d=i["backend_util"].computePool2DInfo(a.shape,o,s,l,u,c);if(1===d.filterWidth&&1===d.filterHeight&&i["util"].arraysEqual(d.inShape,d.outShape))return Ur({inputs:{x:a},backend:n});const h=new Si(d,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}const Ci={kernelName:i["AvgPool"],backendName:"webgl",kernelFunc:_i};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ti(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:o,strides:s,pad:u,dimRoundingMode:c,dataFormat:l}=r,d=[1,1,1],h=i["backend_util"].computePool3DInfo(a.shape,o,s,d,u,c,l),p=new Oi(h,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}const Ii={kernelName:i["AvgPool3D"],backendName:"webgl",kernelFunc:Ti};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ni{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,d=1/(e*n);this.userCode=`\n      const ivec2 pads = ivec2(${c}, ${l});\n      const float avgMultiplier = float(${d});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${s};\n            wR += ${i}) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${u};\n            wC+= ${o}) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Ei{constructor(t){this.variableNames=["dy"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=l-1-t.padInfo.front,f=d-1-t.padInfo.top,m=h-1-t.padInfo.left,g=1/(e*n*r);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${m});\n      const float avgMultiplier = float(${g});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${l};\n            wD += ${s}) {\n          float dyD = float(dyDCorner + wD) / ${a}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${d};\n              wR += ${u}) {\n            float dyR = float(dyRCorner + wR) / ${i}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${h};\n                wC += ${c}) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ai(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:o}=e,s=o,{filterSize:u,strides:c,pad:l,dimRoundingMode:d}=r,h=[1,1,1],p=i["backend_util"].computePool3DInfo(s.shape,u,c,h,l,d),f=new Ei(p);return n.runWebGLProgram(f,[a],s.dtype)}const Ri={kernelName:i["AvgPool3DGrad"],backendName:"webgl",kernelFunc:Ai};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ji(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:o}=e,s=o;xt([a,o],"avgPoolGrad");const{filterSize:u,strides:c,pad:l}=r,d=i["backend_util"].computePool2DInfo(s.shape,u,c,1,l),h=new Ni(d);return n.runWebGLProgram(h,[a],s.dtype)}const Di={kernelName:i["AvgPoolGrad"],backendName:"webgl",kernelFunc:ji};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i}=e,{transposeA:o,transposeB:s}=r;return Na({a:a,b:i,transposeA:o,transposeB:s,backend:n})}const Mi={kernelName:i["BatchMatMul"],backendName:"webgl",kernelFunc:Fi};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pi{constructor(t,e,n,r,a,o){this.outputShape=[],this.variableNames=["x","mean","variance"],i["backend_util"].assertAndGetBroadcastShape(t,e),i["backend_util"].assertAndGetBroadcastShape(t,n);let s="0.0";null!=r&&(i["backend_util"].assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="1.0";null!=a&&(i["backend_util"].assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${s};\n        float scale = ${u};\n        float inv = scale * inversesqrt(variance + float(${o}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $i{constructor(t,e,n,r,a,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],i["backend_util"].assertAndGetBroadcastShape(t,e),i["backend_util"].assertAndGetBroadcastShape(t,n);let s="vec4(0.0)";null!=r&&(i["backend_util"].assertAndGetBroadcastShape(t,r),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let u="vec4(1.0)";null!=a&&(i["backend_util"].assertAndGetBroadcastShape(t,a),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode=`\n      void main() {\n        vec4 offset = ${s};\n        vec4 scale = ${u};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${o}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Li=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:a,variance:o,offset:s,scale:u}=t;i["util"].assert(a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),i["util"].assert(null==s||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),i["util"].assert(null==u||a.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=n;null==c&&(c=.001);const l=[r,a,o];let d=null;null!=s&&(d=s.shape,l.push(s));let h=null;null!=u&&(h=u.shape,l.push(u));const p=Object(i["env"])().getBool("WEBGL_PACK_NORMALIZATION")?new $i(r.shape,a.shape,o.shape,d,h,c):new Pi(r.shape,a.shape,o.shape,d,h,c),f=e.runWebGLProgram(p,l,l[0].dtype);return f},Bi={kernelName:i["FusedBatchNorm"],backendName:"webgl",kernelFunc:Li};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class zi{constructor(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;const e=ye(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=Vi(this.rank);let r;const a=t.map((t,e)=>`sourceLoc.${Wi[e]} = start[${e}] + coords.${Wi[e]};`);r=`\n        ${e} sourceLoc;\n        ${e} coords = getOutputCoords();\n        ${a.join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const Wi=["x","y","z","w","u","v"];function Vi(t){if(1===t)return"sourceLoc";if(t<=6)return Wi.slice(0,t).map(t=>"sourceLoc."+t).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ui{constructor(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const e=ye(this.rank),n=Qn("coords",this.rank),r=Qn("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,o=`\n      result.x = ${i};\n      if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${i};\n        --${r[this.rank-1]};\n      }\n    `,s=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${t[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${i};\n        if (++${n[this.rank-1]} < ${t[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${i};\n        }\n      }\n    `,u=this.rank<=4?`sourceLoc = coords +\n            ${e}(${t.map((t,e)=>`start[${e}]`).join()});`:t.map((t,e)=>`${r[e]} = ${n[e]} + start[${e}];`).join("\n");this.userCode=`\n      void main() {\n        ${e} coords = getOutputCoords();\n        ${e} sourceLoc;\n        ${u}\n        vec4 result = vec4(0.);\n        ${o}\n        ${s}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gi(t,e,n,r){const a=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),s=r.texData.get(o.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=t.dtype;let u=i["slice_util"].computeFlatOffset(e,i["util"].computeStrides(t.shape));a.slice&&(u+=a.slice.flatOffset),s.slice={flatOffset:u,origDataId:a.slice&&a.slice.origDataId||t.dataId};const c=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,c+1),o}function Hi(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:o,size:s}=r,[u,c]=i["slice_util"].parseSliceParams(a,o,s);if(i["slice_util"].assertParamsValid(a,u,c),0===i["util"].sizeFromShape(c))return n.makeTensorInfo(c,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){const t=n.texData.get(a.dataId),e=$n(t.values,u,c,a.shape,a.dtype);return n.makeTensorInfo(c,a.dtype,e)}const{isPacked:l}=n.texData.get(a.dataId),d=i["slice_util"].isSliceContinous(a.shape,u,c);if(l||!d){const t=Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ui(c):new zi(c),e=[u];return n.runWebGLProgram(t,[a],a.dtype,e)}return n.uploadToGPU(a.dataId),Gi(a,u,c,n)}const qi={kernelName:i["Slice"],backendName:"webgl",kernelFunc:Hi},Ki=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:o,crops:s}=r;i["util"].assert(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const u=o.reduce((t,e)=>t*e),c=i["backend_util"].getReshaped(a.shape,o,u),l=i["backend_util"].getPermuted(c.length,o.length),d=i["backend_util"].getReshapedPermuted(a.shape,o,u),h=i["backend_util"].getSliceBeginCoords(s,o.length),p=i["backend_util"].getSliceSize(d,s,o.length),f=[],m=pa({inputs:{x:a},backend:n,attrs:{shape:c}}),g=Ca({inputs:{x:m},backend:n,attrs:{perm:l}}),b=pa({inputs:{x:g},backend:n,attrs:{shape:d}}),y=Hi({inputs:{x:b},backend:n,attrs:{begin:h,size:p}});return f.push(m),f.push(g),f.push(b),f.forEach(t=>n.disposeIntermediateTensorInfo(t)),y},Xi={kernelName:i["BatchToSpaceND"],backendName:"webgl",kernelFunc:Ki};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yi(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.readSync(a.dataId),u=n.readSync(i.dataId),c=sn(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const Ji={kernelName:i["Bincount"],backendName:"webgl",kernelFunc:Yi};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zi(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=i["backend_util"].assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}const Qi={kernelName:i["BroadcastArgs"],backendName:"webgl",kernelFunc:Zi},to="return float(a != b);",eo=aa({opSnippet:to,cpuKernelImpl:Nn,dtype:"bool"}),no={kernelName:i["NotEqual"],backendName:"webgl",kernelFunc:eo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ro(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ur({inputs:{x:a.complexTensorInfos.real},backend:n})}const ao={kernelName:i["Real"],backendName:"webgl",kernelFunc:ro},io="return float(int(x));";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oo(t,e){const n=new dr(t.shape,io),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:o}=r;if("complex64"===o){if("complex64"===a.dtype)return Ur({inputs:{x:a},backend:n});const t=i["zeros"](a.shape),e=so({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),r=Hr({inputs:{real:e,imag:t},backend:n});return t.dispose(),n.disposeIntermediateTensorInfo(e),r}if("complex64"===a.dtype){const t=ro({inputs:{input:a},backend:n}),e=so({inputs:{x:t},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(t),e}if(!i["util"].hasEncodingLoss(a.dtype,o)){const t=Ur({inputs:{x:a},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:o}}if(n.shouldExecuteOnCPU([a])){const t=n.texData.get(a.dataId).values,[e,r,i]=cn(t,a.shape,a.dtype,o);return n.makeTensorInfo(e,r,i)}if("int32"===o)return oo(a,n);if("bool"===o){const t=n.makeTensorInfo([],"bool",i["util"].getTypedArrayFromDType("bool",1)),e={a:a,b:t},r=eo({inputs:e,backend:n});return n.disposeIntermediateTensorInfo(t),r}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${o}`)}const uo={kernelName:i["Cast"],backendName:"webgl",kernelFunc:so},co="return ceil(x);",lo=ra({opSnippet:co,packedOpSnippet:co,cpuKernelImpl:ln}),ho={kernelName:i["Ceil"],backendName:"webgl",kernelFunc:lo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class po{constructor(t){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fo{constructor(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=t,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:o,clipValueMax:s}=r;let u;u=Object(i["env"])().getBool("WEBGL_PACK_CLIP")?new fo(a.shape):new po(a.shape);const c=[[o],[s]];return n.runWebGLProgram(u,[a],a.dtype,c)}const go={kernelName:i["ClipByValue"],backendName:"webgl",kernelFunc:mo};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bo{constructor(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function vo(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.texData.get(r.dataId),i=new bo(r.shape),o=[yo(r,a.complexTensorInfos.real),yo(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const xo={kernelName:i["ComplexAbs"],backendName:"webgl",kernelFunc:vo};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wo{constructor(t){this.outputShape=[],this.outputShape=i["backend_util"].computeOutShape(t,1),this.variableNames=t.map((t,e)=>"T"+e);const e=new Array(t.length-1);e[0]=t[0][1];for(let i=1;i<e.length;i++)e[i]=e[i-1]+t[i][1];const n=[`if (yC < ${e[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<e.length;i++){const t=e[i-1];n.push(`else if (yC < ${e[i]}) setOutput(getT${i}(yR, yC-${t}));`)}const r=e.length,a=e[e.length-1];n.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ko{constructor(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=i["backend_util"].computeOutShape(t,e);const n=this.outputShape,r=n.length,a=ye(r),o=Qn("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((t,e)=>"T"+e);const u=new Array(t.length-1);u[0]=t[0][e];for(let i=1;i<u.length;i++)u[i]=u[i-1]+t[i][e];const c=s[e],l=s.slice(-2),d=s.join();let h=`if (${c} < ${u[0]}) {\n        return getChannel(\n            getT0(${d}), vec2(${l.join()}));\n        }`;for(let i=1;i<u.length;i++){const t=u[i-1];h+=`\n        if (${c} < ${u[i]}  && ${c} >= ${u[i-1]}) {\n          return getChannel(\n            getT${i}(${So(s,c,t)}),\n            vec2(${So(l,c,t)}));\n        }`}const p=u.length,f=u[u.length-1];h+=`\n        return getChannel(\n          getT${p}(${So(s,c,f)}),\n          vec2(${So(l,c,f)}));`,this.userCode=`\n      float getValue(${s.map(t=>"int "+t)}) {\n        ${h}\n      }\n\n      void main() {\n        ${a} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[r-1]} = ${o[r-1]} + 1;\n        if (${o[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[r-2]} = ${o[r-2]} + 1;\n        if (${o[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[r-1]} = ${o[r-1]} - 1;\n        if (${o[r-2]} < ${n[r-2]} &&\n            ${o[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function So(t,e,n){const r=t.indexOf(e),a=t.map((t,e)=>e===r?`${t} - ${n}`:t);return a.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ur({inputs:{x:a.complexTensorInfos.imag},backend:n})}const _o={kernelName:i["Imag"],backendName:"webgl",kernelFunc:Oo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Co(t,e,n){const r=t[0].dtype;if("complex64"===r){const r=t.map(t=>ro({inputs:{input:t},backend:n})),a=t.map(t=>Oo({inputs:{input:t},backend:n})),i=Co(r,e,n),o=Co(a,e,n),s=Hr({inputs:{real:i,imag:o},backend:n});return r.forEach(t=>n.disposeIntermediateTensorInfo(t)),a.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}let a=n.shouldExecuteOnCPU(t);if("string"===r&&(a=!0),a){const a=t.map(t=>{const r=i["util"].sizeFromShape(t.shape.slice(e)),a=[-1,r];return pa({inputs:{x:t},backend:n,attrs:{shape:a}})}),o=a.map(t=>({vals:n.readSync(t.dataId),shape:t.shape})),s=i["backend_util"].computeOutShape(a.map(t=>t.shape),1),u=1===a[0].shape[0],c=dn(o,s,r,u),l=i["backend_util"].computeOutShape(t.map(t=>t.shape),e),d=n.makeTensorInfo(l,r,c);return a.forEach(t=>n.disposeIntermediateTensorInfo(t)),d}const o=Object(i["env"])().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>o){const r=[];for(let i=0;i<t.length;i+=o){const a=t.slice(i,i+o);r.push(Co(a,e,n))}const a=Co(r,e,n);for(const t of r)n.disposeIntermediateTensorInfo(t);return a}if(Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const a=new ko(t.map(t=>t.shape),e);return n.runWebGLProgram(a,t,r)}const{tensors2D:s,outShape:u}=To(t,e,n),c=new wo(s.map(t=>t.shape)),l=n.runWebGLProgram(c,s,r);s.forEach(t=>n.disposeIntermediateTensorInfo(t));const d=pa({inputs:{x:l},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(l),d}function To(t,e,n){const r=i["backend_util"].computeOutShape(t.map(t=>t.shape),e),a=t.map(t=>pa({inputs:{x:t},attrs:{shape:[-1,i["util"].sizeFromShape(t.shape.slice(e))]},backend:n}));return{tensors2D:a,outShape:r}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,o=i["util"].parseAxisParam(a,e[0].shape)[0],s=e.map(t=>t.shape);i["backend_util"].assertParamsConsistent(s,o);const u=i["backend_util"].computeOutShape(e.map(t=>t.shape),o);if(0===i["util"].sizeFromShape(u))return n.makeTensorInfo(u,e[0].dtype,[]);const c=e.filter(t=>i["util"].sizeFromShape(t.shape)>0);return 1===c.length?Ur({inputs:{x:c[0]},backend:n}):Co(c,o,n)}const No={kernelName:i["Concat"],backendName:"webgl",kernelFunc:Io};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eo{constructor(t,e=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=t.outShape;const i=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4,m="channelsLast"===t.dataFormat,g=m?1:2,b=m?2:3,y=m?3:1;let v="",x="";n&&(v=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,x="result = activation(result);");const w=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${v}\n\n      const ivec2 strides = ivec2(${s}, ${u});\n      const ivec2 pads = ivec2(${i}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${y}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${g}], coords[${b}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${c};\n\n          if (xR < 0 || xR >= ${t.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${l};\n\n            if (xC < 0 || xC >= ${t.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}}class Ao{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${a}, ${i}, ${o});\n      const ivec3 pads = ivec3(${e}, ${n}, ${r});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${l}; wF++) {\n          int xF = xFCorner + wF * ${s};\n\n          if (xF < 0 || xF >= ${t.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${d}; wR++) {\n            int xR = xRCorner + wR * ${u};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h}; wC++) {\n              int xC = xCCorner + wC * ${c};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ro{constructor(t,e=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Te(this.outputShape.length);const o=t.padInfo.left,s=t.strideWidth,u=t.dilationWidth,c=t.filterHeight,l=t.filterWidth,d=l;let h="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let i=0;i<l;i++)h+=`\n           vec4 xTexelC${2*i};\n           int xTexelC${2*i}Ready;\n           vec4 xTexelC${2*i+1};\n           int xTexelC${2*i+1}Ready;\n           vec4 xC${i};`;h+=`\n     for (int r = 0; r < ${c}; r++) {\n      for (int d1 = 0; d1 < ${t.inChannels}; d1 += 2) {\n       `;for(let i=0;i<l;i++)h+=`\n           xTexelC${2*i} = vec4(0.0);\n           xTexelC${2*i}Ready = 0;\n           xTexelC${2*i+1} = vec4(0.0);\n           xTexelC${2*i+1}Ready = 0;\n           xC${i} = vec4(0.0);`;h+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let g=0;g<(d+1)/2;g++){const e=2*g;if(h+=`\n           xC = xCCorner + ${e*u};\n           `,1===s){if(e<l&&(o%2===1?(h+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n               `,h+=1===u&&e>0?`\n                 xC${e} = vec4(xTexelC${e-2}.zw, xTexelC${e}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${e} = vec4(previous.zw, xTexelC${e}.xy);\n                   } else {\n                     xC${e} = vec4(0.0, 0.0, xTexelC${e}.xy);\n                   }\n                   `):h+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 xC${e} = xTexelC${e};\n                 `,e+1<l)){const t=o%2===0?i["util"].nearestLargerEven(u):u;u%2===0&&o%2===1||u%2!==0&&o%2!==1?(h+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${t};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                     xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${e+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${e+1}Ready = 1;\n                   }\n                   `,h+=u>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${e+1} = vec4(previous.zw, xTexelC${e+1}.xy);\n                     } else {\n                      xC${e+1} = vec4(0.0, 0.0, xTexelC${e+1}.xy);\n                     }\n                     `:`\n                     xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.xy);\n                     `):h+=1===t?`\n                     xC${e+1} = xTexelC${e};\n                     `:`\n                     xCOffset = xC + ${t};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                       xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${e+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${e+1}Ready = 1;\n                     }\n\n                     xC${e+1} = xTexelC${e+1};\n                     `}}else e<l&&(o%2===1?(h+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${e+1}Ready == 0) {\n                   xTexelC${e+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${e+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${e+1}Ready = 1;\n                 }\n\n                 xC${e} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n               `,e+1<l&&(h+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${e+1} = vec4(xTexelC${e+1}.xy, final.xy);\n                 `)):(h+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${e}Ready == 0) {\n                   xTexelC${e} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${e}.zw = vec2(0.0);\n                   }\n                   xTexelC${e}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${e+1}Ready == 0) {\n                   xTexelC${e+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${e+1}.zw = vec2(0.);\n                   }\n                   xTexelC${e+1}Ready = 1;\n                 }\n\n                 xC${e} = vec4(\n                   xTexelC${e}.xy, xTexelC${e+1}.xy);\n               `,e+1<l&&(h+=`\n                   xC${e+1} = vec4(xTexelC${e}.zw, xTexelC${e+1}.zw);\n                 `)));e<l&&(h+=`\n             wTexel = getW(r, ${e}, d1, d2);\n             dotProd += xC${e}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${t.inChannels}) {\n               dotProd += xC${e}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,e+1<l&&(h+=`\n               wTexel = getW(r, ${e+1}, d1, d2);\n               dotProd += xC${e+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${t.inChannels}) {\n                 dotProd += xC${e+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}h+="\n     }\n   ",h+="\n     }\n   ",h+="\n     }\n   ";let p="",f="";n&&(p=r?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${n}\n         }`:a?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${n}\n         }`:`vec4 activation(vec4 x) {\n           ${n}\n         }`,f="result = activation(result);");const m=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${p}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${h}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${m}\n         ${f}\n         setOutput(result);\n       }\n     `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jo{constructor(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=t,this.enableShapeUniforms=Te(this.outputShape.length);const{dataFormat:n}=e,r=kt(),a="channelsLast"===n,i=a?1:2,o=a?2:3,s=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${t[2]} && pos < ${t[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let t=0;t<=1;t++)u+=`\n          blockIndex = rc.z + ${t};\n          pos = rc.y + ${c};\n\n          ${s}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${i}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${o}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${a}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*c+t}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*c+t}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${u}\n\n        ${r.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Do(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&1===n&&t[0]>1?[t[0],1]:null}function Fo({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:u=null}){const c=t.shape,l=r.texData.get(t.dataId),d=n.inChannels,h=c[0]*c[1]*c[2],p=n.outChannels,f="channelsLast"===n.dataFormat,m=!1,g=!1;let b;const y=[];if(null!=o){const t=Do(o.shape,f);null!=t&&(o=pa({inputs:{x:o},backend:r,attrs:{shape:t}}),y.push(o))}if(null!=a){const t=Do(a.shape,f);null!=t&&(a=pa({inputs:{x:a},backend:r,attrs:{shape:t}}),y.push(a))}const v=(1===h||1===p)&&d>Ia,x=!v&&l.isPacked&&f&&null!=l.texture&&c[2]%2!==0&&i["util"].arraysEqual(l.shape.slice(-3),c.slice(-3));if(x){const d=c[0]*c[1]*(c[2]+1),h={dataId:t.dataId,shape:[1,d,n.inChannels],dtype:t.dtype},p=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,i["util"].assert(it(l.shape,h.shape),()=>`packed reshape ${l.shape} to ${h.shape} isn't free`);const f=pa({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(f);const v=Na({a:h,b:f,backend:r,transposeA:m,transposeB:g,bias:a,activation:u,preluActivationWeights:o,leakyreluAlpha:s}),x=r.texData.get(v.dataId);i["util"].assert(x.isPacked,()=>"batchMatMul result is expected to be packed"),l.shape=p,x.shape=n.outShape,b=Ur({inputs:{x:v},backend:r}),b.shape=n.outShape,y.push(v)}else{const i=n.outHeight*n.outWidth,c=pa({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,i,n.inChannels]:[n.batchSize,n.inChannels,i]}}),l=pa({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),d=Na({a:f?c:l,b:f?l:c,transposeA:!f,transposeB:g,backend:r,bias:a,activation:u,preluActivationWeights:o,leakyreluAlpha:s});b=pa({inputs:{x:d},backend:r,attrs:{shape:n.outShape}}),y.push(c),y.push(l),y.push(d)}for(const i of y)r.disposeIntermediateTensorInfo(i);return b}function Mo({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:u=null}){const{filterWidth:c,filterHeight:l,inChannels:d,outWidth:h,outHeight:p,dataFormat:f}=n,m="channelsLast"===f,g=c*l*d,b=p*h,y=[n.batchSize,g,b],v=!0,x=!1,w=[];if(null!=o){const t=Do(o.shape,m);null!=t&&(o=pa({inputs:{x:o},backend:r,attrs:{shape:t}}),w.push(o))}if(null!=a){const t=Do(a.shape,m);null!=t&&(a=pa({inputs:{x:a},backend:r,attrs:{shape:t}}),w.push(a))}const k=pa({inputs:{x:e},backend:r,attrs:{shape:[1,g,i["util"].sizeFromShape(e.shape)/g]}});w.push(k);const S=new jo(y,n),O=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],_=r.runWebGLProgram(S,[t],"float32",O),C=pa({inputs:{x:_},backend:r,attrs:{shape:y}});w.push(_),w.push(C);const T=null!=a,I=null!=o,N="leakyrelu"===u,E=u?ia(u,!0):null,A=new oa(m?C.shape:k.shape,m?k.shape:C.shape,m?[n.batchSize,b,n.outChannels]:[n.batchSize,n.outChannels,b],v,x,T,E,I,N),R=m?[C,k]:[k,C];if(a&&R.push(a),I&&R.push(o),N){const t=r.makeTensorInfo([],"float32",i["util"].createScalarValue(s,"float32"));R.push(t),w.push(t)}const j=r.runWebGLProgram(A,R,"float32"),D=pa({inputs:{x:j},backend:r,attrs:{shape:n.outShape}});w.push(j);for(const i of w)r.disposeIntermediateTensorInfo(i);return D}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Po(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o}=e,{strides:s,pad:u,dataFormat:c,dilations:l,dimRoundingMode:d}=r,h=i["backend_util"].convertConv2DDataFormat(c),p=i["backend_util"].computeConv2DInfo(a.shape,o.shape,s,l,u,d,!1,h);let f;if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(p.strideWidth<=2&&"channelsLast"===h&&Object(i["env"])().getBool("WEBGL_EXP_CONV")){const t=new Ro(p),e=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(t,[a,o],"float32",e)}else if(Object(i["env"])().getBool("WEBGL_CONV_IM2COL"))f=Mo({x:a,filter:o,convInfo:p,backend:n});else{const t=new Eo(p);f=n.runWebGLProgram(t,[a,o],"float32")}else f=Fo({x:a,filter:o,convInfo:p,backend:n});const m=pa({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),m}const $o={kernelName:i["Conv2D"],backendName:"webgl",kernelFunc:Po};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lo{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i="channelsLast"===t.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${a};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              if (${i}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Bo{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${l}];\n\n        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n\n              if (${i}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class zo{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yF = 0; yF < ${t.outDepth}; yF++) {\n            int xF = wF + yF * ${e} - ${a};\n\n            if (xF < 0 || xF >= ${t.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${t.outHeight}; yR++) {\n              int xR = wR + yR * ${n} - ${i};\n\n              if (xR < 0 || xR >= ${t.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${t.outWidth}; yC++) {\n                int xC = wC + yC * ${r} - ${o};\n\n                if (xC < 0 || xC >= ${t.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Wo{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${s}, ${u}, ${c});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${e}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${a}.0;\n\n          if (dyF < 0.0 || dyF >= ${t.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${e} - 1 - wF;\n\n          for (int wR = 0; wR < ${n}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${i}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${n} - 1 - wR;\n\n            for (int wC = 0; wC < ${r}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${o}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${r} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${t.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vo(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:o}=e,{strides:s,pad:u,dataFormat:c,dimRoundingMode:l,filterShape:d}=r,h=i["backend_util"].convertConv2DDataFormat(c),p=i["backend_util"].computeConv2DInfo(a.shape,d,s,1,u,l,!1,h),f=new Lo(p);return n.runWebGLProgram(f,[a,o],"float32")}const Uo={kernelName:i["Conv2DBackpropFilter"],backendName:"webgl",kernelFunc:Vo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Go(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:o}=e,{inputShape:s,strides:u,pad:c,dataFormat:l,dimRoundingMode:d}=r,h=i["backend_util"].convertConv2DDataFormat(l),p=i["backend_util"].computeConv2DInfo(s,o.shape,u,1,c,d,!1,h),f=new Bo(p);return n.runWebGLProgram(f,[a,o],"float32")}const Ho={kernelName:i["Conv2DBackpropInput"],backendName:"webgl",kernelFunc:Go};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qo(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o}=e,{strides:s,pad:u,dilations:c}=r,l=i["backend_util"].computeConv3DInfo(a.shape,o.shape,s,c,u),d=new Ao(l);return n.runWebGLProgram(d,[a,o],"float32")}const Ko={kernelName:i["Conv3D"],backendName:"webgl",kernelFunc:qo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xo(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:o}=e,{strides:s,pad:u,filterShape:c}=r,l=i["backend_util"].computeConv3DInfo(a.shape,c,s,1,u),d=new zo(l);return n.runWebGLProgram(d,[a,o],"float32")}const Yo={kernelName:i["Conv3DBackpropFilterV2"],backendName:"webgl",kernelFunc:Xo};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jo(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:o}=e,{pad:s,strides:u,inputShape:c}=r,l=i["backend_util"].computeConv3DInfo(c,o.shape,u,1,s),d=new Wo(l);return n.runWebGLProgram(d,[a,o],"float32")}const Zo={kernelName:i["Conv3DBackpropInputV2"],backendName:"webgl",kernelFunc:Jo},Qo=na+"\n  return cos(x);\n",ts=ra({opSnippet:Qo}),es={kernelName:i["Cos"],backendName:"webgl",kernelFunc:ts},ns="\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n",rs=ra({opSnippet:ns}),as={kernelName:i["Cosh"],backendName:"webgl",kernelFunc:rs};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class is{constructor(t,e,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,o,s,u]=t,[c]=e,[l,d]=n;this.outputShape=[c,l,d,u];const h="bilinear"===r?1:0,[p,f]=[o-1+".0",s-1+".0"],[m,g,b]=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0","0.5 * (y1+y2) * "+p],[y,v,x]=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0","0.5 * (x1+x2) * "+f];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${y});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${i}) {\n          return;\n        }\n\n        float height_scale = ${g};\n        float width_scale = ${v};\n\n        float in_y = ${b};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${a}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${a}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${h} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const os=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:u,extrapolationValue:c}=r,l=new is(a.shape,i.shape,s,u,c);return n.runWebGLProgram(l,[a,i,o],"float32")},ss={kernelName:i["CropAndResize"],backendName:"webgl",kernelFunc:os};var us;(function(t){t["Prod"]="*",t["Sum"]="+"})(us||(us={}));class cs{constructor(t,e,n,r){this.op=t,this.outputShape=e,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===us.Prod?"1.0":"0.0",o=n?i:`getX(${ls(a,"coords",this.op)})`,s=this.outputShape[this.outputShape.length-1];let u="",c="";n?(u=r?"end != "+(s-1):"end != 0",c=r?"end + 1":"end - 1"):(u=r?"end + pow2 < "+s:"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${ye(a)} coords = getOutputCoords();\n        int end = ${ds(a,"coords",this.op)};\n        float val = ${o};\n        int pow2 = int(pow(2.0, index));\n        if (${u}) {\n          int idx = ${c};\n          ${ds(a,"coords",this.op)} = idx;\n          val ${this.op}= getX(${ls(a,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function ls(t,e,n){if(1===t)return""+e;if(2===t)return`${e}.x, ${e}.y`;if(3===t)return`${e}.x, ${e}.y, ${e}.z`;if(4===t)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function ds(t,e,n){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(t,e,n,r,a,o){const s=e.shape.length,u=i["backend_util"].getAxesPermutation([r],s);let c=e;null!=u&&(c=Ca({inputs:{x:e},backend:n,attrs:{perm:u}}));const l=i["backend_util"].getInnerMostAxes(1,s)[0];if(l!==s-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=`+r);const d=c.shape[l];let h=Ur({inputs:{x:c},backend:n});for(let i=0;i<=Math.ceil(Math.log2(d))-1;i++){const e=new cs(t,c.shape,!1,o),r=[[i]],a=h;h=n.runWebGLProgram(e,[h],h.dtype,r),n.disposeIntermediateTensorInfo(a)}if(a){const e=new cs(t,c.shape,a,o),r=h;h=n.runWebGLProgram(e,[h],h.dtype),n.disposeIntermediateTensorInfo(r)}if(null!=u){const t=i["backend_util"].getUndoAxesPermutation(u),e=Ca({inputs:{x:h},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(c),e}return h}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ps(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return hs(us.Prod,a,n,i,o,s)}const fs={kernelName:i["Cumprod"],backendName:"webgl",kernelFunc:ps};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return hs(us.Sum,a,n,i,o,s)}const gs={kernelName:i["Cumsum"],backendName:"webgl",kernelFunc:ms};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bs(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const t=n.readSync(a.dataId),e=n.readSync(i.dataId),r=sn(t,e,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,r)}if(2===a.shape.length){const t=n.bufferSync(a),e=n.bufferSync(i),r=un(t,e,o,s);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+a.shape.length+".")}const ys={kernelName:i["DenseBincount"],backendName:"webgl",kernelFunc:bs};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vs{constructor(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${e};\n      int offset_h = imod(h, ${e});\n      int in_w = w / ${e};\n      int offset_w = imod(w, ${e});\n      int offset_d = (offset_h * ${e} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r,s=a.shape[0],u="NHWC"===o?a.shape[1]:a.shape[2],c="NHWC"===o?a.shape[2]:a.shape[3],l="NHWC"===o?a.shape[3]:a.shape[1],d=u*i,h=c*i,p=l/(i*i),f="NHWC"===o?[s,d,h,p]:[s,p,d,h],m=new vs(f,i,o);return n.runWebGLProgram(m,[a],a.dtype)}const ws={kernelName:i["DepthToSpace"],backendName:"webgl",kernelFunc:xs};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ks{constructor(t,e=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Te(this.outputShape.length);const i=t.filterHeight,o=t.filterWidth,s=t.outChannels/t.inChannels;let u="",c="";n&&(u=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,c="result = activation(result);");const l=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${u}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${s};\n        int q = d2 - d1 * ${s};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${i}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${o}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${l}\n        ${c}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ss{constructor(t,e=!1,n=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=t.outShape,this.enableShapeUniforms=Te(this.outputShape.length);const o=t.outChannels/t.inChannels,s=t.padInfo.left,u=t.strideWidth,c=t.dilationWidth,l=t.filterHeight,d=t.filterWidth,h=d;let p="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let i=0;i<d;i++)p+=`\n          vec4 xTexelC${2*i};\n          int xTexelC${2*i}Ready;\n          vec4 xTexelC${2*i+1};\n          int xTexelC${2*i+1}Ready;\n          vec4 xC${i};`;p+=`\n    for (int r = 0; r < ${l}; r++) {\n      `;for(let i=0;i<d;i++)p+=`\n          xTexelC${2*i} = vec4(0.0);\n          xTexelC${2*i}Ready = 0;\n          xTexelC${2*i+1} = vec4(0.0);\n          xTexelC${2*i+1}Ready = 0;\n          xC${i} = vec4(0.0);`;p+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let b=0;b<(h+1)/2;b++){const t=2*b;if(p+=`\n          xC = xCCorner + ${t*c};\n          `,1===u){if(t<d&&(s%2===1?(p+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n              `,p+=1===c&&t>0?`\n                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                  } else {\n                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                  }\n                  `):p+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xC${t} = xTexelC${t};\n                `,t+1<d)){const e=s%2===0?i["util"].nearestLargerEven(c):c;c%2===0&&s%2===1||c%2!==0&&s%2!==1?(p+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${t+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${t+1}Ready = 1;\n                  }\n                  `,p+=c>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                    } else {\n                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                    }\n                    `:`\n                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                    `):p+=1===e?`\n                    xC${t+1} = xTexelC${t};\n                    `:`\n                    xCOffset = xC + ${e};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${t+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${t+1}Ready = 1;\n                    }\n\n                    xC${t+1} = xTexelC${t+1};\n                    `}}else t<d&&(s%2===1?(p+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n              `,t+1<d&&(p+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                `)):(p+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(\n                  xTexelC${t}.xy, xTexelC${t+1}.xy);\n              `,t+1<d&&(p+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                `)));t<d&&(p+=`\n            wTexel = getW(r, ${t}, d1, q);\n            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);\n          `,t+1<d&&(p+=`\n              wTexel = getW(r, ${t+1}, d1, q);\n              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}p+="\n    }\n  ",p+="\n      }\n    ";let f="",m="";n&&(f=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:a?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,m="result = activation(result);");const g=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${f}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${p}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${g}\n        ${m}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o}=e,{strides:s,pad:u,dilations:c,dimRoundingMode:l}=r;let d=c;null==d&&(d=[1,1]),i["util"].assert(i["backend_util"].eitherStridesOrDilationsAreOne(s,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${d}'`);const h=i["backend_util"].computeConv2DInfo(a.shape,o.shape,s,d,u,l,!0);let p;p=Object(i["env"])().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?new Ss(h):new ks(h);const f=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return n.runWebGLProgram(p,[a,o],"float32",f)}const _s={kernelName:i["DepthwiseConv2dNative"],backendName:"webgl",kernelFunc:Os};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cs{constructor(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;const e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${i} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${t.batchSize}; b++) {\n          for (int yR = 0; yR < ${t.outHeight}; yR++) {\n            int xR = wR + yR * ${e} - ${r};\n\n            if (xR < 0 || xR >= ${t.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${t.outWidth}; yC++) {\n              int xC = wC + yC * ${n} - ${a};\n\n              if (xC < 0 || xC >= ${t.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Ts{constructor(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;const e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${i}, ${o});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${e}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${e} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${a}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${s}; dm++) {\n              int d2 = d1 * ${s} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:o}=e,{strides:s,dilations:u,pad:c,dimRoundingMode:l,filterShape:d}=r,h=i["backend_util"].computeConv2DInfo(a.shape,d,s,u,c,l,!0),p=new Cs(h);return n.runWebGLProgram(p,[a,o],"float32")}const Ns={kernelName:i["DepthwiseConv2dNativeBackpropFilter"],backendName:"webgl",kernelFunc:Is};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Es(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:o}=e,{strides:s,dilations:u,pad:c,dimRoundingMode:l,inputShape:d}=r,h=i["backend_util"].computeConv2DInfo(d,o.shape,s,u,c,l,!0),p=new Ts(h);return n.runWebGLProgram(p,[a,o],"float32")}const As={kernelName:i["DepthwiseConv2dNativeBackpropInput"],backendName:"webgl",kernelFunc:Es};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rs{constructor(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function js(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],o=i["util"].sizeFromShape(r.shape),s=pa({inputs:{x:r},backend:n,attrs:{shape:[o]}}),u=new Rs(o),c=n.runWebGLProgram(u,[s],s.dtype),l=pa({inputs:{x:c},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),l}const Ds={kernelName:i["Diag"],backendName:"webgl",kernelFunc:js};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fs{constructor(t){this.variableNames=["x","W"],this.outputShape=t.outShape;const{inHeight:e,inWidth:n,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:o,filterWidth:s,dilationHeight:u,dilationWidth:c}=t,{top:l,left:d}=r;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${i});\n      const ivec2 pads = ivec2(${l}, ${d});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${o}; h++) {\n          int hIn = hBeg + h * ${u};\n\n          if (hIn >= 0 && hIn < ${e}) {\n            for (int w = 0; w < ${s}; w++) {\n              int wIn = wBeg + w * ${c};\n\n              if (wIn >= 0 && wIn < ${n}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ms(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o}=e,{strides:s,pad:u,dilations:c}=r,l=i["backend_util"].computeDilation2DInfo(a.shape,o.shape,s,u,"NHWC",c);let d;const h=new Fs(l);d=n.runWebGLProgram(h,[a,o],"float32");const p=pa({inputs:{x:d},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(d),p}const Ps={kernelName:i["Dilation2D"],backendName:"webgl",kernelFunc:Ms};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,o=e,{allDims:s,summedDims:u,idDims:c}=i["backend_util"].decodeEinsumEquation(a,o.length);i["backend_util"].checkEinsumDimSizes(s.length,c,o);const{path:l,steps:d}=i["backend_util"].getEinsumComputePath(u,c),h=d.length;let p=null,f=s.length;const m=[];for(let g=0;g<h;++g){for(const t of d[g]){const{permutationIndices:e,expandDims:r}=i["backend_util"].getEinsumPermutation(f,c[t]);let a;i["backend_util"].isIdentityPermutation(e)?a=o[t]:(a=Ca({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),m.push(a));const s=a.shape.slice();for(let t=0;t<r.length;++t)s.splice(r[t],0,1);i["util"].arraysEqual(a.shape,s)||(a=pa({inputs:{x:a},backend:n,attrs:{shape:s}}),m.push(a)),null===p?p=a:(p=la({inputs:{a:a,b:p},backend:n}),m.push(p))}g<h-1&&(l[g]>=0&&(p=Oa({inputs:{x:p},backend:n,attrs:{axis:l[g]-(s.length-f),keepDims:!1}}),m.push(p)),f--)}for(const i of m)i!==p&&n.disposeIntermediateTensorInfo(i);return p}const Ls={kernelName:i["Einsum"],backendName:"webgl",kernelFunc:$s},Bs="return (x >= 0.0) ? x : (exp(x) - 1.0);",zs="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Ws=ra({opSnippet:Bs,packedOpSnippet:zs}),Vs={kernelName:i["Elu"],backendName:"webgl",kernelFunc:Ws},Us="return (b >= 1.0) ? a : a * (b + 1.0);",Gs="\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",Hs=t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,o=Object(i["env"])().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Vr(Gs,r.shape,a.shape):new zr(Us,r.shape,a.shape);return n.runWebGLProgram(o,[r,a],r.dtype)},qs={kernelName:i["EluGrad"],backendName:"webgl",kernelFunc:Hs},Ks="\n  return vec4(equal(a, b));\n",Xs="return float(a == b);",Ys=aa({opSnippet:Xs,packedOpSnippet:Ks,dtype:"bool",cpuKernelImpl:hn}),Js={kernelName:i["Equal"],backendName:"webgl",kernelFunc:Ys},Zs=`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${i["backend_util"].ERF_P};\n  float a1 = ${i["backend_util"].ERF_A1};\n  float a2 = ${i["backend_util"].ERF_A2};\n  float a3 = ${i["backend_util"].ERF_A3};\n  float a4 = ${i["backend_util"].ERF_A4};\n  float a5 = ${i["backend_util"].ERF_A5};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`,Qs=ra({opSnippet:Zs}),tu={kernelName:i["Erf"],backendName:"webgl",kernelFunc:Qs},eu=na+"\n  return exp(x);\n",nu="\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ru=ra({opSnippet:eu,packedOpSnippet:nu,cpuKernelImpl:pn,dtype:"float32"}),au={kernelName:i["Exp"],backendName:"webgl",kernelFunc:ru};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function iu(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:o}=e,s=o.shape.length,u=o.shape.slice();let c=a;return a<0&&(i["util"].assert(-(s+1)<=a,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),c=s+a+1),u.splice(c,0,1),pa({inputs:{x:o},backend:r,attrs:{shape:u}})}const ou={kernelName:i["ExpandDims"],backendName:"webgl",kernelFunc:iu},su="return exp(x) - 1.0;",uu=ra({opSnippet:su,packedOpSnippet:su,cpuKernelImpl:fn}),cu={kernelName:i["Expm1"],backendName:"webgl",kernelFunc:uu};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class lu{constructor(t,e,n){this.variableNames=["real","imag"];const r=e[1];this.outputShape=e;const a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";let o;if("real"===t)o="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error(`FFT component must be either "real" or "imag", got ${t}.`);o="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${a};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${o}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${r});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${r}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${i};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function du(t,e,n){const r=n.texData.get(t.dataId),a=i["util"].sizeFromShape(t.shape),o=t.shape[t.shape.length-1],s=a/o,u=pa({inputs:{x:t},backend:n,attrs:{shape:[s,o]}}),c=u.shape,l=new lu("real",c,e),d=new lu("imag",c,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],p=n.runWebGLProgram(l,h,"float32"),f=n.runWebGLProgram(d,h,"float32"),m=Hr({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);const g=pa({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(m),g}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(t){const{inputs:e,backend:n}=t,{input:r}=e;return du(r,!1,n)}const pu={kernelName:i["FFT"],backendName:"webgl",kernelFunc:hu};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fu{constructor(t,e){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mu(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:o}=n;if(o=o||i["util"].inferDtype(a),"string"===o){const t=i["util"].getArrayFromDType(o,i["util"].sizeFromShape(r));return t.fill(a),e.makeTensorInfo(r,o,t)}{const t=new fu(r,a),n=[[a]];return e.runWebGLProgram(t,[],o,n)}}const gu={kernelName:i["Fill"],backendName:"webgl",kernelFunc:mu};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bu{constructor(t){this.variableNames=["Image"],this.outputShape=[];const e=t[2];this.outputShape=t,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${e} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${e}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yu={kernelName:i["FlipLeftRight"],backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,a=new bu(n.shape),i=r.runWebGLProgram(a,[n],n.dtype);return i}},vu="return floor(x);",xu=ra({opSnippet:vu,packedOpSnippet:vu,cpuKernelImpl:mn}),wu={kernelName:i["Floor"],backendName:"webgl",kernelFunc:xu},ku="\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",Su="\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",Ou=aa({opSnippet:ku,packedOpSnippet:Su,dtype:"int32"}),_u={kernelName:i["FloorDiv"],backendName:"webgl",kernelFunc:Ou};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Cu{constructor(t){this.variableNames=["A"];const e=kt(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${e.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tu{constructor(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const e=kt(),[n,r]=t;this.outputShape=t,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${e.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${e.output} = result;\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iu={kernelName:i["FromPixels"],backendName:"webgl",kernelFunc:Au};let Nu,Eu=Object(i["env"])().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Au(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:o}=r,s="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,u="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,[c,l]=s?[a.videoWidth,a.videoHeight]:[a.width,a.height],d=[l,c],h=[l,c,o];if(u||s){const t=Object(i["env"])().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=Nu&&t===Eu||(Eu=t,Nu=document.createElement("canvas").getContext("2d",{willReadFrequently:Eu})),Nu.canvas.width=c,Nu.canvas.height=l,Nu.drawImage(a,0,0,c,l),a=Nu.canvas}const f=n.makeTensorInfo(d,"int32");n.texData.get(f.dataId).usage=p.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);const m=Object(i["env"])().getBool("WEBGL_PACK")?new Tu(h):new Cu(h),g=n.runWebGLProgram(m,[f],"int32");return n.disposeData(f.dataId),g}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o,bias:s,preluActivationWeights:u}=e,{strides:c,pad:l,dataFormat:d,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r,g=i["backend_util"].convertConv2DDataFormat(d),b=i["backend_util"].computeConv2DInfo(a.shape,o.shape,c,h,l,p,!1,g);let y;const v=[],x=null!=s,w=null!=u,k="leakyrelu"===f,S=()=>{const t=[a,o],e=(t,e)=>{if("NCHW"===e&&1===t.shape.length&&1!==t.shape[0]){const e=pa({inputs:{x:t},backend:n,attrs:{shape:[t.shape[0],1,1]}});return v.push(e),e}return t};if(x&&t.push(e(s,d)),w&&t.push(e(u,d)),k){const e=n.makeTensorInfo([],"float32",i["util"].createScalarValue(m,"float32"));t.push(e),v.push(e)}return t};if(1!==b.filterHeight||1!==b.filterWidth||1!==b.dilationHeight||1!==b.dilationWidth||1!==b.strideHeight||1!==b.strideWidth||"SAME"!==b.padInfo.type&&"VALID"!==b.padInfo.type)if(b.strideWidth<=2&&"channelsLast"===g&&Object(i["env"])().getBool("WEBGL_EXP_CONV")){const t=f?ia(f,!0):null,e=new Ro(b,x,t,w,k),r=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],a=S();y=n.runWebGLProgram(e,a,"float32",r)}else if(Object(i["env"])().getBool("WEBGL_CONV_IM2COL"))y=Mo({x:a,filter:o,convInfo:b,backend:n,bias:s,activation:f,preluActivationWeights:u,leakyreluAlpha:m});else{const t=f?ia(f,!1):null,e=new Eo(b,x,t,w,k),r=S();y=n.runWebGLProgram(e,r,"float32")}else y=Fo({x:a,filter:o,convInfo:b,backend:n,bias:s,activation:f,preluActivationWeights:u,leakyreluAlpha:m});const O=pa({inputs:{x:y},backend:n,attrs:{shape:b.outShape}});return v.push(y),v.forEach(t=>n.disposeIntermediateTensorInfo(t)),O}const ju={kernelName:i["FusedConv2D"],backendName:"webgl",kernelFunc:Ru};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Du(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:o,bias:s,preluActivationWeights:u}=e,{strides:c,pad:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,m=[];let g=d;null==g&&(g=[1,1]),i["util"].assert(i["backend_util"].eitherStridesOrDilationsAreOne(c,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${g}'`);const b=i["backend_util"].computeConv2DInfo(a.shape,o.shape,c,g,l,h,!0),y=Object(i["env"])().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,v=p?ia(p,y):null,x=[a,o],w=null!=s,k=null!=u,S="leakyrelu"===p;if(w&&x.push(s),k&&x.push(u),S){const t=n.makeTensorInfo([],"float32",i["util"].createScalarValue(f,"float32"));x.push(t),m.push(t)}let O;O=y?new Ss(b,w,v,k,S):new ks(b,w,v,k,S);const _=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],C=n.runWebGLProgram(O,x,"float32",_);return m.forEach(t=>n.disposeIntermediateTensorInfo(t)),C}const Fu={kernelName:i["FusedDepthwiseConv2D"],backendName:"webgl",kernelFunc:Du};class Mu{constructor(t,e,n,r){this.sliceDim=t,this.strides=e,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=n;const a=ye(n.length);let i="\n    int index;";for(let o=0;o<this.sliceDim;o++)i+=`\n          index = round(getIndices(coords[0], ${o}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};\n          flattenIndex += index * ${this.strides[o]};`;this.userCode=`\n         void main() {\n          ${a} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${i}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,o=a.shape,s=o[o.length-1],u=i["util"].sizeFromShape(r.shape),[c,l,d,h]=i["backend_util"].prepareAndValidate(r,a),p=pa({inputs:{x:a},backend:n,attrs:{shape:[l,s]}}),f=pa({inputs:{x:r},backend:n,attrs:{shape:[i["util"].sizeFromShape(r.shape)/d,d]}});if(n.shouldExecuteOnCPU([r,a])||"string"===r.dtype){const t=n.readSync(a.dataId),e=n.bufferSync(r),i=gn(t,e,r.dtype,l,s,d,h,r.shape,u);return n.makeTensorInfo(c,r.dtype,i.values)}const m=new Mu(s,h,[l,d],r.shape),g=n.runWebGLProgram(m,[f,p],f.dtype),b=pa({inputs:{x:g},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),b}const $u={kernelName:i["GatherNd"],backendName:"webgl",kernelFunc:Pu};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lu{constructor(t,e){this.variableNames=["A","indices"],this.outputShape=e,this.rank=e.length;const n=ye(this.rank),r=Bu(t,2);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${t[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${r}));\n      }\n    `}}function Bu(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<t.length;a++)2===a?r.push("index"):r.push(""+n[a]);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zu(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:o}=e,{axis:s,batchDims:u}=r,c=i["util"].parseAxisParam(s,a.shape)[0];if(Object(i["env"])().get("DEBUG")){const t=n.readSync(o.dataId),e=a.shape[c];for(let n=0;n<t.length;++n){const r=t[n];i["util"].assert(r<=e-1&&r>=0,()=>`GatherV2: the index value ${r} is not in [0, ${e-1}]`)}}const l=i["backend_util"].segment_util.collectGatherOpShapeInfo(a,o,c,u),d=i["util"].sizeFromShape(o.shape),h=[],p=pa({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),f=pa({inputs:{x:o},backend:n,attrs:{shape:[l.batchSize,d/l.batchSize]}});h.push(p),h.push(f);const m=[l.batchSize,l.outerSize,d/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,o])||"string"===a.dtype){const t=n.bufferSync(f),e=n.bufferSync(p),r=bn(e,t,m);return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}const g=new Lu(p.shape,m),b=n.runWebGLProgram(g,[p,f],p.dtype);h.push(b);const y=pa({inputs:{x:b},backend:n,attrs:{shape:l.outputShape}});return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),y}const Wu={kernelName:i["GatherV2"],backendName:"webgl",kernelFunc:zu},Vu="return float(a > b);",Uu="\n  return vec4(greaterThan(a, b));\n",Gu=aa({opSnippet:Vu,packedOpSnippet:Uu,cpuKernelImpl:yn,dtype:"bool"}),Hu={kernelName:i["Greater"],backendName:"webgl",kernelFunc:Gu},qu="return float(a >= b);",Ku="\n  return vec4(greaterThanEqual(a, b));\n",Xu=aa({opSnippet:qu,packedOpSnippet:Ku,dtype:"bool",cpuKernelImpl:vn}),Yu={kernelName:i["GreaterEqual"],backendName:"webgl",kernelFunc:Xu};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ju(t){const{inputs:e,backend:n}=t,{input:r}=e;return du(r,!0,n)}const Zu={kernelName:i["IFFT"],backendName:"webgl",kernelFunc:Ju},Qu="return float(!isnan(x) && !isinf(x));",tc=ra({opSnippet:Qu,dtype:"bool"}),ec={kernelName:i["IsFinite"],backendName:"webgl",kernelFunc:tc},nc="return float(isinf(x));",rc=ra({opSnippet:nc,dtype:"bool"}),ac={kernelName:i["IsInf"],backendName:"webgl",kernelFunc:rc},ic="return float(isnan(x));",oc=ra({opSnippet:ic,dtype:"bool"}),sc={kernelName:i["IsNan"],backendName:"webgl",kernelFunc:oc},uc="return float(a < b);",cc="\n  return vec4(lessThan(a, b));\n",lc=aa({opSnippet:uc,packedOpSnippet:cc,cpuKernelImpl:xn,dtype:"bool"}),dc={kernelName:i["Less"],backendName:"webgl",kernelFunc:lc},hc="return float(a <= b);",pc="\n  return vec4(lessThanEqual(a, b));\n",fc=aa({opSnippet:hc,packedOpSnippet:pc,cpuKernelImpl:wn,dtype:"bool"}),mc={kernelName:i["LessEqual"],backendName:"webgl",kernelFunc:fc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gc(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=kn(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const bc={kernelName:i["LinSpace"],backendName:"webgl",kernelFunc:gc},yc=na+"\n  return x < 0.0 ? 0./0. : log(x);\n",vc="\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",xc=ra({opSnippet:yc,packedOpSnippet:vc,cpuKernelImpl:Sn}),wc={kernelName:i["Log"],backendName:"webgl",kernelFunc:xc},kc=na+"\n  return log(1.0 + x);\n",Sc=ra({opSnippet:kc}),Oc={kernelName:i["Log1p"],backendName:"webgl",kernelFunc:Sc},_c="return float(a >= 1.0 && b >= 1.0);",Cc="\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",Tc=aa({opSnippet:_c,packedOpSnippet:Cc,dtype:"bool"}),Ic={kernelName:i["LogicalAnd"],backendName:"webgl",kernelFunc:Tc},Nc="return float(!(x >= 1.0));",Ec=ra({opSnippet:Nc}),Ac={kernelName:i["LogicalNot"],backendName:"webgl",kernelFunc:Ec},Rc="return float(a >= 1.0 || b >= 1.0);",jc="\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",Dc=aa({opSnippet:Rc,packedOpSnippet:jc,dtype:"bool"}),Fc={kernelName:i["LogicalOr"],backendName:"webgl",kernelFunc:Dc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Mc{constructor(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[];const i=e,o=t[3]-1;let s;this.outputShape=t;const u=`float(${n}) + float(${r}) * sum`;s=.5===a?`inversesqrt(${u})`:1===a?`1.0/(${u})`:`exp(log(${u}) * float(-${a}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${i}; j <= ${i}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${o}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${s};\n        setOutput(val);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pc{constructor(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=e,o=t[3]-1;let s;this.outputShape=t;const u=`float(${n}) + float(${r}) * sum`;s=.5===a?`inversesqrt(${u})`:1===a?`1.0/(${u})`:`exp(log(${u}) * float(-${a}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${i};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${i}; j <= ${i}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${s};\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $c=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:o,bias:s,alpha:u,beta:c}=r,l=Object(i["env"])().getBool("WEBGL_PACK_NORMALIZATION")?new Pc(a.shape,o,s,u,c):new Mc(a.shape,o,s,u,c);return n.runWebGLProgram(l,[a],a.dtype)},Lc={kernelName:i["LRN"],backendName:"webgl",kernelFunc:$c};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Bc{constructor(t,e,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=a,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${e})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${e} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${r}) * norm + float(${n});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${r})\n                * float(${a})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${a});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zc=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:u,alpha:c,beta:l}=r,d=new Bc(a.shape,s,u,c,l);return n.runWebGLProgram(d,[a,i,o],a.dtype)},Wc={kernelName:i["LRNGrad"],backendName:"webgl",kernelFunc:zc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vc(t,e,n,r){const a=i["util"].sizeFromShape(e),o=i["util"].sizeFromShape(t.shape),s=o/a,u=pa({inputs:{x:t},attrs:{shape:[s,a]},backend:r}),c=ya(u,t.dtype,"max",r),l=pa({inputs:{x:c},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),l}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uc(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:o,keepDims:s}=r,u=a.shape.length,c=i["util"].parseAxisParam(o,a.shape);let l=c;const d=i["backend_util"].getAxesPermutation(l,u),h=null!=d,p=n.shouldExecuteOnCPU([a]);let f=a;if(h){if(p){const t=n.texData.get(f.dataId),e=t.values,r=new Array(u);for(let n=0;n<r.length;n++)r[n]=a.shape[d[n]];const i=Yn(e,a.shape,a.dtype,d,r);f=n.makeTensorInfo(r,a.dtype);const o=n.texData.get(f.dataId);o.values=i}else f=ka(a,d,n);l=i["backend_util"].getInnerMostAxes(l.length,u)}i["backend_util"].assertAxesAreInnerMostDims("max",l,u);const[m,g]=i["backend_util"].computeOutAndReduceShapes(f.shape,l);let b,y=m;if(s&&(y=i["backend_util"].expandShapeToKeepDim(m,c)),p){const t=n.texData.get(f.dataId),e=t.values,r=On(e,i["util"].sizeFromShape(g),y,a.dtype);b=n.makeTensorInfo(y,a.dtype);const o=n.texData.get(b.dataId);o.values=r}else b=Vc(f,g,y,n);return h&&n.disposeIntermediateTensorInfo(f),b}const Gc={kernelName:i["Max"],backendName:"webgl",kernelFunc:Uc},Hc=Br+"\n  return max(a, b);\n",qc="\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Wr+"\n  return result;\n",Kc=aa({opSnippet:Hc,packedOpSnippet:qc,cpuKernelImpl:_n}),Xc={kernelName:i["Maximum"],backendName:"webgl",kernelFunc:Kc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yc(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;xt(a,"maxPool");const{filterSize:o,strides:s,pad:u,dimRoundingMode:c}=r,l=1;i["util"].assert(i["backend_util"].eitherStridesOrDilationsAreOne(s,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`);const d=i["backend_util"].computePool2DInfo(a.shape,o,s,l,u,c);if(1===d.filterWidth&&1===d.filterHeight&&i["util"].arraysEqual(d.inShape,d.outShape))return Ur({inputs:{x:a},backend:n});const h=new Si(d,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}const Jc={kernelName:i["MaxPool"],backendName:"webgl",kernelFunc:Yc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zc(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:o,strides:s,pad:u,dataFormat:c,dimRoundingMode:l}=r,d=[1,1,1],h=i["backend_util"].computePool3DInfo(a.shape,o,s,d,u,l,c),p=new Oi(h,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}const Qc={kernelName:i["MaxPool3D"],backendName:"webgl",kernelFunc:Zc};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tl{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,s=i-1-t.padInfo.left,u=a*i-1;this.userCode=`\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${a};\n          wR += ${r}) {\n          float dyR = float(dyRCorner + wR) / ${e}.0;\n\n          if (dyR < 0.0 || dyR >= ${t.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${i}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${n}.0;\n\n            if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${i} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class el{constructor(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;const e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,d=u-1-t.padInfo.top,h=c-1-t.padInfo.left,p=s*u*c-1;this.userCode=`\n      const ivec3 pads = ivec3(${l}, ${d}, ${h});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${s};\n           wD += ${a}) {\n          float dyD = float(dyDCorner + wD) / ${e}.0;\n\n          if (dyD < 0.0 || dyD >= ${t.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${u};\n              wR += ${i}) {\n            float dyR = float(dyRCorner + wR) / ${n}.0;\n\n            if (dyR < 0.0 || dyR >= ${t.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${c};\n                wC += ${o}) {\n              float dyC = float(dyCCorner + wC) / ${r}.0;\n\n              if (dyC < 0.0 || dyC >= ${t.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${u} * ${c} +\n                  wR * ${c} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nl(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:o}=e,s=o,{filterSize:u,strides:c,pad:l,dimRoundingMode:d}=r,h=[1,1,1],p=i["backend_util"].computePool3DInfo(s.shape,u,c,h,l,d),f=new Oi(p,"max",!0),m=n.runWebGLProgram(f,[s],s.dtype),g=new el(p),b=n.runWebGLProgram(g,[a,m],s.dtype);return n.disposeIntermediateTensorInfo(m),b}const rl={kernelName:i["MaxPool3DGrad"],backendName:"webgl",kernelFunc:nl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function al(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:o,output:s}=e,u=o;xt([o,s],"maxPoolGrad");const{filterSize:c,strides:l,pad:d,dimRoundingMode:h}=r,p=i["backend_util"].computePool2DInfo(u.shape,c,l,1,d,h),f=!0,m=new Si(p,"max",f),g=n.runWebGLProgram(m,[u],u.dtype),b=new tl(p),y=n.runWebGLProgram(b,[a,g],u.dtype);return n.disposeIntermediateTensorInfo(g),y}const il={kernelName:i["MaxPoolGrad"],backendName:"webgl",kernelFunc:al};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ol(t,e,n,r){let a=new Si(n,"max",!1);const i=r.runWebGLProgram(a,[t],"float32");a=new Si(n,"max",!0,!0,e);const o=r.runWebGLProgram(a,[t],"float32");return[i,o]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sl={kernelName:i["MaxPoolWithArgmax"],backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:o,pad:s,includeBatchInIndex:u}=e,c=n;i["util"].assert(4===r.shape.length,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const l=[1,1];i["util"].assert(i["backend_util"].eitherStridesOrDilationsAreOne(o,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${l}'`);const d=i["backend_util"].computePool2DInfo(r.shape,a,o,l,s),[h,p]=ol(r,u,d,c);return[h,p]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ul(t,e,n,r){const a=i["util"].sizeFromShape(e),o=i["util"].sizeFromShape(t.shape),s=o/a,u=pa({inputs:{x:t},attrs:{shape:[s,a]},backend:r}),c=ya(u,"float32","mean",r),l=pa({inputs:{x:c},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),l}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cl={kernelName:i["Mean"],backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:a,axis:o}=e,s=n,u=r.shape.length,c=i["util"].parseAxisParam(o,r.shape);let l=c;const d=i["backend_util"].getAxesPermutation(l,u),h=null!=d,p=s.shouldExecuteOnCPU([r]),f=[];let m=r;if(h){if(p){const t=s.texData.get(m.dataId),e=t.values,n=new Array(u);for(let o=0;o<n.length;o++)n[o]=r.shape[d[o]];const a=Yn(e,r.shape,r.dtype,d,n);m=s.makeTensorInfo(n,r.dtype);const i=s.texData.get(m.dataId);i.values=a}else m=ka(r,d,s);f.push(m),l=i["backend_util"].getInnerMostAxes(l.length,u)}i["backend_util"].assertAxesAreInnerMostDims("sum",l,u);const[g,b]=i["backend_util"].computeOutAndReduceShapes(m.shape,l);let y=g;a&&(y=i["backend_util"].expandShapeToKeepDim(g,c));const v=ul(m,b,y,s);for(const i of f)s.disposeIntermediateTensorInfo(i);return v}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ll(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o,keepDims:s}=r,u=a.shape.length,c=i["util"].parseAxisParam(o,a.shape);let l=c;const d=i["backend_util"].getAxesPermutation(l,u);let h=a;null!=d&&(h=Ca({inputs:{x:a},backend:n,attrs:{perm:d}}),l=i["backend_util"].getInnerMostAxes(l.length,a.shape.length)),i["backend_util"].assertAxesAreInnerMostDims("min",l,u);const[p,f]=i["backend_util"].computeOutAndReduceShapes(h.shape,l),m=i["util"].sizeFromShape(f),g=pa({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),b=ya(g,g.dtype,"min",n);let y;if(s){const t=i["backend_util"].expandShapeToKeepDim(p,c);y=pa({inputs:{x:b},backend:n,attrs:{shape:t}})}else y=pa({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),null!=d&&n.disposeIntermediateTensorInfo(h),y}const dl={kernelName:i["Min"],backendName:"webgl",kernelFunc:ll},hl=Br+"\n  return min(a, b);\n",pl="\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Wr+"\n  return result;\n",fl=aa({opSnippet:hl,packedOpSnippet:pl,cpuKernelImpl:Cn}),ml={kernelName:i["Minimum"],backendName:"webgl",kernelFunc:fl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class gl{constructor(t,e,n){this.variableNames=["x"],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=ye(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u="reflect"===n?0:1;this.userCode=1!==r?`\n      ${a} start = ${a}(${i});\n      ${a} end = ${a}(${o});\n\n      void main() {\n        ${a} outC = getOutputCoords();\n        for (int i = 0; i < ${r}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${u};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};\n          }\n        }\n        ${a} coords = outC - start;\n        setOutput(getX(${s}));\n      }\n    `:`\n        int start = ${i};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${u};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${u};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bl{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=ye(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=Qn("rc",r),u=Qn("source",r),c=`${s[r-1]} < ${this.outputShape[r-1]}`,l=1===r?"source":`vec2(${u.slice(-2).join()})`,d="reflect"===n?0:1;let h="";if(1===r){const t=`\n        ${a} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${d};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${d};\n        }\n        source -= start;\n      `;h=`\n        ${a} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${u.join()}), ${l});\n        ${s[r-1]} += 1;\n        if(${c}) {\n          ${t}\n          result[1] = getChannel(getX(${u.join()}), ${l});\n        }\n      `}else{const t=`\n        ${a} source = rc;\n        ${a} lt = ${a}(lessThan(source, start));\n        ${a} gte = ${a}(greaterThanEqual(source, end));\n        ${a} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${d}) +\n                gte * ((end - 1) * 2 - source + ${d});\n        source -= start;\n      `;h=`\n        ${a} rc = outputLoc;\n        ${t}\n        result[0] = getChannel(getX(${u.join()}), ${l});\n        ${s[r-1]} += 1;\n        if(${c}) {\n          ${t}\n          result[1] = getChannel(getX(${u.join()}), ${l});\n        }\n        rc = outputLoc;\n        ${s[r-2]} += 1;\n        if(${s[r-2]} < ${this.outputShape[r-2]}) {\n          ${t}\n          result[2] = getChannel(getX(${u.join()}), ${l});\n          ${s[r-1]} += 1;\n          if(${c}) {\n            ${t}\n            result[3] = getChannel(getX(${u.join()}), ${l});\n          }\n        }\n      `}this.userCode=`\n      const ${a} start = ${a}(${i});\n      const ${a} end = ${a}(${o});\n\n      void main() {\n        ${a} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yl=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:a,mode:o}=n,s=Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bl(r.shape,a,o):new gl(r.shape,a,o),u=e.runWebGLProgram(s,[r],r.dtype);return u},vl={kernelName:i["MirrorPad"],backendName:"webgl",kernelFunc:yl},xl="if (b == 0.0) return NAN;\n  return mod(a, b);",wl="\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Wr+"\n  return result;\n",kl=aa({opSnippet:xl,packedOpSnippet:wl}),Sl={kernelName:i["Mod"],backendName:"webgl",kernelFunc:kl};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ol{constructor(t,e,n){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[t,n],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${e-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${e-1}));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _l="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",Cl="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",Tl=aa({opSnippet:_l,packedOpSnippet:Cl,checkOutOfBounds:!0}),Il={kernelName:i["RealDiv"],backendName:"webgl",kernelFunc:Tl},Nl="return a - b;",El=aa({opSnippet:Nl,packedOpSnippet:Nl,supportsComplex:!0,cpuKernelImpl:qn}),Al={kernelName:i["Sub"],backendName:"webgl",kernelFunc:El};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Rl(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:o}=r,s=i["util"].parseAxisParam([o],a.shape),u=Uc({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),c=i["backend_util"].expandShapeToKeepDim(u.shape,s),l=pa({inputs:{x:u},backend:n,attrs:{shape:c}}),d=El({inputs:{a:a,b:l},backend:n}),h=ru({inputs:{x:d},backend:n}),p=Oa({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),f=pa({inputs:{x:p},backend:n,attrs:{shape:c}}),m=Tl({inputs:{a:h,b:f},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}const jl={kernelName:i["Softmax"],backendName:"webgl",kernelFunc:Rl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dl(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r,u=s?a:Rl({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),c=u.shape[0],l=u.shape[1],d=new Ol(c,l,i),h=[[o]],p=n.runWebGLProgram(d,[u],"int32",h);return s||n.disposeIntermediateTensorInfo(u),p}const Fl={kernelName:i["Multinomial"],backendName:"webgl",kernelFunc:Dl},Ml=hr+"\n  return -x;\n",Pl="\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const t=n.texData.get(r.dataId),[e,a]=In(t.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,e)}let a;return a=Object(i["env"])().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new _r(r.shape,Pl):new dr(r.shape,Ml),n.runWebGLProgram(a,[r],r.dtype)}const Ll={kernelName:i["Neg"],backendName:"webgl",kernelFunc:$l},Bl=i["kernel_impls"].nonMaxSuppressionV3Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zl(t){i["backend_util"].warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c}=r,l=n.readSync(a.dataId),d=n.readSync(o.dataId),{selectedIndices:h}=Bl(l,d,s,u,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Wl={kernelName:i["NonMaxSuppressionV3"],backendName:"webgl",kernelFunc:zl},Vl=i["kernel_impls"].nonMaxSuppressionV4Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(t){i["backend_util"].warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c,padToMaxOutputSize:l}=r,d=n.readSync(a.dataId),h=n.readSync(o.dataId),{selectedIndices:p,validOutputs:f}=Vl(d,h,s,u,c,l);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const Gl={kernelName:i["NonMaxSuppressionV4"],backendName:"webgl",kernelFunc:Ul},Hl=i["kernel_impls"].nonMaxSuppressionV5Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(t){i["backend_util"].warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=r,d=n.readSync(a.dataId),h=n.readSync(o.dataId),p=s,f=u,m=c,g=l,{selectedIndices:b,selectedScores:y}=Hl(d,h,p,f,m,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Kl={kernelName:i["NonMaxSuppressionV5"],backendName:"webgl",kernelFunc:ql};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xl{constructor(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${r}), float(${n}),\n                      float(index == coords.y)));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yl=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:o,depth:s,onValue:u,offValue:c}=r,l=i["util"].sizeFromShape(a.shape),d=new Xl(l,s,u,c),h=pa({inputs:{x:a},backend:n,attrs:{shape:[l]}}),p=n.runWebGLProgram(d,[h],o);n.disposeIntermediateTensorInfo(h);const f=[...a.shape,s],m=pa({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),m},Jl={kernelName:i["OneHot"],backendName:"webgl",kernelFunc:Yl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Zl(t){const{inputs:e,backend:n}=t,{x:r}=e;if("complex64"===r.dtype){const t=ro({inputs:{input:r},backend:n}),e=Zl({inputs:{x:t},backend:n}),a=Oo({inputs:{input:r},backend:n}),i=Zl({inputs:{x:a},backend:n}),o=Hr({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return mu({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}const Ql={kernelName:i["ZerosLike"],backendName:"webgl",kernelFunc:Zl};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function td(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===r.dtype){const t=ro({inputs:{input:r},backend:n}),e=td({inputs:{x:t},backend:n}),a=Oo({inputs:{input:r},backend:n}),i=Zl({inputs:{x:a},backend:n}),o=Hr({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return mu({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const ed={kernelName:i["OnesLike"],backendName:"webgl",kernelFunc:td};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nd(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(1===e.length)return iu({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const o=e[0].shape,s=e[0].dtype;e.forEach(t=>{i["util"].assertShapesMatch(o,t.shape,"All tensors passed to stack must have matching shapes"),i["util"].assert(s===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const u=[],c=e.map(t=>{const e=iu({inputs:{input:t},backend:n,attrs:{dim:a}});return u.push(e),e}),l=Io({inputs:c,backend:n,attrs:{axis:a}});return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),l}const rd={kernelName:i["Pack"],backendName:"webgl",kernelFunc:nd};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ad{constructor(t,e,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=ye(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${a} start = ${a}(${i});\n      ${a} end = ${a}(${o});\n\n      void main() {\n        ${a} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${a} coords = outC - start;\n          setOutput(getX(${s}));\n        }\n      }\n    `:`\n        int start = ${i};\n        int end = ${o};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class id{constructor(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=e.map((e,n)=>e[0]+t[n]+e[1]);const r=t.length,a=ye(r),i=e.map(t=>t[0]).join(","),o=e.map((e,n)=>e[0]+t[n]).join(","),s=Qn("rc",r),u=Qn("source",r),c=`${s[r-1]} < ${this.outputShape[r-1]}`,l=1===r?"source":`vec2(${u.slice(-2).join()})`,d=[a+" rc = outputLoc;",`${s[r-1]} += 1;\n       if(${c}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${s[r-2]} += 1;\n       if(${s[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${s[r-1]} += 1;\n         if(${c}) {`],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let f=0,m=1===r?2:4;f<m;f++)p+=`\n        ${d[f]}\n        if (${h}) {\n          result[${f}] = float(value);\n        } else {\n          ${a} source = rc - start;\n          result[${f}] = getChannel(getX(${u.join()}), ${l});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${a} start = ${a}(${i});\n      const ${a} end = ${a}(${o});\n\n      void main() {\n        ${a} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const od=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:o,constantValue:s}=r;if(0===i["util"].sizeFromShape(a.shape)){const t=o.map((t,e)=>t[0]+a.shape[e]+t[1]);return mu({backend:n,attrs:{shape:t,value:s,dtype:a.dtype}})}const u=Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new id(a.shape,o,s):new ad(a.shape,o,s),c=[[s]];return n.runWebGLProgram(u,[a],a.dtype,c)},sd={kernelName:i["PadV2"],backendName:"webgl",kernelFunc:od},ud="\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",cd="\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Wr+"\n  return result;\n",ld=aa({opSnippet:ud,packedOpSnippet:cd}),dd={kernelName:i["Pow"],backendName:"webgl",kernelFunc:ld};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hd(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:o,keepDims:s}=r,u=a.shape.length,c=[],l=i["util"].parseAxisParam(o,a.shape);let d=l;const h=i["backend_util"].getAxesPermutation(d,u);let p,f=a;if(null!=h&&(f=Ca({inputs:{x:a},backend:n,attrs:{perm:h}}),d=i["backend_util"].getInnerMostAxes(d.length,u),c.push(f)),i["backend_util"].assertAxesAreInnerMostDims("prod",d,u),n.shouldExecuteOnCPU([f])){const t=n.texData.get(f.dataId).values,{outVals:e,outShape:r,outDtype:a}=En(f.shape,f.dtype,t,d);p=n.makeTensorInfo(r,a,e)}else{const[t,e]=i["backend_util"].computeOutAndReduceShapes(f.shape,d),r=i["util"].sizeFromShape(e),o=pa({inputs:{x:f},backend:n,attrs:{shape:[-1,r]}}),s=Object(i["sumOutType"])(a.dtype),u=ya(o,s,"prod",n);p=pa({inputs:{x:u},backend:n,attrs:{shape:t}}),c.push(o),c.push(u)}if(s){c.push(p);const t=i["backend_util"].expandShapeToKeepDim(p.shape,l);p=pa({inputs:{x:p},backend:n,attrs:{shape:t}})}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),p}const pd={kernelName:i["Prod"],backendName:"webgl",kernelFunc:hd};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fd(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,u=a.map(t=>n.readSync(t.dataId)),c=a.map(t=>t.shape),l=n.readSync(i.dataId),d=n.readSync(o.dataId),[h,p,f]=An(u,c,l,i.shape,i.dtype,d,o.shape,s),m=h.map(t=>n.makeTensorInfo([t.length],"int32",t)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}const md={kernelName:i["RaggedGather"],backendName:"webgl",kernelFunc:fd};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:u}=r,c=n.readSync(a.dataId),l=n.readSync(i.dataId),d=n.readSync(o.dataId),h=s.map(t=>n.readSync(t.dataId)),p=s.map(t=>t.shape),[f,m]=Rn(c,a.shape,l,i.shape,i.dtype,d,o.shape,h,p,u);return n.makeTensorInfo(f,i.dtype,m)}const bd={kernelName:i["RaggedTensorToTensor"],backendName:"webgl",kernelFunc:gd},yd=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:i,dtype:o}=n,s=jn(r,a,i,o);return e.makeTensorInfo([s.length],o,s)},vd={kernelName:i["Range"],backendName:"webgl",kernelFunc:yd},xd="return 1.0 / x;",wd=ra({opSnippet:xd}),kd={kernelName:i["Reciprocal"],backendName:"webgl",kernelFunc:wd},Sd=hr+"\n  return (x < 0.0) ? 0.0 : x;\n",Od="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",_d=ra({opSnippet:Sd,packedOpSnippet:Od}),Cd={kernelName:i["Relu"],backendName:"webgl",kernelFunc:_d},Td=hr+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",Id="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Nd=ra({opSnippet:Td,packedOpSnippet:Id}),Ed={kernelName:i["Relu6"],backendName:"webgl",kernelFunc:Nd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ad{constructor(t,e,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,u]=t;this.outputShape=[i,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let d;d=a?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rd{constructor(t,e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,u]=t;this.outputShape=[i,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n];let d;d=a?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]},\n          ${c[1]/l[1]});\n      const vec3 inputShapeRC = vec3(${o}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jd(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:o,halfPixelCenters:s,size:u}=r,[c,l]=u,d=Object(i["env"])().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Rd(a.shape,c,l,o,s):new Ad(a.shape,c,l,o,s);return n.runWebGLProgram(d,[a],"float32")}const Dd={kernelName:i["ResizeBilinear"],backendName:"webgl",kernelFunc:jd};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fd{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],u=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],d=1/c,h=1/l,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${c});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new Fd(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const Pd={kernelName:i["ResizeBilinearGrad"],backendName:"webgl",kernelFunc:Md};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $d{constructor(t,e,n,r,a){this.variableNames=["A"],this.outputShape=[];const[i,o,s,u]=t;this.outputShape=[i,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=a?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ld{constructor(t,e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,o,s,u]=t;this.outputShape=[i,e,n,u];const c=[r&&e>1?o-1:o,r&&n>1?s-1:s],l=[r&&e>1?e-1:e,r&&n>1?n-1:n],d=r?"0.5":"0.0";let h;h=a?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${c[0]/l[0]},\n          ${c[1]/l[1]},\n          ${c[1]/l[1]});\n      const vec3 inputShapeRC = vec3(${o}.0, ${s}.0,\n                                     ${s}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${u-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bd(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:o,halfPixelCenters:s,size:u}=r,[c,l]=u,d=Object(i["env"])().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ld(a.shape,c,l,o,s):new $d(a.shape,c,l,o,s);return n.runWebGLProgram(d,[a],a.dtype)}const zd={kernelName:i["ResizeNearestNeighbor"],backendName:"webgl",kernelFunc:Bd};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wd{constructor(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e;const[,r,a]=e,[,i,o]=t,s=[n&&i>1?r-1:r,n&&o>1?a-1:a],u=[n&&i>1?i-1:i,n&&o>1?o-1:o],c=s[0]/u[0],l=s[1]/u[1],d=1/c,h=1/l,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${c});\n        const float widthScale = float(${l});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${i}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${o}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${s[0]}) *\n                (float(dyR) / float(${u[0]}));\n\n            float sourceFracCol =\n                float(${s[1]}) *\n                  (float(dyC) / float(${u[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${r}) - 1),\n                ${n} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${a}) - 1),\n                ${n} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vd(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new Wd(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const Ud={kernelName:i["ResizeNearestNeighborGrad"],backendName:"webgl",kernelFunc:Vd};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gd{constructor(t,e){this.variableNames=["x"];const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=t,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${t[0]} - coord - 1));\n        }\n      `);const r=n=>-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - coords[${n}] - 1`:`coords[${n}]`,a=t.map((t,e)=>r(e)).join(","),i=ye(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hd{constructor(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=t.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=t;const r=Qn("rc",n),a=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,i=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,o=ye(n);function s(t){return d(t)}function u(t){return t[n-1]="("+t[n-1]+" + 1)",d(t)}function c(t){return t[n-2]="("+t[n-2]+" + 1)",d(t)}function l(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",d(t)}function d(e){const n=t.map((t,n)=>h(n,e)),r=n.join(","),a=n.slice(-2).join(",");return`getChannel(getX(${r}), vec2(${a}))`}function h(n,r){return-1!==e.indexOf(n)&&1!==t[n]?`${t[n]} - ${r[n]} - 1`:""+r[n]}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${t[0]} - rc - 1),\n            ${t[0]} - rc - 1);\n          if(${a}){\n              result.g = getChannel(getX(${t[0]} - (rc  + 1) - 1),\n                ${t[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${o} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${s(r.slice())};\n          if(${a}){\n            result.g = ${u(r.slice())};\n          }\n          if(${i}) {\n            result.b = ${c(r.slice())};\n            if(${a}) {\n              result.a = ${l(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qd(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:o}=r,s=a.shape.length,u=i["util"].parseAxisParam(o,a.shape);if(0===s)return Ur({inputs:{x:a},backend:n});const c=Object(i["env"])().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hd(a.shape,u):new Gd(a.shape,u);return n.runWebGLProgram(c,[a],a.dtype)}const Kd={kernelName:i["Reverse"],backendName:"webgl",kernelFunc:qd};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xd{constructor(t,e){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const n=t[1],r=t[2];this.outputShape=t;let a="";a="number"===typeof e?`float outputValue = ${e.toFixed(2)};`:`\n        vec3 fill = vec3(${e.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${a}\n          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yd={kernelName:i["RotateWithOffset"],backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:o,center:s}=e,u=n,c=new Xd(r.shape,o),[l,d]=i["backend_util"].getImageCenter(s,r.shape[1],r.shape[2]),h=[[l,d,Math.sin(a),Math.cos(a)]],p=u.runWebGLProgram(c,[r],r.dtype,h);return p}},Jd="\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n",Zd=ra({opSnippet:Jd}),Qd={kernelName:i["Round"],backendName:"webgl",kernelFunc:Zd},th="return inversesqrt(x);",eh=ra({opSnippet:th,cpuKernelImpl:Dn}),nh={kernelName:i["Rsqrt"],backendName:"webgl",kernelFunc:eh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class rh{constructor(t,e,n,r,a,i,o=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const s=ye(a.length),u=ye(i.length);let c="";1===n?c="i":2===n&&(c="i, j");const l=`getIndices(${c})`;let d="";1===r?d="i":2===r&&(d="i, coords[1]");const h=`getUpdates(${d})`,p=e>1?"strides[j]":"strides";this.userCode=`\n        ${s} strides = ${s}(${a});\n\n        void main() {\n          ${u} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${t}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${e}; j++) {\n              int index = round(${l});\n              flattenedIndex += index * ${p};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${h};\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ah(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:o}=e,{shape:s}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:d,outputSize:h}=i["backend_util"].calculateShapes(o,a,s),p=[h/l,l];if(0===h)return n.makeTensorInfo(s,a.dtype);const f=pa({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),m=pa({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),b=new rh(c,u,f.shape.length,m.shape.length,d,p),y=n.runWebGLProgram(b,[m,f,g],m.dtype),v=pa({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),v}const ih={kernelName:i["ScatterNd"],backendName:"webgl",kernelFunc:ah};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oh{constructor(t,e,n,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[t,n];const a="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(e+1))}; ++i) { if (left >= right) break;`,s=2===Object(i["env"])().getNumber("WEBGL_VERSION")?a:o,u="left"===r?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${s}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${u} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=new oh(a.shape[0],a.shape[1],i.shape[1],o),u=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",u)}const uh={kernelName:i["SearchSorted"],backendName:"webgl",kernelFunc:sh};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ch{constructor(t,e,n){let r,a;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error(`Where for rank ${n} is not yet supported`);if(1===n)a="resRC",r="resRC";else{const n=["resRC.x","resRC.y","resRC.z","resRC.w"],i=[],o=[];for(let r=0;r<e.length;r++)o.push(""+n[r]),r<t&&i.push(""+n[r]);r=i.join(),a=o.join()}const i=ye(n);this.userCode=`\n      void main() {\n        ${i} resRC = getOutputCoords();\n        float cVal = getC(${r});\n        if (cVal >= 1.0) {\n          setOutput(getA(${a}));\n        } else {\n          setOutput(getB(${a}));\n        }\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lh(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:o}=e,s=new ch(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,o],Object(i["upcastType"])(a.dtype,o.dtype))}const dh={kernelName:i["Select"],backendName:"webgl",kernelFunc:lh},hh=`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${i["backend_util"].SELU_SCALEALPHA};\n  float scale = ${i["backend_util"].SELU_SCALE};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`,ph=ra({opSnippet:hh}),fh={kernelName:i["Selu"],backendName:"webgl",kernelFunc:ph},mh=na+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",gh="\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",bh=ra({opSnippet:mh,packedOpSnippet:gh,cpuKernelImpl:Mn}),yh={kernelName:i["Sigmoid"],backendName:"webgl",kernelFunc:bh},vh="\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n",xh=ra({opSnippet:vh}),wh={kernelName:i["Sign"],backendName:"webgl",kernelFunc:xh},kh=na+"\n  return sin(x);\n",Sh=ra({opSnippet:kh}),Oh={kernelName:i["Sin"],backendName:"webgl",kernelFunc:Sh},_h="\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n",Ch=ra({opSnippet:_h}),Th={kernelName:i["Sinh"],backendName:"webgl",kernelFunc:Ch},Ih="\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n",Nh=ra({opSnippet:Ih}),Eh={kernelName:i["Softplus"],backendName:"webgl",kernelFunc:Nh},Ah=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:o,paddings:s}=r;i["util"].assert(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const u=o.reduce((t,e)=>t*e),c=[[0,0]];c.push(...s);for(let i=1+o.length;i<a.shape.length;++i)c.push([0,0]);const l=[],d=od({inputs:{x:a},backend:n,attrs:{paddings:c,constantValue:0}}),h=i["backend_util"].getReshaped(d.shape,o,u,!1),p=i["backend_util"].getPermuted(h.length,o.length,!1),f=i["backend_util"].getReshapedPermuted(d.shape,o,u,!1),m=pa({inputs:{x:d},backend:n,attrs:{shape:h}}),g=Ca({inputs:{x:m},backend:n,attrs:{perm:p}}),b=pa({inputs:{x:g},backend:n,attrs:{shape:f}});return l.push(d),l.push(m),l.push(g),l.forEach(t=>n.disposeIntermediateTensorInfo(t)),b},Rh={kernelName:i["SpaceToBatchND"],backendName:"webgl",kernelFunc:Ah};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function jh(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n         "+i.shape);if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n         "+r.shape);if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n         "+a.shape);if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        "+o.shape);const s=n.readSync(r.dataId),u=n.readSync(a.dataId),c=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[d,h,p,f,m]=Ln(s,r.shape,r.dtype,u,a.dtype,c,l);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],a.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(t=>Number(t)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Dh={kernelName:i["SparseFillEmptyRows"],backendName:"webgl",kernelFunc:jh};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fh(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape "+r.shape);if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape "+a.shape);if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape "+i.shape);const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),u=Array.from(n.readSync(i.dataId)),[c,l,d]=Bn(s,r.shape,r.dtype,o,u);return[n.makeTensorInfo(l,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Mh={kernelName:i["SparseReshape"],backendName:"webgl",kernelFunc:Fh};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ph(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n              "+a.shape);if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n              "+i.shape);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),[c,l]=zn(o,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(l,r.dtype,c)}const $h={kernelName:i["SparseSegmentMean"],backendName:"webgl",kernelFunc:Ph};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lh(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n             "+a.shape);if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n             "+i.shape);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),u=n.readSync(i.dataId),[c,l]=zn(o,r.shape,r.dtype,s,u);return n.makeTensorInfo(l,r.dtype,c)}const Bh={kernelName:i["SparseSegmentSum"],backendName:"webgl",kernelFunc:Lh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zh(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:o,defaultValue:s}=e,{outputShape:u}=r,{sliceRank:c,numUpdates:l,sliceSize:d,strides:h,outputSize:p}=i["backend_util"].calculateShapes(o,a,u),f=!1;if("string"===o.dtype){const t=n.bufferSync(a),e=n.bufferSync(o),r=i["util"].decodeString(n.readSync(s.dataId)[0]),m=Fn(t,e,u,p,d,l,c,h,r,f);return n.makeTensorInfo(u,m.dtype,m.values)}const m=new rh(l,c,a.shape.length,o.shape.length,h,[p,1],f),g=n.runWebGLProgram(m,[o,a,s],o.dtype),b=pa({inputs:{x:g},backend:n,attrs:{shape:u}});return n.disposeIntermediateTensorInfo(g),b}const Wh={kernelName:i["SparseToDense"],backendName:"webgl",kernelFunc:zh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vh(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:o,axis:s}=r,u=i["util"].parseAxisParam(s,a.shape)[0],c=i["backend_util"].prepareSplitSize(a,o,u),l=a.shape.length,d=new Array(l).fill(0),h=a.shape.slice();return c.map(t=>{const e=[...h];e[u]=t;const r=Hi({inputs:{x:a},backend:n,attrs:{begin:d,size:e}});return d[u]+=t,r})}const Uh={kernelName:i["SplitV"],backendName:"webgl",kernelFunc:Vh},Gh="return sqrt(x);",Hh=ra({opSnippet:Gh,packedOpSnippet:Gh,cpuKernelImpl:Wn}),qh={kernelName:i["Sqrt"],backendName:"webgl",kernelFunc:Hh},Kh="return x * x;",Xh=ra({opSnippet:Kh}),Yh={kernelName:i["Square"],backendName:"webgl",kernelFunc:Xh},Jh="return (a - b) * (a - b);",Zh=aa({opSnippet:Jh,packedOpSnippet:Jh}),Qh={kernelName:i["SquaredDifference"],backendName:"webgl",kernelFunc:Zh};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tp({inputs:t,attrs:e,backend:n}){const{x:r}=t,a=hr+`\n    return x > 0.0 ? 1.0 : float(${e.alpha});\n  `,i=new dr(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}const ep={kernelName:i["Step"],backendName:"webgl",kernelFunc:tp};
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class np{constructor(t,e,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,a=ye(n.length),i=ye(n.length);let o="";if(1===r)o="coords * strides + begin";else{let t=0;o=n.map((e,r)=>(t++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${t-1}] * strides[${r}] + begin[${r}]`)).join(",")}this.userCode=`\n      ${a} begin = ${a}(${t});\n      ${a} strides = ${a}(${e});\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${o}));\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rp(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:o,end:s,strides:u,beginMask:c,endMask:l,ellipsisMask:d,newAxisMask:h,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:m,isIdentity:g,sliceDim0:b,isSimpleSlice:y,begin:v,end:x,strides:w}=i["slice_util"].sliceInfo(a.shape,o,s,u,c,l,d,h,p);let k;if(g)k=pa({inputs:{x:a},backend:n,attrs:{shape:m}});else if(b||y){i["util"].assert(a.shape.length>=1,()=>"Input must have rank at least 1, got: "+a.shape.length);const t=i["slice_util"].computeOutShape(v,x,w),e=Hi({inputs:{x:a},backend:n,attrs:{begin:v,size:t}});k=pa({inputs:{x:e},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(e)}else{const t=n.shouldExecuteOnCPU([a]);if(t){const t=n.readSync(a.dataId),e=Object(i["buffer"])(a.shape,a.dtype,t),r=Vn(f,e,w,v);k=n.makeTensorInfo(m,a.dtype,r.values)}else{const t=new np(v,w,f);k=n.runWebGLProgram(t,[a],a.dtype)}}const S=pa({inputs:{x:k},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(k),S}const ap={kernelName:i["StridedSlice"],backendName:"webgl",kernelFunc:rp};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ip(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:d}=e,h=n.readSync(l.dataId),p=n.readSync(d.dataId),[f,m]=Un(h,p,a,i,o,s,u,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const op={kernelName:i["StringNGrams"],backendName:"webgl",kernelFunc:ip};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sp(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: "+i.shape);if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: "+o.shape);const s=n.readSync(i.dataId),u=n.readSync(o.dataId)[0],[c,l,d]=Gn(s,u,a),h=l.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const up={kernelName:i["StringSplit"],backendName:"webgl",kernelFunc:sp};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cp(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=Hn(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const lp={kernelName:i["StringToHashBucketFast"],backendName:"webgl",kernelFunc:cp},dp="return tan(x);",hp=ra({opSnippet:dp}),pp={kernelName:i["Tan"],backendName:"webgl",kernelFunc:hp},fp="\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n",mp=ra({opSnippet:fp}),gp={kernelName:i["Tanh"],backendName:"webgl",kernelFunc:mp};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class bp{constructor(t,e){this.variableNames=["A"];const n=new Array(t.length);for(let i=0;i<n.length;i++)n[i]=t[i]*e[i];this.outputShape=n,this.rank=n.length;const r=ye(this.rank),a=yp(t);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        setOutput(getA(${a}));\n      }\n    `}}function yp(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(1===e)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<t.length;a++)r.push(`imod(${n[a]}, ${t[a]})`);return r.join()}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vp(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:o}=r;if("string"===a.dtype||a.shape.length>5){const t=n.readSync(a.dataId),e="string"===a.dtype?t.map(t=>i["util"].decodeString(t)):t,r=Object(i["buffer"])(a.shape,a.dtype,e),s=Kn(r,o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const s=new bp(a.shape,o),u=n.runWebGLProgram(s,[a],a.dtype);return u}const xp={kernelName:i["Tile"],backendName:"webgl",kernelFunc:vp};class wp{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=t,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class kp{constructor(t){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=t,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sp(t,e){null!==e&&t.disposeIntermediateTensorInfo(e)}function Op(t){let e=1;while(e<t)e*=2;return e}function _p(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:o,sorted:s}=r,u=Object(i["env"])().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=Object(i["env"])().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),l=a.shape,d=l[l.length-1];if(n.shouldExecuteOnCPU([a])||d<u||o>c){const t=n.readSync(a.dataId),[e,r]=Xn(t,l,a.dtype,o,s);return[n.makeTensorInfo(e.shape,e.dtype,e.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(0===o)return l[l.length-1]=0,[n.makeTensorInfo(l,a.dtype,[]),n.makeTensorInfo(l,"int32",[])];if(1===d)return[a,mu({attrs:{shape:l,dtype:"int32",value:0},backend:n})];const h=n.texData.get(a.dataId),p=null!==h&&h.isPacked,f=p?n.unpackTensor(a):a,m=i["util"].sizeFromShape(l),g=m/d,b=pa({inputs:{x:f},attrs:{shape:[g,d]},backend:n});p&&Sp(n,f);const y=Op(o),v=Op(d);let x=null;const w=()=>null===x?[b,b]:[b,x],k=(t,e,r)=>{const a=w(),i=new wp(r),o=null===x?1:0,s=[[d],[o],[Number.NEGATIVE_INFINITY],[t],[e]],u=x;x=n.runWebGLProgram(i,a,"int32",s),Sp(n,u)};for(let i=1;i<y;i*=2){const t=2*i;for(let e=i;e>=1;e/=2)k(t,e,[g,v])}for(let i=v;i>y;i/=2){const t=w(),e=new kp([g,i/2]),r=null===x?1:0,a=[[d],[r],[y]],o=x;x=n.runWebGLProgram(e,t,"int32",a),Sp(n,o);const s=y/2,u=2*s;for(let n=s;n>=1;n/=2)k(u,n,x.shape)}let S=x;x=Hi({inputs:{x:x},backend:n,attrs:{begin:0,size:[g,o]}}),Sp(n,S);let O=zu({inputs:{x:b,indices:x},backend:n,attrs:{axis:1,batchDims:1}});Sp(n,b);const _=l.slice(0,-1);_.push(o),S=x,x=pa({inputs:{x:x},attrs:{shape:_},backend:n}),Sp(n,S);const C=O;return O=pa({inputs:{x:O},attrs:{shape:_},backend:n}),Sp(n,C),[O,x]}const Cp={kernelName:i["TopK"],backendName:"webgl",kernelFunc:_p};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tp{constructor(t,e,n,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const o="nearest"===n?1:2;let s;switch(r){case"constant":s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4;break;default:s=1;break}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${s} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${s} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${t} && 0 <= coordX && coordX < ${e}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${a});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${a});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${e}));\n                float mapY = mapCoord(inY, float(${t}));\n\n                if (${o} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ip(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:u,outputShape:c}=r,[l,d,h,p]=a.shape,[f,m]=null!=c?c:[d,h],g=[l,f,m,p],b=new Tp(d,h,o,s,u,g);return n.runWebGLProgram(b,[a,i],"float32")}const Np={kernelName:i["Transform"],backendName:"webgl",kernelFunc:Ip};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;xt(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:u,indices:c}=Jn(o,a,i.shape,i.dtype);return[r.makeTensorInfo(u,i.dtype,s),r.makeTensorInfo([c.length],"int32",c)]}const Ap={kernelName:i["Unique"],backendName:"webgl",kernelFunc:Ep};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,u=a.shape[i],c=new Array(s-1);let l=0;for(let m=0;m<s;m++)m!==i&&(c[l++]=o.shape[m]);const d=[],h=new Array(s).fill(0),p=o.shape.slice();p[i]=1;const f=new Array(u);for(let m=0;m<f.length;m++){h[i]=m;const t=Hi({inputs:{x:o},backend:n,attrs:{begin:h,size:p}}),e=pa({inputs:{x:t},backend:n,attrs:{shape:c}});f[m]=e,d.push(t)}return d.forEach(t=>n.disposeIntermediateTensorInfo(t)),f}const jp={kernelName:i["Unpack"],backendName:"webgl",kernelFunc:Rp};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dp{constructor(t,e){this.variableNames=["x","segmentIds"];const n=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];const s="0.0",u="sumValue",c=4*Math.floor(n/4),l=n%4,d="\n        sumValue += dot(values, segFilter);\n    ";let h="";a%n>0&&(h=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return initializationValue;\n        }\n      `);let p="";a%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${a}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${s};\n\n      float getValue(int batch, int inIdx) {\n        ${h}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${p}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${i})) * float(${n}));\n        int currentSeg = int(mod(float(outIdx), float(${i})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${c}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${c};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${d}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${d}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${d}\n        }\n        setOutput(${u});\n      }\n    `}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fp(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:o}=e,{numSegments:s}=r,u=a.shape.length,c=[];let l=0;const d=i["backend_util"].getAxesPermutation([l],u);let h=a;null!=d&&(h=Ca({inputs:{x:a},backend:n,attrs:{perm:d}}),c.push(h),l=i["backend_util"].getInnerMostAxes(1,u)[0]);const p=i["backend_util"].segment_util.computeOutShape(h.shape,l,s),f=i["util"].sizeFromShape([h.shape[l]]),m=pa({inputs:{x:h},backend:n,attrs:{shape:[-1,f]}});c.push(m);const g=Object(i["sumOutType"])(a.dtype),b=(t,e,r,a,o)=>{const s=t.shape[0],u=t.shape[1],l=i["backend_util"].segment_util.segOpComputeOptimalWindowSize(u,o),d={windowSize:l,inSize:u,batchSize:s,numSegments:o},h=new Dp(d,e),p=n.compileAndRun(h,[t,r],a);if(c.push(p),p.shape[1]===o)return p;const f=yd({backend:n,attrs:{start:0,stop:o,step:1,dtype:"float32"}}),m=vp({inputs:{x:f},backend:n,attrs:{reps:[u/l]}});c.push(f),c.push(m);const g=b(p,e,m,a,o);return g},y=b(m,"unsortedSegmentSum",o,g,s),v=pa({inputs:{x:y},backend:n,attrs:{shape:p}});let x=v;if(null!=d){c.push(v);const t=i["backend_util"].getUndoAxesPermutation(d);x=Ca({inputs:{x:x},backend:n,attrs:{perm:t}})}return c.forEach(t=>n.disposeIntermediateTensorInfo(t)),x}const Mp={kernelName:i["UnsortedSegmentSum"],backendName:"webgl",kernelFunc:Fp},Pp=[Aa,Da,Pa,Ba,Va,qa,Xa,Ja,ai,oi,ci,hi,mi,vi,ki,Ci,Ii,Ri,Di,Mi,Bi,Xi,Ji,Qi,uo,ho,go,qr,xo,No,$o,Uo,Ho,Ko,Yo,Zo,es,as,ss,fs,gs,ys,ws,_s,Ns,As,Ds,Ps,Ls,Vs,qs,Js,tu,au,ou,cu,pu,gu,yu,wu,_u,Iu,ju,Fu,$u,Wu,Hu,Yu,Gr,Zu,_o,ec,ac,sc,Jr,dc,mc,bc,wc,Oc,Ic,Ac,Fc,Lc,Wc,Gc,Xc,Jc,Qc,rl,il,sl,cl,dl,ml,vl,Sl,Fl,da,Ll,Wl,Gl,Kl,no,Jl,ed,rd,sd,dd,ea,pd,md,bd,vd,ao,Il,kd,Cd,Ed,fa,Dd,Pd,zd,Ud,Kd,Yd,Qd,nh,ih,uh,dh,fh,yh,wh,Oh,Th,qi,jl,Eh,Rh,Dh,Mh,$h,Bh,Wh,Uh,qh,Yh,Qh,ep,ap,op,up,lp,Al,_a,pp,gp,xp,Cp,Np,Ta,Ap,jp,Mp,Ql];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const $p of Pp)Object(i["registerKernel"])($p);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},"0e2f":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]},"0e43":function(t,e,n){"use strict";n("7d1d")},"0ff5":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;var a=n("9cb8"),i=n("ea61"),o=n("4971"),s=n("f0b4"),u=n("f655"),c=n("4546"),l=n("fce6"),d=n("d777"),h="#",p="beforeDraw",f="draw",m=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=m.length,b=function(t){function e(e){var n=t.call(this,e)||this;return n.canvas=new u.SceneCanvas,n.hitCanvas=new u.HitCanvas({pixelRatio:1}),n._waitingForDraw=!1,n.on("visibleChange.konva",n._checkVisibility),n._checkVisibility(),n.on("imageSmoothingEnabledChange.konva",n._setSmoothEnabled),n._setSmoothEnabled(),n}return r(e,t),e.prototype.createPNGStream=function(){var t=this.canvas._canvas;return t.createPNGStream()},e.prototype.getCanvas=function(){return this.canvas},e.prototype.getHitCanvas=function(){return this.hitCanvas},e.prototype.getContext=function(){return this.getCanvas().getContext()},e.prototype.clear=function(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this},e.prototype.setZIndex=function(e){t.prototype.setZIndex.call(this,e);var n=this.getStage();return n&&(n.content.removeChild(this.getCanvas()._canvas),e<n.children.length-1?n.content.insertBefore(this.getCanvas()._canvas,n.children[e+1].getCanvas()._canvas):n.content.appendChild(this.getCanvas()._canvas)),this},e.prototype.moveToTop=function(){o.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&(t.content.removeChild(this.getCanvas()._canvas),t.content.appendChild(this.getCanvas()._canvas)),!0},e.prototype.moveUp=function(){var t=o.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!!e&&(e.content.removeChild(this.getCanvas()._canvas),this.index<e.children.length-1?e.content.insertBefore(this.getCanvas()._canvas,e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getCanvas()._canvas),!0)},e.prototype.moveDown=function(){if(o.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[this.index+1].getCanvas()._canvas)}return!0}return!1},e.prototype.moveToBottom=function(){if(o.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content.removeChild(this.getCanvas()._canvas),t.content.insertBefore(this.getCanvas()._canvas,e[1].getCanvas()._canvas)}return!0}return!1},e.prototype.getLayer=function(){return this},e.prototype.remove=function(){var t=this.getCanvas()._canvas;return o.Node.prototype.remove.call(this),t&&t.parentNode&&a.Util._isInDocument(t)&&t.parentNode.removeChild(t),this},e.prototype.getStage=function(){return this.parent},e.prototype.setSize=function(t){var e=t.width,n=t.height;return this.canvas.setSize(e,n),this.hitCanvas.setSize(e,n),this._setSmoothEnabled(),this},e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to a layer.")},e.prototype._toKonvaCanvas=function(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=void 0!==t.x?t.x:this.x(),t.y=void 0!==t.y?t.y:this.y(),o.Node.prototype._toKonvaCanvas.call(this,t)},e.prototype._checkVisibility=function(){var t=this.visible();this.canvas._canvas.style.display=t?"block":"none"},e.prototype._setSmoothEnabled=function(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()},e.prototype.getWidth=function(){if(this.parent)return this.parent.width()},e.prototype.setWidth=function(){a.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},e.prototype.getHeight=function(){if(this.parent)return this.parent.height()},e.prototype.setHeight=function(){a.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},e.prototype.batchDraw=function(){var t=this;return this._waitingForDraw||(this._waitingForDraw=!0,a.Util.requestAnimFrame((function(){t.draw(),t._waitingForDraw=!1}))),this},e.prototype.getIntersection=function(t,e){if(!this.isListening()||!this.isVisible())return null;var n=1,r=!1;while(1){for(var a=0;a<g;a++){var i=m[a],o=this._getIntersection({x:t.x+i.x*n,y:t.y+i.y*n}),s=o.shape;if(s&&e)return s.findAncestor(e,!0);if(s)return s;if(r=!!o.antialiased,!o.antialiased)break}if(!r)return null;n+=1}},e.prototype._getIntersection=function(t){var e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=n[3];if(255===r){var i=a.Util._rgbToHex(n[0],n[1],n[2]),o=l.shapes[h+i];return o?{shape:o}:{antialiased:!0}}return r>0?{antialiased:!0}:{}},e.prototype.drawScene=function(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas();return this._fire(p,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),i.Container.prototype.drawScene.call(this,r,e),this._fire(f,{node:this}),this},e.prototype.drawHit=function(t,e){var n=this.getLayer(),r=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),i.Container.prototype.drawHit.call(this,r,e),this},e.prototype.enableHitGraph=function(){return this.hitGraphEnabled(!0),this},e.prototype.disableHitGraph=function(){return this.hitGraphEnabled(!1),this},e.prototype.setHitGraphEnabled=function(t){a.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)},e.prototype.getHitGraphEnabled=function(t){return a.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()},e.prototype.toggleHitCanvas=function(){if(this.parent){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}},e}(i.Container);e.Layer=b,b.prototype.nodeType="Layer",d._registerNode(b),s.Factory.addGetterSetter(b,"imageSmoothingEnabled",!0),s.Factory.addGetterSetter(b,"clearBeforeDraw",!0),s.Factory.addGetterSetter(b,"hitGraphEnabled",!0,c.getBooleanValidator()),a.Collection.mapMethods(b)},1001:function(t,e,n){"use strict";n.r(e),n.d(e,"MathBackendCPU",(function(){return o})),n.d(e,"version_cpu",(function(){return u})),n.d(e,"shared",(function(){return s}));var r=n("2ca8"),a=n("60ee");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=r["kernel_impls"].whereImpl;class o extends r["KernelBackend"]{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new r["DataStorage"](this,Object(r["engine"])())}nextDataId(){return o.nextDataId++}write(t,e,n){this.firstUse&&(this.firstUse=!1,Object(r["env"])().get("IS_NODE")&&r["backend_util"].warn("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const a={id:this.nextDataId()};return this.data.set(a,{values:t,dtype:n,refCount:1}),a}makeTensorInfo(t,e,n){let a;if("string"===e&&null!=n&&n.length>0&&r["util"].isString(n[0])){const i=n.map(t=>r["util"].encodeString(t));a=this.write(i,t,e)}else a=this.write(n,t,e);return{dataId:a,shape:t,dtype:e}}refCount(t){if(this.data.has(t)){const e=this.data.get(t);return e.refCount}return 0}incRef(t){const e=this.data.get(t);e.refCount++}decRef(t){if(this.data.has(t)){const e=this.data.get(t);e.refCount--}}move(t,e,n,r,a){this.data.set(t,{values:e,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(t){return this.readSync(t)}readSync(t){const{dtype:e,complexTensorInfos:n}=this.data.get(t);if("complex64"===e){const t=this.readSync(n.real.dataId),e=this.readSync(n.imag.dataId);return r["backend_util"].mergeRealAndImagArrays(t,e)}return this.data.get(t).values}bufferSync(t){const e=this.readSync(t.dataId);if("string"===t.dtype)try{const n=e.map(t=>r["util"].decodeString(t));return Object(r["buffer"])(t.shape,t.dtype,n)}catch(n){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(r["buffer"])(t.shape,t.dtype,e)}makeOutput(t,e,n){return Object(r["engine"])().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,t),this)}disposeData(t,e=!1){if(this.data.has(t)){if(this.data.get(t).refCount--,!e&&this.data.get(t).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(t);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(t)}return!0}disposeIntermediateTensorInfo(t){this.disposeData(t.dataId)}async time(t){const e=r["util"].now();t();const n=r["util"].now()-e;return{kernelMs:n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(t){Object(a["a"])([t],"where");const e=this.readSync(t.dataId);return i(t.shape,e)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}o.nextDataId=0;var s=n("15e3");
/** @license See the LICENSE file. */const u="3.21.0";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object(r["registerBackend"])("cpu",()=>new o,1);var c=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l=Object(c["a"])(r["Elu"],t=>t>=0?t:Math.exp(t)-1),d={kernelName:r["Elu"],backendName:"cpu",kernelFunc:l};var h=n("3a38");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{alpha:s}=i;Object(a["a"])([o],"leakyRelu");const u=r["util"].sizeFromShape(o.shape),c=n.data.get(o.dataId).values,l=r["util"].getTypedArrayFromDType("float32",u);for(let r=0;r<c.length;r++)l[r]=c[r]<0?s*c[r]:c[r];return n.makeTensorInfo(o.shape,"float32",l)}const f={kernelName:r["LeakyRelu"],backendName:"cpu",kernelFunc:p};var m=n("c5c9");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g=Object(m["a"])((t,e)=>t<0?e*t:t);function b(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;Object(a["a"])([r,i],"prelu");const o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[u,c]=g(r.shape,i.shape,o,s,"float32");return n.makeTensorInfo(c,"float32",u)}const y={kernelName:r["Prelu"],backendName:"cpu",kernelFunc:b},v=Object(c["a"])(r["Relu"],t=>Math.max(0,t)),x={kernelName:r["Relu"],backendName:"cpu",kernelFunc:v},w=Object(c["a"])(r["Relu6"],t=>Math.min(Math.max(0,t),6)),k={kernelName:r["Relu6"],backendName:"cpu",kernelFunc:w};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var S=n("af58");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O(t,e,n,r,a){if("linear"===n)return Object(h["a"])({inputs:{x:e},backend:t});if("relu"===n)return v({inputs:{x:e},backend:t});if("elu"===n)return l({inputs:{x:e},backend:t});if("relu6"===n)return w({inputs:{x:e},backend:t});if("prelu"===n)return b({inputs:{x:e,alpha:r},backend:t});if("leakyrelu"===n)return p({inputs:{x:e},backend:t,attrs:{alpha:a}});if("sigmoid"===n)return Object(S["a"])({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}var _=n("7731");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C(t){const{inputs:e,backend:n,attrs:a}=t,{x:i}=e,{shape:o}=a,s=r["util"].sizeFromShape(i.shape),u=r["util"].inferFromImplicitShape(o,s),c=r["util"].sizeFromShape(u);r["util"].assert(s===c,()=>`The new shape (${u}) has ${c} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const l=n.data.get(i.dataId);if(null!=l.complexTensorInfos){const t=l.complexTensorInfos.real,e=l.complexTensorInfos.imag;t.shape=u,e.shape=u}return{dataId:i.dataId,shape:u,dtype:i.dtype}}const T={kernelName:r["Reshape"],backendName:"cpu",kernelFunc:C};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I(t){const{inputs:e,backend:n,attrs:i}=t,{a:o,b:s}=e,{transposeA:u,transposeB:c}=i;Object(a["a"])([o,s],"matMul");const l=o.shape.length,d=s.shape.length,h=u?o.shape[l-2]:o.shape[l-1],p=c?s.shape[d-1]:s.shape[d-2],f=u?o.shape[l-1]:o.shape[l-2],m=c?s.shape[d-2]:s.shape[d-1],g=o.shape.slice(0,-2),b=s.shape.slice(0,-2),y=r["util"].sizeFromShape(g),v=r["util"].sizeFromShape(b),x=r["broadcast_util"].assertAndGetBroadcastShape(o.shape.slice(0,-2),s.shape.slice(0,-2)),w=x.concat([f,m]);r["util"].assert(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${o.shape} and ${s.shape} and transposeA=${u} and transposeB=${c} must match.`);const k=u?[y,h,f]:[y,f,h],S=c?[v,m,p]:[v,p,m],O=C({inputs:{x:o},backend:n,attrs:{shape:k}}),_=C({inputs:{x:s},backend:n,attrs:{shape:S}}),T=u?O.shape[1]:O.shape[2],I=u?O.shape[2]:O.shape[1],N=c?_.shape[1]:_.shape[2],E=Math.max(y,v),A=n.data.get(O.dataId).values,R=n.data.get(_.dataId).values,j=r["util"].computeStrides(O.shape),D=r["util"].computeStrides(_.shape),[F,M,P]=u?[j[0],1,j[1]]:[j[0],j[1],1],[$,L,B]=c?[1,D[1],D[0]]:[D[1],1,D[0]],z=I*N,W=Object(r["buffer"])([E,I,N],O.dtype),V=W.values,U=n.blockSize;for(let r=0;r<E;r++)for(let t=0;t<I;t+=U)for(let e=0;e<N;e+=U)for(let n=0;n<T;n+=U){const a=Math.min(t+U,I),i=Math.min(e+U,N),o=Math.min(n+U,T);for(let s=t;s<a;s++)for(let t=e;t<i;t++){let e=0;for(let a=n;a<o;a++){const n=Math.min(r,y-1)*F,i=Math.min(r,v-1)*B,o=A[n+s*M+a*P],u=R[a*$+t*L+i];e+=o*u}V[r*z+(s*N+t)]+=e}}return n.disposeIntermediateTensorInfo(O),n.disposeIntermediateTensorInfo(_),n.makeTensorInfo(w,W.dtype,W.values)}const N={kernelName:r["BatchMatMul"],backendName:"cpu",kernelFunc:I};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E(t){const{inputs:e,backend:n,attrs:r}=t,{a:a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:d}=r;let h,p,f;const m=[],g=I({inputs:{a:a,b:i},attrs:{transposeA:u,transposeB:c},backend:n});h=g,o&&(p=Object(_["a"])({inputs:{a:h,b:o},backend:n}),m.push(h),h=p),l&&(f=O(n,h,l,s,d),m.push(h),h=f);for(const b of m)n.disposeIntermediateTensorInfo(b);return h}const A={kernelName:r["_FusedMatMul"],backendName:"cpu",kernelFunc:E};var R=n("b547");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j=Object(c["a"])(r["Acos"],t=>Math.acos(t)),D={kernelName:r["Acos"],backendName:"cpu",kernelFunc:j},F=Object(c["a"])(r["Acosh"],t=>Math.acosh(t)),M={kernelName:r["Acosh"],backendName:"cpu",kernelFunc:F};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function P(t){const{inputs:e,backend:n}=t,i=e;Object(a["a"])(e,"addN");const o=i.map(t=>n.data.get(t.dataId).values),s=Object(r["buffer"])(i[0].shape,i[0].dtype),u=s.values;for(let r=0;r<i.length;r++){const t=o[r];for(let e=0;e<u.length;e++)u[e]+=t[e]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const $={kernelName:r["AddN"],backendName:"cpu",kernelFunc:P};var L=n("82b3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,keepDims:u}=i;Object(a["a"])(o,"all");const c=r["util"].parseAxisParam(s,o.shape);let l=c;const d=r["backend_util"].getAxesPermutation(l,o.shape.length);let h=o;null!=d&&(h=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:d}}),l=r["backend_util"].getInnerMostAxes(l.length,o.shape.length)),r["backend_util"].assertAxesAreInnerMostDims("all",l,h.shape.length);const[p,f]=r["backend_util"].computeOutAndReduceShapes(h.shape,l),m=r["util"].sizeFromShape(f),g=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(p),h.dtype),b=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=b[t];for(let n=0;n<m;++n){const r=b[t+n];e=e&&r}g[r]=e}null!=d&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(p,h.dtype,g);if(u){const t=r["backend_util"].expandShapeToKeepDim(p,c),e=C({inputs:{x:y},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(y),e}return y}const z={kernelName:r["All"],backendName:"cpu",kernelFunc:B};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,keepDims:u}=i;Object(a["a"])(o,"any");const c=r["util"].parseAxisParam(s,o.shape);let l=c;const d=r["backend_util"].getAxesPermutation(l,o.shape.length);let h=o;null!=d&&(h=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:d}}),l=r["backend_util"].getInnerMostAxes(l.length,o.shape.length)),r["backend_util"].assertAxesAreInnerMostDims("any",l,h.shape.length);const[p,f]=r["backend_util"].computeOutAndReduceShapes(h.shape,l),m=r["util"].sizeFromShape(f),g=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(p),h.dtype),b=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=b[t];for(let n=0;n<m;++n){const r=b[t+n];e=e||r}g[r]=e}null!=d&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(p,h.dtype,g);if(u){const t=r["backend_util"].expandShapeToKeepDim(p,c),e=C({inputs:{x:y},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(y),e}return y}const V={kernelName:r["Any"],backendName:"cpu",kernelFunc:W};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s}=i;Object(a["a"])(o,"argMax");let u=r["util"].parseAxisParam(s,o.shape);const c=r["backend_util"].getAxesPermutation(u,o.shape.length);let l=o;const d=[];null!=c&&(l=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:c}}),d.push(l),u=r["backend_util"].getInnerMostAxes(u.length,l.shape.length)),u=[u[0]],r["backend_util"].assertAxesAreInnerMostDims("argMax",u,l.shape.length);const[h,p]=r["backend_util"].computeOutAndReduceShapes(l.shape,u),f=r["util"].sizeFromShape(h),m=r["util"].makeZerosTypedArray(f,"int32"),g=r["util"].sizeFromShape(p),b=n.data.get(l.dataId).values;for(let r=0;r<m.length;++r){const t=r*g;let e=b[t],n=0;for(let r=0;r<g;++r){const a=b[t+r];a>e&&(e=a,n=r)}m[r]=n}return d.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(h,"int32",m)}const G={kernelName:r["ArgMax"],backendName:"cpu",kernelFunc:U};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s}=i;Object(a["a"])(o,"argMin");let u=r["util"].parseAxisParam(s,o.shape);const c=r["backend_util"].getAxesPermutation(u,o.shape.length);let l=o;const d=[];null!=c&&(l=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:c}}),d.push(l),u=r["backend_util"].getInnerMostAxes(u.length,l.shape.length)),u=[u[0]],r["backend_util"].assertAxesAreInnerMostDims("argMin",u,l.shape.length);const[h,p]=r["backend_util"].computeOutAndReduceShapes(l.shape,u),f=r["util"].sizeFromShape(h),m=r["util"].makeZerosTypedArray(f,"int32"),g=r["util"].sizeFromShape(p),b=n.data.get(l.dataId).values;for(let r=0;r<m.length;++r){const t=r*g;let e=b[t],n=0;for(let r=0;r<g;++r){const a=b[t+r];a<e&&(e=a,n=r)}m[r]=n}return d.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(h,"int32",m)}const q={kernelName:r["ArgMin"],backendName:"cpu",kernelFunc:H},K=Object(c["a"])(r["Asin"],t=>Math.asin(t)),X={kernelName:r["Asin"],backendName:"cpu",kernelFunc:K},Y=Object(c["a"])(r["Asinh"],t=>Math.asinh(t)),J={kernelName:r["Asinh"],backendName:"cpu",kernelFunc:Y},Z=Object(c["a"])(r["Atan"],t=>Math.atan(t)),Q={kernelName:r["Atan"],backendName:"cpu",kernelFunc:Z};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tt=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const et=Object(m["a"])((t,e)=>Math.atan2(t,e)),nt=Object(tt["a"])(r["Atan2"],et),rt={kernelName:r["Atan2"],backendName:"cpu",kernelFunc:nt},at=Object(c["a"])(r["Atanh"],t=>Math.atanh(t)),it={kernelName:r["Atanh"],backendName:"cpu",kernelFunc:at};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ot(t,e,n,a,i,o){const s=i.strideHeight,u=i.strideWidth,c=i.dilationHeight,l=i.dilationWidth,d=i.effectiveFilterHeight,h=i.effectiveFilterWidth,p=i.padInfo.top,f=i.padInfo.left,m="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=Object(r["buffer"])(i.outShape,n),b=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],x=i.outShape[3];for(let r=0;r<i.batchSize;++r){const e=r*y,n=r*a[0];for(let r=0;r<i.inChannels;++r)for(let g=0;g<i.outHeight;++g){const y=g*s-p,w=Math.max(0,y),k=Math.min(i.inHeight,d+y),S=e+g*v;for(let e=0;e<i.outWidth;++e){const s=e*u-f,d=Math.max(0,s),p=Math.min(i.inWidth,h+s);let g=m,y=0,v=0;for(let e=w;e<k;e+=c){const i=n+e*a[1];for(let e=d;e<p;e+=l){const n=i+e*a[2],s=t[n+r];"max"===o&&s>g?g=s:"avg"===o&&(y+=s,v++)}if(isNaN(g))break}const O=S+e*x+r;b[O]="avg"===o?y/v:g}}}return g}function st(t,e,n,a,i=!1,o=!1){const s=Object(r["buffer"])(a.outShape,"int32"),u=a.strideHeight,c=a.strideWidth,l=a.dilationHeight,d=a.dilationWidth,h=a.effectiveFilterHeight,p=a.effectiveFilterWidth,f=a.padInfo.top,m=a.padInfo.left,g=Object(r["buffer"])(e,n,t);for(let r=0;r<a.batchSize;++r)for(let t=0;t<a.inChannels;++t)for(let e=0;e<a.outHeight;++e){const n=e*u-f;let b=n;while(b<0)b+=l;const y=Math.min(a.inHeight,h+n);for(let u=0;u<a.outWidth;++u){const h=u*c-m;let f=h;while(f<0)f+=d;const v=Math.min(a.inWidth,p+h);let x=Number.NEGATIVE_INFINITY,w=-1;for(let e=b;e<y;e+=l){const s=e-n;for(let n=f;n<v;n+=d){const u=n-h,c=g.get(r,e,n,t);c>x&&(x=c,w=i?o?((r*a.inHeight+e)*a.inWidth+n)*a.inChannels+t:(e*a.inWidth+n)*a.inChannels+t:s*p+u)}}s.set(w,r,e,u,t)}}return s}function ut(t,e,n,a,i,o){const s=i.strideDepth,u=i.strideHeight,c=i.strideWidth,l=i.dilationDepth,d=i.dilationHeight,h=i.dilationWidth,p=i.effectiveFilterDepth,f=i.effectiveFilterHeight,m=i.effectiveFilterWidth,g=i.padInfo.front,b=i.padInfo.top,y=i.padInfo.left,v="max"===o?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=Object(r["buffer"])(i.outShape,n),w=x.values,k=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[2]*i.outShape[3]*i.outShape[4],O=i.outShape[3]*i.outShape[4],_=i.outShape[4];for(let r=0;r<i.batchSize;++r){const e=r*k,n=r*a[0];for(let r=0;r<i.inChannels;++r)for(let x=0;x<i.outDepth;++x){const k=x*s-g;let C=k;while(C<0)C+=l;const T=Math.min(i.inDepth,p+k),I=e+x*S;for(let e=0;e<i.outHeight;++e){const s=e*u-b;let p=s;while(p<0)p+=d;const g=Math.min(i.inHeight,f+s),x=I+e*O;for(let e=0;e<i.outWidth;++e){const s=e*c-y;let u=s;while(u<0)u+=h;const f=Math.min(i.inWidth,m+s),b=x+e*_;let k=v,S=0,O=0;for(let e=C;e<T;e+=l){const i=n+e*a[1];for(let e=p;e<g;e+=d){const n=i+e*a[2];for(let e=u;e<f;e+=h){const i=n+e*a[3],s=t[i+r];if("max"===o&&s>k?k=s:"avg"===o&&(S+=s,O++),isNaN(k))break}if(isNaN(k))break}if(isNaN(k))break}const I=b+r;w[I]="avg"===o?S/O:k}}}}return x}function ct(t,e){const n=Object(r["buffer"])(e.outShape,"int32"),a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;for(let r=0;r<e.batchSize;++r)for(let g=0;g<e.inChannels;++g)for(let b=0;b<e.outDepth;++b){const y=b*a-p;let v=y;while(v<0)v+=s;const x=Math.min(e.inDepth,l+y);for(let a=0;a<e.outHeight;++a){const l=a*i-f;let p=l;while(p<0)p+=u;const w=Math.min(e.inHeight,d+l);for(let i=0;i<e.outWidth;++i){const f=i*o-m;let k=f;while(k<0)k+=c;const S=Math.min(e.inWidth,h+f);let O=Number.NEGATIVE_INFINITY,_=-1;for(let e=v;e<x;e+=s){const n=e-y;for(let a=p;a<w;a+=u){const i=a-l;for(let o=k;o<S;o+=c){const s=o-f,u=t.get(r,e,a,o,g);u>=O&&(O=u,_=n*d*h+i*d+s)}}}n.set(_,r,b,a,i,g)}}}return n}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e;Object(a["a"])(o,"avgPool");const{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=i,d=1;r["util"].assert(r["backend_util"].eitherStridesOrDilationsAreOne(u,d),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${u} and dilations '${d}'`);const p=r["backend_util"].computePool2DInfo(o.shape,s,u,d,c,l);let f;if(1===p.filterWidth&&1===p.filterHeight&&r["util"].arraysEqual(p.inShape,p.outShape))f=Object(h["a"])({inputs:{x:o},backend:n});else{const t=n.data.get(o.dataId).values,e=r["util"].computeStrides(o.shape),a=ot(t,o.shape,o.dtype,e,p,"avg");f=n.makeTensorInfo(p.outShape,o.dtype,a.values)}return f}const dt={kernelName:r["AvgPool"],backendName:"cpu",kernelFunc:lt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{filterSize:s,strides:u,pad:c,dimRoundingMode:l,dataFormat:d}=i;Object(a["a"])(o,"avgPool3d");const h=r["backend_util"].computePool3DInfo(o.shape,s,u,1,c,l,d),p=n.data.get(o.dataId).values,f=ut(p,o.shape,o.dtype,r["util"].computeStrides(o.shape),h,"avg");return n.makeTensorInfo(f.shape,"float32",f.values)}const pt={kernelName:r["AvgPool3D"],backendName:"cpu",kernelFunc:ht};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ft(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,input:s}=e,{filterSize:u,strides:c,pad:l,dimRoundingMode:d}=i;Object(a["a"])([o,s],"avgPool3DGrad");const h=r["backend_util"].computePool3DInfo(s.shape,u,c,1,l,d),p=h.strideDepth,f=h.strideHeight,m=h.strideWidth,g=h.filterDepth,b=h.filterHeight,y=h.filterWidth,v=h.dilationDepth,x=h.dilationHeight,w=h.dilationWidth,k=h.effectiveFilterDepth,S=h.effectiveFilterHeight,O=h.effectiveFilterWidth,_=k-1-h.padInfo.front,C=O-1-h.padInfo.left,T=S-1-h.padInfo.top,I=Object(r["buffer"])(s.shape,"float32"),N=1/(g*b*y),E=n.bufferSync(o);for(let r=0;r<h.batchSize;++r)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let a=0;a<h.inWidth;++a){const i=e-_,o=n-T,s=a-C;let u=0;for(let e=0;e<k;e+=v){const n=(i+e)/p;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let e=0;e<S;e+=x){const a=(o+e)/f;if(!(a<0||a>=h.outHeight||Math.floor(a)!==a))for(let e=0;e<O;e+=w){const i=(s+e)/m;if(i<0||i>=h.outWidth||Math.floor(i)!==i)continue;const o=E.get(r,n,a,i,t);u+=o}}}I.set(u*N,r,e,n,a,t)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const mt={kernelName:r["AvgPool3DGrad"],backendName:"cpu",kernelFunc:ft};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gt(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,input:s}=e,u=s;Object(a["a"])([o,s],"avgPoolGrad");const{filterSize:c,strides:l,pad:d}=i,h=r["backend_util"].computePool2DInfo(u.shape,c,l,1,d),p=h.strideHeight,f=h.strideWidth,m=h.filterHeight,g=h.filterWidth,b=h.dilationHeight,y=h.dilationWidth,v=h.effectiveFilterHeight,x=h.effectiveFilterWidth,w=x-1-h.padInfo.left,k=v-1-h.padInfo.top,S=Object(r["buffer"])(u.shape,"float32"),O=1/(m*g),_=n.data.get(o.dataId).values,C=Object(r["buffer"])(o.shape,"float32",_);for(let r=0;r<h.batchSize;++r)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inHeight;++e)for(let n=0;n<h.inWidth;++n){const a=e-k,i=n-w;let o=0;for(let e=0;e<v;e+=b){const n=(a+e)/p;if(!(n<0||n>=h.outHeight||Math.floor(n)!==n))for(let e=0;e<x;e+=y){const a=(i+e)/f;if(a<0||a>=h.outWidth||Math.floor(a)!==a)continue;const s=C.get(r,n,a,t);o+=s}}S.set(o*O,r,e,n,t)}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const bt={kernelName:r["AvgPoolGrad"],backendName:"cpu",kernelFunc:gt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,scale:s,offset:u,mean:c,variance:l}=e;r["util"].assert(c.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),r["util"].assert(null==u||c.shape.length===u.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),r["util"].assert(null==s||c.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Object(a["a"])([o,c,l,s,u],"batchNorm");let{varianceEpsilon:d}=i;null==d&&(d=.001);const h=n.data.get(o.dataId).values,p=n.data.get(c.dataId).values,f=n.data.get(l.dataId).values,m=s?n.data.get(s.dataId).values:new Float32Array([1]),g=u?n.data.get(u.dataId).values:new Float32Array([0]),b=new Float32Array(h.length),y=g.length,v=m.length,x=f.length,w=p.length;let k=0,S=0,O=0,_=0;for(let r=0;r<h.length;++r)b[r]=g[k++]+(h[r]-p[S++])*m[O++]/Math.sqrt(f[_++]+d),k>=y&&(k=0),S>=w&&(S=0),O>=v&&(O=0),_>=x&&(_=0);return n.makeTensorInfo(o.shape,o.dtype,b)}const vt={kernelName:r["FusedBatchNorm"],backendName:"cpu",kernelFunc:yt};var xt=n("425a");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{blockShape:s,crops:u}=i;Object(a["a"])([o],"batchToSpaceND");const c=s.reduce((t,e)=>t*e),l=r["backend_util"].getReshaped(o.shape,s,c),d=r["backend_util"].getPermuted(l.length,s.length),h=r["backend_util"].getReshapedPermuted(o.shape,s,c),p=r["backend_util"].getSliceBeginCoords(u,s.length),f=r["backend_util"].getSliceSize(h,u,s.length),m=C({inputs:{x:o},backend:n,attrs:{shape:l}}),g=Object(L["a"])({inputs:{x:m},backend:n,attrs:{perm:d}}),b=C({inputs:{x:g},backend:n,attrs:{shape:h}}),y=Object(xt["a"])({inputs:{x:b},backend:n,attrs:{begin:p,size:f}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),y}const kt={kernelName:r["BatchToSpaceND"],backendName:"cpu",kernelFunc:wt};var St=n("6877");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=Object(St["a"])(s,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}const _t={kernelName:r["Bincount"],backendName:"cpu",kernelFunc:Ot};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ct(t){const{inputs:e,backend:n}=t,{s0:a,s1:i}=e,o=n.data.get(a.dataId).values,s=n.data.get(i.dataId).values,u=r["backend_util"].assertAndGetBroadcastShape(Array.from(o),Array.from(s));return n.makeTensorInfo([u.length],"int32",Int32Array.from(u))}const Tt={kernelName:r["BroadcastArgs"],backendName:"cpu",kernelFunc:Ct};var It=n("d28e"),Nt=n("180e");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Et=Object(c["a"])(r["ClipByValue"],(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),At={kernelName:r["ClipByValue"],backendName:"cpu",kernelFunc:Et};var Rt=n("8f1f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jt=t=>{const{x:e}=t.inputs,n=t.backend,a=new Float32Array(r["util"].sizeFromShape(e.shape)),i=n.data.get(e.dataId),o=i.complexTensorInfos.real,s=i.complexTensorInfos.imag,u=n.data.get(o.dataId).values,c=n.data.get(s.dataId).values;for(let r=0;r<u.length;r++){const t=u[r],e=c[r];a[r]=Math.hypot(t,e)}return n.makeOutput(a,e.shape,"float32")},Dt={kernelName:r["ComplexAbs"],backendName:"cpu",kernelFunc:jt};var Ft=n("d598");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const Pt={kernelName:r["Imag"],backendName:"cpu",kernelFunc:Mt};var $t=n("bc57");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(t){const{inputs:e,backend:n,attrs:a}=t,{axis:i}=a,o=r["util"].parseAxisParam(i,e[0].shape)[0],s=e.map(t=>t.shape);r["backend_util"].assertParamsConsistent(s,o);let u=r["backend_util"].computeOutShape(e.map(t=>t.shape),o);if(0===r["util"].sizeFromShape(u))return n.makeTensorInfo(u,e[0].dtype,[]);const c=e.filter(t=>r["util"].sizeFromShape(t.shape)>0);if(1===c.length)return Object(h["a"])({inputs:{x:c[0]},backend:n});if("complex64"===c[0].dtype){const t=c.map(t=>Object($t["a"])({inputs:{input:t},backend:n})),e=c.map(t=>Mt({inputs:{input:t},backend:n})),r=Lt({inputs:t,backend:n,attrs:{axis:o}}),a=Lt({inputs:e,backend:n,attrs:{axis:o}}),i=Object(Rt["a"])({inputs:{real:r,imag:a},backend:n});return t.forEach(t=>n.disposeIntermediateTensorInfo(t)),e.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),i}const l=c.map(t=>{const e=r["util"].sizeFromShape(t.shape.slice(o)),a=[-1,e];return C({inputs:{x:t},backend:n,attrs:{shape:a}})}),d=l.map(t=>({vals:n.data.get(t.dataId).values,shape:t.shape}));u=r["backend_util"].computeOutShape(l.map(t=>t.shape),1);const p=1===l[0].shape[0],f=Object(Ft["a"])(d,u,e[0].dtype,p),m=r["backend_util"].computeOutShape(c.map(t=>t.shape),o),g=n.makeTensorInfo(m,e[0].dtype,f);return l.forEach(t=>n.disposeIntermediateTensorInfo(t)),g}const Bt={kernelName:r["Concat"],backendName:"cpu",kernelFunc:Lt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,filter:s}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h}=i;Object(a["a"])([o,s],"conv2d");const p=r["backend_util"].convertConv2DDataFormat(l),f=r["backend_util"].computeConv2DInfo(o.shape,s.shape,u,d,c,h,!1,p),m=f.filterHeight,g=f.filterWidth,b=f.dilationHeight,y=f.dilationWidth,v=f.padInfo.left,x=f.padInfo.top,w="channelsLast"===f.dataFormat,k=new r["TensorBuffer"](f.outShape,o.dtype),S=r["util"].computeStrides(o.shape),O=r["util"].computeStrides(s.shape),_=S[0],C=w?S[1]:S[2],T=w?S[2]:1,I=w?1:S[1],N=k.strides[0],E=w?k.strides[1]:k.strides[2],A=w?k.strides[2]:1,R=w?1:k.strides[1],j=n.data.get(o.dataId).values,D=n.data.get(s.dataId).values,F=k.values;for(let r=0;r<f.batchSize;++r){const t=r*_,e=r*N;for(let n=0;n<f.outHeight;++n){const r=e+n*E,a=n*f.strideHeight-x;for(let e=0;e<m;++e){const n=a+e*b;if(n<0||n>=f.inHeight)continue;const i=e*O[0],o=t+n*C;for(let t=0;t<f.outWidth;++t){const e=r+t*A,n=t*f.strideWidth-v;for(let t=0;t<g;++t){const r=n+t*y;if(r<0||r>=f.inWidth)continue;const a=i+t*O[1],s=o+r*T;let u=a;for(let t=0;t<f.inChannels;++t){const n=j[s+t*I];for(let t=0;t<f.outChannels;++t)F[e+t*R]+=n*D[u+t];u+=f.outChannels}}}}}}return n.makeTensorInfo(k.shape,k.dtype,F)}const Wt={kernelName:r["Conv2D"],backendName:"cpu",kernelFunc:zt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,dy:s}=e,{strides:u,pad:c,dataFormat:l,dimRoundingMode:d,filterShape:h}=i;Object(a["a"])([o,s],"conv2dBackpropFilter");const p=r["backend_util"].convertConv2DDataFormat(l),f=r["backend_util"].computeConv2DInfo(o.shape,h,u,1,c,d,!1,p),{strideHeight:m,strideWidth:g,filterHeight:b,filterWidth:y}=f,v="channelsLast"===f.dataFormat,x=new r["TensorBuffer"](f.filterShape,"float32"),w=f.padInfo.left,k=f.padInfo.top,S=n.data.get(o.dataId).values,O=n.data.get(s.dataId).values,_=new r["TensorBuffer"](o.shape,o.dtype,S),C=new r["TensorBuffer"](s.shape,s.dtype,O);for(let r=0;r<b;++r){const t=Math.max(0,Math.ceil((k-r)/m)),e=Math.min(f.outHeight,(f.inHeight+k-r)/m);for(let n=0;n<y;++n){const a=Math.max(0,Math.ceil((w-n)/g)),i=Math.min(f.outWidth,(f.inWidth+w-n)/g);for(let o=0;o<f.inChannels;++o)for(let s=0;s<f.outChannels;++s){let u=0;for(let c=0;c<f.batchSize;++c)for(let l=t;l<e;++l){const t=r+l*m-k;for(let e=a;e<i;++e){const r=n+e*g-w;u+=v?_.get(c,t,r,o)*C.get(c,l,e,s):_.get(c,o,t,r)*C.get(c,s,l,e)}}x.set(u,r,n,o,s)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Ut={kernelName:r["Conv2DBackpropFilter"],backendName:"cpu",kernelFunc:Vt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gt(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,filter:s}=e,{inputShape:u,strides:c,pad:l,dataFormat:d,dimRoundingMode:h}=i;Object(a["a"])([o,s],"conv2dBackpropInput");const p=r["util"].computeStrides(s.shape),f=r["util"].computeStrides(o.shape);let m=r["backend_util"].convertConv2DDataFormat(d);const g=r["backend_util"].computeConv2DInfo(u,s.shape,c,1,l,h,!1,m),b=new r["TensorBuffer"](g.inShape,"float32"),y=b.values,v=n.data.get(o.dataId).values,x=n.data.get(s.dataId).values,[w,k,S]=p,{batchSize:O,filterHeight:_,filterWidth:C,inChannels:T,inHeight:I,inWidth:N,outChannels:E,outHeight:A,outWidth:R,strideHeight:j,strideWidth:D}=g;m=g.dataFormat;const F=_-1-g.padInfo.top,M=C-1-g.padInfo.left,P="channelsLast"===m,$=b.strides[0],L=P?b.strides[1]:b.strides[2],B=P?b.strides[2]:1,z=P?1:b.strides[1],W=f[0],V=P?f[1]:f[2],U=P?f[2]:1,G=P?1:f[1];for(let r=0;r<O;++r)for(let t=0;t<T;++t)for(let e=0;e<I;++e){const n=e-F,a=Math.max(0,Math.ceil(n/j)),i=Math.min(A,(_+n)/j);for(let o=0;o<N;++o){const s=o-M,u=Math.max(0,Math.ceil(s/D)),c=Math.min(R,(C+s)/D);let l=0;for(let e=a;e<i;++e){const a=e*j-n;for(let n=u;n<c;++n){const i=n*D-s,o=W*r+V*e+U*n,u=w*(_-1-a)+k*(C-1-i)+S*t;for(let t=0;t<E;++t){const e=v[o+G*t],n=x[u+t];l+=e*n}}}const d=$*r+L*e+B*o+z*t;y[d]=l}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const Ht={kernelName:r["Conv2DBackpropInput"],backendName:"cpu",kernelFunc:Gt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,filter:s}=e,{strides:u,pad:c,dilations:l}=i;Object(a["a"])([o,s],"conv3d");const d=r["backend_util"].computeConv3DInfo(o.shape,s.shape,u,l,c),{filterDepth:h,filterHeight:p,filterWidth:f,dilationDepth:m,dilationHeight:g,dilationWidth:b,padInfo:y}=d,v=y.front,x=y.left,w=y.top,k=new r["TensorBuffer"](d.outShape,o.dtype),S=n.data.get(o.dataId).values,O=n.data.get(s.dataId).values,_=k.values,C=r["util"].computeStrides(o.shape),T=r["util"].computeStrides(s.shape);for(let r=0;r<d.batchSize;++r){const t=r*C[0],e=r*k.strides[0];for(let n=0;n<d.outDepth;++n){const r=e+n*k.strides[1],a=n*d.strideDepth-v;for(let e=0;e<h;++e){const n=a+e*m;if(n<0||n>=d.inDepth)continue;const i=e*T[0],o=t+n*C[1];for(let t=0;t<d.outHeight;++t){const e=r+t*k.strides[2],n=t*d.strideHeight-w;for(let t=0;t<p;++t){const r=n+t*g;if(r<0||r>=d.inHeight)continue;const a=i+t*T[1],s=o+r*C[2];for(let t=0;t<d.outWidth;++t){const n=e+t*d.outChannels,r=t*d.strideWidth-x;for(let t=0;t<f;++t){const e=r+t*b;if(e<0||e>=d.inWidth)continue;const i=a+t*T[2],o=s+e*d.inChannels;let u=i;for(let t=0;t<d.inChannels;++t){const e=S[o+t];for(let t=0;t<d.outChannels;++t)_[n+t]+=e*O[u+t];u+=d.outChannels}}}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const Kt={kernelName:r["Conv3D"],backendName:"cpu",kernelFunc:qt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xt(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,dy:s}=e,{strides:u,pad:c,filterShape:l}=i;Object(a["a"])([o,s],"conv3dBackpropFilterV2");const d=r["util"].computeStrides(o.shape),h=r["util"].computeStrides(s.shape),p=r["backend_util"].computeConv3DInfo(o.shape,l,u,1,c),f=p.strideDepth,m=p.strideHeight,g=p.strideWidth,b=p.filterDepth,y=p.filterHeight,v=p.filterWidth,x=new r["TensorBuffer"](p.filterShape,"float32"),w=x.values,[k,S,O,_]=x.strides,C=n.data.get(s.dataId).values,[T,I,N,E]=h,A=n.data.get(o.dataId).values,[R,j,D,F]=d,M=p.padInfo.front,P=p.padInfo.left,$=p.padInfo.top;for(let r=0;r<b;++r){const t=Math.max(0,Math.ceil((M-r)/f)),e=Math.min(p.outDepth,(p.inDepth+M-r)/f),n=r*k;for(let a=0;a<y;++a){const i=Math.max(0,Math.ceil(($-a)/m)),o=Math.min(p.outHeight,(p.inHeight+$-a)/m),s=a*S+n;for(let n=0;n<v;++n){const u=Math.max(0,Math.ceil((P-n)/g)),c=Math.min(p.outWidth,(p.inWidth+P-n)/g),l=n*O+s;for(let s=0;s<p.inChannels;++s){const d=s*_+l;for(let l=0;l<p.outChannels;++l){let h=0;for(let d=0;d<p.batchSize;++d){const p=d*R,b=d*T;for(let d=t;d<e;++d){const t=r+d*f-M,e=t*j+p,y=d*I+b;for(let r=i;r<o;++r){const t=a+r*m-$,i=t*D+e,o=r*N+y;for(let e=u;e<c;++e){const t=n+e*g-P,r=t*F+i,a=e*E+o;h+=A[r+s]*C[a+l]}}}}w[d+l]=h}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Yt={kernelName:r["Conv3DBackpropFilterV2"],backendName:"cpu",kernelFunc:Xt};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jt(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,filter:s}=e,{pad:u,strides:c,inputShape:l}=i;Object(a["a"])([o],"conv3dBackpropInputV2");const d=r["util"].computeStrides(o.shape),h=r["util"].computeStrides(s.shape),p=r["backend_util"].computeConv3DInfo(l,s.shape,c,1,u),f=new r["TensorBuffer"](p.inShape,"float32"),m=f.values,[g,b,y,v]=f.strides,x=n.data.get(o.dataId).values,[w,k,S,O]=d,_=n.data.get(s.dataId).values,[C,T,I,N]=h,{batchSize:E,filterDepth:A,filterHeight:R,filterWidth:j,inChannels:D,inDepth:F,inHeight:M,inWidth:P,outChannels:$,outDepth:L,outHeight:B,outWidth:z,strideDepth:W,strideHeight:V,strideWidth:U}=p,G=A-1-p.padInfo.front,H=R-1-p.padInfo.top,q=j-1-p.padInfo.left;for(let r=0;r<E;++r)for(let t=0;t<D;++t)for(let e=0;e<F;++e){const n=e-G,a=Math.max(0,Math.ceil(n/W)),i=Math.min(L,(A+n)/W);for(let o=0;o<M;++o){const s=o-H,u=Math.max(0,Math.ceil(s/V)),c=Math.min(B,(R+s)/V);for(let l=0;l<P;++l){const d=l-q,h=Math.max(0,Math.ceil(d/U)),p=Math.min(z,(j+d)/U);let f=0;for(let e=a;e<i;++e){const a=e*W-n;for(let n=u;n<c;++n){const i=n*V-s;for(let o=h;o<p;++o){const s=o*U-d,u=w*r+k*e+S*n+O*o,c=C*(A-1-a)+T*(R-1-i)+I*(j-1-s)+N*t;for(let t=0;t<$;++t){const e=x[u+t],n=_[c+t];f+=e*n}}}}m[g*r+b*e+y*o+v*l+t]=f}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const Zt={kernelName:r["Conv3DBackpropInputV2"],backendName:"cpu",kernelFunc:Jt},Qt=Object(c["a"])(r["Cos"],t=>Math.cos(t)),te={kernelName:r["Cos"],backendName:"cpu",kernelFunc:Qt},ee=Object(c["a"])(r["Cosh"],t=>Math.cosh(t)),ne={kernelName:r["Cosh"],backendName:"cpu",kernelFunc:ee};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function re(t){const{inputs:e,backend:n,attrs:a}=t,{image:i,boxes:o,boxInd:s}=e,{cropSize:u,method:c,extrapolationValue:l}=a,[d,h,p,f]=i.shape,m=o.shape[0],[g,b]=u,y=Object(r["buffer"])([m,g,b,f],"float32"),v=n.data.get(o.dataId).values,x=n.data.get(s.dataId).values,w=n.data.get(i.dataId).values,k=r["util"].computeStrides(i.shape),S=r["util"].computeStrides(y.shape);for(let r=0;r<m;r++){const t=4*r,e=v[t],n=v[t+1],a=v[t+2],i=v[t+3],o=x[r];if(o>=d)continue;const s=g>1?(a-e)*(h-1)/(g-1):0,u=b>1?(i-n)*(p-1)/(b-1):0;for(let d=0;d<g;d++){const t=g>1?e*(h-1)+d*s:.5*(e+a)*(h-1);if(t<0||t>h-1)for(let e=0;e<b;e++)for(let t=0;t<f;t++){const n=t+e*S[2]+d*S[1]+r*S[0];y.values[n]=l}else if("bilinear"===c){const e=Math.floor(t),a=Math.ceil(t),s=t-e;for(let t=0;t<b;t++){const c=b>1?n*(p-1)+t*u:.5*(n+i)*(p-1);if(c<0||c>p-1){for(let e=0;e<f;e++){const n=e+t*S[2]+d*S[1]+r*S[0];y.values[n]=l}continue}const h=Math.floor(c),m=Math.ceil(c),g=c-h;for(let n=0;n<f;n++){let i=n+h*k[2]+e*k[1]+o*k[0];const u=w[i];i=n+m*k[2]+e*k[1]+o*k[0];const c=w[i];i=n+h*k[2]+a*k[1]+o*k[0];const l=w[i];i=n+m*k[2]+a*k[1]+o*k[0];const p=w[i],f=u+(c-u)*g,b=l+(p-l)*g;i=n+t*S[2]+d*S[1]+r*S[0],y.values[i]=f+(b-f)*s}}}else for(let e=0;e<b;++e){const a=b>1?n*(p-1)+e*u:.5*(n+i)*(p-1);if(a<0||a>p-1){for(let t=0;t<f;t++){const n=t+e*S[2]+d*S[1]+r*S[0];y.values[n]=l}continue}const s=Math.round(a),c=Math.round(t);for(let t=0;t<f;t++){const n=t+s*k[2]+c*k[1]+o*k[0],a=t+e*S[2]+d*S[1]+r*S[0];y.values[a]=w[n]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const ae={kernelName:r["CropAndResize"],backendName:"cpu",kernelFunc:re};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ie(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,exclusive:u,reverse:c}=i;Object(a["a"])(o,"cumprod");const l=r["backend_util"].getAxesPermutation([s],o.shape.length);let d=o;null!=l&&(d=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:l}}));const h=r["backend_util"].getInnerMostAxes(1,o.shape.length)[0];if(h!==d.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${h}`);const p=Object(r["upcastType"])(d.dtype,"int32"),f=r["util"].makeOnesTypedArray(r["util"].sizeFromShape(d.shape),p),m=n.data.get(d.dataId).values,g=d.shape[d.shape.length-1],b=c?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let r=0;r<m.length;r+=g)for(let t=0;t<g;t++){const e=b(r,t);if(0===t)f[e]=u?1:m[e];else{const n=b(r,t-1);f[e]=u?m[n]*f[n]:m[e]*f[n]}}const y=n.makeTensorInfo(d.shape,p,f);if(null!=l){const t=r["backend_util"].getUndoAxesPermutation(l),e=Object(L["a"])({inputs:{x:y},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(d),e}return y}const oe={kernelName:r["Cumprod"],backendName:"cpu",kernelFunc:ie};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function se(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,exclusive:u,reverse:c}=i;Object(a["a"])(o,"cumsum");const l=r["backend_util"].getAxesPermutation([s],o.shape.length);let d=o;null!=l&&(d=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:l}}));const h=r["backend_util"].getInnerMostAxes(1,o.shape.length)[0];if(h!==d.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${d.shape.length-1} but got axis=${h}`);const p=Object(r["upcastType"])(d.dtype,"int32"),f=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(d.shape),p),m=n.data.get(d.dataId).values,g=d.shape[d.shape.length-1],b=c?(t,e)=>t+g-e-1:(t,e)=>t+e;for(let r=0;r<m.length;r+=g)for(let t=0;t<g;t++){const e=b(r,t);if(0===t)f[e]=u?0:m[e];else{const n=b(r,t-1);f[e]=u?m[n]+f[n]:m[e]+f[n]}}const y=n.makeTensorInfo(d.shape,p,f);if(null!=l){const t=r["backend_util"].getUndoAxesPermutation(l),e=Object(L["a"])({inputs:{x:y},backend:n,attrs:{perm:t}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(d),e}return y}const ue={kernelName:r["Cumsum"],backendName:"cpu",kernelFunc:se};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ce(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(1===a.shape.length){const t=n.data.get(a.dataId).values,e=n.data.get(i.dataId).values,r=Object(St["a"])(t,e,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,r)}if(2===a.shape.length){const t=n.bufferSync(a),e=n.bufferSync(i),r=Object(St["b"])(t,e,o,s);return n.makeTensorInfo(r.shape,i.dtype,r.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+a.shape.length+".")}const le={kernelName:r["DenseBincount"],backendName:"cpu",kernelFunc:ce};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(t){const{inputs:e,backend:n,attrs:a}=t,{x:i}=e,{blockSize:o,dataFormat:s}=a;r["util"].assert("NHWC"===s,()=>"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+s);const u=i.shape[0],c=i.shape[1],l=i.shape[2],d=i.shape[3],h=c*o,p=l*o,f=d/(o*o),m=n.data.get(i.dataId).values,g=new Float32Array(u*h*p*f);let b=0;for(let r=0;r<u;++r)for(let t=0;t<h;++t){const e=Math.floor(t/o),n=t%o;for(let t=0;t<p;++t){const a=Math.floor(t/o),i=t%o,s=(n*o+i)*f;for(let t=0;t<f;++t){const n=t+s,i=n+d*(a+l*(e+c*r));g[b++]=m[i]}}}return n.makeTensorInfo([u,h,p,f],i.dtype,g)}const he={kernelName:r["DepthToSpace"],backendName:"cpu",kernelFunc:de};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pe(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,filter:s}=e,{strides:u,pad:c,dilations:l,dimRoundingMode:d}=i;Object(a["a"])([o,s],"depthwiseConv2DNative");const h=r["util"].computeStrides(o.shape),p=r["util"].computeStrides(s.shape);let f=l;null==f&&(f=[1,1]),r["util"].assert(r["backend_util"].eitherStridesOrDilationsAreOne(u,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${f}'`);const m=r["backend_util"].computeConv2DInfo(o.shape,s.shape,u,f,c,d,!0),{filterHeight:g,filterWidth:b,dilationHeight:y,dilationWidth:v,padInfo:x}=m,w=x.left,k=x.top,S=m.outChannels/m.inChannels,O=new r["TensorBuffer"](m.outShape,o.dtype),_=n.data.get(o.dataId).values,C=n.data.get(s.dataId).values,T=O.values;for(let r=0;r<m.batchSize;++r){const t=r*h[0],e=r*O.strides[0];for(let n=0;n<m.outHeight;++n){const r=e+n*O.strides[1],a=n*m.strideHeight-k;for(let e=0;e<g;++e){const n=a+e*y;if(n<0||n>=m.inHeight)continue;const i=e*p[0],o=t+n*h[1];for(let t=0;t<m.outWidth;++t){const e=r+t*O.strides[2],n=t*m.strideWidth-w;for(let t=0;t<b;++t){const r=n+t*v;if(r<0||r>=m.inWidth)continue;const a=i+t*p[1],s=o+r*m.inChannels;let u=e,c=a;for(let t=0;t<m.inChannels;++t){const e=_[s+t];for(let t=0;t<S;++t)T[u+t]+=e*C[c+t];u+=S,c+=S}}}}}}return n.makeTensorInfo(O.shape,O.dtype,O.values)}const fe={kernelName:r["DepthwiseConv2dNative"],backendName:"cpu",kernelFunc:pe};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function me(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,dy:s}=e,{strides:u,dilations:c,pad:l,dimRoundingMode:d,filterShape:h}=i;Object(a["a"])([o,s],"depthwiseConv2dNativeBackpropFilter");const p=r["backend_util"].computeConv2DInfo(o.shape,h,u,c,l,d,!0),{strideHeight:f,strideWidth:m,filterHeight:g,filterWidth:b}=p,y=new r["TensorBuffer"](p.filterShape,"float32"),v=p.padInfo.left,x=p.padInfo.top,w=p.outChannels/p.inChannels,k=n.data.get(o.dataId).values,S=new r["TensorBuffer"](o.shape,o.dtype,k),O=n.data.get(s.dataId).values,_=new r["TensorBuffer"](s.shape,s.dtype,O);for(let r=0;r<g;++r){const t=Math.max(0,Math.ceil((x-r)/f)),e=Math.min(p.outHeight,(p.inHeight+x-r)/f);for(let n=0;n<b;++n){const a=Math.max(0,Math.ceil((v-n)/m)),i=Math.min(p.outWidth,(p.inWidth+v-n)/m);for(let o=0;o<p.outChannels;++o){const s=Math.trunc(o/w),u=o%w;let c=0;for(let l=0;l<p.batchSize;++l)for(let u=t;u<e;++u){const t=r+u*f-x;for(let e=a;e<i;++e){const r=n+e*m-v;c+=S.get(l,t,r,s)*_.get(l,u,e,o)}}y.set(c,r,n,s,u)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const ge={kernelName:r["DepthwiseConv2dNativeBackpropFilter"],backendName:"cpu",kernelFunc:me};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,filter:s}=e,{strides:u,dilations:c,pad:l,dimRoundingMode:d,inputShape:h}=i;Object(a["a"])([o,s],"depthwiseConv2DNativeBackpropInput");const p=r["util"].computeStrides(o.shape),f=r["util"].computeStrides(s.shape),m=r["backend_util"].computeConv2DInfo(h,s.shape,u,c,l,d,!0),g=new r["TensorBuffer"](m.inShape,"float32"),b=g.values,[y,v,x]=g.strides,w=n.data.get(o.dataId).values,[k,S,O]=p,_=n.data.get(s.dataId).values,[C,T,I]=f,{batchSize:N,filterHeight:E,filterWidth:A,inChannels:R,inHeight:j,inWidth:D,outChannels:F,outHeight:M,outWidth:P,strideHeight:$,strideWidth:L}=m,B=E-1-m.padInfo.top,z=A-1-m.padInfo.left,W=F/R;for(let r=0;r<N;++r)for(let t=0;t<R;++t)for(let e=0;e<j;++e){const n=e-B,a=Math.max(0,Math.ceil(n/$)),i=Math.min(M,(E+n)/$);for(let o=0;o<D;++o){const s=o-z,u=Math.max(0,Math.ceil(s/L)),c=Math.min(P,(A+s)/L);let l=0;for(let e=a;e<i;++e){const a=e*$-n;for(let n=u;n<c;++n){const i=n*L-s,o=k*r+S*e+O*n,u=C*(E-1-a)+T*(A-1-i)+I*t;for(let e=0;e<W;++e){const n=t*W+e,r=w[o+n],a=_[u+e];l+=r*a}}}b[y*r+v*e+x*o+t]=l}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const ye={kernelName:r["DepthwiseConv2dNativeBackpropInput"],backendName:"cpu",kernelFunc:be};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ve(t){const{inputs:e,backend:n}=t,{x:a}=e,i=r["util"].sizeFromShape(a.shape),o=n.data.get(a.dataId).values,s=Object(r["buffer"])([i,i],a.dtype),u=s.values;for(let r=0;r<o.length;r++)u[r*i+r]=o[r];const c=[...a.shape,...a.shape];return n.makeTensorInfo(c,s.dtype,s.values)}const xe={kernelName:r["Diag"],backendName:"cpu",kernelFunc:ve},we={kernelName:r["Dilation2D"],backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:a,filter:i}=t,{strides:o,pad:s,dilations:u}=n,c=e,l=c.data.get(a.dataId).values,d=a.shape.length,h=c.data.get(i.dataId).values,p=i.shape.length,{batchSize:f,inHeight:m,inWidth:g,inChannels:b,outHeight:y,outWidth:v,padInfo:x,strideHeight:w,strideWidth:k,filterHeight:S,filterWidth:O,dilationHeight:_,dilationWidth:C,outShape:T}=r["backend_util"].computeDilation2DInfo(a.shape,i.shape,o,s,"NHWC",u),I=r["util"].sizeFromShape(T),N=T.length,E=r["util"].getArrayFromDType(a.dtype,I);for(let R=0;R<f;++R)for(let t=0;t<y;++t){const e=t*w-x.top;for(let n=0;n<v;++n){const o=n*k-x.left;for(let s=0;s<b;++s){let u=Number.MIN_SAFE_INTEGER;for(let t=0;t<S;++t){const n=e+t*_;if(n>=0&&n<m)for(let e=0;e<O;++e){const c=o+e*C;if(c>=0&&c<g){const o=r["util"].locToIndex([R,n,c,s],d,r["util"].computeStrides(a.shape)),f=r["util"].locToIndex([t,e,s],p,r["util"].computeStrides(i.shape)),m=l[o]+h[f];m>u&&(u=m)}}}const c=r["util"].locToIndex([R,t,n,s],N,r["util"].computeStrides(T));E[c]=u}}}const A=c.write(r["util"].toTypedArray(E,a.dtype),T,a.dtype);return{dataId:A,shape:T,dtype:a.dtype}}},ke={kernelName:r["Dilation2DBackpropFilter"],backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:a,filter:i,dy:o}=t,{strides:s,pad:u,dilations:c}=n,l=e,d=r["util"].toNestedArray(a.shape,l.data.get(a.dataId).values),h=r["util"].toNestedArray(i.shape,l.data.get(i.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:O,dilationWidth:_,outShape:C}=r["backend_util"].computeDilation2DInfo(a.shape,i.shape,s,u,"NHWC",c);r["util"].assert(o.rank===C.length,()=>`Error in ${r["Dilation2DBackpropFilter"]}, dy must have the same rank as output ${C.length}, but got `+o.rank);const T=r["util"].toNestedArray(C,l.data.get(o.dataId).values),I=r["util"].makeZerosNestedTypedArray(i.shape,i.dtype);for(let r=0;r<p;++r)for(let t=0;t<b;++t){const e=t*x-v.top;for(let n=0;n<y;++n){const a=n*w-v.left;for(let i=0;i<g;++i){let o=Number.MIN_SAFE_INTEGER,s=0,u=0;for(let t=0;t<k;++t){const n=e+t*O;if(n>=0&&n<f)for(let e=0;e<S;++e){const c=a+e*_;if(c>=0&&c<m){const a=d[r][n][c][i]+h[t][e][i];a>o&&(o=a,s=t,u=e)}}}I[s][u][i]+=T[r][t][n][i]}}}const N=l.write(r["util"].toTypedArray(I,a.dtype),i.shape,i.dtype);return{dataId:N,shape:i.shape,dtype:i.dtype}}},Se={kernelName:r["Dilation2DBackpropInput"],backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:a,filter:i,dy:o}=t,{strides:s,pad:u,dilations:c}=n,l=e,d=r["util"].toNestedArray(a.shape,l.data.get(a.dataId).values),h=r["util"].toNestedArray(i.shape,l.data.get(i.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:g,outHeight:b,outWidth:y,padInfo:v,strideHeight:x,strideWidth:w,filterHeight:k,filterWidth:S,dilationHeight:O,dilationWidth:_,outShape:C}=r["backend_util"].computeDilation2DInfo(a.shape,i.shape,s,u,"NHWC",c);r["util"].assert(o.rank===C.length,()=>`Error in ${r["Dilation2DBackpropInput"]}, dy must have the same rank as output ${C.length}, but got `+o.rank);const T=r["util"].toNestedArray(C,l.data.get(o.dataId).values),I=r["util"].makeZerosNestedTypedArray(a.shape,a.dtype);for(let r=0;r<p;++r)for(let t=0;t<b;++t){const e=t*x-v.top;for(let n=0;n<y;++n){const a=n*w-v.left;for(let i=0;i<g;++i){let o=Number.MIN_SAFE_INTEGER,s=e<0?0:e,u=a<0?0:a;for(let t=0;t<k;++t){const n=e+t*O;if(n>=0&&n<f)for(let e=0;e<S;++e){const c=a+e*_;if(c>=0&&c<m){const a=d[r][n][c][i]+h[t][e][i];a>o&&(o=a,s=n,u=c)}}}I[r][s][u][i]+=T[r][t][n][i]}}}const N=l.write(r["util"].toTypedArray(I,a.dtype),a.shape,a.dtype);return{dataId:N,shape:a.shape,dtype:a.dtype}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Oe=n("734e"),_e=n("5ba1");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ce(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,keepDims:u}=i;let c;Object(a["a"])(o,"sum"),c="bool"===o.dtype?Object(It["a"])({inputs:{x:o},backend:n,attrs:{dtype:"int32"}}):Object(h["a"])({inputs:{x:o},backend:n});const l=c.shape.length,d=r["util"].parseAxisParam(s,c.shape),p=r["backend_util"].getAxesPermutation(d,l);let f=d,m=c;null!=p&&(m=Object(L["a"])({inputs:{x:c},backend:n,attrs:{perm:p}}),f=r["backend_util"].getInnerMostAxes(f.length,l)),r["backend_util"].assertAxesAreInnerMostDims("sum",f,m.shape.length);const[g,b]=r["backend_util"].computeOutAndReduceShapes(m.shape,f),y=r["backend_util"].upcastType(m.dtype,"int32");let v=Object(_e["a"])(n,g,y);const x=r["util"].sizeFromShape(b),w=n.data.get(v.dataId).values,k=n.data.get(m.dataId).values;for(let r=0;r<w.length;++r){const t=r*x;let e=0;for(let n=0;n<x;++n)e+=k[t+n];w[r]=e}if(u){const t=r["backend_util"].expandShapeToKeepDim(v.shape,d),e=v;v=C({inputs:{x:v},backend:n,attrs:{shape:t}}),n.disposeIntermediateTensorInfo(e)}return n.disposeIntermediateTensorInfo(c),null!=p&&n.disposeIntermediateTensorInfo(m),v}const Te={kernelName:r["Sum"],backendName:"cpu",kernelFunc:Ce};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ie(t){const{inputs:e,backend:n,attrs:a}=t,{equation:i}=a,o=e,{allDims:s,summedDims:u,idDims:c}=r["backend_util"].decodeEinsumEquation(i,o.length);r["backend_util"].checkEinsumDimSizes(s.length,c,o);const{path:l,steps:d}=r["backend_util"].getEinsumComputePath(u,c),h=d.length;let p=null,f=s.length;const m=[];for(let g=0;g<h;++g){for(const t of d[g]){const{permutationIndices:e,expandDims:a}=r["backend_util"].getEinsumPermutation(f,c[t]);let i;r["backend_util"].isIdentityPermutation(e)?i=o[t]:(i=Object(L["a"])({inputs:{x:o[t]},backend:n,attrs:{perm:e}}),m.push(i));const s=i.shape.slice();for(let t=0;t<a.length;++t)s.splice(a[t],0,1);r["util"].arraysEqual(i.shape,s)||(i=C({inputs:{x:i},backend:n,attrs:{shape:s}}),m.push(i)),null===p?p=i:(p=Object(Oe["a"])({inputs:{a:i,b:p},backend:n}),m.push(p))}g<h-1&&(l[g]>=0&&(p=Ce({inputs:{x:p},backend:n,attrs:{axis:l[g]-(s.length-f),keepDims:!1}}),m.push(p)),f--)}for(const r of m)r!==p&&n.disposeIntermediateTensorInfo(r);return p}const Ne={kernelName:r["Einsum"],backendName:"cpu",kernelFunc:Ie};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ee(t){const{inputs:e,backend:n}=t,{dy:i,y:o}=e;Object(a["a"])([i,o],"eluGrad");const s=new Float32Array(r["util"].sizeFromShape(o.shape)),u=n.data.get(o.dataId).values,c=n.data.get(i.dataId).values;for(let r=0;r<u.length;++r){const t=u[r];s[r]=t>=1?c[r]:c[r]*(t+1)}return n.makeTensorInfo(o.shape,"float32",s)}const Ae={kernelName:r["EluGrad"],backendName:"cpu",kernelFunc:Ee};var Re=n("acaf");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const je=r["backend_util"].ERF_P,De=r["backend_util"].ERF_A1,Fe=r["backend_util"].ERF_A2,Me=r["backend_util"].ERF_A3,Pe=r["backend_util"].ERF_A4,$e=r["backend_util"].ERF_A5,Le=Object(c["a"])(r["Erf"],t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+je*n);return e*(1-(((($e*r+Pe)*r+Me)*r+Fe)*r+De)*r*Math.exp(-n*n))}),Be={kernelName:r["Erf"],backendName:"cpu",kernelFunc:Le};var ze=n("ae84");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(t){const{inputs:e,backend:n,attrs:a}=t,{input:i}=e,{dim:o}=a,s=i.shape.length,u=i.shape.slice();let c=o;return o<0&&(r["util"].assert(-(s+1)<=o,()=>`Axis must be in the interval [${-(s+1)}, ${s}]`),c=s+o+1),u.splice(c,0,1),C({inputs:{x:i},backend:n,attrs:{shape:u}})}const Ve={kernelName:r["ExpandDims"],backendName:"cpu",kernelFunc:We};var Ue=n("959e");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ge=Object(m["a"])((t,e)=>t/e),He=Object(tt["a"])(r["RealDiv"],Ge),qe={kernelName:r["RealDiv"],backendName:"cpu",kernelFunc:He};var Ke=n("432a");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xe(t,e,n){const a=t.shape,i=a[0],o=a[1],s=n.data.get(t.dataId),u=s.complexTensorInfos.real,c=s.complexTensorInfos.imag,l=[i,o],d=r["util"].sizeFromShape(l),h=r["util"].getTypedArrayFromDType("float32",d),p=r["util"].getTypedArrayFromDType("float32",d);for(let b=0;b<i;b++){const t=Object(xt["a"])({inputs:{x:u},backend:n,attrs:{begin:[b,0],size:[1,o]}}),a=Object(xt["a"])({inputs:{x:c},backend:n,attrs:{begin:[b,0],size:[1,o]}}),i=Object(Rt["a"])({inputs:{real:t,imag:a},backend:n}),{real:s,imag:l}=Ye(i,e,n),d=r["backend_util"].mergeRealAndImagArrays(s,l);for(let e=0;e<o;e++){const t=r["backend_util"].getComplexWithIndex(d,e);h[b*o+e]=t.real,p[b*o+e]=t.imag}n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i)}const f=n.makeTensorInfo(l,"float32",h),m=n.makeTensorInfo(l,"float32",p),g=Object(Rt["a"])({inputs:{real:f,imag:m},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),g}function Ye(t,e,n){const a=r["util"].sizeFromShape(t.shape),i=n.data.get(t.dataId),o=n.data.get(i.complexTensorInfos.real.dataId).values,s=n.data.get(i.complexTensorInfos.imag.dataId).values;if(Je(a)){const i=Ze(o,s,a,e,n),u=[t.shape[0],t.shape[1]];if(e){const t=n.makeTensorInfo(u,"float32",i.real),e=n.makeTensorInfo(u,"float32",i.imag),o=n.makeTensorInfo([],"float32",r["util"].createScalarValue(a,"float32")),s=Object(h["a"])({inputs:{x:o},backend:n}),c=qe.kernelFunc({inputs:{a:t,b:o},backend:n}),l=qe.kernelFunc({inputs:{a:e,b:s},backend:n}),d=n.data.get(c.dataId).values,p=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),{real:d,imag:p}}return i}{const t=r["backend_util"].mergeRealAndImagArrays(o,s),n=Qe(t,a,e);return r["backend_util"].splitRealAndImagArrays(n)}}function Je(t){return 0===(t&t-1)}function Ze(t,e,n,a,i){if(1===n)return{real:t,imag:e};const o=r["backend_util"].mergeRealAndImagArrays(t,e),s=n/2,u=r["backend_util"].complexWithEvenIndex(o),c=u.real,l=u.imag,d=[c.length],h=i.makeTensorInfo(d,"float32",c),p=i.makeTensorInfo(d,"float32",l),f=Object(Rt["a"])({inputs:{real:h,imag:p},backend:i}),m=r["backend_util"].complexWithOddIndex(o),g=m.real,b=m.imag,y=[g.length],v=i.makeTensorInfo(y,"float32",g),x=i.makeTensorInfo(y,"float32",b),w=Object(Rt["a"])({inputs:{real:v,imag:x},backend:i}),k=Ze(c,l,s,a,i),S=k.real,O=k.imag,C=[S.length],T=i.makeTensorInfo(C,"float32",S),I=i.makeTensorInfo(C,"float32",O),N=Object(Rt["a"])({inputs:{real:T,imag:I},backend:i}),E=Ze(g,b,s,a,i),A=E.real,R=E.imag,j=[A.length],D=i.makeTensorInfo(j,"float32",A),F=i.makeTensorInfo(j,"float32",R),M=Object(Rt["a"])({inputs:{real:D,imag:F},backend:i}),P=r["backend_util"].exponents(n,a),$=[P.real.length],L=i.makeTensorInfo($,"float32",P.real),B=i.makeTensorInfo($,"float32",P.imag),z=Object(Rt["a"])({inputs:{real:L,imag:B},backend:i}),W=Object(Oe["a"])({inputs:{a:z,b:M},backend:i}),V=Object(_["a"])({inputs:{a:N,b:W},backend:i}),U=Object(Ke["a"])({inputs:{a:N,b:W},backend:i}),G=Object($t["a"])({inputs:{input:V},backend:i}),H=Object($t["a"])({inputs:{input:U},backend:i}),q=Mt({inputs:{input:V},backend:i}),K=Mt({inputs:{input:U},backend:i}),X=Lt({inputs:[G,H],backend:i,attrs:{axis:0}}),Y=Lt({inputs:[q,K],backend:i,attrs:{axis:0}}),J=i.data.get(X.dataId).values,Z=i.data.get(Y.dataId).values;return i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(w),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(I),i.disposeIntermediateTensorInfo(N),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(F),i.disposeIntermediateTensorInfo(M),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(z),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(V),i.disposeIntermediateTensorInfo(U),i.disposeIntermediateTensorInfo(G),i.disposeIntermediateTensorInfo(q),i.disposeIntermediateTensorInfo(H),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(X),i.disposeIntermediateTensorInfo(Y),{real:J,imag:Z}}function Qe(t,e,n){const a=new Float32Array(2*e);for(let i=0;i<e;i++){let o=0,s=0;for(let a=0;a<e;a++){const u=r["backend_util"].exponent(i*a,e,n),c=r["backend_util"].getComplexWithIndex(t,a);o+=c.real*u.real-c.imag*u.imag,s+=c.real*u.imag+c.imag*u.real}n&&(o/=e,s/=e),r["backend_util"].assignToTypedArray(a,o,s,i)}return a}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(t){const{inputs:e,backend:n}=t,{input:a}=e,i=r["util"].sizeFromShape(a.shape),o=a.shape[a.shape.length-1],s=i/o,u=C({inputs:{x:a},backend:n,attrs:{shape:[s,o]}}),c=Xe(u,!1,n),l=C({inputs:{x:c},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}const en={kernelName:r["FFT"],backendName:"cpu",kernelFunc:tn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t){const{backend:e,attrs:n}=t,{shape:a,value:i,dtype:o}=n,s=o||r["util"].inferDtype(i),u=r["util"].getArrayFromDType(s,r["util"].sizeFromShape(a));return an(u,i,s),e.makeTensorInfo(a,s,u)}const rn={kernelName:r["Fill"],backendName:"cpu",kernelFunc:nn};function an(t,e,n){t.fill(e)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const on={kernelName:r["FlipLeftRight"],backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:a}=t,i=n,o=r["util"].getTypedArrayFromDType(a.dtype,r["util"].sizeFromShape(a.shape)),[s,u,c,l]=a.shape,d=i.data.get(a.dataId).values;for(let r=0;r<s;r++){const t=r*c*u*l;for(let e=0;e<u;e++){const n=e*(c*l);for(let e=0;e<c;e++){const r=e*l;for(let a=0;a<l;a++){const i=Math.round(c-e-1),s=t+n+r+a;let u=d[s];if(i>=0&&i<c){const e=i*l,r=t+n+e+a;u=d[r]}o[s]=u}}}}const h=i.write(o,a.shape,a.dtype);return{dataId:h,shape:a.shape,dtype:a.dtype}}};var sn=n("0a08");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const un=Object(m["a"])((t,e)=>Math.floor(t/e)),cn=Object(tt["a"])(r["FloorDiv"],un,null,"int32"),ln={kernelName:r["FloorDiv"],backendName:"cpu",kernelFunc:cn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dn(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=zt({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h}});if(o){const t=m;if("NCHW"===l&&1===o.shape.length&&1!==o.shape[0]){const t=C({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});m=Object(_["a"])({inputs:{a:m,b:t},backend:n}),n.disposeIntermediateTensorInfo(t)}else m=Object(_["a"])({inputs:{a:m,b:o},backend:n});n.disposeIntermediateTensorInfo(t)}if(p){const t=m;if("NCHW"===l&&"prelu"===p&&1===s.shape.length&&1!==s.shape[0]){const t=C({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});m=O(n,m,p,t,f),n.disposeIntermediateTensorInfo(t)}else m=O(n,m,p,s,f);n.disposeIntermediateTensorInfo(t)}return m}const hn={kernelName:r["FusedConv2D"],backendName:"cpu",kernelFunc:dn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pn(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let m=pe({inputs:{x:a,filter:i},backend:n,attrs:{strides:u,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h}});if(o){const t=m;m=Object(_["a"])({inputs:{a:m,b:o},backend:n}),n.disposeIntermediateTensorInfo(t)}if(p){const t=m;m=O(n,m,p,s,f),n.disposeIntermediateTensorInfo(t)}return m}const fn={kernelName:r["FusedDepthwiseConv2D"],backendName:"cpu",kernelFunc:pn};var mn=n("c701");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gn(t){const{inputs:e,backend:n}=t,{params:a,indices:i}=e,o=r["util"].sizeFromShape(a.shape),s=i.shape,u=s[s.length-1],[c,l,d,h]=r["backend_util"].prepareAndValidate(a,i);if(0===l)return n.makeTensorInfo(c,a.dtype,[]);const p=n.data.get(i.dataId).values,f=n.bufferSync(a),m=Object(mn["a"])(p,f,a.dtype,l,u,d,h,a.shape,o);return n.makeTensorInfo(c,a.dtype,m.values)}const bn={kernelName:r["GatherNd"],backendName:"cpu",kernelFunc:gn};var yn=n("61256");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,indices:s}=e,{axis:u,batchDims:c}=i;Object(a["a"])([o,s],"gatherV2");const l=r["util"].parseAxisParam(u,o.shape)[0],d=n.data.get(s.dataId).values,h=o.shape[l];for(let a=0;a<d.length;++a){const t=d[a];r["util"].assert(t<=h-1&&t>=0,()=>`GatherV2: the index value ${t} is not in [0, ${h-1}]`)}let p=c;null==c&&(p=0);const f=r["util"].sizeFromShape(s.shape),m=r["backend_util"].segment_util.collectGatherOpShapeInfo(o,s,l,p),g=C({inputs:{x:o},backend:n,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),b=C({inputs:{x:s},backend:n,attrs:{shape:[m.batchSize,f/m.batchSize]}}),y=[m.batchSize,m.outerSize,f/m.batchSize,m.sliceSize],v=n.bufferSync(b),x=n.bufferSync(g),w=Object(yn["a"])(x,v,y);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.makeTensorInfo(m.outputShape,w.dtype,w.values)}const xn={kernelName:r["GatherV2"],backendName:"cpu",kernelFunc:vn};var wn=n("8b87"),kn=n("7df4");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Sn(t){const{inputs:e,backend:n}=t,{input:a}=e,i=r["util"].sizeFromShape(a.shape),o=a.shape[a.shape.length-1],s=i/o,u=C({inputs:{x:a},backend:n,attrs:{shape:[s,o]}}),c=Xe(u,!0,n),l=C({inputs:{x:c},backend:n,attrs:{shape:a.shape}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),l}const On={kernelName:r["IFFT"],backendName:"cpu",kernelFunc:Sn},_n=Object(c["a"])(r["IsFinite"],t=>Number.isFinite(t)?1:0,"bool"),Cn={kernelName:r["IsFinite"],backendName:"cpu",kernelFunc:_n},Tn=Object(c["a"])(r["IsInf"],t=>Math.abs(t)===1/0?1:0,"bool"),In={kernelName:r["IsInf"],backendName:"cpu",kernelFunc:Tn},Nn=Object(c["a"])(r["IsNan"],t=>Number.isNaN(t)?1:0,"bool"),En={kernelName:r["IsNan"],backendName:"cpu",kernelFunc:Nn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var An=n("d9f3"),Rn=n("e3df"),jn=n("d521");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Dn(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=Object(jn["a"])(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const Fn={kernelName:r["LinSpace"],backendName:"cpu",kernelFunc:Dn};var Mn=n("9c14");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pn=Object(c["a"])(r["Log1p"],t=>Math.log1p(t)),$n={kernelName:r["Log1p"],backendName:"cpu",kernelFunc:Pn},Ln=Object(m["a"])((t,e)=>t&&e),Bn=Object(tt["a"])(r["LogicalAnd"],Ln,null,"bool"),zn={kernelName:r["LogicalAnd"],backendName:"cpu",kernelFunc:Bn},Wn=Object(c["a"])(r["LogicalNot"],t=>t?0:1,"bool"),Vn={kernelName:r["LogicalNot"],backendName:"cpu",kernelFunc:Wn},Un=Object(m["a"])((t,e)=>t||e),Gn=Object(tt["a"])(r["LogicalOr"],Un,null,"bool"),Hn={kernelName:r["LogicalOr"],backendName:"cpu",kernelFunc:Gn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qn(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{depthRadius:s,bias:u,alpha:c,beta:l}=i;Object(a["a"])(o,"LRN");const d=o.shape[3],h=d-1,p=n.data.get(o.dataId).values,f=r["util"].sizeFromShape(o.shape),m=new Float32Array(f);function g(t){const e=t%d;let n=t-e+Math.max(0,e-s);const r=t-e+Math.min(e+s,h);let a=0;for(;n<=r;n++){const t=p[n];a+=t*t}return a}for(let r=0;r<f;r++){const t=g(r),e=p[r]*Math.pow(u+c*t,-l);m[r]=e}return n.makeTensorInfo(o.shape,o.dtype,m)}const Kn={kernelName:r["LRN"],backendName:"cpu",kernelFunc:qn};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xn(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,y:s,dy:u}=e,{depthRadius:c,bias:l,alpha:d,beta:h}=i;Object(a["a"])(u,"LRNGrad");const p=r["util"].sizeFromShape(u.shape),f=u.shape[3],m=n.data.get(u.dataId).values,g=n.data.get(o.dataId).values,b=n.data.get(s.dataId).values,y=new Float32Array(p),v=p;for(let r=0;r<v;r++){const t=r%f,e=r-t+Math.max(0,t-c),n=r-t+Math.min(f,t+c+1);let a=0;for(let r=e;r<n;r++)a+=Math.pow(g[r],2);a=d*a+l;for(let i=e;i<n;i++){let t=-2*d*h*g[i]*b[r]/a;r===i&&(t+=Math.pow(a,-h)),t*=m[r],y[i]+=t}}return n.makeTensorInfo(u.shape,o.dtype,y)}const Yn={kernelName:r["LRNGrad"],backendName:"cpu",kernelFunc:Xn};var Jn=n("6d0f"),Zn=n("e9cd");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qn(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{reductionIndices:s,keepDims:u}=i,c=n;let l=o.shape;const d=l.length,h=r["util"].parseAxisParam(s,l);let p=h;const f=r["backend_util"].getAxesPermutation(p,d);let m=c.data.get(o.dataId).values;if(null!=f){const t=new Array(d);for(let e=0;e<t.length;e++)t[e]=l[f[e]];m=Object(Zn["a"])(m,l,o.dtype,f,t),p=r["backend_util"].getInnerMostAxes(p.length,d),l=t}Object(a["a"])(o,"max"),r["backend_util"].assertAxesAreInnerMostDims("max",p,d);const[g,b]=r["backend_util"].computeOutAndReduceShapes(l,p),y=r["util"].sizeFromShape(b),v=Object(Jn["a"])(m,y,g,o.dtype),x=c.write(v,g,o.dtype);let w=g;if(u){const t=r["backend_util"].expandShapeToKeepDim(g,h);w=t}return{dataId:x,shape:w,dtype:o.dtype}}const tr={kernelName:r["Max"],backendName:"cpu",kernelFunc:Qn};var er=n("57a7");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nr(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e;Object(a["a"])(o,"maxPool");const{filterSize:s,strides:u,pad:c,dimRoundingMode:l}=i,d=1;r["util"].assert(r["backend_util"].eitherStridesOrDilationsAreOne(u,d),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${u} and dilations '${d}'`);const p=r["backend_util"].computePool2DInfo(o.shape,s,u,d,c,l);let f;if(1===p.filterWidth&&1===p.filterHeight&&r["util"].arraysEqual(p.inShape,p.outShape))f=Object(h["a"])({inputs:{x:o},backend:n});else{const t=n.data.get(o.dataId).values,e=r["util"].computeStrides(o.shape),a=ot(t,o.shape,o.dtype,e,p,"max");f=n.makeTensorInfo(p.outShape,o.dtype,a.values)}return f}const rr={kernelName:r["MaxPool"],backendName:"cpu",kernelFunc:nr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ar(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{filterSize:s,strides:u,pad:c,dimRoundingMode:l,dataFormat:d}=i;Object(a["a"])(o,"maxPool3d");const h=r["backend_util"].computePool3DInfo(o.shape,s,u,1,c,l,d),p=n.data.get(o.dataId).values,f=ut(p,o.shape,o.dtype,r["util"].computeStrides(o.shape),h,"max");return n.makeTensorInfo(f.shape,"float32",f.values)}const ir={kernelName:r["MaxPool3D"],backendName:"cpu",kernelFunc:ar};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function or(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,input:s}=e,{filterSize:u,strides:c,pad:l,dimRoundingMode:d}=i;Object(a["a"])([o,s],"maxPool3DGrad");const h=r["backend_util"].computePool3DInfo(s.shape,u,c,1,l,d),p=n.bufferSync(s),f=ct(p,h),m=h.strideDepth,g=h.strideHeight,b=h.strideWidth,y=h.dilationDepth,v=h.dilationHeight,x=h.dilationWidth,w=h.effectiveFilterDepth,k=h.effectiveFilterHeight,S=h.effectiveFilterWidth,O=w-1-h.padInfo.front,_=S-1-h.padInfo.left,C=k-1-h.padInfo.top,T=Object(r["buffer"])(s.shape,"float32"),I=n.bufferSync(o);for(let r=0;r<h.batchSize;++r)for(let t=0;t<h.inChannels;++t)for(let e=0;e<h.inDepth;++e)for(let n=0;n<h.inHeight;++n)for(let a=0;a<h.inWidth;++a){const i=e-O,o=n-C,s=a-_;let u=0;for(let e=0;e<w;e+=y){const n=(i+e)/m;if(!(n<0||n>=h.outDepth||Math.floor(n)!==n))for(let a=0;a<k;a+=v){const i=(o+a)/g;if(!(i<0||i>=h.outHeight||Math.floor(i)!==i))for(let o=0;o<S;o+=x){const c=(s+o)/b;if(c<0||c>=h.outWidth||Math.floor(c)!==c)continue;const l=w*k*S-1-f.get(r,n,i,c,t),d=e*k*S+a*S+o,p=l===d?1:0;if(0===p)continue;const m=I.get(r,n,i,c,t);u+=m*p}}}T.set(u,r,e,n,a,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const sr={kernelName:r["MaxPool3DGrad"],backendName:"cpu",kernelFunc:or};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ur(t){const{inputs:e,backend:n,attrs:i}=t,{dy:o,input:s,output:u}=e,c=s;Object(a["a"])([s,u],"maxPoolGrad");const{filterSize:l,strides:d,pad:h,dimRoundingMode:p}=i,f=r["backend_util"].computePool2DInfo(c.shape,l,d,1,h,p),m=n.data.get(c.dataId).values,g=Object(r["buffer"])(f.outShape,c.dtype,st(m,c.shape,c.dtype,f).values),b=f.strideHeight,y=f.strideWidth,v=f.dilationHeight,x=f.dilationWidth,w=f.effectiveFilterHeight,k=f.effectiveFilterWidth,S=k-1-f.padInfo.left,O=w-1-f.padInfo.top,_=Object(r["buffer"])(c.shape,"float32"),C=n.data.get(o.dataId).values,T=Object(r["buffer"])(o.shape,"float32",C);for(let r=0;r<f.batchSize;++r)for(let t=0;t<f.inChannels;++t)for(let e=0;e<f.inHeight;++e)for(let n=0;n<f.inWidth;++n){const a=e-O,i=n-S;let o=0;for(let e=0;e<w;e+=v){const n=(a+e)/b;if(!(n<0||n>=f.outHeight||Math.floor(n)!==n))for(let a=0;a<k;a+=x){const s=(i+a)/y;if(s<0||s>=f.outWidth||Math.floor(s)!==s)continue;const u=w*k-1-g.get(r,n,s,t),c=e*k+a,l=u===c?1:0;if(0===l)continue;const d=T.get(r,n,s,t);o+=d*l}}_.set(o,r,e,n,t)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const cr={kernelName:r["MaxPoolGrad"],backendName:"cpu",kernelFunc:ur};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lr(t,e,n,a,i){const o=r["util"].computeStrides(e),s=ot(t,e,n,o,i,"max"),u=st(t,e,n,i,!0,a);return[s.values,u.values]}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dr={kernelName:r["MaxPoolWithArgmax"],backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:i}=t,{filterSize:o,strides:s,pad:u,includeBatchInIndex:c}=e,l=n;Object(a["a"])(i,"MaxPoolWithArgmax");const d=l.data.get(i.dataId).values,h=r["backend_util"].computePool2DInfo(i.shape,o,s,[1,1],u),[p,f]=lr(d,i.shape,i.dtype,c,h),m=l.write(p,h.outShape,i.dtype),g=l.write(f,h.outShape,i.dtype);return[{dataId:m,shape:h.outShape,dtype:i.dtype},{dataId:g,shape:h.outShape,dtype:"int32"}]}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(t){const{inputs:e,backend:n,attrs:a}=t,{x:i}=e,{axis:o,keepDims:s}=a,u=r["util"].parseAxisParam(o,i.shape),c=r["backend_util"].computeOutAndReduceShapes(i.shape,u),l=c[1],d=r["util"].sizeFromShape(l),h=[],p=n.makeTensorInfo([],"float32",new Float32Array([d]));h.push(p);const f=Object(It["a"])({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});h.push(f);const m=He({inputs:{a:f,b:p},backend:n});h.push(m);const g=Ce({inputs:{x:m},backend:n,attrs:{axis:o,keepDims:s}});return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),g}const pr={kernelName:r["Mean"],backendName:"cpu",kernelFunc:hr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{axis:s,keepDims:u}=i;Object(a["a"])(o,"min");const c=r["util"].parseAxisParam(s,o.shape);let l=c;const d=r["backend_util"].getAxesPermutation(l,o.shape.length);let h=o;null!=d&&(h=Object(L["a"])({inputs:{x:o},backend:n,attrs:{perm:d}}),l=r["backend_util"].getInnerMostAxes(l.length,o.shape.length)),r["backend_util"].assertAxesAreInnerMostDims("min",l,h.shape.length);const[p,f]=r["backend_util"].computeOutAndReduceShapes(h.shape,l),m=r["util"].sizeFromShape(f),g=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(p),h.dtype),b=n.data.get(h.dataId).values;for(let r=0;r<g.length;++r){const t=r*m;let e=b[t];for(let n=0;n<m;++n){const r=b[t+n];(Number.isNaN(r)||r<e)&&(e=r)}g[r]=e}null!=d&&n.disposeIntermediateTensorInfo(h);const y=n.makeTensorInfo(p,h.dtype,g);if(u){const t=r["backend_util"].expandShapeToKeepDim(p,c),e=C({inputs:{x:y},backend:n,attrs:{shape:t}});return n.disposeIntermediateTensorInfo(y),e}return y}const mr={kernelName:r["Min"],backendName:"cpu",kernelFunc:fr};var gr=n("382f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function br(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{paddings:s,mode:u}=i;Object(a["a"])(o,"mirrorPad");const c=s.map((t,e)=>t[0]+o.shape[e]+t[1]),l=s.map(t=>t[0]),d=s.map((t,e)=>t[0]+o.shape[e]),h="reflect"===u?0:1,p=n.data.get(o.dataId).values,f=o.shape.length,m=r["util"].computeStrides(o.shape),g=r["util"].sizeFromShape(c),b=c.length,y=r["util"].computeStrides(c),v=r["util"].getTypedArrayFromDType(o.dtype,g);for(let a=0;a<g;a++){let t=r["util"].indexToLoc(a,b,y);for(let n=0;n<b;n++)t[n]<l[n]?t[n]=2*l[n]-t[n]-h:t[n]>=d[n]&&(t[n]=2*(d[n]-1)-t[n]+h);t=t.map((t,e)=>t-l[e]);const e=r["util"].locToIndex(t,f,m);v[a]=p[e]}const x=n.write(v,c,o.dtype);return{dataId:x,shape:c,dtype:o.dtype}}const yr={kernelName:r["MirrorPad"],backendName:"cpu",kernelFunc:br},vr=Object(m["a"])((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),xr=Object(tt["a"])(r["Mod"],vr),wr={kernelName:r["Mod"],backendName:"cpu",kernelFunc:xr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var kr=n("6125");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sr(t){const{inputs:e,backend:n,attrs:a}=t,{logits:i}=e,{dim:o}=a,s=i.shape.length;let u=o;if(-1===u&&(u=s-1),u!==s-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${s} and dim was ${u}`);const c=r["util"].parseAxisParam([u],i.shape),l=Qn({inputs:{x:i},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),d=r["backend_util"].expandShapeToKeepDim(l.shape,c),h=C({inputs:{x:l},backend:n,attrs:{shape:d}}),p=Object(Ke["a"])({inputs:{a:i,b:h},backend:n}),f=Object(ze["a"])({inputs:{x:p},backend:n}),m=Ce({inputs:{x:f},backend:n,attrs:{axis:c,keepDims:!1}}),g=C({inputs:{x:m},backend:n,attrs:{shape:d}}),b=He({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),b}const Or={kernelName:r["Softmax"],backendName:"cpu",kernelFunc:Sr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(t){const{inputs:e,backend:n,attrs:i}=t,{logits:o}=e,{numSamples:s,seed:u,normalized:c}=i;Object(a["a"])(o,"multinomial");const l=c?o:Sr({inputs:{logits:o},backend:n,attrs:{dim:-1}}),d=l.shape[0],h=l.shape[1],p=n.data.get(l.dataId).values,f=[d,s],m=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(f),"int32");for(let r=0;r<d;++r){const t=r*h,e=new Float32Array(h-1);e[0]=p[t];for(let r=1;r<e.length;++r)e[r]=e[r-1]+p[t+r];const n=kr["alea"](u.toString()),a=r*s;for(let r=0;r<s;++r){const t=n();m[a+r]=e.length;for(let n=0;n<e.length;n++)if(t<e[n]){m[a+r]=n;break}}}return c||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(f,"int32",m)}const Cr={kernelName:r["Multinomial"],backendName:"cpu",kernelFunc:_r};var Tr=n("17af");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ir=r["kernel_impls"].nonMaxSuppressionV3Impl;function Nr(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c}=r;Object(a["a"])(i,"NonMaxSuppression");const l=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:h}=Ir(l,d,s,u,c);return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Er={kernelName:r["NonMaxSuppressionV3"],backendName:"cpu",kernelFunc:Nr},Ar=r["kernel_impls"].nonMaxSuppressionV4Impl;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c,padToMaxOutputSize:l}=r;Object(a["a"])(i,"NonMaxSuppressionPadded");const d=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,{selectedIndices:p,validOutputs:f}=Ar(d,h,s,u,c,l);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const jr={kernelName:r["NonMaxSuppressionV4"],backendName:"cpu",kernelFunc:Rr},Dr=r["kernel_impls"].nonMaxSuppressionV5Impl;
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:o}=e,{maxOutputSize:s,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=r;Object(a["a"])(i,"NonMaxSuppressionWithScore");const d=n.data.get(i.dataId).values,h=n.data.get(o.dataId).values,p=s,f=u,m=c,g=l,{selectedIndices:b,selectedScores:y}=Dr(d,h,p,f,m,g);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const Mr={kernelName:r["NonMaxSuppressionV5"],backendName:"cpu",kernelFunc:Fr};var Pr=n("18c7");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t){const{inputs:e,backend:n,attrs:i}=t,{indices:o}=e,{dtype:s,depth:u,onValue:c,offValue:l}=i;Object(a["a"])(o,"oneHot");const d=r["util"].sizeFromShape(o.shape),h=new Float32Array(d*u);h.fill(l);const p=n.data.get(o.dataId).values;for(let r=0;r<d;++r)p[r]>=0&&p[r]<u&&(h[r*u+p[r]]=c);return n.makeTensorInfo([...o.shape,u],s,h)}const Lr={kernelName:r["OneHot"],backendName:"cpu",kernelFunc:$r};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Br(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("zerosLike is not supported for string tensors");if("complex64"===r.dtype){const t=Object($t["a"])({inputs:{input:r},backend:n}),e=Br({inputs:{x:t},backend:n}),a=Mt({inputs:{input:r},backend:n}),i=Br({inputs:{x:a},backend:n}),o=Object(Rt["a"])({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return nn({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const zr={kernelName:r["ZerosLike"],backendName:"cpu",kernelFunc:Br};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t){const{inputs:e,backend:n}=t,{x:r}=e;if("string"===r.dtype)throw new Error("onesLike is not supported for string tensors");if("complex64"===r.dtype){const t=Object($t["a"])({inputs:{input:r},backend:n}),e=Wr({inputs:{x:t},backend:n}),a=Mt({inputs:{input:r},backend:n}),i=Br({inputs:{x:a},backend:n}),o=Object(Rt["a"])({inputs:{real:e,imag:i},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),o}return nn({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const Vr={kernelName:r["OnesLike"],backendName:"cpu",kernelFunc:Wr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ur(t){const{inputs:e,backend:n,attrs:a}=t,{axis:i}=a;if(1===e.length)return We({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const o=e[0].shape,s=e[0].dtype;e.forEach(t=>{r["util"].assertShapesMatch(o,t.shape,"All tensors passed to stack must have matching shapes"),r["util"].assert(s===t.dtype,()=>"All tensors passed to stack must have matching dtypes")});const u=[],c=e.map(t=>{const e=We({inputs:{input:t},backend:n,attrs:{dim:i}});return u.push(e),e}),l=Lt({inputs:c,backend:n,attrs:{axis:i}});return u.forEach(t=>n.disposeIntermediateTensorInfo(t)),l}const Gr={kernelName:r["Pack"],backendName:"cpu",kernelFunc:Ur};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hr(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{paddings:s,constantValue:u}=i;Object(a["a"])(o,"pad");const c=s.map((t,e)=>t[0]+o.shape[e]+t[1]),l=s.map(t=>t[0]),d=n.data.get(o.dataId).values,h=r["util"].sizeFromShape(o.shape),p=o.shape.length,f=r["util"].computeStrides(o.shape),m=r["util"].sizeFromShape(c),g=c.length,b=r["util"].computeStrides(c),y=r["util"].getTypedArrayFromDType(o.dtype,m);0!==u&&y.fill(u);for(let a=0;a<h;a++){const t=r["util"].indexToLoc(a,p,f),e=t.map((t,e)=>t+l[e]),n=r["util"].locToIndex(e,g,b);y[n]=d[a]}const v=n.write(y,c,o.dtype);return{dataId:v,shape:c,dtype:o.dtype}}const qr={kernelName:r["PadV2"],backendName:"cpu",kernelFunc:Hr},Kr=Object(m["a"])((t,e)=>Math.pow(t,e)),Xr=Object(tt["a"])(r["Pow"],Kr),Yr={kernelName:r["Pow"],backendName:"cpu",kernelFunc:Xr};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Jr=n("6732"),Zr=n("8b16");
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qr(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,u=a.map(t=>n.data.get(t.dataId).values),c=a.map(t=>t.shape),l=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,[h,p,f]=Object(Zr["a"])(u,c,l,i.shape,i.dtype,d,o.shape,s),m=h.map(t=>n.makeTensorInfo([t.length],"int32",t)),g=n.makeTensorInfo(f,i.dtype,p);return m.concat([g])}const ta={kernelName:r["RaggedGather"],backendName:"cpu",kernelFunc:Qr};var ea=n("cbb7");
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:u}=r,c=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=s.map(t=>n.data.get(t.dataId).values),p=s.map(t=>t.shape),[f,m]=Object(ea["a"])(c,a.shape,l,i.shape,i.dtype,d,o.shape,h,p,u);return n.makeTensorInfo(f,i.dtype,m)}const ra={kernelName:r["RaggedTensorToTensor"],backendName:"cpu",kernelFunc:na};var aa=n("d032");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ia(t){const{backend:e,attrs:n}=t,{start:r,stop:a,dtype:i,step:o}=n,s=Object(aa["a"])(r,a,o,i);return e.makeTensorInfo([s.length],i,s)}const oa={kernelName:r["Range"],backendName:"cpu",kernelFunc:ia},sa=Object(c["a"])(r["Reciprocal"],t=>1/t),ua={kernelName:r["Reciprocal"],backendName:"cpu",kernelFunc:sa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ca(t){const{inputs:e,backend:n,attrs:i}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:u,size:c}=i;Object(a["a"])(o,"resizeBilinear");const l=r["util"].computeStrides(o.shape),[d,h]=c,[p,f,m,g]=o.shape,b=n.data.get(o.dataId).values,y=new Float32Array(r["util"].sizeFromShape([p,d,h,g])),v=[s&&d>1?f-1:f,s&&h>1?m-1:m],x=[s&&d>1?d-1:d,s&&h>1?h-1:h];let w=0;const k=v[0]/x[0],S=v[1]/x[1];for(let r=0;r<p;r++)for(let t=0;t<d;t++){let e;e=u?k*(t+.5)-.5:k*t;const n=Math.max(0,Math.floor(e)),a=e-n,i=Math.min(f-1,Math.ceil(e)),o=r*l[0]+n*l[1],s=r*l[0]+i*l[1];for(let t=0;t<h;t++){let e;e=u?S*(t+.5)-.5:S*t;const n=Math.max(0,Math.floor(e)),r=e-n,i=Math.min(m-1,Math.ceil(e)),c=o+n*l[2],d=s+n*l[2],h=o+i*l[2],p=s+i*l[2];for(let t=0;t<g;t++){const e=b[c+t],n=b[d+t],i=b[h+t],o=b[p+t],s=e+(i-e)*r,u=n+(o-n)*r,l=s+(u-s)*a;y[w++]=l}}}return n.makeTensorInfo([p,d,h,g],"float32",y)}const la={kernelName:r["ResizeBilinear"],backendName:"cpu",kernelFunc:ca};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function da(t){const{inputs:e,backend:n,attrs:i}=t,{images:o,dy:s}=e,{alignCorners:u}=i;Object(a["a"])([s,o],"resizeBilinearGrad");const c=r["util"].computeStrides(o.shape),[l,d,h,p]=o.shape,[,f,m]=s.shape,g=new Float32Array(l*d*h*p),b=[u&&f>1?d-1:d,u&&m>1?h-1:h],y=[u&&f>1?f-1:f,u&&m>1?m-1:m],v=b[0]/y[0],x=b[1]/y[1],w=n.data.get(s.dataId).values;let k=0;for(let r=0;r<l;r++){const t=r*c[0];for(let e=0;e<f;e++){const n=e*v,r=Math.floor(n),a=Math.min(Math.ceil(n),d-1),i=t+r*c[1],o=t+a*c[1],s=n-r,u=1-s;for(let t=0;t<m;t++){const e=t*x,n=Math.floor(e),r=Math.min(Math.ceil(e),h-1),a=e-n,l=1-a,d=i+n*c[2],f=i+r*c[2],m=o+n*c[2],b=o+r*c[2],y=u*l,v=u*a,S=s*l,O=s*a;for(let t=0;t<p;t++){const e=w[k++];g[d+t]+=e*y,g[f+t]+=e*v,g[m+t]+=e*S,g[b+t]+=e*O}}}}return n.makeTensorInfo([l,h,d,p],"float32",g)}const ha={kernelName:r["ResizeBilinearGrad"],backendName:"cpu",kernelFunc:da};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pa(t){const{inputs:e,backend:n,attrs:i}=t,{images:o}=e,{alignCorners:s,halfPixelCenters:u,size:c}=i;Object(a["a"])(o,"resizeNearestNeighbor");const l=r["util"].computeStrides(o.shape),[d,h]=c,[p,f,m,g]=o.shape,b=n.data.get(o.dataId).values,y=new Float32Array(p*d*h*g),v=[s&&d>1?f-1:f,s&&h>1?m-1:m],x=[s&&d>1?d-1:d,s&&h>1?h-1:h],w=v[0]/x[0],k=v[1]/x[1];let S=0;for(let r=0;r<p;r++){const t=r*l[0];for(let e=0;e<d;e++){const n=u?w*(e+.5):w*e;let r=Math.min(f-1,s?Math.round(n):Math.floor(n));u&&(r=Math.max(0,r));const a=t+r*l[1];for(let t=0;t<h;t++){const e=u?k*(t+.5):k*t;let n=Math.min(m-1,s?Math.round(e):Math.floor(e));u&&(n=Math.max(0,n));const r=a+n*l[2];for(let t=0;t<g;t++){const e=b[r+t];y[S++]=e}}}}return n.makeTensorInfo([p,d,h,g],o.dtype,y)}const fa={kernelName:r["ResizeNearestNeighbor"],backendName:"cpu",kernelFunc:pa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(t){const{inputs:e,backend:n,attrs:i}=t,{images:o,dy:s}=e,{alignCorners:u}=i;Object(a["a"])([s,o],"resizeNearestNeighborGrad");const c=r["util"].computeStrides(o.shape),l=r["util"].computeStrides(s.shape),[d,h,p,f]=o.shape,[,m,g]=s.shape,b=new Float32Array(d*h*p*f),y=n.data.get(s.dataId).values,v=[u&&m>1?h-1:h,u&&g>1?p-1:p],x=[u&&m>1?m-1:m,u&&g>1?g-1:g],w=v[0]/x[0],k=v[1]/x[1],S=1/w,O=1/k,_=2*Math.ceil(S)+2,C=2*Math.ceil(O)+2;for(let r=0;r<d;r++){const t=r*c[0];for(let e=0;e<h;e++){const n=t+e*c[1],r=Math.floor(e*S),a=Math.floor(r-_/2);for(let i=0;i<p;i++){const r=n+i*c[2],o=Math.floor(i*O),s=Math.floor(o-C/2);for(let n=0;n<f;n++){let o=0;for(let r=0;r<_;r++){const c=r+a;if(c<0||c>=m)continue;const d=t+c*l[1],f=c*w,b=Math.min(h-1,u?Math.round(f):Math.floor(f));if(e===b)for(let t=0;t<C;t++){const e=t+s;if(e<0||e>=g)continue;const r=d+e*l[2],a=e*k,c=Math.min(p-1,u?Math.round(a):Math.floor(a));i===c&&(o+=y[r+n])}}b[r+n]=o}}}}return n.makeTensorInfo(o.shape,o.dtype,b)}const ga={kernelName:r["ResizeNearestNeighborGrad"],backendName:"cpu",kernelFunc:ma};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{dims:s}=i;Object(a["a"])(o,"reverse");const u=o.shape.length,c=r["util"].parseAxisParam(s,o.shape);if(0===u)return Object(h["a"])({inputs:{x:o},backend:n});const l=new r["TensorBuffer"](o.shape,o.dtype),d=n.bufferSync(o);for(let r=0;r<l.size;r++){const t=l.indexToLoc(r),e=t.slice();c.forEach(t=>e[t]=o.shape[t]-1-e[t]),l.set(d.get(...e),...t)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const ya={kernelName:r["Reverse"],backendName:"cpu",kernelFunc:ba},va={kernelName:r["RotateWithOffset"],backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:a}=t,{radians:i,fillValue:o,center:s}=e,u=n,c=r["util"].getTypedArrayFromDType(a.dtype,r["util"].sizeFromShape(a.shape)),[l,d,h,p]=a.shape,[f,m]=r["backend_util"].getImageCenter(s,d,h),g=255,b=Math.sin(i),y=Math.cos(i),v=u.data.get(a.dataId).values;for(let r=0;r<l;r++){const t=r*h*d*p;for(let e=0;e<d;e++){const n=e*(h*p);for(let r=0;r<h;r++){const a=r*p;for(let i=0;i<p;i++){const s=[l,e,r,i],u=s[2],x=s[1];let w=(u-f)*y-(x-m)*b,k=(u-f)*b+(x-m)*y;w=Math.round(w+f),k=Math.round(k+m);let S=o;if("number"!==typeof o&&(S=3===i?g:o[i]),w>=0&&w<h&&k>=0&&k<d){const e=k*(h*p),n=w*p,r=t+e+n+i;S=v[r]}const O=t+n+a+i;c[O]=S}}}}const x=u.write(c,a.shape,a.dtype);return{dataId:x,shape:a.shape,dtype:a.dtype}}},xa=Object(c["a"])(r["Round"],t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),wa={kernelName:r["Round"],backendName:"cpu",kernelFunc:xa};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ka=n("d425"),Sa=n("da1c");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Oa(t){const{inputs:e,backend:n,attrs:a}=t,{indices:i,updates:o}=e,{shape:s}=a,{sliceRank:u,numUpdates:c,sliceSize:l,strides:d,outputSize:h}=r["backend_util"].calculateShapes(o,i,s),p=!0,f=n.bufferSync(i),m=n.bufferSync(o),g=Object(Sa["a"])(f,m,s,h,l,c,u,d,0,p);return n.makeTensorInfo(s,g.dtype,g.values)}const _a={kernelName:r["ScatterNd"],backendName:"cpu",kernelFunc:Oa};
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t,e){let n=0,r=t.length,a=0;while(n<r)a=Math.floor((n+r)/2),t[a]<e?n=a+1:r=a;return r}function Ta(t,e){let n=0,r=t.length,a=0;while(n<r)a=Math.floor((n+r)/2),t[a]<=e?n=a+1:r=a;return r}function Ia(t,e,n,a,i,o){const s=r["util"].getArrayFromDType("int32",n*i);for(let r=0;r<n;++r){const n=t.slice(r*a,(r+1)*a),u=r*i;for(let t=0;t<i;++t)s[u+t]="left"===o?Ca(n,e[t+u]):Ta(n,e[t+u])}return s}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Na(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=Ia(s,u,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",c)}const Ea={kernelName:r["SearchSorted"],backendName:"cpu",kernelFunc:Na};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aa(t){const{inputs:e,backend:n}=t,{condition:i,t:o,e:s}=e;Object(a["a"])([i,o,s],"select");const u=i.shape.length,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values,d=n.data.get(s.dataId).values,h=Object(r["upcastType"])(o.dtype,s.dtype),p=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(o.shape),h);let f=0;const m=0===u||u>1||1===o.shape.length?1:r["util"].sizeFromShape(o.shape.slice(1));for(let r=0;r<c.length;r++)for(let t=0;t<m;t++)1===c[r]?p[f++]=l[r]:p[f++]=d[r];return n.makeTensorInfo(o.shape,h,p)}const Ra={kernelName:r["Select"],backendName:"cpu",kernelFunc:Aa},ja=r["backend_util"].SELU_SCALEALPHA,Da=r["backend_util"].SELU_SCALE,Fa=Object(c["a"])(r["Selu"],t=>t>=0?Da*t:ja*(Math.exp(t)-1)),Ma={kernelName:r["Selu"],backendName:"cpu",kernelFunc:Fa},Pa=Object(c["a"])(r["Sign"],t=>t<0?-1:t>0?1:0),$a={kernelName:r["Sign"],backendName:"cpu",kernelFunc:Pa},La=Object(c["a"])(r["Sin"],t=>Math.sin(t)),Ba={kernelName:r["Sin"],backendName:"cpu",kernelFunc:La},za=Object(c["a"])(r["Sinh"],t=>Math.sinh(t)),Wa={kernelName:r["Sinh"],backendName:"cpu",kernelFunc:za},Va=1.1920928955078125e-7,Ua=Math.log(Va)+2,Ga=Object(c["a"])(r["Softplus"],t=>{const e=t>-Ua,n=t<Ua,r=Math.exp(t);let a;return a=n?r:e?t:Math.log(1+r),a}),Ha={kernelName:r["Softplus"],backendName:"cpu",kernelFunc:Ga};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qa(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{blockShape:s,paddings:u}=i;Object(a["a"])([o],"spaceToBatchND");const c=r["util"].sizeFromShape(s),l=[[0,0]];l.push(...u);for(let r=1+s.length;r<o.shape.length;++r)l.push([0,0]);const d=qr.kernelFunc({inputs:{x:o},backend:n,attrs:{paddings:l,constantValue:0}}),h=r["backend_util"].getReshaped(d.shape,s,c,!1),p=r["backend_util"].getPermuted(h.length,s.length,!1),f=r["backend_util"].getReshapedPermuted(d.shape,s,c,!1),m={x:d},g={shape:h},b=C({inputs:m,backend:n,attrs:g}),y={x:b},v={perm:p},x=Object(L["a"])({inputs:y,backend:n,attrs:v}),w={x:x},k={shape:f},S=C({inputs:w,backend:n,attrs:k});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(x),S}const Ka={kernelName:r["SpaceToBatchND"],backendName:"cpu",kernelFunc:qa};var Xa=n("b8d8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ya(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(1!==i.shape.length)throw new Error("Dense shape must be a vector, saw:\n        "+i.shape);if(2!==r.shape.length)throw new Error("Indices must be a matrix, saw:\n        "+r.shape);if(1!==a.shape.length)throw new Error("Values must be a vector, saw:\n        "+a.shape);if(0!==o.shape.length)throw new Error("Default value must be a scalar, saw:\n        "+o.shape);const s=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[d,h,p,f,m]=Object(Xa["a"])(s,r.shape,r.dtype,u,a.dtype,c,l);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],a.dtype,p),n.makeTensorInfo([f.length],"bool",new Uint8Array(f.map(t=>Number(t)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const Ja={kernelName:r["SparseFillEmptyRows"],backendName:"cpu",kernelFunc:Ya};var Za=n("b6c5");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qa(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(2!==r.shape.length)throw new Error("Input indices should be a matrix but received shape\n        "+r.shape);if(1!==a.shape.length)throw new Error("Input shape should be a vector but received shape\n        "+a.shape);if(1!==i.shape.length)throw new Error("Target shape should be a vector but received shape "+i.shape);const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,u=Array.from(n.data.get(i.dataId).values),[c,l,d]=Object(Za["a"])(s,r.shape,r.dtype,o,u);return[n.makeTensorInfo(l,r.dtype,c),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const ti={kernelName:r["SparseReshape"],backendName:"cpu",kernelFunc:Qa};var ei=n("e8a2");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ni(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n          "+a.shape);if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n          "+i.shape);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,[c,l]=Object(ei["a"])(o,r.shape,r.dtype,s,u,!0);return n.makeTensorInfo(l,r.dtype,c)}const ri={kernelName:r["SparseSegmentMean"],backendName:"cpu",kernelFunc:ni};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ai(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.shape.length)throw new Error("Indices should be a vector but received shape\n         "+a.shape);if(1!==i.shape.length)throw new Error("Segment ids should be a vector but received shape\n         "+i.shape);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,[c,l]=Object(ei["a"])(o,r.shape,r.dtype,s,u);return n.makeTensorInfo(l,r.dtype,c)}const ii={kernelName:r["SparseSegmentSum"],backendName:"cpu",kernelFunc:ai};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oi(t){const{inputs:e,backend:n,attrs:a}=t,{sparseIndices:i,sparseValues:o,defaultValue:s}=e,{outputShape:u}=a,{sliceRank:c,numUpdates:l,sliceSize:d,strides:h,outputSize:p}=r["backend_util"].calculateShapes(o,i,u),f=!1,m=n.bufferSync(i);let g;switch(o.dtype){case"bool":{const t=n.bufferSync(o),e=Boolean(n.data.get(s.dataId).values[0]);g=Object(Sa["a"])(m,t,u,p,d,l,c,h,e,f);break}case"float32":{const t=n.bufferSync(o),e=n.data.get(s.dataId).values[0];g=Object(Sa["a"])(m,t,u,p,d,l,c,h,e,f);break}case"int32":{const t=n.bufferSync(o),e=n.data.get(s.dataId).values[0];g=Object(Sa["a"])(m,t,u,p,d,l,c,h,e,f);break}case"string":{const t=n.bufferSync(o),e=r["util"].decodeString(n.data.get(s.dataId).values[0]);g=Object(Sa["a"])(m,t,u,p,d,l,c,h,e,f);break}default:throw new Error("Unsupported type "+o.dtype)}return n.makeTensorInfo(u,g.dtype,g.values)}const si={kernelName:r["SparseToDense"],backendName:"cpu",kernelFunc:oi};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ui(t){const{inputs:e,backend:n,attrs:a}=t,{x:i}=e,{numOrSizeSplits:o,axis:s}=a,u=r["util"].parseAxisParam(s,i.shape)[0],c=r["backend_util"].prepareSplitSize(i,o,u),l=new Array(i.shape.length).fill(0),d=i.shape.slice();return c.map(t=>{const e=[...d];e[u]=t;const r=Object(xt["a"])({inputs:{x:i},backend:n,attrs:{begin:l,size:e}});return l[u]+=t,r})}const ci={kernelName:r["SplitV"],backendName:"cpu",kernelFunc:ui};var li=n("75d3e");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const di={kernelName:r["Square"],backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Object(a["a"])(n,"square");const i=r.data.get(n.dataId).values,o=new Float32Array(i.length);for(let a=0;a<i.length;++a){const t=i[a];o[a]=t*t}const s=r.write(o,n.shape,n.dtype);return{dataId:s,shape:n.shape,dtype:n.dtype}}};var hi=n("5c5c");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pi=Object(c["a"])(r["Step"],(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),fi={kernelName:r["Step"],backendName:"cpu",kernelFunc:pi};var mi=n("e22c");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gi(t){const{inputs:e,backend:n,attrs:i}=t,{x:o}=e,{begin:s,end:u,strides:c,beginMask:l,endMask:d,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:f}=i;Object(a["a"])(o,"stridedSlice");const{finalShapeSparse:m,finalShape:g,isIdentity:b,sliceDim0:y,isSimpleSlice:v,begin:x,end:w,strides:k}=r["slice_util"].sliceInfo(o.shape,s,u,c,l,d,h,p,f);let S;if(b)S=C({inputs:{x:o},backend:n,attrs:{shape:g}});else if(y||v){r["util"].assert(o.shape.length>=1,()=>"Input must have rank at least 1, got: "+o.shape.length);const t=r["slice_util"].computeOutShape(x,w,k),e=Object(xt["a"])({inputs:{x:o},backend:n,attrs:{begin:x,size:t}});S=C({inputs:{x:e},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(e)}else{const t=n.bufferSync(o),e=Object(mi["a"])(m,t,k,x);S=n.makeTensorInfo(g,e.dtype,e.values)}return S}const bi={kernelName:r["StridedSlice"],backendName:"cpu",kernelFunc:gi};var yi=n("1ef8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vi(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:d}=e,h=n.data.get(l.dataId).values,p=n.data.get(d.dataId).values,[f,m]=Object(yi["a"])(h,p,a,i,o,s,u,c);return[n.makeTensorInfo([f.length],"string",f),n.makeTensorInfo(d.shape,"int32",m)]}const xi={kernelName:r["StringNGrams"],backendName:"cpu",kernelFunc:vi};var wi=n("e51a");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ki(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(1!==i.shape.length)throw new Error("Input must be a vector, got shape: "+i.shape);if(0!==o.shape.length)throw new Error("Delimiter must be a scalar, got shape: "+o.shape);const s=n.data.get(i.dataId).values,u=n.data.get(o.dataId).values[0],[c,l,d]=Object(wi["a"])(s,u,a),h=l.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",l),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Si={kernelName:r["StringSplit"],backendName:"cpu",kernelFunc:ki};var Oi=n("614d");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if("string"!==i.dtype)throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,s=Object(Oi["a"])(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const Ci={kernelName:r["StringToHashBucketFast"],backendName:"cpu",kernelFunc:_i},Ti=Object(c["a"])(r["Tan"],t=>Math.tan(t)),Ii={kernelName:r["Tan"],backendName:"cpu",kernelFunc:Ti},Ni=Object(c["a"])(r["Tanh"],t=>Math.tanh(t)),Ei={kernelName:r["Tanh"],backendName:"cpu",kernelFunc:Ni};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ai=n("ddf3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ri(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:o}=r;Object(a["a"])(i,"tile");const s=Object(Ai["a"])(n.bufferSync(i),o);return n.makeTensorInfo(s.shape,s.dtype,s.values)}const ji={kernelName:r["Tile"],backendName:"cpu",kernelFunc:Ri};var Di=n("d286");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:o,sorted:s}=r;Object(a["a"])(i,"topk");const u=n.data.get(i.dataId).values,[c,l]=Object(Di["a"])(u,i.shape,i.dtype,o,s);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}const Mi={kernelName:r["TopK"],backendName:"cpu",kernelFunc:Fi};
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t){const{inputs:e,attrs:n,backend:a}=t,{image:i,transforms:o}=e,{interpolation:s,fillMode:u,fillValue:c,outputShape:l}=n,[d,h,p,f]=i.shape,[m,g]=null!=l?l:[h,p],b=[d,m,g,f],y=r["util"].computeStrides(i.shape),v=y[0],x=y[1],w=y[2],k=r["util"].computeStrides(b),S=k[0],O=k[1],_=k[2],C=r["util"].getTypedArrayFromDType(i.dtype,r["util"].sizeFromShape(b));C.fill(c);const T=a.data.get(i.dataId).values,I=a.data.get(o.dataId).values;for(let r=0;r<d;++r){const t=1===o.shape[0]?I:I.subarray(8*r,8*r+8);for(let e=0;e<m;++e)for(let n=0;n<g;++n)for(let a=0;a<f;++a){let i;const o=t[6]*n+t[7]*e+1;if(0===o)continue;const l=(t[0]*n+t[1]*e+t[2])/o,d=(t[3]*n+t[4]*e+t[5])/o,f=Li(l,p,u),m=Li(d,h,u);switch(s){case"nearest":i=Gi(T,h,p,v,x,w,r,m,f,a,c);break;case"bilinear":i=Hi(T,h,p,v,x,w,r,m,f,a,c);break;default:throw new Error("Error in Transform: Expect 'nearest' or 'bilinear', but got "+s)}const g=r*S+e*O+n*_+a;C[g]=i}return a.makeTensorInfo(b,i.dtype,C)}const N=a.write(C,b,i.dtype);return{dataId:N,shape:i.shape,dtype:i.dtype}}const $i={kernelName:r["Transform"],backendName:"cpu",kernelFunc:Pi};function Li(t,e,n){switch(n){case"reflect":return Bi(t,e);case"wrap":return zi(t,e);case"nearest":return Vi(t,e);case"constant":default:return Wi(t,e)}}function Bi(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=2*e;n<t&&(n=t*Math.trunc(-n/t)+n),n=n<-e?n+t:-n-1}else if(n>e-1)if(e<=1)n=0;else{const t=2*e;n-=t*Math.trunc(n/t),n>=e&&(n=t-n-1)}return r["util"].clamp(0,n,e-1)}function zi(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const t=e-1;n+=e*(Math.trunc(-n/t)+1)}else if(n>e-1)if(e<=1)n=0;else{const t=e-1;n-=e*Math.trunc(n/t)}return r["util"].clamp(0,n,e-1)}function Wi(t,e){return t}function Vi(t,e){return r["util"].clamp(0,t,e-1)}function Ui(t,e,n,r,a,i,o,s,u,c,l){const d=o*r+s*a+u*i+c;return 0<=s&&s<e&&0<=u&&u<n?t[d]:l}function Gi(t,e,n,r,a,i,o,s,u,c,l){const d=Math.round(s),h=Math.round(u);return Ui(t,e,n,r,a,i,o,d,h,c,l)}function Hi(t,e,n,r,a,i,o,s,u,c,l){const d=Math.floor(s),h=Math.floor(u),p=d+1,f=h+1,m=(f-u)*Ui(t,e,n,r,a,i,o,d,h,c,l)+(u-h)*Ui(t,e,n,r,a,i,o,d,f,c,l),g=(f-u)*Ui(t,e,n,r,a,i,o,p,h,c,l)+(u-h)*Ui(t,e,n,r,a,i,o,p,f,c,l);return(p-s)*m+(s-d)*g}var qi=n("31d5");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ki(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:o}=e;Object(a["a"])(o,"unique");const s=r.data.get(o.dataId).values,{outputValues:u,outputShape:c,indices:l}=Object(qi["a"])(s,i,o.shape,o.dtype);return[r.makeTensorInfo(c,o.dtype,u),r.makeTensorInfo([l.length],"int32",l)]}const Xi={kernelName:r["Unique"],backendName:"cpu",kernelFunc:Ki};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],u=new Array(o-1);let c=0;for(let p=0;p<o;p++)p!==i&&(u[c++]=a.shape[p]);const l=new Array(o).fill(0),d=a.shape.slice();d[i]=1;const h=new Array(s);for(let p=0;p<h.length;p++){l[i]=p;const t=Object(xt["a"])({inputs:{x:a},backend:n,attrs:{begin:l,size:d}});h[p]=C({inputs:{x:t},backend:n,attrs:{shape:u}}),n.disposeIntermediateTensorInfo(t)}return h}const Ji={kernelName:r["Unpack"],backendName:"cpu",kernelFunc:Yi};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zi(t){const{inputs:e,backend:n,attrs:i}=t,{x:o,segmentIds:s}=e,{numSegments:u}=i;Object(a["a"])(o,"unsortedSegmentSum");const c=o.shape.length,l=s.shape.length,d=[],h=[],p=c-l;let f=s;for(let r=0;r<p;++r){const t=We({inputs:{input:f},backend:n,attrs:{dim:r+1}});f=t,h.push(t)}for(let a=0;a<u;++a){const t=r["util"].createScalarValue(a,"int32"),e=n.makeTensorInfo([],"int32",t),i=Object(Re["a"])({inputs:{a:e,b:f},backend:n}),s=Object(It["a"])({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),u=Object(Oe["a"])({inputs:{a:s,b:o},backend:n}),c=Ce({inputs:{x:u},backend:n,attrs:{axis:0,keepDims:!1}});d.push(c),h.push(e),h.push(i),h.push(s),h.push(u),h.push(c)}const m=Ur({inputs:d,backend:n,attrs:{axis:0}});return h.forEach(t=>n.disposeIntermediateTensorInfo(t)),m}const Qi={kernelName:r["UnsortedSegmentSum"],backendName:"cpu",kernelFunc:Zi},to=[A,R["a"],D,M,_["b"],$,z,V,G,q,X,J,Q,rt,it,dt,pt,mt,bt,N,vt,kt,_t,Tt,It["b"],Nt["a"],At,Rt["b"],Dt,Bt,Wt,Ut,Ht,Kt,Yt,Zt,te,ne,ae,oe,ue,le,he,fe,ge,ye,xe,we,ke,Se,Ne,d,Ae,Re["b"],Be,ze["b"],Ve,Ue["a"],en,rn,on,sn["a"],ln,hn,fn,bn,xn,wn["a"],kn["a"],h["b"],On,Pt,Cn,In,En,f,An["a"],Rn["a"],Fn,Mn["a"],$n,zn,Vn,Hn,Kn,Yn,tr,er["a"],rr,ir,sr,cr,dr,pr,mr,gr["a"],yr,wr,Cr,Oe["b"],Tr["a"],Er,jr,Mr,Pr["a"],Lr,Vr,Gr,qr,Yr,y,Jr["a"],ta,ra,oa,$t["b"],qe,ua,x,k,T,la,ha,fa,ga,ya,va,wa,ka["a"],_a,Ea,Ra,Ma,S["b"],$a,Ba,Wa,xt["b"],Or,Ha,Ka,Ja,ti,ri,ii,si,ci,li["a"],di,hi["a"],fi,bi,xi,Si,Ci,Ke["b"],Te,Ii,Ei,ji,Mi,$i,L["b"],Xi,Ji,Qi,zr];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const eo of to)Object(r["registerKernel"])(eo);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},"100e":function(t,e,n){var r=n("cd9d"),a=n("2286"),i=n("c1c9");function o(t,e){return i(a(t,e,r),t+"")}t.exports=o},"10f2":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("45ef"),a=n("2493"),i=468,o=.25;class s{constructor(t,e,n,r,a,i){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=t,this.meshDetector=e,this.meshWidth=n,this.meshHeight=r,this.maxContinuousChecks=a,this.maxFaces=i}async predict(t){if(this.shouldUpdateRegionsOfInterest()){const e=!0,n=!1,{boxes:r,scaleFactor:i}=await this.boundingBoxDetector.getBoundingBoxes(t,e,n);if(0===r.length)return i.dispose(),this.clearAllRegionsOfInterest(),null;const o=r.map(t=>a.enlargeBox(a.scaleBoxCoordinates(t,i)));r.forEach(a.disposeBox),this.updateRegionsOfInterest(o),this.runsWithoutFaceDetector=0}else this.runsWithoutFaceDetector++;return r.tidy(()=>this.regionsOfInterest.map((e,n)=>{const i=a.cutBoxFromImageAndResize(e,t,[this.meshHeight,this.meshWidth]).div(255),[,o,s]=this.meshDetector.predict(i),u=r.reshape(s,[-1,3]),c=r.div(a.getBoxSize(e),[this.meshWidth,this.meshHeight]),l=r.mul(u,c.concat(r.tensor2d([1],[1,1]),1)).add(e.startPoint.concat(r.tensor2d([0],[1,1]),1)),d=this.calculateLandmarksBoundingBox(l),h=this.regionsOfInterest[n];a.disposeBox(h),this.regionsOfInterest[n]=d;const p={coords:u,scaledCoords:l,box:d,flag:o.squeeze()};return p}))}updateRegionsOfInterest(t){for(let e=0;e<t.length;e++){const n=t[e],r=this.regionsOfInterest[e];let i=0;if(r&&r.startPoint){const[t,e,a,o]=n.startEndTensor.arraySync()[0],[s,u,c,l]=r.startEndTensor.arraySync()[0],d=Math.max(t,s),h=Math.max(e,u),p=Math.min(a,c),f=Math.min(o,l),m=(p-d)*(f-h),g=(a-t)*(o-e),b=(c-s)*(l-e);i=m/(g+b-m)}i>o?a.disposeBox(n):(this.regionsOfInterest[e]=n,a.disposeBox(r))}for(let e=t.length;e<this.regionsOfInterest.length;e++)a.disposeBox(this.regionsOfInterest[e]);this.regionsOfInterest=this.regionsOfInterest.slice(0,t.length)}clearRegionOfInterest(t){null!=this.regionsOfInterest[t]&&(a.disposeBox(this.regionsOfInterest[t]),this.regionsOfInterest=[...this.regionsOfInterest.slice(0,t),...this.regionsOfInterest.slice(t+1)])}clearAllRegionsOfInterest(){for(let t=0;t<this.regionsOfInterest.length;t++)a.disposeBox(this.regionsOfInterest[t]);this.regionsOfInterest=[]}shouldUpdateRegionsOfInterest(){const t=this.regionsOfInterest.length,e=0===t;return 1===this.maxFaces||e?e:t!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks}calculateLandmarksBoundingBox(t){const e=t.slice([0,0],[i,1]),n=t.slice([0,1],[i,1]),o=r.stack([e.min(),n.min(),e.max(),n.max()]),s=a.createBox(o.expandDims(0));return a.enlargeBox(s)}}e.Pipeline=s},1194:function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e,n){const r=a(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function a(t,e,n){return o(t,e,n||i)}function i(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){let r=0,a=t.length,i=0,o=!1;while(r<a){i=r+(a-r>>>1);const s=n(e,t[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(t,e,n,r,a){return l(t,e,n,r,a,0)}function u(t,e,n,r,a,i){return l(t,e,n,r,a,0,!1,i,!0)}function c(t,e,n,r,a,i){return l(t,e,n,r,a,i,!0)}function l(t,e,n,a,i,o,s=!1,u=!1,c=!1){const l=[];for(let r=0;r<e.length;r++)e[r]>i&&l.push({score:e[r],boxIndex:r,suppressBeginIndex:0});l.sort(p);const f=o>0?-.5/o:0,m=[],g=[];while(m.length<n&&l.length>0){const e=l.pop(),{score:n,boxIndex:o,suppressBeginIndex:s}=e;if(n<i)break;let u=!1;for(let r=m.length-1;r>=s;--r){const n=d(t,o,m[r]);if(n>=a){u=!0;break}if(e.score=e.score*h(a,f,n),e.score<=i)break}e.suppressBeginIndex=m.length,u||(e.score===n?(m.push(o),g.push(e.score)):e.score>i&&r(l,e,p))}const b=m.length,y=n-b;u&&y>0&&(m.push(...new Array(y).fill(0)),g.push(...new Array(y).fill(0)));const v={selectedIndices:m};return s&&(v["selectedScores"]=g),c&&(v["validOutputs"]=b),v}function d(t,e,n){const r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),p=(s-i)*(u-o),f=(d-c)*(h-l);if(p<=0||f<=0)return 0;const m=Math.max(i,c),g=Math.max(o,l),b=Math.min(s,d),y=Math.min(u,h),v=Math.max(b-m,0)*Math.max(y-g,0);return v/(p+f-v)}function h(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function p(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u})),n.d(e,"c",(function(){return c}))},1212:function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this,n=c();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function s(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var n=new o(t),r=e&&e.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}function c(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)};return e}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.alea=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},"122f":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Threshold=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n=255*this.threshold(),r=t.data,a=r.length;for(e=0;e<a;e+=1)r[e]=r[e]<n?0:255};e.Threshold=o,r.Factory.addGetterSetter(a.Node,"threshold",.5,i.getNumberValidator(),r.Factory.afterSetFilter)},1290:function(t,e){function n(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}t.exports=n},1304:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},13040:function(t,e,n){var r=n("cd9d");function a(t){return"function"==typeof t?t:r}t.exports=a},1310:function(t,e){function n(t){return null!=t&&"object"==typeof t}t.exports=n},1331:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.regex)("integer",/(^[0-9]*$)|(^-[0-9]+$)/);e.default=a},1368:function(t,e,n){var r=n("da03"),a=function(){var t=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function i(t){return!!a&&a in t}t.exports=i},1469:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("219b"),a=n("388c");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,n){const i={shape:t,value:e,dtype:n};return r["a"].runKernel(a["gb"],{},i)}},1491:function(t,e,n){"use strict";n("2d36")},1517:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("210a"),a=n("b605"),i=n("45ef"),o=n("a777"),s=n("10f2"),u=n("476e"),c="https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",l=192,d=192;async function h({maxContinuousChecks:t=5,detectionConfidence:e=.9,maxFaces:n=10,iouThreshold:r=.3,scoreThreshold:a=.75}={}){const[i,o]=await Promise.all([p(n,r,a),f()]),s=new b(i,o,t,e,n);return s}async function p(t,e,n){return r.load({maxFaces:t,iouThreshold:e,scoreThreshold:n})}async function f(){return a.loadGraphModel(c,{fromTFHub:!0})}function m(t){return t instanceof i.Tensor?[t.shape[0],t.shape[1]]:[t.height,t.width]}function g(t,e){if(t.mesh instanceof i.Tensor){const[n,r,a,o]=i.tidy(()=>{const n=i.tensor1d([e-1,0,0]),r=i.tensor1d([1,-1,1]);return i.tidy(()=>[i.concat([i.sub(e-1,t.boundingBox.topLeft.slice(0,1)),t.boundingBox.topLeft.slice(1,1)]),i.concat([i.sub(e-1,t.boundingBox.bottomRight.slice(0,1)),t.boundingBox.bottomRight.slice(1,1)]),i.sub(n,t.mesh).mul(r),i.sub(n,t.scaledMesh).mul(r)])});return Object.assign({},t,{boundingBox:{topLeft:n,bottomRight:r},mesh:a,scaledMesh:o})}return Object.assign({},t,{boundingBox:{topLeft:[e-1-t.boundingBox.topLeft[0],t.boundingBox.topLeft[1]],bottomRight:[e-1-t.boundingBox.bottomRight[0],t.boundingBox.bottomRight[1]]},mesh:t.mesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n}),scaledMesh:t.scaledMesh.map(t=>{const n=t.slice(0);return n[0]=e-1-t[0],n})})}e.load=h;class b{constructor(t,e,n,r,a){this.pipeline=new s.Pipeline(t,e,l,d,n,a),this.detectionConfidence=r}static getAnnotations(){return o.MESH_ANNOTATIONS}static getUVCoords(){return u.UV_COORDS}async estimateFaces(t,e=!1,n=!1){const[,r]=m(t),a=i.tidy(()=>(t instanceof i.Tensor||(t=i.browser.fromPixels(t)),t.toFloat().expandDims(0))),s=i.env().get("WEBGL_PACK_DEPTHWISECONV");i.env().set("WEBGL_PACK_DEPTHWISECONV",!0);const u=await this.pipeline.predict(a);return i.env().set("WEBGL_PACK_DEPTHWISECONV",s),a.dispose(),null!=u&&u.length>0?Promise.all(u.map(async(t,a)=>{const{coords:i,scaledCoords:s,box:u,flag:c}=t;let l=[c];e||(l=l.concat([i,s,u.startPoint,u.endPoint]));const d=await Promise.all(l.map(async t=>t.array())),h=d[0];if(c.dispose(),h<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(a),e){const t={faceInViewConfidence:h,mesh:i,scaledMesh:s,boundingBox:{topLeft:u.startPoint.squeeze(),bottomRight:u.endPoint.squeeze()}};return n?g(t,r):t}const[p,f,m,b]=d.slice(1);s.dispose(),i.dispose();let y={faceInViewConfidence:h,boundingBox:{topLeft:m,bottomRight:b},mesh:p,scaledMesh:f};n&&(y=g(y,r));const v={};for(const e in o.MESH_ANNOTATIONS)v[e]=o.MESH_ANNOTATIONS[e].map(t=>y.scaledMesh[t]);return y["annotations"]=v,y})):[]}}e.FaceMesh=b},"15e3":function(t,e,n){"use strict";n.r(e);var r=n("b547");n.d(e,"simpleAbsImpl",(function(){return r["b"]}));var a=n("7731");n.d(e,"addImpl",(function(){return a["c"]}));var i=n("6877");n.d(e,"bincountImpl",(function(){return i["a"]})),n.d(e,"bincountReduceImpl",(function(){return i["b"]}));var o=n("d28e");n.d(e,"castImpl",(function(){return o["c"]}));var s=n("180e");n.d(e,"ceilImpl",(function(){return s["b"]}));var u=n("d598");n.d(e,"concatImpl",(function(){return u["a"]}));var c=n("acaf");n.d(e,"equalImpl",(function(){return c["c"]}));var l=n("ae84");n.d(e,"expImpl",(function(){return l["c"]}));var d=n("959e");n.d(e,"expm1Impl",(function(){return d["b"]}));var h=n("0a08");n.d(e,"floorImpl",(function(){return h["b"]}));var p=n("c701");n.d(e,"gatherNdImpl",(function(){return p["a"]}));var f=n("61256");n.d(e,"gatherV2Impl",(function(){return f["a"]}));var m=n("8b87");n.d(e,"greaterImpl",(function(){return m["b"]}));var g=n("7df4");n.d(e,"greaterEqualImpl",(function(){return g["b"]}));var b=n("d9f3");n.d(e,"lessImpl",(function(){return b["b"]}));var y=n("e3df");n.d(e,"lessEqualImpl",(function(){return y["b"]}));var v=n("d521");n.d(e,"linSpaceImpl",(function(){return v["a"]}));var x=n("9c14");n.d(e,"logImpl",(function(){return x["b"]}));var w=n("6d0f");n.d(e,"maxImpl",(function(){return w["a"]}));var k=n("57a7");n.d(e,"maximumImpl",(function(){return k["b"]}));var S=n("382f");n.d(e,"minimumImpl",(function(){return S["b"]}));var O=n("734e");n.d(e,"multiplyImpl",(function(){return O["c"]}));var _=n("17af");n.d(e,"negImpl",(function(){return _["b"]}));var C=n("18c7");n.d(e,"notEqualImpl",(function(){return C["b"]}));var T=n("6732");n.d(e,"prodImpl",(function(){return T["b"]}));var I=n("8b16");n.d(e,"raggedGatherImpl",(function(){return I["a"]}));var N=n("cbb7");n.d(e,"raggedTensorToTensorImpl",(function(){return N["a"]}));var E=n("d032");n.d(e,"rangeImpl",(function(){return E["a"]}));var A=n("d425");n.d(e,"rsqrtImpl",(function(){return A["b"]}));var R=n("da1c");n.d(e,"scatterImpl",(function(){return R["a"]}));var j=n("af58");n.d(e,"sigmoidImpl",(function(){return j["c"]}));var D=n("425a");n.d(e,"sliceImpl",(function(){return D["c"]}));var F=n("b8d8");n.d(e,"sparseFillEmptyRowsImpl",(function(){return F["a"]}));var M=n("b6c5");n.d(e,"sparseReshapeImpl",(function(){return M["a"]}));var P=n("e8a2");n.d(e,"sparseSegmentReductionImpl",(function(){return P["a"]}));var $=n("75d3e");n.d(e,"sqrtImpl",(function(){return $["b"]}));var L=n("5c5c");n.d(e,"squaredDifferenceImpl",(function(){return L["b"]}));var B=n("e22c");n.d(e,"stridedSliceImpl",(function(){return B["a"]}));var z=n("1ef8");n.d(e,"stringNGramsImpl",(function(){return z["a"]}));var W=n("e51a");n.d(e,"stringSplitImpl",(function(){return W["a"]}));var V=n("614d");n.d(e,"stringToHashBucketFastImpl",(function(){return V["a"]}));var U=n("432a");n.d(e,"subImpl",(function(){return U["c"]}));var G=n("ddf3");n.d(e,"tileImpl",(function(){return G["a"]}));var H=n("d286");n.d(e,"topKImpl",(function(){return H["a"]}));var q=n("e9cd");n.d(e,"transposeImpl",(function(){return q["a"]}));var K=n("31d5");n.d(e,"uniqueImpl",(function(){return K["a"]}))},"16d4":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e){const n=Object(i["a"])(t,"x","reverse"),o={x:n},s={dims:e};return r["a"].runKernel(a["Ac"],o,s)}const u=Object(o["b"])({reverse_:s})},"17a9":function(t,e,n){},"17af":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("60ee"),i=n("734e");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n){const a=r["util"].createScalarValue(-1,n);return Object(i["c"])([],e,a,t,n)}function s(t){const{inputs:e,backend:n}=t,{x:r}=e;Object(a["a"])(r,"neg");const i=n.data.get(r.dataId).values,[s,u]=o(i,r.shape,r.dtype);return n.makeTensorInfo(u,r.dtype,s)}const u={kernelName:r["Neg"],backendName:"cpu",kernelFunc:s}},"180e":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.ceil(t)),s=Object(i["b"])(r["Ceil"],o),u={kernelName:r["Ceil"],backendName:"cpu",kernelFunc:s}},1838:function(t,e,n){var r=n("c05f"),a=n("9b02"),i=n("8604"),o=n("f608"),s=n("08cc"),u=n("20ec"),c=n("f4d6"),l=1,d=2;function h(t,e){return o(t)&&s(e)?u(c(t),e):function(n){var o=a(n,t);return void 0===o&&o===e?i(n,t):r(e,o,l|d)}}t.exports=h},"18c7":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t!==e?1:0),s=Object(i["a"])(r["NotEqual"],o,null,"bool"),u={kernelName:r["NotEqual"],backendName:"cpu",kernelFunc:s}},"18d8":function(t,e,n){var r=n("234d"),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,o=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(a,(function(t,n,r,a){e.push(r?a.replace(i,"$1"):n||t)})),e}));t.exports=o},"19d5":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("4e1f"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e=0){Object(o["b"])(t.length>=1,()=>"Pass at least one tensor to concat");const n=Object(i["b"])(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)}),1===n.length)return Object(s["a"])(n[0]);const u=n,c={axis:e};return r["a"].runKernel(a["C"],u,c)}const l=Object(u["b"])({concat_:c})},"1a28":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},"1a8c":function(t,e){function n(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}t.exports=n},"1b4e":function(t,e){},"1ba2":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("df00"),a=n("e136");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e){if((Object(r["A"])(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Object(r["A"])(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");const n=[],i=[];return Object(a["a"])(t,n,i,e)}},"1bd8":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Arrow=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("f709"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(e){t.prototype._sceneFunc.call(this,e);var n=2*Math.PI,r=this.points(),a=r,i=0!==this.tension()&&r.length>4;i&&(a=this.getTensionPoints());var o,s,u=r.length;i?(o=r[u-2]-(a[a.length-2]+a[a.length-4])/2,s=r[u-1]-(a[a.length-1]+a[a.length-3])/2):(o=r[u-2]-r[u-4],s=r[u-1]-r[u-3]);var c=(Math.atan2(s,o)+n)%n,l=this.pointerLength(),d=this.pointerWidth();e.save(),e.beginPath(),e.translate(r[u-2],r[u-1]),e.rotate(c),e.moveTo(0,0),e.lineTo(-l,d/2),e.lineTo(-l,-d/2),e.closePath(),e.restore(),this.pointerAtBeginning()&&(e.save(),e.translate(r[0],r[1]),i?(o=(a[0]+a[2])/2-r[0],s=(a[1]+a[3])/2-r[1]):(o=r[2]-r[0],s=r[3]-r[1]),e.rotate((Math.atan2(-s,-o)+n)%n),e.moveTo(0,0),e.lineTo(-l,d/2),e.lineTo(-l,-d/2),e.closePath(),e.restore());var h=this.dashEnabled();h&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),h&&(this.attrs.dashEnabled=!0)},e.prototype.getSelfRect=function(){var e=t.prototype.getSelfRect.call(this),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+2*n,height:e.height+2*n}},e}(o.Line);e.Arrow=c,c.prototype.className="Arrow",u._registerNode(c),i.Factory.addGetterSetter(c,"pointerLength",10,s.getNumberValidator()),i.Factory.addGetterSetter(c,"pointerWidth",10,s.getNumberValidator()),i.Factory.addGetterSetter(c,"pointerAtBeginning",!1),a.Collection.mapMethods(c)},"1be3":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("f947"),o=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n,i,s,u=[1,1],c){let l=t;3===t.rank&&(l=Object(o["a"])(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let d=e;3===d.rank&&(d=Object(o["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={x:l,dy:d},p={strides:i,pad:s,dimRoundingMode:c,dilations:u,filterShape:n};return r["a"].runKernel(a["R"],h,p)}const u=Object(i["b"])({depthwiseConv2dNativeBackpropFilter_:s})},"1bec":function(t,e,n){},"1c3c":function(t,e,n){var r=n("9e69"),a=n("2474"),i=n("9638"),o=n("a2be"),s=n("edfa"),u=n("ac41"),c=1,l=2,d="[object Boolean]",h="[object Date]",p="[object Error]",f="[object Map]",m="[object Number]",g="[object RegExp]",b="[object Set]",y="[object String]",v="[object Symbol]",x="[object ArrayBuffer]",w="[object DataView]",k=r?r.prototype:void 0,S=k?k.valueOf:void 0;function O(t,e,n,r,k,O,_){switch(n){case w:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!O(new a(t),new a(e)));case d:case h:case m:return i(+t,+e);case p:return t.name==e.name&&t.message==e.message;case g:case y:return t==e+"";case f:var C=s;case b:var T=r&c;if(C||(C=u),t.size!=e.size&&!T)return!1;var I=_.get(t);if(I)return I==e;r|=l,_.set(t,e);var N=o(C(t),C(e),r,k,O,_);return _["delete"](t),N;case v:if(S)return S.call(t)==S.call(e)}return!1}t.exports=O},"1c49":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Kaleidoscope=void 0;var r=n("f0b4"),a=n("4971"),i=n("9cb8"),o=n("4546"),s=function(t,e,n){var r,a,i,o,s=t.data,u=e.data,c=t.width,l=t.height,d=n.polarCenterX||c/2,h=n.polarCenterY||l/2,p=0,f=0,m=0,g=0,b=Math.sqrt(d*d+h*h);a=c-d,i=l-h,o=Math.sqrt(a*a+i*i),b=o>b?o:b;var y,v,x,w,k=l,S=c,O=360/S*Math.PI/180;for(v=0;v<S;v+=1)for(x=Math.sin(v*O),w=Math.cos(v*O),y=0;y<k;y+=1)a=Math.floor(d+b*y/k*w),i=Math.floor(h+b*y/k*x),r=4*(i*c+a),p=s[r+0],f=s[r+1],m=s[r+2],g=s[r+3],r=4*(v+y*c),u[r+0]=p,u[r+1]=f,u[r+2]=m,u[r+3]=g},u=function(t,e,n){var r,a,i,o,s,u,c=t.data,l=e.data,d=t.width,h=t.height,p=n.polarCenterX||d/2,f=n.polarCenterY||h/2,m=0,g=0,b=0,y=0,v=Math.sqrt(p*p+f*f);a=d-p,i=h-f,u=Math.sqrt(a*a+i*i),v=u>v?u:v;var x,w,k,S,O=h,_=d,C=n.polarRotation||0;for(a=0;a<d;a+=1)for(i=0;i<h;i+=1)o=a-p,s=i-f,x=Math.sqrt(o*o+s*s)*O/v,w=(180*Math.atan2(s,o)/Math.PI+360+C)%360,w=w*_/360,k=Math.floor(w),S=Math.floor(x),r=4*(S*d+k),m=c[r+0],g=c[r+1],b=c[r+2],y=c[r+3],r=4*(i*d+a),l[r+0]=m,l[r+1]=g,l[r+2]=b,l[r+3]=y},c=function(t){var e,n,r,a,o,c,l,d,h,p,f=t.width,m=t.height,g=Math.round(this.kaleidoscopePower()),b=Math.round(this.kaleidoscopeAngle()),y=Math.floor(f*(b%360)/360);if(!(g<1)){var v=i.Util.createCanvasElement();v.width=f,v.height=m;var x=v.getContext("2d").getImageData(0,0,f,m);s(t,x,{polarCenterX:f/2,polarCenterY:m/2});var w=f/Math.pow(2,g);while(w<=8)w*=2,g-=1;w=Math.ceil(w);var k=w,S=0,O=k,_=1;for(y+w>f&&(S=k,O=0,_=-1),n=0;n<m;n+=1)for(e=S;e!==O;e+=_)r=Math.round(e+y)%f,h=4*(f*n+r),o=x.data[h+0],c=x.data[h+1],l=x.data[h+2],d=x.data[h+3],p=4*(f*n+e),x.data[p+0]=o,x.data[p+1]=c,x.data[p+2]=l,x.data[p+3]=d;for(n=0;n<m;n+=1)for(k=Math.floor(w),a=0;a<g;a+=1){for(e=0;e<k+1;e+=1)h=4*(f*n+e),o=x.data[h+0],c=x.data[h+1],l=x.data[h+2],d=x.data[h+3],p=4*(f*n+2*k-e-1),x.data[p+0]=o,x.data[p+1]=c,x.data[p+2]=l,x.data[p+3]=d;k*=2}u(x,t,{polarRotation:0})}};e.Kaleidoscope=c,r.Factory.addGetterSetter(a.Node,"kaleidoscopePower",2,o.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"kaleidoscopeAngle",0,o.getNumberValidator(),r.Factory.afterSetFilter)},"1c95":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e=0,n=!1,o=!1){const s=Object(i["a"])(t,"x","cumsum"),u={x:s},c={axis:e,exclusive:n,reverse:o};return r["a"].runKernel(a["N"],u,c)}const u=Object(o["b"])({cumsum_:s})},"1cc6":function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return a}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=1.7580993408473768,a=1.0507009873554805},"1cec":function(t,e,n){var r=n("0b07"),a=n("2b3e"),i=r(a,"Promise");t.exports=i},"1dce":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vuelidate=D,e.validationMixin=e.default=void 0,Object.defineProperty(e,"withParams",{enumerable:!0,get:function(){return a.withParams}});var r=n("fbf4"),a=n("0234");function i(t){return c(t)||u(t)||s(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if(t){if("string"===typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function u(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function c(t){if(Array.isArray(t))return l(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){return f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}var m=function(){return null},g=function(t,e,n){return t.reduce((function(t,r){return t[n?n(r):r]=e(r),t}),{})};function b(t){return"function"===typeof t}function y(t){return null!==t&&("object"===f(t)||b(t))}function v(t){return y(t)&&b(t.then)}var x=function(t,e,n,r){if("function"===typeof n)return n.call(t,e,r);n=Array.isArray(n)?n:n.split(".");for(var a=0;a<n.length;a++){if(!e||"object"!==f(e))return r;e=e[n[a]]}return"undefined"===typeof e?r:e},w="__isVuelidateAsyncVm";function k(t,e){var n=new t({data:{p:!0,v:!1}});return e.then((function(t){n.p=!1,n.v=t}),(function(t){throw n.p=!1,n.v=!1,t})),n[w]=!0,n}var S={$invalid:function(){var t=this,e=this.proxy;return this.nestedKeys.some((function(e){return t.refProxy(e).$invalid}))||this.ruleKeys.some((function(t){return!e[t]}))},$dirty:function(){var t=this;return!!this.dirty||0!==this.nestedKeys.length&&this.nestedKeys.every((function(e){return t.refProxy(e).$dirty}))},$anyDirty:function(){var t=this;return!!this.dirty||0!==this.nestedKeys.length&&this.nestedKeys.some((function(e){return t.refProxy(e).$anyDirty}))},$error:function(){return this.$dirty&&!this.$pending&&this.$invalid},$anyError:function(){var t=this;return!!this.$error||this.nestedKeys.some((function(e){return t.refProxy(e).$anyError}))},$pending:function(){var t=this;return this.ruleKeys.some((function(e){return t.getRef(e).$pending}))||this.nestedKeys.some((function(e){return t.refProxy(e).$pending}))},$params:function(){var t=this,e=this.validations;return h(h({},g(this.nestedKeys,(function(t){return e[t]&&e[t].$params||null}))),g(this.ruleKeys,(function(e){return t.getRef(e).$params})))}};function O(t){this.dirty=t;var e=this.proxy,n=t?"$touch":"$reset";this.nestedKeys.forEach((function(t){e[t][n]()}))}var _={$touch:function(){O.call(this,!0)},$reset:function(){O.call(this,!1)},$flattenParams:function(){var t=this.proxy,e=[];for(var n in this.$params)if(this.isNested(n)){for(var r=t[n].$flattenParams(),a=0;a<r.length;a++)r[a].path.unshift(n);e=e.concat(r)}else e.push({path:[],name:n,params:this.$params[n]});return e}},C=Object.keys(S),T=Object.keys(_),I=null,N=function(t){if(I)return I;var e=t.extend({computed:{refs:function(){var t=this._vval;this._vval=this.children,(0,r.patchChildren)(t,this._vval);var e={};return this._vval.forEach((function(t){e[t.key]=t.vm})),e}},beforeCreate:function(){this._vval=null},beforeDestroy:function(){this._vval&&((0,r.patchChildren)(this._vval),this._vval=null)},methods:{getModel:function(){return this.lazyModel?this.lazyModel(this.prop):this.model},getModelKey:function(t){var e=this.getModel();if(e)return e[t]},hasIter:function(){return!1}}}),n=e.extend({data:function(){return{rule:null,lazyModel:null,model:null,lazyParentModel:null,rootModel:null}},methods:{runRule:function(e){var n=this.getModel();(0,a.pushParams)();var r=this.rule.call(this.rootModel,n,e),i=v(r)?k(t,r):r,o=(0,a.popParams)(),s=o&&o.$sub?o.$sub.length>1?o:o.$sub[0]:null;return{output:i,params:s}}},computed:{run:function(){var t=this,e=this.lazyParentModel(),n=Array.isArray(e)&&e.__ob__;if(n){var r=e.__ob__.dep;r.depend();var a=r.constructor.target;if(!this._indirectWatcher){var i=a.constructor;this._indirectWatcher=new i(this,(function(){return t.runRule(e)}),null,{lazy:!0})}var o=this.getModel();if(!this._indirectWatcher.dirty&&this._lastModel===o)return this._indirectWatcher.depend(),a.value;this._lastModel=o,this._indirectWatcher.evaluate(),this._indirectWatcher.depend()}else this._indirectWatcher&&(this._indirectWatcher.teardown(),this._indirectWatcher=null);return this._indirectWatcher?this._indirectWatcher.value:this.runRule(e)},$params:function(){return this.run.params},proxy:function(){var t=this.run.output;return t[w]?!!t.v:!!t},$pending:function(){var t=this.run.output;return!!t[w]&&t.p}},destroyed:function(){this._indirectWatcher&&(this._indirectWatcher.teardown(),this._indirectWatcher=null)}}),o=e.extend({data:function(){return{dirty:!1,validations:null,lazyModel:null,model:null,prop:null,lazyParentModel:null,rootModel:null}},methods:h(h({},_),{},{refProxy:function(t){return this.getRef(t).proxy},getRef:function(t){return this.refs[t]},isNested:function(t){return"function"!==typeof this.validations[t]}}),computed:h(h({},S),{},{nestedKeys:function(){return this.keys.filter(this.isNested)},ruleKeys:function(){var t=this;return this.keys.filter((function(e){return!t.isNested(e)}))},keys:function(){return Object.keys(this.validations).filter((function(t){return"$params"!==t}))},proxy:function(){var t=this,e=g(this.keys,(function(e){return{enumerable:!0,configurable:!0,get:function(){return t.refProxy(e)}}})),n=g(C,(function(e){return{enumerable:!0,configurable:!0,get:function(){return t[e]}}})),r=g(T,(function(e){return{enumerable:!1,configurable:!0,get:function(){return t[e]}}})),a=this.hasIter()?{$iter:{enumerable:!0,value:Object.defineProperties({},h({},e))}}:{};return Object.defineProperties({},h(h(h(h({},e),a),{},{$model:{enumerable:!0,get:function(){var e=t.lazyParentModel();return null!=e?e[t.prop]:null},set:function(e){var n=t.lazyParentModel();null!=n&&(n[t.prop]=e,t.$touch())}}},n),r))},children:function(){var t=this;return[].concat(i(this.nestedKeys.map((function(e){return c(t,e)}))),i(this.ruleKeys.map((function(e){return l(t,e)})))).filter(Boolean)}})}),s=o.extend({methods:{isNested:function(t){return"undefined"!==typeof this.validations[t]()},getRef:function(t){var e=this;return{get proxy(){return e.validations[t]()||!1}}}}}),u=o.extend({computed:{keys:function(){var t=this.getModel();return y(t)?Object.keys(t):[]},tracker:function(){var t=this,e=this.validations.$trackBy;return e?function(n){return"".concat(x(t.rootModel,t.getModelKey(n),e))}:function(t){return"".concat(t)}},getModelLazy:function(){var t=this;return function(){return t.getModel()}},children:function(){var t=this,e=this.validations,n=this.getModel(),a=h({},e);delete a["$trackBy"];var i={};return this.keys.map((function(e){var s=t.tracker(e);return i.hasOwnProperty(s)?null:(i[s]=!0,(0,r.h)(o,s,{validations:a,prop:e,lazyParentModel:t.getModelLazy,model:n[e],rootModel:t.rootModel}))})).filter(Boolean)}},methods:{isNested:function(){return!0},getRef:function(t){return this.refs[this.tracker(t)]},hasIter:function(){return!0}}}),c=function(t,e){if("$each"===e)return(0,r.h)(u,e,{validations:t.validations[e],lazyParentModel:t.lazyParentModel,prop:e,lazyModel:t.getModel,rootModel:t.rootModel});var n=t.validations[e];if(Array.isArray(n)){var a=t.rootModel,i=g(n,(function(t){return function(){return x(a,a.$v,t)}}),(function(t){return Array.isArray(t)?t.join("."):t}));return(0,r.h)(s,e,{validations:i,lazyParentModel:m,prop:e,lazyModel:m,rootModel:a})}return(0,r.h)(o,e,{validations:n,lazyParentModel:t.getModel,prop:e,lazyModel:t.getModelKey,rootModel:t.rootModel})},l=function(t,e){return(0,r.h)(n,e,{rule:t.validations[e],lazyParentModel:t.lazyParentModel,lazyModel:t.getModel,rootModel:t.rootModel})};return I={VBase:e,Validation:o},I},E=null;function A(t){if(E)return E;var e=t.constructor;while(e.super)e=e.super;return E=e,e}var R=function(t,e){var n=A(t),a=N(n),i=a.Validation,o=a.VBase,s=new o({computed:{children:function(){var n="function"===typeof e?e.call(t):e;return[(0,r.h)(i,"$v",{validations:n,lazyParentModel:m,prop:"$v",model:t,rootModel:t})]}}});return s},j={data:function(){var t=this.$options.validations;return t&&(this._vuelidate=R(this,t)),{}},beforeCreate:function(){var t=this.$options,e=t.validations;e&&(t.computed||(t.computed={}),t.computed.$v||(t.computed.$v=function(){return this._vuelidate?this._vuelidate.refs.$v.proxy:null}))},beforeDestroy:function(){this._vuelidate&&(this._vuelidate.$destroy(),this._vuelidate=null)}};function D(t){t.mixin(j)}e.validationMixin=j;var F=D;e.default=F},"1ef8":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class a{constructor(t,e,n,a,i,o){this.separator=r["util"].encodeString(t),this.nGramWidths=e,this.leftPad=r["util"].encodeString(n),this.rightPad=r["util"].encodeString(a),this.padWidth=i,this.preserveShort=o}getPadWidth(t){return Math.min(this.padWidth<0?t-1:this.padWidth,t-1)}getNumNGrams(t,e){const n=this.getPadWidth(e);return Math.max(0,t+2*n-e+1)}createNGrams(t,e,n,r,a,i){for(let o=0;o<a;++o){const s=this.getPadWidth(i),u=Math.max(0,s-o),c=Math.max(0,s-(a-(o+1))),l=i-(u+c),d=e+(u>0?0:o-s);let h=0;h+=u*this.leftPad.length;for(let e=0;e<l;++e)h+=t[d+e].length;h+=c*this.rightPad.length;const p=u+c+l-1;h+=p*this.separator.length,n[r+o]=new Uint8Array(h);const f=n[r+o];let m=0;const g=t=>t.forEach(t=>f[m++]=t);for(let t=0;t<u;++t)g(this.leftPad),g(this.separator);for(let e=0;e<l-1;++e)g(t[d+e]),g(this.separator);if(l>0){g(t[d+l-1]);for(let t=0;t<c;++t)g(this.separator),g(this.rightPad)}else{for(let t=0;t<c-1;++t)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(t,e){const n=t.length,a=e.length;if(a>0){let t=e[0];if(0!==t)throw new Error("First split value must be 0, got "+t);for(let r=1;r<a;++r){let a=e[r]>=t;if(a=a&&e[r]<=n,!a)throw new Error(`Invalid split value ${e[r]}, must be in [${t}, ${n}]`);t=e[r]}if(t!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${t}`)}const i=a-1,o=r["util"].getArrayFromDType("int32",a);if(0===n||0===a){const t=new Array(n);for(let e=0;e<=i;++e)o[e]=0;return[t,o]}o[0]=0;for(let r=1;r<=i;++r){const t=e[r]-e[r-1];let n=0;this.nGramWidths.forEach(e=>{n+=this.getNumNGrams(t,e)}),this.preserveShort&&t>0&&0===n&&(n=1),o[r]=o[r-1]+n}const s=new Array(o[i]);for(let r=0;r<i;++r){const n=e[r];let a=o[r];if(this.nGramWidths.forEach(i=>{const o=e[r+1]-e[r],u=this.getNumNGrams(o,i);this.createNGrams(t,n,s,a,u,i),a+=u}),this.preserveShort&&a===o[r]){const i=e[r+1]-e[r];if(0===i)continue;const o=i+2*this.padWidth,u=1;this.createNGrams(t,n,s,a,u,o)}}return[s,o]}}function i(t,e,n,r,i,o,s,u){return new a(n,r,i,o,s,u).compute(t,e)}},"1efc":function(t,e){function n(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}t.exports=n},"1f21":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Circle=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,2*Math.PI,!1),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius()!==t/2&&this.radius(t/2)},e.prototype.setHeight=function(t){this.radius()!==t/2&&this.radius(t/2)},e}(o.Shape);e.Circle=c,c.prototype._centroid=!0,c.prototype.className="Circle",c.prototype._attrsAffectingSize=["radius"],u._registerNode(c),i.Factory.addGetterSetter(c,"radius",0,s.getNumberValidator()),a.Collection.mapMethods(c)},"1fb5":function(t,e,n){"use strict";e.byteLength=l,e.toByteArray=h,e.fromByteArray=m;for(var r=[],a=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],a[o.charCodeAt(s)]=s;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");-1===n&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function l(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r}function d(t,e,n){return 3*(e+n)/4-n}function h(t){var e,n,r=c(t),o=r[0],s=r[1],u=new i(d(t,o,s)),l=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)e=a[t.charCodeAt(n)]<<18|a[t.charCodeAt(n+1)]<<12|a[t.charCodeAt(n+2)]<<6|a[t.charCodeAt(n+3)],u[l++]=e>>16&255,u[l++]=e>>8&255,u[l++]=255&e;return 2===s&&(e=a[t.charCodeAt(n)]<<2|a[t.charCodeAt(n+1)]>>4,u[l++]=255&e),1===s&&(e=a[t.charCodeAt(n)]<<10|a[t.charCodeAt(n+1)]<<4|a[t.charCodeAt(n+2)]>>2,u[l++]=e>>8&255,u[l++]=255&e),u}function p(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function f(t,e,n){for(var r,a=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),a.push(p(r));return a.join("")}function m(t){for(var e,n=t.length,a=n%3,i=[],o=16383,s=0,u=n-a;s<u;s+=o)i.push(f(t,s,s+o>u?u:s+o));return 1===a?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===a&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},"1fc8":function(t,e,n){var r=n("4245");function a(t,e){var n=r(this,t),a=n.size;return n.set(t,e),this.size+=n.size==a?0:1,this}t.exports=a},2013:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Posterize=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n=Math.round(254*this.levels())+1,r=t.data,a=r.length,i=255/n;for(e=0;e<a;e+=1)r[e]=Math.floor(r[e]/i)*i};e.Posterize=o,r.Factory.addGetterSetter(a.Node,"levels",.5,i.getNumberValidator(),r.Factory.afterSetFilter)},"20aa":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},"20ec":function(t,e){function n(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}t.exports=n},"210a":function(t,e,n){"use strict";n.r(e),n.d(e,"load",(function(){return b})),n.d(e,"BlazeFaceModel",(function(){return m}));var r=n("45ef"),a=n("b605");
/**
    * @license
    * Copyright 2020 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */
const i=t=>{t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose()},o=t=>({startEndTensor:t,startPoint:Object(r["slice"])(t,[0,0],[-1,2]),endPoint:Object(r["slice"])(t,[0,2],[-1,2])}),s=(t,e)=>{const n=Object(r["mul"])(t.startPoint,e),a=Object(r["mul"])(t.endPoint,e),i=Object(r["concat2d"])([n,a],1);return o(i)},u={strides:[8,16],anchors:[2,6]},c=6;function l(t,e,n){const r=[];for(let a=0;a<n.strides.length;a++){const i=n.strides[a],o=Math.floor((e+i-1)/i),s=Math.floor((t+i-1)/i),u=n.anchors[a];for(let t=0;t<o;t++){const e=i*(t+.5);for(let t=0;t<s;t++){const n=i*(t+.5);for(let t=0;t<u;t++)r.push([n,e])}}}return r}function d(t,e,n){const a=Object(r["slice"])(t,[0,1],[-1,2]),i=Object(r["add"])(a,e),o=Object(r["slice"])(t,[0,3],[-1,2]),s=Object(r["div"])(o,n),u=Object(r["div"])(i,n),c=Object(r["div"])(s,2),l=Object(r["sub"])(u,c),d=Object(r["add"])(u,c),h=Object(r["mul"])(l,n),p=Object(r["mul"])(d,n);return Object(r["concat2d"])([h,p],1)}function h(t){return t instanceof r["Tensor"]?[t.shape[0],t.shape[1]]:[t.height,t.width]}function p(t,e){let n,a,i;if(t.topLeft instanceof r["Tensor"]&&t.bottomRight instanceof r["Tensor"]){const[o,s]=Object(r["tidy"])(()=>[Object(r["concat"])([Object(r["sub"])(e-1,t.topLeft.slice(0,1)),t.topLeft.slice(1,1)]),Object(r["concat"])([Object(r["sub"])(e-1,t.bottomRight.slice(0,1)),t.bottomRight.slice(1,1)])]);n=o,a=s,null!=t.landmarks&&(i=Object(r["tidy"])(()=>{const n=Object(r["sub"])(Object(r["tensor1d"])([e-1,0]),t.landmarks),a=Object(r["tensor1d"])([1,-1]);return Object(r["mul"])(n,a)}))}else{const[r,o]=t.topLeft,[s,u]=t.bottomRight;n=[e-1-r,o],a=[e-1-s,u],null!=t.landmarks&&(i=t.landmarks.map(t=>[e-1-t[0],t[1]]))}const o={topLeft:n,bottomRight:a};return null!=i&&(o.landmarks=i),null!=t.probability&&(o.probability=t.probability instanceof r["Tensor"]?t.probability.clone():t.probability),o}function f(t,e){return Object(r["tidy"])(()=>{let n;return n=t.hasOwnProperty("box")?t.box:t,s(n,e).startEndTensor.squeeze()})}class m{constructor(t,e,n,a,i,o){this.blazeFaceModel=t,this.width=e,this.height=n,this.maxFaces=a,this.anchorsData=l(e,n,u),this.anchors=Object(r["tensor2d"])(this.anchorsData),this.inputSizeData=[e,n],this.inputSize=Object(r["tensor1d"])([e,n]),this.iouThreshold=i,this.scoreThreshold=o}async getBoundingBoxes(t,e,n=!0){const[a,i,s]=Object(r["tidy"])(()=>{const e=t.resizeBilinear([this.width,this.height]),n=Object(r["mul"])(Object(r["sub"])(e.div(255),.5),2),a=this.blazeFaceModel.predict(n).squeeze(),i=d(a,this.anchors,this.inputSize),o=Object(r["slice"])(a,[0,0],[-1,1]);return[a,i,Object(r["sigmoid"])(o).squeeze()]}),u=console.warn;console.warn=()=>{};const l=r["image"].nonMaxSuppression(i,s,this.maxFaces,this.iouThreshold,this.scoreThreshold);console.warn=u;const h=await l.array();l.dispose();let p=h.map(t=>Object(r["slice"])(i,[t,0],[1,-1]));e||(p=await Promise.all(p.map(async t=>{const e=await t.array();return t.dispose(),e})));const f=t.shape[1],m=t.shape[2];let g;g=e?Object(r["div"])([m,f],this.inputSize):[m/this.inputSizeData[0],f/this.inputSizeData[1]];const b=[];for(let d=0;d<p.length;d++){const t=p[d],i=Object(r["tidy"])(()=>{const i=o(t instanceof r["Tensor"]?t:Object(r["tensor2d"])(t));if(!n)return i;const u=h[d];let l;return l=e?this.anchors.slice([u,0],[1,2]):this.anchorsData[u],{box:i,landmarks:Object(r["slice"])(a,[u,c-1],[1,-1]).squeeze().reshape([c,-1]),probability:Object(r["slice"])(s,[u],[1]),anchor:l}});b.push(i)}return i.dispose(),s.dispose(),a.dispose(),{boxes:b,scaleFactor:g}}async estimateFaces(t,e=!1,n=!1,a=!0){const[,o]=h(t),s=Object(r["tidy"])(()=>(t instanceof r["Tensor"]||(t=r["browser"].fromPixels(t)),t.toFloat().expandDims(0))),{boxes:u,scaleFactor:c}=await this.getBoundingBoxes(s,e,a);return s.dispose(),e?u.map(t=>{const e=f(t,c);let r={topLeft:e.slice([0],[2]),bottomRight:e.slice([2],[2])};if(a){const{landmarks:e,probability:n,anchor:a}=t,i=e.add(a).mul(c);r.landmarks=i,r.probability=n}return n&&(r=p(r,o)),r}):Promise.all(u.map(async t=>{const e=f(t,c);let r;if(a){const[n,a,o]=await Promise.all([t.landmarks,e,t.probability].map(async t=>t.array())),s=t.anchor,[u,l]=c,d=n.map(t=>[(t[0]+s[0])*u,(t[1]+s[1])*l]);r={topLeft:a.slice(0,2),bottomRight:a.slice(2),landmarks:d,probability:o},i(t.box),t.landmarks.dispose(),t.probability.dispose()}else{const t=await e.array();r={topLeft:t.slice(0,2),bottomRight:t.slice(2)}}return e.dispose(),n&&(r=p(r,o)),r}))}}const g="https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1";async function b({maxFaces:t=10,inputWidth:e=128,inputHeight:n=128,iouThreshold:r=.3,scoreThreshold:i=.75}={}){const o=await Object(a["loadGraphModel"])(g,{fromTFHub:!0});return new m(o,e,n,t,r,i)}},"219b":function(t,e,n){"use strict";n.d(e,"b",(function(){return k})),n.d(e,"a",(function(){return S}));var r=n("ec7c"),a=n("32fe"),i=n("4705"),o=n("388c"),s=n("3182"),u=n("eea1"),c=n("bb7b"),l=n("df00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class d{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new p)}profileKernel(t,e,n){let r;const i=()=>{r=n()};let o;const s=c["now"]();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const t of r)t.dataSync();o=Promise.resolve({kernelMs:c["now"]()-s})}if(Object(a["c"])().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let a=0;a<r.length;a++){const e=r[a];e.data().then(n=>{h(n,e.dtype,t)})}const u={kernelName:t,outputs:r,inputs:e,timeMs:o.then(t=>t.kernelMs),extraInfo:o.then(t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():"")};return u}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:a,extraInfo:i}=t;n.forEach(t=>{Promise.all([t.data(),r,i]).then(n=>{this.logger.logKernelProfile(e,t,n[0],n[1],a,n[2])})})}}function h(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}return!1}class p{logKernelProfile(t,e,n,r,a,i){const o="number"===typeof r?l["L"](r+"ms",9):r["error"],s=l["L"](t,25),u=e.rank,c=e.size,d=l["L"](e.shape.toString(),14);let h="";for(const l in a){const t=a[l];if(null!=t){const n=t.shape||e.shape,r=n.length;h+=`${l}: ${r}D ${r>0?n:""} `}}console.log(`%c${s}\t%c${o}\t%c${u}D ${d}\t%c${c}\t%c${h}\t%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f(t,e,n){const r={},a={};for(let u=0;u<e.length;u++)r[e[u].id]=!0;for(let u=0;u<t.length;u++){const n=t[u],i=n.inputs;for(const t in i){const o=i[t];let s=!1;for(let t=0;t<e.length;t++)if(r[o.id]){n.outputs.forEach(t=>r[t.id]=!0),s=!0,a[n.id]=!0;break}if(s)break}}const i={};i[n.id]=!0;const o={};for(let u=t.length-1;u>=0;u--){const e=t[u],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(i[e.outputs[t].id]){for(const t in n)i[n[t].id]=!0,o[e.id]=!0;break}}const s=[];for(let u=0;u<t.length;u++){const e=t[u];if(a[e.id]&&o[e.id]){const t={};for(const a in e.inputs){const n=e.inputs[a];r[n.id]&&(t[a]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}function m(t,e,n,r){for(let a=e.length-1;a>=0;a--){const i=e[a],o=[];if(i.outputs.forEach(e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)}),null==i.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const s=i.gradient(o);for(const e in i.inputs){if(!(e in s))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(s)}.`);const a=n(()=>s[e]());if("float32"!==a.dtype)throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${a.dtype}'`);const o=i.inputs[e];if(!l["a"](a.shape,o.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${e}' has shape '${a.shape}', which does not match the shape of the input '${o.shape}'`);if(null==t[o.id])t[o.id]=a;else{const e=t[o.id];t[o.id]=r(e,a),e.dispose()}}}}var g=n("4e56"),b=n("a6a7");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function y(t){return null!=t.kernelName}class v{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class x{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new v}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],r=await this.initializeBackend(n).success;if(r)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(u["b"](t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t),r=n?await e:e;if(!r)return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new d(this.backendInstance),!0}setupRegisteredKernels(){const t=Object(s["d"])(this.backendName);t.forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){const e=Object(s["d"])(t);e.forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof r["b"]||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0)).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,u["b"](`Initialization of backend ${t} failed`),u["b"](n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return u["b"](`Initialization of backend ${t} failed`),u["b"](n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return x.nextTensorId++}nextVariableId(){return x.nextVariableId++}clone(t){const e=S.runKernel(o["tb"],{x:t}),n={x:t},r=t=>({x:()=>{const e="float32",n={x:t},r={dtype:e};return S.runKernel(o["x"],n,r)}}),a=[];return this.addTapeNode(this.state.activeScope.name,n,[e],r,a,{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;const r=null!=Object(s["c"])(t,this.backendName);if(!r)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let a=0;n.forEach(t=>{a+="complex64"===t.dtype?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;let o,u;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const c=y(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(y(t)){const{kernelName:e,inputs:a,attrs:i}=t;null==this.backendName&&this.backend;const c=Object(s["c"])(e,this.backendName);l["b"](null!=c,()=>`Cannot find registered kernel '${e}' for backend '${this.backendName}'`),o=()=>{const t=this.backend.numDataIds();u=c.kernelFunc({inputs:a,attrs:i,backend:this.backend});const o=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const s=o.map(t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t));if(r){const t=this.getTensorsForGradient(e,a,s);n=this.saveTensorsForBackwardMode(t)}return s}}else{const{forwardFunc:e}=t,a=t=>{r&&(n=t.map(t=>this.keep(this.clone(t))))};o=()=>{const t=this.backend.numDataIds();u=this.tidy(()=>e(this.backend,a));const n=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,t,n),n}}const{inputs:d,attrs:h}=t,p=y(t)?null:t.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(f=this.profiler.profileKernel(c,d,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),e=f.outputs):e=o()}),r&&this.addTapeNode(c,d,e,p,n,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(t=>null!=d[t]?d[t].shape:null),outputShapes:e.map(t=>t.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(u)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map(t=>this.keep(this.clone(t)));return e}getTensorsForGradient(t,e,n){const r=Object(s["b"])(t);if(null!=r){const t=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(l["b"](Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(e).map(t=>e[t])):i=t.map(t=>e[t]);const o=n.filter((t,e)=>a[e]);return i.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=t;"string"===n&&l["z"](t[0])&&(a=t.map(t=>c["encodeString"](t)));const i=r.write(a,e,n),o=new g["a"](e,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(i),e=Object(l["f"])(a);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){n=n||"float32";const a={dataId:t,shape:e,dtype:n};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:a}=t,i=new g["a"](r,a,n,this.nextTensorId());return this.trackTensor(i,e),i}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const a=new g["c"](t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*l["g"](t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof g["c"]||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*l["g"](t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},u=Object(s["b"])(t);null!=u&&(r=u.gradFunc),null!=r&&(o.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=l["F"](t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],a,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=Object(b["getTensorsInContainer"])(t),n=new Set(e.map(t=>t.id));for(let a=0;a<this.state.activeScope.track.length;a++){const t=this.state.activeScope.track[a];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n,r=!1){if(l["b"](e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));l["b"](a instanceof g["a"],()=>"The result y returned by f() must be a tensor.");const i=f(this.state.activeTape,e,a);if(!r&&0===i.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[a.id]=null==n?w(a.shape):n,m(t,i,t=>this.tidy(t),O);const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(t){return l["b"](l["u"](t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;l["b"](e.every(t=>t instanceof g["a"]),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};e.forEach((t,e)=>{r[e]=t});const a=(r,a)=>(n=t(...e,a),l["b"](n.value instanceof g["a"],()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),l["b"](l["u"](n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(t,r)=>{const a=n.gradFunc(t,r),i=Array.isArray(a)?a:[a];l["b"](i.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),l["b"](i.every(t=>t instanceof g["a"]),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const o={};return i.forEach((t,e)=>{o[e]=()=>t}),o};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(t){const e=this.state.tensorInfo.get(t);return e.backend.readSync(t)}read(t){const e=this.state.tensorInfo.get(t);return e.backend.read(t)}readToGPU(t,e){const n=this.state.tensorInfo.get(t);return n.backend.readToGPU(t,e)}async time(t){const e=Object(c["now"])(),n=await this.backend.time(t);return n.wallMs=Object(c["now"])()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new v;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function w(t){const e=Object(l["D"])(Object(l["O"])(t),"float32");return S.makeTensor(e,t,"float32")}function k(){const t=Object(i["b"])();if(null==t._tfengine){const e=new a["b"](t);t._tfengine=new x(e)}return Object(a["d"])(t._tfengine.ENV),Object(g["f"])(()=>t._tfengine),t._tfengine}x.nextTensorId=0,x.nextVariableId=0;const S=k();function O(t,e){const n={a:t,b:e};return S.runKernel(o["d"],n)}},"222c":function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return g}));n("df3a");var r=n("32fe"),a=n("ad8e"),i=n("6a9b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o="tensorflowjs",s=1,u="models_store",c="model_info_store";function l(){if(!Object(r["c"])().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function d(t){const e=t.result;e.createObjectStore(u,{keyPath:"modelPath"}),e.createObjectStore(c,{keyPath:"modelPath"})}class h{constructor(t){if(this.indexedDB=l(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open(o,s);r.onupgradeneeded=()=>d(r),r.onsuccess=()=>{const i=r.result;if(null==e){const e=i.transaction(u,"readonly"),r=e.objectStore(u),a=r.get(this.modelPath);a.onsuccess=()=>{if(null==a.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(a.result.modelArtifacts)},a.onerror=t=>(i.close(),n(a.error)),e.oncomplete=()=>i.close()}else{const r=Object(a["i"])(e),o=i.transaction(c,"readwrite");let s=o.objectStore(c);const l=s.put({modelPath:this.modelPath,modelArtifactsInfo:r});let d;l.onsuccess=()=>{d=i.transaction(u,"readwrite");const a=d.objectStore(u),l=a.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});l.onsuccess=()=>t({modelArtifactsInfo:r}),l.onerror=t=>{s=o.objectStore(c);const e=s.delete(this.modelPath);e.onsuccess=()=>(i.close(),n(l.error)),e.onerror=t=>(i.close(),n(l.error))}},l.onerror=t=>(i.close(),n(l.error)),o.oncomplete=()=>{null==d?i.close():d.oncomplete=()=>i.close()}}},r.onerror=t=>n(r.error)})}}h.URL_SCHEME="indexeddb://";const p=t=>Object(r["c"])().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(h.URL_SCHEME)?f(t.slice(h.URL_SCHEME.length)):null;function f(t){return new h(t)}function m(t){return t.startsWith(h.URL_SCHEME)?t.slice(h.URL_SCHEME.length):t}i["a"].registerSaveRouter(p),i["a"].registerLoadRouter(p);class g{constructor(){this.indexedDB=l()}async listModels(){return new Promise((t,e)=>{const n=this.indexedDB.open(o,s);n.onupgradeneeded=()=>d(n),n.onsuccess=()=>{const r=n.result,a=r.transaction(c,"readonly"),i=a.objectStore(c),o=i.getAll();o.onsuccess=()=>{const e={};for(const t of o.result)e[t.modelPath]=t.modelArtifactsInfo;t(e)},o.onerror=t=>(r.close(),e(o.error)),a.oncomplete=()=>r.close()},n.onerror=t=>e(n.error)})}async removeModel(t){return t=m(t),new Promise((e,n)=>{const r=this.indexedDB.open(o,s);r.onupgradeneeded=()=>d(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(c,"readwrite"),o=i.objectStore(c),s=o.get(t);let l;s.onsuccess=()=>{if(null==s.result)return a.close(),n(new Error(`Cannot find model with path '${t}' in IndexedDB.`));{const r=o.delete(t),i=()=>{l=a.transaction(u,"readwrite");const r=l.objectStore(u),i=r.delete(t);i.onsuccess=()=>e(s.result.modelArtifactsInfo),i.onerror=t=>n(s.error)};r.onsuccess=i,r.onerror=t=>(i(),a.close(),n(s.error))}},s.onerror=t=>(a.close(),n(s.error)),i.oncomplete=()=>{null==l?a.close():l.oncomplete=()=>a.close()}},r.onerror=t=>n(r.error)})}}},2254:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},"225e":function(t,e,n){var r=n("4359"),a=n("d460");function i(t){return a(r(t))}t.exports=i},2286:function(t,e,n){var r=n("85e3"),a=Math.max;function i(t,e,n){return e=a(void 0===e?t.length-1:e,0),function(){var i=arguments,o=-1,s=a(i.length-e,0),u=Array(s);while(++o<s)u[o]=i[e+o];o=-1;var c=Array(e+1);while(++o<e)c[o]=i[o];return c[e]=n(u),r(t,this,c)}}t.exports=i},"229a":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._useBufferCanvas=function(){return t.prototype._useBufferCanvas.call(this,!0)},e.prototype._sceneFunc=function(t){var e,n=this.getWidth(),r=this.getHeight(),a=this.attrs.image;if(a){var i=this.attrs.cropWidth,o=this.attrs.cropHeight;e=i&&o?[a,this.cropX(),this.cropY(),i,o,0,0,n,r]:[a,0,0,n,r]}(this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,n,r),t.closePath(),t.fillStrokeShape(this)),a&&t.drawImage.apply(t,e)},e.prototype._hitFunc=function(t){var e=this.width(),n=this.height();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){var t,e;return null!==(t=this.attrs.width)&&void 0!==t?t:(null===(e=this.image())||void 0===e?void 0:e.width)||0},e.prototype.getHeight=function(){var t,e;return null!==(t=this.attrs.height)&&void 0!==t?t:(null===(e=this.image())||void 0===e?void 0:e.height)||0},e.fromURL=function(t,n){var r=a.Util.createImageElement();r.onload=function(){var t=new e({image:r});n(t)},r.crossOrigin="Anonymous",r.src=t},e}(o.Shape);e.Image=c,c.prototype.className="Image",u._registerNode(c),i.Factory.addGetterSetter(c,"image"),i.Factory.addComponentsGetterSetter(c,"crop",["x","y","width","height"]),i.Factory.addGetterSetter(c,"cropX",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"cropY",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"cropWidth",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"cropHeight",0,s.getNumberValidator()),a.Collection.mapMethods(c)},"22ca":function(t,e,n){"use strict";n("5479")},2337:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"input","imag"),n={input:e};return r["a"].runKernel(a["ub"],n)}const u=Object(o["b"])({imag_:s})},"234d":function(t,e,n){var r=n("e380"),a=500;function i(t){var e=r(t,(function(t){return n.size===a&&n.clear(),t})),n=e.cache;return e}t.exports=i},"23dc":function(t,e){},"242e":function(t,e,n){var r=n("72af"),a=n("ec69");function i(t,e){return t&&r(t,e,a)}t.exports=i},2474:function(t,e,n){var r=n("2b3e"),a=r.Uint8Array;t.exports=a},2478:function(t,e,n){var r=n("4245");function a(t){return r(this,t).get(t)}t.exports=a},2493:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n("45ef");function a(t){null!=t&&null!=t.startPoint&&(t.startEndTensor.dispose(),t.startPoint.dispose(),t.endPoint.dispose())}function i(t,e,n){return{startEndTensor:t,startPoint:null!=e?e:r.slice(t,[0,0],[-1,2]),endPoint:null!=n?n:r.slice(t,[0,2],[-1,2])}}function o(t,e){const n=r.mul(t.startPoint,e),a=r.mul(t.endPoint,e);return i(r.concat2d([n,a],1))}function s(t){return r.tidy(()=>{const e=r.sub(t.endPoint,t.startPoint);return r.abs(e)})}function u(t){return r.tidy(()=>{const e=r.div(r.sub(t.endPoint,t.startPoint),2);return r.add(t.startPoint,e)})}function c(t,e,n){const a=e.shape[1],i=e.shape[2],o=t.startEndTensor;return r.tidy(()=>{const t=r.concat2d([o.slice([0,1],[-1,1]),o.slice([0,0],[-1,1]),o.slice([0,3],[-1,1]),o.slice([0,2],[-1,1])],0),s=r.div(t.transpose(),[a,i,a,i]);return r.image.cropAndResize(e,s,[0],n)})}function l(t,e=1.5){return r.tidy(()=>{const n=u(t),a=s(t),o=r.mul(r.div(a,2),e),c=r.sub(n,o),l=r.add(n,o);return i(r.concat2d([c,l],1),c,l)})}e.disposeBox=a,e.createBox=i,e.scaleBoxCoordinates=o,e.getBoxSize=s,e.getBoxCenter=u,e.cutBoxFromImageAndResize=c,e.enlargeBox=l},"24df":function(t,e,n){},2524:function(t,e,n){var r=n("6044"),a="__lodash_hash_undefined__";function i(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?a:e,this}t.exports=i},"253c":function(t,e,n){var r=n("3729"),a=n("1310"),i="[object Arguments]";function o(t){return a(t)&&r(t)==i}t.exports=o},"266a":function(t,e,n){var r=n("7948");function a(t,e){return r(e,(function(e){return t[e]}))}t.exports=a},"26c8":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RegularPolygon=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this._getPoints();t.beginPath(),t.moveTo(e[0].x,e[0].y);for(var n=1;n<e.length;n++)t.lineTo(e[n].x,e[n].y);t.closePath(),t.fillStrokeShape(this)},e.prototype._getPoints=function(){for(var t=this.attrs.sides,e=this.attrs.radius||0,n=[],r=0;r<t;r++)n.push({x:e*Math.sin(2*r*Math.PI/t),y:-1*e*Math.cos(2*r*Math.PI/t)});return n},e.prototype.getSelfRect=function(){var t=this._getPoints(),e=t[0].x,n=t[0].y,r=t[0].x,a=t[0].y;return t.forEach((function(t){e=Math.min(e,t.x),n=Math.max(n,t.x),r=Math.min(r,t.y),a=Math.max(a,t.y)})),{x:e,y:r,width:n-e,height:a-r}},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius(t/2)},e.prototype.setHeight=function(t){this.radius(t/2)},e}(o.Shape);e.RegularPolygon=c,c.prototype.className="RegularPolygon",c.prototype._centroid=!0,c.prototype._attrsAffectingSize=["radius"],u._registerNode(c),i.Factory.addGetterSetter(c,"radius",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"sides",0,s.getNumberValidator()),a.Collection.mapMethods(c)},"26e8":function(t,e){function n(t,e){return null!=t&&e in Object(t)}t.exports=n},"27bf":function(t,e,n){"use strict";t.exports=o;var r=n("b19a"),a=Object.create(n("3a7c"));function i(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=e&&this.push(e),r(t);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"===typeof t.transform&&(this._transform=t.transform),"function"===typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",s)}function s(){var t=this;"function"===typeof this._flush?this._flush((function(e,n){u(t,e,n)})):u(this,null,null)}function u(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}a.inherits=n("3fb5"),a.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var a=this._readableState;(r.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,(function(t){e(t),n.emit("close")}))}},2877:function(t,e,n){"use strict";function r(t,e,n,r,a,i,o,s){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),o?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=u):a&&(u=s?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(t,e){return u.call(e),l(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,u):[u]}return{exports:t,options:c}}n.d(e,"a",(function(){return r}))},"28a2":function(t,e){},"28c9":function(t,e){function n(){this.__data__=[],this.size=0}t.exports=n},"29f3":function(t,e){var n=Object.prototype,r=n.toString;function a(t){return r.call(t)}t.exports=a},"2a01":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.TextPath=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("8c18"),u=n("5414"),c=n("4546"),l=n("d777"),d="",h="normal";function p(t){t.fillText(this.partialText,0,0)}function f(t){t.strokeText(this.partialText,0,0)}var m=function(t){function e(e){var n=t.call(this,e)||this;return n.dummyCanvas=a.Util.createCanvasElement(),n.dataArray=[],n.dataArray=s.Path.parsePathData(n.attrs.data),n.on("dataChange.konva",(function(){this.dataArray=s.Path.parsePathData(this.attrs.data),this._setTextData()})),n.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva",n._setTextData),e&&e["getKerning"]&&(a.Util.warn('getKerning TextPath API is deprecated. Please use "kerningFunc" instead.'),n.kerningFunc(e["getKerning"])),n._setTextData(),n}return r(e,t),e.prototype._sceneFunc=function(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();var e=this.textDecoration(),n=this.fill(),r=this.fontSize(),a=this.glyphInfo;"underline"===e&&t.beginPath();for(var i=0;i<a.length;i++){t.save();var o=a[i].p0;t.translate(o.x,o.y),t.rotate(a[i].rotation),this.partialText=a[i].text,t.fillStrokeShape(this),"underline"===e&&(0===i&&t.moveTo(0,r/2+1),t.lineTo(r,r/2+1)),t.restore()}"underline"===e&&(t.strokeStyle=n,t.lineWidth=r/20,t.stroke()),t.restore()},e.prototype._hitFunc=function(t){t.beginPath();var e=this.glyphInfo;if(e.length>=1){var n=e[0].p0;t.moveTo(n.x,n.y)}for(var r=0;r<e.length;r++){var a=e[r].p1;t.lineTo(a.x,a.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()},e.prototype.getTextWidth=function(){return this.textWidth},e.prototype.getTextHeight=function(){return a.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},e.prototype.setText=function(t){return u.Text.prototype.setText.call(this,t)},e.prototype._getContextFont=function(){return u.Text.prototype._getContextFont.call(this)},e.prototype._getTextSize=function(t){var e=this.dummyCanvas,n=e.getContext("2d");n.save(),n.font=this._getContextFont();var r=n.measureText(t);return n.restore(),{width:r.width,height:parseInt(this.attrs.fontSize,10)}},e.prototype._setTextData=function(){var t=this,e=this._getTextSize(this.attrs.text),n=this.letterSpacing(),r=this.align(),a=this.kerningFunc();this.textWidth=e.width,this.textHeight=e.height;var i=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);this.glyphInfo=[];for(var o=0,c=0;c<t.dataArray.length;c++)t.dataArray[c].pathLength>0&&(o+=t.dataArray[c].pathLength);var l=0;"center"===r&&(l=Math.max(0,o/2-i/2)),"right"===r&&(l=Math.max(0,o-i));for(var d,h,p,f=u.stringToArray(this.text()),m=this.text().split(" ").length-1,g=-1,b=0,y=function(){b=0;for(var e=t.dataArray,n=g+1;n<e.length;n++){if(e[n].pathLength>0)return g=n,e[n];"M"===e[n].command&&(d={x:e[n].points[0],y:e[n].points[1]})}return{}},v=function(e){var a=t._getTextSize(e).width+n;" "===e&&"justify"===r&&(a+=(o-i)/m);var u=0,c=0;h=void 0;while(Math.abs(a-u)/a>.01&&c<20){c++;var l=u;while(void 0===p)p=y(),p&&l+p.pathLength<a&&(l+=p.pathLength,p=void 0);if(p==={}||void 0===d)return;var f=!1;switch(p.command){case"L":s.Path.getLineLength(d.x,d.y,p.points[0],p.points[1])>a?h=s.Path.getPointOnLine(a,d.x,d.y,p.points[0],p.points[1],d.x,d.y):p=void 0;break;case"A":var g=p.points[4],v=p.points[5],x=p.points[4]+v;0===b?b=g+1e-8:a>u?b+=Math.PI/180*v/Math.abs(v):b-=Math.PI/360*v/Math.abs(v),(v<0&&b<x||v>=0&&b>x)&&(b=x,f=!0),h=s.Path.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],b,p.points[6]);break;case"C":0===b?b=a>p.pathLength?1e-8:a/p.pathLength:a>u?b+=(a-u)/p.pathLength/2:b=Math.max(b-(u-a)/p.pathLength/2,0),b>1&&(b=1,f=!0),h=s.Path.getPointOnCubicBezier(b,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);break;case"Q":0===b?b=a/p.pathLength:a>u?b+=(a-u)/p.pathLength:b-=(u-a)/p.pathLength,b>1&&(b=1,f=!0),h=s.Path.getPointOnQuadraticBezier(b,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3]);break}void 0!==h&&(u=s.Path.getLineLength(d.x,d.y,h.x,h.y)),f&&(f=!1,p=void 0)}},x="C",w=t._getTextSize(x).width+n,k=l/w-1,S=0;S<k;S++){if(v(x),void 0===d||void 0===h)break;d=h}for(var O=0;O<f.length;O++){if(v(f[O]),void 0===d||void 0===h)break;var _=s.Path.getLineLength(d.x,d.y,h.x,h.y),C=0;if(a)try{C=a(f[O-1],f[O])*this.fontSize()}catch(N){C=0}d.x+=C,h.x+=C,this.textWidth+=C;var T=s.Path.getPointOnLine(C+_/2,d.x,d.y,h.x,h.y),I=Math.atan2(h.y-d.y,h.x-d.x);this.glyphInfo.push({transposeX:T.x,transposeY:T.y,text:f[O],rotation:I,p0:d,p1:h}),d=h}},e.prototype.getSelfRect=function(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var t=[];this.glyphInfo.forEach((function(e){t.push(e.p0.x),t.push(e.p0.y),t.push(e.p1.x),t.push(e.p1.y)}));for(var e,n,r=t[0]||0,a=t[0]||0,i=t[1]||0,o=t[1]||0,s=0;s<t.length/2;s++)e=t[2*s],n=t[2*s+1],r=Math.min(r,e),a=Math.max(a,e),i=Math.min(i,n),o=Math.max(o,n);var u=this.fontSize();return{x:r-u/2,y:i-u/2,width:a-r+u,height:o-i+u}},e}(o.Shape);e.TextPath=m,m.prototype._fillFunc=p,m.prototype._strokeFunc=f,m.prototype._fillFuncHit=p,m.prototype._strokeFuncHit=f,m.prototype.className="TextPath",m.prototype._attrsAffectingSize=["text","fontSize","data"],l._registerNode(m),i.Factory.addGetterSetter(m,"data"),i.Factory.addGetterSetter(m,"fontFamily","Arial"),i.Factory.addGetterSetter(m,"fontSize",12,c.getNumberValidator()),i.Factory.addGetterSetter(m,"fontStyle",h),i.Factory.addGetterSetter(m,"align","left"),i.Factory.addGetterSetter(m,"letterSpacing",0,c.getNumberValidator()),i.Factory.addGetterSetter(m,"textBaseline","middle"),i.Factory.addGetterSetter(m,"fontVariant",h),i.Factory.addGetterSetter(m,"text",d),i.Factory.addGetterSetter(m,"textDecoration",null),i.Factory.addGetterSetter(m,"kerningFunc",null),a.Collection.mapMethods(m)},"2a12":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"maxLength",max:t},(function(e){return!(0,r.req)(e)||(0,r.len)(e)<=t}))};e.default=a},"2b03":function(t,e){function n(t,e,n,r){var a=t.length,i=n+(r?1:-1);while(r?i--:++i<a)if(e(t[i],i,t))return i;return-1}t.exports=n},"2b0e":function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"EffectScope",(function(){return Ne})),n.d(e,"computed",(function(){return be})),n.d(e,"customRef",(function(){return ue})),n.d(e,"default",(function(){return ai})),n.d(e,"defineAsyncComponent",(function(){return nr})),n.d(e,"defineComponent",(function(){return vr})),n.d(e,"del",(function(){return Wt})),n.d(e,"effectScope",(function(){return Ee})),n.d(e,"getCurrentInstance",(function(){return bt})),n.d(e,"getCurrentScope",(function(){return Re})),n.d(e,"h",(function(){return Ln})),n.d(e,"inject",(function(){return Me})),n.d(e,"isProxy",(function(){return Yt})),n.d(e,"isReactive",(function(){return qt})),n.d(e,"isReadonly",(function(){return Xt})),n.d(e,"isRef",(function(){return te})),n.d(e,"isShallow",(function(){return Kt})),n.d(e,"markRaw",(function(){return Zt})),n.d(e,"mergeDefaults",(function(){return _n})),n.d(e,"nextTick",(function(){return Qn})),n.d(e,"onActivated",(function(){return dr})),n.d(e,"onBeforeMount",(function(){return ir})),n.d(e,"onBeforeUnmount",(function(){return cr})),n.d(e,"onBeforeUpdate",(function(){return sr})),n.d(e,"onDeactivated",(function(){return hr})),n.d(e,"onErrorCaptured",(function(){return br})),n.d(e,"onMounted",(function(){return or})),n.d(e,"onRenderTracked",(function(){return fr})),n.d(e,"onRenderTriggered",(function(){return mr})),n.d(e,"onScopeDispose",(function(){return je})),n.d(e,"onServerPrefetch",(function(){return pr})),n.d(e,"onUnmounted",(function(){return lr})),n.d(e,"onUpdated",(function(){return ur})),n.d(e,"provide",(function(){return De})),n.d(e,"proxyRefs",(function(){return oe})),n.d(e,"reactive",(function(){return Ut})),n.d(e,"readonly",(function(){return pe})),n.d(e,"ref",(function(){return ee})),n.d(e,"set",(function(){return zt})),n.d(e,"shallowReactive",(function(){return Gt})),n.d(e,"shallowReadonly",(function(){return ge})),n.d(e,"shallowRef",(function(){return ne})),n.d(e,"toRaw",(function(){return Jt})),n.d(e,"toRef",(function(){return le})),n.d(e,"toRefs",(function(){return ce})),n.d(e,"triggerRef",(function(){return ae})),n.d(e,"unref",(function(){return ie})),n.d(e,"useAttrs",(function(){return kn})),n.d(e,"useCssModule",(function(){return tr})),n.d(e,"useCssVars",(function(){return er})),n.d(e,"useListeners",(function(){return Sn})),n.d(e,"useSlots",(function(){return wn})),n.d(e,"version",(function(){return yr})),n.d(e,"watch",(function(){return Te})),n.d(e,"watchEffect",(function(){return ke})),n.d(e,"watchPostEffect",(function(){return Se})),n.d(e,"watchSyncEffect",(function(){return Oe}));
/*!
 * Vue.js v2.7.16
 * (c) 2014-2023 Evan You
 * Released under the MIT License.
 */
var r=Object.freeze({}),a=Array.isArray;function i(t){return void 0===t||null===t}function o(t){return void 0!==t&&null!==t}function s(t){return!0===t}function u(t){return!1===t}function c(t){return"string"===typeof t||"number"===typeof t||"symbol"===typeof t||"boolean"===typeof t}function l(t){return"function"===typeof t}function d(t){return null!==t&&"object"===typeof t}var h=Object.prototype.toString;function p(t){return"[object Object]"===h.call(t)}function f(t){return"[object RegExp]"===h.call(t)}function m(t){var e=parseFloat(String(t));return e>=0&&Math.floor(e)===e&&isFinite(t)}function g(t){return o(t)&&"function"===typeof t.then&&"function"===typeof t.catch}function b(t){return null==t?"":Array.isArray(t)||p(t)&&t.toString===h?JSON.stringify(t,y,2):String(t)}function y(t,e){return e&&e.__v_isRef?e.value:e}function v(t){var e=parseFloat(t);return isNaN(e)?t:e}function x(t,e){for(var n=Object.create(null),r=t.split(","),a=0;a<r.length;a++)n[r[a]]=!0;return e?function(t){return n[t.toLowerCase()]}:function(t){return n[t]}}x("slot,component",!0);var w=x("key,ref,slot,slot-scope,is");function k(t,e){var n=t.length;if(n){if(e===t[n-1])return void(t.length=n-1);var r=t.indexOf(e);if(r>-1)return t.splice(r,1)}}var S=Object.prototype.hasOwnProperty;function O(t,e){return S.call(t,e)}function _(t){var e=Object.create(null);return function(n){var r=e[n];return r||(e[n]=t(n))}}var C=/-(\w)/g,T=_((function(t){return t.replace(C,(function(t,e){return e?e.toUpperCase():""}))})),I=_((function(t){return t.charAt(0).toUpperCase()+t.slice(1)})),N=/\B([A-Z])/g,E=_((function(t){return t.replace(N,"-$1").toLowerCase()}));function A(t,e){function n(n){var r=arguments.length;return r?r>1?t.apply(e,arguments):t.call(e,n):t.call(e)}return n._length=t.length,n}function R(t,e){return t.bind(e)}var j=Function.prototype.bind?R:A;function D(t,e){e=e||0;var n=t.length-e,r=new Array(n);while(n--)r[n]=t[n+e];return r}function F(t,e){for(var n in e)t[n]=e[n];return t}function M(t){for(var e={},n=0;n<t.length;n++)t[n]&&F(e,t[n]);return e}function P(t,e,n){}var $=function(t,e,n){return!1},L=function(t){return t};function B(t,e){if(t===e)return!0;var n=d(t),r=d(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var a=Array.isArray(t),i=Array.isArray(e);if(a&&i)return t.length===e.length&&t.every((function(t,n){return B(t,e[n])}));if(t instanceof Date&&e instanceof Date)return t.getTime()===e.getTime();if(a||i)return!1;var o=Object.keys(t),s=Object.keys(e);return o.length===s.length&&o.every((function(n){return B(t[n],e[n])}))}catch(u){return!1}}function z(t,e){for(var n=0;n<t.length;n++)if(B(t[n],e))return n;return-1}function W(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}}function V(t,e){return t===e?0===t&&1/t!==1/e:t===t||e===e}var U="data-server-rendered",G=["component","directive","filter"],H=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],q={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:$,isReservedAttr:$,isUnknownElement:$,getTagNamespace:P,parsePlatformTagName:L,mustUseProp:$,async:!0,_lifecycleHooks:H},K=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function X(t){var e=(t+"").charCodeAt(0);return 36===e||95===e}function Y(t,e,n,r){Object.defineProperty(t,e,{value:n,enumerable:!!r,writable:!0,configurable:!0})}var J=new RegExp("[^".concat(K.source,".$_\\d]"));function Z(t){if(!J.test(t)){var e=t.split(".");return function(t){for(var n=0;n<e.length;n++){if(!t)return;t=t[e[n]]}return t}}}var Q="__proto__"in{},tt="undefined"!==typeof window,et=tt&&window.navigator.userAgent.toLowerCase(),nt=et&&/msie|trident/.test(et),rt=et&&et.indexOf("msie 9.0")>0,at=et&&et.indexOf("edge/")>0;et&&et.indexOf("android");var it=et&&/iphone|ipad|ipod|ios/.test(et);et&&/chrome\/\d+/.test(et),et&&/phantomjs/.test(et);var ot,st=et&&et.match(/firefox\/(\d+)/),ut={}.watch,ct=!1;if(tt)try{var lt={};Object.defineProperty(lt,"passive",{get:function(){ct=!0}}),window.addEventListener("test-passive",null,lt)}catch(iu){}var dt=function(){return void 0===ot&&(ot=!tt&&"undefined"!==typeof t&&(t["process"]&&"server"===t["process"].env.VUE_ENV)),ot},ht=tt&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function pt(t){return"function"===typeof t&&/native code/.test(t.toString())}var ft,mt="undefined"!==typeof Symbol&&pt(Symbol)&&"undefined"!==typeof Reflect&&pt(Reflect.ownKeys);ft="undefined"!==typeof Set&&pt(Set)?Set:function(){function t(){this.set=Object.create(null)}return t.prototype.has=function(t){return!0===this.set[t]},t.prototype.add=function(t){this.set[t]=!0},t.prototype.clear=function(){this.set=Object.create(null)},t}();var gt=null;function bt(){return gt&&{proxy:gt}}function yt(t){void 0===t&&(t=null),t||gt&&gt._scope.off(),gt=t,t&&t._scope.on()}var vt=function(){function t(t,e,n,r,a,i,o,s){this.tag=t,this.data=e,this.children=n,this.text=r,this.elm=a,this.ns=void 0,this.context=i,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=e&&e.key,this.componentOptions=o,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=s,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(t.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),t}(),xt=function(t){void 0===t&&(t="");var e=new vt;return e.text=t,e.isComment=!0,e};function wt(t){return new vt(void 0,void 0,void 0,String(t))}function kt(t){var e=new vt(t.tag,t.data,t.children&&t.children.slice(),t.text,t.elm,t.context,t.componentOptions,t.asyncFactory);return e.ns=t.ns,e.isStatic=t.isStatic,e.key=t.key,e.isComment=t.isComment,e.fnContext=t.fnContext,e.fnOptions=t.fnOptions,e.fnScopeId=t.fnScopeId,e.asyncMeta=t.asyncMeta,e.isCloned=!0,e}"function"===typeof SuppressedError&&SuppressedError;var St=0,Ot=[],_t=function(){for(var t=0;t<Ot.length;t++){var e=Ot[t];e.subs=e.subs.filter((function(t){return t})),e._pending=!1}Ot.length=0},Ct=function(){function t(){this._pending=!1,this.id=St++,this.subs=[]}return t.prototype.addSub=function(t){this.subs.push(t)},t.prototype.removeSub=function(t){this.subs[this.subs.indexOf(t)]=null,this._pending||(this._pending=!0,Ot.push(this))},t.prototype.depend=function(e){t.target&&t.target.addDep(this)},t.prototype.notify=function(t){var e=this.subs.filter((function(t){return t}));for(var n=0,r=e.length;n<r;n++){var a=e[n];0,a.update()}},t}();Ct.target=null;var Tt=[];function It(t){Tt.push(t),Ct.target=t}function Nt(){Tt.pop(),Ct.target=Tt[Tt.length-1]}var Et=Array.prototype,At=Object.create(Et),Rt=["push","pop","shift","unshift","splice","sort","reverse"];Rt.forEach((function(t){var e=Et[t];Y(At,t,(function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var a,i=e.apply(this,n),o=this.__ob__;switch(t){case"push":case"unshift":a=n;break;case"splice":a=n.slice(2);break}return a&&o.observeArray(a),o.dep.notify(),i}))}));var jt=Object.getOwnPropertyNames(At),Dt={},Ft=!0;function Mt(t){Ft=t}var Pt={notify:P,depend:P,addSub:P,removeSub:P},$t=function(){function t(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=!1),this.value=t,this.shallow=e,this.mock=n,this.dep=n?Pt:new Ct,this.vmCount=0,Y(t,"__ob__",this),a(t)){if(!n)if(Q)t.__proto__=At;else for(var r=0,i=jt.length;r<i;r++){var o=jt[r];Y(t,o,At[o])}e||this.observeArray(t)}else{var s=Object.keys(t);for(r=0;r<s.length;r++){o=s[r];Bt(t,o,Dt,void 0,e,n)}}}return t.prototype.observeArray=function(t){for(var e=0,n=t.length;e<n;e++)Lt(t[e],!1,this.mock)},t}();function Lt(t,e,n){return t&&O(t,"__ob__")&&t.__ob__ instanceof $t?t.__ob__:!Ft||!n&&dt()||!a(t)&&!p(t)||!Object.isExtensible(t)||t.__v_skip||te(t)||t instanceof vt?void 0:new $t(t,e,n)}function Bt(t,e,n,r,i,o,s){void 0===s&&(s=!1);var u=new Ct,c=Object.getOwnPropertyDescriptor(t,e);if(!c||!1!==c.configurable){var l=c&&c.get,d=c&&c.set;l&&!d||n!==Dt&&2!==arguments.length||(n=t[e]);var h=i?n&&n.__ob__:Lt(n,!1,o);return Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){var e=l?l.call(t):n;return Ct.target&&(u.depend(),h&&(h.dep.depend(),a(e)&&Vt(e))),te(e)&&!i?e.value:e},set:function(e){var r=l?l.call(t):n;if(V(r,e)){if(d)d.call(t,e);else{if(l)return;if(!i&&te(r)&&!te(e))return void(r.value=e);n=e}h=i?e&&e.__ob__:Lt(e,!1,o),u.notify()}}}),u}}function zt(t,e,n){if(!Xt(t)){var r=t.__ob__;return a(t)&&m(e)?(t.length=Math.max(t.length,e),t.splice(e,1,n),r&&!r.shallow&&r.mock&&Lt(n,!1,!0),n):e in t&&!(e in Object.prototype)?(t[e]=n,n):t._isVue||r&&r.vmCount?n:r?(Bt(r.value,e,n,void 0,r.shallow,r.mock),r.dep.notify(),n):(t[e]=n,n)}}function Wt(t,e){if(a(t)&&m(e))t.splice(e,1);else{var n=t.__ob__;t._isVue||n&&n.vmCount||Xt(t)||O(t,e)&&(delete t[e],n&&n.dep.notify())}}function Vt(t){for(var e=void 0,n=0,r=t.length;n<r;n++)e=t[n],e&&e.__ob__&&e.__ob__.dep.depend(),a(e)&&Vt(e)}function Ut(t){return Ht(t,!1),t}function Gt(t){return Ht(t,!0),Y(t,"__v_isShallow",!0),t}function Ht(t,e){if(!Xt(t)){Lt(t,e,dt());0}}function qt(t){return Xt(t)?qt(t["__v_raw"]):!(!t||!t.__ob__)}function Kt(t){return!(!t||!t.__v_isShallow)}function Xt(t){return!(!t||!t.__v_isReadonly)}function Yt(t){return qt(t)||Xt(t)}function Jt(t){var e=t&&t["__v_raw"];return e?Jt(e):t}function Zt(t){return Object.isExtensible(t)&&Y(t,"__v_skip",!0),t}var Qt="__v_isRef";function te(t){return!(!t||!0!==t.__v_isRef)}function ee(t){return re(t,!1)}function ne(t){return re(t,!0)}function re(t,e){if(te(t))return t;var n={};return Y(n,Qt,!0),Y(n,"__v_isShallow",e),Y(n,"dep",Bt(n,"value",t,null,e,dt())),n}function ae(t){t.dep&&t.dep.notify()}function ie(t){return te(t)?t.value:t}function oe(t){if(qt(t))return t;for(var e={},n=Object.keys(t),r=0;r<n.length;r++)se(e,t,n[r]);return e}function se(t,e,n){Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){var t=e[n];if(te(t))return t.value;var r=t&&t.__ob__;return r&&r.dep.depend(),t},set:function(t){var r=e[n];te(r)&&!te(t)?r.value=t:e[n]=t}})}function ue(t){var e=new Ct,n=t((function(){e.depend()}),(function(){e.notify()})),r=n.get,a=n.set,i={get value(){return r()},set value(t){a(t)}};return Y(i,Qt,!0),i}function ce(t){var e=a(t)?new Array(t.length):{};for(var n in t)e[n]=le(t,n);return e}function le(t,e,n){var r=t[e];if(te(r))return r;var a={get value(){var r=t[e];return void 0===r?n:r},set value(n){t[e]=n}};return Y(a,Qt,!0),a}var de="__v_rawToReadonly",he="__v_rawToShallowReadonly";function pe(t){return fe(t,!1)}function fe(t,e){if(!p(t))return t;if(Xt(t))return t;var n=e?he:de,r=t[n];if(r)return r;var a=Object.create(Object.getPrototypeOf(t));Y(t,n,a),Y(a,"__v_isReadonly",!0),Y(a,"__v_raw",t),te(t)&&Y(a,Qt,!0),(e||Kt(t))&&Y(a,"__v_isShallow",!0);for(var i=Object.keys(t),o=0;o<i.length;o++)me(a,t,i[o],e);return a}function me(t,e,n,r){Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:function(){var t=e[n];return r||!p(t)?t:pe(t)},set:function(){}})}function ge(t){return fe(t,!0)}function be(t,e){var n,r,a=l(t);a?(n=t,r=P):(n=t.get,r=t.set);var i=dt()?null:new _r(gt,n,P,{lazy:!0});var o={effect:i,get value(){return i?(i.dirty&&i.evaluate(),Ct.target&&i.depend(),i.value):n()},set value(t){r(t)}};return Y(o,Qt,!0),Y(o,"__v_isReadonly",a),o}var ye="watcher",ve="".concat(ye," callback"),xe="".concat(ye," getter"),we="".concat(ye," cleanup");function ke(t,e){return Ie(t,null,e)}function Se(t,e){return Ie(t,null,{flush:"post"})}function Oe(t,e){return Ie(t,null,{flush:"sync"})}var _e,Ce={};function Te(t,e,n){return Ie(t,e,n)}function Ie(t,e,n){var i=void 0===n?r:n,o=i.immediate,s=i.deep,u=i.flush,c=void 0===u?"pre":u;i.onTrack,i.onTrigger;var d,h,p=gt,f=function(t,e,n){void 0===n&&(n=null);var r=zn(t,null,n,p,e);return s&&r&&r.__ob__&&r.__ob__.dep.depend(),r},m=!1,g=!1;if(te(t)?(d=function(){return t.value},m=Kt(t)):qt(t)?(d=function(){return t.__ob__.dep.depend(),t},s=!0):a(t)?(g=!0,m=t.some((function(t){return qt(t)||Kt(t)})),d=function(){return t.map((function(t){return te(t)?t.value:qt(t)?(t.__ob__.dep.depend(),wr(t)):l(t)?f(t,xe):void 0}))}):d=l(t)?e?function(){return f(t,xe)}:function(){if(!p||!p._isDestroyed)return h&&h(),f(t,ye,[y])}:P,e&&s){var b=d;d=function(){return wr(b())}}var y=function(t){h=v.onStop=function(){f(t,we)}};if(dt())return y=P,e?o&&f(e,ve,[d(),g?[]:void 0,y]):d(),P;var v=new _r(gt,d,P,{lazy:!0});v.noRecurse=!e;var x=g?[]:Ce;return v.run=function(){if(v.active)if(e){var t=v.get();(s||m||(g?t.some((function(t,e){return V(t,x[e])})):V(t,x)))&&(h&&h(),f(e,ve,[t,x===Ce?void 0:x,y]),x=t)}else v.get()},"sync"===c?v.update=v.run:"post"===c?(v.post=!0,v.update=function(){return ra(v)}):v.update=function(){if(p&&p===gt&&!p._isMounted){var t=p._preWatchers||(p._preWatchers=[]);t.indexOf(v)<0&&t.push(v)}else ra(v)},e?o?v.run():x=v.get():"post"===c&&p?p.$once("hook:mounted",(function(){return v.get()})):v.get(),function(){v.teardown()}}var Ne=function(){function t(t){void 0===t&&(t=!1),this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=_e,!t&&_e&&(this.index=(_e.scopes||(_e.scopes=[])).push(this)-1)}return t.prototype.run=function(t){if(this.active){var e=_e;try{return _e=this,t()}finally{_e=e}}else 0},t.prototype.on=function(){_e=this},t.prototype.off=function(){_e=this.parent},t.prototype.stop=function(t){if(this.active){var e=void 0,n=void 0;for(e=0,n=this.effects.length;e<n;e++)this.effects[e].teardown();for(e=0,n=this.cleanups.length;e<n;e++)this.cleanups[e]();if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){var r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this.active=!1}},t}();function Ee(t){return new Ne(t)}function Ae(t,e){void 0===e&&(e=_e),e&&e.active&&e.effects.push(t)}function Re(){return _e}function je(t){_e&&_e.cleanups.push(t)}function De(t,e){gt&&(Fe(gt)[t]=e)}function Fe(t){var e=t._provided,n=t.$parent&&t.$parent._provided;return n===e?t._provided=Object.create(n):e}function Me(t,e,n){void 0===n&&(n=!1);var r=gt;if(r){var a=r.$parent&&r.$parent._provided;if(a&&t in a)return a[t];if(arguments.length>1)return n&&l(e)?e.call(r):e}else 0}var Pe=_((function(t){var e="&"===t.charAt(0);t=e?t.slice(1):t;var n="~"===t.charAt(0);t=n?t.slice(1):t;var r="!"===t.charAt(0);return t=r?t.slice(1):t,{name:t,once:n,capture:r,passive:e}}));function $e(t,e){function n(){var t=n.fns;if(!a(t))return zn(t,null,arguments,e,"v-on handler");for(var r=t.slice(),i=0;i<r.length;i++)zn(r[i],null,arguments,e,"v-on handler")}return n.fns=t,n}function Le(t,e,n,r,a,o){var u,c,l,d;for(u in t)c=t[u],l=e[u],d=Pe(u),i(c)||(i(l)?(i(c.fns)&&(c=t[u]=$e(c,o)),s(d.once)&&(c=t[u]=a(d.name,c,d.capture)),n(d.name,c,d.capture,d.passive,d.params)):c!==l&&(l.fns=c,t[u]=l));for(u in e)i(t[u])&&(d=Pe(u),r(d.name,e[u],d.capture))}function Be(t,e,n){var r;t instanceof vt&&(t=t.data.hook||(t.data.hook={}));var a=t[e];function u(){n.apply(this,arguments),k(r.fns,u)}i(a)?r=$e([u]):o(a.fns)&&s(a.merged)?(r=a,r.fns.push(u)):r=$e([a,u]),r.merged=!0,t[e]=r}function ze(t,e,n){var r=e.options.props;if(!i(r)){var a={},s=t.attrs,u=t.props;if(o(s)||o(u))for(var c in r){var l=E(c);We(a,u,c,l,!0)||We(a,s,c,l,!1)}return a}}function We(t,e,n,r,a){if(o(e)){if(O(e,n))return t[n]=e[n],a||delete e[n],!0;if(O(e,r))return t[n]=e[r],a||delete e[r],!0}return!1}function Ve(t){for(var e=0;e<t.length;e++)if(a(t[e]))return Array.prototype.concat.apply([],t);return t}function Ue(t){return c(t)?[wt(t)]:a(t)?He(t):void 0}function Ge(t){return o(t)&&o(t.text)&&u(t.isComment)}function He(t,e){var n,r,u,l,d=[];for(n=0;n<t.length;n++)r=t[n],i(r)||"boolean"===typeof r||(u=d.length-1,l=d[u],a(r)?r.length>0&&(r=He(r,"".concat(e||"","_").concat(n)),Ge(r[0])&&Ge(l)&&(d[u]=wt(l.text+r[0].text),r.shift()),d.push.apply(d,r)):c(r)?Ge(l)?d[u]=wt(l.text+r):""!==r&&d.push(wt(r)):Ge(r)&&Ge(l)?d[u]=wt(l.text+r.text):(s(t._isVList)&&o(r.tag)&&i(r.key)&&o(e)&&(r.key="__vlist".concat(e,"_").concat(n,"__")),d.push(r)));return d}function qe(t,e){var n,r,i,s,u=null;if(a(t)||"string"===typeof t)for(u=new Array(t.length),n=0,r=t.length;n<r;n++)u[n]=e(t[n],n);else if("number"===typeof t)for(u=new Array(t),n=0;n<t;n++)u[n]=e(n+1,n);else if(d(t))if(mt&&t[Symbol.iterator]){u=[];var c=t[Symbol.iterator](),l=c.next();while(!l.done)u.push(e(l.value,u.length)),l=c.next()}else for(i=Object.keys(t),u=new Array(i.length),n=0,r=i.length;n<r;n++)s=i[n],u[n]=e(t[s],s,n);return o(u)||(u=[]),u._isVList=!0,u}function Ke(t,e,n,r){var a,i=this.$scopedSlots[t];i?(n=n||{},r&&(n=F(F({},r),n)),a=i(n)||(l(e)?e():e)):a=this.$slots[t]||(l(e)?e():e);var o=n&&n.slot;return o?this.$createElement("template",{slot:o},a):a}function Xe(t){return Aa(this.$options,"filters",t,!0)||L}function Ye(t,e){return a(t)?-1===t.indexOf(e):t!==e}function Je(t,e,n,r,a){var i=q.keyCodes[e]||n;return a&&r&&!q.keyCodes[e]?Ye(a,r):i?Ye(i,t):r?E(r)!==e:void 0===t}function Ze(t,e,n,r,i){if(n)if(d(n)){a(n)&&(n=M(n));var o=void 0,s=function(a){if("class"===a||"style"===a||w(a))o=t;else{var s=t.attrs&&t.attrs.type;o=r||q.mustUseProp(e,s,a)?t.domProps||(t.domProps={}):t.attrs||(t.attrs={})}var u=T(a),c=E(a);if(!(u in o)&&!(c in o)&&(o[a]=n[a],i)){var l=t.on||(t.on={});l["update:".concat(a)]=function(t){n[a]=t}}};for(var u in n)s(u)}else;return t}function Qe(t,e){var n=this._staticTrees||(this._staticTrees=[]),r=n[t];return r&&!e||(r=n[t]=this.$options.staticRenderFns[t].call(this._renderProxy,this._c,this),en(r,"__static__".concat(t),!1)),r}function tn(t,e,n){return en(t,"__once__".concat(e).concat(n?"_".concat(n):""),!0),t}function en(t,e,n){if(a(t))for(var r=0;r<t.length;r++)t[r]&&"string"!==typeof t[r]&&nn(t[r],"".concat(e,"_").concat(r),n);else nn(t,e,n)}function nn(t,e,n){t.isStatic=!0,t.key=e,t.isOnce=n}function rn(t,e){if(e)if(p(e)){var n=t.on=t.on?F({},t.on):{};for(var r in e){var a=n[r],i=e[r];n[r]=a?[].concat(a,i):i}}else;return t}function an(t,e,n,r){e=e||{$stable:!n};for(var i=0;i<t.length;i++){var o=t[i];a(o)?an(o,e,n):o&&(o.proxy&&(o.fn.proxy=!0),e[o.key]=o.fn)}return r&&(e.$key=r),e}function on(t,e){for(var n=0;n<e.length;n+=2){var r=e[n];"string"===typeof r&&r&&(t[e[n]]=e[n+1])}return t}function sn(t,e){return"string"===typeof t?e+t:t}function un(t){t._o=tn,t._n=v,t._s=b,t._l=qe,t._t=Ke,t._q=B,t._i=z,t._m=Qe,t._f=Xe,t._k=Je,t._b=Ze,t._v=wt,t._e=xt,t._u=an,t._g=rn,t._d=on,t._p=sn}function cn(t,e){if(!t||!t.length)return{};for(var n={},r=0,a=t.length;r<a;r++){var i=t[r],o=i.data;if(o&&o.attrs&&o.attrs.slot&&delete o.attrs.slot,i.context!==e&&i.fnContext!==e||!o||null==o.slot)(n.default||(n.default=[])).push(i);else{var s=o.slot,u=n[s]||(n[s]=[]);"template"===i.tag?u.push.apply(u,i.children||[]):u.push(i)}}for(var c in n)n[c].every(ln)&&delete n[c];return n}function ln(t){return t.isComment&&!t.asyncFactory||" "===t.text}function dn(t){return t.isComment&&t.asyncFactory}function hn(t,e,n,a){var i,o=Object.keys(n).length>0,s=e?!!e.$stable:!o,u=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(s&&a&&a!==r&&u===a.$key&&!o&&!a.$hasNormal)return a;for(var c in i={},e)e[c]&&"$"!==c[0]&&(i[c]=pn(t,n,c,e[c]))}else i={};for(var l in n)l in i||(i[l]=fn(n,l));return e&&Object.isExtensible(e)&&(e._normalized=i),Y(i,"$stable",s),Y(i,"$key",u),Y(i,"$hasNormal",o),i}function pn(t,e,n,r){var i=function(){var e=gt;yt(t);var n=arguments.length?r.apply(null,arguments):r({});n=n&&"object"===typeof n&&!a(n)?[n]:Ue(n);var i=n&&n[0];return yt(e),n&&(!i||1===n.length&&i.isComment&&!dn(i))?void 0:n};return r.proxy&&Object.defineProperty(e,n,{get:i,enumerable:!0,configurable:!0}),i}function fn(t,e){return function(){return t[e]}}function mn(t){var e=t.$options,n=e.setup;if(n){var r=t._setupContext=gn(t);yt(t),It();var a=zn(n,null,[t._props||Gt({}),r],t,"setup");if(Nt(),yt(),l(a))e.render=a;else if(d(a))if(t._setupState=a,a.__sfc){var i=t._setupProxy={};for(var o in a)"__sfc"!==o&&se(i,a,o)}else for(var o in a)X(o)||se(t,a,o);else 0}}function gn(t){return{get attrs(){if(!t._attrsProxy){var e=t._attrsProxy={};Y(e,"_v_attr_proxy",!0),bn(e,t.$attrs,r,t,"$attrs")}return t._attrsProxy},get listeners(){if(!t._listenersProxy){var e=t._listenersProxy={};bn(e,t.$listeners,r,t,"$listeners")}return t._listenersProxy},get slots(){return vn(t)},emit:j(t.$emit,t),expose:function(e){e&&Object.keys(e).forEach((function(n){return se(t,e,n)}))}}}function bn(t,e,n,r,a){var i=!1;for(var o in e)o in t?e[o]!==n[o]&&(i=!0):(i=!0,yn(t,o,r,a));for(var o in t)o in e||(i=!0,delete t[o]);return i}function yn(t,e,n,r){Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){return n[r][e]}})}function vn(t){return t._slotsProxy||xn(t._slotsProxy={},t.$scopedSlots),t._slotsProxy}function xn(t,e){for(var n in e)t[n]=e[n];for(var n in t)n in e||delete t[n]}function wn(){return On().slots}function kn(){return On().attrs}function Sn(){return On().listeners}function On(){var t=gt;return t._setupContext||(t._setupContext=gn(t))}function _n(t,e){var n=a(t)?t.reduce((function(t,e){return t[e]={},t}),{}):t;for(var r in e){var i=n[r];i?a(i)||l(i)?n[r]={type:i,default:e[r]}:i.default=e[r]:null===i&&(n[r]={default:e[r]})}return n}function Cn(t){t._vnode=null,t._staticTrees=null;var e=t.$options,n=t.$vnode=e._parentVnode,a=n&&n.context;t.$slots=cn(e._renderChildren,a),t.$scopedSlots=n?hn(t.$parent,n.data.scopedSlots,t.$slots):r,t._c=function(e,n,r,a){return Fn(t,e,n,r,a,!1)},t.$createElement=function(e,n,r,a){return Fn(t,e,n,r,a,!0)};var i=n&&n.data;Bt(t,"$attrs",i&&i.attrs||r,null,!0),Bt(t,"$listeners",e._parentListeners||r,null,!0)}var Tn=null;function In(t){un(t.prototype),t.prototype.$nextTick=function(t){return Qn(t,this)},t.prototype._render=function(){var t=this,e=t.$options,n=e.render,r=e._parentVnode;r&&t._isMounted&&(t.$scopedSlots=hn(t.$parent,r.data.scopedSlots,t.$slots,t.$scopedSlots),t._slotsProxy&&xn(t._slotsProxy,t.$scopedSlots)),t.$vnode=r;var i,o=gt,s=Tn;try{yt(t),Tn=t,i=n.call(t._renderProxy,t.$createElement)}catch(iu){Bn(iu,t,"render"),i=t._vnode}finally{Tn=s,yt(o)}return a(i)&&1===i.length&&(i=i[0]),i instanceof vt||(i=xt()),i.parent=r,i}}function Nn(t,e){return(t.__esModule||mt&&"Module"===t[Symbol.toStringTag])&&(t=t.default),d(t)?e.extend(t):t}function En(t,e,n,r,a){var i=xt();return i.asyncFactory=t,i.asyncMeta={data:e,context:n,children:r,tag:a},i}function An(t,e){if(s(t.error)&&o(t.errorComp))return t.errorComp;if(o(t.resolved))return t.resolved;var n=Tn;if(n&&o(t.owners)&&-1===t.owners.indexOf(n)&&t.owners.push(n),s(t.loading)&&o(t.loadingComp))return t.loadingComp;if(n&&!o(t.owners)){var r=t.owners=[n],a=!0,u=null,c=null;n.$on("hook:destroyed",(function(){return k(r,n)}));var l=function(t){for(var e=0,n=r.length;e<n;e++)r[e].$forceUpdate();t&&(r.length=0,null!==u&&(clearTimeout(u),u=null),null!==c&&(clearTimeout(c),c=null))},h=W((function(n){t.resolved=Nn(n,e),a?r.length=0:l(!0)})),p=W((function(e){o(t.errorComp)&&(t.error=!0,l(!0))})),f=t(h,p);return d(f)&&(g(f)?i(t.resolved)&&f.then(h,p):g(f.component)&&(f.component.then(h,p),o(f.error)&&(t.errorComp=Nn(f.error,e)),o(f.loading)&&(t.loadingComp=Nn(f.loading,e),0===f.delay?t.loading=!0:u=setTimeout((function(){u=null,i(t.resolved)&&i(t.error)&&(t.loading=!0,l(!1))}),f.delay||200)),o(f.timeout)&&(c=setTimeout((function(){c=null,i(t.resolved)&&p(null)}),f.timeout)))),a=!1,t.loading?t.loadingComp:t.resolved}}function Rn(t){if(a(t))for(var e=0;e<t.length;e++){var n=t[e];if(o(n)&&(o(n.componentOptions)||dn(n)))return n}}var jn=1,Dn=2;function Fn(t,e,n,r,i,o){return(a(n)||c(n))&&(i=r,r=n,n=void 0),s(o)&&(i=Dn),Mn(t,e,n,r,i)}function Mn(t,e,n,r,i){if(o(n)&&o(n.__ob__))return xt();if(o(n)&&o(n.is)&&(e=n.is),!e)return xt();var s,u;if(a(r)&&l(r[0])&&(n=n||{},n.scopedSlots={default:r[0]},r.length=0),i===Dn?r=Ue(r):i===jn&&(r=Ve(r)),"string"===typeof e){var c=void 0;u=t.$vnode&&t.$vnode.ns||q.getTagNamespace(e),s=q.isReservedTag(e)?new vt(q.parsePlatformTagName(e),n,r,void 0,void 0,t):n&&n.pre||!o(c=Aa(t.$options,"components",e))?new vt(e,n,r,void 0,void 0,t):fa(c,n,t,r,e)}else s=fa(e,n,t,r);return a(s)?s:o(s)?(o(u)&&Pn(s,u),o(n)&&$n(n),s):xt()}function Pn(t,e,n){if(t.ns=e,"foreignObject"===t.tag&&(e=void 0,n=!0),o(t.children))for(var r=0,a=t.children.length;r<a;r++){var u=t.children[r];o(u.tag)&&(i(u.ns)||s(n)&&"svg"!==u.tag)&&Pn(u,e,n)}}function $n(t){d(t.style)&&wr(t.style),d(t.class)&&wr(t.class)}function Ln(t,e,n){return Fn(gt,t,e,n,2,!0)}function Bn(t,e,n){It();try{if(e){var r=e;while(r=r.$parent){var a=r.$options.errorCaptured;if(a)for(var i=0;i<a.length;i++)try{var o=!1===a[i].call(r,t,e,n);if(o)return}catch(iu){Wn(iu,r,"errorCaptured hook")}}}Wn(t,e,n)}finally{Nt()}}function zn(t,e,n,r,a){var i;try{i=n?t.apply(e,n):t.call(e),i&&!i._isVue&&g(i)&&!i._handled&&(i.catch((function(t){return Bn(t,r,a+" (Promise/async)")})),i._handled=!0)}catch(iu){Bn(iu,r,a)}return i}function Wn(t,e,n){if(q.errorHandler)try{return q.errorHandler.call(null,t,e,n)}catch(iu){iu!==t&&Vn(iu,null,"config.errorHandler")}Vn(t,e,n)}function Vn(t,e,n){if(!tt||"undefined"===typeof console)throw t;console.error(t)}var Un,Gn=!1,Hn=[],qn=!1;function Kn(){qn=!1;var t=Hn.slice(0);Hn.length=0;for(var e=0;e<t.length;e++)t[e]()}if("undefined"!==typeof Promise&&pt(Promise)){var Xn=Promise.resolve();Un=function(){Xn.then(Kn),it&&setTimeout(P)},Gn=!0}else if(nt||"undefined"===typeof MutationObserver||!pt(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Un="undefined"!==typeof setImmediate&&pt(setImmediate)?function(){setImmediate(Kn)}:function(){setTimeout(Kn,0)};else{var Yn=1,Jn=new MutationObserver(Kn),Zn=document.createTextNode(String(Yn));Jn.observe(Zn,{characterData:!0}),Un=function(){Yn=(Yn+1)%2,Zn.data=String(Yn)},Gn=!0}function Qn(t,e){var n;if(Hn.push((function(){if(t)try{t.call(e)}catch(iu){Bn(iu,e,"nextTick")}else n&&n(e)})),qn||(qn=!0,Un()),!t&&"undefined"!==typeof Promise)return new Promise((function(t){n=t}))}function tr(t){if(void 0===t&&(t="$style"),!gt)return r;var e=gt[t];return e||r}function er(t){if(tt){var e=gt;e&&Se((function(){var n=e.$el,r=t(e,e._setupProxy);if(n&&1===n.nodeType){var a=n.style;for(var i in r)a.setProperty("--".concat(i),r[i])}}))}}function nr(t){l(t)&&(t={loader:t});var e=t.loader,n=t.loadingComponent,r=t.errorComponent,a=t.delay,i=void 0===a?200:a,o=t.timeout,s=(t.suspensible,t.onError);var u=null,c=0,d=function(){return c++,u=null,h()},h=function(){var t;return u||(t=u=e().catch((function(t){if(t=t instanceof Error?t:new Error(String(t)),s)return new Promise((function(e,n){var r=function(){return e(d())},a=function(){return n(t)};s(t,r,a,c+1)}));throw t})).then((function(e){return t!==u&&u?u:(e&&(e.__esModule||"Module"===e[Symbol.toStringTag])&&(e=e.default),e)})))};return function(){var t=h();return{component:t,delay:i,timeout:o,error:r,loading:n}}}function rr(t){return function(e,n){if(void 0===n&&(n=gt),n)return ar(n,t,e)}}function ar(t,e,n){var r=t.$options;r[e]=Sa(r[e],n)}var ir=rr("beforeMount"),or=rr("mounted"),sr=rr("beforeUpdate"),ur=rr("updated"),cr=rr("beforeDestroy"),lr=rr("destroyed"),dr=rr("activated"),hr=rr("deactivated"),pr=rr("serverPrefetch"),fr=rr("renderTracked"),mr=rr("renderTriggered"),gr=rr("errorCaptured");function br(t,e){void 0===e&&(e=gt),gr(t,e)}var yr="2.7.16";function vr(t){return t}var xr=new ft;function wr(t){return kr(t,xr),xr.clear(),t}function kr(t,e){var n,r,i=a(t);if(!(!i&&!d(t)||t.__v_skip||Object.isFrozen(t)||t instanceof vt)){if(t.__ob__){var o=t.__ob__.dep.id;if(e.has(o))return;e.add(o)}if(i){n=t.length;while(n--)kr(t[n],e)}else if(te(t))kr(t.value,e);else{r=Object.keys(t),n=r.length;while(n--)kr(t[r[n]],e)}}}var Sr,Or=0,_r=function(){function t(t,e,n,r,a){Ae(this,_e&&!_e._vm?_e:t?t._scope:void 0),(this.vm=t)&&a&&(t._watcher=this),r?(this.deep=!!r.deep,this.user=!!r.user,this.lazy=!!r.lazy,this.sync=!!r.sync,this.before=r.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++Or,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new ft,this.newDepIds=new ft,this.expression="",l(e)?this.getter=e:(this.getter=Z(e),this.getter||(this.getter=P)),this.value=this.lazy?void 0:this.get()}return t.prototype.get=function(){var t;It(this);var e=this.vm;try{t=this.getter.call(e,e)}catch(iu){if(!this.user)throw iu;Bn(iu,e,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&wr(t),Nt(),this.cleanupDeps()}return t},t.prototype.addDep=function(t){var e=t.id;this.newDepIds.has(e)||(this.newDepIds.add(e),this.newDeps.push(t),this.depIds.has(e)||t.addSub(this))},t.prototype.cleanupDeps=function(){var t=this.deps.length;while(t--){var e=this.deps[t];this.newDepIds.has(e.id)||e.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},t.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():ra(this)},t.prototype.run=function(){if(this.active){var t=this.get();if(t!==this.value||d(t)||this.deep){var e=this.value;if(this.value=t,this.user){var n='callback for watcher "'.concat(this.expression,'"');zn(this.cb,this.vm,[t,e],this.vm,n)}else this.cb.call(this.vm,t,e)}}},t.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},t.prototype.depend=function(){var t=this.deps.length;while(t--)this.deps[t].depend()},t.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&k(this.vm._scope.effects,this),this.active){var t=this.deps.length;while(t--)this.deps[t].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},t}();function Cr(t){t._events=Object.create(null),t._hasHookEvent=!1;var e=t.$options._parentListeners;e&&Er(t,e)}function Tr(t,e){Sr.$on(t,e)}function Ir(t,e){Sr.$off(t,e)}function Nr(t,e){var n=Sr;return function r(){var a=e.apply(null,arguments);null!==a&&n.$off(t,r)}}function Er(t,e,n){Sr=t,Le(e,n||{},Tr,Ir,Nr,t),Sr=void 0}function Ar(t){var e=/^hook:/;t.prototype.$on=function(t,n){var r=this;if(a(t))for(var i=0,o=t.length;i<o;i++)r.$on(t[i],n);else(r._events[t]||(r._events[t]=[])).push(n),e.test(t)&&(r._hasHookEvent=!0);return r},t.prototype.$once=function(t,e){var n=this;function r(){n.$off(t,r),e.apply(n,arguments)}return r.fn=e,n.$on(t,r),n},t.prototype.$off=function(t,e){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(a(t)){for(var r=0,i=t.length;r<i;r++)n.$off(t[r],e);return n}var o,s=n._events[t];if(!s)return n;if(!e)return n._events[t]=null,n;var u=s.length;while(u--)if(o=s[u],o===e||o.fn===e){s.splice(u,1);break}return n},t.prototype.$emit=function(t){var e=this,n=e._events[t];if(n){n=n.length>1?D(n):n;for(var r=D(arguments,1),a='event handler for "'.concat(t,'"'),i=0,o=n.length;i<o;i++)zn(n[i],e,r,e,a)}return e}}var Rr=null;function jr(t){var e=Rr;return Rr=t,function(){Rr=e}}function Dr(t){var e=t.$options,n=e.parent;if(n&&!e.abstract){while(n.$options.abstract&&n.$parent)n=n.$parent;n.$children.push(t)}t.$parent=n,t.$root=n?n.$root:t,t.$children=[],t.$refs={},t._provided=n?n._provided:Object.create(null),t._watcher=null,t._inactive=null,t._directInactive=!1,t._isMounted=!1,t._isDestroyed=!1,t._isBeingDestroyed=!1}function Fr(t){t.prototype._update=function(t,e){var n=this,r=n.$el,a=n._vnode,i=jr(n);n._vnode=t,n.$el=a?n.__patch__(a,t):n.__patch__(n.$el,t,e,!1),i(),r&&(r.__vue__=null),n.$el&&(n.$el.__vue__=n);var o=n;while(o&&o.$vnode&&o.$parent&&o.$vnode===o.$parent._vnode)o.$parent.$el=o.$el,o=o.$parent},t.prototype.$forceUpdate=function(){var t=this;t._watcher&&t._watcher.update()},t.prototype.$destroy=function(){var t=this;if(!t._isBeingDestroyed){zr(t,"beforeDestroy"),t._isBeingDestroyed=!0;var e=t.$parent;!e||e._isBeingDestroyed||t.$options.abstract||k(e.$children,t),t._scope.stop(),t._data.__ob__&&t._data.__ob__.vmCount--,t._isDestroyed=!0,t.__patch__(t._vnode,null),zr(t,"destroyed"),t.$off(),t.$el&&(t.$el.__vue__=null),t.$vnode&&(t.$vnode.parent=null)}}}function Mr(t,e,n){var r;t.$el=e,t.$options.render||(t.$options.render=xt),zr(t,"beforeMount"),r=function(){t._update(t._render(),n)};var a={before:function(){t._isMounted&&!t._isDestroyed&&zr(t,"beforeUpdate")}};new _r(t,r,P,a,!0),n=!1;var i=t._preWatchers;if(i)for(var o=0;o<i.length;o++)i[o].run();return null==t.$vnode&&(t._isMounted=!0,zr(t,"mounted")),t}function Pr(t,e,n,a,i){var o=a.data.scopedSlots,s=t.$scopedSlots,u=!!(o&&!o.$stable||s!==r&&!s.$stable||o&&t.$scopedSlots.$key!==o.$key||!o&&t.$scopedSlots.$key),c=!!(i||t.$options._renderChildren||u),l=t.$vnode;t.$options._parentVnode=a,t.$vnode=a,t._vnode&&(t._vnode.parent=a),t.$options._renderChildren=i;var d=a.data.attrs||r;t._attrsProxy&&bn(t._attrsProxy,d,l.data&&l.data.attrs||r,t,"$attrs")&&(c=!0),t.$attrs=d,n=n||r;var h=t.$options._parentListeners;if(t._listenersProxy&&bn(t._listenersProxy,n,h||r,t,"$listeners"),t.$listeners=t.$options._parentListeners=n,Er(t,n,h),e&&t.$options.props){Mt(!1);for(var p=t._props,f=t.$options._propKeys||[],m=0;m<f.length;m++){var g=f[m],b=t.$options.props;p[g]=Ra(g,b,e,t)}Mt(!0),t.$options.propsData=e}c&&(t.$slots=cn(i,a.context),t.$forceUpdate())}function $r(t){while(t&&(t=t.$parent))if(t._inactive)return!0;return!1}function Lr(t,e){if(e){if(t._directInactive=!1,$r(t))return}else if(t._directInactive)return;if(t._inactive||null===t._inactive){t._inactive=!1;for(var n=0;n<t.$children.length;n++)Lr(t.$children[n]);zr(t,"activated")}}function Br(t,e){if((!e||(t._directInactive=!0,!$r(t)))&&!t._inactive){t._inactive=!0;for(var n=0;n<t.$children.length;n++)Br(t.$children[n]);zr(t,"deactivated")}}function zr(t,e,n,r){void 0===r&&(r=!0),It();var a=gt,i=Re();r&&yt(t);var o=t.$options[e],s="".concat(e," hook");if(o)for(var u=0,c=o.length;u<c;u++)zn(o[u],t,n||null,t,s);t._hasHookEvent&&t.$emit("hook:"+e),r&&(yt(a),i&&i.on()),Nt()}var Wr=[],Vr=[],Ur={},Gr=!1,Hr=!1,qr=0;function Kr(){qr=Wr.length=Vr.length=0,Ur={},Gr=Hr=!1}var Xr=0,Yr=Date.now;if(tt&&!nt){var Jr=window.performance;Jr&&"function"===typeof Jr.now&&Yr()>document.createEvent("Event").timeStamp&&(Yr=function(){return Jr.now()})}var Zr=function(t,e){if(t.post){if(!e.post)return 1}else if(e.post)return-1;return t.id-e.id};function Qr(){var t,e;for(Xr=Yr(),Hr=!0,Wr.sort(Zr),qr=0;qr<Wr.length;qr++)t=Wr[qr],t.before&&t.before(),e=t.id,Ur[e]=null,t.run();var n=Vr.slice(),r=Wr.slice();Kr(),na(n),ta(r),_t(),ht&&q.devtools&&ht.emit("flush")}function ta(t){var e=t.length;while(e--){var n=t[e],r=n.vm;r&&r._watcher===n&&r._isMounted&&!r._isDestroyed&&zr(r,"updated")}}function ea(t){t._inactive=!1,Vr.push(t)}function na(t){for(var e=0;e<t.length;e++)t[e]._inactive=!0,Lr(t[e],!0)}function ra(t){var e=t.id;if(null==Ur[e]&&(t!==Ct.target||!t.noRecurse)){if(Ur[e]=!0,Hr){var n=Wr.length-1;while(n>qr&&Wr[n].id>t.id)n--;Wr.splice(n+1,0,t)}else Wr.push(t);Gr||(Gr=!0,Qn(Qr))}}function aa(t){var e=t.$options.provide;if(e){var n=l(e)?e.call(t):e;if(!d(n))return;for(var r=Fe(t),a=mt?Reflect.ownKeys(n):Object.keys(n),i=0;i<a.length;i++){var o=a[i];Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(n,o))}}}function ia(t){var e=oa(t.$options.inject,t);e&&(Mt(!1),Object.keys(e).forEach((function(n){Bt(t,n,e[n])})),Mt(!0))}function oa(t,e){if(t){for(var n=Object.create(null),r=mt?Reflect.ownKeys(t):Object.keys(t),a=0;a<r.length;a++){var i=r[a];if("__ob__"!==i){var o=t[i].from;if(o in e._provided)n[i]=e._provided[o];else if("default"in t[i]){var s=t[i].default;n[i]=l(s)?s.call(e):s}else 0}}return n}}function sa(t,e,n,i,o){var u,c=this,l=o.options;O(i,"_uid")?(u=Object.create(i),u._original=i):(u=i,i=i._original);var d=s(l._compiled),h=!d;this.data=t,this.props=e,this.children=n,this.parent=i,this.listeners=t.on||r,this.injections=oa(l.inject,i),this.slots=function(){return c.$slots||hn(i,t.scopedSlots,c.$slots=cn(n,i)),c.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return hn(i,t.scopedSlots,this.slots())}}),d&&(this.$options=l,this.$slots=this.slots(),this.$scopedSlots=hn(i,t.scopedSlots,this.$slots)),l._scopeId?this._c=function(t,e,n,r){var o=Fn(u,t,e,n,r,h);return o&&!a(o)&&(o.fnScopeId=l._scopeId,o.fnContext=i),o}:this._c=function(t,e,n,r){return Fn(u,t,e,n,r,h)}}function ua(t,e,n,i,s){var u=t.options,c={},l=u.props;if(o(l))for(var d in l)c[d]=Ra(d,l,e||r);else o(n.attrs)&&la(c,n.attrs),o(n.props)&&la(c,n.props);var h=new sa(n,c,s,i,t),p=u.render.call(null,h._c,h);if(p instanceof vt)return ca(p,n,h.parent,u,h);if(a(p)){for(var f=Ue(p)||[],m=new Array(f.length),g=0;g<f.length;g++)m[g]=ca(f[g],n,h.parent,u,h);return m}}function ca(t,e,n,r,a){var i=kt(t);return i.fnContext=n,i.fnOptions=r,e.slot&&((i.data||(i.data={})).slot=e.slot),i}function la(t,e){for(var n in e)t[T(n)]=e[n]}function da(t){return t.name||t.__name||t._componentTag}un(sa.prototype);var ha={init:function(t,e){if(t.componentInstance&&!t.componentInstance._isDestroyed&&t.data.keepAlive){var n=t;ha.prepatch(n,n)}else{var r=t.componentInstance=ma(t,Rr);r.$mount(e?t.elm:void 0,e)}},prepatch:function(t,e){var n=e.componentOptions,r=e.componentInstance=t.componentInstance;Pr(r,n.propsData,n.listeners,e,n.children)},insert:function(t){var e=t.context,n=t.componentInstance;n._isMounted||(n._isMounted=!0,zr(n,"mounted")),t.data.keepAlive&&(e._isMounted?ea(n):Lr(n,!0))},destroy:function(t){var e=t.componentInstance;e._isDestroyed||(t.data.keepAlive?Br(e,!0):e.$destroy())}},pa=Object.keys(ha);function fa(t,e,n,r,a){if(!i(t)){var u=n.$options._base;if(d(t)&&(t=u.extend(t)),"function"===typeof t){var c;if(i(t.cid)&&(c=t,t=An(c,u),void 0===t))return En(c,e,n,r,a);e=e||{},ni(t),o(e.model)&&ya(t.options,e);var l=ze(e,t,a);if(s(t.options.functional))return ua(t,l,e,n,r);var h=e.on;if(e.on=e.nativeOn,s(t.options.abstract)){var p=e.slot;e={},p&&(e.slot=p)}ga(e);var f=da(t.options)||a,m=new vt("vue-component-".concat(t.cid).concat(f?"-".concat(f):""),e,void 0,void 0,void 0,n,{Ctor:t,propsData:l,listeners:h,tag:a,children:r},c);return m}}}function ma(t,e){var n={_isComponent:!0,_parentVnode:t,parent:e},r=t.data.inlineTemplate;return o(r)&&(n.render=r.render,n.staticRenderFns=r.staticRenderFns),new t.componentOptions.Ctor(n)}function ga(t){for(var e=t.hook||(t.hook={}),n=0;n<pa.length;n++){var r=pa[n],a=e[r],i=ha[r];a===i||a&&a._merged||(e[r]=a?ba(i,a):i)}}function ba(t,e){var n=function(n,r){t(n,r),e(n,r)};return n._merged=!0,n}function ya(t,e){var n=t.model&&t.model.prop||"value",r=t.model&&t.model.event||"input";(e.attrs||(e.attrs={}))[n]=e.model.value;var i=e.on||(e.on={}),s=i[r],u=e.model.callback;o(s)?(a(s)?-1===s.indexOf(u):s!==u)&&(i[r]=[u].concat(s)):i[r]=u}var va=P,xa=q.optionMergeStrategies;function wa(t,e,n){if(void 0===n&&(n=!0),!e)return t;for(var r,a,i,o=mt?Reflect.ownKeys(e):Object.keys(e),s=0;s<o.length;s++)r=o[s],"__ob__"!==r&&(a=t[r],i=e[r],n&&O(t,r)?a!==i&&p(a)&&p(i)&&wa(a,i):zt(t,r,i));return t}function ka(t,e,n){return n?function(){var r=l(e)?e.call(n,n):e,a=l(t)?t.call(n,n):t;return r?wa(r,a):a}:e?t?function(){return wa(l(e)?e.call(this,this):e,l(t)?t.call(this,this):t)}:e:t}function Sa(t,e){var n=e?t?t.concat(e):a(e)?e:[e]:t;return n?Oa(n):n}function Oa(t){for(var e=[],n=0;n<t.length;n++)-1===e.indexOf(t[n])&&e.push(t[n]);return e}function _a(t,e,n,r){var a=Object.create(t||null);return e?F(a,e):a}xa.data=function(t,e,n){return n?ka(t,e,n):e&&"function"!==typeof e?t:ka(t,e)},H.forEach((function(t){xa[t]=Sa})),G.forEach((function(t){xa[t+"s"]=_a})),xa.watch=function(t,e,n,r){if(t===ut&&(t=void 0),e===ut&&(e=void 0),!e)return Object.create(t||null);if(!t)return e;var i={};for(var o in F(i,t),e){var s=i[o],u=e[o];s&&!a(s)&&(s=[s]),i[o]=s?s.concat(u):a(u)?u:[u]}return i},xa.props=xa.methods=xa.inject=xa.computed=function(t,e,n,r){if(!t)return e;var a=Object.create(null);return F(a,t),e&&F(a,e),a},xa.provide=function(t,e){return t?function(){var n=Object.create(null);return wa(n,l(t)?t.call(this):t),e&&wa(n,l(e)?e.call(this):e,!1),n}:e};var Ca=function(t,e){return void 0===e?t:e};function Ta(t,e){var n=t.props;if(n){var r,i,o,s={};if(a(n)){r=n.length;while(r--)i=n[r],"string"===typeof i&&(o=T(i),s[o]={type:null})}else if(p(n))for(var u in n)i=n[u],o=T(u),s[o]=p(i)?i:{type:i};else 0;t.props=s}}function Ia(t,e){var n=t.inject;if(n){var r=t.inject={};if(a(n))for(var i=0;i<n.length;i++)r[n[i]]={from:n[i]};else if(p(n))for(var o in n){var s=n[o];r[o]=p(s)?F({from:o},s):{from:s}}else 0}}function Na(t){var e=t.directives;if(e)for(var n in e){var r=e[n];l(r)&&(e[n]={bind:r,update:r})}}function Ea(t,e,n){if(l(e)&&(e=e.options),Ta(e,n),Ia(e,n),Na(e),!e._base&&(e.extends&&(t=Ea(t,e.extends,n)),e.mixins))for(var r=0,a=e.mixins.length;r<a;r++)t=Ea(t,e.mixins[r],n);var i,o={};for(i in t)s(i);for(i in e)O(t,i)||s(i);function s(r){var a=xa[r]||Ca;o[r]=a(t[r],e[r],n,r)}return o}function Aa(t,e,n,r){if("string"===typeof n){var a=t[e];if(O(a,n))return a[n];var i=T(n);if(O(a,i))return a[i];var o=I(i);if(O(a,o))return a[o];var s=a[n]||a[i]||a[o];return s}}function Ra(t,e,n,r){var a=e[t],i=!O(n,t),o=n[t],s=Pa(Boolean,a.type);if(s>-1)if(i&&!O(a,"default"))o=!1;else if(""===o||o===E(t)){var u=Pa(String,a.type);(u<0||s<u)&&(o=!0)}if(void 0===o){o=ja(r,a,t);var c=Ft;Mt(!0),Lt(o),Mt(c)}return o}function ja(t,e,n){if(O(e,"default")){var r=e.default;return t&&t.$options.propsData&&void 0===t.$options.propsData[n]&&void 0!==t._props[n]?t._props[n]:l(r)&&"Function"!==Fa(e.type)?r.call(t):r}}var Da=/^\s*function (\w+)/;function Fa(t){var e=t&&t.toString().match(Da);return e?e[1]:""}function Ma(t,e){return Fa(t)===Fa(e)}function Pa(t,e){if(!a(e))return Ma(e,t)?0:-1;for(var n=0,r=e.length;n<r;n++)if(Ma(e[n],t))return n;return-1}var $a={enumerable:!0,configurable:!0,get:P,set:P};function La(t,e,n){$a.get=function(){return this[e][n]},$a.set=function(t){this[e][n]=t},Object.defineProperty(t,n,$a)}function Ba(t){var e=t.$options;if(e.props&&za(t,e.props),mn(t),e.methods&&Xa(t,e.methods),e.data)Wa(t);else{var n=Lt(t._data={});n&&n.vmCount++}e.computed&&Ga(t,e.computed),e.watch&&e.watch!==ut&&Ya(t,e.watch)}function za(t,e){var n=t.$options.propsData||{},r=t._props=Gt({}),a=t.$options._propKeys=[],i=!t.$parent;i||Mt(!1);var o=function(i){a.push(i);var o=Ra(i,e,n,t);Bt(r,i,o,void 0,!0),i in t||La(t,"_props",i)};for(var s in e)o(s);Mt(!0)}function Wa(t){var e=t.$options.data;e=t._data=l(e)?Va(e,t):e||{},p(e)||(e={});var n=Object.keys(e),r=t.$options.props,a=(t.$options.methods,n.length);while(a--){var i=n[a];0,r&&O(r,i)||X(i)||La(t,"_data",i)}var o=Lt(e);o&&o.vmCount++}function Va(t,e){It();try{return t.call(e,e)}catch(iu){return Bn(iu,e,"data()"),{}}finally{Nt()}}var Ua={lazy:!0};function Ga(t,e){var n=t._computedWatchers=Object.create(null),r=dt();for(var a in e){var i=e[a],o=l(i)?i:i.get;0,r||(n[a]=new _r(t,o||P,P,Ua)),a in t||Ha(t,a,i)}}function Ha(t,e,n){var r=!dt();l(n)?($a.get=r?qa(e):Ka(n),$a.set=P):($a.get=n.get?r&&!1!==n.cache?qa(e):Ka(n.get):P,$a.set=n.set||P),Object.defineProperty(t,e,$a)}function qa(t){return function(){var e=this._computedWatchers&&this._computedWatchers[t];if(e)return e.dirty&&e.evaluate(),Ct.target&&e.depend(),e.value}}function Ka(t){return function(){return t.call(this,this)}}function Xa(t,e){t.$options.props;for(var n in e)t[n]="function"!==typeof e[n]?P:j(e[n],t)}function Ya(t,e){for(var n in e){var r=e[n];if(a(r))for(var i=0;i<r.length;i++)Ja(t,n,r[i]);else Ja(t,n,r)}}function Ja(t,e,n,r){return p(n)&&(r=n,n=n.handler),"string"===typeof n&&(n=t[n]),t.$watch(e,n,r)}function Za(t){var e={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(t.prototype,"$data",e),Object.defineProperty(t.prototype,"$props",n),t.prototype.$set=zt,t.prototype.$delete=Wt,t.prototype.$watch=function(t,e,n){var r=this;if(p(e))return Ja(r,t,e,n);n=n||{},n.user=!0;var a=new _r(r,t,e,n);if(n.immediate){var i='callback for immediate watcher "'.concat(a.expression,'"');It(),zn(e,r,[a.value],r,i),Nt()}return function(){a.teardown()}}}var Qa=0;function ti(t){t.prototype._init=function(t){var e=this;e._uid=Qa++,e._isVue=!0,e.__v_skip=!0,e._scope=new Ne(!0),e._scope.parent=void 0,e._scope._vm=!0,t&&t._isComponent?ei(e,t):e.$options=Ea(ni(e.constructor),t||{},e),e._renderProxy=e,e._self=e,Dr(e),Cr(e),Cn(e),zr(e,"beforeCreate",void 0,!1),ia(e),Ba(e),aa(e),zr(e,"created"),e.$options.el&&e.$mount(e.$options.el)}}function ei(t,e){var n=t.$options=Object.create(t.constructor.options),r=e._parentVnode;n.parent=e.parent,n._parentVnode=r;var a=r.componentOptions;n.propsData=a.propsData,n._parentListeners=a.listeners,n._renderChildren=a.children,n._componentTag=a.tag,e.render&&(n.render=e.render,n.staticRenderFns=e.staticRenderFns)}function ni(t){var e=t.options;if(t.super){var n=ni(t.super),r=t.superOptions;if(n!==r){t.superOptions=n;var a=ri(t);a&&F(t.extendOptions,a),e=t.options=Ea(n,t.extendOptions),e.name&&(e.components[e.name]=t)}}return e}function ri(t){var e,n=t.options,r=t.sealedOptions;for(var a in n)n[a]!==r[a]&&(e||(e={}),e[a]=n[a]);return e}function ai(t){this._init(t)}function ii(t){t.use=function(t){var e=this._installedPlugins||(this._installedPlugins=[]);if(e.indexOf(t)>-1)return this;var n=D(arguments,1);return n.unshift(this),l(t.install)?t.install.apply(t,n):l(t)&&t.apply(null,n),e.push(t),this}}function oi(t){t.mixin=function(t){return this.options=Ea(this.options,t),this}}function si(t){t.cid=0;var e=1;t.extend=function(t){t=t||{};var n=this,r=n.cid,a=t._Ctor||(t._Ctor={});if(a[r])return a[r];var i=da(t)||da(n.options);var o=function(t){this._init(t)};return o.prototype=Object.create(n.prototype),o.prototype.constructor=o,o.cid=e++,o.options=Ea(n.options,t),o["super"]=n,o.options.props&&ui(o),o.options.computed&&ci(o),o.extend=n.extend,o.mixin=n.mixin,o.use=n.use,G.forEach((function(t){o[t]=n[t]})),i&&(o.options.components[i]=o),o.superOptions=n.options,o.extendOptions=t,o.sealedOptions=F({},o.options),a[r]=o,o}}function ui(t){var e=t.options.props;for(var n in e)La(t.prototype,"_props",n)}function ci(t){var e=t.options.computed;for(var n in e)Ha(t.prototype,n,e[n])}function li(t){G.forEach((function(e){t[e]=function(t,n){return n?("component"===e&&p(n)&&(n.name=n.name||t,n=this.options._base.extend(n)),"directive"===e&&l(n)&&(n={bind:n,update:n}),this.options[e+"s"][t]=n,n):this.options[e+"s"][t]}}))}function di(t){return t&&(da(t.Ctor.options)||t.tag)}function hi(t,e){return a(t)?t.indexOf(e)>-1:"string"===typeof t?t.split(",").indexOf(e)>-1:!!f(t)&&t.test(e)}function pi(t,e){var n=t.cache,r=t.keys,a=t._vnode,i=t.$vnode;for(var o in n){var s=n[o];if(s){var u=s.name;u&&!e(u)&&fi(n,o,r,a)}}i.componentOptions.children=void 0}function fi(t,e,n,r){var a=t[e];!a||r&&a.tag===r.tag||a.componentInstance.$destroy(),t[e]=null,k(n,e)}ti(ai),Za(ai),Ar(ai),Fr(ai),In(ai);var mi=[String,RegExp,Array],gi={name:"keep-alive",abstract:!0,props:{include:mi,exclude:mi,max:[String,Number]},methods:{cacheVNode:function(){var t=this,e=t.cache,n=t.keys,r=t.vnodeToCache,a=t.keyToCache;if(r){var i=r.tag,o=r.componentInstance,s=r.componentOptions;e[a]={name:di(s),tag:i,componentInstance:o},n.push(a),this.max&&n.length>parseInt(this.max)&&fi(e,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var t in this.cache)fi(this.cache,t,this.keys)},mounted:function(){var t=this;this.cacheVNode(),this.$watch("include",(function(e){pi(t,(function(t){return hi(e,t)}))})),this.$watch("exclude",(function(e){pi(t,(function(t){return!hi(e,t)}))}))},updated:function(){this.cacheVNode()},render:function(){var t=this.$slots.default,e=Rn(t),n=e&&e.componentOptions;if(n){var r=di(n),a=this,i=a.include,o=a.exclude;if(i&&(!r||!hi(i,r))||o&&r&&hi(o,r))return e;var s=this,u=s.cache,c=s.keys,l=null==e.key?n.Ctor.cid+(n.tag?"::".concat(n.tag):""):e.key;u[l]?(e.componentInstance=u[l].componentInstance,k(c,l),c.push(l)):(this.vnodeToCache=e,this.keyToCache=l),e.data.keepAlive=!0}return e||t&&t[0]}},bi={KeepAlive:gi};function yi(t){var e={get:function(){return q}};Object.defineProperty(t,"config",e),t.util={warn:va,extend:F,mergeOptions:Ea,defineReactive:Bt},t.set=zt,t.delete=Wt,t.nextTick=Qn,t.observable=function(t){return Lt(t),t},t.options=Object.create(null),G.forEach((function(e){t.options[e+"s"]=Object.create(null)})),t.options._base=t,F(t.options.components,bi),ii(t),oi(t),si(t),li(t)}yi(ai),Object.defineProperty(ai.prototype,"$isServer",{get:dt}),Object.defineProperty(ai.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(ai,"FunctionalRenderContext",{value:sa}),ai.version=yr;var vi=x("style,class"),xi=x("input,textarea,option,select,progress"),wi=function(t,e,n){return"value"===n&&xi(t)&&"button"!==e||"selected"===n&&"option"===t||"checked"===n&&"input"===t||"muted"===n&&"video"===t},ki=x("contenteditable,draggable,spellcheck"),Si=x("events,caret,typing,plaintext-only"),Oi=function(t,e){return Ni(e)||"false"===e?"false":"contenteditable"===t&&Si(e)?e:"true"},_i=x("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),Ci="http://www.w3.org/1999/xlink",Ti=function(t){return":"===t.charAt(5)&&"xlink"===t.slice(0,5)},Ii=function(t){return Ti(t)?t.slice(6,t.length):""},Ni=function(t){return null==t||!1===t};function Ei(t){var e=t.data,n=t,r=t;while(o(r.componentInstance))r=r.componentInstance._vnode,r&&r.data&&(e=Ai(r.data,e));while(o(n=n.parent))n&&n.data&&(e=Ai(e,n.data));return Ri(e.staticClass,e.class)}function Ai(t,e){return{staticClass:ji(t.staticClass,e.staticClass),class:o(t.class)?[t.class,e.class]:e.class}}function Ri(t,e){return o(t)||o(e)?ji(t,Di(e)):""}function ji(t,e){return t?e?t+" "+e:t:e||""}function Di(t){return Array.isArray(t)?Fi(t):d(t)?Mi(t):"string"===typeof t?t:""}function Fi(t){for(var e,n="",r=0,a=t.length;r<a;r++)o(e=Di(t[r]))&&""!==e&&(n&&(n+=" "),n+=e);return n}function Mi(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}var Pi={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},$i=x("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Li=x("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Bi=function(t){return $i(t)||Li(t)};function zi(t){return Li(t)?"svg":"math"===t?"math":void 0}var Wi=Object.create(null);function Vi(t){if(!tt)return!0;if(Bi(t))return!1;if(t=t.toLowerCase(),null!=Wi[t])return Wi[t];var e=document.createElement(t);return t.indexOf("-")>-1?Wi[t]=e.constructor===window.HTMLUnknownElement||e.constructor===window.HTMLElement:Wi[t]=/HTMLUnknownElement/.test(e.toString())}var Ui=x("text,number,password,search,email,tel,url");function Gi(t){if("string"===typeof t){var e=document.querySelector(t);return e||document.createElement("div")}return t}function Hi(t,e){var n=document.createElement(t);return"select"!==t||e.data&&e.data.attrs&&void 0!==e.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n}function qi(t,e){return document.createElementNS(Pi[t],e)}function Ki(t){return document.createTextNode(t)}function Xi(t){return document.createComment(t)}function Yi(t,e,n){t.insertBefore(e,n)}function Ji(t,e){t.removeChild(e)}function Zi(t,e){t.appendChild(e)}function Qi(t){return t.parentNode}function to(t){return t.nextSibling}function eo(t){return t.tagName}function no(t,e){t.textContent=e}function ro(t,e){t.setAttribute(e,"")}var ao=Object.freeze({__proto__:null,createElement:Hi,createElementNS:qi,createTextNode:Ki,createComment:Xi,insertBefore:Yi,removeChild:Ji,appendChild:Zi,parentNode:Qi,nextSibling:to,tagName:eo,setTextContent:no,setStyleScope:ro}),io={create:function(t,e){oo(e)},update:function(t,e){t.data.ref!==e.data.ref&&(oo(t,!0),oo(e))},destroy:function(t){oo(t,!0)}};function oo(t,e){var n=t.data.ref;if(o(n)){var r=t.context,i=t.componentInstance||t.elm,s=e?null:i,u=e?void 0:i;if(l(n))zn(n,r,[s],r,"template ref function");else{var c=t.data.refInFor,d="string"===typeof n||"number"===typeof n,h=te(n),p=r.$refs;if(d||h)if(c){var f=d?p[n]:n.value;e?a(f)&&k(f,i):a(f)?f.includes(i)||f.push(i):d?(p[n]=[i],so(r,n,p[n])):n.value=[i]}else if(d){if(e&&p[n]!==i)return;p[n]=u,so(r,n,s)}else if(h){if(e&&n.value!==i)return;n.value=s}else 0}}}function so(t,e,n){var r=t._setupState;r&&O(r,e)&&(te(r[e])?r[e].value=n:r[e]=n)}var uo=new vt("",{},[]),co=["create","activate","update","remove","destroy"];function lo(t,e){return t.key===e.key&&t.asyncFactory===e.asyncFactory&&(t.tag===e.tag&&t.isComment===e.isComment&&o(t.data)===o(e.data)&&ho(t,e)||s(t.isAsyncPlaceholder)&&i(e.asyncFactory.error))}function ho(t,e){if("input"!==t.tag)return!0;var n,r=o(n=t.data)&&o(n=n.attrs)&&n.type,a=o(n=e.data)&&o(n=n.attrs)&&n.type;return r===a||Ui(r)&&Ui(a)}function po(t,e,n){var r,a,i={};for(r=e;r<=n;++r)a=t[r].key,o(a)&&(i[a]=r);return i}function fo(t){var e,n,r={},u=t.modules,l=t.nodeOps;for(e=0;e<co.length;++e)for(r[co[e]]=[],n=0;n<u.length;++n)o(u[n][co[e]])&&r[co[e]].push(u[n][co[e]]);function d(t){return new vt(l.tagName(t).toLowerCase(),{},[],void 0,t)}function h(t,e){function n(){0===--n.listeners&&p(t)}return n.listeners=e,n}function p(t){var e=l.parentNode(t);o(e)&&l.removeChild(e,t)}function f(t,e,n,r,a,i,u){if(o(t.elm)&&o(i)&&(t=i[u]=kt(t)),t.isRootInsert=!a,!m(t,e,n,r)){var c=t.data,d=t.children,h=t.tag;o(h)?(t.elm=t.ns?l.createElementNS(t.ns,h):l.createElement(h,t),S(t),v(t,d,e),o(c)&&k(t,e),y(n,t.elm,r)):s(t.isComment)?(t.elm=l.createComment(t.text),y(n,t.elm,r)):(t.elm=l.createTextNode(t.text),y(n,t.elm,r))}}function m(t,e,n,r){var a=t.data;if(o(a)){var i=o(t.componentInstance)&&a.keepAlive;if(o(a=a.hook)&&o(a=a.init)&&a(t,!1),o(t.componentInstance))return g(t,e),y(n,t.elm,r),s(i)&&b(t,e,n,r),!0}}function g(t,e){o(t.data.pendingInsert)&&(e.push.apply(e,t.data.pendingInsert),t.data.pendingInsert=null),t.elm=t.componentInstance.$el,w(t)?(k(t,e),S(t)):(oo(t),e.push(t))}function b(t,e,n,a){var i,s=t;while(s.componentInstance)if(s=s.componentInstance._vnode,o(i=s.data)&&o(i=i.transition)){for(i=0;i<r.activate.length;++i)r.activate[i](uo,s);e.push(s);break}y(n,t.elm,a)}function y(t,e,n){o(t)&&(o(n)?l.parentNode(n)===t&&l.insertBefore(t,e,n):l.appendChild(t,e))}function v(t,e,n){if(a(e)){0;for(var r=0;r<e.length;++r)f(e[r],n,t.elm,null,!0,e,r)}else c(t.text)&&l.appendChild(t.elm,l.createTextNode(String(t.text)))}function w(t){while(t.componentInstance)t=t.componentInstance._vnode;return o(t.tag)}function k(t,n){for(var a=0;a<r.create.length;++a)r.create[a](uo,t);e=t.data.hook,o(e)&&(o(e.create)&&e.create(uo,t),o(e.insert)&&n.push(t))}function S(t){var e;if(o(e=t.fnScopeId))l.setStyleScope(t.elm,e);else{var n=t;while(n)o(e=n.context)&&o(e=e.$options._scopeId)&&l.setStyleScope(t.elm,e),n=n.parent}o(e=Rr)&&e!==t.context&&e!==t.fnContext&&o(e=e.$options._scopeId)&&l.setStyleScope(t.elm,e)}function O(t,e,n,r,a,i){for(;r<=a;++r)f(n[r],i,t,e,!1,n,r)}function _(t){var e,n,a=t.data;if(o(a))for(o(e=a.hook)&&o(e=e.destroy)&&e(t),e=0;e<r.destroy.length;++e)r.destroy[e](t);if(o(e=t.children))for(n=0;n<t.children.length;++n)_(t.children[n])}function C(t,e,n){for(;e<=n;++e){var r=t[e];o(r)&&(o(r.tag)?(T(r),_(r)):p(r.elm))}}function T(t,e){if(o(e)||o(t.data)){var n,a=r.remove.length+1;for(o(e)?e.listeners+=a:e=h(t.elm,a),o(n=t.componentInstance)&&o(n=n._vnode)&&o(n.data)&&T(n,e),n=0;n<r.remove.length;++n)r.remove[n](t,e);o(n=t.data.hook)&&o(n=n.remove)?n(t,e):e()}else p(t.elm)}function I(t,e,n,r,a){var s,u,c,d,h=0,p=0,m=e.length-1,g=e[0],b=e[m],y=n.length-1,v=n[0],x=n[y],w=!a;while(h<=m&&p<=y)i(g)?g=e[++h]:i(b)?b=e[--m]:lo(g,v)?(E(g,v,r,n,p),g=e[++h],v=n[++p]):lo(b,x)?(E(b,x,r,n,y),b=e[--m],x=n[--y]):lo(g,x)?(E(g,x,r,n,y),w&&l.insertBefore(t,g.elm,l.nextSibling(b.elm)),g=e[++h],x=n[--y]):lo(b,v)?(E(b,v,r,n,p),w&&l.insertBefore(t,b.elm,g.elm),b=e[--m],v=n[++p]):(i(s)&&(s=po(e,h,m)),u=o(v.key)?s[v.key]:N(v,e,h,m),i(u)?f(v,r,t,g.elm,!1,n,p):(c=e[u],lo(c,v)?(E(c,v,r,n,p),e[u]=void 0,w&&l.insertBefore(t,c.elm,g.elm)):f(v,r,t,g.elm,!1,n,p)),v=n[++p]);h>m?(d=i(n[y+1])?null:n[y+1].elm,O(t,d,n,p,y,r)):p>y&&C(e,h,m)}function N(t,e,n,r){for(var a=n;a<r;a++){var i=e[a];if(o(i)&&lo(t,i))return a}}function E(t,e,n,a,u,c){if(t!==e){o(e.elm)&&o(a)&&(e=a[u]=kt(e));var d=e.elm=t.elm;if(s(t.isAsyncPlaceholder))o(e.asyncFactory.resolved)?j(t.elm,e,n):e.isAsyncPlaceholder=!0;else if(s(e.isStatic)&&s(t.isStatic)&&e.key===t.key&&(s(e.isCloned)||s(e.isOnce)))e.componentInstance=t.componentInstance;else{var h,p=e.data;o(p)&&o(h=p.hook)&&o(h=h.prepatch)&&h(t,e);var f=t.children,m=e.children;if(o(p)&&w(e)){for(h=0;h<r.update.length;++h)r.update[h](t,e);o(h=p.hook)&&o(h=h.update)&&h(t,e)}i(e.text)?o(f)&&o(m)?f!==m&&I(d,f,m,n,c):o(m)?(o(t.text)&&l.setTextContent(d,""),O(d,null,m,0,m.length-1,n)):o(f)?C(f,0,f.length-1):o(t.text)&&l.setTextContent(d,""):t.text!==e.text&&l.setTextContent(d,e.text),o(p)&&o(h=p.hook)&&o(h=h.postpatch)&&h(t,e)}}}function A(t,e,n){if(s(n)&&o(t.parent))t.parent.data.pendingInsert=e;else for(var r=0;r<e.length;++r)e[r].data.hook.insert(e[r])}var R=x("attrs,class,staticClass,staticStyle,key");function j(t,e,n,r){var a,i=e.tag,u=e.data,c=e.children;if(r=r||u&&u.pre,e.elm=t,s(e.isComment)&&o(e.asyncFactory))return e.isAsyncPlaceholder=!0,!0;if(o(u)&&(o(a=u.hook)&&o(a=a.init)&&a(e,!0),o(a=e.componentInstance)))return g(e,n),!0;if(o(i)){if(o(c))if(t.hasChildNodes())if(o(a=u)&&o(a=a.domProps)&&o(a=a.innerHTML)){if(a!==t.innerHTML)return!1}else{for(var l=!0,d=t.firstChild,h=0;h<c.length;h++){if(!d||!j(d,c[h],n,r)){l=!1;break}d=d.nextSibling}if(!l||d)return!1}else v(e,c,n);if(o(u)){var p=!1;for(var f in u)if(!R(f)){p=!0,k(e,n);break}!p&&u["class"]&&wr(u["class"])}}else t.data!==e.text&&(t.data=e.text);return!0}return function(t,e,n,a){if(!i(e)){var u=!1,c=[];if(i(t))u=!0,f(e,c);else{var h=o(t.nodeType);if(!h&&lo(t,e))E(t,e,c,null,null,a);else{if(h){if(1===t.nodeType&&t.hasAttribute(U)&&(t.removeAttribute(U),n=!0),s(n)&&j(t,e,c))return A(e,c,!0),t;t=d(t)}var p=t.elm,m=l.parentNode(p);if(f(e,c,p._leaveCb?null:m,l.nextSibling(p)),o(e.parent)){var g=e.parent,b=w(e);while(g){for(var y=0;y<r.destroy.length;++y)r.destroy[y](g);if(g.elm=e.elm,b){for(var v=0;v<r.create.length;++v)r.create[v](uo,g);var x=g.data.hook.insert;if(x.merged)for(var k=x.fns.slice(1),S=0;S<k.length;S++)k[S]()}else oo(g);g=g.parent}}o(m)?C([t],0,0):o(t.tag)&&_(t)}}return A(e,c,u),e.elm}o(t)&&_(t)}}var mo={create:go,update:go,destroy:function(t){go(t,uo)}};function go(t,e){(t.data.directives||e.data.directives)&&bo(t,e)}function bo(t,e){var n,r,a,i=t===uo,o=e===uo,s=vo(t.data.directives,t.context),u=vo(e.data.directives,e.context),c=[],l=[];for(n in u)r=s[n],a=u[n],r?(a.oldValue=r.value,a.oldArg=r.arg,wo(a,"update",e,t),a.def&&a.def.componentUpdated&&l.push(a)):(wo(a,"bind",e,t),a.def&&a.def.inserted&&c.push(a));if(c.length){var d=function(){for(var n=0;n<c.length;n++)wo(c[n],"inserted",e,t)};i?Be(e,"insert",d):d()}if(l.length&&Be(e,"postpatch",(function(){for(var n=0;n<l.length;n++)wo(l[n],"componentUpdated",e,t)})),!i)for(n in s)u[n]||wo(s[n],"unbind",t,t,o)}var yo=Object.create(null);function vo(t,e){var n,r,a=Object.create(null);if(!t)return a;for(n=0;n<t.length;n++){if(r=t[n],r.modifiers||(r.modifiers=yo),a[xo(r)]=r,e._setupState&&e._setupState.__sfc){var i=r.def||Aa(e,"_setupState","v-"+r.name);r.def="function"===typeof i?{bind:i,update:i}:i}r.def=r.def||Aa(e.$options,"directives",r.name,!0)}return a}function xo(t){return t.rawName||"".concat(t.name,".").concat(Object.keys(t.modifiers||{}).join("."))}function wo(t,e,n,r,a){var i=t.def&&t.def[e];if(i)try{i(n.elm,t,n,r,a)}catch(iu){Bn(iu,n.context,"directive ".concat(t.name," ").concat(e," hook"))}}var ko=[io,mo];function So(t,e){var n=e.componentOptions;if((!o(n)||!1!==n.Ctor.options.inheritAttrs)&&(!i(t.data.attrs)||!i(e.data.attrs))){var r,a,u,c=e.elm,l=t.data.attrs||{},d=e.data.attrs||{};for(r in(o(d.__ob__)||s(d._v_attr_proxy))&&(d=e.data.attrs=F({},d)),d)a=d[r],u=l[r],u!==a&&Oo(c,r,a,e.data.pre);for(r in(nt||at)&&d.value!==l.value&&Oo(c,"value",d.value),l)i(d[r])&&(Ti(r)?c.removeAttributeNS(Ci,Ii(r)):ki(r)||c.removeAttribute(r))}}function Oo(t,e,n,r){r||t.tagName.indexOf("-")>-1?_o(t,e,n):_i(e)?Ni(n)?t.removeAttribute(e):(n="allowfullscreen"===e&&"EMBED"===t.tagName?"true":e,t.setAttribute(e,n)):ki(e)?t.setAttribute(e,Oi(e,n)):Ti(e)?Ni(n)?t.removeAttributeNS(Ci,Ii(e)):t.setAttributeNS(Ci,e,n):_o(t,e,n)}function _o(t,e,n){if(Ni(n))t.removeAttribute(e);else{if(nt&&!rt&&"TEXTAREA"===t.tagName&&"placeholder"===e&&""!==n&&!t.__ieph){var r=function(e){e.stopImmediatePropagation(),t.removeEventListener("input",r)};t.addEventListener("input",r),t.__ieph=!0}t.setAttribute(e,n)}}var Co={create:So,update:So};function To(t,e){var n=e.elm,r=e.data,a=t.data;if(!(i(r.staticClass)&&i(r.class)&&(i(a)||i(a.staticClass)&&i(a.class)))){var s=Ei(e),u=n._transitionClasses;o(u)&&(s=ji(s,Di(u))),s!==n._prevClass&&(n.setAttribute("class",s),n._prevClass=s)}}var Io,No={create:To,update:To},Eo="__r",Ao="__c";function Ro(t){if(o(t[Eo])){var e=nt?"change":"input";t[e]=[].concat(t[Eo],t[e]||[]),delete t[Eo]}o(t[Ao])&&(t.change=[].concat(t[Ao],t.change||[]),delete t[Ao])}function jo(t,e,n){var r=Io;return function a(){var i=e.apply(null,arguments);null!==i&&Mo(t,a,n,r)}}var Do=Gn&&!(st&&Number(st[1])<=53);function Fo(t,e,n,r){if(Do){var a=Xr,i=e;e=i._wrapper=function(t){if(t.target===t.currentTarget||t.timeStamp>=a||t.timeStamp<=0||t.target.ownerDocument!==document)return i.apply(this,arguments)}}Io.addEventListener(t,e,ct?{capture:n,passive:r}:n)}function Mo(t,e,n,r){(r||Io).removeEventListener(t,e._wrapper||e,n)}function Po(t,e){if(!i(t.data.on)||!i(e.data.on)){var n=e.data.on||{},r=t.data.on||{};Io=e.elm||t.elm,Ro(n),Le(n,r,Fo,Mo,jo,e.context),Io=void 0}}var $o,Lo={create:Po,update:Po,destroy:function(t){return Po(t,uo)}};function Bo(t,e){if(!i(t.data.domProps)||!i(e.data.domProps)){var n,r,a=e.elm,u=t.data.domProps||{},c=e.data.domProps||{};for(n in(o(c.__ob__)||s(c._v_attr_proxy))&&(c=e.data.domProps=F({},c)),u)n in c||(a[n]="");for(n in c){if(r=c[n],"textContent"===n||"innerHTML"===n){if(e.children&&(e.children.length=0),r===u[n])continue;1===a.childNodes.length&&a.removeChild(a.childNodes[0])}if("value"===n&&"PROGRESS"!==a.tagName){a._value=r;var l=i(r)?"":String(r);zo(a,l)&&(a.value=l)}else if("innerHTML"===n&&Li(a.tagName)&&i(a.innerHTML)){$o=$o||document.createElement("div"),$o.innerHTML="<svg>".concat(r,"</svg>");var d=$o.firstChild;while(a.firstChild)a.removeChild(a.firstChild);while(d.firstChild)a.appendChild(d.firstChild)}else if(r!==u[n])try{a[n]=r}catch(iu){}}}}function zo(t,e){return!t.composing&&("OPTION"===t.tagName||Wo(t,e)||Vo(t,e))}function Wo(t,e){var n=!0;try{n=document.activeElement!==t}catch(iu){}return n&&t.value!==e}function Vo(t,e){var n=t.value,r=t._vModifiers;if(o(r)){if(r.number)return v(n)!==v(e);if(r.trim)return n.trim()!==e.trim()}return n!==e}var Uo={create:Bo,update:Bo},Go=_((function(t){var e={},n=/;(?![^(]*\))/g,r=/:(.+)/;return t.split(n).forEach((function(t){if(t){var n=t.split(r);n.length>1&&(e[n[0].trim()]=n[1].trim())}})),e}));function Ho(t){var e=qo(t.style);return t.staticStyle?F(t.staticStyle,e):e}function qo(t){return Array.isArray(t)?M(t):"string"===typeof t?Go(t):t}function Ko(t,e){var n,r={};if(e){var a=t;while(a.componentInstance)a=a.componentInstance._vnode,a&&a.data&&(n=Ho(a.data))&&F(r,n)}(n=Ho(t.data))&&F(r,n);var i=t;while(i=i.parent)i.data&&(n=Ho(i.data))&&F(r,n);return r}var Xo,Yo=/^--/,Jo=/\s*!important$/,Zo=function(t,e,n){if(Yo.test(e))t.style.setProperty(e,n);else if(Jo.test(n))t.style.setProperty(E(e),n.replace(Jo,""),"important");else{var r=ts(e);if(Array.isArray(n))for(var a=0,i=n.length;a<i;a++)t.style[r]=n[a];else t.style[r]=n}},Qo=["Webkit","Moz","ms"],ts=_((function(t){if(Xo=Xo||document.createElement("div").style,t=T(t),"filter"!==t&&t in Xo)return t;for(var e=t.charAt(0).toUpperCase()+t.slice(1),n=0;n<Qo.length;n++){var r=Qo[n]+e;if(r in Xo)return r}}));function es(t,e){var n=e.data,r=t.data;if(!(i(n.staticStyle)&&i(n.style)&&i(r.staticStyle)&&i(r.style))){var a,s,u=e.elm,c=r.staticStyle,l=r.normalizedStyle||r.style||{},d=c||l,h=qo(e.data.style)||{};e.data.normalizedStyle=o(h.__ob__)?F({},h):h;var p=Ko(e,!0);for(s in d)i(p[s])&&Zo(u,s,"");for(s in p)a=p[s],Zo(u,s,null==a?"":a)}}var ns={create:es,update:es},rs=/\s+/;function as(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(rs).forEach((function(e){return t.classList.add(e)})):t.classList.add(e);else{var n=" ".concat(t.getAttribute("class")||""," ");n.indexOf(" "+e+" ")<0&&t.setAttribute("class",(n+e).trim())}}function is(t,e){if(e&&(e=e.trim()))if(t.classList)e.indexOf(" ")>-1?e.split(rs).forEach((function(e){return t.classList.remove(e)})):t.classList.remove(e),t.classList.length||t.removeAttribute("class");else{var n=" ".concat(t.getAttribute("class")||""," "),r=" "+e+" ";while(n.indexOf(r)>=0)n=n.replace(r," ");n=n.trim(),n?t.setAttribute("class",n):t.removeAttribute("class")}}function os(t){if(t){if("object"===typeof t){var e={};return!1!==t.css&&F(e,ss(t.name||"v")),F(e,t),e}return"string"===typeof t?ss(t):void 0}}var ss=_((function(t){return{enterClass:"".concat(t,"-enter"),enterToClass:"".concat(t,"-enter-to"),enterActiveClass:"".concat(t,"-enter-active"),leaveClass:"".concat(t,"-leave"),leaveToClass:"".concat(t,"-leave-to"),leaveActiveClass:"".concat(t,"-leave-active")}})),us=tt&&!rt,cs="transition",ls="animation",ds="transition",hs="transitionend",ps="animation",fs="animationend";us&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(ds="WebkitTransition",hs="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(ps="WebkitAnimation",fs="webkitAnimationEnd"));var ms=tt?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(t){return t()};function gs(t){ms((function(){ms(t)}))}function bs(t,e){var n=t._transitionClasses||(t._transitionClasses=[]);n.indexOf(e)<0&&(n.push(e),as(t,e))}function ys(t,e){t._transitionClasses&&k(t._transitionClasses,e),is(t,e)}function vs(t,e,n){var r=ws(t,e),a=r.type,i=r.timeout,o=r.propCount;if(!a)return n();var s=a===cs?hs:fs,u=0,c=function(){t.removeEventListener(s,l),n()},l=function(e){e.target===t&&++u>=o&&c()};setTimeout((function(){u<o&&c()}),i+1),t.addEventListener(s,l)}var xs=/\b(transform|all)(,|$)/;function ws(t,e){var n,r=window.getComputedStyle(t),a=(r[ds+"Delay"]||"").split(", "),i=(r[ds+"Duration"]||"").split(", "),o=ks(a,i),s=(r[ps+"Delay"]||"").split(", "),u=(r[ps+"Duration"]||"").split(", "),c=ks(s,u),l=0,d=0;e===cs?o>0&&(n=cs,l=o,d=i.length):e===ls?c>0&&(n=ls,l=c,d=u.length):(l=Math.max(o,c),n=l>0?o>c?cs:ls:null,d=n?n===cs?i.length:u.length:0);var h=n===cs&&xs.test(r[ds+"Property"]);return{type:n,timeout:l,propCount:d,hasTransform:h}}function ks(t,e){while(t.length<e.length)t=t.concat(t);return Math.max.apply(null,e.map((function(e,n){return Ss(e)+Ss(t[n])})))}function Ss(t){return 1e3*Number(t.slice(0,-1).replace(",","."))}function Os(t,e){var n=t.elm;o(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var r=os(t.data.transition);if(!i(r)&&!o(n._enterCb)&&1===n.nodeType){var a=r.css,s=r.type,u=r.enterClass,c=r.enterToClass,h=r.enterActiveClass,p=r.appearClass,f=r.appearToClass,m=r.appearActiveClass,g=r.beforeEnter,b=r.enter,y=r.afterEnter,x=r.enterCancelled,w=r.beforeAppear,k=r.appear,S=r.afterAppear,O=r.appearCancelled,_=r.duration,C=Rr,T=Rr.$vnode;while(T&&T.parent)C=T.context,T=T.parent;var I=!C._isMounted||!t.isRootInsert;if(!I||k||""===k){var N=I&&p?p:u,E=I&&m?m:h,A=I&&f?f:c,R=I&&w||g,j=I&&l(k)?k:b,D=I&&S||y,F=I&&O||x,M=v(d(_)?_.enter:_);0;var P=!1!==a&&!rt,$=Ts(j),L=n._enterCb=W((function(){P&&(ys(n,A),ys(n,E)),L.cancelled?(P&&ys(n,N),F&&F(n)):D&&D(n),n._enterCb=null}));t.data.show||Be(t,"insert",(function(){var e=n.parentNode,r=e&&e._pending&&e._pending[t.key];r&&r.tag===t.tag&&r.elm._leaveCb&&r.elm._leaveCb(),j&&j(n,L)})),R&&R(n),P&&(bs(n,N),bs(n,E),gs((function(){ys(n,N),L.cancelled||(bs(n,A),$||(Cs(M)?setTimeout(L,M):vs(n,s,L)))}))),t.data.show&&(e&&e(),j&&j(n,L)),P||$||L()}}}function _s(t,e){var n=t.elm;o(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var r=os(t.data.transition);if(i(r)||1!==n.nodeType)return e();if(!o(n._leaveCb)){var a=r.css,s=r.type,u=r.leaveClass,c=r.leaveToClass,l=r.leaveActiveClass,h=r.beforeLeave,p=r.leave,f=r.afterLeave,m=r.leaveCancelled,g=r.delayLeave,b=r.duration,y=!1!==a&&!rt,x=Ts(p),w=v(d(b)?b.leave:b);0;var k=n._leaveCb=W((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[t.key]=null),y&&(ys(n,c),ys(n,l)),k.cancelled?(y&&ys(n,u),m&&m(n)):(e(),f&&f(n)),n._leaveCb=null}));g?g(S):S()}function S(){k.cancelled||(!t.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[t.key]=t),h&&h(n),y&&(bs(n,u),bs(n,l),gs((function(){ys(n,u),k.cancelled||(bs(n,c),x||(Cs(w)?setTimeout(k,w):vs(n,s,k)))}))),p&&p(n,k),y||x||k())}}function Cs(t){return"number"===typeof t&&!isNaN(t)}function Ts(t){if(i(t))return!1;var e=t.fns;return o(e)?Ts(Array.isArray(e)?e[0]:e):(t._length||t.length)>1}function Is(t,e){!0!==e.data.show&&Os(e)}var Ns=tt?{create:Is,activate:Is,remove:function(t,e){!0!==t.data.show?_s(t,e):e()}}:{},Es=[Co,No,Lo,Uo,ns,Ns],As=Es.concat(ko),Rs=fo({nodeOps:ao,modules:As});rt&&document.addEventListener("selectionchange",(function(){var t=document.activeElement;t&&t.vmodel&&Bs(t,"input")}));var js={inserted:function(t,e,n,r){"select"===n.tag?(r.elm&&!r.elm._vOptions?Be(n,"postpatch",(function(){js.componentUpdated(t,e,n)})):Ds(t,e,n.context),t._vOptions=[].map.call(t.options,Ps)):("textarea"===n.tag||Ui(t.type))&&(t._vModifiers=e.modifiers,e.modifiers.lazy||(t.addEventListener("compositionstart",$s),t.addEventListener("compositionend",Ls),t.addEventListener("change",Ls),rt&&(t.vmodel=!0)))},componentUpdated:function(t,e,n){if("select"===n.tag){Ds(t,e,n.context);var r=t._vOptions,a=t._vOptions=[].map.call(t.options,Ps);if(a.some((function(t,e){return!B(t,r[e])}))){var i=t.multiple?e.value.some((function(t){return Ms(t,a)})):e.value!==e.oldValue&&Ms(e.value,a);i&&Bs(t,"change")}}}};function Ds(t,e,n){Fs(t,e,n),(nt||at)&&setTimeout((function(){Fs(t,e,n)}),0)}function Fs(t,e,n){var r=e.value,a=t.multiple;if(!a||Array.isArray(r)){for(var i,o,s=0,u=t.options.length;s<u;s++)if(o=t.options[s],a)i=z(r,Ps(o))>-1,o.selected!==i&&(o.selected=i);else if(B(Ps(o),r))return void(t.selectedIndex!==s&&(t.selectedIndex=s));a||(t.selectedIndex=-1)}}function Ms(t,e){return e.every((function(e){return!B(e,t)}))}function Ps(t){return"_value"in t?t._value:t.value}function $s(t){t.target.composing=!0}function Ls(t){t.target.composing&&(t.target.composing=!1,Bs(t.target,"input"))}function Bs(t,e){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function zs(t){return!t.componentInstance||t.data&&t.data.transition?t:zs(t.componentInstance._vnode)}var Ws={bind:function(t,e,n){var r=e.value;n=zs(n);var a=n.data&&n.data.transition,i=t.__vOriginalDisplay="none"===t.style.display?"":t.style.display;r&&a?(n.data.show=!0,Os(n,(function(){t.style.display=i}))):t.style.display=r?i:"none"},update:function(t,e,n){var r=e.value,a=e.oldValue;if(!r!==!a){n=zs(n);var i=n.data&&n.data.transition;i?(n.data.show=!0,r?Os(n,(function(){t.style.display=t.__vOriginalDisplay})):_s(n,(function(){t.style.display="none"}))):t.style.display=r?t.__vOriginalDisplay:"none"}},unbind:function(t,e,n,r,a){a||(t.style.display=t.__vOriginalDisplay)}},Vs={model:js,show:Ws},Us={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Gs(t){var e=t&&t.componentOptions;return e&&e.Ctor.options.abstract?Gs(Rn(e.children)):t}function Hs(t){var e={},n=t.$options;for(var r in n.propsData)e[r]=t[r];var a=n._parentListeners;for(var r in a)e[T(r)]=a[r];return e}function qs(t,e){if(/\d-keep-alive$/.test(e.tag))return t("keep-alive",{props:e.componentOptions.propsData})}function Ks(t){while(t=t.parent)if(t.data.transition)return!0}function Xs(t,e){return e.key===t.key&&e.tag===t.tag}var Ys=function(t){return t.tag||dn(t)},Js=function(t){return"show"===t.name},Zs={name:"transition",props:Us,abstract:!0,render:function(t){var e=this,n=this.$slots.default;if(n&&(n=n.filter(Ys),n.length)){0;var r=this.mode;0;var a=n[0];if(Ks(this.$vnode))return a;var i=Gs(a);if(!i)return a;if(this._leaving)return qs(t,a);var o="__transition-".concat(this._uid,"-");i.key=null==i.key?i.isComment?o+"comment":o+i.tag:c(i.key)?0===String(i.key).indexOf(o)?i.key:o+i.key:i.key;var s=(i.data||(i.data={})).transition=Hs(this),u=this._vnode,l=Gs(u);if(i.data.directives&&i.data.directives.some(Js)&&(i.data.show=!0),l&&l.data&&!Xs(i,l)&&!dn(l)&&(!l.componentInstance||!l.componentInstance._vnode.isComment)){var d=l.data.transition=F({},s);if("out-in"===r)return this._leaving=!0,Be(d,"afterLeave",(function(){e._leaving=!1,e.$forceUpdate()})),qs(t,a);if("in-out"===r){if(dn(i))return u;var h,p=function(){h()};Be(s,"afterEnter",p),Be(s,"enterCancelled",p),Be(d,"delayLeave",(function(t){h=t}))}}return a}}},Qs=F({tag:String,moveClass:String},Us);delete Qs.mode;var tu={props:Qs,beforeMount:function(){var t=this,e=this._update;this._update=function(n,r){var a=jr(t);t.__patch__(t._vnode,t.kept,!1,!0),t._vnode=t.kept,a(),e.call(t,n,r)}},render:function(t){for(var e=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),r=this.prevChildren=this.children,a=this.$slots.default||[],i=this.children=[],o=Hs(this),s=0;s<a.length;s++){var u=a[s];if(u.tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))i.push(u),n[u.key]=u,(u.data||(u.data={})).transition=o;else;}if(r){var c=[],l=[];for(s=0;s<r.length;s++){u=r[s];u.data.transition=o,u.data.pos=u.elm.getBoundingClientRect(),n[u.key]?c.push(u):l.push(u)}this.kept=t(e,null,c),this.removed=l}return t(e,null,i)},updated:function(){var t=this.prevChildren,e=this.moveClass||(this.name||"v")+"-move";t.length&&this.hasMove(t[0].elm,e)&&(t.forEach(eu),t.forEach(nu),t.forEach(ru),this._reflow=document.body.offsetHeight,t.forEach((function(t){if(t.data.moved){var n=t.elm,r=n.style;bs(n,e),r.transform=r.WebkitTransform=r.transitionDuration="",n.addEventListener(hs,n._moveCb=function t(r){r&&r.target!==n||r&&!/transform$/.test(r.propertyName)||(n.removeEventListener(hs,t),n._moveCb=null,ys(n,e))})}})))},methods:{hasMove:function(t,e){if(!us)return!1;if(this._hasMove)return this._hasMove;var n=t.cloneNode();t._transitionClasses&&t._transitionClasses.forEach((function(t){is(n,t)})),as(n,e),n.style.display="none",this.$el.appendChild(n);var r=ws(n);return this.$el.removeChild(n),this._hasMove=r.hasTransform}}};function eu(t){t.elm._moveCb&&t.elm._moveCb(),t.elm._enterCb&&t.elm._enterCb()}function nu(t){t.data.newPos=t.elm.getBoundingClientRect()}function ru(t){var e=t.data.pos,n=t.data.newPos,r=e.left-n.left,a=e.top-n.top;if(r||a){t.data.moved=!0;var i=t.elm.style;i.transform=i.WebkitTransform="translate(".concat(r,"px,").concat(a,"px)"),i.transitionDuration="0s"}}var au={Transition:Zs,TransitionGroup:tu};ai.config.mustUseProp=wi,ai.config.isReservedTag=Bi,ai.config.isReservedAttr=vi,ai.config.getTagNamespace=zi,ai.config.isUnknownElement=Vi,F(ai.options.directives,Vs),F(ai.options.components,au),ai.prototype.__patch__=tt?Rs:P,ai.prototype.$mount=function(t,e){return t=t&&tt?Gi(t):void 0,Mr(this,t,e)},tt&&setTimeout((function(){q.devtools&&ht&&ht.emit("init",ai)}),0)}.call(this,n("c8ba"))},"2b26":function(t,e,n){"use strict";n("abee")},"2b3e":function(t,e,n){var r=n("585a"),a="object"==typeof self&&self&&self.Object===Object&&self,i=r||a||Function("return this")();t.exports=i},"2c63":function(t,e,n){t.exports=n("dc14")},"2ca8":function(t,e,n){"use strict";n.r(e),n.d(e,"AdadeltaOptimizer",(function(){return m["d"]})),n.d(e,"AdagradOptimizer",(function(){return m["e"]})),n.d(e,"AdamOptimizer",(function(){return m["f"]})),n.d(e,"AdamaxOptimizer",(function(){return m["g"]})),n.d(e,"MomentumOptimizer",(function(){return m["gc"]})),n.d(e,"Optimizer",(function(){return m["rc"]})),n.d(e,"OptimizerConstructors",(function(){return m["sc"]})),n.d(e,"RMSPropOptimizer",(function(){return m["zc"]})),n.d(e,"SGDOptimizer",(function(){return m["Tc"]})),n.d(e,"Tensor",(function(){return m["yd"]})),n.d(e,"TensorBuffer",(function(){return m["zd"]})),n.d(e,"Variable",(function(){return m["Id"]})),n.d(e,"Rank",(function(){return m["Dc"]})),n.d(e,"sumOutType",(function(){return m["hi"]})),n.d(e,"upcastType",(function(){return m["Fi"]})),n.d(e,"abs",(function(){return m["Ld"]})),n.d(e,"acos",(function(){return m["Md"]})),n.d(e,"acosh",(function(){return m["Nd"]})),n.d(e,"add",(function(){return m["Od"]})),n.d(e,"addN",(function(){return m["Pd"]})),n.d(e,"all",(function(){return m["Qd"]})),n.d(e,"any",(function(){return m["Rd"]})),n.d(e,"argMax",(function(){return m["Sd"]})),n.d(e,"argMin",(function(){return m["Td"]})),n.d(e,"asin",(function(){return m["Ud"]})),n.d(e,"asinh",(function(){return m["Vd"]})),n.d(e,"atan",(function(){return m["Wd"]})),n.d(e,"atan2",(function(){return m["Xd"]})),n.d(e,"atanh",(function(){return m["Yd"]})),n.d(e,"avgPool",(function(){return m["Zd"]})),n.d(e,"avgPool3d",(function(){return m["ae"]})),n.d(e,"basicLSTMCell",(function(){return m["de"]})),n.d(e,"batchToSpaceND",(function(){return m["ie"]})),n.d(e,"batchNorm",(function(){return m["ee"]})),n.d(e,"batchNorm2d",(function(){return m["fe"]})),n.d(e,"batchNorm3d",(function(){return m["ge"]})),n.d(e,"batchNorm4d",(function(){return m["he"]})),n.d(e,"bincount",(function(){return m["je"]})),n.d(e,"broadcastArgs",(function(){return m["le"]})),n.d(e,"broadcastTo",(function(){return m["me"]})),n.d(e,"buffer",(function(){return m["pe"]})),n.d(e,"cast",(function(){return m["qe"]})),n.d(e,"ceil",(function(){return m["re"]})),n.d(e,"clipByValue",(function(){return m["se"]})),n.d(e,"clone",(function(){return m["te"]})),n.d(e,"complex",(function(){return m["ue"]})),n.d(e,"concat",(function(){return m["ve"]})),n.d(e,"concat1d",(function(){return m["we"]})),n.d(e,"concat2d",(function(){return m["xe"]})),n.d(e,"concat3d",(function(){return m["ye"]})),n.d(e,"concat4d",(function(){return m["ze"]})),n.d(e,"conv1d",(function(){return m["Ae"]})),n.d(e,"conv2d",(function(){return m["Be"]})),n.d(e,"conv2dTranspose",(function(){return m["Ce"]})),n.d(e,"conv3d",(function(){return m["De"]})),n.d(e,"conv3dTranspose",(function(){return m["Ee"]})),n.d(e,"cos",(function(){return m["Ge"]})),n.d(e,"cosh",(function(){return m["He"]})),n.d(e,"cumprod",(function(){return m["Je"]})),n.d(e,"cumsum",(function(){return m["Ke"]})),n.d(e,"denseBincount",(function(){return m["Me"]})),n.d(e,"depthToSpace",(function(){return m["Oe"]})),n.d(e,"depthwiseConv2d",(function(){return m["Pe"]})),n.d(e,"diag",(function(){return m["Re"]})),n.d(e,"dilation2d",(function(){return m["Se"]})),n.d(e,"div",(function(){return m["We"]})),n.d(e,"divNoNan",(function(){return m["Xe"]})),n.d(e,"dot",(function(){return m["Ye"]})),n.d(e,"einsum",(function(){return m["af"]})),n.d(e,"elu",(function(){return m["bf"]})),n.d(e,"equal",(function(){return m["hf"]})),n.d(e,"erf",(function(){return m["if"]})),n.d(e,"euclideanNorm",(function(){return m["jf"]})),n.d(e,"exp",(function(){return m["kf"]})),n.d(e,"expandDims",(function(){return m["lf"]})),n.d(e,"expm1",(function(){return m["mf"]})),n.d(e,"eye",(function(){return m["nf"]})),n.d(e,"fill",(function(){return m["pf"]})),n.d(e,"floor",(function(){return m["sf"]})),n.d(e,"floorDiv",(function(){return m["tf"]})),n.d(e,"gather",(function(){return m["vf"]})),n.d(e,"greater",(function(){return m["Ef"]})),n.d(e,"greaterEqual",(function(){return m["Ff"]})),n.d(e,"imag",(function(){return m["Hf"]})),n.d(e,"isFinite",(function(){return m["Mf"]})),n.d(e,"isInf",(function(){return m["Nf"]})),n.d(e,"isNaN",(function(){return m["Of"]})),n.d(e,"leakyRelu",(function(){return m["Rf"]})),n.d(e,"less",(function(){return m["Sf"]})),n.d(e,"lessEqual",(function(){return m["Tf"]})),n.d(e,"linspace",(function(){return m["Vf"]})),n.d(e,"localResponseNormalization",(function(){return m["Wf"]})),n.d(e,"log",(function(){return m["Xf"]})),n.d(e,"log1p",(function(){return m["Yf"]})),n.d(e,"logSigmoid",(function(){return m["Zf"]})),n.d(e,"logSoftmax",(function(){return m["ag"]})),n.d(e,"logSumExp",(function(){return m["bg"]})),n.d(e,"logicalAnd",(function(){return m["cg"]})),n.d(e,"logicalNot",(function(){return m["dg"]})),n.d(e,"logicalOr",(function(){return m["eg"]})),n.d(e,"logicalXor",(function(){return m["fg"]})),n.d(e,"lowerBound",(function(){return m["hg"]})),n.d(e,"matMul",(function(){return m["ig"]})),n.d(e,"max",(function(){return m["kg"]})),n.d(e,"maxPool",(function(){return m["lg"]})),n.d(e,"maxPool3d",(function(){return m["mg"]})),n.d(e,"maxPoolWithArgmax",(function(){return m["ng"]})),n.d(e,"maximum",(function(){return m["og"]})),n.d(e,"mean",(function(){return m["pg"]})),n.d(e,"meshgrid",(function(){return m["rg"]})),n.d(e,"min",(function(){return m["sg"]})),n.d(e,"minimum",(function(){return m["tg"]})),n.d(e,"mirrorPad",(function(){return m["ug"]})),n.d(e,"mod",(function(){return m["vg"]})),n.d(e,"moments",(function(){return m["wg"]})),n.d(e,"mul",(function(){return m["yg"]})),n.d(e,"multiRNNCell",(function(){return m["zg"]})),n.d(e,"multinomial",(function(){return m["Ag"]})),n.d(e,"neg",(function(){return m["Bg"]})),n.d(e,"notEqual",(function(){return m["Eg"]})),n.d(e,"oneHot",(function(){return m["Fg"]})),n.d(e,"ones",(function(){return m["Gg"]})),n.d(e,"onesLike",(function(){return m["Hg"]})),n.d(e,"outerProduct",(function(){return m["Jg"]})),n.d(e,"pad",(function(){return m["Kg"]})),n.d(e,"pad1d",(function(){return m["Lg"]})),n.d(e,"pad2d",(function(){return m["Mg"]})),n.d(e,"pad3d",(function(){return m["Ng"]})),n.d(e,"pad4d",(function(){return m["Og"]})),n.d(e,"pool",(function(){return m["Pg"]})),n.d(e,"pow",(function(){return m["Qg"]})),n.d(e,"prelu",(function(){return m["Rg"]})),n.d(e,"print",(function(){return m["Sg"]})),n.d(e,"prod",(function(){return m["Tg"]})),n.d(e,"raggedGather",(function(){return m["Vg"]})),n.d(e,"raggedTensorToTensor",(function(){return m["Wg"]})),n.d(e,"rand",(function(){return m["Xg"]})),n.d(e,"randomGamma",(function(){return m["Yg"]})),n.d(e,"randomNormal",(function(){return m["Zg"]})),n.d(e,"randomStandardNormal",(function(){return m["ah"]})),n.d(e,"randomUniform",(function(){return m["bh"]})),n.d(e,"range",(function(){return m["ch"]})),n.d(e,"real",(function(){return m["eh"]})),n.d(e,"reciprocal",(function(){return m["fh"]})),n.d(e,"relu",(function(){return m["jh"]})),n.d(e,"relu6",(function(){return m["kh"]})),n.d(e,"reshape",(function(){return m["mh"]})),n.d(e,"reverse",(function(){return m["nh"]})),n.d(e,"reverse1d",(function(){return m["oh"]})),n.d(e,"reverse2d",(function(){return m["ph"]})),n.d(e,"reverse3d",(function(){return m["qh"]})),n.d(e,"reverse4d",(function(){return m["rh"]})),n.d(e,"round",(function(){return m["th"]})),n.d(e,"rsqrt",(function(){return m["uh"]})),n.d(e,"scalar",(function(){return m["vh"]})),n.d(e,"selu",(function(){return m["zh"]})),n.d(e,"separableConv2d",(function(){return m["Ah"]})),n.d(e,"setdiff1dAsync",(function(){return m["Eh"]})),n.d(e,"sigmoid",(function(){return m["Fh"]})),n.d(e,"sign",(function(){return m["Gh"]})),n.d(e,"sin",(function(){return m["Ih"]})),n.d(e,"sinh",(function(){return m["Jh"]})),n.d(e,"slice",(function(){return m["Kh"]})),n.d(e,"slice1d",(function(){return m["Lh"]})),n.d(e,"slice2d",(function(){return m["Mh"]})),n.d(e,"slice3d",(function(){return m["Nh"]})),n.d(e,"slice4d",(function(){return m["Oh"]})),n.d(e,"softmax",(function(){return m["Qh"]})),n.d(e,"softplus",(function(){return m["Rh"]})),n.d(e,"spaceToBatchND",(function(){return m["Sh"]})),n.d(e,"fft",(function(){return m["of"]})),n.d(e,"ifft",(function(){return m["Gf"]})),n.d(e,"irfft",(function(){return m["Lf"]})),n.d(e,"rfft",(function(){return m["sh"]})),n.d(e,"split",(function(){return m["Wh"]})),n.d(e,"sqrt",(function(){return m["Xh"]})),n.d(e,"square",(function(){return m["Yh"]})),n.d(e,"squaredDifference",(function(){return m["Zh"]})),n.d(e,"squeeze",(function(){return m["ai"]})),n.d(e,"stack",(function(){return m["bi"]})),n.d(e,"step",(function(){return m["ci"]})),n.d(e,"stridedSlice",(function(){return m["di"]})),n.d(e,"sub",(function(){return m["fi"]})),n.d(e,"sum",(function(){return m["gi"]})),n.d(e,"tan",(function(){return m["ii"]})),n.d(e,"tanh",(function(){return m["ji"]})),n.d(e,"tensor",(function(){return m["ki"]})),n.d(e,"tensor1d",(function(){return m["li"]})),n.d(e,"tensor2d",(function(){return m["mi"]})),n.d(e,"tensor3d",(function(){return m["ni"]})),n.d(e,"tensor4d",(function(){return m["oi"]})),n.d(e,"tensor5d",(function(){return m["pi"]})),n.d(e,"tensor6d",(function(){return m["qi"]})),n.d(e,"tile",(function(){return m["ui"]})),n.d(e,"topk",(function(){return m["wi"]})),n.d(e,"truncatedNormal",(function(){return m["zi"]})),n.d(e,"unique",(function(){return m["Ai"]})),n.d(e,"unsortedSegmentSum",(function(){return m["Di"]})),n.d(e,"unstack",(function(){return m["Ei"]})),n.d(e,"upperBound",(function(){return m["Gi"]})),n.d(e,"variable",(function(){return m["Ki"]})),n.d(e,"where",(function(){return m["Ni"]})),n.d(e,"whereAsync",(function(){return m["Oi"]})),n.d(e,"zeros",(function(){return m["Pi"]})),n.d(e,"zerosLike",(function(){return m["Qi"]})),n.d(e,"booleanMaskAsync",(function(){return m["ke"]})),n.d(e,"transpose",(function(){return m["yi"]})),n.d(e,"norm",(function(){return m["Dg"]})),n.d(e,"movingAverage",(function(){return m["xg"]})),n.d(e,"scatterND",(function(){return m["wh"]})),n.d(e,"searchSorted",(function(){return m["yh"]})),n.d(e,"sparseToDense",(function(){return m["Uh"]})),n.d(e,"gatherND",(function(){return m["wf"]})),n.d(e,"dropout",(function(){return m["Ze"]})),n.d(e,"enclosingPowerOfTwo",(function(){return m["ef"]})),n.d(e,"cosineWindow",(function(){return m["Ie"]})),n.d(e,"inTopKAsync",(function(){return m["Jf"]})),n.d(e,"op",(function(){return m["Ig"]})),n.d(e,"OP_SCOPE_SUFFIX",(function(){return m["oc"]})),n.d(e,"image",(function(){return m["If"]})),n.d(e,"linalg",(function(){return m["Uf"]})),n.d(e,"losses",(function(){return m["gg"]})),n.d(e,"spectral",(function(){return m["Vh"]})),n.d(e,"fused",(function(){return m["uf"]})),n.d(e,"signal",(function(){return m["Hh"]})),n.d(e,"sparse",(function(){return m["Th"]})),n.d(e,"string",(function(){return m["ei"]})),n.d(e,"Reduction",(function(){return m["Hc"]})),n.d(e,"train",(function(){return m["xi"]})),n.d(e,"enableProdMode",(function(){return m["df"]})),n.d(e,"enableDebugMode",(function(){return m["cf"]})),n.d(e,"disableDeprecationWarnings",(function(){return m["Te"]})),n.d(e,"deprecationWarn",(function(){return m["Ne"]})),n.d(e,"disposeVariables",(function(){return m["Ve"]})),n.d(e,"engine",(function(){return m["ff"]})),n.d(e,"memory",(function(){return m["qg"]})),n.d(e,"profile",(function(){return m["Ug"]})),n.d(e,"tidy",(function(){return m["ti"]})),n.d(e,"dispose",(function(){return m["Ue"]})),n.d(e,"keep",(function(){return m["Pf"]})),n.d(e,"time",(function(){return m["vi"]})),n.d(e,"setBackend",(function(){return m["Ch"]})),n.d(e,"ready",(function(){return m["dh"]})),n.d(e,"getBackend",(function(){return m["yf"]})),n.d(e,"removeBackend",(function(){return m["lh"]})),n.d(e,"findBackend",(function(){return m["qf"]})),n.d(e,"findBackendFactory",(function(){return m["rf"]})),n.d(e,"registerBackend",(function(){return m["gh"]})),n.d(e,"backend",(function(){return m["be"]})),n.d(e,"setPlatform",(function(){return m["Dh"]})),n.d(e,"getKernel",(function(){return m["Af"]})),n.d(e,"getGradient",(function(){return m["zf"]})),n.d(e,"getKernelsForBackend",(function(){return m["Bf"]})),n.d(e,"registerKernel",(function(){return m["ih"]})),n.d(e,"registerGradient",(function(){return m["hh"]})),n.d(e,"unregisterKernel",(function(){return m["Ci"]})),n.d(e,"unregisterGradient",(function(){return m["Bi"]})),n.d(e,"copyRegisteredKernels",(function(){return m["Fe"]})),n.d(e,"customGrad",(function(){return m["Le"]})),n.d(e,"grad",(function(){return m["Cf"]})),n.d(e,"grads",(function(){return m["Df"]})),n.d(e,"valueAndGrad",(function(){return m["Ii"]})),n.d(e,"valueAndGrads",(function(){return m["Ji"]})),n.d(e,"variableGrads",(function(){return m["Li"]})),n.d(e,"Environment",(function(){return m["gb"]})),n.d(e,"env",(function(){return m["gf"]})),n.d(e,"ENV",(function(){return m["cb"]})),n.d(e,"version_core",(function(){return m["Mi"]})),n.d(e,"nextFrame",(function(){return m["Cg"]})),n.d(e,"browser",(function(){return m["oe"]})),n.d(e,"io",(function(){return m["Kf"]})),n.d(e,"math",(function(){return m["jg"]})),n.d(e,"serialization",(function(){return m["Bh"]})),n.d(e,"test_util",(function(){return m["si"]})),n.d(e,"util",(function(){return m["Hi"]})),n.d(e,"backend_util",(function(){return m["ce"]})),n.d(e,"broadcast_util",(function(){return m["ne"]})),n.d(e,"tensor_util",(function(){return m["ri"]})),n.d(e,"slice_util",(function(){return m["Ph"]})),n.d(e,"gather_util",(function(){return m["xf"]})),n.d(e,"scatter_util",(function(){return m["xh"]})),n.d(e,"device_util",(function(){return m["Qe"]})),n.d(e,"kernel_impls",(function(){return m["Qf"]})),n.d(e,"KernelBackend",(function(){return m["Fb"]})),n.d(e,"DataStorage",(function(){return m["S"]})),n.d(e,"Abs",(function(){return m["a"]})),n.d(e,"Acos",(function(){return m["b"]})),n.d(e,"Acosh",(function(){return m["c"]})),n.d(e,"Add",(function(){return m["h"]})),n.d(e,"AddN",(function(){return m["i"]})),n.d(e,"All",(function(){return m["j"]})),n.d(e,"Any",(function(){return m["k"]})),n.d(e,"ArgMax",(function(){return m["l"]})),n.d(e,"ArgMin",(function(){return m["m"]})),n.d(e,"Asin",(function(){return m["n"]})),n.d(e,"Asinh",(function(){return m["o"]})),n.d(e,"Atan",(function(){return m["p"]})),n.d(e,"Atanh",(function(){return m["r"]})),n.d(e,"Atan2",(function(){return m["q"]})),n.d(e,"AvgPool",(function(){return m["s"]})),n.d(e,"AvgPoolGrad",(function(){return m["v"]})),n.d(e,"AvgPool3D",(function(){return m["t"]})),n.d(e,"AvgPool3DGrad",(function(){return m["u"]})),n.d(e,"BatchMatMul",(function(){return m["w"]})),n.d(e,"BatchToSpaceND",(function(){return m["x"]})),n.d(e,"Bincount",(function(){return m["y"]})),n.d(e,"BroadcastTo",(function(){return m["A"]})),n.d(e,"BroadcastArgs",(function(){return m["z"]})),n.d(e,"Cast",(function(){return m["B"]})),n.d(e,"Ceil",(function(){return m["C"]})),n.d(e,"ClipByValue",(function(){return m["D"]})),n.d(e,"Complex",(function(){return m["E"]})),n.d(e,"ComplexAbs",(function(){return m["F"]})),n.d(e,"Concat",(function(){return m["G"]})),n.d(e,"Conv2D",(function(){return m["H"]})),n.d(e,"Conv2DBackpropFilter",(function(){return m["I"]})),n.d(e,"Conv2DBackpropInput",(function(){return m["J"]})),n.d(e,"Conv3D",(function(){return m["K"]})),n.d(e,"Conv3DBackpropFilterV2",(function(){return m["L"]})),n.d(e,"Conv3DBackpropInputV2",(function(){return m["M"]})),n.d(e,"Cos",(function(){return m["N"]})),n.d(e,"Cosh",(function(){return m["O"]})),n.d(e,"Cumprod",(function(){return m["Q"]})),n.d(e,"Cumsum",(function(){return m["R"]})),n.d(e,"CropAndResize",(function(){return m["P"]})),n.d(e,"DenseBincount",(function(){return m["T"]})),n.d(e,"DepthToSpace",(function(){return m["U"]})),n.d(e,"DepthwiseConv2dNative",(function(){return m["V"]})),n.d(e,"DepthwiseConv2dNativeBackpropFilter",(function(){return m["W"]})),n.d(e,"DepthwiseConv2dNativeBackpropInput",(function(){return m["X"]})),n.d(e,"Diag",(function(){return m["Y"]})),n.d(e,"Dilation2D",(function(){return m["Z"]})),n.d(e,"Dilation2DBackpropInput",(function(){return m["bb"]})),n.d(e,"Dilation2DBackpropFilter",(function(){return m["ab"]})),n.d(e,"RealDiv",(function(){return m["Fc"]})),n.d(e,"Einsum",(function(){return m["db"]})),n.d(e,"Elu",(function(){return m["eb"]})),n.d(e,"EluGrad",(function(){return m["fb"]})),n.d(e,"Erf",(function(){return m["ib"]})),n.d(e,"Equal",(function(){return m["hb"]})),n.d(e,"Exp",(function(){return m["jb"]})),n.d(e,"ExpandDims",(function(){return m["kb"]})),n.d(e,"Expm1",(function(){return m["lb"]})),n.d(e,"FFT",(function(){return m["mb"]})),n.d(e,"Fill",(function(){return m["nb"]})),n.d(e,"FlipLeftRight",(function(){return m["ob"]})),n.d(e,"Floor",(function(){return m["pb"]})),n.d(e,"FloorDiv",(function(){return m["qb"]})),n.d(e,"FusedBatchNorm",(function(){return m["sb"]})),n.d(e,"GatherV2",(function(){return m["wb"]})),n.d(e,"GatherNd",(function(){return m["vb"]})),n.d(e,"Greater",(function(){return m["xb"]})),n.d(e,"GreaterEqual",(function(){return m["yb"]})),n.d(e,"Identity",(function(){return m["Ab"]})),n.d(e,"IFFT",(function(){return m["zb"]})),n.d(e,"Imag",(function(){return m["Bb"]})),n.d(e,"IsFinite",(function(){return m["Cb"]})),n.d(e,"IsInf",(function(){return m["Db"]})),n.d(e,"IsNan",(function(){return m["Eb"]})),n.d(e,"LeakyRelu",(function(){return m["Ib"]})),n.d(e,"Less",(function(){return m["Jb"]})),n.d(e,"LessEqual",(function(){return m["Kb"]})),n.d(e,"LinSpace",(function(){return m["Lb"]})),n.d(e,"Log",(function(){return m["Mb"]})),n.d(e,"Log1p",(function(){return m["Nb"]})),n.d(e,"LogicalAnd",(function(){return m["Pb"]})),n.d(e,"LogicalNot",(function(){return m["Qb"]})),n.d(e,"LogicalOr",(function(){return m["Rb"]})),n.d(e,"LogicalXor",(function(){return m["Sb"]})),n.d(e,"LogSoftmax",(function(){return m["Ob"]})),n.d(e,"LowerBound",(function(){return m["Tb"]})),n.d(e,"LRN",(function(){return m["Gb"]})),n.d(e,"LRNGrad",(function(){return m["Hb"]})),n.d(e,"Max",(function(){return m["Ub"]})),n.d(e,"Maximum",(function(){return m["ac"]})),n.d(e,"MaxPool",(function(){return m["Vb"]})),n.d(e,"MaxPoolGrad",(function(){return m["Yb"]})),n.d(e,"MaxPool3D",(function(){return m["Wb"]})),n.d(e,"MaxPool3DGrad",(function(){return m["Xb"]})),n.d(e,"MaxPoolWithArgmax",(function(){return m["Zb"]})),n.d(e,"Mean",(function(){return m["bc"]})),n.d(e,"Min",(function(){return m["cc"]})),n.d(e,"Minimum",(function(){return m["dc"]})),n.d(e,"MirrorPad",(function(){return m["ec"]})),n.d(e,"Mod",(function(){return m["fc"]})),n.d(e,"Multinomial",(function(){return m["hc"]})),n.d(e,"Multiply",(function(){return m["ic"]})),n.d(e,"Neg",(function(){return m["jc"]})),n.d(e,"NotEqual",(function(){return m["nc"]})),n.d(e,"NonMaxSuppressionV3",(function(){return m["kc"]})),n.d(e,"NonMaxSuppressionV4",(function(){return m["lc"]})),n.d(e,"NonMaxSuppressionV5",(function(){return m["mc"]})),n.d(e,"OnesLike",(function(){return m["qc"]})),n.d(e,"OneHot",(function(){return m["pc"]})),n.d(e,"Pack",(function(){return m["tc"]})),n.d(e,"PadV2",(function(){return m["uc"]})),n.d(e,"Pool",(function(){return m["vc"]})),n.d(e,"Pow",(function(){return m["wc"]})),n.d(e,"Prelu",(function(){return m["xc"]})),n.d(e,"Prod",(function(){return m["yc"]})),n.d(e,"RaggedGather",(function(){return m["Ac"]})),n.d(e,"RaggedTensorToTensor",(function(){return m["Bc"]})),n.d(e,"Range",(function(){return m["Cc"]})),n.d(e,"Real",(function(){return m["Ec"]})),n.d(e,"Reciprocal",(function(){return m["Gc"]})),n.d(e,"Relu",(function(){return m["Ic"]})),n.d(e,"Reshape",(function(){return m["Kc"]})),n.d(e,"ResizeNearestNeighbor",(function(){return m["Nc"]})),n.d(e,"ResizeNearestNeighborGrad",(function(){return m["Oc"]})),n.d(e,"ResizeBilinear",(function(){return m["Lc"]})),n.d(e,"ResizeBilinearGrad",(function(){return m["Mc"]})),n.d(e,"Relu6",(function(){return m["Jc"]})),n.d(e,"Reverse",(function(){return m["Pc"]})),n.d(e,"Round",(function(){return m["Rc"]})),n.d(e,"Rsqrt",(function(){return m["Sc"]})),n.d(e,"ScatterNd",(function(){return m["Uc"]})),n.d(e,"SearchSorted",(function(){return m["Vc"]})),n.d(e,"Select",(function(){return m["Wc"]})),n.d(e,"Selu",(function(){return m["Xc"]})),n.d(e,"Slice",(function(){return m["cd"]})),n.d(e,"Sin",(function(){return m["ad"]})),n.d(e,"Sinh",(function(){return m["bd"]})),n.d(e,"Sign",(function(){return m["Zc"]})),n.d(e,"Sigmoid",(function(){return m["Yc"]})),n.d(e,"Softplus",(function(){return m["ed"]})),n.d(e,"Sqrt",(function(){return m["md"]})),n.d(e,"Sum",(function(){return m["vd"]})),n.d(e,"SpaceToBatchND",(function(){return m["fd"]})),n.d(e,"SplitV",(function(){return m["ld"]})),n.d(e,"Softmax",(function(){return m["dd"]})),n.d(e,"SparseFillEmptyRows",(function(){return m["gd"]})),n.d(e,"SparseReshape",(function(){return m["hd"]})),n.d(e,"SparseSegmentMean",(function(){return m["id"]})),n.d(e,"SparseSegmentSum",(function(){return m["jd"]})),n.d(e,"SparseToDense",(function(){return m["kd"]})),n.d(e,"SquaredDifference",(function(){return m["od"]})),n.d(e,"Square",(function(){return m["nd"]})),n.d(e,"StridedSlice",(function(){return m["qd"]})),n.d(e,"StringNGrams",(function(){return m["rd"]})),n.d(e,"StringSplit",(function(){return m["sd"]})),n.d(e,"StringToHashBucketFast",(function(){return m["td"]})),n.d(e,"Sub",(function(){return m["ud"]})),n.d(e,"Tan",(function(){return m["wd"]})),n.d(e,"Tanh",(function(){return m["xd"]})),n.d(e,"Tile",(function(){return m["Ad"]})),n.d(e,"TopK",(function(){return m["Bd"]})),n.d(e,"Transform",(function(){return m["Cd"]})),n.d(e,"Transpose",(function(){return m["Dd"]})),n.d(e,"Unique",(function(){return m["Ed"]})),n.d(e,"Unpack",(function(){return m["Fd"]})),n.d(e,"UnsortedSegmentSum",(function(){return m["Gd"]})),n.d(e,"UpperBound",(function(){return m["Hd"]})),n.d(e,"ZerosLike",(function(){return m["Jd"]})),n.d(e,"Step",(function(){return m["pd"]})),n.d(e,"FromPixels",(function(){return m["rb"]})),n.d(e,"RotateWithOffset",(function(){return m["Qc"]})),n.d(e,"_FusedMatMul",(function(){return m["Kd"]})),n.d(e,"FusedConv2D",(function(){return m["tb"]})),n.d(e,"FusedDepthwiseConv2D",(function(){return m["ub"]}));var r=n("219b"),a=(n("df3a"),n("32fe")),i=n("222c"),o=n("58b9"),s=n("6bfe");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class u{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(t,e){return fetch(t,e)}now(){return performance.now()}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)}decode(t,e){return new TextDecoder(e).decode(t)}setTimeoutCustom(t,e){window&&Object(a["c"])().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(t),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},e),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",t=>{if(t.source===window&&t.data.name===this.messageName){t.stopPropagation();const e=this.functionRefs[t.data.index];e(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))):setTimeout(t,e)}}if(Object(a["c"])().get("IS_BROWSER")){Object(a["c"])().setPlatform("browser",new u);try{s["a"].registerManager(o["a"].URL_SCHEME,new o["b"])}catch(g){}try{s["a"].registerManager(i["a"].URL_SCHEME,new i["b"])}catch(g){}}n("b37e");var c=n("6128"),l=n("7b50"),d=n("4e1f"),h=n("ca58"),p=n("4e56");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object(r["b"])();const f={buffer:c["a"],cast:l["a"],clone:d["a"],print:h["a"]};Object(p["e"])(f);var m=n("f137");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},"2d36":function(t,e,n){},"2d7c":function(t,e){function n(t,e){var n=-1,r=null==t?0:t.length,a=0,i=[];while(++n<r){var o=t[n];e(o,n,t)&&(i[a++]=o)}return i}t.exports=n},"2dcb":function(t,e,n){var r=n("91e9"),a=r(Object.getPrototypeOf,Object);t.exports=a},"2eaa":function(t,e,n){var r=n("d612"),a=n("8db3"),i=n("5edf"),o=n("7948"),s=n("b047"),u=n("c584"),c=200;function l(t,e,n,l){var d=-1,h=a,p=!0,f=t.length,m=[],g=e.length;if(!f)return m;n&&(e=o(e,s(n))),l?(h=i,p=!1):e.length>=c&&(h=u,p=!1,e=new r(e));t:while(++d<f){var b=t[d],y=null==n?b:n(b);if(b=l||0!==b?b:0,p&&y===y){var v=g;while(v--)if(e[v]===y)continue t;m.push(b)}else h(e,y,l)||m.push(b)}return m}t.exports=l},"2ec1":function(t,e,n){var r=n("100e"),a=n("9aff");function i(t){return r((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;o=t.length>3&&"function"==typeof o?(i--,o):void 0,s&&a(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),e=Object(e);while(++r<i){var u=n[r];u&&t(e,u,r,o)}return e}))}t.exports=i},"2ef0":function(t,e,n){(function(t,r){var a;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var i,o="4.17.21",s=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",c="Expected a function",l="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",h=500,p="__lodash_placeholder__",f=1,m=2,g=4,b=1,y=2,v=1,x=2,w=4,k=8,S=16,O=32,_=64,C=128,T=256,I=512,N=30,E="...",A=800,R=16,j=1,D=2,F=3,M=1/0,P=9007199254740991,$=17976931348623157e292,L=NaN,B=4294967295,z=B-1,W=B>>>1,V=[["ary",C],["bind",v],["bindKey",x],["curry",k],["curryRight",S],["flip",I],["partial",O],["partialRight",_],["rearg",T]],U="[object Arguments]",G="[object Array]",H="[object AsyncFunction]",q="[object Boolean]",K="[object Date]",X="[object DOMException]",Y="[object Error]",J="[object Function]",Z="[object GeneratorFunction]",Q="[object Map]",tt="[object Number]",et="[object Null]",nt="[object Object]",rt="[object Promise]",at="[object Proxy]",it="[object RegExp]",ot="[object Set]",st="[object String]",ut="[object Symbol]",ct="[object Undefined]",lt="[object WeakMap]",dt="[object WeakSet]",ht="[object ArrayBuffer]",pt="[object DataView]",ft="[object Float32Array]",mt="[object Float64Array]",gt="[object Int8Array]",bt="[object Int16Array]",yt="[object Int32Array]",vt="[object Uint8Array]",xt="[object Uint8ClampedArray]",wt="[object Uint16Array]",kt="[object Uint32Array]",St=/\b__p \+= '';/g,Ot=/\b(__p \+=) '' \+/g,_t=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Ct=/&(?:amp|lt|gt|quot|#39);/g,Tt=/[&<>"']/g,It=RegExp(Ct.source),Nt=RegExp(Tt.source),Et=/<%-([\s\S]+?)%>/g,At=/<%([\s\S]+?)%>/g,Rt=/<%=([\s\S]+?)%>/g,jt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,Ft=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mt=/[\\^$.*+?()[\]{}|]/g,Pt=RegExp(Mt.source),$t=/^\s+/,Lt=/\s/,Bt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zt=/\{\n\/\* \[wrapped with (.+)\] \*/,Wt=/,? & /,Vt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ut=/[()=,{}\[\]\/\s]/,Gt=/\\(\\)?/g,Ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qt=/\w*$/,Kt=/^[-+]0x[0-9a-f]+$/i,Xt=/^0b[01]+$/i,Yt=/^\[object .+?Constructor\]$/,Jt=/^0o[0-7]+$/i,Zt=/^(?:0|[1-9]\d*)$/,Qt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,te=/($^)/,ee=/['\n\r\u2028\u2029\\]/g,ne="\\ud800-\\udfff",re="\\u0300-\\u036f",ae="\\ufe20-\\ufe2f",ie="\\u20d0-\\u20ff",oe=re+ae+ie,se="\\u2700-\\u27bf",ue="a-z\\xdf-\\xf6\\xf8-\\xff",ce="\\xac\\xb1\\xd7\\xf7",le="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",de="\\u2000-\\u206f",he=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",pe="A-Z\\xc0-\\xd6\\xd8-\\xde",fe="\\ufe0e\\ufe0f",me=ce+le+de+he,ge="['’]",be="["+ne+"]",ye="["+me+"]",ve="["+oe+"]",xe="\\d+",we="["+se+"]",ke="["+ue+"]",Se="[^"+ne+me+xe+se+ue+pe+"]",Oe="\\ud83c[\\udffb-\\udfff]",_e="(?:"+ve+"|"+Oe+")",Ce="[^"+ne+"]",Te="(?:\\ud83c[\\udde6-\\uddff]){2}",Ie="[\\ud800-\\udbff][\\udc00-\\udfff]",Ne="["+pe+"]",Ee="\\u200d",Ae="(?:"+ke+"|"+Se+")",Re="(?:"+Ne+"|"+Se+")",je="(?:"+ge+"(?:d|ll|m|re|s|t|ve))?",De="(?:"+ge+"(?:D|LL|M|RE|S|T|VE))?",Fe=_e+"?",Me="["+fe+"]?",Pe="(?:"+Ee+"(?:"+[Ce,Te,Ie].join("|")+")"+Me+Fe+")*",$e="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Le="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Be=Me+Fe+Pe,ze="(?:"+[we,Te,Ie].join("|")+")"+Be,We="(?:"+[Ce+ve+"?",ve,Te,Ie,be].join("|")+")",Ve=RegExp(ge,"g"),Ue=RegExp(ve,"g"),Ge=RegExp(Oe+"(?="+Oe+")|"+We+Be,"g"),He=RegExp([Ne+"?"+ke+"+"+je+"(?="+[ye,Ne,"$"].join("|")+")",Re+"+"+De+"(?="+[ye,Ne+Ae,"$"].join("|")+")",Ne+"?"+Ae+"+"+je,Ne+"+"+De,Le,$e,xe,ze].join("|"),"g"),qe=RegExp("["+Ee+ne+oe+fe+"]"),Ke=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Je={};Je[ft]=Je[mt]=Je[gt]=Je[bt]=Je[yt]=Je[vt]=Je[xt]=Je[wt]=Je[kt]=!0,Je[U]=Je[G]=Je[ht]=Je[q]=Je[pt]=Je[K]=Je[Y]=Je[J]=Je[Q]=Je[tt]=Je[nt]=Je[it]=Je[ot]=Je[st]=Je[lt]=!1;var Ze={};Ze[U]=Ze[G]=Ze[ht]=Ze[pt]=Ze[q]=Ze[K]=Ze[ft]=Ze[mt]=Ze[gt]=Ze[bt]=Ze[yt]=Ze[Q]=Ze[tt]=Ze[nt]=Ze[it]=Ze[ot]=Ze[st]=Ze[ut]=Ze[vt]=Ze[xt]=Ze[wt]=Ze[kt]=!0,Ze[Y]=Ze[J]=Ze[lt]=!1;var Qe={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},tn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},en={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},nn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rn=parseFloat,an=parseInt,on="object"==typeof t&&t&&t.Object===Object&&t,sn="object"==typeof self&&self&&self.Object===Object&&self,un=on||sn||Function("return this")(),cn=e&&!e.nodeType&&e,ln=cn&&"object"==typeof r&&r&&!r.nodeType&&r,dn=ln&&ln.exports===cn,hn=dn&&on.process,pn=function(){try{var t=ln&&ln.require&&ln.require("util").types;return t||hn&&hn.binding&&hn.binding("util")}catch(e){}}(),fn=pn&&pn.isArrayBuffer,mn=pn&&pn.isDate,gn=pn&&pn.isMap,bn=pn&&pn.isRegExp,yn=pn&&pn.isSet,vn=pn&&pn.isTypedArray;function xn(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function wn(t,e,n,r){var a=-1,i=null==t?0:t.length;while(++a<i){var o=t[a];e(r,o,n(o),t)}return r}function kn(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(!1===e(t[n],n,t))break;return t}function Sn(t,e){var n=null==t?0:t.length;while(n--)if(!1===e(t[n],n,t))break;return t}function On(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(!e(t[n],n,t))return!1;return!0}function _n(t,e){var n=-1,r=null==t?0:t.length,a=0,i=[];while(++n<r){var o=t[n];e(o,n,t)&&(i[a++]=o)}return i}function Cn(t,e){var n=null==t?0:t.length;return!!n&&$n(t,e,0)>-1}function Tn(t,e,n){var r=-1,a=null==t?0:t.length;while(++r<a)if(n(e,t[r]))return!0;return!1}function In(t,e){var n=-1,r=null==t?0:t.length,a=Array(r);while(++n<r)a[n]=e(t[n],n,t);return a}function Nn(t,e){var n=-1,r=e.length,a=t.length;while(++n<r)t[a+n]=e[n];return t}function En(t,e,n,r){var a=-1,i=null==t?0:t.length;r&&i&&(n=t[++a]);while(++a<i)n=e(n,t[a],a,t);return n}function An(t,e,n,r){var a=null==t?0:t.length;r&&a&&(n=t[--a]);while(a--)n=e(n,t[a],a,t);return n}function Rn(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(e(t[n],n,t))return!0;return!1}var jn=Wn("length");function Dn(t){return t.split("")}function Fn(t){return t.match(Vt)||[]}function Mn(t,e,n){var r;return n(t,(function(t,n,a){if(e(t,n,a))return r=n,!1})),r}function Pn(t,e,n,r){var a=t.length,i=n+(r?1:-1);while(r?i--:++i<a)if(e(t[i],i,t))return i;return-1}function $n(t,e,n){return e===e?fr(t,e,n):Pn(t,Bn,n)}function Ln(t,e,n,r){var a=n-1,i=t.length;while(++a<i)if(r(t[a],e))return a;return-1}function Bn(t){return t!==t}function zn(t,e){var n=null==t?0:t.length;return n?Hn(t,e)/n:L}function Wn(t){return function(e){return null==e?i:e[t]}}function Vn(t){return function(e){return null==t?i:t[e]}}function Un(t,e,n,r,a){return a(t,(function(t,a,i){n=r?(r=!1,t):e(n,t,a,i)})),n}function Gn(t,e){var n=t.length;t.sort(e);while(n--)t[n]=t[n].value;return t}function Hn(t,e){var n,r=-1,a=t.length;while(++r<a){var o=e(t[r]);o!==i&&(n=n===i?o:n+o)}return n}function qn(t,e){var n=-1,r=Array(t);while(++n<t)r[n]=e(n);return r}function Kn(t,e){return In(e,(function(e){return[e,t[e]]}))}function Xn(t){return t?t.slice(0,yr(t)+1).replace($t,""):t}function Yn(t){return function(e){return t(e)}}function Jn(t,e){return In(e,(function(e){return t[e]}))}function Zn(t,e){return t.has(e)}function Qn(t,e){var n=-1,r=t.length;while(++n<r&&$n(e,t[n],0)>-1);return n}function tr(t,e){var n=t.length;while(n--&&$n(e,t[n],0)>-1);return n}function er(t,e){var n=t.length,r=0;while(n--)t[n]===e&&++r;return r}var nr=Vn(Qe),rr=Vn(tn);function ar(t){return"\\"+nn[t]}function ir(t,e){return null==t?i:t[e]}function or(t){return qe.test(t)}function sr(t){return Ke.test(t)}function ur(t){var e,n=[];while(!(e=t.next()).done)n.push(e.value);return n}function cr(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function lr(t,e){return function(n){return t(e(n))}}function dr(t,e){var n=-1,r=t.length,a=0,i=[];while(++n<r){var o=t[n];o!==e&&o!==p||(t[n]=p,i[a++]=n)}return i}function hr(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function pr(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function fr(t,e,n){var r=n-1,a=t.length;while(++r<a)if(t[r]===e)return r;return-1}function mr(t,e,n){var r=n+1;while(r--)if(t[r]===e)return r;return r}function gr(t){return or(t)?xr(t):jn(t)}function br(t){return or(t)?wr(t):Dn(t)}function yr(t){var e=t.length;while(e--&&Lt.test(t.charAt(e)));return e}var vr=Vn(en);function xr(t){var e=Ge.lastIndex=0;while(Ge.test(t))++e;return e}function wr(t){return t.match(Ge)||[]}function kr(t){return t.match(He)||[]}var Sr=function t(e){e=null==e?un:Or.defaults(un.Object(),e,Or.pick(un,Xe));var n=e.Array,r=e.Date,a=e.Error,Lt=e.Function,Vt=e.Math,ne=e.Object,re=e.RegExp,ae=e.String,ie=e.TypeError,oe=n.prototype,se=Lt.prototype,ue=ne.prototype,ce=e["__core-js_shared__"],le=se.toString,de=ue.hasOwnProperty,he=0,pe=function(){var t=/[^.]+$/.exec(ce&&ce.keys&&ce.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),fe=ue.toString,me=le.call(ne),ge=un._,be=re("^"+le.call(de).replace(Mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ye=dn?e.Buffer:i,ve=e.Symbol,xe=e.Uint8Array,we=ye?ye.allocUnsafe:i,ke=lr(ne.getPrototypeOf,ne),Se=ne.create,Oe=ue.propertyIsEnumerable,_e=oe.splice,Ce=ve?ve.isConcatSpreadable:i,Te=ve?ve.iterator:i,Ie=ve?ve.toStringTag:i,Ne=function(){try{var t=qo(ne,"defineProperty");return t({},"",{}),t}catch(e){}}(),Ee=e.clearTimeout!==un.clearTimeout&&e.clearTimeout,Ae=r&&r.now!==un.Date.now&&r.now,Re=e.setTimeout!==un.setTimeout&&e.setTimeout,je=Vt.ceil,De=Vt.floor,Fe=ne.getOwnPropertySymbols,Me=ye?ye.isBuffer:i,Pe=e.isFinite,$e=oe.join,Le=lr(ne.keys,ne),Be=Vt.max,ze=Vt.min,We=r.now,Ge=e.parseInt,He=Vt.random,qe=oe.reverse,Ke=qo(e,"DataView"),Qe=qo(e,"Map"),tn=qo(e,"Promise"),en=qo(e,"Set"),nn=qo(e,"WeakMap"),on=qo(ne,"create"),sn=nn&&new nn,cn={},ln=Rs(Ke),hn=Rs(Qe),pn=Rs(tn),jn=Rs(en),Dn=Rs(nn),Vn=ve?ve.prototype:i,fr=Vn?Vn.valueOf:i,xr=Vn?Vn.toString:i;function wr(t){if(_l(t)&&!ul(t)&&!(t instanceof Tr)){if(t instanceof Cr)return t;if(de.call(t,"__wrapped__"))return Ds(t)}return new Cr(t)}var Sr=function(){function t(){}return function(e){if(!Ol(e))return{};if(Se)return Se(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function _r(){}function Cr(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Tr(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=B,this.__views__=[]}function Ir(){var t=new Tr(this.__wrapped__);return t.__actions__=ro(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=ro(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=ro(this.__views__),t}function Nr(){if(this.__filtered__){var t=new Tr(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Er(){var t=this.__wrapped__.value(),e=this.__dir__,n=ul(t),r=e<0,a=n?t.length:0,i=Zo(0,a,this.__views__),o=i.start,s=i.end,u=s-o,c=r?s:o-1,l=this.__iteratees__,d=l.length,h=0,p=ze(u,this.__takeCount__);if(!n||!r&&a==u&&p==u)return $i(t,this.__actions__);var f=[];t:while(u--&&h<p){c+=e;var m=-1,g=t[c];while(++m<d){var b=l[m],y=b.iteratee,v=b.type,x=y(g);if(v==D)g=x;else if(!x){if(v==j)continue t;break t}}f[h++]=g}return f}function Ar(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function Rr(){this.__data__=on?on(null):{},this.size=0}function jr(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function Dr(t){var e=this.__data__;if(on){var n=e[t];return n===d?i:n}return de.call(e,t)?e[t]:i}function Fr(t){var e=this.__data__;return on?e[t]!==i:de.call(e,t)}function Mr(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=on&&e===i?d:e,this}function Pr(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function $r(){this.__data__=[],this.size=0}function Lr(t){var e=this.__data__,n=la(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():_e.call(e,n,1),--this.size,!0}function Br(t){var e=this.__data__,n=la(e,t);return n<0?i:e[n][1]}function zr(t){return la(this.__data__,t)>-1}function Wr(t,e){var n=this.__data__,r=la(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}function Vr(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}function Ur(){this.size=0,this.__data__={hash:new Ar,map:new(Qe||Pr),string:new Ar}}function Gr(t){var e=Go(this,t)["delete"](t);return this.size-=e?1:0,e}function Hr(t){return Go(this,t).get(t)}function qr(t){return Go(this,t).has(t)}function Kr(t,e){var n=Go(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}function Xr(t){var e=-1,n=null==t?0:t.length;this.__data__=new Vr;while(++e<n)this.add(t[e])}function Yr(t){return this.__data__.set(t,d),this}function Jr(t){return this.__data__.has(t)}function Zr(t){var e=this.__data__=new Pr(t);this.size=e.size}function Qr(){this.__data__=new Pr,this.size=0}function ta(t){var e=this.__data__,n=e["delete"](t);return this.size=e.size,n}function ea(t){return this.__data__.get(t)}function na(t){return this.__data__.has(t)}function ra(t,e){var n=this.__data__;if(n instanceof Pr){var r=n.__data__;if(!Qe||r.length<s-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Vr(r)}return n.set(t,e),this.size=n.size,this}function aa(t,e){var n=ul(t),r=!n&&sl(t),a=!n&&!r&&pl(t),i=!n&&!r&&!a&&Bl(t),o=n||r||a||i,s=o?qn(t.length,ae):[],u=s.length;for(var c in t)!e&&!de.call(t,c)||o&&("length"==c||a&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||os(c,u))||s.push(c);return s}function ia(t){var e=t.length;return e?t[bi(0,e-1)]:i}function oa(t,e){return Ns(ro(t),ga(e,0,t.length))}function sa(t){return Ns(ro(t))}function ua(t,e,n){(n!==i&&!al(t[e],n)||n===i&&!(e in t))&&fa(t,e,n)}function ca(t,e,n){var r=t[e];de.call(t,e)&&al(r,n)&&(n!==i||e in t)||fa(t,e,n)}function la(t,e){var n=t.length;while(n--)if(al(t[n][0],e))return n;return-1}function da(t,e,n,r){return ka(t,(function(t,a,i){e(r,t,n(t),i)})),r}function ha(t,e){return t&&ao(e,kd(e),t)}function pa(t,e){return t&&ao(e,Sd(e),t)}function fa(t,e,n){"__proto__"==e&&Ne?Ne(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ma(t,e){var r=-1,a=e.length,o=n(a),s=null==t;while(++r<a)o[r]=s?i:gd(t,e[r]);return o}function ga(t,e,n){return t===t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function ba(t,e,n,r,a,o){var s,u=e&f,c=e&m,l=e&g;if(n&&(s=a?n(t,r,a,o):n(t)),s!==i)return s;if(!Ol(t))return t;var d=ul(t);if(d){if(s=es(t),!u)return ro(t,s)}else{var h=Jo(t),p=h==J||h==Z;if(pl(t))return qi(t,u);if(h==nt||h==U||p&&!a){if(s=c||p?{}:ns(t),!u)return c?oo(t,pa(s,t)):io(t,ha(s,t))}else{if(!Ze[h])return a?t:{};s=rs(t,h,u)}}o||(o=new Zr);var b=o.get(t);if(b)return b;o.set(t,s),Pl(t)?t.forEach((function(r){s.add(ba(r,e,n,r,t,o))})):Cl(t)&&t.forEach((function(r,a){s.set(a,ba(r,e,n,a,t,o))}));var y=l?c?Bo:Lo:c?Sd:kd,v=d?i:y(t);return kn(v||t,(function(r,a){v&&(a=r,r=t[a]),ca(s,a,ba(r,e,n,a,t,o))})),s}function ya(t){var e=kd(t);return function(n){return va(n,t,e)}}function va(t,e,n){var r=n.length;if(null==t)return!r;t=ne(t);while(r--){var a=n[r],o=e[a],s=t[a];if(s===i&&!(a in t)||!o(s))return!1}return!0}function xa(t,e,n){if("function"!=typeof t)throw new ie(c);return _s((function(){t.apply(i,n)}),e)}function wa(t,e,n,r){var a=-1,i=Cn,o=!0,u=t.length,c=[],l=e.length;if(!u)return c;n&&(e=In(e,Yn(n))),r?(i=Tn,o=!1):e.length>=s&&(i=Zn,o=!1,e=new Xr(e));t:while(++a<u){var d=t[a],h=null==n?d:n(d);if(d=r||0!==d?d:0,o&&h===h){var p=l;while(p--)if(e[p]===h)continue t;c.push(d)}else i(e,h,r)||c.push(d)}return c}wr.templateSettings={escape:Et,evaluate:At,interpolate:Rt,variable:"",imports:{_:wr}},wr.prototype=_r.prototype,wr.prototype.constructor=wr,Cr.prototype=Sr(_r.prototype),Cr.prototype.constructor=Cr,Tr.prototype=Sr(_r.prototype),Tr.prototype.constructor=Tr,Ar.prototype.clear=Rr,Ar.prototype["delete"]=jr,Ar.prototype.get=Dr,Ar.prototype.has=Fr,Ar.prototype.set=Mr,Pr.prototype.clear=$r,Pr.prototype["delete"]=Lr,Pr.prototype.get=Br,Pr.prototype.has=zr,Pr.prototype.set=Wr,Vr.prototype.clear=Ur,Vr.prototype["delete"]=Gr,Vr.prototype.get=Hr,Vr.prototype.has=qr,Vr.prototype.set=Kr,Xr.prototype.add=Xr.prototype.push=Yr,Xr.prototype.has=Jr,Zr.prototype.clear=Qr,Zr.prototype["delete"]=ta,Zr.prototype.get=ea,Zr.prototype.has=na,Zr.prototype.set=ra;var ka=co(Aa),Sa=co(Ra,!0);function Oa(t,e){var n=!0;return ka(t,(function(t,r,a){return n=!!e(t,r,a),n})),n}function _a(t,e,n){var r=-1,a=t.length;while(++r<a){var o=t[r],s=e(o);if(null!=s&&(u===i?s===s&&!Ll(s):n(s,u)))var u=s,c=o}return c}function Ca(t,e,n,r){var a=t.length;n=Kl(n),n<0&&(n=-n>a?0:a+n),r=r===i||r>a?a:Kl(r),r<0&&(r+=a),r=n>r?0:Xl(r);while(n<r)t[n++]=e;return t}function Ta(t,e){var n=[];return ka(t,(function(t,r,a){e(t,r,a)&&n.push(t)})),n}function Ia(t,e,n,r,a){var i=-1,o=t.length;n||(n=is),a||(a=[]);while(++i<o){var s=t[i];e>0&&n(s)?e>1?Ia(s,e-1,n,r,a):Nn(a,s):r||(a[a.length]=s)}return a}var Na=lo(),Ea=lo(!0);function Aa(t,e){return t&&Na(t,e,kd)}function Ra(t,e){return t&&Ea(t,e,kd)}function ja(t,e){return _n(e,(function(e){return wl(t[e])}))}function Da(t,e){e=Vi(e,t);var n=0,r=e.length;while(null!=t&&n<r)t=t[As(e[n++])];return n&&n==r?t:i}function Fa(t,e,n){var r=e(t);return ul(t)?r:Nn(r,n(t))}function Ma(t){return null==t?t===i?ct:et:Ie&&Ie in ne(t)?Ko(t):vs(t)}function Pa(t,e){return t>e}function $a(t,e){return null!=t&&de.call(t,e)}function La(t,e){return null!=t&&e in ne(t)}function Ba(t,e,n){return t>=ze(e,n)&&t<Be(e,n)}function za(t,e,r){var a=r?Tn:Cn,o=t[0].length,s=t.length,u=s,c=n(s),l=1/0,d=[];while(u--){var h=t[u];u&&e&&(h=In(h,Yn(e))),l=ze(h.length,l),c[u]=!r&&(e||o>=120&&h.length>=120)?new Xr(u&&h):i}h=t[0];var p=-1,f=c[0];t:while(++p<o&&d.length<l){var m=h[p],g=e?e(m):m;if(m=r||0!==m?m:0,!(f?Zn(f,g):a(d,g,r))){u=s;while(--u){var b=c[u];if(!(b?Zn(b,g):a(t[u],g,r)))continue t}f&&f.push(g),d.push(m)}}return d}function Wa(t,e,n,r){return Aa(t,(function(t,a,i){e(r,n(t),a,i)})),r}function Va(t,e,n){e=Vi(e,t),t=ws(t,e);var r=null==t?t:t[As(iu(e))];return null==r?i:xn(r,t,n)}function Ua(t){return _l(t)&&Ma(t)==U}function Ga(t){return _l(t)&&Ma(t)==ht}function Ha(t){return _l(t)&&Ma(t)==K}function qa(t,e,n,r,a){return t===e||(null==t||null==e||!_l(t)&&!_l(e)?t!==t&&e!==e:Ka(t,e,n,r,qa,a))}function Ka(t,e,n,r,a,i){var o=ul(t),s=ul(e),u=o?G:Jo(t),c=s?G:Jo(e);u=u==U?nt:u,c=c==U?nt:c;var l=u==nt,d=c==nt,h=u==c;if(h&&pl(t)){if(!pl(e))return!1;o=!0,l=!1}if(h&&!l)return i||(i=new Zr),o||Bl(t)?Fo(t,e,n,r,a,i):Mo(t,e,u,n,r,a,i);if(!(n&b)){var p=l&&de.call(t,"__wrapped__"),f=d&&de.call(e,"__wrapped__");if(p||f){var m=p?t.value():t,g=f?e.value():e;return i||(i=new Zr),a(m,g,n,r,i)}}return!!h&&(i||(i=new Zr),Po(t,e,n,r,a,i))}function Xa(t){return _l(t)&&Jo(t)==Q}function Ya(t,e,n,r){var a=n.length,o=a,s=!r;if(null==t)return!o;t=ne(t);while(a--){var u=n[a];if(s&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}while(++a<o){u=n[a];var c=u[0],l=t[c],d=u[1];if(s&&u[2]){if(l===i&&!(c in t))return!1}else{var h=new Zr;if(r)var p=r(l,d,c,t,e,h);if(!(p===i?qa(d,l,b|y,r,h):p))return!1}}return!0}function Ja(t){if(!Ol(t)||ds(t))return!1;var e=wl(t)?be:Yt;return e.test(Rs(t))}function Za(t){return _l(t)&&Ma(t)==it}function Qa(t){return _l(t)&&Jo(t)==ot}function ti(t){return _l(t)&&Sl(t.length)&&!!Je[Ma(t)]}function ei(t){return"function"==typeof t?t:null==t?Eh:"object"==typeof t?ul(t)?si(t[0],t[1]):oi(t):Vh(t)}function ni(t){if(!ps(t))return Le(t);var e=[];for(var n in ne(t))de.call(t,n)&&"constructor"!=n&&e.push(n);return e}function ri(t){if(!Ol(t))return ys(t);var e=ps(t),n=[];for(var r in t)("constructor"!=r||!e&&de.call(t,r))&&n.push(r);return n}function ai(t,e){return t<e}function ii(t,e){var r=-1,a=ll(t)?n(t.length):[];return ka(t,(function(t,n,i){a[++r]=e(t,n,i)})),a}function oi(t){var e=Ho(t);return 1==e.length&&e[0][2]?ms(e[0][0],e[0][1]):function(n){return n===t||Ya(n,t,e)}}function si(t,e){return us(t)&&fs(e)?ms(As(t),e):function(n){var r=gd(n,t);return r===i&&r===e?yd(n,t):qa(e,r,b|y)}}function ui(t,e,n,r,a){t!==e&&Na(e,(function(o,s){if(a||(a=new Zr),Ol(o))ci(t,e,s,n,ui,r,a);else{var u=r?r(Ss(t,s),o,s+"",t,e,a):i;u===i&&(u=o),ua(t,s,u)}}),Sd)}function ci(t,e,n,r,a,o,s){var u=Ss(t,n),c=Ss(e,n),l=s.get(c);if(l)ua(t,n,l);else{var d=o?o(u,c,n+"",t,e,s):i,h=d===i;if(h){var p=ul(c),f=!p&&pl(c),m=!p&&!f&&Bl(c);d=c,p||f||m?ul(u)?d=u:dl(u)?d=ro(u):f?(h=!1,d=qi(c,!0)):m?(h=!1,d=Zi(c,!0)):d=[]:Dl(c)||sl(c)?(d=u,sl(u)?d=Jl(u):Ol(u)&&!wl(u)||(d=ns(c))):h=!1}h&&(s.set(c,d),a(d,c,r,o,s),s["delete"](c)),ua(t,n,d)}}function li(t,e){var n=t.length;if(n)return e+=e<0?n:0,os(e,n)?t[e]:i}function di(t,e,n){e=e.length?In(e,(function(t){return ul(t)?function(e){return Da(e,1===t.length?t[0]:t)}:t})):[Eh];var r=-1;e=In(e,Yn(Uo()));var a=ii(t,(function(t,n,a){var i=In(e,(function(e){return e(t)}));return{criteria:i,index:++r,value:t}}));return Gn(a,(function(t,e){return to(t,e,n)}))}function hi(t,e){return pi(t,e,(function(e,n){return yd(t,n)}))}function pi(t,e,n){var r=-1,a=e.length,i={};while(++r<a){var o=e[r],s=Da(t,o);n(s,o)&&Si(i,Vi(o,t),s)}return i}function fi(t){return function(e){return Da(e,t)}}function mi(t,e,n,r){var a=r?Ln:$n,i=-1,o=e.length,s=t;t===e&&(e=ro(e)),n&&(s=In(t,Yn(n)));while(++i<o){var u=0,c=e[i],l=n?n(c):c;while((u=a(s,l,u,r))>-1)s!==t&&_e.call(s,u,1),_e.call(t,u,1)}return t}function gi(t,e){var n=t?e.length:0,r=n-1;while(n--){var a=e[n];if(n==r||a!==i){var i=a;os(a)?_e.call(t,a,1):Fi(t,a)}}return t}function bi(t,e){return t+De(He()*(e-t+1))}function yi(t,e,r,a){var i=-1,o=Be(je((e-t)/(r||1)),0),s=n(o);while(o--)s[a?o:++i]=t,t+=r;return s}function vi(t,e){var n="";if(!t||e<1||e>P)return n;do{e%2&&(n+=t),e=De(e/2),e&&(t+=t)}while(e);return n}function xi(t,e){return Cs(xs(t,e,Eh),t+"")}function wi(t){return ia(zd(t))}function ki(t,e){var n=zd(t);return Ns(n,ga(e,0,n.length))}function Si(t,e,n,r){if(!Ol(t))return t;e=Vi(e,t);var a=-1,o=e.length,s=o-1,u=t;while(null!=u&&++a<o){var c=As(e[a]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(a!=s){var d=u[c];l=r?r(d,c,u):i,l===i&&(l=Ol(d)?d:os(e[a+1])?[]:{})}ca(u,c,l),u=u[c]}return t}var Oi=sn?function(t,e){return sn.set(t,e),t}:Eh,_i=Ne?function(t,e){return Ne(t,"toString",{configurable:!0,enumerable:!1,value:Ch(e),writable:!0})}:Eh;function Ci(t){return Ns(zd(t))}function Ti(t,e,r){var a=-1,i=t.length;e<0&&(e=-e>i?0:i+e),r=r>i?i:r,r<0&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;var o=n(i);while(++a<i)o[a]=t[a+e];return o}function Ii(t,e){var n;return ka(t,(function(t,r,a){return n=e(t,r,a),!n})),!!n}function Ni(t,e,n){var r=0,a=null==t?r:t.length;if("number"==typeof e&&e===e&&a<=W){while(r<a){var i=r+a>>>1,o=t[i];null!==o&&!Ll(o)&&(n?o<=e:o<e)?r=i+1:a=i}return a}return Ei(t,e,Eh,n)}function Ei(t,e,n,r){var a=0,o=null==t?0:t.length;if(0===o)return 0;e=n(e);var s=e!==e,u=null===e,c=Ll(e),l=e===i;while(a<o){var d=De((a+o)/2),h=n(t[d]),p=h!==i,f=null===h,m=h===h,g=Ll(h);if(s)var b=r||m;else b=l?m&&(r||p):u?m&&p&&(r||!f):c?m&&p&&!f&&(r||!g):!f&&!g&&(r?h<=e:h<e);b?a=d+1:o=d}return ze(o,z)}function Ai(t,e){var n=-1,r=t.length,a=0,i=[];while(++n<r){var o=t[n],s=e?e(o):o;if(!n||!al(s,u)){var u=s;i[a++]=0===o?0:o}}return i}function Ri(t){return"number"==typeof t?t:Ll(t)?L:+t}function ji(t){if("string"==typeof t)return t;if(ul(t))return In(t,ji)+"";if(Ll(t))return xr?xr.call(t):"";var e=t+"";return"0"==e&&1/t==-M?"-0":e}function Di(t,e,n){var r=-1,a=Cn,i=t.length,o=!0,u=[],c=u;if(n)o=!1,a=Tn;else if(i>=s){var l=e?null:No(t);if(l)return hr(l);o=!1,a=Zn,c=new Xr}else c=e?[]:u;t:while(++r<i){var d=t[r],h=e?e(d):d;if(d=n||0!==d?d:0,o&&h===h){var p=c.length;while(p--)if(c[p]===h)continue t;e&&c.push(h),u.push(d)}else a(c,h,n)||(c!==u&&c.push(h),u.push(d))}return u}function Fi(t,e){return e=Vi(e,t),t=ws(t,e),null==t||delete t[As(iu(e))]}function Mi(t,e,n,r){return Si(t,e,n(Da(t,e)),r)}function Pi(t,e,n,r){var a=t.length,i=r?a:-1;while((r?i--:++i<a)&&e(t[i],i,t));return n?Ti(t,r?0:i,r?i+1:a):Ti(t,r?i+1:0,r?a:i)}function $i(t,e){var n=t;return n instanceof Tr&&(n=n.value()),En(e,(function(t,e){return e.func.apply(e.thisArg,Nn([t],e.args))}),n)}function Li(t,e,r){var a=t.length;if(a<2)return a?Di(t[0]):[];var i=-1,o=n(a);while(++i<a){var s=t[i],u=-1;while(++u<a)u!=i&&(o[i]=wa(o[i]||s,t[u],e,r))}return Di(Ia(o,1),e,r)}function Bi(t,e,n){var r=-1,a=t.length,o=e.length,s={};while(++r<a){var u=r<o?e[r]:i;n(s,t[r],u)}return s}function zi(t){return dl(t)?t:[]}function Wi(t){return"function"==typeof t?t:Eh}function Vi(t,e){return ul(t)?t:us(t,e)?[t]:Es(Ql(t))}var Ui=xi;function Gi(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:Ti(t,e,n)}var Hi=Ee||function(t){return un.clearTimeout(t)};function qi(t,e){if(e)return t.slice();var n=t.length,r=we?we(n):new t.constructor(n);return t.copy(r),r}function Ki(t){var e=new t.constructor(t.byteLength);return new xe(e).set(new xe(t)),e}function Xi(t,e){var n=e?Ki(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}function Yi(t){var e=new t.constructor(t.source,qt.exec(t));return e.lastIndex=t.lastIndex,e}function Ji(t){return fr?ne(fr.call(t)):{}}function Zi(t,e){var n=e?Ki(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Qi(t,e){if(t!==e){var n=t!==i,r=null===t,a=t===t,o=Ll(t),s=e!==i,u=null===e,c=e===e,l=Ll(e);if(!u&&!l&&!o&&t>e||o&&s&&c&&!u&&!l||r&&s&&c||!n&&c||!a)return 1;if(!r&&!o&&!l&&t<e||l&&n&&a&&!r&&!o||u&&n&&a||!s&&a||!c)return-1}return 0}function to(t,e,n){var r=-1,a=t.criteria,i=e.criteria,o=a.length,s=n.length;while(++r<o){var u=Qi(a[r],i[r]);if(u){if(r>=s)return u;var c=n[r];return u*("desc"==c?-1:1)}}return t.index-e.index}function eo(t,e,r,a){var i=-1,o=t.length,s=r.length,u=-1,c=e.length,l=Be(o-s,0),d=n(c+l),h=!a;while(++u<c)d[u]=e[u];while(++i<s)(h||i<o)&&(d[r[i]]=t[i]);while(l--)d[u++]=t[i++];return d}function no(t,e,r,a){var i=-1,o=t.length,s=-1,u=r.length,c=-1,l=e.length,d=Be(o-u,0),h=n(d+l),p=!a;while(++i<d)h[i]=t[i];var f=i;while(++c<l)h[f+c]=e[c];while(++s<u)(p||i<o)&&(h[f+r[s]]=t[i++]);return h}function ro(t,e){var r=-1,a=t.length;e||(e=n(a));while(++r<a)e[r]=t[r];return e}function ao(t,e,n,r){var a=!n;n||(n={});var o=-1,s=e.length;while(++o<s){var u=e[o],c=r?r(n[u],t[u],u,n,t):i;c===i&&(c=t[u]),a?fa(n,u,c):ca(n,u,c)}return n}function io(t,e){return ao(t,Xo(t),e)}function oo(t,e){return ao(t,Yo(t),e)}function so(t,e){return function(n,r){var a=ul(n)?wn:da,i=e?e():{};return a(n,t,Uo(r,2),i)}}function uo(t){return xi((function(e,n){var r=-1,a=n.length,o=a>1?n[a-1]:i,s=a>2?n[2]:i;o=t.length>3&&"function"==typeof o?(a--,o):i,s&&ss(n[0],n[1],s)&&(o=a<3?i:o,a=1),e=ne(e);while(++r<a){var u=n[r];u&&t(e,u,r,o)}return e}))}function co(t,e){return function(n,r){if(null==n)return n;if(!ll(n))return t(n,r);var a=n.length,i=e?a:-1,o=ne(n);while(e?i--:++i<a)if(!1===r(o[i],i,o))break;return n}}function lo(t){return function(e,n,r){var a=-1,i=ne(e),o=r(e),s=o.length;while(s--){var u=o[t?s:++a];if(!1===n(i[u],u,i))break}return e}}function ho(t,e,n){var r=e&v,a=mo(t);function i(){var e=this&&this!==un&&this instanceof i?a:t;return e.apply(r?n:this,arguments)}return i}function po(t){return function(e){e=Ql(e);var n=or(e)?br(e):i,r=n?n[0]:e.charAt(0),a=n?Gi(n,1).join(""):e.slice(1);return r[t]()+a}}function fo(t){return function(e){return En(wh(Kd(e).replace(Ve,"")),t,"")}}function mo(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Sr(t.prototype),r=t.apply(n,e);return Ol(r)?r:n}}function go(t,e,r){var a=mo(t);function o(){var s=arguments.length,u=n(s),c=s,l=Vo(o);while(c--)u[c]=arguments[c];var d=s<3&&u[0]!==l&&u[s-1]!==l?[]:dr(u,l);if(s-=d.length,s<r)return To(t,e,vo,o.placeholder,i,u,d,i,i,r-s);var h=this&&this!==un&&this instanceof o?a:t;return xn(h,this,u)}return o}function bo(t){return function(e,n,r){var a=ne(e);if(!ll(e)){var o=Uo(n,3);e=kd(e),n=function(t){return o(a[t],t,a)}}var s=t(e,n,r);return s>-1?a[o?e[s]:s]:i}}function yo(t){return $o((function(e){var n=e.length,r=n,a=Cr.prototype.thru;t&&e.reverse();while(r--){var o=e[r];if("function"!=typeof o)throw new ie(c);if(a&&!s&&"wrapper"==Wo(o))var s=new Cr([],!0)}r=s?r:n;while(++r<n){o=e[r];var u=Wo(o),l="wrapper"==u?zo(o):i;s=l&&ls(l[0])&&l[1]==(C|k|O|T)&&!l[4].length&&1==l[9]?s[Wo(l[0])].apply(s,l[3]):1==o.length&&ls(o)?s[u]():s.thru(o)}return function(){var t=arguments,r=t[0];if(s&&1==t.length&&ul(r))return s.plant(r).value();var a=0,i=n?e[a].apply(this,t):r;while(++a<n)i=e[a].call(this,i);return i}}))}function vo(t,e,r,a,o,s,u,c,l,d){var h=e&C,p=e&v,f=e&x,m=e&(k|S),g=e&I,b=f?i:mo(t);function y(){var i=arguments.length,v=n(i),x=i;while(x--)v[x]=arguments[x];if(m)var w=Vo(y),k=er(v,w);if(a&&(v=eo(v,a,o,m)),s&&(v=no(v,s,u,m)),i-=k,m&&i<d){var S=dr(v,w);return To(t,e,vo,y.placeholder,r,v,S,c,l,d-i)}var O=p?r:this,_=f?O[t]:t;return i=v.length,c?v=ks(v,c):g&&i>1&&v.reverse(),h&&l<i&&(v.length=l),this&&this!==un&&this instanceof y&&(_=b||mo(_)),_.apply(O,v)}return y}function xo(t,e){return function(n,r){return Wa(n,t,e(r),{})}}function wo(t,e){return function(n,r){var a;if(n===i&&r===i)return e;if(n!==i&&(a=n),r!==i){if(a===i)return r;"string"==typeof n||"string"==typeof r?(n=ji(n),r=ji(r)):(n=Ri(n),r=Ri(r)),a=t(n,r)}return a}}function ko(t){return $o((function(e){return e=In(e,Yn(Uo())),xi((function(n){var r=this;return t(e,(function(t){return xn(t,r,n)}))}))}))}function So(t,e){e=e===i?" ":ji(e);var n=e.length;if(n<2)return n?vi(e,t):e;var r=vi(e,je(t/gr(e)));return or(e)?Gi(br(r),0,t).join(""):r.slice(0,t)}function Oo(t,e,r,a){var i=e&v,o=mo(t);function s(){var e=-1,u=arguments.length,c=-1,l=a.length,d=n(l+u),h=this&&this!==un&&this instanceof s?o:t;while(++c<l)d[c]=a[c];while(u--)d[c++]=arguments[++e];return xn(h,i?r:this,d)}return s}function _o(t){return function(e,n,r){return r&&"number"!=typeof r&&ss(e,n,r)&&(n=r=i),e=ql(e),n===i?(n=e,e=0):n=ql(n),r=r===i?e<n?1:-1:ql(r),yi(e,n,r,t)}}function Co(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=Yl(e),n=Yl(n)),t(e,n)}}function To(t,e,n,r,a,o,s,u,c,l){var d=e&k,h=d?s:i,p=d?i:s,f=d?o:i,m=d?i:o;e|=d?O:_,e&=~(d?_:O),e&w||(e&=~(v|x));var g=[t,e,a,f,h,m,p,u,c,l],b=n.apply(i,g);return ls(t)&&Os(b,g),b.placeholder=r,Ts(b,t,e)}function Io(t){var e=Vt[t];return function(t,n){if(t=Yl(t),n=null==n?0:ze(Kl(n),292),n&&Pe(t)){var r=(Ql(t)+"e").split("e"),a=e(r[0]+"e"+(+r[1]+n));return r=(Ql(a)+"e").split("e"),+(r[0]+"e"+(+r[1]-n))}return e(t)}}var No=en&&1/hr(new en([,-0]))[1]==M?function(t){return new en(t)}:$h;function Eo(t){return function(e){var n=Jo(e);return n==Q?cr(e):n==ot?pr(e):Kn(e,t(e))}}function Ao(t,e,n,r,a,o,s,u){var l=e&x;if(!l&&"function"!=typeof t)throw new ie(c);var d=r?r.length:0;if(d||(e&=~(O|_),r=a=i),s=s===i?s:Be(Kl(s),0),u=u===i?u:Kl(u),d-=a?a.length:0,e&_){var h=r,p=a;r=a=i}var f=l?i:zo(t),m=[t,e,n,r,a,h,p,o,s,u];if(f&&bs(m,f),t=m[0],e=m[1],n=m[2],r=m[3],a=m[4],u=m[9]=m[9]===i?l?0:t.length:Be(m[9]-d,0),!u&&e&(k|S)&&(e&=~(k|S)),e&&e!=v)g=e==k||e==S?go(t,e,u):e!=O&&e!=(v|O)||a.length?vo.apply(i,m):Oo(t,e,n,r);else var g=ho(t,e,n);var b=f?Oi:Os;return Ts(b(g,m),t,e)}function Ro(t,e,n,r){return t===i||al(t,ue[n])&&!de.call(r,n)?e:t}function jo(t,e,n,r,a,o){return Ol(t)&&Ol(e)&&(o.set(e,t),ui(t,e,i,jo,o),o["delete"](e)),t}function Do(t){return Dl(t)?i:t}function Fo(t,e,n,r,a,o){var s=n&b,u=t.length,c=e.length;if(u!=c&&!(s&&c>u))return!1;var l=o.get(t),d=o.get(e);if(l&&d)return l==e&&d==t;var h=-1,p=!0,f=n&y?new Xr:i;o.set(t,e),o.set(e,t);while(++h<u){var m=t[h],g=e[h];if(r)var v=s?r(g,m,h,e,t,o):r(m,g,h,t,e,o);if(v!==i){if(v)continue;p=!1;break}if(f){if(!Rn(e,(function(t,e){if(!Zn(f,e)&&(m===t||a(m,t,n,r,o)))return f.push(e)}))){p=!1;break}}else if(m!==g&&!a(m,g,n,r,o)){p=!1;break}}return o["delete"](t),o["delete"](e),p}function Mo(t,e,n,r,a,i,o){switch(n){case pt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ht:return!(t.byteLength!=e.byteLength||!i(new xe(t),new xe(e)));case q:case K:case tt:return al(+t,+e);case Y:return t.name==e.name&&t.message==e.message;case it:case st:return t==e+"";case Q:var s=cr;case ot:var u=r&b;if(s||(s=hr),t.size!=e.size&&!u)return!1;var c=o.get(t);if(c)return c==e;r|=y,o.set(t,e);var l=Fo(s(t),s(e),r,a,i,o);return o["delete"](t),l;case ut:if(fr)return fr.call(t)==fr.call(e)}return!1}function Po(t,e,n,r,a,o){var s=n&b,u=Lo(t),c=u.length,l=Lo(e),d=l.length;if(c!=d&&!s)return!1;var h=c;while(h--){var p=u[h];if(!(s?p in e:de.call(e,p)))return!1}var f=o.get(t),m=o.get(e);if(f&&m)return f==e&&m==t;var g=!0;o.set(t,e),o.set(e,t);var y=s;while(++h<c){p=u[h];var v=t[p],x=e[p];if(r)var w=s?r(x,v,p,e,t,o):r(v,x,p,t,e,o);if(!(w===i?v===x||a(v,x,n,r,o):w)){g=!1;break}y||(y="constructor"==p)}if(g&&!y){var k=t.constructor,S=e.constructor;k==S||!("constructor"in t)||!("constructor"in e)||"function"==typeof k&&k instanceof k&&"function"==typeof S&&S instanceof S||(g=!1)}return o["delete"](t),o["delete"](e),g}function $o(t){return Cs(xs(t,i,Ks),t+"")}function Lo(t){return Fa(t,kd,Xo)}function Bo(t){return Fa(t,Sd,Yo)}var zo=sn?function(t){return sn.get(t)}:$h;function Wo(t){var e=t.name+"",n=cn[e],r=de.call(cn,e)?n.length:0;while(r--){var a=n[r],i=a.func;if(null==i||i==t)return a.name}return e}function Vo(t){var e=de.call(wr,"placeholder")?wr:t;return e.placeholder}function Uo(){var t=wr.iteratee||Ah;return t=t===Ah?ei:t,arguments.length?t(arguments[0],arguments[1]):t}function Go(t,e){var n=t.__data__;return cs(e)?n["string"==typeof e?"string":"hash"]:n.map}function Ho(t){var e=kd(t),n=e.length;while(n--){var r=e[n],a=t[r];e[n]=[r,a,fs(a)]}return e}function qo(t,e){var n=ir(t,e);return Ja(n)?n:i}function Ko(t){var e=de.call(t,Ie),n=t[Ie];try{t[Ie]=i;var r=!0}catch(o){}var a=fe.call(t);return r&&(e?t[Ie]=n:delete t[Ie]),a}var Xo=Fe?function(t){return null==t?[]:(t=ne(t),_n(Fe(t),(function(e){return Oe.call(t,e)})))}:qh,Yo=Fe?function(t){var e=[];while(t)Nn(e,Xo(t)),t=ke(t);return e}:qh,Jo=Ma;function Zo(t,e,n){var r=-1,a=n.length;while(++r<a){var i=n[r],o=i.size;switch(i.type){case"drop":t+=o;break;case"dropRight":e-=o;break;case"take":e=ze(e,t+o);break;case"takeRight":t=Be(t,e-o);break}}return{start:t,end:e}}function Qo(t){var e=t.match(zt);return e?e[1].split(Wt):[]}function ts(t,e,n){e=Vi(e,t);var r=-1,a=e.length,i=!1;while(++r<a){var o=As(e[r]);if(!(i=null!=t&&n(t,o)))break;t=t[o]}return i||++r!=a?i:(a=null==t?0:t.length,!!a&&Sl(a)&&os(o,a)&&(ul(t)||sl(t)))}function es(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&de.call(t,"index")&&(n.index=t.index,n.input=t.input),n}function ns(t){return"function"!=typeof t.constructor||ps(t)?{}:Sr(ke(t))}function rs(t,e,n){var r=t.constructor;switch(e){case ht:return Ki(t);case q:case K:return new r(+t);case pt:return Xi(t,n);case ft:case mt:case gt:case bt:case yt:case vt:case xt:case wt:case kt:return Zi(t,n);case Q:return new r;case tt:case st:return new r(t);case it:return Yi(t);case ot:return new r;case ut:return Ji(t)}}function as(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(Bt,"{\n/* [wrapped with "+e+"] */\n")}function is(t){return ul(t)||sl(t)||!!(Ce&&t&&t[Ce])}function os(t,e){var n=typeof t;return e=null==e?P:e,!!e&&("number"==n||"symbol"!=n&&Zt.test(t))&&t>-1&&t%1==0&&t<e}function ss(t,e,n){if(!Ol(n))return!1;var r=typeof e;return!!("number"==r?ll(n)&&os(e,n.length):"string"==r&&e in n)&&al(n[e],t)}function us(t,e){if(ul(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!Ll(t))||(Dt.test(t)||!jt.test(t)||null!=e&&t in ne(e))}function cs(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ls(t){var e=Wo(t),n=wr[e];if("function"!=typeof n||!(e in Tr.prototype))return!1;if(t===n)return!0;var r=zo(n);return!!r&&t===r[0]}function ds(t){return!!pe&&pe in t}(Ke&&Jo(new Ke(new ArrayBuffer(1)))!=pt||Qe&&Jo(new Qe)!=Q||tn&&Jo(tn.resolve())!=rt||en&&Jo(new en)!=ot||nn&&Jo(new nn)!=lt)&&(Jo=function(t){var e=Ma(t),n=e==nt?t.constructor:i,r=n?Rs(n):"";if(r)switch(r){case ln:return pt;case hn:return Q;case pn:return rt;case jn:return ot;case Dn:return lt}return e});var hs=ce?wl:Kh;function ps(t){var e=t&&t.constructor,n="function"==typeof e&&e.prototype||ue;return t===n}function fs(t){return t===t&&!Ol(t)}function ms(t,e){return function(n){return null!=n&&(n[t]===e&&(e!==i||t in ne(n)))}}function gs(t){var e=Bc(t,(function(t){return n.size===h&&n.clear(),t})),n=e.cache;return e}function bs(t,e){var n=t[1],r=e[1],a=n|r,i=a<(v|x|C),o=r==C&&n==k||r==C&&n==T&&t[7].length<=e[8]||r==(C|T)&&e[7].length<=e[8]&&n==k;if(!i&&!o)return t;r&v&&(t[2]=e[2],a|=n&v?0:w);var s=e[3];if(s){var u=t[3];t[3]=u?eo(u,s,e[4]):s,t[4]=u?dr(t[3],p):e[4]}return s=e[5],s&&(u=t[5],t[5]=u?no(u,s,e[6]):s,t[6]=u?dr(t[5],p):e[6]),s=e[7],s&&(t[7]=s),r&C&&(t[8]=null==t[8]?e[8]:ze(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=a,t}function ys(t){var e=[];if(null!=t)for(var n in ne(t))e.push(n);return e}function vs(t){return fe.call(t)}function xs(t,e,r){return e=Be(e===i?t.length-1:e,0),function(){var a=arguments,i=-1,o=Be(a.length-e,0),s=n(o);while(++i<o)s[i]=a[e+i];i=-1;var u=n(e+1);while(++i<e)u[i]=a[i];return u[e]=r(s),xn(t,this,u)}}function ws(t,e){return e.length<2?t:Da(t,Ti(e,0,-1))}function ks(t,e){var n=t.length,r=ze(e.length,n),a=ro(t);while(r--){var o=e[r];t[r]=os(o,n)?a[o]:i}return t}function Ss(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}var Os=Is(Oi),_s=Re||function(t,e){return un.setTimeout(t,e)},Cs=Is(_i);function Ts(t,e,n){var r=e+"";return Cs(t,as(r,js(Qo(r),n)))}function Is(t){var e=0,n=0;return function(){var r=We(),a=R-(r-n);if(n=r,a>0){if(++e>=A)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Ns(t,e){var n=-1,r=t.length,a=r-1;e=e===i?r:e;while(++n<e){var o=bi(n,a),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}var Es=gs((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Ft,(function(t,n,r,a){e.push(r?a.replace(Gt,"$1"):n||t)})),e}));function As(t){if("string"==typeof t||Ll(t))return t;var e=t+"";return"0"==e&&1/t==-M?"-0":e}function Rs(t){if(null!=t){try{return le.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function js(t,e){return kn(V,(function(n){var r="_."+n[0];e&n[1]&&!Cn(t,r)&&t.push(r)})),t.sort()}function Ds(t){if(t instanceof Tr)return t.clone();var e=new Cr(t.__wrapped__,t.__chain__);return e.__actions__=ro(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Fs(t,e,r){e=(r?ss(t,e,r):e===i)?1:Be(Kl(e),0);var a=null==t?0:t.length;if(!a||e<1)return[];var o=0,s=0,u=n(je(a/e));while(o<a)u[s++]=Ti(t,o,o+=e);return u}function Ms(t){var e=-1,n=null==t?0:t.length,r=0,a=[];while(++e<n){var i=t[e];i&&(a[r++]=i)}return a}function Ps(){var t=arguments.length;if(!t)return[];var e=n(t-1),r=arguments[0],a=t;while(a--)e[a-1]=arguments[a];return Nn(ul(r)?ro(r):[r],Ia(e,1))}var $s=xi((function(t,e){return dl(t)?wa(t,Ia(e,1,dl,!0)):[]})),Ls=xi((function(t,e){var n=iu(e);return dl(n)&&(n=i),dl(t)?wa(t,Ia(e,1,dl,!0),Uo(n,2)):[]})),Bs=xi((function(t,e){var n=iu(e);return dl(n)&&(n=i),dl(t)?wa(t,Ia(e,1,dl,!0),i,n):[]}));function zs(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===i?1:Kl(e),Ti(t,e<0?0:e,r)):[]}function Ws(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===i?1:Kl(e),e=r-e,Ti(t,0,e<0?0:e)):[]}function Vs(t,e){return t&&t.length?Pi(t,Uo(e,3),!0,!0):[]}function Us(t,e){return t&&t.length?Pi(t,Uo(e,3),!0):[]}function Gs(t,e,n,r){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&ss(t,e,n)&&(n=0,r=a),Ca(t,e,n,r)):[]}function Hs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=null==n?0:Kl(n);return a<0&&(a=Be(r+a,0)),Pn(t,Uo(e,3),a)}function qs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=r-1;return n!==i&&(a=Kl(n),a=n<0?Be(r+a,0):ze(a,r-1)),Pn(t,Uo(e,3),a,!0)}function Ks(t){var e=null==t?0:t.length;return e?Ia(t,1):[]}function Xs(t){var e=null==t?0:t.length;return e?Ia(t,M):[]}function Ys(t,e){var n=null==t?0:t.length;return n?(e=e===i?1:Kl(e),Ia(t,e)):[]}function Js(t){var e=-1,n=null==t?0:t.length,r={};while(++e<n){var a=t[e];r[a[0]]=a[1]}return r}function Zs(t){return t&&t.length?t[0]:i}function Qs(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=null==n?0:Kl(n);return a<0&&(a=Be(r+a,0)),$n(t,e,a)}function tu(t){var e=null==t?0:t.length;return e?Ti(t,0,-1):[]}var eu=xi((function(t){var e=In(t,zi);return e.length&&e[0]===t[0]?za(e):[]})),nu=xi((function(t){var e=iu(t),n=In(t,zi);return e===iu(n)?e=i:n.pop(),n.length&&n[0]===t[0]?za(n,Uo(e,2)):[]})),ru=xi((function(t){var e=iu(t),n=In(t,zi);return e="function"==typeof e?e:i,e&&n.pop(),n.length&&n[0]===t[0]?za(n,i,e):[]}));function au(t,e){return null==t?"":$e.call(t,e)}function iu(t){var e=null==t?0:t.length;return e?t[e-1]:i}function ou(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var a=r;return n!==i&&(a=Kl(n),a=a<0?Be(r+a,0):ze(a,r-1)),e===e?mr(t,e,a):Pn(t,Bn,a,!0)}function su(t,e){return t&&t.length?li(t,Kl(e)):i}var uu=xi(cu);function cu(t,e){return t&&t.length&&e&&e.length?mi(t,e):t}function lu(t,e,n){return t&&t.length&&e&&e.length?mi(t,e,Uo(n,2)):t}function du(t,e,n){return t&&t.length&&e&&e.length?mi(t,e,i,n):t}var hu=$o((function(t,e){var n=null==t?0:t.length,r=ma(t,e);return gi(t,In(e,(function(t){return os(t,n)?+t:t})).sort(Qi)),r}));function pu(t,e){var n=[];if(!t||!t.length)return n;var r=-1,a=[],i=t.length;e=Uo(e,3);while(++r<i){var o=t[r];e(o,r,t)&&(n.push(o),a.push(r))}return gi(t,a),n}function fu(t){return null==t?t:qe.call(t)}function mu(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&ss(t,e,n)?(e=0,n=r):(e=null==e?0:Kl(e),n=n===i?r:Kl(n)),Ti(t,e,n)):[]}function gu(t,e){return Ni(t,e)}function bu(t,e,n){return Ei(t,e,Uo(n,2))}function yu(t,e){var n=null==t?0:t.length;if(n){var r=Ni(t,e);if(r<n&&al(t[r],e))return r}return-1}function vu(t,e){return Ni(t,e,!0)}function xu(t,e,n){return Ei(t,e,Uo(n,2),!0)}function wu(t,e){var n=null==t?0:t.length;if(n){var r=Ni(t,e,!0)-1;if(al(t[r],e))return r}return-1}function ku(t){return t&&t.length?Ai(t):[]}function Su(t,e){return t&&t.length?Ai(t,Uo(e,2)):[]}function Ou(t){var e=null==t?0:t.length;return e?Ti(t,1,e):[]}function _u(t,e,n){return t&&t.length?(e=n||e===i?1:Kl(e),Ti(t,0,e<0?0:e)):[]}function Cu(t,e,n){var r=null==t?0:t.length;return r?(e=n||e===i?1:Kl(e),e=r-e,Ti(t,e<0?0:e,r)):[]}function Tu(t,e){return t&&t.length?Pi(t,Uo(e,3),!1,!0):[]}function Iu(t,e){return t&&t.length?Pi(t,Uo(e,3)):[]}var Nu=xi((function(t){return Di(Ia(t,1,dl,!0))})),Eu=xi((function(t){var e=iu(t);return dl(e)&&(e=i),Di(Ia(t,1,dl,!0),Uo(e,2))})),Au=xi((function(t){var e=iu(t);return e="function"==typeof e?e:i,Di(Ia(t,1,dl,!0),i,e)}));function Ru(t){return t&&t.length?Di(t):[]}function ju(t,e){return t&&t.length?Di(t,Uo(e,2)):[]}function Du(t,e){return e="function"==typeof e?e:i,t&&t.length?Di(t,i,e):[]}function Fu(t){if(!t||!t.length)return[];var e=0;return t=_n(t,(function(t){if(dl(t))return e=Be(t.length,e),!0})),qn(e,(function(e){return In(t,Wn(e))}))}function Mu(t,e){if(!t||!t.length)return[];var n=Fu(t);return null==e?n:In(n,(function(t){return xn(e,i,t)}))}var Pu=xi((function(t,e){return dl(t)?wa(t,e):[]})),$u=xi((function(t){return Li(_n(t,dl))})),Lu=xi((function(t){var e=iu(t);return dl(e)&&(e=i),Li(_n(t,dl),Uo(e,2))})),Bu=xi((function(t){var e=iu(t);return e="function"==typeof e?e:i,Li(_n(t,dl),i,e)})),zu=xi(Fu);function Wu(t,e){return Bi(t||[],e||[],ca)}function Vu(t,e){return Bi(t||[],e||[],Si)}var Uu=xi((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,Mu(t,n)}));function Gu(t){var e=wr(t);return e.__chain__=!0,e}function Hu(t,e){return e(t),t}function qu(t,e){return e(t)}var Ku=$o((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,a=function(e){return ma(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Tr&&os(n)?(r=r.slice(n,+n+(e?1:0)),r.__actions__.push({func:qu,args:[a],thisArg:i}),new Cr(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(a)}));function Xu(){return Gu(this)}function Yu(){return new Cr(this.value(),this.__chain__)}function Ju(){this.__values__===i&&(this.__values__=Hl(this.value()));var t=this.__index__>=this.__values__.length,e=t?i:this.__values__[this.__index__++];return{done:t,value:e}}function Zu(){return this}function Qu(t){var e,n=this;while(n instanceof _r){var r=Ds(n);r.__index__=0,r.__values__=i,e?a.__wrapped__=r:e=r;var a=r;n=n.__wrapped__}return a.__wrapped__=t,e}function tc(){var t=this.__wrapped__;if(t instanceof Tr){var e=t;return this.__actions__.length&&(e=new Tr(this)),e=e.reverse(),e.__actions__.push({func:qu,args:[fu],thisArg:i}),new Cr(e,this.__chain__)}return this.thru(fu)}function ec(){return $i(this.__wrapped__,this.__actions__)}var nc=so((function(t,e,n){de.call(t,n)?++t[n]:fa(t,n,1)}));function rc(t,e,n){var r=ul(t)?On:Oa;return n&&ss(t,e,n)&&(e=i),r(t,Uo(e,3))}function ac(t,e){var n=ul(t)?_n:Ta;return n(t,Uo(e,3))}var ic=bo(Hs),oc=bo(qs);function sc(t,e){return Ia(gc(t,e),1)}function uc(t,e){return Ia(gc(t,e),M)}function cc(t,e,n){return n=n===i?1:Kl(n),Ia(gc(t,e),n)}function lc(t,e){var n=ul(t)?kn:ka;return n(t,Uo(e,3))}function dc(t,e){var n=ul(t)?Sn:Sa;return n(t,Uo(e,3))}var hc=so((function(t,e,n){de.call(t,n)?t[n].push(e):fa(t,n,[e])}));function pc(t,e,n,r){t=ll(t)?t:zd(t),n=n&&!r?Kl(n):0;var a=t.length;return n<0&&(n=Be(a+n,0)),$l(t)?n<=a&&t.indexOf(e,n)>-1:!!a&&$n(t,e,n)>-1}var fc=xi((function(t,e,r){var a=-1,i="function"==typeof e,o=ll(t)?n(t.length):[];return ka(t,(function(t){o[++a]=i?xn(e,t,r):Va(t,e,r)})),o})),mc=so((function(t,e,n){fa(t,n,e)}));function gc(t,e){var n=ul(t)?In:ii;return n(t,Uo(e,3))}function bc(t,e,n,r){return null==t?[]:(ul(e)||(e=null==e?[]:[e]),n=r?i:n,ul(n)||(n=null==n?[]:[n]),di(t,e,n))}var yc=so((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]}));function vc(t,e,n){var r=ul(t)?En:Un,a=arguments.length<3;return r(t,Uo(e,4),n,a,ka)}function xc(t,e,n){var r=ul(t)?An:Un,a=arguments.length<3;return r(t,Uo(e,4),n,a,Sa)}function wc(t,e){var n=ul(t)?_n:Ta;return n(t,zc(Uo(e,3)))}function kc(t){var e=ul(t)?ia:wi;return e(t)}function Sc(t,e,n){e=(n?ss(t,e,n):e===i)?1:Kl(e);var r=ul(t)?oa:ki;return r(t,e)}function Oc(t){var e=ul(t)?sa:Ci;return e(t)}function _c(t){if(null==t)return 0;if(ll(t))return $l(t)?gr(t):t.length;var e=Jo(t);return e==Q||e==ot?t.size:ni(t).length}function Cc(t,e,n){var r=ul(t)?Rn:Ii;return n&&ss(t,e,n)&&(e=i),r(t,Uo(e,3))}var Tc=xi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&ss(t,e[0],e[1])?e=[]:n>2&&ss(e[0],e[1],e[2])&&(e=[e[0]]),di(t,Ia(e,1),[])})),Ic=Ae||function(){return un.Date.now()};function Nc(t,e){if("function"!=typeof e)throw new ie(c);return t=Kl(t),function(){if(--t<1)return e.apply(this,arguments)}}function Ec(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,Ao(t,C,i,i,i,i,e)}function Ac(t,e){var n;if("function"!=typeof e)throw new ie(c);return t=Kl(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Rc=xi((function(t,e,n){var r=v;if(n.length){var a=dr(n,Vo(Rc));r|=O}return Ao(t,r,e,n,a)})),jc=xi((function(t,e,n){var r=v|x;if(n.length){var a=dr(n,Vo(jc));r|=O}return Ao(e,r,t,n,a)}));function Dc(t,e,n){e=n?i:e;var r=Ao(t,k,i,i,i,i,i,e);return r.placeholder=Dc.placeholder,r}function Fc(t,e,n){e=n?i:e;var r=Ao(t,S,i,i,i,i,i,e);return r.placeholder=Fc.placeholder,r}function Mc(t,e,n){var r,a,o,s,u,l,d=0,h=!1,p=!1,f=!0;if("function"!=typeof t)throw new ie(c);function m(e){var n=r,o=a;return r=a=i,d=e,s=t.apply(o,n),s}function g(t){return d=t,u=_s(v,e),h?m(t):s}function b(t){var n=t-l,r=t-d,a=e-n;return p?ze(a,o-r):a}function y(t){var n=t-l,r=t-d;return l===i||n>=e||n<0||p&&r>=o}function v(){var t=Ic();if(y(t))return x(t);u=_s(v,b(t))}function x(t){return u=i,f&&r?m(t):(r=a=i,s)}function w(){u!==i&&Hi(u),d=0,r=l=a=u=i}function k(){return u===i?s:x(Ic())}function S(){var t=Ic(),n=y(t);if(r=arguments,a=this,l=t,n){if(u===i)return g(l);if(p)return Hi(u),u=_s(v,e),m(l)}return u===i&&(u=_s(v,e)),s}return e=Yl(e)||0,Ol(n)&&(h=!!n.leading,p="maxWait"in n,o=p?Be(Yl(n.maxWait)||0,e):o,f="trailing"in n?!!n.trailing:f),S.cancel=w,S.flush=k,S}var Pc=xi((function(t,e){return xa(t,1,e)})),$c=xi((function(t,e,n){return xa(t,Yl(e)||0,n)}));function Lc(t){return Ao(t,I)}function Bc(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new ie(c);var n=function(){var r=arguments,a=e?e.apply(this,r):r[0],i=n.cache;if(i.has(a))return i.get(a);var o=t.apply(this,r);return n.cache=i.set(a,o)||i,o};return n.cache=new(Bc.Cache||Vr),n}function zc(t){if("function"!=typeof t)throw new ie(c);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Wc(t){return Ac(2,t)}Bc.Cache=Vr;var Vc=Ui((function(t,e){e=1==e.length&&ul(e[0])?In(e[0],Yn(Uo())):In(Ia(e,1),Yn(Uo()));var n=e.length;return xi((function(r){var a=-1,i=ze(r.length,n);while(++a<i)r[a]=e[a].call(this,r[a]);return xn(t,this,r)}))})),Uc=xi((function(t,e){var n=dr(e,Vo(Uc));return Ao(t,O,i,e,n)})),Gc=xi((function(t,e){var n=dr(e,Vo(Gc));return Ao(t,_,i,e,n)})),Hc=$o((function(t,e){return Ao(t,T,i,i,i,e)}));function qc(t,e){if("function"!=typeof t)throw new ie(c);return e=e===i?e:Kl(e),xi(t,e)}function Kc(t,e){if("function"!=typeof t)throw new ie(c);return e=null==e?0:Be(Kl(e),0),xi((function(n){var r=n[e],a=Gi(n,0,e);return r&&Nn(a,r),xn(t,this,a)}))}function Xc(t,e,n){var r=!0,a=!0;if("function"!=typeof t)throw new ie(c);return Ol(n)&&(r="leading"in n?!!n.leading:r,a="trailing"in n?!!n.trailing:a),Mc(t,e,{leading:r,maxWait:e,trailing:a})}function Yc(t){return Ec(t,1)}function Jc(t,e){return Uc(Wi(e),t)}function Zc(){if(!arguments.length)return[];var t=arguments[0];return ul(t)?t:[t]}function Qc(t){return ba(t,g)}function tl(t,e){return e="function"==typeof e?e:i,ba(t,g,e)}function el(t){return ba(t,f|g)}function nl(t,e){return e="function"==typeof e?e:i,ba(t,f|g,e)}function rl(t,e){return null==e||va(t,e,kd(e))}function al(t,e){return t===e||t!==t&&e!==e}var il=Co(Pa),ol=Co((function(t,e){return t>=e})),sl=Ua(function(){return arguments}())?Ua:function(t){return _l(t)&&de.call(t,"callee")&&!Oe.call(t,"callee")},ul=n.isArray,cl=fn?Yn(fn):Ga;function ll(t){return null!=t&&Sl(t.length)&&!wl(t)}function dl(t){return _l(t)&&ll(t)}function hl(t){return!0===t||!1===t||_l(t)&&Ma(t)==q}var pl=Me||Kh,fl=mn?Yn(mn):Ha;function ml(t){return _l(t)&&1===t.nodeType&&!Dl(t)}function gl(t){if(null==t)return!0;if(ll(t)&&(ul(t)||"string"==typeof t||"function"==typeof t.splice||pl(t)||Bl(t)||sl(t)))return!t.length;var e=Jo(t);if(e==Q||e==ot)return!t.size;if(ps(t))return!ni(t).length;for(var n in t)if(de.call(t,n))return!1;return!0}function bl(t,e){return qa(t,e)}function yl(t,e,n){n="function"==typeof n?n:i;var r=n?n(t,e):i;return r===i?qa(t,e,i,n):!!r}function vl(t){if(!_l(t))return!1;var e=Ma(t);return e==Y||e==X||"string"==typeof t.message&&"string"==typeof t.name&&!Dl(t)}function xl(t){return"number"==typeof t&&Pe(t)}function wl(t){if(!Ol(t))return!1;var e=Ma(t);return e==J||e==Z||e==H||e==at}function kl(t){return"number"==typeof t&&t==Kl(t)}function Sl(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=P}function Ol(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function _l(t){return null!=t&&"object"==typeof t}var Cl=gn?Yn(gn):Xa;function Tl(t,e){return t===e||Ya(t,e,Ho(e))}function Il(t,e,n){return n="function"==typeof n?n:i,Ya(t,e,Ho(e),n)}function Nl(t){return jl(t)&&t!=+t}function El(t){if(hs(t))throw new a(u);return Ja(t)}function Al(t){return null===t}function Rl(t){return null==t}function jl(t){return"number"==typeof t||_l(t)&&Ma(t)==tt}function Dl(t){if(!_l(t)||Ma(t)!=nt)return!1;var e=ke(t);if(null===e)return!0;var n=de.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&le.call(n)==me}var Fl=bn?Yn(bn):Za;function Ml(t){return kl(t)&&t>=-P&&t<=P}var Pl=yn?Yn(yn):Qa;function $l(t){return"string"==typeof t||!ul(t)&&_l(t)&&Ma(t)==st}function Ll(t){return"symbol"==typeof t||_l(t)&&Ma(t)==ut}var Bl=vn?Yn(vn):ti;function zl(t){return t===i}function Wl(t){return _l(t)&&Jo(t)==lt}function Vl(t){return _l(t)&&Ma(t)==dt}var Ul=Co(ai),Gl=Co((function(t,e){return t<=e}));function Hl(t){if(!t)return[];if(ll(t))return $l(t)?br(t):ro(t);if(Te&&t[Te])return ur(t[Te]());var e=Jo(t),n=e==Q?cr:e==ot?hr:zd;return n(t)}function ql(t){if(!t)return 0===t?t:0;if(t=Yl(t),t===M||t===-M){var e=t<0?-1:1;return e*$}return t===t?t:0}function Kl(t){var e=ql(t),n=e%1;return e===e?n?e-n:e:0}function Xl(t){return t?ga(Kl(t),0,B):0}function Yl(t){if("number"==typeof t)return t;if(Ll(t))return L;if(Ol(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ol(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xn(t);var n=Xt.test(t);return n||Jt.test(t)?an(t.slice(2),n?2:8):Kt.test(t)?L:+t}function Jl(t){return ao(t,Sd(t))}function Zl(t){return t?ga(Kl(t),-P,P):0===t?t:0}function Ql(t){return null==t?"":ji(t)}var td=uo((function(t,e){if(ps(e)||ll(e))ao(e,kd(e),t);else for(var n in e)de.call(e,n)&&ca(t,n,e[n])})),ed=uo((function(t,e){ao(e,Sd(e),t)})),nd=uo((function(t,e,n,r){ao(e,Sd(e),t,r)})),rd=uo((function(t,e,n,r){ao(e,kd(e),t,r)})),ad=$o(ma);function id(t,e){var n=Sr(t);return null==e?n:ha(n,e)}var od=xi((function(t,e){t=ne(t);var n=-1,r=e.length,a=r>2?e[2]:i;a&&ss(e[0],e[1],a)&&(r=1);while(++n<r){var o=e[n],s=Sd(o),u=-1,c=s.length;while(++u<c){var l=s[u],d=t[l];(d===i||al(d,ue[l])&&!de.call(t,l))&&(t[l]=o[l])}}return t})),sd=xi((function(t){return t.push(i,jo),xn(Td,i,t)}));function ud(t,e){return Mn(t,Uo(e,3),Aa)}function cd(t,e){return Mn(t,Uo(e,3),Ra)}function ld(t,e){return null==t?t:Na(t,Uo(e,3),Sd)}function dd(t,e){return null==t?t:Ea(t,Uo(e,3),Sd)}function hd(t,e){return t&&Aa(t,Uo(e,3))}function pd(t,e){return t&&Ra(t,Uo(e,3))}function fd(t){return null==t?[]:ja(t,kd(t))}function md(t){return null==t?[]:ja(t,Sd(t))}function gd(t,e,n){var r=null==t?i:Da(t,e);return r===i?n:r}function bd(t,e){return null!=t&&ts(t,e,$a)}function yd(t,e){return null!=t&&ts(t,e,La)}var vd=xo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),t[e]=n}),Ch(Eh)),xd=xo((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),de.call(t,e)?t[e].push(n):t[e]=[n]}),Uo),wd=xi(Va);function kd(t){return ll(t)?aa(t):ni(t)}function Sd(t){return ll(t)?aa(t,!0):ri(t)}function Od(t,e){var n={};return e=Uo(e,3),Aa(t,(function(t,r,a){fa(n,e(t,r,a),t)})),n}function _d(t,e){var n={};return e=Uo(e,3),Aa(t,(function(t,r,a){fa(n,r,e(t,r,a))})),n}var Cd=uo((function(t,e,n){ui(t,e,n)})),Td=uo((function(t,e,n,r){ui(t,e,n,r)})),Id=$o((function(t,e){var n={};if(null==t)return n;var r=!1;e=In(e,(function(e){return e=Vi(e,t),r||(r=e.length>1),e})),ao(t,Bo(t),n),r&&(n=ba(n,f|m|g,Do));var a=e.length;while(a--)Fi(n,e[a]);return n}));function Nd(t,e){return Ad(t,zc(Uo(e)))}var Ed=$o((function(t,e){return null==t?{}:hi(t,e)}));function Ad(t,e){if(null==t)return{};var n=In(Bo(t),(function(t){return[t]}));return e=Uo(e),pi(t,n,(function(t,n){return e(t,n[0])}))}function Rd(t,e,n){e=Vi(e,t);var r=-1,a=e.length;a||(a=1,t=i);while(++r<a){var o=null==t?i:t[As(e[r])];o===i&&(r=a,o=n),t=wl(o)?o.call(t):o}return t}function jd(t,e,n){return null==t?t:Si(t,e,n)}function Dd(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Si(t,e,n,r)}var Fd=Eo(kd),Md=Eo(Sd);function Pd(t,e,n){var r=ul(t),a=r||pl(t)||Bl(t);if(e=Uo(e,4),null==n){var i=t&&t.constructor;n=a?r?new i:[]:Ol(t)&&wl(i)?Sr(ke(t)):{}}return(a?kn:Aa)(t,(function(t,r,a){return e(n,t,r,a)})),n}function $d(t,e){return null==t||Fi(t,e)}function Ld(t,e,n){return null==t?t:Mi(t,e,Wi(n))}function Bd(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Mi(t,e,Wi(n),r)}function zd(t){return null==t?[]:Jn(t,kd(t))}function Wd(t){return null==t?[]:Jn(t,Sd(t))}function Vd(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=Yl(n),n=n===n?n:0),e!==i&&(e=Yl(e),e=e===e?e:0),ga(Yl(t),e,n)}function Ud(t,e,n){return e=ql(e),n===i?(n=e,e=0):n=ql(n),t=Yl(t),Ba(t,e,n)}function Gd(t,e,n){if(n&&"boolean"!=typeof n&&ss(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ql(t),e===i?(e=t,t=0):e=ql(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var a=He();return ze(t+a*(e-t+rn("1e-"+((a+"").length-1))),e)}return bi(t,e)}var Hd=fo((function(t,e,n){return e=e.toLowerCase(),t+(n?qd(e):e)}));function qd(t){return xh(Ql(t).toLowerCase())}function Kd(t){return t=Ql(t),t&&t.replace(Qt,nr).replace(Ue,"")}function Xd(t,e,n){t=Ql(t),e=ji(e);var r=t.length;n=n===i?r:ga(Kl(n),0,r);var a=n;return n-=e.length,n>=0&&t.slice(n,a)==e}function Yd(t){return t=Ql(t),t&&Nt.test(t)?t.replace(Tt,rr):t}function Jd(t){return t=Ql(t),t&&Pt.test(t)?t.replace(Mt,"\\$&"):t}var Zd=fo((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Qd=fo((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),th=po("toLowerCase");function eh(t,e,n){t=Ql(t),e=Kl(e);var r=e?gr(t):0;if(!e||r>=e)return t;var a=(e-r)/2;return So(De(a),n)+t+So(je(a),n)}function nh(t,e,n){t=Ql(t),e=Kl(e);var r=e?gr(t):0;return e&&r<e?t+So(e-r,n):t}function rh(t,e,n){t=Ql(t),e=Kl(e);var r=e?gr(t):0;return e&&r<e?So(e-r,n)+t:t}function ah(t,e,n){return n||null==e?e=0:e&&(e=+e),Ge(Ql(t).replace($t,""),e||0)}function ih(t,e,n){return e=(n?ss(t,e,n):e===i)?1:Kl(e),vi(Ql(t),e)}function oh(){var t=arguments,e=Ql(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var sh=fo((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()}));function uh(t,e,n){return n&&"number"!=typeof n&&ss(t,e,n)&&(e=n=i),n=n===i?B:n>>>0,n?(t=Ql(t),t&&("string"==typeof e||null!=e&&!Fl(e))&&(e=ji(e),!e&&or(t))?Gi(br(t),0,n):t.split(e,n)):[]}var ch=fo((function(t,e,n){return t+(n?" ":"")+xh(e)}));function lh(t,e,n){return t=Ql(t),n=null==n?0:ga(Kl(n),0,t.length),e=ji(e),t.slice(n,n+e.length)==e}function dh(t,e,n){var r=wr.templateSettings;n&&ss(t,e,n)&&(e=i),t=Ql(t),e=nd({},e,r,Ro);var o,s,u=nd({},e.imports,r.imports,Ro),c=kd(u),d=Jn(u,c),h=0,p=e.interpolate||te,f="__p += '",m=re((e.escape||te).source+"|"+p.source+"|"+(p===Rt?Ht:te).source+"|"+(e.evaluate||te).source+"|$","g"),g="//# sourceURL="+(de.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";t.replace(m,(function(e,n,r,a,i,u){return r||(r=a),f+=t.slice(h,u).replace(ee,ar),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),i&&(s=!0,f+="';\n"+i+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),h=u+e.length,e})),f+="';\n";var b=de.call(e,"variable")&&e.variable;if(b){if(Ut.test(b))throw new a(l)}else f="with (obj) {\n"+f+"\n}\n";f=(s?f.replace(St,""):f).replace(Ot,"$1").replace(_t,"$1;"),f="function("+(b||"obj")+") {\n"+(b?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var y=kh((function(){return Lt(c,g+"return "+f).apply(i,d)}));if(y.source=f,vl(y))throw y;return y}function hh(t){return Ql(t).toLowerCase()}function ph(t){return Ql(t).toUpperCase()}function fh(t,e,n){if(t=Ql(t),t&&(n||e===i))return Xn(t);if(!t||!(e=ji(e)))return t;var r=br(t),a=br(e),o=Qn(r,a),s=tr(r,a)+1;return Gi(r,o,s).join("")}function mh(t,e,n){if(t=Ql(t),t&&(n||e===i))return t.slice(0,yr(t)+1);if(!t||!(e=ji(e)))return t;var r=br(t),a=tr(r,br(e))+1;return Gi(r,0,a).join("")}function gh(t,e,n){if(t=Ql(t),t&&(n||e===i))return t.replace($t,"");if(!t||!(e=ji(e)))return t;var r=br(t),a=Qn(r,br(e));return Gi(r,a).join("")}function bh(t,e){var n=N,r=E;if(Ol(e)){var a="separator"in e?e.separator:a;n="length"in e?Kl(e.length):n,r="omission"in e?ji(e.omission):r}t=Ql(t);var o=t.length;if(or(t)){var s=br(t);o=s.length}if(n>=o)return t;var u=n-gr(r);if(u<1)return r;var c=s?Gi(s,0,u).join(""):t.slice(0,u);if(a===i)return c+r;if(s&&(u+=c.length-u),Fl(a)){if(t.slice(u).search(a)){var l,d=c;a.global||(a=re(a.source,Ql(qt.exec(a))+"g")),a.lastIndex=0;while(l=a.exec(d))var h=l.index;c=c.slice(0,h===i?u:h)}}else if(t.indexOf(ji(a),u)!=u){var p=c.lastIndexOf(a);p>-1&&(c=c.slice(0,p))}return c+r}function yh(t){return t=Ql(t),t&&It.test(t)?t.replace(Ct,vr):t}var vh=fo((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),xh=po("toUpperCase");function wh(t,e,n){return t=Ql(t),e=n?i:e,e===i?sr(t)?kr(t):Fn(t):t.match(e)||[]}var kh=xi((function(t,e){try{return xn(t,i,e)}catch(n){return vl(n)?n:new a(n)}})),Sh=$o((function(t,e){return kn(e,(function(e){e=As(e),fa(t,e,Rc(t[e],t))})),t}));function Oh(t){var e=null==t?0:t.length,n=Uo();return t=e?In(t,(function(t){if("function"!=typeof t[1])throw new ie(c);return[n(t[0]),t[1]]})):[],xi((function(n){var r=-1;while(++r<e){var a=t[r];if(xn(a[0],this,n))return xn(a[1],this,n)}}))}function _h(t){return ya(ba(t,f))}function Ch(t){return function(){return t}}function Th(t,e){return null==t||t!==t?e:t}var Ih=yo(),Nh=yo(!0);function Eh(t){return t}function Ah(t){return ei("function"==typeof t?t:ba(t,f))}function Rh(t){return oi(ba(t,f))}function jh(t,e){return si(t,ba(e,f))}var Dh=xi((function(t,e){return function(n){return Va(n,t,e)}})),Fh=xi((function(t,e){return function(n){return Va(t,n,e)}}));function Mh(t,e,n){var r=kd(e),a=ja(e,r);null!=n||Ol(e)&&(a.length||!r.length)||(n=e,e=t,t=this,a=ja(e,kd(e)));var i=!(Ol(n)&&"chain"in n)||!!n.chain,o=wl(t);return kn(a,(function(n){var r=e[n];t[n]=r,o&&(t.prototype[n]=function(){var e=this.__chain__;if(i||e){var n=t(this.__wrapped__),a=n.__actions__=ro(this.__actions__);return a.push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Nn([this.value()],arguments))})})),t}function Ph(){return un._===this&&(un._=ge),this}function $h(){}function Lh(t){return t=Kl(t),xi((function(e){return li(e,t)}))}var Bh=ko(In),zh=ko(On),Wh=ko(Rn);function Vh(t){return us(t)?Wn(As(t)):fi(t)}function Uh(t){return function(e){return null==t?i:Da(t,e)}}var Gh=_o(),Hh=_o(!0);function qh(){return[]}function Kh(){return!1}function Xh(){return{}}function Yh(){return""}function Jh(){return!0}function Zh(t,e){if(t=Kl(t),t<1||t>P)return[];var n=B,r=ze(t,B);e=Uo(e),t-=B;var a=qn(r,e);while(++n<t)e(n);return a}function Qh(t){return ul(t)?In(t,As):Ll(t)?[t]:ro(Es(Ql(t)))}function tp(t){var e=++he;return Ql(t)+e}var ep=wo((function(t,e){return t+e}),0),np=Io("ceil"),rp=wo((function(t,e){return t/e}),1),ap=Io("floor");function ip(t){return t&&t.length?_a(t,Eh,Pa):i}function op(t,e){return t&&t.length?_a(t,Uo(e,2),Pa):i}function sp(t){return zn(t,Eh)}function up(t,e){return zn(t,Uo(e,2))}function cp(t){return t&&t.length?_a(t,Eh,ai):i}function lp(t,e){return t&&t.length?_a(t,Uo(e,2),ai):i}var dp=wo((function(t,e){return t*e}),1),hp=Io("round"),pp=wo((function(t,e){return t-e}),0);function fp(t){return t&&t.length?Hn(t,Eh):0}function mp(t,e){return t&&t.length?Hn(t,Uo(e,2)):0}return wr.after=Nc,wr.ary=Ec,wr.assign=td,wr.assignIn=ed,wr.assignInWith=nd,wr.assignWith=rd,wr.at=ad,wr.before=Ac,wr.bind=Rc,wr.bindAll=Sh,wr.bindKey=jc,wr.castArray=Zc,wr.chain=Gu,wr.chunk=Fs,wr.compact=Ms,wr.concat=Ps,wr.cond=Oh,wr.conforms=_h,wr.constant=Ch,wr.countBy=nc,wr.create=id,wr.curry=Dc,wr.curryRight=Fc,wr.debounce=Mc,wr.defaults=od,wr.defaultsDeep=sd,wr.defer=Pc,wr.delay=$c,wr.difference=$s,wr.differenceBy=Ls,wr.differenceWith=Bs,wr.drop=zs,wr.dropRight=Ws,wr.dropRightWhile=Vs,wr.dropWhile=Us,wr.fill=Gs,wr.filter=ac,wr.flatMap=sc,wr.flatMapDeep=uc,wr.flatMapDepth=cc,wr.flatten=Ks,wr.flattenDeep=Xs,wr.flattenDepth=Ys,wr.flip=Lc,wr.flow=Ih,wr.flowRight=Nh,wr.fromPairs=Js,wr.functions=fd,wr.functionsIn=md,wr.groupBy=hc,wr.initial=tu,wr.intersection=eu,wr.intersectionBy=nu,wr.intersectionWith=ru,wr.invert=vd,wr.invertBy=xd,wr.invokeMap=fc,wr.iteratee=Ah,wr.keyBy=mc,wr.keys=kd,wr.keysIn=Sd,wr.map=gc,wr.mapKeys=Od,wr.mapValues=_d,wr.matches=Rh,wr.matchesProperty=jh,wr.memoize=Bc,wr.merge=Cd,wr.mergeWith=Td,wr.method=Dh,wr.methodOf=Fh,wr.mixin=Mh,wr.negate=zc,wr.nthArg=Lh,wr.omit=Id,wr.omitBy=Nd,wr.once=Wc,wr.orderBy=bc,wr.over=Bh,wr.overArgs=Vc,wr.overEvery=zh,wr.overSome=Wh,wr.partial=Uc,wr.partialRight=Gc,wr.partition=yc,wr.pick=Ed,wr.pickBy=Ad,wr.property=Vh,wr.propertyOf=Uh,wr.pull=uu,wr.pullAll=cu,wr.pullAllBy=lu,wr.pullAllWith=du,wr.pullAt=hu,wr.range=Gh,wr.rangeRight=Hh,wr.rearg=Hc,wr.reject=wc,wr.remove=pu,wr.rest=qc,wr.reverse=fu,wr.sampleSize=Sc,wr.set=jd,wr.setWith=Dd,wr.shuffle=Oc,wr.slice=mu,wr.sortBy=Tc,wr.sortedUniq=ku,wr.sortedUniqBy=Su,wr.split=uh,wr.spread=Kc,wr.tail=Ou,wr.take=_u,wr.takeRight=Cu,wr.takeRightWhile=Tu,wr.takeWhile=Iu,wr.tap=Hu,wr.throttle=Xc,wr.thru=qu,wr.toArray=Hl,wr.toPairs=Fd,wr.toPairsIn=Md,wr.toPath=Qh,wr.toPlainObject=Jl,wr.transform=Pd,wr.unary=Yc,wr.union=Nu,wr.unionBy=Eu,wr.unionWith=Au,wr.uniq=Ru,wr.uniqBy=ju,wr.uniqWith=Du,wr.unset=$d,wr.unzip=Fu,wr.unzipWith=Mu,wr.update=Ld,wr.updateWith=Bd,wr.values=zd,wr.valuesIn=Wd,wr.without=Pu,wr.words=wh,wr.wrap=Jc,wr.xor=$u,wr.xorBy=Lu,wr.xorWith=Bu,wr.zip=zu,wr.zipObject=Wu,wr.zipObjectDeep=Vu,wr.zipWith=Uu,wr.entries=Fd,wr.entriesIn=Md,wr.extend=ed,wr.extendWith=nd,Mh(wr,wr),wr.add=ep,wr.attempt=kh,wr.camelCase=Hd,wr.capitalize=qd,wr.ceil=np,wr.clamp=Vd,wr.clone=Qc,wr.cloneDeep=el,wr.cloneDeepWith=nl,wr.cloneWith=tl,wr.conformsTo=rl,wr.deburr=Kd,wr.defaultTo=Th,wr.divide=rp,wr.endsWith=Xd,wr.eq=al,wr.escape=Yd,wr.escapeRegExp=Jd,wr.every=rc,wr.find=ic,wr.findIndex=Hs,wr.findKey=ud,wr.findLast=oc,wr.findLastIndex=qs,wr.findLastKey=cd,wr.floor=ap,wr.forEach=lc,wr.forEachRight=dc,wr.forIn=ld,wr.forInRight=dd,wr.forOwn=hd,wr.forOwnRight=pd,wr.get=gd,wr.gt=il,wr.gte=ol,wr.has=bd,wr.hasIn=yd,wr.head=Zs,wr.identity=Eh,wr.includes=pc,wr.indexOf=Qs,wr.inRange=Ud,wr.invoke=wd,wr.isArguments=sl,wr.isArray=ul,wr.isArrayBuffer=cl,wr.isArrayLike=ll,wr.isArrayLikeObject=dl,wr.isBoolean=hl,wr.isBuffer=pl,wr.isDate=fl,wr.isElement=ml,wr.isEmpty=gl,wr.isEqual=bl,wr.isEqualWith=yl,wr.isError=vl,wr.isFinite=xl,wr.isFunction=wl,wr.isInteger=kl,wr.isLength=Sl,wr.isMap=Cl,wr.isMatch=Tl,wr.isMatchWith=Il,wr.isNaN=Nl,wr.isNative=El,wr.isNil=Rl,wr.isNull=Al,wr.isNumber=jl,wr.isObject=Ol,wr.isObjectLike=_l,wr.isPlainObject=Dl,wr.isRegExp=Fl,wr.isSafeInteger=Ml,wr.isSet=Pl,wr.isString=$l,wr.isSymbol=Ll,wr.isTypedArray=Bl,wr.isUndefined=zl,wr.isWeakMap=Wl,wr.isWeakSet=Vl,wr.join=au,wr.kebabCase=Zd,wr.last=iu,wr.lastIndexOf=ou,wr.lowerCase=Qd,wr.lowerFirst=th,wr.lt=Ul,wr.lte=Gl,wr.max=ip,wr.maxBy=op,wr.mean=sp,wr.meanBy=up,wr.min=cp,wr.minBy=lp,wr.stubArray=qh,wr.stubFalse=Kh,wr.stubObject=Xh,wr.stubString=Yh,wr.stubTrue=Jh,wr.multiply=dp,wr.nth=su,wr.noConflict=Ph,wr.noop=$h,wr.now=Ic,wr.pad=eh,wr.padEnd=nh,wr.padStart=rh,wr.parseInt=ah,wr.random=Gd,wr.reduce=vc,wr.reduceRight=xc,wr.repeat=ih,wr.replace=oh,wr.result=Rd,wr.round=hp,wr.runInContext=t,wr.sample=kc,wr.size=_c,wr.snakeCase=sh,wr.some=Cc,wr.sortedIndex=gu,wr.sortedIndexBy=bu,wr.sortedIndexOf=yu,wr.sortedLastIndex=vu,wr.sortedLastIndexBy=xu,wr.sortedLastIndexOf=wu,wr.startCase=ch,wr.startsWith=lh,wr.subtract=pp,wr.sum=fp,wr.sumBy=mp,wr.template=dh,wr.times=Zh,wr.toFinite=ql,wr.toInteger=Kl,wr.toLength=Xl,wr.toLower=hh,wr.toNumber=Yl,wr.toSafeInteger=Zl,wr.toString=Ql,wr.toUpper=ph,wr.trim=fh,wr.trimEnd=mh,wr.trimStart=gh,wr.truncate=bh,wr.unescape=yh,wr.uniqueId=tp,wr.upperCase=vh,wr.upperFirst=xh,wr.each=lc,wr.eachRight=dc,wr.first=Zs,Mh(wr,function(){var t={};return Aa(wr,(function(e,n){de.call(wr.prototype,n)||(t[n]=e)})),t}(),{chain:!1}),wr.VERSION=o,kn(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){wr[t].placeholder=wr})),kn(["drop","take"],(function(t,e){Tr.prototype[t]=function(n){n=n===i?1:Be(Kl(n),0);var r=this.__filtered__&&!e?new Tr(this):this.clone();return r.__filtered__?r.__takeCount__=ze(n,r.__takeCount__):r.__views__.push({size:ze(n,B),type:t+(r.__dir__<0?"Right":"")}),r},Tr.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),kn(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=n==j||n==F;Tr.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Uo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),kn(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Tr.prototype[t]=function(){return this[n](1).value()[0]}})),kn(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Tr.prototype[t]=function(){return this.__filtered__?new Tr(this):this[n](1)}})),Tr.prototype.compact=function(){return this.filter(Eh)},Tr.prototype.find=function(t){return this.filter(t).head()},Tr.prototype.findLast=function(t){return this.reverse().find(t)},Tr.prototype.invokeMap=xi((function(t,e){return"function"==typeof t?new Tr(this):this.map((function(n){return Va(n,t,e)}))})),Tr.prototype.reject=function(t){return this.filter(zc(Uo(t)))},Tr.prototype.slice=function(t,e){t=Kl(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Tr(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(e=Kl(e),n=e<0?n.dropRight(-e):n.take(e-t)),n)},Tr.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Tr.prototype.toArray=function(){return this.take(B)},Aa(Tr.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),a=wr[r?"take"+("last"==e?"Right":""):e],o=r||/^find/.test(e);a&&(wr.prototype[e]=function(){var e=this.__wrapped__,s=r?[1]:arguments,u=e instanceof Tr,c=s[0],l=u||ul(e),d=function(t){var e=a.apply(wr,Nn([t],s));return r&&h?e[0]:e};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var h=this.__chain__,p=!!this.__actions__.length,f=o&&!h,m=u&&!p;if(!o&&l){e=m?e:new Tr(this);var g=t.apply(e,s);return g.__actions__.push({func:qu,args:[d],thisArg:i}),new Cr(g,h)}return f&&m?t.apply(this,s):(g=this.thru(d),f?r?g.value()[0]:g.value():g)})})),kn(["pop","push","shift","sort","splice","unshift"],(function(t){var e=oe[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);wr.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var a=this.value();return e.apply(ul(a)?a:[],t)}return this[n]((function(n){return e.apply(ul(n)?n:[],t)}))}})),Aa(Tr.prototype,(function(t,e){var n=wr[e];if(n){var r=n.name+"";de.call(cn,r)||(cn[r]=[]),cn[r].push({name:e,func:n})}})),cn[vo(i,x).name]=[{name:"wrapper",func:i}],Tr.prototype.clone=Ir,Tr.prototype.reverse=Nr,Tr.prototype.value=Er,wr.prototype.at=Ku,wr.prototype.chain=Xu,wr.prototype.commit=Yu,wr.prototype.next=Ju,wr.prototype.plant=Qu,wr.prototype.reverse=tc,wr.prototype.toJSON=wr.prototype.valueOf=wr.prototype.value=ec,wr.prototype.first=wr.prototype.head,Te&&(wr.prototype[Te]=Zu),wr},Or=Sr();un._=Or,a=function(){return Or}.call(e,n,e,r),a===i||(r.exports=a)}).call(this)}).call(this,n("c8ba"),n("62e4")(t))},"2fb2":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.FastLayer=void 0;var a=n("9cb8"),i=n("0ff5"),o=n("d777"),s=function(t){function e(e){var n=t.call(this,e)||this;return n.listening(!1),a.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.'),n}return r(e,t),e}(i.Layer);e.FastLayer=s,s.prototype.nodeType="FastLayer",o._registerNode(s),a.Collection.mapMethods(s)},"2fcc":function(t,e){function n(t){var e=this.__data__,n=e["delete"](t);return this.size=e.size,n}t.exports=n},"2fce":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=Object(o["a"])(t,"a","floorDiv"),s=Object(o["a"])(e,"b","floorDiv");[n,s]=Object(i["makeTypesMatch"])(n,s);const u={a:n,b:s};return r["a"].runKernel(a["jb"],u)}const c=Object(s["b"])({floorDiv_:u})},3079:function(t,e,n){},"30c9":function(t,e,n){var r=n("9520"),a=n("b218");function i(t){return null!=t&&a(t.length)&&!r(t)}t.exports=i},3182:function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return h})),n.d(e,"h",(function(){return p})),n.d(e,"g",(function(){return f})),n.d(e,"a",(function(){return m}));var r=n("32fe"),a=n("4705"),i=n("eea1");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])("kernelRegistry",()=>new Map),s=Object(a["a"])("gradRegistry",()=>new Map);function u(t,e){const n=g(t,e);return o.get(n)}function c(t){return s.get(t)}function l(t){const e=o.entries(),n=[];while(1){const{done:r,value:a}=e.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===t&&n.push(o)}return n}function d(t){const{kernelName:e,backendName:n}=t,r=g(e,n);o.has(r)&&i["b"](`The kernel '${e}' for backend '${n}' is already registered`),o.set(r,t)}function h(t){const{kernelName:e}=t;s.has(e)&&Object(r["c"])().getBool("DEBUG")&&i["b"](`Overriding the gradient for '${e}'`),s.set(e,t)}function p(t,e){const n=g(t,e);if(!o.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);o.delete(n)}function f(t){if(!s.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);s.delete(t)}function m(t,e){const n=l(t);n.forEach(t=>{const n=Object.assign({},t,{backendName:e});d(n)})}function g(t,e){return`${e}_${t}`}},"31ad":function(t,e,n){"use strict";n("eb91")},"31d5":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a){const i=r["util"].parseAxisParam(e,n)[0],o=[1,n[0],1];for(let r=0;r<i;r++)o[0]*=n[r];o[1]=n[i];for(let r=i+1;r<n.length;r++)o[2]*=n[r];const s={},u=new Int32Array(n[i]),c=new r["TensorBuffer"](o,a,t),l=[],d=1===o[0]&&1===o[2];for(let r=0;r<n[i];r++){let e;if(d)e=t[r].toString();else{const t=[];for(let e=0;e<o[0];e++)for(let n=0;n<o[2];n++)t.push(c.get(e,r,n));e=t.join(",")}if(void 0!==s[e])u[r]=s[e];else{const t=Object.keys(s).length;s[e]=t,u[r]=t,l.push(r)}}const h=o.slice();h[1]=Object.keys(s).length;const p=new r["TensorBuffer"](h,a);l.forEach((t,e)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)p.set(c.get(n,t,r),n,e,r)});const f=n.slice();return f[i]=h[1],{outputValues:p.values,outputShape:f,indices:u}}},"322b":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("df00"),o=n("086c"),s=n("f947"),u=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e,n,s,c,l="NHWC",d){let h=t;3===t.rank&&(h=Object(u["a"])(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let p=e;3===p.rank&&(p=Object(u["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2]])),i["b"](4===h.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+h.shape+"."),i["b"](4===p.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+p.shape+"."),i["b"](4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+".");const f="NHWC"===l?h.shape[3]:h.shape[1],m="NHWC"===l?p.shape[3]:p.shape[1];i["b"](f===n[2],()=>`Error in conv2dDerFilter: depth of input ${f}) must match input depth in filter (${n[2]}.`),i["b"](m===n[3],()=>`Error in conv2dDerFilter: depth of dy (${m}) must match output depth for filter (${n[3]}).`),o["a"]("conv2dDerFilter",c,d);const g={x:h,dy:p},b={strides:s,pad:c,dataFormat:l,dimRoundingMode:d,filterShape:n};return r["a"].runKernel(a["E"],g,b)}const l=Object(s["b"])({conv2DBackpropFilter_:c})},3276:function(t,e,n){"use strict";n("9239")},"32b3":function(t,e,n){var r=n("872a"),a=n("9638"),i=Object.prototype,o=i.hasOwnProperty;function s(t,e,n){var i=t[e];o.call(t,e)&&a(i,n)&&(void 0!==n||e in t)||r(t,e,n)}t.exports=s},"32f4":function(t,e,n){var r=n("2d7c"),a=n("d327"),i=Object.prototype,o=i.propertyIsEnumerable,s=Object.getOwnPropertySymbols,u=s?function(t){return null==t?[]:(t=Object(t),r(s(t),(function(e){return o.call(t,e)})))}:a;t.exports=u},"32fe":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return d}));var r=n("df00");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a="tfjsflags";class i{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=o,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(c().getBool("IS_TEST")||c().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];c().getBool("IS_TEST")||c().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Object(r["x"])(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(a in t){const e=t[a].split(",");e.forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=u(e,n)})}}}function o(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(s(e,n[0],n[1]),n.join("="))),e}function s(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function u(t,e){if(e=e.toLowerCase(),"true"===e||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function c(){return l}let l=null;function d(t){l=t}},"330c":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","sqrt","float32"),n={x:e};return r["a"].runKernel(a["Wc"],n)}const u=Object(o["b"])({sqrt_:s})},3360:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,r.withParams)({type:"and"},(function(){for(var t=this,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.length>0&&e.reduce((function(e,n){return e&&n.apply(t,r)}),!0)}))};e.default=a},"34ac":function(t,e,n){var r=n("9520"),a=n("1368"),i=n("1a8c"),o=n("dc57"),s=/[\\^$.*+?()[\]{}|]/g,u=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,d=c.toString,h=l.hasOwnProperty,p=RegExp("^"+d.call(h).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(t){if(!i(t)||a(t))return!1;var e=r(t)?p:u;return e.test(o(t))}t.exports=f},"353b":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("7b50"),c=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function l(t,e){let n=Object(o["a"])(t,"a","maximum"),c=Object(o["a"])(e,"b","maximum");[n,c]=Object(i["makeTypesMatch"])(n,c),"bool"===n.dtype&&(n=Object(u["a"])(n,"int32"),c=Object(u["a"])(c,"int32")),Object(s["assertAndGetBroadcastShape"])(n.shape,c.shape);const l={a:n,b:c};return r["a"].runKernel(a["Sb"],l)}const d=Object(c["b"])({maximum_:l})},"35bd":function(t,e){window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)}}(),window.cancelRequestAnimFrame=function(){return window.cancelCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.clearTimeout}()},"35bf":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},"362d":function(t,e,n){var r=n("fd15").Konva;r._injectGlobal(r),e["default"]=r,t.exports=e["default"]},3665:function(t,e,n){"use strict";n.d(e,"a",(function(){return rl}));var r={};n.r(r),n.d(r,"Experiment",(function(){return dt})),n.d(r,"Screen",(function(){return Ot})),n.d(r,"Slide",(function(){return Et})),n.d(r,"CompletionInput",(function(){return $t})),n.d(r,"DropdownInput",(function(){return Ht})),n.d(r,"ForcedChoiceInput",(function(){return te})),n.d(r,"ImageSelectionInput",(function(){return ue})),n.d(r,"KeypressInput",(function(){return ge})),n.d(r,"RatingInput",(function(){return Oe})),n.d(r,"SliderInput",(function(){return De})),n.d(r,"TextareaInput",(function(){return We})),n.d(r,"MultipleChoiceInput",(function(){return Ze})),n.d(r,"MultipleChoiceMatrixInput",(function(){return sn})),n.d(r,"SliderRangesInput",(function(){return yn})),n.d(r,"RankOrderInput",(function(){return In})),n.d(r,"MazeInput",(function(){return gr})),n.d(r,"SerialInput",(function(){return $n})),n.d(r,"SelfPacedReadingInput",(function(){return Or})),n.d(r,"Rsvp",(function(){return Rr})),n.d(r,"FixationCross",(function(){return Br})),n.d(r,"Synth",(function(){return Tu})),n.d(r,"Chat",(function(){return Jr})),n.d(r,"WaitForParticipants",(function(){return ia})),n.d(r,"LifecycleScreen",(function(){return Na})),n.d(r,"ConnectInteractiveScreen",(function(){return Pa})),n.d(r,"AwaitIteratedResultScreen",(function(){return Ga})),n.d(r,"DebugResultsScreen",(function(){return ei})),n.d(r,"SubmitResultsScreen",(function(){return ci})),n.d(r,"PostTestScreen",(function(){return bi})),n.d(r,"InstructionScreen",(function(){return _i})),n.d(r,"EyetrackingCalibrationScreen",(function(){return Fi})),n.d(r,"EyetrackingValidationScreen",(function(){return Ji})),n.d(r,"ForcedChoiceScreen",(function(){return io})),n.d(r,"ImageSelectionScreen",(function(){return fo})),n.d(r,"TextareaScreen",(function(){return ko})),n.d(r,"SliderScreen",(function(){return Eo})),n.d(r,"SliderRangesScreen",(function(){return $o})),n.d(r,"RatingScreen",(function(){return Ho})),n.d(r,"CompletionScreen",(function(){return ts})),n.d(r,"KeypressScreen",(function(){return us})),n.d(r,"ForcedChoiceMousetrackingScreen",(function(){return gs})),n.d(r,"MultipleChoiceScreen",(function(){return Os})),n.d(r,"MultipleChoiceMatrixScreen",(function(){return Rs})),n.d(r,"MazeScreen",(function(){return Bs})),n.d(r,"SelfPacedReadingScreen",(function(){return Ks})),n.d(r,"Wait",(function(){return lr})),n.d(r,"TimerStop",(function(){return Hn})),n.d(r,"TimerStart",(function(){return tr})),n.d(r,"Record",(function(){return Sa})),n.d(r,"ResponseTimeStart",(function(){return ma})),n.d(r,"MousetrackingStart",(function(){return nu})),n.d(r,"EyetrackingStart",(function(){return Gi})),n.d(r,"FullscreenStart",(function(){return lu})),n.d(r,"HideCursor",(function(){return yu})),n.d(r,"PreventCopyPaste",(function(){return Cu}));var a={};n.r(a),n.d(a,"en",(function(){return tl})),n.d(a,"de",(function(){return el})),n.d(a,"zh",(function(){return nl}));var i=n("faa1"),o=n.n(i),s=n("2b0e"),u=t=>{if("function"===typeof t)return t;{let e=function(){return t};return e}},c="undefined"!==typeof self?self:null,l="undefined"!==typeof window?window:null,d=c||l||d,h="2.0.0",p={connecting:0,open:1,closing:2,closed:3},f=1e4,m=1e3,g={closed:"closed",errored:"errored",joined:"joined",joining:"joining",leaving:"leaving"},b={close:"phx_close",error:"phx_error",join:"phx_join",reply:"phx_reply",leave:"phx_leave"},y={longpoll:"longpoll",websocket:"websocket"},v={complete:4},x=class{constructor(t,e,n,r){this.channel=t,this.event=e,this.payload=n||function(){return{}},this.receivedResp=null,this.timeout=r,this.timeoutTimer=null,this.recHooks=[],this.sent=!1}resend(t){this.timeout=t,this.reset(),this.send()}send(){this.hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload(),ref:this.ref,join_ref:this.channel.joinRef()}))}receive(t,e){return this.hasReceived(t)&&e(this.receivedResp.response),this.recHooks.push({status:t,callback:e}),this}reset(){this.cancelRefEvent(),this.ref=null,this.refEvent=null,this.receivedResp=null,this.sent=!1}matchReceive({status:t,response:e,_ref:n}){this.recHooks.filter(e=>e.status===t).forEach(t=>t.callback(e))}cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=null}startTimeout(){this.timeoutTimer&&this.cancelTimeout(),this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref),this.channel.on(this.refEvent,t=>{this.cancelRefEvent(),this.cancelTimeout(),this.receivedResp=t,this.matchReceive(t)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}trigger(t,e){this.channel.trigger(this.refEvent,{status:t,response:e})}},w=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=null,this.tries=0}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}},k=class{constructor(t,e,n){this.state=g.closed,this.topic=t,this.params=u(e||{}),this.socket=n,this.bindings=[],this.bindingRef=0,this.timeout=this.socket.timeout,this.joinedOnce=!1,this.joinPush=new x(this,b.join,this.params,this.timeout),this.pushBuffer=[],this.stateChangeRefs=[],this.rejoinTimer=new w(()=>{this.socket.isConnected()&&this.rejoin()},this.socket.rejoinAfterMs),this.stateChangeRefs.push(this.socket.onError(()=>this.rejoinTimer.reset())),this.stateChangeRefs.push(this.socket.onOpen(()=>{this.rejoinTimer.reset(),this.isErrored()&&this.rejoin()})),this.joinPush.receive("ok",()=>{this.state=g.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(t=>t.send()),this.pushBuffer=[]}),this.joinPush.receive("error",()=>{this.state=g.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.hasLogger()&&this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=g.closed,this.socket.remove(this)}),this.onError(t=>{this.socket.hasLogger()&&this.socket.log("channel","error "+this.topic,t),this.isJoining()&&this.joinPush.reset(),this.state=g.errored,this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.joinPush.receive("timeout",()=>{this.socket.hasLogger()&&this.socket.log("channel",`timeout ${this.topic} (${this.joinRef()})`,this.joinPush.timeout);let t=new x(this,b.leave,u({}),this.timeout);t.send(),this.state=g.errored,this.joinPush.reset(),this.socket.isConnected()&&this.rejoinTimer.scheduleTimeout()}),this.on(b.reply,(t,e)=>{this.trigger(this.replyEventName(e),t)})}join(t=this.timeout){if(this.joinedOnce)throw new Error("tried to join multiple times. 'join' can only be called a single time per channel instance");return this.timeout=t,this.joinedOnce=!0,this.rejoin(),this.joinPush}onClose(t){this.on(b.close,t)}onError(t){return this.on(b.error,e=>t(e))}on(t,e){let n=this.bindingRef++;return this.bindings.push({event:t,ref:n,callback:e}),n}off(t,e){this.bindings=this.bindings.filter(n=>!(n.event===t&&("undefined"===typeof e||e===n.ref)))}canPush(){return this.socket.isConnected()&&this.isJoined()}push(t,e,n=this.timeout){if(e=e||{},!this.joinedOnce)throw new Error(`tried to push '${t}' to '${this.topic}' before joining. Use channel.join() before pushing events`);let r=new x(this,t,(function(){return e}),n);return this.canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}leave(t=this.timeout){this.rejoinTimer.reset(),this.joinPush.cancelTimeout(),this.state=g.leaving;let e=()=>{this.socket.hasLogger()&&this.socket.log("channel","leave "+this.topic),this.trigger(b.close,"leave")},n=new x(this,b.leave,u({}),t);return n.receive("ok",()=>e()).receive("timeout",()=>e()),n.send(),this.canPush()||n.trigger("ok",{}),n}onMessage(t,e,n){return e}isMember(t,e,n,r){return this.topic===t&&(!r||r===this.joinRef()||(this.socket.hasLogger()&&this.socket.log("channel","dropping outdated message",{topic:t,event:e,payload:n,joinRef:r}),!1))}joinRef(){return this.joinPush.ref}rejoin(t=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=g.joining,this.joinPush.resend(t))}trigger(t,e,n,r){let a=this.onMessage(t,e,n,r);if(e&&!a)throw new Error("channel onMessage callbacks must return the payload, modified or unmodified");let i=this.bindings.filter(e=>e.event===t);for(let o=0;o<i.length;o++){let t=i[o];t.callback(a,n,r||this.joinRef())}}replyEventName(t){return"chan_reply_"+t}isClosed(){return this.state===g.closed}isErrored(){return this.state===g.errored}isJoined(){return this.state===g.joined}isJoining(){return this.state===g.joining}isLeaving(){return this.state===g.leaving}},S=class{static request(t,e,n,r,a,i,o){if(d.XDomainRequest){let n=new d.XDomainRequest;return this.xdomainRequest(n,t,e,r,a,i,o)}{let s=new d.XMLHttpRequest;return this.xhrRequest(s,t,e,n,r,a,i,o)}}static xdomainRequest(t,e,n,r,a,i,o){return t.timeout=a,t.open(e,n),t.onload=()=>{let e=this.parseJSON(t.responseText);o&&o(e)},i&&(t.ontimeout=i),t.onprogress=()=>{},t.send(r),t}static xhrRequest(t,e,n,r,a,i,o,s){return t.open(e,n,!0),t.timeout=i,t.setRequestHeader("Content-Type",r),t.onerror=()=>s&&s(null),t.onreadystatechange=()=>{if(t.readyState===v.complete&&s){let e=this.parseJSON(t.responseText);s(e)}},o&&(t.ontimeout=o),t.send(a),t}static parseJSON(t){if(!t||""===t)return null;try{return JSON.parse(t)}catch(e){return console&&console.log("failed to parse JSON response",t),null}}static serialize(t,e){let n=[];for(var r in t){if(!Object.prototype.hasOwnProperty.call(t,r))continue;let a=e?`${e}[${r}]`:r,i=t[r];"object"===typeof i?n.push(this.serialize(i,a)):n.push(encodeURIComponent(a)+"="+encodeURIComponent(i))}return n.join("&")}static appendParams(t,e){if(0===Object.keys(e).length)return t;let n=t.match(/\?/)?"&":"?";return`${t}${n}${this.serialize(e)}`}},O=t=>{let e="",n=new Uint8Array(t),r=n.byteLength;for(let a=0;a<r;a++)e+=String.fromCharCode(n[a]);return btoa(e)},_=class{constructor(t){this.endPoint=null,this.token=null,this.skipHeartbeat=!0,this.reqs=new Set,this.awaitingBatchAck=!1,this.currentBatch=null,this.currentBatchTimer=null,this.batchBuffer=[],this.onopen=function(){},this.onerror=function(){},this.onmessage=function(){},this.onclose=function(){},this.pollEndpoint=this.normalizeEndpoint(t),this.readyState=p.connecting,setTimeout(()=>this.poll(),0)}normalizeEndpoint(t){return t.replace("ws://","http://").replace("wss://","https://").replace(new RegExp("(.*)/"+y.websocket),"$1/"+y.longpoll)}endpointURL(){return S.appendParams(this.pollEndpoint,{token:this.token})}closeAndRetry(t,e,n){this.close(t,e,n),this.readyState=p.connecting}ontimeout(){this.onerror("timeout"),this.closeAndRetry(1005,"timeout",!1)}isActive(){return this.readyState===p.open||this.readyState===p.connecting}poll(){this.ajax("GET","application/json",null,()=>this.ontimeout(),t=>{if(t){var{status:e,token:n,messages:r}=t;this.token=n}else e=0;switch(e){case 200:r.forEach(t=>{setTimeout(()=>this.onmessage({data:t}),0)}),this.poll();break;case 204:this.poll();break;case 410:this.readyState=p.open,this.onopen({}),this.poll();break;case 403:this.onerror(403),this.close(1008,"forbidden",!1);break;case 0:case 500:this.onerror(500),this.closeAndRetry(1011,"internal server error",500);break;default:throw new Error("unhandled poll status "+e)}})}send(t){"string"!==typeof t&&(t=O(t)),this.currentBatch?this.currentBatch.push(t):this.awaitingBatchAck?this.batchBuffer.push(t):(this.currentBatch=[t],this.currentBatchTimer=setTimeout(()=>{this.batchSend(this.currentBatch),this.currentBatch=null},0))}batchSend(t){this.awaitingBatchAck=!0,this.ajax("POST","application/x-ndjson",t.join("\n"),()=>this.onerror("timeout"),t=>{this.awaitingBatchAck=!1,t&&200===t.status?this.batchBuffer.length>0&&(this.batchSend(this.batchBuffer),this.batchBuffer=[]):(this.onerror(t&&t.status),this.closeAndRetry(1011,"internal server error",!1))})}close(t,e,n){for(let a of this.reqs)a.abort();this.readyState=p.closed;let r=Object.assign({code:1e3,reason:void 0,wasClean:!0},{code:t,reason:e,wasClean:n});this.batchBuffer=[],clearTimeout(this.currentBatchTimer),this.currentBatchTimer=null,"undefined"!==typeof CloseEvent?this.onclose(new CloseEvent("close",r)):this.onclose(r)}ajax(t,e,n,r,a){let i,o=()=>{this.reqs.delete(i),r()};i=S.request(t,this.endpointURL(),e,n,this.timeout,o,t=>{this.reqs.delete(i),this.isActive()&&a(t)}),this.reqs.add(i)}},C={HEADER_LENGTH:1,META_LENGTH:4,KINDS:{push:0,reply:1,broadcast:2},encode(t,e){if(t.payload.constructor===ArrayBuffer)return e(this.binaryEncode(t));{let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return e(JSON.stringify(n))}},decode(t,e){if(t.constructor===ArrayBuffer)return e(this.binaryDecode(t));{let[n,r,a,i,o]=JSON.parse(t);return e({join_ref:n,ref:r,topic:a,event:i,payload:o})}},binaryEncode(t){let{join_ref:e,ref:n,event:r,topic:a,payload:i}=t,o=this.META_LENGTH+e.length+n.length+a.length+r.length,s=new ArrayBuffer(this.HEADER_LENGTH+o),u=new DataView(s),c=0;u.setUint8(c++,this.KINDS.push),u.setUint8(c++,e.length),u.setUint8(c++,n.length),u.setUint8(c++,a.length),u.setUint8(c++,r.length),Array.from(e,t=>u.setUint8(c++,t.charCodeAt(0))),Array.from(n,t=>u.setUint8(c++,t.charCodeAt(0))),Array.from(a,t=>u.setUint8(c++,t.charCodeAt(0))),Array.from(r,t=>u.setUint8(c++,t.charCodeAt(0)));var l=new Uint8Array(s.byteLength+i.byteLength);return l.set(new Uint8Array(s),0),l.set(new Uint8Array(i),s.byteLength),l.buffer},binaryDecode(t){let e=new DataView(t),n=e.getUint8(0),r=new TextDecoder;switch(n){case this.KINDS.push:return this.decodePush(t,e,r);case this.KINDS.reply:return this.decodeReply(t,e,r);case this.KINDS.broadcast:return this.decodeBroadcast(t,e,r)}},decodePush(t,e,n){let r=e.getUint8(1),a=e.getUint8(2),i=e.getUint8(3),o=this.HEADER_LENGTH+this.META_LENGTH-1,s=n.decode(t.slice(o,o+r));o+=r;let u=n.decode(t.slice(o,o+a));o+=a;let c=n.decode(t.slice(o,o+i));o+=i;let l=t.slice(o,t.byteLength);return{join_ref:s,ref:null,topic:u,event:c,payload:l}},decodeReply(t,e,n){let r=e.getUint8(1),a=e.getUint8(2),i=e.getUint8(3),o=e.getUint8(4),s=this.HEADER_LENGTH+this.META_LENGTH,u=n.decode(t.slice(s,s+r));s+=r;let c=n.decode(t.slice(s,s+a));s+=a;let l=n.decode(t.slice(s,s+i));s+=i;let d=n.decode(t.slice(s,s+o));s+=o;let h=t.slice(s,t.byteLength),p={status:d,response:h};return{join_ref:u,ref:c,topic:l,event:b.reply,payload:p}},decodeBroadcast(t,e,n){let r=e.getUint8(1),a=e.getUint8(2),i=this.HEADER_LENGTH+2,o=n.decode(t.slice(i,i+r));i+=r;let s=n.decode(t.slice(i,i+a));i+=a;let u=t.slice(i,t.byteLength);return{join_ref:null,ref:null,topic:o,event:s,payload:u}}},T=class{constructor(t,e={}){this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.channels=[],this.sendBuffer=[],this.ref=0,this.timeout=e.timeout||f,this.transport=e.transport||d.WebSocket||_,this.primaryPassedHealthCheck=!1,this.longPollFallbackMs=e.longPollFallbackMs,this.fallbackTimer=null,this.sessionStore=e.sessionStorage||d&&d.sessionStorage,this.establishedConnections=0,this.defaultEncoder=C.encode.bind(C),this.defaultDecoder=C.decode.bind(C),this.closeWasClean=!1,this.binaryType=e.binaryType||"arraybuffer",this.connectClock=1,this.transport!==_?(this.encode=e.encode||this.defaultEncoder,this.decode=e.decode||this.defaultDecoder):(this.encode=this.defaultEncoder,this.decode=this.defaultDecoder);let n=null;l&&l.addEventListener&&(l.addEventListener("pagehide",t=>{this.conn&&(this.disconnect(),n=this.connectClock)}),l.addEventListener("pageshow",t=>{n===this.connectClock&&(n=null,this.connect())})),this.heartbeatIntervalMs=e.heartbeatIntervalMs||3e4,this.rejoinAfterMs=t=>e.rejoinAfterMs?e.rejoinAfterMs(t):[1e3,2e3,5e3][t-1]||1e4,this.reconnectAfterMs=t=>e.reconnectAfterMs?e.reconnectAfterMs(t):[10,50,100,150,200,250,500,1e3,2e3][t-1]||5e3,this.logger=e.logger||null,!this.logger&&e.debug&&(this.logger=(t,e,n)=>{console.log(`${t}: ${e}`,n)}),this.longpollerTimeout=e.longpollerTimeout||2e4,this.params=u(e.params||{}),this.endPoint=`${t}/${y.websocket}`,this.vsn=e.vsn||h,this.heartbeatTimeoutTimer=null,this.heartbeatTimer=null,this.pendingHeartbeatRef=null,this.reconnectTimer=new w(()=>{this.teardown(()=>this.connect())},this.reconnectAfterMs)}getLongPollTransport(){return _}replaceTransport(t){this.connectClock++,this.closeWasClean=!0,clearTimeout(this.fallbackTimer),this.reconnectTimer.reset(),this.conn&&(this.conn.close(),this.conn=null),this.transport=t}protocol(){return location.protocol.match(/^https/)?"wss":"ws"}endPointURL(){let t=S.appendParams(S.appendParams(this.endPoint,this.params()),{vsn:this.vsn});return"/"!==t.charAt(0)?t:"/"===t.charAt(1)?`${this.protocol()}:${t}`:`${this.protocol()}://${location.host}${t}`}disconnect(t,e,n){this.connectClock++,this.closeWasClean=!0,clearTimeout(this.fallbackTimer),this.reconnectTimer.reset(),this.teardown(t,e,n)}connect(t){t&&(console&&console.log("passing params to connect is deprecated. Instead pass :params to the Socket constructor"),this.params=u(t)),this.conn||(this.longPollFallbackMs&&this.transport!==_?this.connectWithFallback(_,this.longPollFallbackMs):this.transportConnect())}log(t,e,n){this.logger&&this.logger(t,e,n)}hasLogger(){return null!==this.logger}onOpen(t){let e=this.makeRef();return this.stateChangeCallbacks.open.push([e,t]),e}onClose(t){let e=this.makeRef();return this.stateChangeCallbacks.close.push([e,t]),e}onError(t){let e=this.makeRef();return this.stateChangeCallbacks.error.push([e,t]),e}onMessage(t){let e=this.makeRef();return this.stateChangeCallbacks.message.push([e,t]),e}ping(t){if(!this.isConnected())return!1;let e=this.makeRef(),n=Date.now();this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:e});let r=this.onMessage(a=>{a.ref===e&&(this.off([r]),t(Date.now()-n))});return!0}transportConnect(){this.connectClock++,this.closeWasClean=!1,this.conn=new this.transport(this.endPointURL()),this.conn.binaryType=this.binaryType,this.conn.timeout=this.longpollerTimeout,this.conn.onopen=()=>this.onConnOpen(),this.conn.onerror=t=>this.onConnError(t),this.conn.onmessage=t=>this.onConnMessage(t),this.conn.onclose=t=>this.onConnClose(t)}getSession(t){return this.sessionStore&&this.sessionStore.getItem(t)}storeSession(t,e){this.sessionStore&&this.sessionStore.setItem(t,e)}connectWithFallback(t,e=2500){clearTimeout(this.fallbackTimer);let n,r,a=!1,i=!0,o=e=>{this.log("transport",`falling back to ${t.name}...`,e),this.off([n,r]),i=!1,this.replaceTransport(t),this.transportConnect()};if(this.getSession("phx:fallback:"+t.name))return o("memorized");this.fallbackTimer=setTimeout(o,e),r=this.onError(t=>{this.log("transport","error",t),i&&!a&&(clearTimeout(this.fallbackTimer),o(t))}),this.onOpen(()=>{if(a=!0,!i)return this.primaryPassedHealthCheck||this.storeSession("phx:fallback:"+t.name,"true"),this.log("transport",`established ${t.name} fallback`);clearTimeout(this.fallbackTimer),this.fallbackTimer=setTimeout(o,e),this.ping(t=>{this.log("transport","connected to primary after",t),this.primaryPassedHealthCheck=!0,clearTimeout(this.fallbackTimer)})}),this.transportConnect()}clearHeartbeats(){clearTimeout(this.heartbeatTimer),clearTimeout(this.heartbeatTimeoutTimer)}onConnOpen(){this.hasLogger()&&this.log("transport",`${this.transport.name} connected to ${this.endPointURL()}`),this.closeWasClean=!1,this.establishedConnections++,this.flushSendBuffer(),this.reconnectTimer.reset(),this.resetHeartbeat(),this.stateChangeCallbacks.open.forEach(([,t])=>t())}heartbeatTimeout(){this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null,this.hasLogger()&&this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.triggerChanError(),this.closeWasClean=!1,this.teardown(()=>this.reconnectTimer.scheduleTimeout(),m,"heartbeat timeout"))}resetHeartbeat(){this.conn&&this.conn.skipHeartbeat||(this.pendingHeartbeatRef=null,this.clearHeartbeats(),this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs))}teardown(t,e,n){if(!this.conn)return t&&t();this.waitForBufferDone(()=>{this.conn&&(e?this.conn.close(e,n||""):this.conn.close()),this.waitForSocketClosed(()=>{this.conn&&(this.conn.onopen=function(){},this.conn.onerror=function(){},this.conn.onmessage=function(){},this.conn.onclose=function(){},this.conn=null),t&&t()})})}waitForBufferDone(t,e=1){5!==e&&this.conn&&this.conn.bufferedAmount?setTimeout(()=>{this.waitForBufferDone(t,e+1)},150*e):t()}waitForSocketClosed(t,e=1){5!==e&&this.conn&&this.conn.readyState!==p.closed?setTimeout(()=>{this.waitForSocketClosed(t,e+1)},150*e):t()}onConnClose(t){let e=t&&t.code;this.hasLogger()&&this.log("transport","close",t),this.triggerChanError(),this.clearHeartbeats(),this.closeWasClean||1e3===e||this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(([,e])=>e(t))}onConnError(t){this.hasLogger()&&this.log("transport",t);let e=this.transport,n=this.establishedConnections;this.stateChangeCallbacks.error.forEach(([,r])=>{r(t,e,n)}),(e===this.transport||n>0)&&this.triggerChanError()}triggerChanError(){this.channels.forEach(t=>{t.isErrored()||t.isLeaving()||t.isClosed()||t.trigger(b.error)})}connectionState(){switch(this.conn&&this.conn.readyState){case p.connecting:return"connecting";case p.open:return"open";case p.closing:return"closing";default:return"closed"}}isConnected(){return"open"===this.connectionState()}remove(t){this.off(t.stateChangeRefs),this.channels=this.channels.filter(e=>e!==t)}off(t){for(let e in this.stateChangeCallbacks)this.stateChangeCallbacks[e]=this.stateChangeCallbacks[e].filter(([e])=>-1===t.indexOf(e))}channel(t,e={}){let n=new k(t,e,this);return this.channels.push(n),n}push(t){if(this.hasLogger()){let{topic:e,event:n,payload:r,ref:a,join_ref:i}=t;this.log("push",`${e} ${n} (${i}, ${a})`,r)}this.isConnected()?this.encode(t,t=>this.conn.send(t)):this.sendBuffer.push(()=>this.encode(t,t=>this.conn.send(t)))}makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}sendHeartbeat(){this.pendingHeartbeatRef&&!this.isConnected()||(this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatTimeoutTimer=setTimeout(()=>this.heartbeatTimeout(),this.heartbeatIntervalMs))}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}onConnMessage(t){this.decode(t.data,t=>{let{topic:e,event:n,payload:r,ref:a,join_ref:i}=t;a&&a===this.pendingHeartbeatRef&&(this.clearHeartbeats(),this.pendingHeartbeatRef=null,this.heartbeatTimer=setTimeout(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)),this.hasLogger()&&this.log("receive",`${r.status||""} ${e} ${n} ${a&&"("+a+")"||""}`,r);for(let o=0;o<this.channels.length;o++){const t=this.channels[o];t.isMember(e,n,r,i)&&t.trigger(n,r,a,i)}for(let o=0;o<this.stateChangeCallbacks.message.length;o++){let[,e]=this.stateChangeCallbacks.message[o];e(t)}})}leaveOpenTopic(t){let e=this.channels.find(e=>e.topic===t&&(e.isJoined()||e.isJoining()));e&&(this.hasLogger()&&this.log("transport",`leaving duplicate topic "${t}"`),e.leave())}},I=n("8bc1");const N=3e3,E=1e4,A="screen_presence",R={CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",WAITING:"WAITING",READY:"READY",ERROR:"ERROR"};class j extends o.a{constructor(t,e,n){super(),this.socketURL=e,this.errorHandler=t=>{this.state=R.ERROR,n(t)},this.participantId=D(40),this.experimentId=t,this.state=R.CONNECTING,this.iteratedState=R.WAITING,this.participants=[],this.active=[],this.variant=null,this.chain=null,this.generation=null,this.player=null,this.groupLabel=null,this.lastIterationResults=null,s["default"].observable(this),this.currentScreen=null,this.participantsPerScreen={},this.timeoutsPerParticipant={}}getParticipantName(t){return M(t,I)}getParticipantColor(t){return M(t,P)}initialize(){null===this.variant&&(this.phoenix=new T(this.socketURL,{params:{participant_id:this.participantId,experiment_id:this.experimentId}}),this.phoenix.onError(this.errorHandler),this.phoenix.connect(),this.participantChannel=this.phoenix.channel("participant:"+this.participantId,{}),this.participantChannel.on("experiment_available",t=>{this.variant=t.variant,this.chain=t.chain,this.generation=t.generation,this.player=t.player,this.groupLabel=t.group_label,this.state=R.CONNECTED,this.join()}),this.participantChannel.join().receive("ok",()=>{}).receive("error",this.errorHandler).receive("timeout",this.errorHandler),setInterval(()=>{this.participantChannel.push("report_heartbeat")},3e4))}join(){this.chain&&this.generation&&(this.roomChannel=this.phoenix.channel(`interactive_room:${this.experimentId}:${this.chain}:${this.variant}:${this.generation}`,{participant_id:this.participantId}),this.roomChannel.join().receive("ok",()=>{this.state=R.WAITING}).receive("error",this.errorHandler).receive("timeout",this.errorHandler),this.roomChannel.on("start_game",({group_label:t})=>{this.groupLabel=t,this.state=R.READY}),this.roomChannel.on("new_msg",t=>{this.emit(t.event,t.payload)}),this.roomChannel.on("presence_diff",t=>{Object.keys(t.joins).forEach(t=>this.participants.push(t)),Object.keys(t.leaves).forEach(t=>{this.participants.splice(this.participants.indexOf(t),1),this.leaveHandler&&this.leaveHandler()})}),setInterval(()=>{this.broadcast(A,{[this.participantId]:this.currentScreen})},N),this.on(A,t=>{Object.assign(this.participantsPerScreen,t),this.updateActiveParticipants();const e=Object.keys(t)[0];e&&(clearTimeout(this.timeoutsPerParticipant[e]),this.timeoutsPerParticipant[e]=setTimeout(()=>{delete this.participantsPerScreen[e],this.updateActiveParticipants()},E))}),1===this.generation?this.iteratedState=R.READY:(this.lobbyChannel=this.phoenix.channel(`iterated_lobby:${this.experimentId}:${this.chain}:${this.variant}:${this.generation-1}:${this.player}`,{participant_id:this.participantId}),this.lobbyChannel.on("finished",t=>{this.lastIterationResults=t.results,this.lobbyChannel.leave(),this.iteratedState=R.READY}),this.lobbyChannel.join().receive("error",this.errorHandler).receive("timeout",this.errorHandler)))}setCurrentScreen(t){this.currentScreen=t,this.updateActiveParticipants()}updateActiveParticipants(){this.active=Object.entries({...this.participantsPerScreen,[this.participantId]:this.currentScreen}).filter(([,t])=>t===this.currentScreen).map(([t])=>t)}setUpSubscriptions(t,e){for(const n of Object.keys(t))t[n].listener=r=>t[n].call(e,r),this.on(n,t[n].listener)}tearDownSubscriptions(t){for(const e of Object.keys(t))this.off(e,t[e].listener)}broadcast(t,e){this.roomChannel.push("new_msg",{event:t,payload:e})}}function D(t){const e=function(t){return("0"+t.toString(16)).substr(-2)};let n=new Uint8Array((t||40)/2);return window.crypto.getRandomValues(n),Array.from(n,e).join("")}function F(t){var e,n,r=0;if(0===t.length)return r;for(e=0;e<t.length;e++)n=t.charCodeAt(e),r=(r<<5)-r+n,r|=0;return r}function M(t,e){var n=F(t);return e[Math.abs(n%e.length)]}const P=["#ffadad","#ffd6a5","#fdffb6","#caffbf","#9bf6ff","#a0c4ff","#bdb2ff","#ffc6ff"];var $=n("ed9a"),L=n("42454"),B=n.n(L),z=n("dd61"),W=n.n(z),V=n("4d8c"),U=n.n(V);class G{constructor(){this.time=[0],this.x=[0],this.y=[0],this.startTime=0,this.originX=0,this.originY=0}onMouseMove(t){this.time.push(Date.now()-this.startTime),this.x.push(t.clientX-this.originX),this.y.push(t.clientY-this.originY)}start(t,e){t&&e&&(this.originX=t,this.originY=e),this.time=[],this.x=[],this.y=[],this.startTime=Date.now()}getMouseTrack(t=15){const e={mt_time:[],mt_x:[],mt_y:[],mt_start_time:this.startTime};for(let n=0;n<this.time.length;n++)if(e.mt_time.push(this.time[n]),e.mt_x.push(this.x[n]),e.mt_y.push(this.y[n]),n<this.time.length-1&&this.time[n+1]-this.time[n]>t){const r=(this.time[n+1]-this.time[n])/t-1,a=(this.x[n+1]-this.x[n])/(r+1),i=(this.y[n+1]-this.y[n])/(r+1),o=e.mt_time.length-1;for(let n=0;n<r;n++)e.mt_time.push(e.mt_time[o+n]+t),e.mt_x.push(Math.round(e.mt_x[o+n]+a)),e.mt_y.push(Math.round(e.mt_y[o+n]+i))}return e}}var H=n("bcab");let q;try{window.MAGPIE_STYLEGUIDIST||(q=n("06f5").default)}catch(al){console.log("Optional webgazer dependency not found. Eyetracking disabled.")}class K{constructor(){this.time=[0],this.x=[0],this.y=[0],this.startTime=0,this.originX=0,this.originY=0,this.deaf=!1}async initialize(){try{window.MAGPIE_STYLEGUIDIST&&(q=n("06f5").default)}catch(al){console.log("Optional webgazer dependency not found. Eyetracking disabled.")}if(!q)throw new Error("Could not find webgazer");return q.setRegression("ridge"),q.setGazeListener(t=>t&&this.onGaze(t)),q.begin()}onGaze(t){this.deaf||(this.time.push(Date.now()-this.startTime),this.x.push(t.x-this.originX),this.y.push(t.y-this.originY))}start(t,e){t&&e&&(this.originX=t,this.originY=e),this.time=[],this.x=[],this.y=[],this.startTime=Date.now(),this.resume()}pause(){q&&q.pause()}resume(){if(!q)throw new Error("Could not find webgazer");q.resume()}setDebug(t){q.showVideoPreview(t),q.showPredictionPoints(t)}setDeaf(t){this.deaf=t}getEyeTrack(t=15){const e={et_time:[],et_x:[],et_y:[],et_start_time:this.startTime};for(let n=0;n<this.time.length;n++)if(e.et_time.push(this.time[n]),e.et_x.push(this.x[n]),e.et_y.push(this.y[n]),n<this.time.length-1&&this.time[n+1]-this.time[n]>t){const r=(this.time[n+1]-this.time[n])/t-1,a=(this.x[n+1]-this.x[n])/(r+1),i=(this.y[n+1]-this.y[n])/(r+1),o=e.et_time.length-1;for(let n=0;n<r;n++)e.et_time.push(e.et_time[o+n]+t),e.et_x.push(Math.round(e.et_x[o+n]+a)),e.et_y.push(Math.round(e.et_y[o+n]+i))}return e}}var X=t=>{const e=new Proxy(()=>e,{get:(n,r)=>(t&&t(),"valueOf"===r||"toString"===r||r===Symbol.toPrimitive?()=>"":e)});return e};class Y extends o.a{get validators(){return $}get v(){return $}constructor(t){super(),this.experiment={},this.id=t.experimentId,this.serverUrl=t.serverUrl,this.submissionUrl=this.serverUrl+("/"===this.serverUrl[this.serverUrl.length-1]?"":"/")+"api/submit_experiment/"+this.id,this.validateSubmission=t=>!0,this.completionUrl=t.completionUrl,this.contactEmail=t.contactEmail,this.mode=t.mode,this.debug="debug"===t.mode,this.socketUrl=t.socketUrl,this.socket=t.socketUrl?new j(t.experimentId,t.socketUrl,this.onSocketError):X(()=>this.warning="You are making use of Socket functionality, but no socket URL is set in magpie.config.js"),this.trialData=window.magpie_trial_data={},this.expData=window.magpie_exp_data={},this.progress=-1,this.mousetracking=new G,this.eyetracking=new K,this.currentScreenIndex=0,this.currentSlideIndex=0,this.responseTimeStart=Date.now(),this.measurements={},this.validateMeasurements={},this.timers={},this.warning=null,console.log("magpie "+H.version),console.log("Experiment id: "+this.id),console.log("Server: "+this.serverUrl),console.log("Submission URL: "+this.submissionUrl),console.log("Mode: "+this.mode),console.log("Completion URL: "+this.completionUrl),console.log("magpie_trial_data = ",this.trialData),console.log("magpie_exp_data = ",this.expData),s["default"].observable(this),"prolific"===this.mode&&this.extractProlificData(),this.addExpData({experiment_start_time:Date.now()}),"debug"===this.mode&&(window.onunhandledrejection=t=>{this.warning=t.reason},window.onerror=function(t){this.warning=t})}nextSlide(t){"number"!==typeof t?this.currentSlideIndex++:this.currentSlideIndex=t}nextScreen(t){if("number"===typeof t)this.currentScreenIndex=t;else if("string"===typeof t){const e=this.experiment.$slots.default,n=e.filter(t=>!!t.componentOptions).findIndex(e=>e.componentOptions.propsData.label===t);if(-1===n)throw new Error('Could not find screen with label "'+t+'"');this.currentScreenIndex=n}else this.currentScreenIndex+=1;this.currentSlideIndex=0,this.measurements={},this.currentVarsData={},this.socket.state!==R.CONNECTED&&this.socket.state!==R.READY||this.socket.setCurrentScreen(this.currentScreenIndex),this.responseTimeStart=Date.now(),this.experiment.scrollToTop(),this.mousetracking.start(),this.eyetracking.pause()}saveAndNextScreen(t){this.saveMeasurements(),this.nextScreen(t)}addTrialData(t){this.trialData[this.currentScreenIndex]||(this.trialData[this.currentScreenIndex]=[]),this.trialData[this.currentScreenIndex].push({responseTime:Date.now()-this.responseTimeStart,...t})}addExpData(t){Object.assign(this.expData,t)}saveMeasurements(){this.addTrialData({responseTime:Date.now()-this.responseTimeStart,...this.measurements})}onSocketError(t){console.error(t)}getAllData(){return Z({...this.expData,experiment_end_time:Date.now(),experiment_duration:Date.now()-this.expData.experiment_start_time,...(this.socket.state===R.CONNECTED||this.socket.state===R.READY)&&{participantId:this.socket.participantId},...(this.socket.state===R.CONNECTED||this.socket.state===R.READY)&&{groupLabel:this.socket.groupLabel},trials:J(U()(Object.values(this.trialData)).map(t=>Object.assign({},Object.fromEntries(Object.entries(t).filter(([,t])=>"function"!==typeof t)))))})}submit(){if(!this.submissionUrl)throw new Error("No submission URL set");const t=this.getAllData();if(!this.validateSubmission(t))throw new Error("Submission failed validation");return this.submitResults(this.submissionUrl,t)}submitIntermediateResults(){if(!this.submissionUrl)throw new Error("No submission URL set");return this.submitResults(this.submissionUrl,this.getAllData(),!0)}async submitResults(t,e,n){if(this.socket.state===R.CONNECTED||this.socket.state===R.READY)try{const t=n?"save_intermediate_results":"submit_results";return await new Promise((n,r)=>this.socket.participantChannel.push(t,{results:e}).receive("ok",n).receive("error",r))}catch(al){if(n)throw al;console.log("Submission via magpie socket failed, trying HTTP")}const r=await fetch(t,{method:"POST",mode:"cors",headers:{"Content-type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw new Error("The server says: "+await r.text())}setProgress(t){this.progress=t}extractProlificData(){const t=new URL(window.location);this.addExpData({prolific_pid:t.searchParams.get("PROLIFIC_PID"),prolific_study_id:t.searchParams.get("STUDY_ID"),prolific_session_id:t.searchParams.get("SESSION_ID")})}}const J=function(t){for(var e=[],n=0;n<t.length;n++)for(var r in t[n])Object.prototype.hasOwnProperty.call(t[n],r)&&-1===e.indexOf(r)&&e.push(r);for(var a=0;a<t.length;a++)for(var i=0;i<e.length;i++)Object.prototype.hasOwnProperty.call(t[a],e[i])&&"undefined"!==typeof t[a]||(t[a][e[i]]="");return t},Z=function(t){var e=t.trials;delete t.trials;var n=e[0];for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&Object.prototype.hasOwnProperty.call(t,r)){var a="glb_"+r;t[a]=t[r],delete t[r]}var i=W()(e,(function(e,n){for(const t in e)Array.isArray(e[t])&&(e[t]=e[t].join("|"));if(0===n)return B()(e,t);{const n=Object.keys(t).reduce((t,e)=>(t[e]=null,t),{});return B()(e,n)}}));return i};var Q,tt,et=n("ee6e"),nt=n.n(et),rt={name:"Experiment",props:{wide:{type:Boolean,default:!1},title:{type:String,default:""},recordData:{type:Object,default:()=>({})},imageAssets:{type:Array,default(){return[]}},audioAssets:{type:Array,default(){return[]}},videoAssets:{type:Array,default(){return[]}},validateSubmission:{type:Function,default(){return()=>!0}}},data(){return{currentScreenComponent:{}}},created(){if(this.$parent.magpie=new Y(this.$options.magpie),this.$magpie.experiment=this,window.$magpie=this.$magpie,this.$magpie.socketUrl){let t=0;this.$watch("$magpie.socket.participants",e=>{const n=this.$slots.default.filter(t=>!!t.componentOptions);e.length-t<0&&n.length-1!==this.$magpie.currentScreenIndex&&(window.alert(this.$t("interactive.general.aborted")),this.$magpie.nextScreen(n.length-1)),t=e.length})}this.title&&(document.title=this.title),this.imageAssets.forEach(t=>{const e=document.createElement("link");e.href=t,e.rel="preload",e.as="image",document.head.appendChild(e)}),this.audioAssets.forEach(t=>{const e=document.createElement("link");e.href=t,e.rel="preload",e.as="audio",document.head.appendChild(e)}),this.videoAssets.forEach(t=>{const e=document.createElement("link");e.href=t,e.rel="preload",e.as="video",document.head.appendChild(e)}),this.$magpie.validateSubmission=this.validateSubmission,this.$magpie.addExpData(this.recordData),window.addEventListener("beforeunload",t=>{t.preventDefault()})},mounted(){this.$el.addEventListener("mousemove",t=>this.$magpie.mousetracking.onMouseMove(t))},methods:{scrollToTop(){const t=this.$el.getBoundingClientRect();window.scrollTo(0,window.scrollY+t.top)}},render(t){const e=this.$slots.default,n=e?e.filter(t=>!!t.componentOptions)[this.$magpie.currentScreenIndex]:null;return n.key=this.$magpie.currentScreenIndex,t("div",{class:"experiment"+(this.wide?" wide":"")},[t("div",{class:"header"},[t("div",{class:"col title"},this.$slots.title),t("div",{class:"col status"},[-1!==this.$magpie.progress?t(nt.a,{props:{percent:100*this.$magpie.progress,showText:!1,lineHeight:10},style:{width:"150px"}}):null])]),n])}},at=rt,it=(n("f59f"),n("2877")),ot=n("28a2"),st=n.n(ot),ut=Object(it["a"])(at,Q,tt,!1,null,null,null);"function"===typeof st.a&&st()(ut);var ct,lt,dt=ut.exports,ht=n("1dce"),pt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"debug-statement"},[e("h2",[t._v("magpie "+t._s(t.type))]),t._v(" "+t._s(t.text)+" ")])},ft=[],mt={name:"DebugStatement",props:{text:{type:String,required:!0},type:{type:String,default:"info"}}},gt=mt,bt=(n("4280"),Object(it["a"])(gt,pt,ft,!1,null,"5a63c536",null)),yt=bt.exports,vt={name:"Screen",mixins:[ht["validationMixin"]],props:{title:{type:String,required:!1,default:""},progress:{type:Number,default:-1},label:{type:String,default:""},validations:{type:Object,default(){return{}}}},data(){return{measurements:{}}},watch:{"$magpie.measurements":{handler(){this.measurements=this.$magpie.measurements,this.$v.measurements.$touch()},deep:!0}},beforeMount(){this.$magpie.setProgress(this.progress)},mounted(){this.$magpie.validateMeasurements=this.$v.measurements,this.$magpie.mousetracking.start()},validations(){return{measurements:this.validations}},render(t){const e=this.$slots.default;if(!e)return t("div",{class:"screen"},[this.title?t("h2",this.title):null]);let n;const r=e.filter(t=>!!t.componentOptions);return r.length&&r.every(t=>"Slide"===t.componentOptions.tag)?n=r[this.$magpie.currentSlideIndex]:(n=this.$slots.default,r.some(t=>"Slide"===t.componentOptions.tag)&&(this.$magpie.warning="This screen received mixed contents. Either provide only <Slide> elements inside your <Screen> or provide the contents of the first and only slide directly.")),n.key=this.$magpie.currentSlideIndex,t("div",{class:"screen"},[this.title?t("h2",this.title):null,n,this.$magpie.warning?t(yt,{props:{text:this.$magpie.warning,type:"warning"}}):null])}},xt=vt,wt=(n("6656"),n("3d7b")),kt=n.n(wt),St=Object(it["a"])(xt,ct,lt,!1,null,"2db71145",null);"function"===typeof kt.a&&kt()(St);var Ot=St.exports,_t=function(){var t=this,e=t._self._c;return e("div",[t._t("default")],2)},Ct=[],Tt={name:"Slide"},It=Tt,Nt=Object(it["a"])(It,_t,Ct,!1,null,null,null),Et=Nt.exports,At=function(){var t=this,e=t._self._c;return e("div",{staticClass:"completion"},[e("div",{staticClass:"question"},t._l(t.slices,(function(n,r){return e("span",{key:r},[t._v(t._s(n)+" "),r!==t.slices.length-1?e("select",{directives:[{name:"model",rawName:"v-model",value:t.answers[r],expression:"answers[i]"}],on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.answers,r,e.target.multiple?n:n[0])},function(e){t.$emit("update:response",t.fullAnswer),t.$emit("update:responses",t.answers)}]}},t._l(t.options[r],(function(n){return e("option",{key:n,domProps:{textContent:t._s(n)}})})),0):t._e()])})),0)])},Rt=[],jt={name:"CompletionInput",props:{text:{type:String,required:!0},options:{type:Array,required:!0}},data(){return{answers:[]}},computed:{slices(){return this.text.split("%s")},fullAnswer(){const t=this.answers.slice();return this.text.split("%s").map(e=>e+(t.shift()||"")).join("")}}},Dt=jt,Ft=(n("9d1e"),n("c0e4")),Mt=n.n(Ft),Pt=Object(it["a"])(Dt,At,Rt,!1,null,"20ec9a19",null);"function"===typeof Mt.a&&Mt()(Pt);var $t=Pt.exports,Lt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dropdown-input"},[e("select",{ref:"input",on:{change:function(e){return t.$emit("update:response",t.$refs.input.value)}}},t._l(t.options,(function(n){return e("option",{key:n,domProps:{value:n,textContent:t._s(n)}})})),0)])},Bt=[],zt={name:"DropdownInput",props:{options:{type:Array,required:!0}}},Wt=zt,Vt=n("6b80"),Ut=n.n(Vt),Gt=Object(it["a"])(Wt,Lt,Bt,!1,null,"6fb3df0e",null);"function"===typeof Ut.a&&Ut()(Gt);var Ht=Gt.exports,qt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"forced_choice"},[e("div",{staticClass:"options"},t._l(t.options,(function(n){return e("div",{key:n,staticClass:"option",on:{click:function(e){return t.onOptionClick(n)}}},[t._v(" "+t._s(n)+" ")])})),0)])},Kt=[],Xt={name:"ForcedChoiceInput",props:{options:{type:Array,required:!0}},methods:{onOptionClick(t){this.$emit("update:response",t)}}},Yt=Xt,Jt=(n("0abf"),n("8284")),Zt=n.n(Jt),Qt=Object(it["a"])(Yt,qt,Kt,!1,null,"0428af94",null);"function"===typeof Zt.a&&Zt()(Qt);var te=Qt.exports,ee=function(){var t=this,e=t._self._c;return e("div",{staticClass:"image_selection"},[e("div",{staticClass:"options"},t._l(t.options,(function(n){return e("div",{key:n.label,staticClass:"option",on:{click:function(e){return t.onOptionClick(n.label)}}},[e("img",{attrs:{src:n.src,alt:n.label},on:{click:function(e){return t.onOptionClick(n.label)}}})])})),0)])},ne=[],re={name:"ImageSelectionInput",props:{options:{type:Array,required:!0}},methods:{onOptionClick(t){this.$emit("update:response",t)}}},ae=re,ie=(n("2b26"),n("23dc")),oe=n.n(ie),se=Object(it["a"])(ae,ee,ne,!1,null,"36baf217",null);"function"===typeof oe.a&&oe()(se);var ue=se.exports,ce=function(){var t=this,e=t._self._c;return e("div",{staticClass:"keypress"},[t.showOptions?e("div",{staticClass:"options"},t._l(t.keys,(function(n,r){return e("span",{key:r},[e("strong",{domProps:{textContent:t._s(r)}}),t._v(" = "+t._s(n)+" ")])})),0):t._e()])},le=[],de={name:"KeypressInput",props:{keys:{type:Object,required:!0},showOptions:{type:Boolean,default:!0}},mounted(){window.document.addEventListener("keydown",this.onKeyDown)},destroyed(){window.document.removeEventListener("keydown",this.onKeyDown)},methods:{onKeyDown(t){"undefined"!==typeof this.keys[t.key]&&(t.preventDefault(),this.$emit("update:response",this.keys[t.key]))}}},he=de,pe=n("66f3"),fe=n.n(pe),me=Object(it["a"])(he,ce,le,!1,null,"6de4318b",null);"function"===typeof fe.a&&fe()(me);var ge=me.exports,be=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rating"},[e("form",[e("div",{staticClass:"options"},[e("div",{staticClass:"left"},[t._v(t._s(t.left))]),t._l(t.count,(function(n){return e("label",{key:n},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.answers[n],expression:"answers[i]"}],attrs:{type:"radio",name:"rating"},domProps:{checked:t._q(t.answers[n],null)},on:{input:function(e){return t.$emit("update:response",n)},change:function(e){return t.$set(t.answers,n,null)}}}),t._v(" "+t._s(n))])})),e("div",{staticClass:"right"},[t._v(t._s(t.right))])],2)])])},ye=[],ve={name:"RatingInput",props:{count:{type:Number,default:7},left:{type:String,optional:!0,default:""},right:{type:String,optional:!0,default:""}},data(){const t={};for(let e=1;e<this.count;e++)t[e]=!1;return{answers:t}}},xe=ve,we=(n("22ca"),n("85be")),ke=n.n(we),Se=Object(it["a"])(xe,be,ye,!1,null,"50f61df4",null);"function"===typeof ke.a&&ke()(Se);var Oe=Se.exports,_e=function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider"},[e("div",{staticClass:"slider-element"},[e("div",{staticClass:"left"},[t._v(t._s(t.left))]),e("Slider",{staticClass:"slider",attrs:{tooltip:t.tooltip?"always":"none",min:t.min,max:t.max,interval:t.interval,disabled:t.disabled},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),e("div",{staticClass:"right"},[t._v(t._s(t.right))])],1)])},Ce=[],Te=n("4971b"),Ie=n.n(Te),Ne=(n("24df"),{name:"SliderInput",components:{Slider:Ie.a},props:{left:{type:String,optional:!0,default:""},right:{type:String,optional:!0,default:""},initial:{type:Number,optional:!0,default:0},min:{type:Number,optional:!0,default:0},max:{type:Number,optional:!0,default:100},interval:{type:Number,optional:!0,default:1},tooltip:{type:Boolean,optional:!0,default:!1},disabled:{type:Boolean,optional:!0,default:!1}},data(){return{value:this.initial}},watch:{value(){this.disabled||this.$emit("update:response",this.value)}}}),Ee=Ne,Ae=(n("3276"),n("b96e")),Re=n.n(Ae),je=Object(it["a"])(Ee,_e,Ce,!1,null,"6c73a9d4",null);"function"===typeof Re.a&&Re()(je);var De=je.exports,Fe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"textarea"},[e("textarea",{ref:"text",on:{input:function(e){return t.$emit("update:response",t.$refs.text.value)}}})])},Me=[],Pe={name:"TextareaInput"},$e=Pe,Le=(n("0e43"),n("1b4e")),Be=n.n(Le),ze=Object(it["a"])($e,Fe,Me,!1,null,"7a50d03b",null);"function"===typeof Be.a&&Be()(ze);var We=ze.exports,Ve=function(){var t=this,e=t._self._c;return e("div",{class:["multiple-choice",t.orientation]},[e("form",[e("div",{staticClass:"options"},t._l(t.order,(function(n){return e("label",{key:n},[e("input",{attrs:{type:"radio",name:"options"},domProps:{value:t.options[n]},on:{input:function(e){return t.$emit("update:response",t.options[n])}}}),t.labels?[t.optionsHtml.length?e("span",{domProps:{innerHTML:t._s(t.optionsHtml[n])}}):e("span",[t._v(t._s(t.options[n]))])]:t._e()],2)})),0)])])},Ue=[],Ge=n("f560"),He=n.n(Ge),qe={name:"MultipleChoiceInput",props:{options:{type:Array,required:!0},optionsHtml:{type:Array,default:()=>[]},orientation:{type:String,default:"vertical"},labels:{type:Boolean,default:!0},randomize:{type:Boolean,default:!1}},data(){let t=Object.keys(this.options);return this.randomize&&(t=He()(t)),{order:t}},methods:{onOptionClick(t){this.$emit("update:response",t)}}},Ke=qe,Xe=(n("31ad"),n("676b")),Ye=n.n(Xe),Je=Object(it["a"])(Ke,Ve,Ue,!1,null,"f03be8e0",null);"function"===typeof Ye.a&&Ye()(Je);var Ze=Je.exports,Qe=function(){var t=this,e=t._self._c;return e("div",{staticClass:"matrix-choice"},[e("div",{staticClass:"row header"},[e("p"),e("div",t._l(t.options,(function(n){return e("label",{key:n,domProps:{textContent:t._s(n)}})})),0)]),t.randomize?[t._l(t.randomizedQuestions,(function([n,r]){return[e("div",{key:r,staticClass:"row"},[e("p",[t._v(t._s(n))]),e("MultipleChoiceInput",{attrs:{labels:!1,options:t.options,orientation:"horizontal"},on:{"update:response":function(e){return t.onOptionClick(r,e)}}})],1)]}))]:[t._l(t.questions,(function(n,r){return[e("div",{key:r,staticClass:"row"},[e("p",[t._v(t._s(n))]),e("MultipleChoiceInput",{attrs:{labels:!1,options:t.options,orientation:"horizontal"},on:{"update:response":function(e){return t.onOptionClick(r,e)}}})],1)]}))],e("div",{staticClass:"row header"},[e("p"),e("div",t._l(t.options,(function(n){return e("label",{key:n,domProps:{textContent:t._s(n)}})})),0)])],2)},tn=[],en={name:"MultipleChoiceMatrixInput",components:{MultipleChoiceInput:Ze},props:{questions:{type:Array,required:!0},options:{type:Array,required:!0},randomize:{type:Boolean,default:!1}},data(){return{responses:[],randomizedQuestions:He()(this.questions.map((t,e)=>[t,e]))}},methods:{onOptionClick(t,e){s["default"].set(this.responses,t,e),this.$emit("update:responses",this.responses)}}},nn=en,rn=(n("9ad2"),n("cfe5")),an=n.n(rn),on=Object(it["a"])(nn,Qe,tn,!1,null,null,null);"function"===typeof an.a&&an()(on);var sn=on.exports,un=function(){var t=this,e=t._self._c;return e("div",{staticClass:"slider"},[e("div",{staticClass:"slider-element"},[e("div",{staticClass:"left"},[t._v(t._s(t.left))]),e("Slider",{staticClass:"slider",attrs:{tooltip:t.tooltip?"always":"none",min:t.min,max:t.max,interval:t.interval,"enable-cross":!1,process:t.process},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),e("div",{staticClass:"right"},[t._v(t._s(t.right))])],1)])},cn=[],ln={name:"SliderRangesInput",components:{Slider:Ie.a},props:{left:{type:String,optional:!0,default:""},right:{type:String,optional:!0,default:""},initial:{type:Number,optional:!0,default:0},min:{type:Number,optional:!0,default:0},max:{type:Number,optional:!0,default:100},interval:{type:Number,optional:!0,default:1},tooltip:{type:Boolean,optional:!0,default:!1},ranges:{type:Array,required:!0}},data(){return{value:this.ranges.slice(1).map((t,e)=>Math.round((e+1)*(this.max/this.ranges.length))),process:t=>[[this.min,t[0],this.ranges[0]]].concat(t.map((e,n)=>[e,t[n+1]||this.max,this.ranges[n+1]])).map(([t,e,n])=>[t,e,{background:hn(n,pn)}])}},computed:{rangeValues(){return this.value.map((t,e)=>t-(this.value[e-1]||this.min)).concat([this.max-this.value[this.value.length-1]])},responses(){return[this.min].concat(this.value).concat[this.max]}},watch:{value(){this.$emit("update:responses",this.responses),this.$emit("update:rangeValues",this.rangeValues)}},mounted(){this.$emit("update:responses",this.responses),this.$emit("update:rangeValues",this.rangeValues)}};function dn(t){var e,n,r=0;if(0===t.length)return r;for(e=0;e<t.length;e++)n=t.charCodeAt(e),r=(r<<5)-r+n,r|=0;return r}function hn(t,e){var n=dn(t);let r=e[Math.abs(n%e.length)];return r}const pn=["#f94144","#f3722c","#f8961e","#f9c74f","#90be6d","#43aa8b","#577590"];var fn=ln,mn=(n("1491"),n("5232")),gn=n.n(mn),bn=Object(it["a"])(fn,un,cn,!1,null,"5fcc2cd1",null);"function"===typeof gn.a&&gn()(bn);var yn=bn.exports,vn=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rankorder-input"},[e("draggable",{model:{value:t.list,callback:function(e){t.list=e},expression:"list"}},t._l(t.list,(function(n,r){return e("div",{key:r,staticClass:"item"},[e("span",{staticClass:"pill"},[t._v(t._s(r+1))]),t._v(t._s(n)+" ")])})),0)],1)},xn=[],wn=n("b76a"),kn=n.n(wn),Sn={name:"RankOrderInput",components:{draggable:kn.a},props:{options:{type:Array,required:!0}},data(){return{list:this.options}},watch:{list(){this.$emit("update:response",this.list)}}},On=Sn,_n=(n("d5f8"),n("5af0")),Cn=n.n(_n),Tn=Object(it["a"])(On,vn,xn,!1,null,"cde501dc",null);"function"===typeof Cn.a&&Cn()(Tn);var In=Tn.exports,Nn=function(){var t=this,e=t._self._c;return e("div",[e("SerialInput",{attrs:{iterations:t.targets.length+1},on:{end:t.end},scopedSlots:t._u([{key:"default",fn:function({i:n,next:r}){return[t.timeout?[e("TimerStop",{attrs:{id:"responseTime"},on:{"update:time":function(e){return t.responseTimes.push(e)}}}),e("Wait",{attrs:{time:0},on:{done:t.end}})]:t.correct?[n>0?e("TimerStop",{attrs:{id:"responseTime"},on:{"update:time":function(e){t.responseTimes.push(e),n===t.targets.length&&r()}}}):t._e(),e("TimerStart",{attrs:{id:"responseTime"}}),-1!==t.responseTimeLimit?e("Wait",{attrs:{time:t.responseTimeLimit},on:{done:function(e){t.timeout=!0}}}):t._e(),e("KeypressInput",{attrs:{keys:{[t.leftKey]:"left",[t.rightKey]:"right"},"show-options":t.showKeypressOptions},on:{"update:response":function(e){t.correct=t.targets[n]===t.getOption(e,n),t.responses.push(t.getOption(e,n)),r()}}}),e("div",{staticClass:"options"},[e("div",{staticClass:"option"},[t._v(" "+t._s(t.getLeftOption(n))+" ")]),e("div",{staticClass:"option"},[t._v(" "+t._s(t.getRightOption(n))+" ")])])]:[e("TimerStop",{attrs:{id:"responseTime"},on:{"update:time":function(e){return t.responseTimes.push(e)}}}),e("Wait",{attrs:{time:0},on:{done:t.end}})]]}}])})],1)},En=[],An=function(){var t=this,e=t._self._c;return e("div",{staticClass:"serial_input"},[e("div",{key:t.i,staticClass:"slice"},[t._t("default",(function(){return[t._v(" No template defined. ")]}),{i:t.i,iterations:t.iterations,record:(e,n)=>t.$magpie.measurements[e]&&t.$magpie.measurements[e].length?t.$magpie.measurements[e].push(n):t.$magpie.measurements[e]=[n],next:()=>t.i++})],2)])},Rn=[],jn={name:"SerialInput",props:{iterations:{type:Number,required:!0}},data(){return{i:0}},watch:{i(){this.i>=this.iterations&&this.$emit("end")}}},Dn=jn,Fn=n("9315"),Mn=n.n(Fn),Pn=Object(it["a"])(Dn,An,Rn,!1,null,null,null);"function"===typeof Mn.a&&Mn()(Pn);var $n=Pn.exports,Ln=function(){var t=this,e=t._self._c;return e("span")},Bn=[],zn={name:"TimerStop",props:{id:{type:String,required:!0}},mounted(){this.$emit("update:time",Date.now()-this.$magpie.timers[this.id])}},Wn=zn,Vn=n("04d3"),Un=n.n(Vn),Gn=Object(it["a"])(Wn,Ln,Bn,!1,null,"51fb0e4e",null);"function"===typeof Un.a&&Un()(Gn);var Hn=Gn.exports,qn=function(){var t=this,e=t._self._c;return e("span")},Kn=[],Xn={name:"TimerStart",props:{id:{type:String,required:!0}},mounted(){this.$magpie.timers[this.id]=Date.now()}},Yn=Xn,Jn=n("bc0d"),Zn=n.n(Jn),Qn=Object(it["a"])(Yn,qn,Kn,!1,null,"87863ff4",null);"function"===typeof Zn.a&&Zn()(Qn);var tr=Qn.exports,er=n("2ef0"),nr=n.n(er),rr=function(){var t=this,e=t._self._c;return e("span")},ar=[],ir={name:"Wait",props:{time:{required:!0,type:Number}},data(){return{timeout:null}},watch:{time(){this.$el&&this.set()}},mounted(){this.set()},updated(){this.set()},activated(){this.set()},deactivated(){this.timeout&&clearTimeout(this.timeout)},beforeDestroy(){this.timeout&&clearTimeout(this.timeout)},methods:{set(){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.$emit("done"),this.time)}}},or=ir,sr=n("5c5c0"),ur=n.n(sr),cr=Object(it["a"])(or,rr,ar,!1,null,"16ed3190",null);"function"===typeof ur.a&&ur()(cr);var lr=cr.exports,dr={name:"MazeInput",components:{Wait:lr,TimerStart:tr,TimerStop:Hn,SerialInput:$n,KeypressInput:ge},props:{targets:{type:Array,required:!0},competitors:{type:Array,required:!0},leftKey:{type:String,default:"f"},rightKey:{type:String,default:"j"},showKeypressOptions:{type:Boolean,default:!0},responseTimeLimit:{type:Number,default:-1}},data(){const t=this.targets.length,e=nr.a.map(nr.a.range(t),()=>nr.a.random());return{responseTimes:[],responses:[],targetOnLeft:e,targetPositions:e.map(t=>t?"left":"right"),timeout:!1,correct:!0}},methods:{getLeftOption(t){return 1===this.targetOnLeft[t]?this.targets[t]:this.competitors[t]},getRightOption(t){return 0===this.targetOnLeft[t]?this.targets[t]:this.competitors[t]},getOption(t,e){return"left"===t?this.getLeftOption(e):this.getRightOption(e)},end(){this.$emit("update:response-times",this.responseTimes),this.$emit("update:responses",this.responses),this.$emit("update:target-positions",this.targetPositions),this.$emit("update:correct",this.correct),this.$emit("update:timeout",this.timeout),this.$emit("end")}}},hr=dr,pr=(n("3b1d"),n("9cff")),fr=n.n(pr),mr=Object(it["a"])(hr,Nn,En,!1,null,"e124492a",null);"function"===typeof fr.a&&fr()(mr);var gr=mr.exports,br=function(){var t=this,e=t._self._c;return e("div",[e("SerialInput",{attrs:{iterations:t.chunks.length+2},on:{end:t.end},scopedSlots:t._u([{key:"default",fn:function({i:n,next:r}){return[t.timeout?[e("TimerStop",{attrs:{id:"responseTime"},on:{"update:time":function(e){return t.responseTimes.push(e)}}}),e("Wait",{attrs:{time:0},on:{done:t.end}})]:[n>1?e("TimerStop",{attrs:{id:"responseTime"},on:{"update:time":function(e){t.responseTimes.push(e),n>t.chunks.length&&r()}}}):t._e(),n>0?e("TimerStart",{attrs:{id:"responseTime"}}):t._e(),e("KeypressInput",{attrs:{keys:{[t.trigger]:t.instructions},"show-options":t.showKeypressOptions},on:{"update:response":r}}),-1!==t.responseTimeLimit&&n>1?e("Wait",{attrs:{time:t.responseTimeLimit},on:{done:function(e){t.timeout=!0}}}):t._e(),e("div",{class:{text:!0,"underline-words":"words"===t.underline,"underline-sentence":"sentence"===t.underline,"show-all":"next"===t.wordPos}},t._l(t.chunks,(function(r,a){return e("span",{key:a,class:{current:n-1===a},domProps:{textContent:t._s(r)}})})),0)]]}}])})],1)},yr=[],vr={name:"SelfPacedReadingInput",components:{Wait:lr,TimerStart:tr,TimerStop:Hn,SerialInput:$n,KeypressInput:ge},props:{chunks:{type:Array,required:!0},instructions:{type:String,default:"Press SPACE to reveal the words."},trigger:{type:String,default:" "},underline:{type:String,default:"none"},wordPos:{type:String,default:"same"},showKeypressOptions:{type:Boolean,default:!0},responseTimeLimit:{type:Number,default:-1}},data(){return{responseTimes:[],timeout:!1}},methods:{end(){this.$emit("update:response-times",this.responseTimes),this.$emit("update:timeout",this.timeout),this.$emit("end")}}},xr=vr,wr=(n("df8d"),n("0155")),kr=n.n(wr),Sr=Object(it["a"])(xr,br,yr,!1,null,"752e72bd",null);"function"===typeof kr.a&&kr()(Sr);var Or=Sr.exports,_r=function(){var t=this,e=t._self._c;return e("div",[t._t("presentation",(function(){return[e("p",[t._v(t._s(t.chunks[t.position]))])]}),{chunk:t.chunks[t.position]}),t.position<t.chunks.length?e("Wait",{key:t.position,attrs:{time:t.interval},on:{done:t.nextChunk}}):t._e()],2)},Cr=[],Tr={name:"Rsvp",components:{Wait:lr},props:{chunks:{type:Array,required:!0},interval:{type:Number,default:300}},data(){return{position:0}},methods:{nextChunk(){this.position++,this.position>=this.chunks.length&&this.$emit("end")}}},Ir=Tr,Nr=n("c0f2"),Er=n.n(Nr),Ar=Object(it["a"])(Ir,_r,Cr,!1,null,null,null);"function"===typeof Er.a&&Er()(Ar);var Rr=Ar.exports,jr=function(){var t=this,e=t._self._c;return e("CanvasStage",{attrs:{config:{width:800,height:400}}},[e("CanvasLayer",[e("CanvasShape",{attrs:{config:{sceneFunc:function(e,n){e.beginPath(),e.moveTo(t.x-25,t.y-25),e.lineTo(t.x+25,t.y+25),e.moveTo(t.x+25,t.y-25),e.lineTo(t.x-25,t.y+25),e.closePath(),e.strokeShape(n)},strokeWidth:1,stroke:"black"}}})],1)],1)},Dr=[],Fr={name:"FixationCross",props:{x:{type:Number,default:425},y:{type:Number,default:200}}},Mr=Fr,Pr=n("0435"),$r=n.n(Pr),Lr=Object(it["a"])(Mr,jr,Dr,!1,null,null,null);"function"===typeof $r.a&&$r()(Lr);var Br=Lr.exports,zr=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chat"},[e("div",{ref:"box",staticClass:"chat-box"},t._l(t.messages,(function(n,r){return e("p",{key:r,class:{message:"message"===n.event,userEvent:"join"===n.event||"leave"===n.event,me:n.participantId===t.$magpie.socket.participantId},style:{...n.message&&{background:t.$magpie.socket.getParticipantColor(n.participantId)},...!n.message&&{color:t.$magpie.socket.getParticipantColor(n.participantId)}},domProps:{textContent:t._s(n.message||(n.participantId===t.$magpie.socket.participantId?"join"===n.event?t.$t("interactive.Chat.statusYouJoined"):"leave"===n.event?t.$t("interactive.Chat.statusYouLeft"):"":"join"===n.event?t.$t("interactive.Chat.statusParticipantJoined",{user:t.$magpie.socket.getParticipantName(n.participantId)}):"leave"===n.event?t.$t("interactive.Chat.statusParticipantLeft",{user:t.$magpie.socket.getParticipantName(n.participantId)}):""))}})})),0),e("div",{staticClass:"chat-input"},[e("textarea",{ref:"text",attrs:{cols:"50",placeholder:t.$t("interactive.Chat.messageLabel")},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.send.apply(null,arguments))}}}),e("button",{on:{click:function(e){return e.stopPropagation(),t.send()}}},[t._v(t._s(t.$t("general.send")))])])])},Wr=[],Vr=n("ceac"),Ur=n.n(Vr);const Gr="$magpie.chat_message";var Hr={name:"Chat",props:{participantLabel:{type:String,default:null}},data(){return{messages:[],interval:null}},socket:{[Gr](t){this.messages.push(t),s["default"].nextTick(()=>{this.$refs.box.scrollTop=this.$refs.box.scrollHeight}),this.$emit("update:messages",this.messages.filter(t=>"message"===t.event)),this.$emit("update:data",this.flattenData(this.messages.filter(t=>"message"===t.event)))}},watch:{["$magpie.socket.active"](t,e){const n=Ur()(t,e),r=Ur()(e,t);r.forEach(t=>{this.messages.push({time:Date.now(),participantId:t,event:"leave",message:""})}),n.forEach(t=>{this.messages.push({time:Date.now(),participantId:t,event:"join",message:""})})}},mounted(){this.$magpie.socket.active.forEach(t=>{this.messages.push({time:Date.now(),participantId:t,event:"join",message:""})})},EVENT_CHAT_MESSAGE:Gr,methods:{send(){const t=this.$refs.text.value;t&&(this.$magpie.socket.broadcast(Gr,{event:"message",message:t,participantId:this.$magpie.socket.participantId,participantLabel:this.participantLabel,time:Date.now()}),this.$refs.text.value="",this.$refs.text.focus())},flattenData(t){return{chatMessage:t.map(t=>t.message),chatParticipantId:t.map(t=>t.participantId),chatParticipantLabel:t.map(t=>t.participantId),chatTime:t.map(t=>t.time)}}}},qr=Hr,Kr=(n("f239"),n("fb49")),Xr=n.n(Kr),Yr=Object(it["a"])(qr,zr,Wr,!1,null,null,null);"function"===typeof Xr.a&&Xr()(Yr);var Jr=Yr.exports,Zr=function(){var t=this,e=t._self._c;return e("span")},Qr=[],ta={name:"WaitForParticipants",props:{number:{type:Number,required:!0}},watch:{["$magpie.socket.active"](){this.$magpie.socket.active.length===this.number&&this.$emit("done")}},mounted(){this.$magpie.socket.active.length===this.number&&this.$emit("done")}},ea=ta,na=n("969e"),ra=n.n(na),aa=Object(it["a"])(ea,Zr,Qr,!1,null,null,null);"function"===typeof ra.a&&ra()(aa);var ia=aa.exports,oa=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[t.pauseTime?e("Slide",[t.qud?e("p",{domProps:{textContent:t._s(t.qud)}}):t._e(),e("Wait",{key:"pause-timer",attrs:{time:t.pauseTime},on:{done:function(e){return t.$magpie.nextSlide()}}})],1):t._e(),t.fixationTime?e("Slide",[t.qud?e("p",{domProps:{textContent:t._s(t.qud)}}):t._e(),t._t("fixation",(function(){return[e("FixationCross")]})),-1!==t.fixationTime?e("Wait",{key:"fixation-timer",attrs:{time:t.fixationTime},on:{done:function(e){return t.$magpie.nextSlide()}}}):t._e()],2):t._e(),t.stimulusTime?e("Slide",[t.qud?e("p",{domProps:{textContent:t._s(t.qud)}}):t._e(),t._t("stimulus"),-1!==t.stimulusTime?e("Wait",{key:"stimulus-timer",attrs:{time:t.stimulusTime},on:{done:function(e){return t.$magpie.nextSlide()}}}):t._e()],2):t._e(),e("Slide",[t.qud?e("p",{domProps:{textContent:t._s(t.qud)}}):t._e(),t.stimulusTime?t._e():t._t("stimulus"),t._t("task"),t.responseTimeLimit?e("Wait",{attrs:{time:t.responseTimeLimit},on:{done:t.nextAfterTimeout}}):t._e(),e("Record",{attrs:{data:{...t.qud&&{qud:t.qud},...t.responseTimeLimit&&{responseTimeout:!1},...t.pauseTime&&{pauseTime:t.pauseTime},...t.fixationTime&&{fixationTime:t.fixationTime},...t.stimulusTime&&{stimulusTime:t.stimulusTime},...t.responseTimeLimit&&{responseTimeLimit:t.responseTimeLimit},...t.feedbackTime&&{feedbackTime:t.feedbackTime}}}}),e("ResponseTimeStart")],2),t.feedbackTime?e("Slide",[t.qud?e("p",{domProps:{textContent:t._s(t.qud)}}):t._e(),t._t("feedback"),t.feedbackTime>0?e("Wait",{attrs:{time:t.feedbackTime},on:{done:function(e){return t.$magpie.nextScreen()}}}):t._e()],2):t._e()],1)},sa=[],ua=function(){var t=this,e=t._self._c;return e("span")},ca=[],la={name:"ResponseTimeStart",mounted(){this.$magpie.responseTimeStart=Date.now()}},da=la,ha=n("f88f"),pa=n.n(ha),fa=Object(it["a"])(da,ua,ca,!1,null,"18fe891b",null);"function"===typeof pa.a&&pa()(fa);var ma=fa.exports,ga=function(){var t=this,e=t._self._c;return e("span")},ba=[],ya={name:"Record",props:{data:{type:Object,required:!0},global:{type:Boolean,default:!1}},mounted(){this.global?this.$magpie.addExpData(this.data):Object.keys(this.data).forEach(t=>{"undefined"!==typeof this.data[t]&&s["default"].set(this.$magpie.measurements,t,this.data[t])})}},va=ya,xa=n("ae6f"),wa=n.n(xa),ka=Object(it["a"])(va,ga,ba,!1,null,"36ef7edc",null);"function"===typeof wa.a&&wa()(ka);var Sa=ka.exports,Oa={name:"LifecycleScreen",components:{Record:Sa,ResponseTimeStart:ma,Wait:lr,FixationCross:Br,Slide:Et,Screen:Ot},props:{qud:{type:String,default:""},pauseTime:{type:Number,default:0},fixationTime:{type:Number,default:0},stimulusTime:{type:Number,default:0},responseTimeLimit:{type:Number,default:0},feedbackTime:{type:Number,default:0}},methods:{nextAfterResponse(){this.$props.feedbackTime?(this.$magpie.saveMeasurements(),this.$magpie.nextSlide()):this.$magpie.saveAndNextScreen()},nextAfterTimeout(){this.$props.responseTimeLimit&&(this.$magpie.measurements.responseTimeout=!0),this.nextAfterResponse()}}},_a=Oa,Ca=n("b8cd"),Ta=n.n(Ca),Ia=Object(it["a"])(_a,oa,sa,!1,null,"d32534da",null);"function"===typeof Ta.a&&Ta()(Ia);var Na=Ia.exports,Ea=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[t._t("default",(function(){return[t._v(" "+t._s(t.$t("screens.ConnectInteractiveScreen.description"))+" ")]}))],2)},Aa=[],Ra={name:"ConnectInteractiveScreen",components:{Screen:Ot},props:{},watch:{"$magpie.socket.state":function(t){t===R.READY&&this.$magpie.nextScreen()}},mounted(){this.$magpie.socket.initialize(),this.$magpie.socket.state===R.READY&&this.$magpie.nextScreen()}},ja=Ra,Da=n("43c6"),Fa=n.n(Da),Ma=Object(it["a"])(ja,Ea,Aa,!1,null,null,null);"function"===typeof Fa.a&&Fa()(Ma);var Pa=Ma.exports,$a=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[t._t("default",(function(){return[t._v(" "+t._s(t.$t("screens.AwaitIteratedResultScreen.description"))+" ")]}))],2)},La=[],Ba={name:"AwaitIteratedResultScreen",components:{Screen:Ot},props:{},watch:{"$magpie.socket.iteratedState":function(){this.$magpie.socket.iteratedState===R.READY&&this.$magpie.nextScreen()}},mounted(){this.$magpie.socket.initialize(),this.$magpie.socket.iteratedState===R.READY&&this.$magpie.nextScreen()}},za=Ba,Wa=n("5f89"),Va=n.n(Wa),Ua=Object(it["a"])(za,$a,La,!1,null,null,null);"function"===typeof Va.a&&Va()(Ua);var Ga=Ua.exports,Ha=function(){var t=this,e=t._self._c;return e("Screen",{staticClass:"debugResults",attrs:{title:"Results"}},[e("Slide",[e("button",{on:{click:t.downloadCsv}},[t._v("Download all data as csv")]),t.results.length?e("table",[e("thead",[e("tr",t._l(Object.keys(t.results[0]),(function(n){return e("th",{key:n},[t._v(t._s(n))])})),0)]),e("tbody",t._l(t.results,(function(n,r){return e("tr",{key:r},t._l(Object.keys(t.results[0]),(function(r,a){return e("td",{key:a},[t._v(" "+t._s(String(n[r]))+" ")])})),0)})),0)]):t._e()])],1)},qa=[],Ka=n("ee10"),Xa=n.n(Ka),Ya={name:"DebugResultsScreen",components:{Slide:Et,Screen:Ot},props:{},data(){return{results:[],csv:""}},mounted(){this.results=this.$magpie.getAllData(),this.csv=Xa()(this.results,{columns:Object.keys(this.results[0]),header:!0})},methods:{downloadCsv(){let t=new Blob([this.csv],{type:"text/plain",endings:"native"});this.download("magpie-"+this.$magpie.id+"-"+(new Date).toISOString().slice(0,10)+".csv",t)},download(t,e){const n=document.createElement("a");let r=URL.createObjectURL(e);n.setAttribute("href",r),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),URL.revokeObjectURL(r),document.body.removeChild(n)}}},Ja=Ya,Za=(n("d9fd"),n("775d")),Qa=n.n(Za),ti=Object(it["a"])(Ja,Ha,qa,!1,null,"681a623c",null);"function"===typeof Qa.a&&Qa()(ti);var ei=ti.exports,ni=function(){var t=this,e=t._self._c;return t.$magpie.debug?e("DebugResultsScreen"):e("Screen",{attrs:{title:"Submitting"}},[e("Slide",[e("p",[t._v(t._s(t.$t("screens.SubmitResultsScreen.waiting")))]),e("Wait",{attrs:{time:0},on:{done:function(e){t.submit(()=>t.$magpie.nextSlide())}}})],1),e("Slide",[t.error?e("div",[e("p",[t._v(t._s(t.$t("screens.SubmitResultsScreen.error")))]),e("p",[t._v(" "+t._s(t.$t("screens.SubmitResultsScreen.contact"))+" "),e("a",{attrs:{href:"mailto:"+t.$magpie.contactEmail}},[t._v(" "+t._s(t.$magpie.contactEmail)+" ")])]),e("p",{}),e("button",{staticStyle:{bottom:"40%",transform:"translate(-50%, -50%)"},on:{click:t.downloadCsv}},[t._v(" "+t._s(t.$t("screens.SubmitResultsScreen.download"))+" ")])]):e("p",[t._v(" "+t._s(t.$t("screens.SubmitResultsScreen.done"))+" "),e("Wait",{attrs:{time:3e3},on:{done:t.redirectToCompletionUrl}})],1)])],1)},ri=[],ai={name:"SubmitResultsScreen",components:{Slide:Et,DebugResultsScreen:ei,Wait:lr,Screen:Ot},props:{},data(){return{error:null,results:[],csv:""}},methods:{async submit(t){try{await this.$magpie.submit(),t()}catch(e){this.results=this.$magpie.getAllData(),this.results.length&&(this.csv=Xa()(this.results,{columns:Object.keys(this.results[0]),header:!0})),this.error=e.message,t()}},redirectToCompletionUrl(){this.$magpie.completionUrl&&"prolific"===this.$magpie.mode&&(window.location=this.$magpie.completionUrl)},downloadCsv(){const t=new Blob([this.csv],{type:"text/plain",endings:"native"}),e=document.createElement("a"),n="data-"+this.$magpie.id+"-"+(new Date).toISOString().slice(0,16).replace(/[:T]/g,"-")+".csv",r=URL.createObjectURL(t);e.setAttribute("href",r),e.setAttribute("download",n),e.style.display="none",document.body.appendChild(e),e.click(),URL.revokeObjectURL(r),document.body.removeChild(e)}}},ii=ai,oi=n("656e"),si=n.n(oi),ui=Object(it["a"])(ii,ni,ri,!1,null,null,null);"function"===typeof si.a&&si()(ui);var ci=ui.exports,li=function(){var t=this,e=t._self._c;return e("Screen",t._b({attrs:{title:"Additional information"}},"Screen",{...t.$attrs,...t.$props},!1),[e("Slide",[e("p",[t._v(" "+t._s(t.$t("screens.PostTestScreen.instruction"))+" ")]),e("div",{staticStyle:{"text-align":"left",width:"200px",margin:"0 auto"}},[t.age?e("p",[e("label",[t._v(t._s(t.$t("screens.PostTestScreen.age"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.$magpie.measurements.age,expression:"$magpie.measurements.age"}],attrs:{type:"number",max:"110",min:"18"},domProps:{value:t.$magpie.measurements.age},on:{input:function(e){e.target.composing||t.$set(t.$magpie.measurements,"age",e.target.value)}}})])]):t._e(),t.gender?e("p",[e("label",[t._v(t._s(t.$t("screens.PostTestScreen.gender"))+" "),e("DropdownInput",{attrs:{options:["",t.$t("screens.PostTestScreen.male"),t.$t("screens.PostTestScreen.female"),t.$t("screens.PostTestScreen.otherGender")],response:t.$magpie.measurements.gender},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"gender",e)}}})],1)]):t._e(),t.education?e("p",[e("label",[t._v(t._s(t.$t("screens.PostTestScreen.education"))+" "),e("DropdownInput",{attrs:{options:["",t.$t("screens.PostTestScreen.educationBelowHighschool"),t.$t("screens.PostTestScreen.educationHighschool"),t.$t("screens.PostTestScreen.educationCollege"),t.$t("screens.PostTestScreen.educationHigher")],response:t.$magpie.measurements.education},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"education",e)}}})],1)]):t._e(),t.languages?e("p",[e("label",[t._v(t._s(t.$t("screens.PostTestScreen.nativeLanguages"))+" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.$magpie.measurements.languages,expression:"$magpie.measurements.languages"}],attrs:{type:"text",placeholder:t.$t("screens.PostTestScreen.nativeLanguagesExplanation"),title:t.$t("screens.PostTestScreen.nativeLanguagesExplanation")},domProps:{value:t.$magpie.measurements.languages},on:{input:function(e){e.target.composing||t.$set(t.$magpie.measurements,"languages",e.target.value)}}})])]):t._e(),t._t("default",null,{measurements:t.$magpie.measurements}),t._v(" "+t._s(t.$t("screens.PostTestScreen.comments"))+" "),e("TextareaInput",{attrs:{response:t.$magpie.measurements.comments},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"comments",e)}}})],2),e("button",{on:{click:function(e){t.$magpie.addExpData(t.$magpie.measurements),t.$magpie.nextScreen()}}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])])],1)},di=[],hi={name:"PostTestScreen",components:{Slide:Et,DropdownInput:Ht,TextareaInput:We,Screen:Ot},props:{age:{type:Boolean,default:!0},gender:{type:Boolean,default:!0},education:{type:Boolean,default:!0},languages:{type:Boolean,default:!0},comments:{type:Boolean,default:!0}}},pi=hi,fi=n("eb48"),mi=n.n(fi),gi=Object(it["a"])(pi,li,di,!1,null,"1cb95052",null);"function"===typeof mi.a&&mi()(gi);var bi=gi.exports,yi=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[e("Slide",[e("div",{staticClass:"instructions"},[t._t("default")],2),e("button",{on:{click:function(e){return t.$magpie.nextScreen()}}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])])],1)},vi=[],xi={name:"InstructionScreen",components:{Slide:Et,Screen:Ot},props:{}},wi=xi,ki=(n("f378"),n("e09c")),Si=n.n(ki),Oi=Object(it["a"])(wi,yi,vi,!1,null,"286444fe",null);"function"===typeof Si.a&&Si()(Oi);var _i=Oi.exports,Ci=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[e("Slide",[e("Wait",{key:"start",attrs:{time:0},on:{done:t.onStart}}),e("p",[t._v(t._s(t.$t("screens.EyetrackingCalibrationScreen.start")))])],1),e("Slide",[e("Wait",{key:"calibration",attrs:{time:0},on:{done:t.runCalibration}}),e("p",[t._v(t._s(t.$t("screens.EyetrackingCalibrationScreen.instruction")))]),e("CanvasStage",{staticClass:"point",style:{left:t.x+"px",top:t.y+"px"},attrs:{config:{width:26,height:26}},on:{click:t.nextPoint}},[e("CanvasLayer",[e("CanvasCircle",{attrs:{config:{x:13,y:13,fill:"red",radius:12,stroke:"black",strokeWidth:1}}})],1)],1)],1),e("Slide",[e("p",[t._v(t._s(t.$t("screens.EyetrackingCalibrationScreen.error")))])])],1)},Ti=[],Ii=n("db1a"),Ni=n.n(Ii),Ei={name:"EyetrackingCalibrationScreen",components:{Slide:Et,Screen:Ot},props:{debug:{type:Boolean,default:!1}},data(){return{x:0,y:0,calibrationSequence:[]}},methods:{nextPoint(){const t=this.calibrationSequence.pop();t?Object.assign(this,t):(this.$magpie.eyetracking.setDeaf(!1),this.$magpie.nextScreen())},async onStart(){this.$magpie.eyetracking.setDeaf(!0);try{await this.$magpie.eyetracking.initialize(),this.$magpie.eyetracking.setDebug(this.debug),this.$magpie.nextSlide()}catch(al){console.error(al),this.$magpie.nextSlide(2)}},runCalibration(){const t=this.$magpie.experiment.$el.getBoundingClientRect();[0,.25*t.height,t.height/2,.75*t.height].forEach(e=>{[0,.25*t.width,t.width/2,.75*t.width,t.width].forEach(t=>{this.calibrationSequence.push({x:t,y:e})})}),this.calibrationSequence=U()(Ni()(2,()=>He()(this.calibrationSequence))),this.nextPoint()}}},Ai=Ei,Ri=(n("5905"),n("39a4")),ji=n.n(Ri),Di=Object(it["a"])(Ai,Ci,Ti,!1,null,"8ef3bc36",null);"function"===typeof ji.a&&ji()(Di);var Fi=Di.exports,Mi=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[e("Slide",[e("p",[t._v(t._s(t.$t("screens.EyetrackingValidationScreen.instruction")))]),e("Wait",{attrs:{time:5e3},on:{done:t.measureAccuracy}}),e("EyetrackingStart"),e("CanvasStage",{ref:"checkpoint",staticClass:"point check",style:{top:t.windowHeight/2+"px",left:t.windowWidth/2+"px"},attrs:{config:{width:26,height:26}}},[e("CanvasLayer",[e("CanvasCircle",{attrs:{config:{x:13,y:13,fill:"lightblue",radius:12,stroke:"black",strokeWidth:1}}})],1)],1)],1),e("Slide",[e("p",[t._v(t._s(t.$t("screens.EyetrackingValidationScreen.error")))])])],1)},Pi=[],$i=function(){var t=this,e=t._self._c;return e("span")},Li=[],Bi={name:"EyetrackingStart",mounted(){this.$magpie.eyetracking.start()}},zi=Bi,Wi=n("cc16"),Vi=n.n(Wi),Ui=Object(it["a"])(zi,$i,Li,!1,null,"cea287d6",null);"function"===typeof Vi.a&&Vi()(Ui);var Gi=Ui.exports,Hi={name:"EyetrackingValidationScreen",components:{Wait:lr,EyetrackingStart:Gi,Slide:Et,Screen:Ot},props:{precision:{type:Number,default:100}},data(){return{x:0,y:0,calibrationSequence:[]}},computed:{windowHeight(){return window.innerHeight},windowWidth(){return window.innerWidth}},methods:{measureAccuracy(){const t=this.$magpie.eyetracking.getEyeTrack(),e={x:window.innerWidth/2,y:window.innerHeight/2};let n,r,a,i=0;for(let s=0;s<t.et_x.length;s++)n=e.x-t.et_x[s],r=e.y-t.et_y[s],a=Math.sqrt(n**2+r**2),a<this.precision&&i++;const o=i/t.et_x.length;console.log("Eyetracking accuracy after calibration:",o),this.$magpie.addExpData({et_accuracy:o}),this.$magpie.nextScreen()}}},qi=Hi,Ki=(n("6936"),n("f7b7")),Xi=n.n(Ki),Yi=Object(it["a"])(qi,Mi,Pi,!1,null,"249dc640",null);"function"===typeof Xi.a&&Xi()(Yi);var Ji=Yi.exports,Zi=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,options:t.options}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("ForcedChoiceInput",{attrs:{options:t.options,response:t.$magpie.measurements.response},on:{"update:response":[function(e){return t.$set(t.$magpie.measurements,"response",e)},t.nextAfterResponse]}})]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Qi=[],to={name:"ForcedChoiceScreen",components:{LifecycleScreen:Na,Record:Sa,ForcedChoiceInput:te},extends:Na,props:{question:{type:String,default:void 0},options:{type:Array,required:!0}}},eo=to,no=n("5825"),ro=n.n(no),ao=Object(it["a"])(eo,Zi,Qi,!1,null,"5483b43e",null);"function"===typeof ro.a&&ro()(ao);var io=ao.exports,oo=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,options:t.options.map(t=>t.label)}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("ImageSelectionInput",{attrs:{options:t.options,response:t.$magpie.measurements.response},on:{"update:response":[function(e){return t.$set(t.$magpie.measurements,"response",e)},t.nextAfterResponse]}})]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},so=[],uo={name:"ImageSelectionScreen",components:{LifecycleScreen:Na,ImageSelectionInput:ue,Record:Sa},extends:Na,props:{question:{type:String,default:void 0},options:{type:Array,required:!0}},methods:{next(){this.$attrs.feedbackTime?(this.$magpie.save(),this.$magpie.nextSlide()):this.$magpie.saveAndNextScreen()}}},co=uo,lo=n("bb2d"),ho=n.n(lo),po=Object(it["a"])(co,oo,so,!1,null,"2f4f474a",null);"function"===typeof ho.a&&ho()(po);var fo=po.exports,mo=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("TextareaInput",{attrs:{response:t.$magpie.measurements.response},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"response",e)}}}),!t.$magpie.measurements.response||t.$magpie.validateMeasurements.response&&t.$magpie.validateMeasurements.response.$invalid?t._e():e("button",{on:{click:t.nextAfterResponse}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},go=[],bo={name:"TextareaScreen",components:{LifecycleScreen:Na,TextareaInput:We,Record:Sa},extends:Na,props:{question:{type:String,required:!0}}},yo=bo,vo=n("7991"),xo=n.n(vo),wo=Object(it["a"])(yo,mo,go,!1,null,"0d144568",null);"function"===typeof xo.a&&xo()(wo);var ko=wo.exports,So=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,...t.optionLeft&&{optionLeft:t.optionLeft},...t.optionRight&&{optionRight:t.optionRight},interval:t.interval,max:t.max,min:t.min,initial:t.initial}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("SliderInput",{attrs:{left:t.optionLeft,right:t.optionRight,min:t.min,max:t.max,interval:t.interval,initial:t.initial,disabled:t.disabled,response:t.$magpie.measurements.response},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"response",e)}}}),t.$magpie.measurements.response&&!t.$magpie.validateMeasurements.$invalid?e("button",{on:{click:t.nextAfterResponse}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")]):t._e()]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Oo=[],_o={name:"SliderScreen",components:{LifecycleScreen:Na,SliderInput:De,Record:Sa},extends:Na,props:{question:{type:String,required:!0},optionLeft:{type:String,default:""},optionRight:{type:String,default:""},initial:{type:Number,optional:!0,default:0},min:{type:Number,optional:!0,default:0},max:{type:Number,optional:!0,default:100},interval:{type:Number,optional:!0,default:1},disabled:{type:Boolean,optional:!0,default:!1}}},Co=_o,To=n("5517"),Io=n.n(To),No=Object(it["a"])(Co,So,Oo,!1,null,"6468ed0d",null);"function"===typeof Io.a&&Io()(No);var Eo=No.exports,Ao=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,...t.optionLeft&&{optionLeft:t.optionLeft},...t.optionRight&&{optionRight:t.optionRight},interval:t.interval,ranges:t.ranges,min:t.min,max:t.max}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("SliderRangesInput",{attrs:{left:t.optionLeft,right:t.optionRight,min:t.min,max:t.max,interval:t.interval,ranges:t.ranges,responses:t.$magpie.measurements.response,"range-values":t.$magpie.measurements.range_values},on:{"update:responses":function(e){return t.$set(t.$magpie.measurements,"response",e)},"update:rangeValues":function(e){return t.$set(t.$magpie.measurements,"range_values",e)},"update:range-values":function(e){return t.$set(t.$magpie.measurements,"range_values",e)}}}),t.$magpie.measurements.range_values?e("ul",t._l(t.$magpie.measurements.range_values,(function(n,r){return e("li",{key:r},[t._v(" "+t._s(n)+" "+t._s(t.ranges[r])+" ")])})),0):t._e(),!t.$magpie.measurements.response||t.$magpie.validateMeasurements.response&&t.$magpie.validateMeasurements.response.$invalid?t._e():e("button",{on:{click:t.nextAfterResponse}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Ro=[],jo={name:"SliderRangesScreen",components:{LifecycleScreen:Na,SliderRangesInput:yn,Record:Sa},extends:Na,props:{question:{type:String,required:!0},ranges:{type:Array,required:!0},optionLeft:{type:String,default:""},optionRight:{type:String,default:""},min:{type:Number,optional:!0,default:0},max:{type:Number,optional:!0,default:100},interval:{type:Number,optional:!0,default:1}}},Do=jo,Fo=n("5046"),Mo=n.n(Fo),Po=Object(it["a"])(Do,Ao,Ro,!1,null,"674745fd",null);"function"===typeof Mo.a&&Mo()(Po);var $o=Po.exports,Lo=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,...t.optionLeft&&{optionLeft:t.optionLeft},...t.optionRight&&{optionRight:t.optionRight},count:t.count}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("RatingInput",{attrs:{left:t.optionLeft,right:t.optionRight,count:t.count,response:t.$magpie.measurements.response},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"response",e)}}}),!t.$magpie.measurements.response||t.$magpie.validateMeasurements.response&&t.$magpie.validateMeasurements.response.$invalid?t._e():e("button",{on:{click:function(e){return t.$magpie.saveAndNextScreen()}}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Bo=[],zo={name:"RatingScreen",components:{LifecycleScreen:Na,RatingInput:Oe,Record:Sa},extends:Na,props:{question:{type:String,required:!0},optionLeft:{type:String,default:""},optionRight:{type:String,default:""},count:{type:Number,default:7}}},Wo=zo,Vo=n("686b"),Uo=n.n(Vo),Go=Object(it["a"])(Wo,Lo,Bo,!1,null,"1d16eb65",null);"function"===typeof Uo.a&&Uo()(Go);var Ho=Go.exports,qo=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,options:t.options,text:t.text}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("CompletionInput",{attrs:{text:t.text,options:t.options,response:t.$magpie.measurements.response,responses:t.$magpie.measurements.responses},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"response",e)},"update:responses":function(e){return t.$set(t.$magpie.measurements,"responses",e)}}}),t.$magpie.measurements.responses&&t.$magpie.measurements.responses.filter(Boolean).length===t.options.length?e("button",{on:{click:t.nextAfterResponse}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")]):t._e()]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Ko=[],Xo={name:"CompletionScreen",components:{LifecycleScreen:Na,CompletionInput:$t,Record:Sa},extends:Na,props:{question:{type:String,default:void 0},text:{type:String,required:!0},options:{type:Array,required:!0}}},Yo=Xo,Jo=n("748d"),Zo=n.n(Jo),Qo=Object(it["a"])(Yo,qo,Ko,!1,null,"0526d666",null);"function"===typeof Zo.a&&Zo()(Qo);var ts=Qo.exports,es=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("KeypressInput",{attrs:{keys:t.keys,"show-options":t.showOptions,response:t.$magpie.measurements.response},on:{"update:response":[function(e){return t.$set(t.$magpie.measurements,"response",e)},t.nextAfterResponse]}})]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation",(function(){return[e("FixationCross")]})),e("KeypressInput",{attrs:{keys:t.keys,"show-options":t.showOptions}})],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},ns=[],rs={name:"KeypressScreen",components:{FixationCross:Br,LifecycleScreen:Na,KeypressInput:ge,Record:Sa},extends:Na,props:{question:{type:String,default:void 0},keys:{type:Object,required:!0},showOptions:{type:Boolean,default:!0}}},as=rs,is=n("8b74"),os=n.n(is),ss=Object(it["a"])(as,es,ns,!1,null,"08791dd8",null);"function"===typeof os.a&&os()(ss);var us=ss.exports,cs=function(){var t=this,e=t._self._c;return e("Screen",t._b({},"Screen",{...t.$attrs,...t.$props},!1),[e("Slide",[t.qud?e("p",{staticClass:"qud",domProps:{textContent:t._s(t.qud)}}):t._e(),t._t("preparation",(function(){return[e("Wait",{attrs:{time:1},on:{done:function(e){return t.$magpie.nextSlide()}}})]}))],2),e("Slide",[t.qud?e("p",{staticClass:"qud",domProps:{textContent:t._s(t.qud)}}):t._e(),e("Wait",{key:"pause",attrs:{time:t.pauseTime},on:{done:function(e){return t.$magpie.nextSlide()}}})],1),e("Slide",[t.qud?e("p",{staticClass:"qud",domProps:{textContent:t._s(t.qud)}}):t._e(),e("Wait",{key:"wait a bit",attrs:{time:500},on:{done:function(e){return t.$magpie.nextSlide()}}}),e("div",{staticClass:"options"},[e("div",{staticClass:"option1"},[t._t("option1")],2),e("div",{staticClass:"space"}),e("div",{staticClass:"option2"},[t._t("option2")],2)])],1),e("Slide",[e("div",{staticClass:"options"},[t.$magpie.measurements.response?t._e():e("div",{staticClass:"option1",on:t._d({},[t.selectEvent,function(e){return t.submit("option1")}])},[t._t("option1")],2),e("div",{staticClass:"space"}),t.$magpie.measurements.response?t._e():e("div",{staticClass:"option2",on:t._d({},[t.selectEvent,function(e){return t.submit("option2")}])},[t._t("option2")],2)]),t.qud?e("p",{staticClass:"qud",domProps:{textContent:t._s(t.qud)}}):t._e(),e("div",{staticClass:"stimulus"},[t.playing?t._t("stimulus",null,{coordinates:t.buttonCoordinates}):t._e(),t.$magpie.measurements.response?t._t("feedback"):t._e()],2),t.playing?t._e():e("button",{ref:"button",on:{click:t.onPressPlay}},[t._v(" "+t._s(t.$t("general.go"))+" ")]),t.playing&&t.responseTimeLimit?e("Wait",{attrs:{time:t.responseTimeLimit},on:{done:function(e){return t.$magpie.nextSlide()}}}):t._e(),t.playing?e("TimerStart",{attrs:{id:"fcmt-response-time"}}):t._e(),t.$magpie.measurements.response?e("TimerStop",{attrs:{id:"fcmt-response-time",time:t.$magpie.measurements.responseTime},on:{"update:time":function(e){return t.$set(t.$magpie.measurements,"responseTime",e)}}}):t._e()],1)],1)},ls=[],ds={name:"ForcedChoiceMousetrackingScreen",components:{TimerStart:tr,TimerStop:Hn,Slide:Et,Screen:Ot,Wait:lr},props:{option1:{type:String,default:"option1"},option2:{type:String,default:"option2"},selectEvent:{type:String,default:"mouseover"},qud:{type:String,default:void 0},pauseTime:{type:Number,default:0},responseTimeLimit:{type:Number,default:0}},data(){return{playing:!1}},computed:{buttonCoordinates(){return{x:this.$refs.button.getBoundingClientRect().x,y:this.$refs.button.getBoundingClientRect().y}}},methods:{onPressPlay(){this.playing=!0,this.$magpie.mousetracking.start(this.buttonCoordinates.x,this.buttonCoordinates.y)},submit(t){if(!this.playing)return;this.$magpie.measurements.response=this[t];const e=this.$magpie.mousetracking.getMouseTrack();for(const n in e)s["default"].set(this.$magpie.measurements,n,JSON.parse(JSON.stringify(e[n])))}}},hs=ds,ps=(n("63a0"),n("7518")),fs=n.n(ps),ms=Object(it["a"])(hs,cs,ls,!1,null,"22cf83e4",null);"function"===typeof fs.a&&fs()(ms);var gs=ms.exports,bs=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,options:t.options,orientation:t.orientation,randomize:t.randomize,...t.optionsHtml.length&&{optionsHtml:t.optionsHtml}}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("MultipleChoiceInput",{attrs:{options:t.options,"options-html":t.optionsHtml,orientation:t.orientation,randomize:t.randomize,response:t.$magpie.measurements.response},on:{"update:response":function(e){return t.$set(t.$magpie.measurements,"response",e)}}}),!t.$magpie.measurements.response||t.$magpie.validateMeasurements.response&&t.$magpie.validateMeasurements.response.$invalid?t._e():e("button",{on:{click:function(e){return t.$magpie.saveAndNextScreen()}}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")])]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},ys=[],vs={name:"MultipleChoiceScreen",components:{LifecycleScreen:Na,MultipleChoiceInput:Ze,Record:Sa},extends:Na,props:{question:{type:String,required:!0},options:{type:Array,required:!0},optionsHtml:{type:Array,default:()=>[]},orientation:{type:String,default:"vertical"},randomize:{type:Boolean,default:!1}}},xs=vs,ws=n("4f8b"),ks=n.n(ws),Ss=Object(it["a"])(xs,bs,ys,!1,null,"ccf8f3fe",null);"function"===typeof ks.a&&ks()(Ss);var Os=Ss.exports,_s=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"task",fn:function(){return[e("Record",{attrs:{data:{questions:t.questions,options:t.options,...t.randomize&&{randomize:t.randomize}}}}),e("MultipleChoiceMatrixInput",{attrs:{options:t.options,questions:t.questions,randomize:t.randomize,responses:t.$magpie.measurements.responses},on:{"update:responses":function(e){return t.$set(t.$magpie.measurements,"responses",e)}}}),t.$magpie.measurements.responses&&!t.$magpie.validateMeasurements.$invalid?e("button",{on:{click:t.nextAfterResponse}},[t._v(" "+t._s(t.$t("general.nextButton"))+" ")]):t._e()]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1),[e("template",{slot:"fixation"},[t._t("fixation")],2),e("template",{slot:"stimulus"},[t._t("stimulus")],2)],2)},Cs=[],Ts={name:"MultipleChoiceMatrixScreen",components:{LifecycleScreen:Na,MultipleChoiceMatrixInput:sn,Record:Sa},extends:Na,props:{questions:{type:Array,required:!0},options:{type:Array,required:!0},randomize:{type:Boolean,default:!1}}},Is=Ts,Ns=n("d3e0"),Es=n.n(Ns),As=Object(it["a"])(Is,_s,Cs,!1,null,"489277d4",null);"function"===typeof Es.a&&Es()(As);var Rs=As.exports,js=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"fixation",fn:function(){return[t._t("fixation",(function(){return[e("FixationCross")]}))]},proxy:!0},{key:"stimulus",fn:function(){return[t._t("stimulus")]},proxy:!0},{key:"task",fn:function(){return[e("Record",{attrs:{data:{question:t.question,targets:t.targets,competitors:t.competitors,leftKey:t.leftKey,rightKey:t.rightKey,mazeTimeLimit:t.mazeTimeLimit}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),e("MazeInput",{attrs:{targets:t.targets,competitors:t.competitors,"response-time-limit":t.mazeTimeLimit,"response-times":t.$magpie.measurements.times,"target-positions":t.$magpie.measurements.target_positions,responses:t.$magpie.measurements.responses,timeout:t.$magpie.measurements.maze_timeout,correct:t.$magpie.measurements.correct},on:{"update:responseTimes":function(e){return t.$set(t.$magpie.measurements,"times",e)},"update:response-times":function(e){return t.$set(t.$magpie.measurements,"times",e)},"update:targetPositions":function(e){return t.$set(t.$magpie.measurements,"target_positions",e)},"update:target-positions":function(e){return t.$set(t.$magpie.measurements,"target_positions",e)},"update:responses":function(e){return t.$set(t.$magpie.measurements,"responses",e)},"update:timeout":function(e){return t.$set(t.$magpie.measurements,"maze_timeout",e)},"update:correct":function(e){return t.$set(t.$magpie.measurements,"correct",e)},end:t.nextAfterResponse}})]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1))},Ds=[],Fs={name:"MazeScreen",components:{LifecycleScreen:Na,MazeInput:gr,Record:Sa},extends:Na,props:{question:{type:String,default:void 0},targets:{type:Array,required:!0},competitors:{type:Array,required:!0},mazeTimeLimit:{type:Number,default:-1},leftKey:{type:String,default:"f"},rightKey:{type:String,default:"j"},progress:{type:Number,default:void 0}}},Ms=Fs,Ps=n("baba"),$s=n.n(Ps),Ls=Object(it["a"])(Ms,js,Ds,!1,null,null,null);"function"===typeof $s.a&&$s()(Ls);var Bs=Ls.exports,zs=function(){var t=this,e=t._self._c;return e("LifecycleScreen",t._b({scopedSlots:t._u([{key:"fixation",fn:function(){return[t._t("fixation",(function(){return[e("FixationCross")]}))]},proxy:!0},{key:"stimulus",fn:function(){return[t._t("stimulus")]},proxy:!0},{key:"task",fn:function(){return[e("Record",{attrs:{data:{chunks:t.chunks,trigger:t.trigger,underline:t.underline,wordPos:t.wordPos,question:t.question}}}),t.question?e("p",{domProps:{textContent:t._s(t.question)}}):t._e(),t.instructions?e("p",{domProps:{textContent:t._s(t.instructions)}}):t._e(),e("SelfPacedReadingInput",{attrs:{chunks:t.chunks,"word-pos":t.wordPos,underline:t.underline,trigger:t.trigger,"response-times":t.$magpie.measurements.response_times,timeout:t.$magpie.measurements.spr_timeout,"show-keypress-options":!1},on:{"update:responseTimes":function(e){return t.$set(t.$magpie.measurements,"response_times",e)},"update:response-times":function(e){return t.$set(t.$magpie.measurements,"response_times",e)},"update:timeout":function(e){return t.$set(t.$magpie.measurements,"spr_timeout",e)},end:t.nextAfterResponse}})]},proxy:!0},{key:"feedback",fn:function(){return[t._t("feedback")]},proxy:!0}],null,!0)},"LifecycleScreen",{...t.$attrs,...t.$props},!1))},Ws=[],Vs={name:"SelfPacedReadingScreen",components:{LifecycleScreen:Na,SelfPacedReadingInput:Or},extends:Na,props:{question:{type:String,default:void 0},chunks:{type:Array,required:!0},instructions:{type:String,default:"Press SPACE to reveal the words."},trigger:{type:String,default:" "},underline:{type:String,default:"none"},wordPos:{type:String,default:"same"},sprTimeLimit:{type:Number,default:-1}},data(){return{responseTimes:[],responseTimeout:!1}}},Us=Vs,Gs=(n("6cb7"),n("39cd")),Hs=n.n(Gs),qs=Object(it["a"])(Us,zs,Ws,!1,null,"18f4a5b4",null);"function"===typeof Hs.a&&Hs()(qs);var Ks=qs.exports,Xs=function(){var t=this,e=t._self._c;return e("span")},Ys=[],Js={name:"MousetrackingStart",mounted(){this.$magpie.mousetracking.start()}},Zs=Js,Qs=n("acf4"),tu=n.n(Qs),eu=Object(it["a"])(Zs,Xs,Ys,!1,null,"39ed7d0a",null);"function"===typeof tu.a&&tu()(eu);var nu=eu.exports,ru=function(){var t=this,e=t._self._c;return e("span")},au=[],iu={name:"FullscreenStart",mounted(){document.documentElement.requestFullscreen()}},ou=iu,su=n("38e4"),uu=n.n(su),cu=Object(it["a"])(ou,ru,au,!1,null,"292734e2",null);"function"===typeof uu.a&&uu()(cu);var lu=cu.exports,du=function(){var t=this,e=t._self._c;return e("span")},hu=[],pu={name:"HideCursor",mounted(){document.onmousedown=()=>!1,document.onclick=()=>!1,document.body.classList.add("nocursor")},deactivated(){document.onmousedown=null,document.onclick=null,document.body.classList.remove("nocursor")},destroyed(){document.onmousedown=null,document.onclick=null,document.body.classList.remove("nocursor")}},fu=pu,mu=(n("a1df"),n("5ec0")),gu=n.n(mu),bu=Object(it["a"])(fu,du,hu,!1,null,null,null);"function"===typeof gu.a&&gu()(bu);var yu=bu.exports,vu=function(){var t=this,e=t._self._c;return e("span")},xu=[],wu={name:"PreventCopyPaste",mounted(){document.onselectstart=()=>!1,document.oncontextmenu=()=>!1,document.body.classList.add("noselect")},deactivated(){document.onselectstart=null,document.oncontextmenu=null,document.body.classList.remove("noselect")},destroyed(){document.onselectstart=null,document.oncontextmenu=null,document.body.classList.remove("noselect")}},ku=wu,Su=(n("df47"),n("627d")),Ou=n.n(Su),_u=Object(it["a"])(ku,vu,xu,!1,null,null,null);"function"===typeof Ou.a&&Ou()(_u);var Cu=_u.exports;const Tu=()=>n.e("chunk-70e262cb").then(n.bind(null,"39ca"));
/*!
 * vue-i18n v8.28.2 
 * (c) 2022 kazuya kawaguchi
 * Released under the MIT License.
 */var Iu=["compactDisplay","currency","currencyDisplay","currencySign","localeMatcher","notation","numberingSystem","signDisplay","style","unit","unitDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"],Nu=["dateStyle","timeStyle","calendar","localeMatcher","hour12","hourCycle","timeZone","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function Eu(t,e){"undefined"!==typeof console&&(console.warn("[vue-i18n] "+t),e&&console.warn(e.stack))}function Au(t,e){"undefined"!==typeof console&&(console.error("[vue-i18n] "+t),e&&console.error(e.stack))}var Ru=Array.isArray;function ju(t){return null!==t&&"object"===typeof t}function Du(t){return"boolean"===typeof t}function Fu(t){return"string"===typeof t}var Mu=Object.prototype.toString,Pu="[object Object]";function $u(t){return Mu.call(t)===Pu}function Lu(t){return null===t||void 0===t}function Bu(t){return"function"===typeof t}function zu(){var t=[],e=arguments.length;while(e--)t[e]=arguments[e];var n=null,r=null;return 1===t.length?ju(t[0])||Ru(t[0])?r=t[0]:"string"===typeof t[0]&&(n=t[0]):2===t.length&&("string"===typeof t[0]&&(n=t[0]),(ju(t[1])||Ru(t[1]))&&(r=t[1])),{locale:n,params:r}}function Wu(t){return JSON.parse(JSON.stringify(t))}function Vu(t,e){if(t.delete(e))return t}function Uu(t){var e=[];return t.forEach((function(t){return e.push(t)})),e}function Gu(t,e){return!!~t.indexOf(e)}var Hu=Object.prototype.hasOwnProperty;function qu(t,e){return Hu.call(t,e)}function Ku(t){for(var e=arguments,n=Object(t),r=1;r<arguments.length;r++){var a=e[r];if(void 0!==a&&null!==a){var i=void 0;for(i in a)qu(a,i)&&(ju(a[i])?n[i]=Ku(n[i],a[i]):n[i]=a[i])}}return n}function Xu(t,e){if(t===e)return!0;var n=ju(t),r=ju(e);if(!n||!r)return!n&&!r&&String(t)===String(e);try{var a=Ru(t),i=Ru(e);if(a&&i)return t.length===e.length&&t.every((function(t,n){return Xu(t,e[n])}));if(a||i)return!1;var o=Object.keys(t),s=Object.keys(e);return o.length===s.length&&o.every((function(n){return Xu(t[n],e[n])}))}catch(al){return!1}}function Yu(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function Ju(t){return null!=t&&Object.keys(t).forEach((function(e){"string"==typeof t[e]&&(t[e]=Yu(t[e]))})),t}function Zu(t){t.prototype.hasOwnProperty("$i18n")||Object.defineProperty(t.prototype,"$i18n",{get:function(){return this._i18n}}),t.prototype.$t=function(t){var e=[],n=arguments.length-1;while(n-- >0)e[n]=arguments[n+1];var r=this.$i18n;return r._t.apply(r,[t,r.locale,r._getMessages(),this].concat(e))},t.prototype.$tc=function(t,e){var n=[],r=arguments.length-2;while(r-- >0)n[r]=arguments[r+2];var a=this.$i18n;return a._tc.apply(a,[t,a.locale,a._getMessages(),this,e].concat(n))},t.prototype.$te=function(t,e){var n=this.$i18n;return n._te(t,n.locale,n._getMessages(),e)},t.prototype.$d=function(t){var e,n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];return(e=this.$i18n).d.apply(e,[t].concat(n))},t.prototype.$n=function(t){var e,n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];return(e=this.$i18n).n.apply(e,[t].concat(n))}}function Qu(t){function e(){this!==this.$root&&this.$options.__INTLIFY_META__&&this.$el&&this.$el.setAttribute("data-intlify",this.$options.__INTLIFY_META__)}return void 0===t&&(t=!1),t?{mounted:e}:{beforeCreate:function(){var t=this.$options;if(t.i18n=t.i18n||(t.__i18nBridge||t.__i18n?{}:null),t.i18n)if(t.i18n instanceof Jc){if(t.__i18nBridge||t.__i18n)try{var e=t.i18n&&t.i18n.messages?t.i18n.messages:{},n=t.__i18nBridge||t.__i18n;n.forEach((function(t){e=Ku(e,JSON.parse(t))})),Object.keys(e).forEach((function(n){t.i18n.mergeLocaleMessage(n,e[n])}))}catch(al){0}this._i18n=t.i18n,this._i18nWatcher=this._i18n.watchI18nData()}else if($u(t.i18n)){var r=this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Jc?this.$root.$i18n:null;if(r&&(t.i18n.root=this.$root,t.i18n.formatter=r.formatter,t.i18n.fallbackLocale=r.fallbackLocale,t.i18n.formatFallbackMessages=r.formatFallbackMessages,t.i18n.silentTranslationWarn=r.silentTranslationWarn,t.i18n.silentFallbackWarn=r.silentFallbackWarn,t.i18n.pluralizationRules=r.pluralizationRules,t.i18n.preserveDirectiveContent=r.preserveDirectiveContent),t.__i18nBridge||t.__i18n)try{var a=t.i18n&&t.i18n.messages?t.i18n.messages:{},i=t.__i18nBridge||t.__i18n;i.forEach((function(t){a=Ku(a,JSON.parse(t))})),t.i18n.messages=a}catch(al){0}var o=t.i18n,s=o.sharedMessages;s&&$u(s)&&(t.i18n.messages=Ku(t.i18n.messages,s)),this._i18n=new Jc(t.i18n),this._i18nWatcher=this._i18n.watchI18nData(),(void 0===t.i18n.sync||t.i18n.sync)&&(this._localeWatcher=this.$i18n.watchLocale()),r&&r.onComponentInstanceCreated(this._i18n)}else 0;else this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Jc?this._i18n=this.$root.$i18n:t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Jc&&(this._i18n=t.parent.$i18n)},beforeMount:function(){var t=this.$options;t.i18n=t.i18n||(t.__i18nBridge||t.__i18n?{}:null),t.i18n?(t.i18n instanceof Jc||$u(t.i18n))&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0):(this.$root&&this.$root.$i18n&&this.$root.$i18n instanceof Jc||t.parent&&t.parent.$i18n&&t.parent.$i18n instanceof Jc)&&(this._i18n.subscribeDataChanging(this),this._subscribing=!0)},mounted:e,beforeDestroy:function(){if(this._i18n){var t=this;this.$nextTick((function(){t._subscribing&&(t._i18n.unsubscribeDataChanging(t),delete t._subscribing),t._i18nWatcher&&(t._i18nWatcher(),t._i18n.destroyVM(),delete t._i18nWatcher),t._localeWatcher&&(t._localeWatcher(),delete t._localeWatcher)}))}}}}var tc={name:"i18n",functional:!0,props:{tag:{type:[String,Boolean,Object],default:"span"},path:{type:String,required:!0},locale:{type:String},places:{type:[Array,Object]}},render:function(t,e){var n=e.data,r=e.parent,a=e.props,i=e.slots,o=r.$i18n;if(o){var s=a.path,u=a.locale,c=a.places,l=i(),d=o.i(s,u,ec(l)||c?nc(l.default,c):l),h=a.tag&&!0!==a.tag||!1===a.tag?a.tag:"span";return h?t(h,n,d):d}}};function ec(t){var e;for(e in t)if("default"!==e)return!1;return Boolean(e)}function nc(t,e){var n=e?rc(e):{};if(!t)return n;t=t.filter((function(t){return t.tag||""!==t.text.trim()}));var r=t.every(oc);return t.reduce(r?ac:ic,n)}function rc(t){return Array.isArray(t)?t.reduce(ic,{}):Object.assign({},t)}function ac(t,e){return e.data&&e.data.attrs&&e.data.attrs.place&&(t[e.data.attrs.place]=e),t}function ic(t,e,n){return t[n]=e,t}function oc(t){return Boolean(t.data&&t.data.attrs&&t.data.attrs.place)}var sc,uc={name:"i18n-n",functional:!0,props:{tag:{type:[String,Boolean,Object],default:"span"},value:{type:Number,required:!0},format:{type:[String,Object]},locale:{type:String}},render:function(t,e){var n=e.props,r=e.parent,a=e.data,i=r.$i18n;if(!i)return null;var o=null,s=null;Fu(n.format)?o=n.format:ju(n.format)&&(n.format.key&&(o=n.format.key),s=Object.keys(n.format).reduce((function(t,e){var r;return Gu(Iu,e)?Object.assign({},t,(r={},r[e]=n.format[e],r)):t}),null));var u=n.locale||i.locale,c=i._ntp(n.value,u,o,s),l=c.map((function(t,e){var n,r=a.scopedSlots&&a.scopedSlots[t.type];return r?r((n={},n[t.type]=t.value,n.index=e,n.parts=c,n)):t.value})),d=n.tag&&!0!==n.tag||!1===n.tag?n.tag:"span";return d?t(d,{attrs:a.attrs,class:a["class"],staticClass:a.staticClass},l):l}};function cc(t,e,n){hc(t,n)&&fc(t,e,n)}function lc(t,e,n,r){if(hc(t,n)){var a=n.context.$i18n;pc(t,n)&&Xu(e.value,e.oldValue)&&Xu(t._localeMessage,a.getLocaleMessage(a.locale))||fc(t,e,n)}}function dc(t,e,n,r){var a=n.context;if(a){var i=n.context.$i18n||{};e.modifiers.preserve||i.preserveDirectiveContent||(t.textContent=""),t._vt=void 0,delete t["_vt"],t._locale=void 0,delete t["_locale"],t._localeMessage=void 0,delete t["_localeMessage"]}else Eu("Vue instance does not exists in VNode context")}function hc(t,e){var n=e.context;return n?!!n.$i18n||(Eu("VueI18n instance does not exists in Vue instance"),!1):(Eu("Vue instance does not exists in VNode context"),!1)}function pc(t,e){var n=e.context;return t._locale===n.$i18n.locale}function fc(t,e,n){var r,a,i=e.value,o=mc(i),s=o.path,u=o.locale,c=o.args,l=o.choice;if(s||u||c)if(s){var d=n.context;t._vt=t.textContent=null!=l?(r=d.$i18n).tc.apply(r,[s,l].concat(gc(u,c))):(a=d.$i18n).t.apply(a,[s].concat(gc(u,c))),t._locale=d.$i18n.locale,t._localeMessage=d.$i18n.getLocaleMessage(d.$i18n.locale)}else Eu("`path` is required in v-t directive");else Eu("value type not supported")}function mc(t){var e,n,r,a;return Fu(t)?e=t:$u(t)&&(e=t.path,n=t.locale,r=t.args,a=t.choice),{path:e,locale:n,args:r,choice:a}}function gc(t,e){var n=[];return t&&n.push(t),e&&(Array.isArray(e)||$u(e))&&n.push(e),n}function bc(t,e){void 0===e&&(e={bridge:!1}),bc.installed=!0,sc=t;sc.version&&Number(sc.version.split(".")[0]);Zu(sc),sc.mixin(Qu(e.bridge)),sc.directive("t",{bind:cc,update:lc,unbind:dc}),sc.component(tc.name,tc),sc.component(uc.name,uc);var n=sc.config.optionMergeStrategies;n.i18n=function(t,e){return void 0===e?t:e}}var yc=function(){this._caches=Object.create(null)};yc.prototype.interpolate=function(t,e){if(!e)return[t];var n=this._caches[t];return n||(n=wc(t),this._caches[t]=n),kc(n,e)};var vc=/^(?:\d)+/,xc=/^(?:\w)+/;function wc(t){var e=[],n=0,r="";while(n<t.length){var a=t[n++];if("{"===a){r&&e.push({type:"text",value:r}),r="";var i="";a=t[n++];while(void 0!==a&&"}"!==a)i+=a,a=t[n++];var o="}"===a,s=vc.test(i)?"list":o&&xc.test(i)?"named":"unknown";e.push({value:i,type:s})}else"%"===a?"{"!==t[n]&&(r+=a):r+=a}return r&&e.push({type:"text",value:r}),e}function kc(t,e){var n=[],r=0,a=Array.isArray(e)?"list":ju(e)?"named":"unknown";if("unknown"===a)return n;while(r<t.length){var i=t[r];switch(i.type){case"text":n.push(i.value);break;case"list":n.push(e[parseInt(i.value,10)]);break;case"named":"named"===a&&n.push(e[i.value]);break;case"unknown":0;break}r++}return n}var Sc=0,Oc=1,_c=2,Cc=3,Tc=0,Ic=1,Nc=2,Ec=3,Ac=4,Rc=5,jc=6,Dc=7,Fc=8,Mc=[];Mc[Tc]={ws:[Tc],ident:[Ec,Sc],"[":[Ac],eof:[Dc]},Mc[Ic]={ws:[Ic],".":[Nc],"[":[Ac],eof:[Dc]},Mc[Nc]={ws:[Nc],ident:[Ec,Sc],0:[Ec,Sc],number:[Ec,Sc]},Mc[Ec]={ident:[Ec,Sc],0:[Ec,Sc],number:[Ec,Sc],ws:[Ic,Oc],".":[Nc,Oc],"[":[Ac,Oc],eof:[Dc,Oc]},Mc[Ac]={"'":[Rc,Sc],'"':[jc,Sc],"[":[Ac,_c],"]":[Ic,Cc],eof:Fc,else:[Ac,Sc]},Mc[Rc]={"'":[Ac,Sc],eof:Fc,else:[Rc,Sc]},Mc[jc]={'"':[Ac,Sc],eof:Fc,else:[jc,Sc]};var Pc=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function $c(t){return Pc.test(t)}function Lc(t){var e=t.charCodeAt(0),n=t.charCodeAt(t.length-1);return e!==n||34!==e&&39!==e?t:t.slice(1,-1)}function Bc(t){if(void 0===t||null===t)return"eof";var e=t.charCodeAt(0);switch(e){case 91:case 93:case 46:case 34:case 39:return t;case 95:case 36:case 45:return"ident";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return"ident"}function zc(t){var e=t.trim();return("0"!==t.charAt(0)||!isNaN(t))&&($c(e)?Lc(e):"*"+e)}function Wc(t){var e,n,r,a,i,o,s,u=[],c=-1,l=Tc,d=0,h=[];function p(){var e=t[c+1];if(l===Rc&&"'"===e||l===jc&&'"'===e)return c++,r="\\"+e,h[Sc](),!0}h[Oc]=function(){void 0!==n&&(u.push(n),n=void 0)},h[Sc]=function(){void 0===n?n=r:n+=r},h[_c]=function(){h[Sc](),d++},h[Cc]=function(){if(d>0)d--,l=Ac,h[Sc]();else{if(d=0,void 0===n)return!1;if(n=zc(n),!1===n)return!1;h[Oc]()}};while(null!==l)if(c++,e=t[c],"\\"!==e||!p()){if(a=Bc(e),s=Mc[l],i=s[a]||s["else"]||Fc,i===Fc)return;if(l=i[0],o=h[i[1]],o&&(r=i[2],r=void 0===r?e:r,!1===o()))return;if(l===Dc)return u}}var Vc=function(){this._cache=Object.create(null)};Vc.prototype.parsePath=function(t){var e=this._cache[t];return e||(e=Wc(t),e&&(this._cache[t]=e)),e||[]},Vc.prototype.getPathValue=function(t,e){if(!ju(t))return null;var n=this.parsePath(e);if(0===n.length)return null;var r=n.length,a=t,i=0;while(i<r){var o=a[n[i]];if(void 0===o||null===o)return null;a=o,i++}return a};var Uc,Gc=/<\/?[\w\s="/.':;#-\/]+>/,Hc=/(?:@(?:\.[a-zA-Z]+)?:(?:[\w\-_|./]+|\([\w\-_:|./]+\)))/g,qc=/^@(?:\.([a-zA-Z]+))?:/,Kc=/[()]/g,Xc={upper:function(t){return t.toLocaleUpperCase()},lower:function(t){return t.toLocaleLowerCase()},capitalize:function(t){return""+t.charAt(0).toLocaleUpperCase()+t.substr(1)}},Yc=new yc,Jc=function(t){var e=this;void 0===t&&(t={}),!sc&&"undefined"!==typeof window&&window.Vue&&bc(window.Vue);var n=t.locale||"en-US",r=!1!==t.fallbackLocale&&(t.fallbackLocale||"en-US"),a=t.messages||{},i=t.dateTimeFormats||t.datetimeFormats||{},o=t.numberFormats||{};this._vm=null,this._formatter=t.formatter||Yc,this._modifiers=t.modifiers||{},this._missing=t.missing||null,this._root=t.root||null,this._sync=void 0===t.sync||!!t.sync,this._fallbackRoot=void 0===t.fallbackRoot||!!t.fallbackRoot,this._fallbackRootWithEmptyString=void 0===t.fallbackRootWithEmptyString||!!t.fallbackRootWithEmptyString,this._formatFallbackMessages=void 0!==t.formatFallbackMessages&&!!t.formatFallbackMessages,this._silentTranslationWarn=void 0!==t.silentTranslationWarn&&t.silentTranslationWarn,this._silentFallbackWarn=void 0!==t.silentFallbackWarn&&!!t.silentFallbackWarn,this._dateTimeFormatters={},this._numberFormatters={},this._path=new Vc,this._dataListeners=new Set,this._componentInstanceCreatedListener=t.componentInstanceCreatedListener||null,this._preserveDirectiveContent=void 0!==t.preserveDirectiveContent&&!!t.preserveDirectiveContent,this.pluralizationRules=t.pluralizationRules||{},this._warnHtmlInMessage=t.warnHtmlInMessage||"off",this._postTranslation=t.postTranslation||null,this._escapeParameterHtml=t.escapeParameterHtml||!1,"__VUE_I18N_BRIDGE__"in t&&(this.__VUE_I18N_BRIDGE__=t.__VUE_I18N_BRIDGE__),this.getChoiceIndex=function(t,n){var r=Object.getPrototypeOf(e);if(r&&r.getChoiceIndex){var a=r.getChoiceIndex;return a.call(e,t,n)}var i=function(t,e){return t=Math.abs(t),2===e?t?t>1?1:0:1:t?Math.min(t,2):0};return e.locale in e.pluralizationRules?e.pluralizationRules[e.locale].apply(e,[t,n]):i(t,n)},this._exist=function(t,n){return!(!t||!n)&&(!Lu(e._path.getPathValue(t,n))||!!t[n])},"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||Object.keys(a).forEach((function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,a[t])})),this._initVM({locale:n,fallbackLocale:r,messages:a,dateTimeFormats:i,numberFormats:o})},Zc={vm:{configurable:!0},messages:{configurable:!0},dateTimeFormats:{configurable:!0},numberFormats:{configurable:!0},availableLocales:{configurable:!0},locale:{configurable:!0},fallbackLocale:{configurable:!0},formatFallbackMessages:{configurable:!0},missing:{configurable:!0},formatter:{configurable:!0},silentTranslationWarn:{configurable:!0},silentFallbackWarn:{configurable:!0},preserveDirectiveContent:{configurable:!0},warnHtmlInMessage:{configurable:!0},postTranslation:{configurable:!0},sync:{configurable:!0}};Jc.prototype._checkLocaleMessage=function(t,e,n){var r=[],a=function(t,e,n,r){if($u(n))Object.keys(n).forEach((function(i){var o=n[i];$u(o)?(r.push(i),r.push("."),a(t,e,o,r),r.pop(),r.pop()):(r.push(i),a(t,e,o,r),r.pop())}));else if(Ru(n))n.forEach((function(n,i){$u(n)?(r.push("["+i+"]"),r.push("."),a(t,e,n,r),r.pop(),r.pop()):(r.push("["+i+"]"),a(t,e,n,r),r.pop())}));else if(Fu(n)){var i=Gc.test(n);if(i){var o="Detected HTML in message '"+n+"' of keypath '"+r.join("")+"' at '"+e+"'. Consider component interpolation with '<i18n>' to avoid XSS. See https://bit.ly/2ZqJzkp";"warn"===t?Eu(o):"error"===t&&Au(o)}}};a(e,t,n,r)},Jc.prototype._initVM=function(t){var e=sc.config.silent;sc.config.silent=!0,this._vm=new sc({data:t,__VUE18N__INSTANCE__:!0}),sc.config.silent=e},Jc.prototype.destroyVM=function(){this._vm.$destroy()},Jc.prototype.subscribeDataChanging=function(t){this._dataListeners.add(t)},Jc.prototype.unsubscribeDataChanging=function(t){Vu(this._dataListeners,t)},Jc.prototype.watchI18nData=function(){var t=this;return this._vm.$watch("$data",(function(){var e=Uu(t._dataListeners),n=e.length;while(n--)sc.nextTick((function(){e[n]&&e[n].$forceUpdate()}))}),{deep:!0})},Jc.prototype.watchLocale=function(t){if(t){if(!this.__VUE_I18N_BRIDGE__)return null;var e=this,n=this._vm;return this.vm.$watch("locale",(function(r){n.$set(n,"locale",r),e.__VUE_I18N_BRIDGE__&&t&&(t.locale.value=r),n.$forceUpdate()}),{immediate:!0})}if(!this._sync||!this._root)return null;var r=this._vm;return this._root.$i18n.vm.$watch("locale",(function(t){r.$set(r,"locale",t),r.$forceUpdate()}),{immediate:!0})},Jc.prototype.onComponentInstanceCreated=function(t){this._componentInstanceCreatedListener&&this._componentInstanceCreatedListener(t,this)},Zc.vm.get=function(){return this._vm},Zc.messages.get=function(){return Wu(this._getMessages())},Zc.dateTimeFormats.get=function(){return Wu(this._getDateTimeFormats())},Zc.numberFormats.get=function(){return Wu(this._getNumberFormats())},Zc.availableLocales.get=function(){return Object.keys(this.messages).sort()},Zc.locale.get=function(){return this._vm.locale},Zc.locale.set=function(t){this._vm.$set(this._vm,"locale",t)},Zc.fallbackLocale.get=function(){return this._vm.fallbackLocale},Zc.fallbackLocale.set=function(t){this._localeChainCache={},this._vm.$set(this._vm,"fallbackLocale",t)},Zc.formatFallbackMessages.get=function(){return this._formatFallbackMessages},Zc.formatFallbackMessages.set=function(t){this._formatFallbackMessages=t},Zc.missing.get=function(){return this._missing},Zc.missing.set=function(t){this._missing=t},Zc.formatter.get=function(){return this._formatter},Zc.formatter.set=function(t){this._formatter=t},Zc.silentTranslationWarn.get=function(){return this._silentTranslationWarn},Zc.silentTranslationWarn.set=function(t){this._silentTranslationWarn=t},Zc.silentFallbackWarn.get=function(){return this._silentFallbackWarn},Zc.silentFallbackWarn.set=function(t){this._silentFallbackWarn=t},Zc.preserveDirectiveContent.get=function(){return this._preserveDirectiveContent},Zc.preserveDirectiveContent.set=function(t){this._preserveDirectiveContent=t},Zc.warnHtmlInMessage.get=function(){return this._warnHtmlInMessage},Zc.warnHtmlInMessage.set=function(t){var e=this,n=this._warnHtmlInMessage;if(this._warnHtmlInMessage=t,n!==t&&("warn"===t||"error"===t)){var r=this._getMessages();Object.keys(r).forEach((function(t){e._checkLocaleMessage(t,e._warnHtmlInMessage,r[t])}))}},Zc.postTranslation.get=function(){return this._postTranslation},Zc.postTranslation.set=function(t){this._postTranslation=t},Zc.sync.get=function(){return this._sync},Zc.sync.set=function(t){this._sync=t},Jc.prototype._getMessages=function(){return this._vm.messages},Jc.prototype._getDateTimeFormats=function(){return this._vm.dateTimeFormats},Jc.prototype._getNumberFormats=function(){return this._vm.numberFormats},Jc.prototype._warnDefault=function(t,e,n,r,a,i){if(!Lu(n))return n;if(this._missing){var o=this._missing.apply(null,[t,e,r,a]);if(Fu(o))return o}else 0;if(this._formatFallbackMessages){var s=zu.apply(void 0,a);return this._render(e,i,s.params,e)}return e},Jc.prototype._isFallbackRoot=function(t){return(this._fallbackRootWithEmptyString?!t:Lu(t))&&!Lu(this._root)&&this._fallbackRoot},Jc.prototype._isSilentFallbackWarn=function(t){return this._silentFallbackWarn instanceof RegExp?this._silentFallbackWarn.test(t):this._silentFallbackWarn},Jc.prototype._isSilentFallback=function(t,e){return this._isSilentFallbackWarn(e)&&(this._isFallbackRoot()||t!==this.fallbackLocale)},Jc.prototype._isSilentTranslationWarn=function(t){return this._silentTranslationWarn instanceof RegExp?this._silentTranslationWarn.test(t):this._silentTranslationWarn},Jc.prototype._interpolate=function(t,e,n,r,a,i,o){if(!e)return null;var s,u=this._path.getPathValue(e,n);if(Ru(u)||$u(u))return u;if(Lu(u)){if(!$u(e))return null;if(s=e[n],!Fu(s)&&!Bu(s))return null}else{if(!Fu(u)&&!Bu(u))return null;s=u}return Fu(s)&&(s.indexOf("@:")>=0||s.indexOf("@.")>=0)&&(s=this._link(t,e,s,r,"raw",i,o)),this._render(s,a,i,n)},Jc.prototype._link=function(t,e,n,r,a,i,o){var s=n,u=s.match(Hc);for(var c in u)if(u.hasOwnProperty(c)){var l=u[c],d=l.match(qc),h=d[0],p=d[1],f=l.replace(h,"").replace(Kc,"");if(Gu(o,f))return s;o.push(f);var m=this._interpolate(t,e,f,r,"raw"===a?"string":a,"raw"===a?void 0:i,o);if(this._isFallbackRoot(m)){if(!this._root)throw Error("unexpected error");var g=this._root.$i18n;m=g._translate(g._getMessages(),g.locale,g.fallbackLocale,f,r,a,i)}m=this._warnDefault(t,f,m,r,Ru(i)?i:[i],a),this._modifiers.hasOwnProperty(p)?m=this._modifiers[p](m):Xc.hasOwnProperty(p)&&(m=Xc[p](m)),o.pop(),s=m?s.replace(l,m):s}return s},Jc.prototype._createMessageContext=function(t,e,n,r){var a=this,i=Ru(t)?t:[],o=ju(t)?t:{},s=function(t){return i[t]},u=function(t){return o[t]},c=this._getMessages(),l=this.locale;return{list:s,named:u,values:t,formatter:e,path:n,messages:c,locale:l,linked:function(t){return a._interpolate(l,c[l]||{},t,null,r,void 0,[t])}}},Jc.prototype._render=function(t,e,n,r){if(Bu(t))return t(this._createMessageContext(n,this._formatter||Yc,r,e));var a=this._formatter.interpolate(t,n,r);return a||(a=Yc.interpolate(t,n,r)),"string"!==e||Fu(a)?a:a.join("")},Jc.prototype._appendItemToChain=function(t,e,n){var r=!1;return Gu(t,e)||(r=!0,e&&(r="!"!==e[e.length-1],e=e.replace(/!/g,""),t.push(e),n&&n[e]&&(r=n[e]))),r},Jc.prototype._appendLocaleToChain=function(t,e,n){var r,a=e.split("-");do{var i=a.join("-");r=this._appendItemToChain(t,i,n),a.splice(-1,1)}while(a.length&&!0===r);return r},Jc.prototype._appendBlockToChain=function(t,e,n){for(var r=!0,a=0;a<e.length&&Du(r);a++){var i=e[a];Fu(i)&&(r=this._appendLocaleToChain(t,i,n))}return r},Jc.prototype._getLocaleChain=function(t,e){if(""===t)return[];this._localeChainCache||(this._localeChainCache={});var n=this._localeChainCache[t];if(!n){e||(e=this.fallbackLocale),n=[];var r,a=[t];while(Ru(a))a=this._appendBlockToChain(n,a,e);r=Ru(e)?e:ju(e)?e["default"]?e["default"]:null:e,a=Fu(r)?[r]:r,a&&this._appendBlockToChain(n,a,null),this._localeChainCache[t]=n}return n},Jc.prototype._translate=function(t,e,n,r,a,i,o){for(var s,u=this._getLocaleChain(e,n),c=0;c<u.length;c++){var l=u[c];if(s=this._interpolate(l,t[l],r,a,i,o,[r]),!Lu(s))return s}return null},Jc.prototype._t=function(t,e,n,r){var a,i=[],o=arguments.length-4;while(o-- >0)i[o]=arguments[o+4];if(!t)return"";var s=zu.apply(void 0,i);this._escapeParameterHtml&&(s.params=Ju(s.params));var u=s.locale||e,c=this._translate(n,u,this.fallbackLocale,t,r,"string",s.params);if(this._isFallbackRoot(c)){if(!this._root)throw Error("unexpected error");return(a=this._root).$t.apply(a,[t].concat(i))}return c=this._warnDefault(u,t,c,r,i,"string"),this._postTranslation&&null!==c&&void 0!==c&&(c=this._postTranslation(c,t)),c},Jc.prototype.t=function(t){var e,n=[],r=arguments.length-1;while(r-- >0)n[r]=arguments[r+1];return(e=this)._t.apply(e,[t,this.locale,this._getMessages(),null].concat(n))},Jc.prototype._i=function(t,e,n,r,a){var i=this._translate(n,e,this.fallbackLocale,t,r,"raw",a);if(this._isFallbackRoot(i)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.i(t,e,a)}return this._warnDefault(e,t,i,r,[a],"raw")},Jc.prototype.i=function(t,e,n){return t?(Fu(e)||(e=this.locale),this._i(t,e,this._getMessages(),null,n)):""},Jc.prototype._tc=function(t,e,n,r,a){var i,o=[],s=arguments.length-5;while(s-- >0)o[s]=arguments[s+5];if(!t)return"";void 0===a&&(a=1);var u={count:a,n:a},c=zu.apply(void 0,o);return c.params=Object.assign(u,c.params),o=null===c.locale?[c.params]:[c.locale,c.params],this.fetchChoice((i=this)._t.apply(i,[t,e,n,r].concat(o)),a)},Jc.prototype.fetchChoice=function(t,e){if(!t||!Fu(t))return null;var n=t.split("|");return e=this.getChoiceIndex(e,n.length),n[e]?n[e].trim():t},Jc.prototype.tc=function(t,e){var n,r=[],a=arguments.length-2;while(a-- >0)r[a]=arguments[a+2];return(n=this)._tc.apply(n,[t,this.locale,this._getMessages(),null,e].concat(r))},Jc.prototype._te=function(t,e,n){var r=[],a=arguments.length-3;while(a-- >0)r[a]=arguments[a+3];var i=zu.apply(void 0,r).locale||e;return this._exist(n[i],t)},Jc.prototype.te=function(t,e){return this._te(t,this.locale,this._getMessages(),e)},Jc.prototype.getLocaleMessage=function(t){return Wu(this._vm.messages[t]||{})},Jc.prototype.setLocaleMessage=function(t,e){"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||this._checkLocaleMessage(t,this._warnHtmlInMessage,e),this._vm.$set(this._vm.messages,t,e)},Jc.prototype.mergeLocaleMessage=function(t,e){"warn"!==this._warnHtmlInMessage&&"error"!==this._warnHtmlInMessage||this._checkLocaleMessage(t,this._warnHtmlInMessage,e),this._vm.$set(this._vm.messages,t,Ku("undefined"!==typeof this._vm.messages[t]&&Object.keys(this._vm.messages[t]).length?Object.assign({},this._vm.messages[t]):{},e))},Jc.prototype.getDateTimeFormat=function(t){return Wu(this._vm.dateTimeFormats[t]||{})},Jc.prototype.setDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,e),this._clearDateTimeFormat(t,e)},Jc.prototype.mergeDateTimeFormat=function(t,e){this._vm.$set(this._vm.dateTimeFormats,t,Ku(this._vm.dateTimeFormats[t]||{},e)),this._clearDateTimeFormat(t,e)},Jc.prototype._clearDateTimeFormat=function(t,e){for(var n in e){var r=t+"__"+n;this._dateTimeFormatters.hasOwnProperty(r)&&delete this._dateTimeFormatters[r]}},Jc.prototype._localizeDateTime=function(t,e,n,r,a,i){for(var o=e,s=r[o],u=this._getLocaleChain(e,n),c=0;c<u.length;c++){var l=u[c];if(s=r[l],o=l,!Lu(s)&&!Lu(s[a]))break}if(Lu(s)||Lu(s[a]))return null;var d,h=s[a];if(i)d=new Intl.DateTimeFormat(o,Object.assign({},h,i));else{var p=o+"__"+a;d=this._dateTimeFormatters[p],d||(d=this._dateTimeFormatters[p]=new Intl.DateTimeFormat(o,h))}return d.format(t)},Jc.prototype._d=function(t,e,n,r){if(!n){var a=r?new Intl.DateTimeFormat(e,r):new Intl.DateTimeFormat(e);return a.format(t)}var i=this._localizeDateTime(t,e,this.fallbackLocale,this._getDateTimeFormats(),n,r);if(this._isFallbackRoot(i)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.d(t,n,e)}return i||""},Jc.prototype.d=function(t){var e=[],n=arguments.length-1;while(n-- >0)e[n]=arguments[n+1];var r=this.locale,a=null,i=null;return 1===e.length?(Fu(e[0])?a=e[0]:ju(e[0])&&(e[0].locale&&(r=e[0].locale),e[0].key&&(a=e[0].key)),i=Object.keys(e[0]).reduce((function(t,n){var r;return Gu(Nu,n)?Object.assign({},t,(r={},r[n]=e[0][n],r)):t}),null)):2===e.length&&(Fu(e[0])&&(a=e[0]),Fu(e[1])&&(r=e[1])),this._d(t,r,a,i)},Jc.prototype.getNumberFormat=function(t){return Wu(this._vm.numberFormats[t]||{})},Jc.prototype.setNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,e),this._clearNumberFormat(t,e)},Jc.prototype.mergeNumberFormat=function(t,e){this._vm.$set(this._vm.numberFormats,t,Ku(this._vm.numberFormats[t]||{},e)),this._clearNumberFormat(t,e)},Jc.prototype._clearNumberFormat=function(t,e){for(var n in e){var r=t+"__"+n;this._numberFormatters.hasOwnProperty(r)&&delete this._numberFormatters[r]}},Jc.prototype._getNumberFormatter=function(t,e,n,r,a,i){for(var o=e,s=r[o],u=this._getLocaleChain(e,n),c=0;c<u.length;c++){var l=u[c];if(s=r[l],o=l,!Lu(s)&&!Lu(s[a]))break}if(Lu(s)||Lu(s[a]))return null;var d,h=s[a];if(i)d=new Intl.NumberFormat(o,Object.assign({},h,i));else{var p=o+"__"+a;d=this._numberFormatters[p],d||(d=this._numberFormatters[p]=new Intl.NumberFormat(o,h))}return d},Jc.prototype._n=function(t,e,n,r){if(!Jc.availabilities.numberFormat)return"";if(!n){var a=r?new Intl.NumberFormat(e,r):new Intl.NumberFormat(e);return a.format(t)}var i=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),n,r),o=i&&i.format(t);if(this._isFallbackRoot(o)){if(!this._root)throw Error("unexpected error");return this._root.$i18n.n(t,Object.assign({},{key:n,locale:e},r))}return o||""},Jc.prototype.n=function(t){var e=[],n=arguments.length-1;while(n-- >0)e[n]=arguments[n+1];var r=this.locale,a=null,i=null;return 1===e.length?Fu(e[0])?a=e[0]:ju(e[0])&&(e[0].locale&&(r=e[0].locale),e[0].key&&(a=e[0].key),i=Object.keys(e[0]).reduce((function(t,n){var r;return Gu(Iu,n)?Object.assign({},t,(r={},r[n]=e[0][n],r)):t}),null)):2===e.length&&(Fu(e[0])&&(a=e[0]),Fu(e[1])&&(r=e[1])),this._n(t,r,a,i)},Jc.prototype._ntp=function(t,e,n,r){if(!Jc.availabilities.numberFormat)return[];if(!n){var a=r?new Intl.NumberFormat(e,r):new Intl.NumberFormat(e);return a.formatToParts(t)}var i=this._getNumberFormatter(t,e,this.fallbackLocale,this._getNumberFormats(),n,r),o=i&&i.formatToParts(t);if(this._isFallbackRoot(o)){if(!this._root)throw Error("unexpected error");return this._root.$i18n._ntp(t,e,n,r)}return o||[]},Object.defineProperties(Jc.prototype,Zc),Object.defineProperty(Jc,"availabilities",{get:function(){if(!Uc){var t="undefined"!==typeof Intl;Uc={dateTimeFormat:t&&"undefined"!==typeof Intl.DateTimeFormat,numberFormat:t&&"undefined"!==typeof Intl.NumberFormat}}return Uc}}),Jc.install=bc,Jc.version="8.28.2";var Qc=Jc,tl=n("c2a1"),el=n("d266"),nl=n("9e07"),rl=function(t,e){Qc.install(t);const n=new Qc({locale:e.language||"en",fallbackLocale:"en",messages:a});t.prototype._i18n=n;const i=X();t.mixin({components:{...r},data(){return{magpie:null}},computed:{$magpie(){return this.magpie||this.$parent&&this.$parent.$magpie||i},$i18n(){return n}},magpie:e,mounted(){this.$options.socket&&this.$magpie.socket&&this.$magpie.socket.setUpSubscriptions(this.$options.socket,this)},beforeDestroy(){this.$options.socket&&this.$magpie.socket&&this.$magpie.socket.tearDownSubscriptions(this.$options.socket)}})}},3698:function(t,e){function n(t,e){return null==t?void 0:t[e]}t.exports=n},"36da":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=n("d777"),a=n("9cb8"),i=n("4971"),o=n("ea61"),s=n("eba4"),u=n("0ff5"),c=n("2fb2"),l=n("f35c"),d=n("df93"),h=n("fce6"),p=n("ed3d"),f=n("06f8"),m=n("c527"),g=n("f655");e.Konva=a.Util._assign(r.Konva,{Collection:a.Collection,Util:a.Util,Transform:a.Transform,Node:i.Node,ids:i.ids,names:i.names,Container:o.Container,Stage:s.Stage,stages:s.stages,Layer:u.Layer,FastLayer:c.FastLayer,Group:l.Group,DD:d.DD,Shape:h.Shape,shapes:h.shapes,Animation:p.Animation,Tween:f.Tween,Easings:f.Easings,Context:m.Context,Canvas:g.Canvas})},3729:function(t,e,n){var r=n("9e69"),a=n("00fd"),i=n("29f3"),o="[object Null]",s="[object Undefined]",u=r?r.toStringTag:void 0;function c(t){return null==t?void 0===t?s:o:u&&u in Object(t)?a(t):i(t)}t.exports=c},"381a":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("4ffe"),a=n("df00"),i=n("e136");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n){if(Object(a["d"])(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const o=Object(r["c"])(t,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(i["a"])(t,e,o,n)}},"382f":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>Math.min(t,e)),s=Object(i["a"])(r["Minimum"],o),u={kernelName:r["Minimum"],backendName:"cpu",kernelFunc:s}},"383f":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Ellipse=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.radiusX(),n=this.radiusY();t.beginPath(),t.save(),e!==n&&t.scale(1,n/e),t.arc(0,0,e,0,2*Math.PI,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radiusX()},e.prototype.getHeight=function(){return 2*this.radiusY()},e.prototype.setWidth=function(t){this.radiusX(t/2)},e.prototype.setHeight=function(t){this.radiusY(t/2)},e}(o.Shape);e.Ellipse=c,c.prototype.className="Ellipse",c.prototype._centroid=!0,c.prototype._attrsAffectingSize=["radiusX","radiusY"],u._registerNode(c),i.Factory.addComponentsGetterSetter(c,"radius",["x","y"]),i.Factory.addGetterSetter(c,"radiusX",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"radiusY",0,s.getNumberValidator()),a.Collection.mapMethods(c)},"388c":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"i",(function(){return d})),n.d(e,"j",(function(){return h})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return f})),n.d(e,"n",(function(){return m})),n.d(e,"m",(function(){return g})),n.d(e,"o",(function(){return b})),n.d(e,"r",(function(){return y})),n.d(e,"p",(function(){return v})),n.d(e,"q",(function(){return x})),n.d(e,"s",(function(){return w})),n.d(e,"t",(function(){return k})),n.d(e,"u",(function(){return S})),n.d(e,"w",(function(){return O})),n.d(e,"v",(function(){return _})),n.d(e,"x",(function(){return C})),n.d(e,"y",(function(){return T})),n.d(e,"z",(function(){return I})),n.d(e,"A",(function(){return N})),n.d(e,"B",(function(){return E})),n.d(e,"C",(function(){return A})),n.d(e,"D",(function(){return R})),n.d(e,"E",(function(){return j})),n.d(e,"F",(function(){return D})),n.d(e,"G",(function(){return F})),n.d(e,"H",(function(){return M})),n.d(e,"I",(function(){return P})),n.d(e,"J",(function(){return $})),n.d(e,"K",(function(){return L})),n.d(e,"M",(function(){return B})),n.d(e,"N",(function(){return z})),n.d(e,"L",(function(){return W})),n.d(e,"O",(function(){return V})),n.d(e,"P",(function(){return U})),n.d(e,"Q",(function(){return G})),n.d(e,"R",(function(){return H})),n.d(e,"S",(function(){return q})),n.d(e,"T",(function(){return K})),n.d(e,"U",(function(){return X})),n.d(e,"W",(function(){return Y})),n.d(e,"V",(function(){return J})),n.d(e,"rc",(function(){return Z})),n.d(e,"X",(function(){return Q})),n.d(e,"Y",(function(){return tt})),n.d(e,"Z",(function(){return et})),n.d(e,"bb",(function(){return nt})),n.d(e,"ab",(function(){return rt})),n.d(e,"cb",(function(){return at})),n.d(e,"db",(function(){return it})),n.d(e,"eb",(function(){return ot})),n.d(e,"fb",(function(){return st})),n.d(e,"gb",(function(){return ut})),n.d(e,"hb",(function(){return ct})),n.d(e,"ib",(function(){return lt})),n.d(e,"jb",(function(){return dt})),n.d(e,"lb",(function(){return ht})),n.d(e,"pb",(function(){return pt})),n.d(e,"ob",(function(){return ft})),n.d(e,"qb",(function(){return mt})),n.d(e,"rb",(function(){return gt})),n.d(e,"tb",(function(){return bt})),n.d(e,"sb",(function(){return yt})),n.d(e,"ub",(function(){return vt})),n.d(e,"vb",(function(){return xt})),n.d(e,"wb",(function(){return wt})),n.d(e,"xb",(function(){return kt})),n.d(e,"Ab",(function(){return St})),n.d(e,"Bb",(function(){return Ot})),n.d(e,"Cb",(function(){return _t})),n.d(e,"Db",(function(){return Ct})),n.d(e,"Eb",(function(){return Tt})),n.d(e,"Fb",(function(){return It})),n.d(e,"Hb",(function(){return Nt})),n.d(e,"Ib",(function(){return Et})),n.d(e,"Jb",(function(){return At})),n.d(e,"Kb",(function(){return Rt})),n.d(e,"Gb",(function(){return jt})),n.d(e,"Lb",(function(){return Dt})),n.d(e,"yb",(function(){return Ft})),n.d(e,"zb",(function(){return Mt})),n.d(e,"Mb",(function(){return Pt})),n.d(e,"Sb",(function(){return $t})),n.d(e,"Nb",(function(){return Lt})),n.d(e,"Qb",(function(){return Bt})),n.d(e,"Ob",(function(){return zt})),n.d(e,"Pb",(function(){return Wt})),n.d(e,"Rb",(function(){return Vt})),n.d(e,"Tb",(function(){return Ut})),n.d(e,"Ub",(function(){return Gt})),n.d(e,"Vb",(function(){return Ht})),n.d(e,"Wb",(function(){return qt})),n.d(e,"Xb",(function(){return Kt})),n.d(e,"Yb",(function(){return Xt})),n.d(e,"Zb",(function(){return Yt})),n.d(e,"ac",(function(){return Jt})),n.d(e,"ec",(function(){return Zt})),n.d(e,"bc",(function(){return Qt})),n.d(e,"cc",(function(){return te})),n.d(e,"dc",(function(){return ee})),n.d(e,"gc",(function(){return ne})),n.d(e,"fc",(function(){return re})),n.d(e,"hc",(function(){return ae})),n.d(e,"ic",(function(){return ie})),n.d(e,"jc",(function(){return oe})),n.d(e,"kc",(function(){return se})),n.d(e,"lc",(function(){return ue})),n.d(e,"mc",(function(){return ce})),n.d(e,"nc",(function(){return le})),n.d(e,"oc",(function(){return de})),n.d(e,"pc",(function(){return he})),n.d(e,"qc",(function(){return pe})),n.d(e,"sc",(function(){return fe})),n.d(e,"tc",(function(){return me})),n.d(e,"vc",(function(){return ge})),n.d(e,"yc",(function(){return be})),n.d(e,"zc",(function(){return ye})),n.d(e,"wc",(function(){return ve})),n.d(e,"xc",(function(){return xe})),n.d(e,"uc",(function(){return we})),n.d(e,"Ac",(function(){return ke})),n.d(e,"Cc",(function(){return Se})),n.d(e,"Dc",(function(){return Oe})),n.d(e,"Ec",(function(){return _e})),n.d(e,"Fc",(function(){return Ce})),n.d(e,"Gc",(function(){return Te})),n.d(e,"Hc",(function(){return Ie})),n.d(e,"Mc",(function(){return Ne})),n.d(e,"Kc",(function(){return Ee})),n.d(e,"Lc",(function(){return Ae})),n.d(e,"Jc",(function(){return Re})),n.d(e,"Ic",(function(){return je})),n.d(e,"Oc",(function(){return De})),n.d(e,"Wc",(function(){return Fe})),n.d(e,"fd",(function(){return Me})),n.d(e,"Pc",(function(){return Pe})),n.d(e,"Vc",(function(){return $e})),n.d(e,"Nc",(function(){return Le})),n.d(e,"Qc",(function(){return Be})),n.d(e,"Rc",(function(){return ze})),n.d(e,"Sc",(function(){return We})),n.d(e,"Tc",(function(){return Ve})),n.d(e,"Uc",(function(){return Ue})),n.d(e,"Yc",(function(){return Ge})),n.d(e,"Xc",(function(){return He})),n.d(e,"ad",(function(){return qe})),n.d(e,"bd",(function(){return Ke})),n.d(e,"cd",(function(){return Xe})),n.d(e,"dd",(function(){return Ye})),n.d(e,"ed",(function(){return Je})),n.d(e,"gd",(function(){return Ze})),n.d(e,"hd",(function(){return Qe})),n.d(e,"id",(function(){return tn})),n.d(e,"jd",(function(){return en})),n.d(e,"kd",(function(){return nn})),n.d(e,"ld",(function(){return rn})),n.d(e,"md",(function(){return an})),n.d(e,"nd",(function(){return on})),n.d(e,"od",(function(){return sn})),n.d(e,"pd",(function(){return un})),n.d(e,"qd",(function(){return cn})),n.d(e,"Zc",(function(){return ln})),n.d(e,"kb",(function(){return dn})),n.d(e,"Bc",(function(){return hn})),n.d(e,"rd",(function(){return pn})),n.d(e,"mb",(function(){return fn})),n.d(e,"nb",(function(){return mn}));const r="Abs",a="Acos",i="Acosh",o="Add",s="AddN",u="All",c="Any",l="ArgMax",d="ArgMin",h="Asin",p="Asinh",f="Atan",m="Atanh",g="Atan2",b="AvgPool",y="AvgPoolGrad",v="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",k="BatchToSpaceND",S="Bincount",O="BroadcastTo",_="BroadcastArgs",C="Cast",T="Ceil",I="ClipByValue",N="Complex",E="ComplexAbs",A="Concat",R="Conv2D",j="Conv2DBackpropFilter",D="Conv2DBackpropInput",F="Conv3D",M="Conv3DBackpropFilterV2",P="Conv3DBackpropInputV2",$="Cos",L="Cosh",B="Cumprod",z="Cumsum",W="CropAndResize",V="DenseBincount",U="DepthToSpace",G="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",q="DepthwiseConv2dNativeBackpropInput",K="Diag",X="Dilation2D",Y="Dilation2DBackpropInput",J="Dilation2DBackpropFilter",Z="RealDiv",Q="Einsum",tt="Elu",et="EluGrad",nt="Erf",rt="Equal",at="Exp",it="ExpandDims",ot="Expm1",st="FFT",ut="Fill",ct="FlipLeftRight",lt="Floor",dt="FloorDiv",ht="FusedBatchNorm",pt="GatherV2",ft="GatherNd",mt="Greater",gt="GreaterEqual",bt="Identity",yt="IFFT",vt="Imag",xt="IsFinite",wt="IsInf",kt="IsNan",St="LeakyRelu",Ot="Less",_t="LessEqual",Ct="LinSpace",Tt="Log",It="Log1p",Nt="LogicalAnd",Et="LogicalNot",At="LogicalOr",Rt="LogicalXor",jt="LogSoftmax",Dt="LowerBound",Ft="LRN",Mt="LRNGrad",Pt="Max",$t="Maximum",Lt="MaxPool",Bt="MaxPoolGrad",zt="MaxPool3D",Wt="MaxPool3DGrad",Vt="MaxPoolWithArgmax",Ut="Mean",Gt="Min",Ht="Minimum",qt="MirrorPad",Kt="Mod",Xt="Multinomial",Yt="Multiply",Jt="Neg",Zt="NotEqual",Qt="NonMaxSuppressionV3",te="NonMaxSuppressionV4",ee="NonMaxSuppressionV5",ne="OnesLike",re="OneHot",ae="Pack",ie="PadV2",oe="Pool",se="Pow",ue="Prelu",ce="Prod",le="RaggedGather",de="RaggedTensorToTensor",he="Range",pe="Real",fe="Reciprocal",me="Relu",ge="Reshape",be="ResizeNearestNeighbor",ye="ResizeNearestNeighborGrad",ve="ResizeBilinear",xe="ResizeBilinearGrad",we="Relu6",ke="Reverse",Se="Round",Oe="Rsqrt",_e="ScatterNd",Ce="SearchSorted",Te="Select",Ie="Selu",Ne="Slice",Ee="Sin",Ae="Sinh",Re="Sign",je="Sigmoid",De="Softplus",Fe="Sqrt",Me="Sum",Pe="SpaceToBatchND",$e="SplitV",Le="Softmax",Be="SparseFillEmptyRows",ze="SparseReshape",We="SparseSegmentMean",Ve="SparseSegmentSum",Ue="SparseToDense",Ge="SquaredDifference",He="Square",qe="StridedSlice",Ke="StringNGrams",Xe="StringSplit",Ye="StringToHashBucketFast",Je="Sub",Ze="Tan",Qe="Tanh",tn="Tile",en="TopK",nn="Transform",rn="Transpose",an="Unique",on="Unpack",sn="UnsortedSegmentSum",un="UpperBound",cn="ZerosLike",ln="Step",dn="FromPixels",hn="RotateWithOffset",pn="_FusedMatMul",fn="FusedConv2D",mn="FusedDepthwiseConv2D"},"38e4":function(t,e){},"393f":function(t,e,n){"use strict";(function(t,r,a){function i(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(e,"__esModule",{value:!0});var o=n("2ca8"),s=n("da5a"),u=i(s),c=n("42e8"),l=n("e929"),d=n("6645"),h=n("1001"),p=n("0e1b");const f="Abs",m="Acos",g="Acosh",b="Add",y="AddN",v="All",x="Any",w="ArgMax",k="ArgMin",S="Asin",O="Asinh",_="Atan",C="Atanh",T="Atan2",I="AvgPool",N="AvgPoolGrad",E="AvgPool3D",A="AvgPool3DGrad",R="BatchMatMul",j="BatchToSpaceND",D="Bincount",F="BroadcastTo",M="BroadcastArgs",P="Cast",$="Ceil",L="ClipByValue",B="Complex",z="ComplexAbs",W="Concat",V="Conv2D",U="Conv2DBackpropFilter",G="Conv2DBackpropInput",H="Conv3D",q="Conv3DBackpropFilterV2",K="Conv3DBackpropInputV2",X="Cos",Y="Cosh",J="Cumprod",Z="Cumsum",Q="CropAndResize",tt="DenseBincount",et="DepthToSpace",nt="DepthwiseConv2dNative",rt="DepthwiseConv2dNativeBackpropFilter",at="DepthwiseConv2dNativeBackpropInput",it="Diag",ot="Dilation2D",st="Dilation2DBackpropInput",ut="Dilation2DBackpropFilter",ct="RealDiv",lt="Einsum",dt="Elu",ht="EluGrad",pt="Erf",ft="Equal",mt="Exp",gt="ExpandDims",bt="Expm1",yt="FFT",vt="Fill",xt="FlipLeftRight",wt="Floor",kt="FloorDiv",St="FusedBatchNorm",Ot="GatherV2",_t="GatherNd",Ct="Greater",Tt="GreaterEqual",It="Identity",Nt="IFFT",Et="Imag",At="IsFinite",Rt="IsInf",jt="IsNan",Dt="LeakyRelu",Ft="Less",Mt="LessEqual",Pt="Log",$t="Log1p",Lt="LogicalAnd",Bt="LogicalNot",zt="LogicalOr",Wt="LogSoftmax",Vt="LRN",Ut="LRNGrad",Gt="Max",Ht="Maximum",qt="MaxPool",Kt="MaxPoolGrad",Xt="MaxPool3D",Yt="MaxPool3DGrad",Jt="MaxPoolWithArgmax",Zt="Mean",Qt="Min",te="Minimum",ee="MirrorPad",ne="Mod",re="Multinomial",ae="Multiply",ie="Neg",oe="NotEqual",se="NonMaxSuppressionV3",ue="NonMaxSuppressionV4",ce="NonMaxSuppressionV5",le="OnesLike",de="OneHot",he="Pack",pe="PadV2",fe="Pow",me="Prelu",ge="Prod",be="RaggedGather",ye="RaggedTensorToTensor",ve="Range",xe="Real",we="Reciprocal",ke="Relu",Se="Reshape",Oe="ResizeNearestNeighbor",_e="ResizeNearestNeighborGrad",Ce="ResizeBilinear",Te="ResizeBilinearGrad",Ie="Relu6",Ne="Reverse",Ee="Round",Ae="Rsqrt",Re="ScatterNd",je="SearchSorted",De="Select",Fe="Selu",Me="Slice",Pe="Sin",$e="Sinh",Le="Sign",Be="Sigmoid",ze="Softplus",We="Sqrt",Ve="Sum",Ue="SpaceToBatchND",Ge="SplitV",He="Softmax",qe="SparseFillEmptyRows",Ke="SparseReshape",Xe="SparseSegmentMean",Ye="SparseSegmentSum",Je="SparseToDense",Ze="SquaredDifference",Qe="Square",tn="StridedSlice",en="StringNGrams",nn="StringSplit",rn="StringToHashBucketFast",an="Sub",on="Tan",sn="Tanh",un="Tile",cn="TopK",ln="Transform",dn="Transpose",hn="Unique",pn="Unpack",fn="UnsortedSegmentSum",mn="ZerosLike",gn="Step",bn="FromPixels",yn="RotateWithOffset",vn="_FusedMatMul",xn="FusedConv2D",wn="FusedDepthwiseConv2D",kn=1e-7,Sn=1e-4;class On{refCount(t){return _n("refCount")}incRef(t){return _n("incRef")}timerAvailable(){return!0}time(t){return _n("time")}read(t){return _n("read")}readSync(t){return _n("readSync")}readToGPU(t,e){return _n("readToGPU")}numDataIds(){return _n("numDataIds")}disposeData(t,e){return _n("disposeData")}write(t,e,n){return _n("write")}move(t,e,n,r,a){return _n("move")}memory(){return _n("memory")}floatPrecision(){return _n("floatPrecision")}epsilon(){return 32===this.floatPrecision()?kn:Sn}dispose(){return _n("dispose")}}function _n(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cn(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function Tn(t,e,n=""){Cn(An(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function In(t){Cn(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function Nn(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||Ln(t)&&!n)for(let r=0;r<t.length;++r)Nn(t[r],e,n);else e.push(t);return e}function En(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function An(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Rn(t){return t%1===0}function jn(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function Dn(t,e){const n=e.length;return t=null==t?e.map((t,e)=>e):[].concat(t),Cn(t.every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis `+t),Cn(t.every(t=>Rn(t)),()=>"All values in axis param must be integers but got axis "+t),t.map(t=>t<0?n+t:t)}function Fn(t,e){const n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:Dn(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error(`Can't squeeze axis ${s} since its dim '${t[s]}' is not 1`);(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function Mn(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function Pn(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function $n(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function Ln(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Bn(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function zn(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function Wn(t){return"string"===typeof t||t instanceof String}function Vn(t){return"boolean"===typeof t}function Un(t){return"number"===typeof t}function Gn(t){return Array.isArray(t)?Gn(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Un(t)?"float32":Wn(t)?"string":Vn(t)?"bool":"float32"}function Hn(t){return!!(t&&t.constructor&&t.call&&t.apply)}function qn(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function Kn(t,e,n,r=!1){const a=new Array;if(1===e.length){const i=e[0]*(r?2:1);for(let e=0;e<i;e++)a[e]=n[t+e]}else{const i=e[0],o=e.slice(1),s=o.reduce((t,e)=>t*e)*(r?2:1);for(let e=0;e<i;e++)a[e]=Kn(t+e*s,o,n,r)}return a}function Xn(t,e,n=!1){if(0===t.length)return e[0];const r=t.reduce((t,e)=>t*e)*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return Kn(0,t,e,n)}function Yn(t,e){const n=Jn(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Jn(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function Zn(t){t.forEach(e=>{Cn(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Qn(t){return t&&t.then&&"function"===typeof t.then}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tr="tfjsflags";class er{constructor(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=nr,this.populateURLFlags()}setPlatform(t,e){null!=this.platform&&(ir().getBool("IS_TEST")||ir().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${t}.`)),this.platformName=t,this.platform=e}registerFlag(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){const e=this.urlFlags[t];ir().getBool("IS_TEST")||ir().getBool("PROD")||console.warn(`Setting feature override from URL ${t}: ${e}.`),this.set(t,e)}}async getAsync(t){return t in this.flags||(this.flags[t]=await this.evaluateFlag(t)),this.flags[t]}get(t){if(t in this.flags)return this.flags[t];const e=this.evaluateFlag(t);if(Qn(e))throw new Error(`Flag ${t} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[t]=e,this.flags[t]}getNumber(t){return this.get(t)}getBool(t){return this.get(t)}getFlags(){return this.flags}get features(){return this.flags}set(t,e){if(null==this.flagRegistry[t])throw new Error(`Cannot set flag ${t} as it has not been registered.`);this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)}evaluateFlag(t){if(null==this.flagRegistry[t])throw new Error(`Cannot evaluate flag '${t}': no evaluation function found.`);return this.flagRegistry[t].evaluationFn()}setFlags(t){this.flags=Object.assign({},t)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if("undefined"===typeof this.global||"undefined"===typeof this.global.location||"undefined"===typeof this.global.location.search)return;const t=this.getQueryParams(this.global.location.search);if(tr in t){const e=t[tr].split(",");e.forEach(t=>{const[e,n]=t.split(":");this.urlFlags[e]=ar(e,n)})}}}function nr(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...n)=>(rr(e,n[0],n[1]),n.join("="))),e}function rr(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function ar(t,e){if(e=e.toLowerCase(),"true"===e||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function ir(){return sr}let or,sr=null;function ur(t){sr=t}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(){if(null==or){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof t)e=t;else if("undefined"!==typeof r)e=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}or=e}return or}function lr(){const t=cr();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}function dr(t,e){const n=lr();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(...t){ir().getBool("IS_TEST")||ir().getBool("PROD")||console.warn(...t)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const pr=dr("kernelRegistry",()=>new Map),fr=dr("gradRegistry",()=>new Map);function mr(t,e){const n=vr(t,e);return pr.get(n)}function gr(t){return fr.get(t)}function br(t){const e=pr.entries(),n=[];while(1){const{done:r,value:a}=e.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===t&&n.push(o)}return n}function yr(t){const{kernelName:e}=t;fr.has(e)&&ir().getBool("DEBUG")&&hr(`Overriding the gradient for '${e}'`),fr.set(e,t)}function vr(t,e){return`${e}_${t}`}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xr=u||s;function wr(t){return xr.fromString(t,!0,16)}wr("c3a5c85c97cb3127"),wr("b492b66fbe98f273"),wr("9ae16a3b2f90404f");function kr(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}function Sr(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Nn(t)),ir().getBool("DEBUG")&&Pn(t,e),kr(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function Or(){return ir().platform.now()}function _r(t,e="utf-8"){return e=e||"utf-8",ir().platform.encode(t,e)}function Cr(t,e="utf-8"){return e=e||"utf-8",ir().platform.decode(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tr{constructor(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new Nr)}profileKernel(t,e,n){let r;const a=()=>{r=n()};let i;const o=Or();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const t of r)t.dataSync();i=Promise.resolve({kernelMs:Or()-o})}if(ir().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const e=r[u];e.data().then(n=>{Ir(n,e.dtype,t)})}const s={kernelName:t,outputs:r,inputs:e,timeMs:i.then(t=>t.kernelMs),extraInfo:i.then(t=>null!=t.getExtraProfileInfo?t.getExtraProfileInfo():"")};return s}logKernelProfile(t){const{kernelName:e,outputs:n,timeMs:r,inputs:a,extraInfo:i}=t;n.forEach(t=>{Promise.all([t.data(),r,i]).then(n=>{this.logger.logKernelProfile(e,t,n[0],n[1],a,n[2])})})}}function Ir(t,e,n){if("float32"!==e)return!1;for(let r=0;r<t.length;r++){const e=t[r];if(isNaN(e)||!isFinite(e))return console.warn(`Found ${e} in the result of '${n}'`),!0}return!1}class Nr{logKernelProfile(t,e,n,r,a,i){const o="number"===typeof r?jn(r+"ms",9):r["error"],s=jn(t,25),u=e.rank,c=e.size,l=jn(e.shape.toString(),14);let d="";for(const h in a){const t=a[h];if(null!=t){const n=t.shape||e.shape,r=n.length;d+=`${h}: ${r}D ${r>0?n:""} `}}console.log(`%c${s}\t%c${o}\t%c${u}D ${l}\t%c${c}\t%c${d}\t%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Er(t,e,n){const r={},a={};for(let u=0;u<e.length;u++)r[e[u].id]=!0;for(let u=0;u<t.length;u++){const n=t[u],i=n.inputs;for(const t in i){const o=i[t];let s=!1;for(let t=0;t<e.length;t++)if(r[o.id]){n.outputs.forEach(t=>r[t.id]=!0),s=!0,a[n.id]=!0;break}if(s)break}}const i={};i[n.id]=!0;const o={};for(let u=t.length-1;u>=0;u--){const e=t[u],n=e.inputs;for(let t=0;t<e.outputs.length;t++)if(i[e.outputs[t].id]){for(const t in n)i[n[t].id]=!0,o[e.id]=!0;break}}const s=[];for(let u=0;u<t.length;u++){const e=t[u];if(a[e.id]&&o[e.id]){const t={};for(const a in e.inputs){const n=e.inputs[a];r[n.id]&&(t[a]=n)}const n=Object.assign({},e);n.inputs=t,n.outputs=e.outputs,s.push(n)}}return s}function Ar(t,e,n,r){for(let a=e.length-1;a>=0;a--){const i=e[a],o=[];if(i.outputs.forEach(e=>{const n=t[e.id];null!=n?o.push(n):o.push(null)}),null==i.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const s=i.gradient(o);for(const e in i.inputs){if(!(e in s))throw new Error(`Cannot backprop through input ${e}. Available gradients found: ${Object.keys(s)}.`);const a=n(()=>s[e]());if("float32"!==a.dtype)throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${e} must have 'float32' dtype, but has '${a.dtype}'`);const o=i.inputs[e];if(!An(a.shape,o.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${e}' has shape '${a.shape}', which does not match the shape of the input '${o.shape}'`);if(null==t[o.id])t[o.id]=a;else{const e=t[o.id];t[o.id]=r(e,a),e.dispose()}}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rr=20,jr=3,Dr=7;function Fr(t,e,n,r){const a=qn(e),i=Mr(t,e,n,a),o=e.length,s=Lr(t,e,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(s.map(t=>"    "+t).join("\n")),u.join("\n")}function Mr(t,e,n,r){const a=En(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,u="complex64"===n?Br(t):t;if(s>1)for(let c=0;c<a/i;c++){const t=c*i;for(let e=0;e<i;e++)o[e]=Math.max(o[e],Pr(u[t+e],0,n).length)}return o}function Pr(t,e,n){let r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(Dr))+" + "+parseFloat(t[1].toFixed(Dr))+"j":Wn(t)?`'${t}'`:"bool"===n?$r(t):parseFloat(t.toFixed(Dr)).toString(),jn(r,e)}function $r(t){return 0===t?"false":"true"}function Lr(t,e,n,r,a,i=!0){const o="complex64"===n?2:1,s=e[0],u=e.length;if(0===u){if("complex64"===n){const e=Br(t);return[Pr(e[0],0,n)]}return"bool"===n?[$r(t[0])]:[t[0].toString()]}if(1===u){if(s>Rr){const e=jr*o;let r=Array.from(t.slice(0,e)),i=Array.from(t.slice((s-jr)*o,s*o));return"complex64"===n&&(r=Br(r),i=Br(i)),["["+r.map((t,e)=>Pr(t,a[e],n)).join(", ")+", ..., "+i.map((t,e)=>Pr(t,a[s-jr+e],n)).join(", ")+"]"]}const e="complex64"===n?Br(t):Array.from(t);return["["+e.map((t,e)=>Pr(t,a[e],n)).join(", ")+"]"]}const c=e.slice(1),l=r.slice(1),d=r[0]*o,h=[];if(s>Rr){for(let e=0;e<jr;e++){const r=e*d,i=r+d;h.push(...Lr(t.slice(r,i),c,n,l,a,!1))}h.push("...");for(let e=s-jr;e<s;e++){const r=e*d,i=r+d;h.push(...Lr(t.slice(r,i),c,n,l,a,e===s-1))}}else for(let m=0;m<s;m++){const e=m*d,r=e+d;h.push(...Lr(t.slice(e,r),c,n,l,a,m===s-1))}const p=2===u?",":"";h[0]="["+h[0]+p;for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+p;let f=",\n";for(let m=2;m<u;m++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(i?"":f),h}function Br(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zr{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=En(t),null!=n){const t=n.length;Cn(t===this.size,()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||Mn(e,this.size),this.strides=qn(t)}set(t,...e){0===e.length&&(e=[0]),Cn(e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const e=`Requested out of range element at ${t}.   Buffer shape=`+this.shape;throw new Error(e)}e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return Wr().makeTensor(this.values,this.shape,this.dtype)}}let Wr=null,Vr=null,Ur=null;function Gr(t){Wr=t}function Hr(t){Ur=t}class qr{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=En(t),this.strides=qn(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return Vr.buffer(this.shape,this.dtype,t)}bufferSync(){return Vr.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Xn(this.shape,t,"complex64"===this.dtype)}arraySync(){return Xn(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=Wr().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map(t=>Cr(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),Wr().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=Wr().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>Cr(t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await Wr().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(Wr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return Vr.print(this,t)}clone(){return this.throwIfDisposed(),Vr.clone(this)}toString(t=!1){const e=this.dataSync();return Fr(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),Vr.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),Wr().makeVariable(this,t,e,n)}}function Kr(){return dr("Tensor",()=>qr)}Object.defineProperty(qr,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),Kr();class Xr extends qr{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!An(t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);Wr().disposeTensor(this),this.dataId=t.dataId,Wr().incRef(this,null)}dispose(){Wr().disposeVariable(this),this.isDisposedInternal=!0}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var Yr,Jr,Zr,Qr,ta;Object.defineProperty(Xr,Symbol.hasInstance,{value:t=>t instanceof qr&&null!=t.assign&&t.assign instanceof Function}),function(t){t["R0"]="R0",t["R1"]="R1",t["R2"]="R2",t["R3"]="R3",t["R4"]="R4",t["R5"]="R5",t["R6"]="R6"}(Yr||(Yr={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="int32",t["complex64"]="complex64"}(Jr||(Jr={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="bool",t["complex64"]="complex64"}(Zr||(Zr={})),function(t){t["float32"]="float32",t["int32"]="float32",t["bool"]="float32",t["complex64"]="complex64"}(Qr||(Qr={})),function(t){t["float32"]="complex64",t["int32"]="complex64",t["bool"]="complex64",t["complex64"]="complex64"}(ta||(ta={}));const ea={float32:Qr,int32:Jr,bool:Zr,complex64:ta};function na(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return ea[t][e]}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ra(t,e){if(t.dtype===e.dtype)return[t,e];const n=na(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function aa(t,e){Cn(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function ia(t){const e=[],n=new Set;return oa(t,e,n),e}function oa(t,e,n){if(null==t)return;if(t instanceof qr)return void e.push(t);if(!sa(t))return;const r=t;for(const a in r){const t=r[a];n.has(t)||(n.add(t),oa(t,e,n))}}function sa(t){return Array.isArray(t)||"object"===typeof t}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ua(t){return null!=t.kernelName}class ca{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(t=>t.name)))}}}dispose(){for(const t in this.registeredVariables)this.registeredVariables[t].dispose()}}class la{constructor(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ca}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then(()=>{});if(null!=this.backendInstance)return;const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],r=await this.initializeBackend(n).success;if(r)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:t,asyncInit:e}=this.initializeBackendsAndReturnBest();if(e)throw new Error(`The highest priority backend '${t}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(t)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;{const{asyncInit:e}=this.initializeBackend(t);if(e)return null}}return this.registry[t]}findBackendFactory(t){return t in this.registryFactory?this.registryFactory[t].factory:null}registerBackend(t,e,n=1){return t in this.registryFactory?(hr(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)}async setBackend(t){if(null==this.registryFactory[t])throw new Error(`Backend name '${t}' not found in registry`);if(this.backendName=t,null==this.registry[t]){this.backendInstance=null;const{success:e,asyncInit:n}=this.initializeBackend(t),r=n?await e:e;if(!r)return!1}return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new Tr(this.backendInstance),!0}setupRegisteredKernels(){const t=br(this.backendName);t.forEach(t=>{null!=t.setupFunc&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(t){const e=br(t);e.forEach(e=>{null!=e.disposeFunc&&e.disposeFunc(this.registry[t])})}initializeBackend(t){const e=this.registryFactory[t];if(null==e)throw new Error(`Cannot initialize backend ${t}, no registration found.`);try{const n=e.factory();if(!n||n instanceof On||"function"!==typeof n.then)return this.registry[t]=n,{success:!0,asyncInit:!1};{const e=++this.pendingBackendInitId,r=n.then(n=>!(e<this.pendingBackendInitId)&&(this.registry[t]=n,this.pendingBackendInit=null,!0)).catch(n=>(e<this.pendingBackendInitId||(this.pendingBackendInit=null,hr(`Initialization of backend ${t} failed`),hr(n.stack||n.message)),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(n){return hr(`Initialization of backend ${t} failed`),hr(n.stack||n.message),{success:!1,asyncInit:!1}}}removeBackend(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((t,e)=>this.registryFactory[e].priority-this.registryFactory[t].priority)}initializeBackendsAndReturnBest(){const t=this.getSortedBackends();for(let e=0;e<t.length;e++){const n=t[e],{success:r,asyncInit:a}=this.initializeBackend(n);if(a||r)return{name:n,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(t,e){const n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e),i=r.refCount(e);r.disposeData(e,!0),n.backend=t,t.move(e,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(t,e){let n,r=null;if(null==e){if("function"!==typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!==typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=t}return this.scopedRun(()=>this.startScope(r),()=>this.endScope(n),()=>(n=e(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n))}scopedRun(t,e,n){t();try{const t=n();return e(),t}catch(r){throw e(),r}}nextTensorId(){return la.nextTensorId++}nextVariableId(){return la.nextVariableId++}clone(t){const e=pa.runKernel(It,{x:t}),n={x:t},r=t=>({x:()=>{const e="float32",n={x:t},r={dtype:e};return pa.runKernel(P,n,r)}}),a=[];return this.addTapeNode(this.state.activeScope.name,n,[e],r,a,{}),e}runKernel(t,e,n){null==this.backendName&&this.backend;const r=null!=mr(t,this.backendName);if(!r)throw new Error(`Kernel '${t}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:t,inputs:e,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(t,e,n){const r=this.backend.numDataIds();let a=0;n.forEach(t=>{a+="complex64"===t.dtype?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${t}'`)}runKernelFunc(t){let e,n=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;let o,s;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const u=ua(t)?t.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(ua(t)){const{kernelName:e,inputs:a,attrs:i}=t;null==this.backendName&&this.backend;const u=mr(e,this.backendName);Cn(null!=u,()=>`Cannot find registered kernel '${e}' for backend '${this.backendName}'`),o=()=>{const t=this.backend.numDataIds();s=u.kernelFunc({inputs:a,attrs:i,backend:this.backend});const o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(e,t,o);const c=o.map(t=>null!=t.rank?t:this.makeTensorFromTensorInfo(t));if(r){const t=this.getTensorsForGradient(e,a,c);n=this.saveTensorsForBackwardMode(t)}return c}}else{const{forwardFunc:e}=t,a=t=>{r&&(n=t.map(t=>this.keep(this.clone(t))))};o=()=>{const t=this.backend.numDataIds();s=this.tidy(()=>e(this.backend,a));const n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,t,n),n}}const{inputs:c,attrs:l}=t,d=ua(t)?null:t.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(u,c,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),e=h.outputs):e=o()}),r&&this.addTapeNode(u,c,e,d,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(t=>null!=c[t]?c[t].shape:null),outputShapes:e.map(t=>t.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(s)?e:e[0]}saveTensorsForBackwardMode(t){const e=t.map(t=>this.keep(this.clone(t)));return e}getTensorsForGradient(t,e,n){const r=gr(t);if(null!=r){const t=r.inputsToSave||[],a=r.outputsToSave||[];let i;r.saveAllInputs?(Cn(Array.isArray(e),()=>"saveAllInputs is true, expected inputs to be an array."),i=Object.keys(e).map(t=>e[t])):i=t.map(t=>e[t]);const o=n.filter((t,e)=>a[e]);return i.concat(o)}return[]}makeTensor(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let a=t;"string"===n&&Wn(t[0])&&(a=t.map(t=>_r(t)));const i=r.write(a,e,n),o=new qr(e,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){const t=this.state.tensorInfo.get(i),e=zn(a);this.state.numBytes+=e-t.bytes,t.bytes=e}return o}makeTensorFromDataId(t,e,n,r){n=n||"float32";const a={dataId:t,shape:e,dtype:n};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(t,e){const{dataId:n,shape:r,dtype:a}=t,i=new qr(r,a,n,this.nextTensorId());return this.trackTensor(i,e),i}makeVariable(t,e=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.cast(r));const a=new Xr(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(t,e){this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(n=t.size*Bn(t.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(t.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:n})),t instanceof Xr||this.track(t)}incRef(t,e){this.trackTensor(t,e),this.backend.incRef(t.dataId)}removeDataId(t,e){this.state.tensorInfo.has(t)&&this.state.tensorInfo.get(t).backend===e&&(this.state.tensorInfo.delete(t),this.state.numDataBuffers--)}disposeTensor(t){if(!this.state.tensorInfo.has(t.dataId))return;const e=this.state.tensorInfo.get(t.dataId);if(this.state.numTensors--,"string"===t.dtype&&(this.state.numStringTensors--,this.state.numBytes-=e.bytes),"complex64"!==t.dtype&&"string"!==t.dtype){const e=t.size*Bn(t.dtype);this.state.numBytes-=e}e.backend.disposeData(t.dataId)&&this.removeDataId(t.dataId,e.backend)}disposeVariables(){for(const t in this.state.registeredVariables){const e=this.state.registeredVariables[t];this.disposeVariable(e)}}disposeVariable(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]}memory(){const t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t}async profile(t){this.state.profiling=!0;const e=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(t=>t.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(t,e,n,r,a,i){const o={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},s=gr(t);null!=s&&(r=s.gradFunc),null!=r&&(o.gradient=t=>(t=t.map((t,e)=>{if(null==t){const t=n[e],r=Jn(t.size,t.dtype);return this.makeTensor(r,t.shape,t.dtype)}return t}),r(t.length>1?t:t[0],a,i))),this.state.activeTape.push(o)}keep(t){return t.kept=!0,t}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(t){const e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e}endScope(t){const e=ia(t),n=new Set(e.map(t=>t.id));for(let a=0;a<this.state.activeScope.track.length;a++){const t=this.state.activeScope.track[a];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],e.forEach(t=>{t.kept||t.scopeId!==r.id||this.track(t)})}gradients(t,e,n,r=!1){if(Cn(e.length>0,()=>"gradients() received an empty list of xs."),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",t));Cn(a instanceof qr,()=>"The result y returned by f() must be a tensor.");const i=Er(this.state.activeTape,e,a);if(!r&&0===i.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const t={};t[a.id]=null==n?da(a.shape):n,Ar(t,i,t=>this.tidy(t),fa);const r=e.map(e=>t[e.id]);return 0===this.state.gradientDepth&&(this.state.activeTape.forEach(t=>{for(const e of t.saved)e.dispose()}),this.state.activeTape=null),{value:a,grads:r}})}customGrad(t){return Cn(Hn(t),()=>"The f passed in customGrad(f) must be a function."),(...e)=>{let n;Cn(e.every(t=>t instanceof qr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");const r={};e.forEach((t,e)=>{r[e]=t});const a=(r,a)=>(n=t(...e,a),Cn(n.value instanceof qr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Cn(Hn(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),i=(t,r)=>{const a=n.gradFunc(t,r),i=Array.isArray(a)?a:[a];Cn(i.length===e.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Cn(i.every(t=>t instanceof qr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const o={};return i.forEach((t,e)=>{o[e]=()=>t}),o};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(t){const e=this.state.tensorInfo.get(t);return e.backend.readSync(t)}read(t){const e=this.state.tensorInfo.get(t);return e.backend.read(t)}readToGPU(t,e){const n=this.state.tensorInfo.get(t);return n.backend.readToGPU(t,e)}async time(t){const e=Or(),n=await this.backend.time(t);return n.wallMs=Or()-e,n}track(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ca;for(const t in this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function da(t){const e=Yn(En(t),"float32");return pa.makeTensor(e,t,"float32")}function ha(){const t=cr();if(null==t._tfengine){const e=new er(t);t._tfengine=new la(e)}return ur(t._tfengine.ENV),Gr(()=>t._tfengine),t._tfengine}la.nextTensorId=0,la.nextVariableId=0;const pa=ha();function fa(t,e){const n={a:t,b:e};return pa.runKernel(b,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(t,e){let n=t;if(Ln(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];while(Array.isArray(n)||Ln(n)&&"string"!==e)r.push(n.length),n=n[0];return Array.isArray(t)&&ir().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ga(t,r,[]),r}function ga(t,e,n){if(n=n||[],!Array.isArray(t)&&!Ln(t))return void Cn(0===e.length,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);Cn(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),Cn(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let a=0;a<t.length;++a)ga(t[a],r,n.concat(a))}function ba(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function ya(t,e,n,r="numeric"){if(t instanceof qr)return ba(r,t.dtype,e,n),t;let a=Gn(t);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),ba(r,a,e,n),null==t||!Ln(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const i=ma(t,a);Ln(t)||Array.isArray(t)||(t=[t]);const o=!0,s="string"!==a?Sr(t,a):Nn(t,[],o);return pa.makeTensor(s,i,a)}function va(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);const a=t;return a.map((t,a)=>ya(t,`${e}[${a}]`,n,r))}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xa="__op";function wa(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=xa;const a=(...t)=>{pa.startScope(n);try{const e=r(...t);return Qn(e)&&console.error("Cannot return a Promise inside of tidy."),pa.endScope(e),e}catch(e){throw pa.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ka(t,e){const n=ya(t,"x","cast");if(!$n(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:e};return pa.runKernel(P,r,a)}const Sa=wa({cast_:ka});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t,e){let n=ya(t,"a","mul"),r=ya(e,"b","mul");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(ae,a)}const _a=wa({mul_:Oa});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t,e=0){const n=ya(t,"x","step"),r={x:n},a={alpha:e};return pa.runKernel(gn,r,a)}const Ta=wa({step_:Ca}),Ia={kernelName:f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,Ta(Sa(n,"float32"),-1))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Na(t,e){let n=ya(t,"a","floorDiv"),r=ya(e,"b","floorDiv");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(kt,a)}const Ea=wa({floorDiv_:Na});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aa(t,e){let n=ya(t,"a","div"),r=ya(e,"b","div");if([n,r]=ra(n,r),"int32"===n.dtype&&"int32"===r.dtype)return Ea(n,r);const a={a:n,b:r},i={};return pa.runKernel(ct,a,i)}const Ra=wa({div_:Aa});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ja(t){const e=ya(t,"x","neg"),n={x:e};return pa.runKernel(ie,n)}const Da=wa({neg_:ja});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(t,e,n,r){if(null==r&&(r=Gn(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Ln(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Zn(e);const t=En(e),r=En(n);Cn(t===r,()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`);for(let a=0;a<n.length;++a){const t=n[a],r=a!==n.length-1||t!==En(e.slice(a));Cn(n[a]===e[a]||!r,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return Ln(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?Sr(t,r):Nn(t,[],!0),pa.makeTensor(t,e,r)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ma(t,e){if((Ln(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&Ln(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");const n=[],r=[];return Fa(t,n,r,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pa(t){const e=ya(t,"x","sqrt","float32"),n={x:e};return pa.runKernel(We,n)}const $a=wa({sqrt_:Pa});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function La(t){const e=ya(t,"x","square"),n={};return pa.runKernel("Square",{x:e},n)}const Ba=wa({square_:La});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function za(t,e){let n=ya(t,"a","sub"),r=ya(e,"b","sub");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(an,a)}const Wa=wa({sub_:za}),Va={kernelName:m,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Ba(Sa(n,"float32")),r=$a(Wa(Ma(1),e));return Da(Ra(t,r))}}}},Ua={kernelName:g,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=$a(Wa(Ba(Sa(n,"float32")),1));return Ra(t,e)}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ga(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Ha(t,e){const n=[],r=Math.max(t.length,e.length);for(let a=0;a<r;a++){let r=t[t.length-a-1];null==r&&(r=1);let i=e[e.length-a-1];if(null==i&&(i=1),1===r)n.unshift(i);else if(1===i)n.unshift(r);else{if(r!==i){const n=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(n)}n.unshift(r)}}return n}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qa(t,e){const n=ya(t,"x","reshape","string_or_numeric"),r={x:n},a={shape:e};return pa.runKernel(Se,r,a)}const Ka=wa({reshape_:qa});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(t,e=null,n=!1){let r=ya(t,"x","sum");"bool"===r.dtype&&(r=Sa(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return pa.runKernel(Ve,a,i)}const Ya=wa({sum_:Xa}),Ja={kernelName:b,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{let e=t;const r=Ga(n.shape,a);return r.length>0&&(e=Ya(e,r)),Ka(e,n.shape)},o=()=>{let e=t;const n=Ga(r.shape,a);return n.length>0&&(e=Ya(e,n)),Ka(e,r.shape)};return{a:i,b:o}}},Za={kernelName:y,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qa(t){const e=ya(t,"x","zerosLike"),n={x:e};return pa.runKernel(mn,n)}const ti=wa({zerosLike_:Qa}),ei={kernelName:w,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ti(n)}}},ni={kernelName:k,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ti(n)}}},ri={kernelName:S,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,$a(Wa(Ma(1),Ba(Sa(n,"float32")))))}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ai(t,e){let n=ya(t,"a","add"),r=ya(e,"b","add");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(b,a)}const ii=wa({add_:ai}),oi={kernelName:O,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=$a(ii(Ma(1),Ba(Sa(n,"float32"))));return Ra(t,e)}}}},si={kernelName:T,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{const e=ii(Ba(n),Ba(r));let i=_a(t,Ra(r,e));const o=Ga(n.shape,a);return o.length>0&&(i=Ya(i,o)),Ka(i,n.shape)},o=()=>{const e=ii(Ba(n),Ba(r));let i=Da(_a(t,Ra(n,e)));const o=Ga(r.shape,a);return o.length>0&&(i=Ya(i,o)),Ka(i,r.shape)};return{a:i,b:o}}},ui={kernelName:_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,ii(Ba(Sa(n,"float32")),1))}}},ci={kernelName:C,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,Wa(Ma(1),Ba(Sa(n,"float32"))))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function li(t,e,n,r,a,i,o="channelsLast"){const[s,u]=fi(e);let c;if("channelsLast"===o)c=[s,u,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=[s,u,t[1],t[1]]}return di(t,c,n,r,a,i,!1,o)}function di(t,e,n,r,a,i,o=!1,s="channelsLast"){let[u,c,l,d]=[-1,-1,-1,-1];if("channelsLast"===s)[u,c,l,d]=t;else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);[u,d,c,l]=t}const[h,p,,f]=e,[m,g]=fi(n),[b,y]=fi(r),v=mi(h,b),x=mi(p,y),{padInfo:w,outHeight:k,outWidth:S}=gi(a,c,l,m,g,v,x,i,s),O=o?f*d:f;let _;return"channelsFirst"===s?_=[u,O,k,S]:"channelsLast"===s&&(_=[u,k,S,O]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:d,outHeight:k,outWidth:S,outChannels:O,padInfo:w,strideHeight:m,strideWidth:g,filterHeight:h,filterWidth:p,effectiveFilterHeight:v,effectiveFilterWidth:x,dilationHeight:b,dilationWidth:y,inShape:t,outShape:_,filterShape:e}}function hi(t,e,n,r,a){null==r&&(r=pi(t,e,n));const i=t[0],o=t[1],s=bi((i-e+2*r)/n+1,a),u=bi((o-e+2*r)/n+1,a);return[s,u]}function pi(t,e,n,r=1){const a=mi(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function fi(t){return"number"===typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function mi(t,e){return e<=1?t:t+(t-1)*(e-1)}function gi(t,e,n,r,a,i,o,s,u){let c,l,d;if("number"===typeof t){const a=0===t?"VALID":"NUMBER";c={top:t,bottom:t,left:t,right:t,type:a};const o=hi([e,n],i,r,t,s);l=o[0],d=o[1]}else if("same"===t){l=Math.ceil(e/r),d=Math.ceil(n/a);const t=Math.max(0,(l-1)*r+i-e),s=Math.max(0,(d-1)*a+o-n),u=Math.floor(t/2),h=t-u,p=Math.floor(s/2),f=s-p;c={top:u,bottom:h,left:p,right:f,type:"SAME"}}else if("valid"===t)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/a);else{if("object"!==typeof t)throw Error("Unknown padding parameter: "+t);{const h="channelsLast"===u?t[1][0]:t[2][0],p="channelsLast"===u?t[1][1]:t[2][1],f="channelsLast"===u?t[2][0]:t[3][0],m="channelsLast"===u?t[2][1]:t[3][1],g=0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT";c={top:h,bottom:p,left:f,right:m,type:g},l=bi((e-i+h+p)/r+1,s),d=bi((n-o+f+m)/a+1,s)}}return{padInfo:c,outHeight:l,outWidth:d}}function bi(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function yi(t){const[e,n,r]=fi(t);return 1===e&&1===n&&1===r}function vi(t,e){return yi(t)||yi(e)}function xi(t,e,n){if(null!=n){if("string"===typeof e)throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if("number"===typeof e)Cn(Rn(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else{if("object"!==typeof e)throw Error(`Error in ${t}: Unknown padding parameter: ${e}`);e.forEach(e=>{e.forEach(e=>{Cn(Rn(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`)})})}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wi(t,e,n,r,a,i){const o=ya(t,"dy","avgPool3dGrad"),s=ya(e,"input","avgPool3dGrad");let u=o,c=s,l=!1;4===s.rank&&(l=!0,u=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Cn(5===u.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+u.rank+"."),Cn(5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+c.rank+"."),xi("avgPool3dGrad",a,i);const d={dy:u,input:c},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},p=pa.runKernel(A,d,h);return l?Ka(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const ki=wa({avgPool3dGrad_:wi}),Si={kernelName:E,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:s}=n;return{x:()=>ki(t,r,a,i,o,s)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Oi(t,e,n,r,a){const i=ya(t,"dy","avgPoolGrad"),o=ya(e,"input","avgPoolGrad");Cn(o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let s=o,u=i,c=!1;3===o.rank&&(c=!0,s=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Ka(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Cn(4===u.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+u.rank+"."),Cn(4===s.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+s.rank+".");const l={dy:u,input:s},d={filterSize:n,strides:r,pad:a},h=pa.runKernel(N,l,d);return c?Ka(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const _i=wa({avgPoolGrad_:Oi}),Ci={kernelName:I,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o}=n;return{x:()=>_i(t,r,a,i,o)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ti(t,e,n=!1,r=!1){let a=ya(t,"a","matMul"),i=ya(e,"b","matMul");[a,i]=ra(a,i);const o={a:a,b:i},s={transposeA:n,transposeB:r};return pa.runKernel(R,o,s)}const Ii=wa({matMul_:Ti}),Ni={kernelName:R,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,a]=e,{transposeA:i,transposeB:o}=n;return i||o?!i&&o?{a:()=>Ii(t,a,!1,!1),b:()=>Ii(t,r,!0,!1)}:i&&!o?{a:()=>Ii(a,t,!1,!0),b:()=>Ii(r,t,!1,!1)}:{a:()=>Ii(a,t,!0,!0),b:()=>Ii(t,r,!0,!0)}:{a:()=>Ii(t,a,!1,!0),b:()=>Ii(r,t,!0,!1)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ei(t,e,n){const r=ya(t,"x","spaceToBatchND");Cn(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),Cn(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),Cn(r.shape.reduce((t,r,a)=>a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]===0:t,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:r},i={blockShape:e,paddings:n};return pa.runKernel(Ue,a,i)}const Ai=wa({spaceToBatchND_:Ei}),Ri={kernelName:j,gradFunc:(t,e,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>Ai(t,r,a)}}},ji={kernelName:F,gradFunc:(t,e,n)=>{const r=n,a=r.inputShape,i=r.shape,o=Array.from(i);for(let u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${i}].`);const s=[];for(let u=0;u<o.length;u++)o[u]>1&&s.push(u);return{x:()=>Ya(t,s,!0)}}},Di={kernelName:P,gradFunc:t=>({x:()=>t.clone()})},Fi={kernelName:$,gradFunc:t=>({x:()=>ti(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Mi(t,e){let n=ya(t,"a","greaterEqual","string_or_numeric"),r=ya(e,"b","greaterEqual","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Tt,a)}const Pi=wa({greaterEqual_:Mi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $i(t,e){let n=ya(t,"a","lessEqual","string_or_numeric"),r=ya(e,"b","lessEqual","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Mt,a)}const Li=wa({lessEqual_:$i});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bi(t,e){const n=ya(t,"a","logicalAnd","bool"),r=ya(e,"b","logicalAnd","bool");Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Lt,a)}const zi=wa({logicalAnd_:Bi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wi(t){const e=ya(t,"x","clone","string_or_numeric"),n={x:e};return pa.runKernel(It,n)}const Vi=wa({clone_:Wi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ui(t,e){let n=ya(t,"broadcastTo","x");const r=n.shape;if(e.some(t=>!(t>0)||t%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const t=n.shape.slice();while(t.length<e.length)t.unshift(1);n=Ka(n,t)}const a=n.shape,i=Array.from(e);for(let c=e.length-1;c>=0;c--)if(a[c]===e[c])i[c]=1;else if(1!==n.shape[c])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);const o=i.map((t,e)=>t>1?e:-1).filter(t=>t>=0);if(0===o.length)return Vi(n);const s={x:n},u={reps:i};return pa.runKernel(un,s,u)}const Gi=wa({broadcastTo_:Ui});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hi(t,e,n){const r=ya(e,"a","where"),a=ya(n,"b","where"),i=ya(t,"condition","where","bool"),o=Ha(Ha(i.shape,r.shape),a.shape),s=Gi(i,o),u=Gi(r,o),c=Gi(a,o),l={condition:s,t:u,e:c};return pa.runKernel(De,l)}const qi=wa({where_:Hi}),Ki={kernelName:L,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>qi(zi(Pi(r,a),Li(r,i)),t,ti(t))}}},Xi={kernelName:z,inputsToSave:["x"],gradFunc:Ia.gradFunc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yi(t,e,n=0){const r=ya(t,"x","split"),a={x:r},i={numOrSizeSplits:e,axis:n};return pa.runKernel(Ge,a,i)}const Ji=wa({split_:Yi}),Zi={kernelName:W,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:a}=n,i=Dn(a,e[0].shape)[0],o=r.map(t=>t[i]),s=Ji(t,o,i);return s.map(t=>()=>t)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qi(t,e,n,r,a,i="NHWC",o){let s=t;3===t.rank&&(s=Ka(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;3===u.rank&&(u=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Cn(4===s.rank,()=>"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."),Cn(4===u.rank,()=>"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."),Cn(4===n.length,()=>"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+".");const c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];Cn(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),Cn(l===n[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`),xi("conv2dDerFilter",a,o);const d={x:s,dy:u},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return pa.runKernel(U,d,h)}const to=wa({conv2DBackpropFilter_:Qi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eo(t,e,n,r,a,i="NHWC",o){Cn(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,u=e,c=!1;3===e.rank&&(c=!0,u=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),Cn(4===s.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."),Cn(4===u.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank),Cn(4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank);const l="NHWC"===i?s[3]:s[1],d="NHWC"===i?u.shape[3]:u.shape[1];Cn(l===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`),Cn(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),xi("conv2dDerInput",a,o);const h={dy:u,filter:n},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},f=pa.runKernel(G,h,p);return c?Ka(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const no=wa({conv2DBackpropInput_:eo}),ro={kernelName:V,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{dilations:i,strides:o,pad:s,dataFormat:u}=n;return Cn(yi(i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>no(r.shape,t,a,o,s,u),filter:()=>to(r,t,a.shape,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ao(t,e,n,r,a="NHWC",i=[1,1],o){const s=ya(t,"x","conv2d","float32"),u=ya(e,"filter","conv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Cn(4===c.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),Cn(4===u.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."),xi("conv2d",r,o);const d="NHWC"===a?c.shape[3]:c.shape[1];Cn(d===u.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${u.shape[2]}.`),Cn(vi(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const h={x:c,filter:u},p={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=pa.runKernel(V,h,p);return l?Ka(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const io=wa({conv2d_:ao}),oo={kernelName:G,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{strides:i,pad:o,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>io(t,a,i,o,s,1,u),filter:()=>to(t,r,a.shape,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function so(t,e,n,r,a){let i=t;4===t.rank&&(i=Ka(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),Cn(5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."),Cn(5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."),Cn(5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."),Cn(i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),Cn(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return pa.runKernel(q,s,u)}const uo=wa({conv3DBackpropFilter_:so});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function co(t,e,n,r,a){Cn(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,s=!1;4===e.rank&&(s=!0,o=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const u=i[4],c=o.shape[4];Cn(5===i.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."),Cn(5===o.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank),Cn(5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank),Cn(u===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[3]}.`),Cn(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const l={dy:o,filter:n},d={pad:a,strides:r,inputShape:i},h=pa.runKernel(K,l,d);return s?Ka(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const lo=wa({conv3DBackpropInput_:co}),ho={kernelName:H,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i}=n;Cn(yi(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,s]=e;return{x:()=>lo(o.shape,t,s,a,i),filter:()=>uo(o,t,s.shape,a,i)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function po(t){const e=ya(t,"x","sin","float32"),n={x:e};return pa.runKernel(Pe,n)}const fo=wa({sin_:po}),mo={kernelName:X,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(Da(fo(Sa(n,"float32"))),t)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function go(t){const e=ya(t,"x","sinh"),n={x:e};return pa.runKernel($e,n)}const bo=wa({sinh_:go}),yo={kernelName:Y,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(bo(Sa(n,"float32")),t)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function vo(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function xo(t,e,n){const r=t.length+e.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function wo(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);const a=e.map(e=>t[e]);return[n,a]}function ko(t,e){const n=e.map(t=>1);return xo(t,n,e)}function So(t,e){if(vo(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function Oo(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _o(t,e=0,n=!1,r=!1){const a=ya(t,"x","cumsum"),i={x:a},o={axis:e,exclusive:n,reverse:r};return pa.runKernel(Z,i,o)}const Co=wa({cumsum_:_o});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function To(t){ir().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Io(t,e){return pa.tidy(t,e)}function No(t){const e=ia(t);e.forEach(t=>t.dispose())}function Eo(t){return pa.keep(t)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ao(t,e){const n=ya(t,"real","complex"),r=ya(e,"imag","complex");Tn(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:n,imag:r};return pa.runKernel(B,a)}Hr(To);const Ro=wa({complex_:Ao});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jo(t){const e=ya(t,"input","imag"),n={input:e};return pa.runKernel(Et,n)}const Do=wa({imag_:jo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fo(t){const e=ya(t,"input","real"),n={input:e};return pa.runKernel(xe,n)}const Mo=wa({real_:Fo});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Po(t,e,n){const r=ya(t,"x","transpose");if(null==e&&(e=r.shape.map((t,e)=>e).reverse()),Cn(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(t=>{Cn(t>=0&&t<r.rank,()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+" but got "+e)}),r.rank<=1)return r.clone();const a={x:r},i={perm:e};return"complex64"===r.dtype?Io(()=>{let t=Mo(r),e=Do(r);return t=pa.runKernel(dn,{x:t},i),e=pa.runKernel(dn,{x:e},i),n&&(e=Da(e)),Ro(t,e)}):pa.runKernel(dn,a,i)}const $o=wa({transpose_:Po}),Lo={kernelName:Z,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a,exclusive:i,reverse:o}=n;return{x:()=>{const e=So([a],r.rank);let n=Co(t,a,i,!o);return null!=e&&(n=$o(n,e)),n}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bo(t,e,n,r,a,i=[1,1],o){let s=t;3===t.rank&&(s=Ka(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let u=e;3===u.rank&&(u=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:s,dy:u},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return pa.runKernel(rt,c,l)}const zo=wa({depthwiseConv2dNativeBackpropFilter_:Bo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wo(t,e,n,r,a,i=[1,1],o){let s=e,u=!1;3===e.rank&&(u=!0,s=Ka(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:t},d=pa.runKernel(at,c,l);return u?Ka(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Vo=wa({depthwiseConv2dNativeBackpropInput_:Wo}),Uo={kernelName:nt,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i,dimRoundingMode:o}=n,s=null==r?[1,1]:r;Cn(yi(s),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[u,c]=e;return Cn(4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),Cn(4===c.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),Cn(u.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),Cn(vi(a,s),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${s}'.`),xi("depthwiseConv2d",i,o),{x:()=>Vo(u.shape,t,c,a,i,s,o),filter:()=>zo(u,t,c.shape,a,i,s,o)}}},Go={kernelName:ot,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,i={x:r,filter:a,dy:t},o={x:r,filter:a,dy:t};return{x:()=>pa.runKernel(st,i,n),filter:()=>pa.runKernel(ut,o,n)}}},Ho={kernelName:dt,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>pa.runKernel(ht,r)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function qo(t){const e=ya(t,"x","exp"),n={x:e};return pa.runKernel(mt,n)}const Ko=wa({exp_:qo}),Xo={kernelName:pt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_a(Ko(Da(Ba(n))),2/Math.sqrt(Math.PI));return{x:()=>_a(t,r)}}},Yo={kernelName:mt,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,n)}}},Jo={kernelName:gt,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Ka(t,n.shape)}}},Zo={kernelName:bt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,Ko(n))}}},Qo={kernelName:wt,gradFunc:t=>({x:()=>ti(t)})},ts={kernelName:kt,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{const e=Ra(t,Sa(r,"float32")),i=Ga(n.shape,a);return i.length>0?Ka(Ya(e,i),n.shape):e},o=()=>{let e=_a(t,Sa(n,"float32"));const i=Ga(r.shape,a);i.length>0&&(e=Ka(Ya(e,i),r.shape));const o=Ba(r);return Da(Ra(e,Sa(o,"float32")))};return{a:i,b:o}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function es(t){const e=ya(t,"x","rsqrt","float32"),n={x:e};return pa.runKernel(Ae,n)}const ns=wa({rsqrt_:es});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rs(t,e){const n=ya(t,"x","tile","string_or_numeric");Cn(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},a={reps:e};return pa.runKernel(un,r,a)}const as=wa({tile_:rs}),is={kernelName:St,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[a,i,o,s]=e,u=null==s?Ma(1):s,c=Ga(i.shape,a.shape),l=[];if(1===i.rank){for(let t=0;t<a.shape.length-1;++t)l.push(a.shape[t]);l.push(1)}const d=Wa(a,i),h=_a(t,u),p=ns(ii(o,Ma(r))),f=_a(_a(_a(p,p),p),Ma(-.5)),m=()=>1===i.rank?Ka(_a(_a(t,as(Ka(p,[1,1,1,i.shape[0]]),l)),u),a.shape):Ka(_a(_a(t,p),u),a.shape),g=()=>{let t=_a(_a(p,Ma(-1)),h);return 1===i.rank&&(t=Ya(t,c)),Ka(t,i.shape)},b=()=>{let t=_a(_a(f,d),h);return 1===i.rank&&(t=Ya(t,c)),Ka(t,i.shape)},y=()=>{const e=_a(d,p);let n=_a(t,e);return 1===i.rank&&(n=Ya(n,c)),Ka(n,i.shape)},v=()=>{let e=t;return 1===i.rank&&(e=Ya(e,c)),Ka(e,i.shape)};return{x:m,mean:g,variance:b,scale:y,offset:v}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function os(t,e,n){const r=ya(t,"x","unsortedSegmentSum"),a=ya(e,"segmentIds","unsortedSegmentSum","int32");Cn(Rn(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},o={numSegments:n};return pa.runKernel(fn,i,o)}const ss=wa({unsortedSegmentSum_:os}),us={kernelName:Ot,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,a]=e,{axis:i}=n,o=Dn(i,r.shape)[0],s=()=>{const e=r.shape,n=a.size,s=e.slice(0,o),u=s.length,c=e.slice(i,e.length).slice(1),l=c.length,d=cs(0,u),h=cs(u+1,u+1+l),p=ls([s,[n],c]),f=Ka(t,p),m=Ka(a,[n]),g=ls([[u],d,h]),b=$o(f,g);let y=ss(b,m,r.shape[o]);const v=Oo(g);return y=$o(y,v),y};return{x:s,indices:()=>a}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cs(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function ls(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds={kernelName:Tt,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>ti(n),b:()=>ti(r)}}},hs={kernelName:It,gradFunc:t=>({x:()=>Sa(t,"float32")})},ps={kernelName:At,gradFunc:t=>({x:()=>ti(t)})},fs={kernelName:Rt,gradFunc:t=>({x:()=>ti(t)})},ms={kernelName:jt,gradFunc:t=>({x:()=>ti(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function gs(t,e){let n=ya(t,"a","greater","string_or_numeric"),r=ya(e,"b","greater","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Ct,a)}const bs=wa({greater_:gs}),ys={kernelName:Dt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:a}=n,i=bs(r,0);return{x:()=>qi(i,t,_a(t,a))}}},vs={kernelName:$t,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,ii(n,1))}}},xs={kernelName:Pt,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,Sa(n,"float32"))}}},ws={kernelName:Wt,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;return{logits:()=>{const e=!0,n=Ko(r);return Wa(t,_a(Ya(t,a,e),n))}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ks(t,e,n,r=5,a=1,i=1,o=.5){const s={x:t,y:e,dy:n},u={depthRadius:r,bias:a,alpha:i,beta:o};return pa.runKernel(Ut,s,u)}const Ss=wa({localResponseNormalizationBackprop_:ks}),Os={kernelName:Vt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{depthRadius:i,bias:o,alpha:s,beta:u}=n;return{x:()=>Ss(r,a,t,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function _s(t,e){let n=ya(t,"a","equal","string_or_numeric"),r=ya(e,"b","equal","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(ft,a)}const Cs=wa({equal_:_s});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ts(t,e,n,r){return e.rank<n.rank&&(e=Ka(e,ko(e.shape,r))),t.rank<n.rank&&(t=Ka(t,ko(t.shape,r))),{x:()=>{const r=_a(t,Sa(Cs(n,e),t.dtype));return r}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Is={kernelName:Gt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:a}=r,i=e[0],o=e[1],s=Dn(a,i.shape),u=Ts(t,o,i,s);return{x:()=>u["x"]()}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ns(t,e){let n=ya(t,"a","less","string_or_numeric"),r=ya(e,"b","less","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Ft,a)}const Es=wa({less_:Ns}),As={kernelName:Ht,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=()=>_a(t,Sa(Pi(n,r),"float32")),i=()=>_a(t,Sa(Es(n,r),"float32"));return{a:a,b:i}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Rs(t,e,n,r,a,i,o){const s=ya(t,"dy","maxPool3dGrad"),u=ya(e,"input","maxPool3dGrad"),c=ya(n,"output","maxPool3dGrad");let l=s,d=u,h=c,p=!1;4===u.rank&&(p=!0,l=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=Ka(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=Ka(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),Cn(5===l.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+l.rank+"."),Cn(5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+d.rank+"."),Cn(5===h.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+h.rank+"."),xi("maxPool3dGrad",i,o);const f={dy:l,input:d,output:h},m={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=pa.runKernel(Yt,f,m);return p?Ka(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const js=wa({maxPool3dGrad_:Rs}),Ds={kernelName:Xt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=n;return{x:()=>js(t,r,a,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fs(t,e,n,r,a,i,o){const s=ya(t,"dy","maxPoolGrad"),u=ya(e,"input","maxPoolGrad"),c=ya(n,"output","maxPoolGrad");Cn(u.rank===s.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${s.rank})`),Cn(4===s.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+s.rank+"."),Cn(4===u.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+u.rank+"."),xi("maxPoolGrad",i,o);const l={dy:s,input:u,output:c},d={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return pa.runKernel(Kt,l,d)}const Ms=wa({maxPoolGrad_:Fs}),Ps={kernelName:qt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s}=n;return{x:()=>Ms(t,r,a,i,o,s)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $s(t,e="float32"){if("complex64"===e){const e=$s(t,"float32"),n=$s(t,"float32");return Ro(e,n)}const n=Jn(En(t),e);return pa.makeTensor(n,t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ls(t,e="float32"){if("complex64"===e){const e=Ls(t,"float32"),n=$s(t,"float32");return Ro(e,n)}const n=Yn(En(t),e);return pa.makeTensor(n,t,e)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bs={kernelName:Zt,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n,i=Dn(a,r.shape),o=wo(r.shape,i),s=o[1],u=En(s),c=()=>{const e=r.shape.slice();i.forEach(t=>{e[t]=1});const n=Ka(t,e),a=Ra(_a(n,Ls(r.shape,"float32")),u);return a};return{x:c}}},zs={kernelName:Qt,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:a}=r,[i,o]=e,s=Dn(a,i.shape),u=Ts(t,o,i,s);return{x:()=>u["x"]()}}},Ws={kernelName:te,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=()=>_a(t,Sa(Li(n,r),"float32")),i=()=>_a(t,Sa(bs(n,r),"float32"));return{a:a,b:i}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Vs(t,e,n){const r=ya(t,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:e,size:n};return pa.runKernel(Me,a,i)}const Us=wa({slice_:Vs}),Gs={kernelName:ee,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Us(t,i,r.shape)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Hs(t){const e=ya(t,"x","floor","float32"),n={x:e};return pa.runKernel(wt,n)}const qs=wa({floor_:Hs}),Ks={kernelName:ne,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{const e=Ga(n.shape,a);return e.length>0?Ka(Ya(t,e),n.shape):t},o=()=>{const e=_a(t,Da(qs(Ra(n,r)))),i=Ga(r.shape,a);return i.length>0?Ka(Ya(e,i),r.shape):e};return{a:i,b:o}}},Xs={kernelName:ae,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{const e=_a(t,Sa(r,"float32")),i=Ga(n.shape,a);return i.length>0?Ka(Ya(e,i),n.shape):e},o=()=>{const e=_a(t,Sa(n,"float32")),i=Ga(r.shape,a);return i.length>0?Ka(Ya(e,i),r.shape):e};return{a:i,b:o}}},Ys={kernelName:ie,gradFunc:t=>({x:()=>Da(t)})},Js={kernelName:de,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>$s(n.shape,"float32")}}},Zs={kernelName:le,gradFunc:t=>({x:()=>ti(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Qs(t,e=0){const n=ya(t,"x","unstack","string_or_numeric");Cn(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},a={axis:e};return pa.runKernel(pn,r,a)}const tu=wa({unstack_:Qs}),eu={kernelName:he,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n,a=tu(t,r);return a.map(t=>()=>t)}},nu={kernelName:pe,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Us(t,i,r.shape)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ru(t){const e=ya(t,"x","log","float32"),n={x:e};return pa.runKernel(Pt,n)}const au=wa({log_:ru});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iu(t,e){let n=ya(t,"base","pow"),r=ya(e,"exp","pow");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(fe,a)}const ou=wa({pow_:iu}),su={kernelName:fe,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,a]=e,i=n,o=r,s=Ha(i.shape,o.shape),u=()=>{const e=Sa(o,"float32");let n=_a(t,_a(e,ou(i,Wa(e,Ma(1)))));const r=Ga(i.shape,s);return r.length>0&&(n=Ya(n,r)),Ka(n,i.shape)},c=()=>{const e=bs(i,0),n=qi(e,au(i),ti(i));let r=_a(t,_a(a,n));const u=Ga(o.shape,s);return u.length>0&&(r=Ya(r,u)),Ka(r,o.shape)};return{a:u,b:c}}},uu={kernelName:me,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,a=bs(n,0);return{x:()=>qi(a,t,_a(t,r)),alpha:()=>{let e=qi(a,ti(t),_a(t,n));const i=Ga(r.shape,t.shape);return i.length>0&&(e=Ya(e,i)),Ka(e,r.shape)}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cu(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lu=ir();
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function du(t,e,n){const r=ma(t,n);return Fa(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */lu.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),lu.registerFlag("IS_BROWSER",()=>cu()),lu.registerFlag("IS_NODE",()=>"undefined"!==typeof r&&"undefined"!==typeof r.versions&&"undefined"!==typeof r.versions.node),lu.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),lu.registerFlag("PROD",()=>!1),lu.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>lu.getBool("DEBUG")),lu.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),lu.registerFlag("IS_TEST",()=>!1),lu.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),lu.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),lu.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),lu.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),lu.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);const hu="undefined"!==typeof a&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function pu(t){return hu?a.byteLength(t):new Blob([t]).size}function fu(t){if(hu)return a.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function mu(t){if(hu){const e=a.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function gu(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function bu(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function yu(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),r}async function vu(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),yu(t,n,r)}function xu(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:pu(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:pu(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function wu(t){const e=[];for(const n of t)e.push(...n.weights);return e}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class ku{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==ku.instance&&(ku.instance=new ku),ku.instance}static registerSaveRouter(t){ku.getInstance().saveRouters.push(t)}static registerLoadRouter(t){ku.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return ku.getHandlers(t,"save")}static getLoadHandlers(t,e){return ku.getHandlers(t,"load",e)}static getHandlers(t,e,n){const r=[],a="load"===e?ku.getInstance().loadRouters:ku.getInstance().saveRouters;return a.forEach(e=>{const a=e(t,n);null!==a&&r.push(a)}),r}}const Su="tensorflowjs",Ou=1,_u="models_store",Cu="model_info_store";function Tu(){if(!ir().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t="undefined"===typeof window?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Iu(t){const e=t.result;e.createObjectStore(_u,{keyPath:"modelPath"}),e.createObjectStore(Cu,{keyPath:"modelPath"})}class Nu{constructor(t){if(this.indexedDB=Tu(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,t)}async load(){return this.databaseAction(this.modelPath)}databaseAction(t,e){return new Promise((t,n)=>{const r=this.indexedDB.open(Su,Ou);r.onupgradeneeded=()=>Iu(r),r.onsuccess=()=>{const a=r.result;if(null==e){const e=a.transaction(_u,"readonly"),r=e.objectStore(_u),i=r.get(this.modelPath);i.onsuccess=()=>{if(null==i.result)return a.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));t(i.result.modelArtifacts)},i.onerror=t=>(a.close(),n(i.error)),e.oncomplete=()=>a.close()}else{const r=xu(e),i=a.transaction(Cu,"readwrite");let o=i.objectStore(Cu);const s=o.put({modelPath:this.modelPath,modelArtifactsInfo:r});let u;s.onsuccess=()=>{u=a.transaction(_u,"readwrite");const s=u.objectStore(_u),c=s.put({modelPath:this.modelPath,modelArtifacts:e,modelArtifactsInfo:r});c.onsuccess=()=>t({modelArtifactsInfo:r}),c.onerror=t=>{o=i.objectStore(Cu);const e=o.delete(this.modelPath);e.onsuccess=()=>(a.close(),n(c.error)),e.onerror=t=>(a.close(),n(c.error))}},s.onerror=t=>(a.close(),n(s.error)),i.oncomplete=()=>{null==u?a.close():u.oncomplete=()=>a.close()}}},r.onerror=t=>n(r.error)})}}Nu.URL_SCHEME="indexeddb://";const Eu=t=>ir().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Nu.URL_SCHEME)?Au(t.slice(Nu.URL_SCHEME.length)):null;function Au(t){return new Nu(t)}ku.registerSaveRouter(Eu),ku.registerLoadRouter(Eu);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Ru="/",ju="tensorflowjs_models",Du="info",Fu="model_topology",Mu="weight_specs",Pu="weight_data",$u="model_metadata";function Lu(t){return{info:[ju,t,Du].join(Ru),topology:[ju,t,Fu].join(Ru),weightSpecs:[ju,t,Mu].join(Ru),weightData:[ju,t,Pu].join(Ru),modelMetadata:[ju,t,$u].join(Ru)}}function Bu(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}class zu{constructor(t){if(!ir().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Lu(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=xu(t);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,fu(t.weightData));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:a}}catch(e){throw Bu(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const t=JSON.parse(a);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(null==i)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=mu(i),e}}zu.URL_SCHEME="localstorage://";const Wu=t=>ir().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(zu.URL_SCHEME)?Vu(t.slice(zu.URL_SCHEME.length)):null;function Vu(t){return new zu(t)}ku.registerSaveRouter(Wu),ku.registerLoadRouter(Wu);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Uu="model",Gu=".json",Hu=".weights.bin";function qu(t){return new Promise(t=>setTimeout(t)).then(t)}class Ku{constructor(t){if(!ir().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(Ku.URL_SCHEME)&&(t=t.slice(Ku.URL_SCHEME.length)),null!=t&&0!==t.length||(t=Uu),this.modelJsonFileName=t+Gu,this.weightDataFileName=t+Hu}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r=bu(t,n),a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=a,await qu(()=>i.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await qu(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:xu(t)}}}}Ku.URL_SCHEME="downloads://";const Xu=t=>ir().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ku.URL_SCHEME)?Yu(t.slice(Ku.URL_SCHEME.length)):null;function Yu(t="model"){return new Ku(t)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ju(t,e,n,r){o(t),n=null==n?0:n,r=null==r?1:r,s(n,r);let a=0;const i=i=>(i.then(i=>{const o=n+ ++a/t.length*(r-n);return e(o),i}),i);function o(t){Cn(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}function s(t,e){Cn(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+t),Cn(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+e),Cn(e>=t,()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction `+e)}return Promise.all(t.map(i))}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Zu(t,e){null==e&&(e={});const n=null==e.fetchFunc?ir().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),a=0,i=.5,o=null==e.onProgress?await Promise.all(r):await Ju(r,e.onProgress,a,i),s=o.map(t=>t.arrayBuffer()),u=.5,c=1,l=null==e.onProgress?await Promise.all(s):await Ju(s,e.onProgress,u,c);return l}ku.registerSaveRouter(Xu);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Qu="application/octet-stream",tc="application/json";class ec{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(Cn("function"===typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=ir().platform.fetch,Cn(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Cn(2===t.length,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=bu(t,n);e.body.append("model.json",new Blob([JSON.stringify(r)],{type:tc}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:Qu}),"model.weights.bin");const a=await this.fetch(this.path,e);if(a.ok)return{modelArtifactsInfo:xu(t),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(a){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return vu(e,t=>this.loadWeights(t))}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=nc(e),a=this.weightPathPrefix||n,i=wu(t),o=[],s=[];for(const c of t)for(const t of c.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(t)):o.push(a+t+r);this.weightUrlConverter&&o.push(...await Promise.all(s));const u=await Zu(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,gu(u)]}}function nc(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}function rc(t){return null!=t.match(ec.URL_SCHEME_REGEX)}ec.URL_SCHEME_REGEX=/^https?:\/\//;const ac=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>rc(t)):rc(t),n)return ic(t,e)}return null};function ic(t,e){return new ec(t,e)}ku.registerSaveRouter(ac),ku.registerLoadRouter(ac);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function oc(t,e,n=1,r=0,a="int32"){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);const i=ya(t,"indices","oneHot","int32"),o={indices:i},s={dtype:a,depth:e,onValue:n,offValue:r};return pa.runKernel(de,o,s)}const sc=wa({oneHot_:oc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uc(t,e,n){const r=ya(t,"labels","confusionMatrix"),a=ya(e,"predictions","confusionMatrix");Cn(null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got "+n),Cn(1===r.rank,()=>"Expected the rank of labels to be 1, but got "+r.rank),Cn(1===a.rank,()=>"Expected the rank of predictions to be 1, but got "+a.rank),Cn(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),Cn(n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+n);const i=sc(Sa(r,"int32"),n),o=sc(Sa(a,"int32"),n),s=$o(i),u=Ii(s,o);return Sa(u,"int32")}wa({confusionMatrix_:uc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cc(t,e,n){if(In(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");const r=ma(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Fa(t,e,r,n)}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let lc;function dc(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);s=!0}const u=mr(bn,pa.backendName);if(null!=u){const n={pixels:t},r={numChannels:e};return pa.runKernel(bn,n,r)}const[c,l]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d,h;if(o)d=t.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)d=t.data;else if(i||a||s){if(null==lc)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");lc=new OffscreenCanvas(1,1).getContext("2d")}else lc=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});lc.canvas.width=c,lc.canvas.height=l,lc.drawImage(t,0,0,c,l),d=lc.getImageData(0,0,c,l).data}if(4===e)h=new Int32Array(d);else{const t=c*l;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=d[4*n+t]}const p=[l,c,e];return cc(h,p,"int32")}wa({fromPixels_:dc});function hc(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != "+(a+t.length-r));for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${t[o+a]})`)}function pc(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}hc(n,e,t)}function fc(t,e,n){let r;const a=t.shape.length;let i;return r="number"===typeof e?[e,...new Array(a-1).fill(0)]:e.length<a?e.concat(new Array(a-e.length).fill(0)):e.slice(),r.forEach(t=>{Cn(-1!==t,()=>"slice() does not support negative begin indexing.")}),i=null==n?new Array(a).fill(-1):"number"===typeof n?[n,...new Array(a-1).fill(-1)]:n.length<a?n.concat(new Array(a-n.length).fill(-1)):n,i=i.map((e,n)=>e>=0?e:(Cn(-1===e,()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`),t.shape[n]-r[n])),[r,i]}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class mc{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class gc{constructor(){this.classNameMap={}}static getMap(){return null==gc.instance&&(gc.instance=new gc),gc.instance}static register(t){gc.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function bc(t){Cn(null!=t.className,()=>"Class being registered does not have the static className property defined."),Cn("string"===typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Cn(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),gc.register(t)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yc(t){const e=ya(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return pa.runKernel(z,t)}{const t={x:e};return pa.runKernel(f,t)}}const vc=wa({abs_:yc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xc(t){const e=ya(t,"x","acos"),n={x:e};return pa.runKernel(m,n)}const wc=wa({acos_:xc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kc(t){const e=ya(t,"x","acosh"),n={x:e};return pa.runKernel(g,n)}const Sc=wa({acosh_:kc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oc(t){Cn(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),Cn(t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+t.length);const e=t.map((t,e)=>ya(t,"tensors"+e,"addN")),n=e[0];e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!An(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return pa.runKernel(y,r)}wa({addN_:Oc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _c(t,e=null,n=!1){const r=ya(t,"x","all","bool"),a={x:r},i={axis:e,keepDims:n};return pa.runKernel(v,a,i)}const Cc=wa({all_:_c});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tc(t,e=null,n=!1){const r=ya(t,"x","any","bool"),a={x:r},i={axis:e,keepDims:n};return pa.runKernel(x,a,i)}const Ic=wa({any_:Tc});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nc(t,e=0){const n=ya(t,"x","argMax"),r={x:n},a={axis:e};return pa.runKernel(w,r,a)}const Ec=wa({argMax_:Nc});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ac(t,e=0){const n=ya(t,"x","argMin"),r={x:n},a={axis:e};return pa.runKernel(k,r,a)}const Rc=wa({argMin_:Ac});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jc(t){const e=ya(t,"x","asin"),n={x:e};return pa.runKernel(S,n)}const Dc=wa({asin_:jc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fc(t){const e=ya(t,"x","asinh"),n={x:e};return pa.runKernel(O,n)}const Mc=wa({asinh_:Fc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pc(t){const e=ya(t,"x","atan"),n={x:e};return pa.runKernel(_,n)}const $c=wa({atan_:Pc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(t,e){let n=ya(t,"a","atan2"),r=ya(e,"b","atan2");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(T,a)}const Bc=wa({atan2_:Lc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zc(t){const e=ya(t,"x","atanh"),n={x:e};return pa.runKernel(C,n)}const Wc=wa({atanh_:zc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vc(t,e,n,r,a){const i=ya(t,"x","avgPool","float32"),o=1;Cn(vi(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let s=i,u=!1;3===i.rank&&(u=!0,s=Ka(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Cn(4===s.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`),xi("avgPool",r,a);const c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let d=pa.runKernel(I,c,l);return d=Sa(d,i.dtype),u?Ka(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Uc=wa({avgPool_:Vc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gc(t,e,n,r,a,i="NDHWC"){const o=ya(t,"x","avgPool3d","float32");let s=o,u=!1;4===o.rank&&(u=!0,s=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Cn(5===s.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`),Cn("NDHWC"===i,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i),xi("avgPool3d",r,a);const c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let d=pa.runKernel(E,c,l);return d=Sa(d,s.dtype),u?Ka(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}wa({avgPool3d_:Gc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hc(t,e=0){Cn(t.length>=1,()=>"Pass at least one tensor to concat");const n=va(t,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach(t=>{if("complex64"!==t.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${t.dtype}. `)}),1===n.length)return Vi(n[0]);const r=n,a={axis:e};return pa.runKernel(W,r,a)}const qc=wa({concat_:Hc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kc(t){const e=ya(t,"x","sigmoid","float32"),n={x:e};return pa.runKernel(Be,n)}const Xc=wa({sigmoid_:Kc});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yc(t){const e=ya(t,"x","tanh","float32"),n={x:e};return pa.runKernel(sn,n)}const Jc=wa({tanh_:Yc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zc(t,e,n,r,a,i){const o=ya(t,"forgetBias","basicLSTMCell"),s=ya(e,"lstmKernel","basicLSTMCell"),u=ya(n,"lstmBias","basicLSTMCell"),c=ya(r,"data","basicLSTMCell"),l=ya(a,"c","basicLSTMCell"),d=ya(i,"h","basicLSTMCell"),h=qc([c,d],1),p=Ii(h,s),f=ii(p,u),m=f.shape[0],g=f.shape[1]/4,b=[m,g],y=Us(f,[0,0],b),v=Us(f,[0,g],b),x=Us(f,[0,2*g],b),w=Us(f,[0,3*g],b),k=ii(_a(Xc(y),Jc(v)),_a(l,Xc(ii(o,x)))),S=_a(Jc(k),Xc(w));return[k,S]}wa({basicLSTMCell_:Zc});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qc(t,e,n){const r=ya(t,"x","batchToSpaceND"),a=e.reduce((t,e)=>t*e);Cn(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),Cn(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),Cn(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const i={x:r},o={blockShape:e,crops:n};return pa.runKernel(j,i,o)}const tl=wa({batchToSpaceND_:Qc});function el(t){let e;return e=0===t.rank||1===t.rank?Ka(t,[1,1,1,t.size]):2===t.rank?Ka(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Ka(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nl(t,e,n,r,a,i){null==i&&(i=.001);const o=ya(t,"x","batchNorm"),s=ya(e,"mean","batchNorm"),u=ya(n,"variance","batchNorm");let c,l;null!=a&&(c=ya(a,"scale","batchNorm")),null!=r&&(l=ya(r,"offset","batchNorm")),Cn(s.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Cn(null==l||s.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Cn(null==c||s.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d=el(o),h={x:d,scale:c,offset:l,mean:s,variance:u},p={varianceEpsilon:i},f=pa.runKernel(St,h,p);return Ka(f,o.shape)}const rl=wa({batchNorm_:nl});function al(t,e,n,r,a,i){const o=ya(t,"x","batchNorm"),s=ya(e,"mean","batchNorm"),u=ya(n,"variance","batchNorm");let c,l;return null!=a&&(c=ya(a,"scale","batchNorm")),null!=r&&(l=ya(r,"offset","batchNorm")),Cn(2===o.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+o.rank+"."),Cn(2===s.rank||1===s.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`),Cn(2===u.rank||1===u.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),null!=c&&Cn(2===c.rank||1===c.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),null!=l&&Cn(2===l.rank||1===l.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),rl(o,s,u,l,c,i)}wa({batchNorm2d_:al});function il(t,e,n,r,a,i){const o=ya(t,"x","batchNorm"),s=ya(e,"mean","batchNorm"),u=ya(n,"variance","batchNorm");let c,l;return null!=a&&(c=ya(a,"scale","batchNorm")),null!=r&&(l=ya(r,"offset","batchNorm")),Cn(3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+o.rank+"."),Cn(3===s.rank||1===s.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`),Cn(3===u.rank||1===u.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),null!=c&&Cn(3===c.rank||1===c.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),null!=l&&Cn(3===l.rank||1===l.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),rl(o,s,u,l,c,i)}wa({batchNorm3d_:il});function ol(t,e,n,r,a,i){const o=ya(t,"x","batchNorm"),s=ya(e,"mean","batchNorm"),u=ya(n,"variance","batchNorm");let c,l;return null!=a&&(c=ya(a,"scale","batchNorm")),null!=r&&(l=ya(r,"offset","batchNorm")),Cn(4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+o.rank+"."),Cn(4===s.rank||1===s.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`),Cn(4===u.rank||1===u.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),null!=c&&Cn(4===c.rank||1===c.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),null!=l&&Cn(4===l.rank||1===l.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),rl(o,s,u,l,c,i)}wa({batchNorm4d_:ol});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sl(t,e,n){const r=ya(t,"x","bincount"),a=ya(e,"weights","bincount");Cn("int32"===r.dtype,()=>"Error in bincount: input dtype must be int32, but got "+r.dtype),Cn(n>=0,()=>`size must be non-negative, but got ${n}.`),Cn(a.size===r.size||0===a.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: `+a.shape+".");const i={x:r,weights:a},o={size:n};return pa.runKernel(D,i,o)}const ul=wa({bincount_:sl});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cl(t,e){const n=ya(t,"s0","broadcastArgs","int32"),r=ya(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). Has rank "+n.rank);if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). Has rank "+r.rank);const a={s0:n,s1:r};return pa.runKernel(M,a)}wa({broadcastArgs_:cl});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ll(t,e="float32",n){return e=e||"float32",Zn(t),new zr(t,e,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dl(t){const e=ya(t,"x","ceil","float32"),n={x:e};return pa.runKernel($,n)}const hl=wa({ceil_:dl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pl(t,e,n){const r={shape:t,value:e,dtype:n};return pa.runKernel(vt,{},r)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fl(t,e,n){const r=ya(t,"x","clipByValue");if(Cn(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return pl(r.shape,e,r.dtype);const a={x:r},i={clipValueMin:e,clipValueMax:n};return pa.runKernel(L,a,i)}const ml=wa({clipByValue_:fl});function gl(t){return qc(t,0)}wa({concat1d_:gl});function bl(t,e){return qc(t,e)}wa({concat2d_:bl});function yl(t,e){return qc(t,e)}wa({concat3d_:yl});function vl(t,e){return qc(t,e)}wa({concat4d_:vl});function xl(t,e,n,r,a="NWC",i=1,o){const s=ya(t,"x","conv1d"),u=ya(e,"filter","conv1d");let c=s,l=!1;2===s.rank&&(l=!0,c=Ka(s,[1,s.shape[0],s.shape[1]])),Cn(3===c.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),Cn(3===u.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."),xi("conv1d",r,o),Cn(c.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`),Cn(vi(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),Cn("NWC"===a,()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=Ka(u,[1,u.shape[0],u.shape[1],u.shape[2]]),h=Ka(c,[c.shape[0],1,c.shape[1],c.shape[2]]),p=[1,n],f=[1,i],m="NHWC",g=io(h,d,p,r,m,f,o);return Ka(g,l?[g.shape[2],g.shape[3]]:[g.shape[0],g.shape[2],g.shape[3]])}const wl=wa({conv1d_:xl});function kl(t,e,n,r,a,i){const o=ya(t,"x","conv2dTranspose"),s=ya(e,"filter","conv2dTranspose");return no(n,o,s,r,a,"NHWC",i)}const Sl=wa({conv2dTranspose_:kl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ol(t,e,n,r,a="NDHWC",i=[1,1,1]){const o=ya(t,"x","conv3d"),s=ya(e,"filter","conv3d");let u=o,c=!1;4===o.rank&&(c=!0,u=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Cn(5===u.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),Cn(5===s.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."),Cn(u.shape[4]===s.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${s.shape[3]}.`),Cn(vi(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Cn("NDHWC"===a,()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`);const l={x:u,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:i},h=pa.runKernel(H,l,d);return c?Ka(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}wa({conv3d_:Ol});function _l(t,e,n,r,a){const i=ya(t,"x","conv3dTranspose"),o=ya(e,"filter","conv3dTranspose");return lo(n,i,o,r,a)}wa({conv3dTranspose_:_l});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cl(t){const e=ya(t,"x","cos","float32"),n={x:e};return pa.runKernel(X,n)}const Tl=wa({cos_:Cl});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Il(t){const e=ya(t,"x","cosh","float32"),n={x:e};return pa.runKernel(Y,n)}const Nl=wa({cosh_:Il});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(t,e=0,n=!1,r=!1){const a=ya(t,"x","cumprod"),i={x:a},o={axis:e,exclusive:n,reverse:r};return pa.runKernel(J,i,o)}const Al=wa({cumprod_:El});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rl(t,e,n,r=!1){const a=ya(t,"x","denseBincount"),i=ya(e,"weights","denseBincount");Cn("int32"===a.dtype,()=>"Error in denseBincount: input dtype must be int32, but got "+a.dtype),Cn(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),Cn(n>=0,()=>`size must be non-negative, but got ${n}.`),Cn(i.size===a.size||0===i.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: `+i.shape+".");const o={x:a,weights:i},s={size:n,binaryOutput:r};return pa.runKernel(tt,o,s)}wa({denseBincount_:Rl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jl(t,e,n="NHWC"){const r=ya(t,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];Cn(e>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+e),Cn(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${e}  for depthToSpace with input shape\n    ${r.shape}`),Cn(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${e} for depthToSpace with input shape\n        ${r.shape}`),Cn(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const s={x:r},u={blockSize:e,dataFormat:n};return pa.runKernel(et,s,u)}const Dl=wa({depthToSpace_:jl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fl(t,e,n,r,a="NHWC",i=[1,1],o){const s=ya(t,"x","depthwiseConv2d","float32"),u=ya(e,"filter","depthwiseConv2d","float32");let c=s,l=!1;3===s.rank&&(l=!0,c=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Cn(4===c.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),Cn(4===u.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+".");const d="NHWC"===a?c.shape[3]:c.shape[1];Cn(d===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${u.shape[2]}.`),xi("depthwiseConv2d",r,o);const h={x:c,filter:u},p={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},f=pa.runKernel(nt,h,p);return l?Ka(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Ml=wa({depthwiseConv2d_:Fl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pl(t){const e=ya(t,"x","diag"),n={x:e};return pa.runKernel(it,n)}wa({diag_:Pl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(t,e,n,r,a=[1,1],i="NHWC"){const o=ya(t,"x","dilation2d"),s=ya(e,"filter","dilation2d");Cn(3===o.rank||4===o.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+o.rank+"."),Cn(3===s.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+s.rank+"."),Cn("NHWC"===i,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+i);let u=o,c=!1;3===o.rank&&(u=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=!0);const l={x:u,filter:s},d={strides:n,pad:r,dilations:a},h=pa.runKernel(ot,l,d);return c?Ka(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Ll=wa({dilation2d_:$l});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(t,e){let n=ya(t,"a","div"),r=ya(e,"b","div");[n,r]=ra(n,r);const a=Ra(n,r),i=ti(a),o=Cs(r,i);return qi(o,i,a)}const zl=wa({divNoNan_:Bl});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wl(t,e){const n=ya(t,"t1","dot"),r=ya(e,"t2","dot");Cn((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(Cn(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),1===n.rank&&1===r.rank){const t=Ka(n,[1,-1]),e=Ka(r,[-1,1]),a=Ii(t,e);return Ka(a,[])}if(1===n.rank&&2===r.rank){const t=Ka(n,[1,-1]),e=Ka(r,[r.shape[0],r.shape[1]]),a=Ii(t,e);return Ka(a,[a.size])}if(2===n.rank&&1===r.rank){const t=Ka(r,[-1,1]),e=Ii(n,t);return Ka(e,[e.size])}{const t=Ka(r,[r.shape[0],r.shape[1]]),e=Ii(n,t);return e}}const Vl=wa({dot_:Wl});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(t,...e){const n=e.map((t,e)=>ya(t,"tensors"+e,"einsum")),r={equation:t};return pa.runKernel(lt,n,r)}wa({einsum_:Ul});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gl(t){const e=ya(t,"x","elu","float32"),n={x:e};return pa.runKernel(dt,n)}const Hl=wa({elu_:Gl});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(t){let e=ya(t,"x","erf");Cn("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=Sa(e,"float32"));const n={x:e};return pa.runKernel(pt,n)}const Kl=wa({erf_:ql});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(t,e=null,n=!1){const r=ya(t,"x","max"),a={x:r},i={reductionIndices:e,keepDims:n};return pa.runKernel(Gt,a,i)}const Yl=wa({max_:Xl});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jl(t,e=null,n=!1){const r=ya(t,"x","min"),a={x:r},i={axis:e,keepDims:n};return pa.runKernel(Qt,a,i)}const Zl=wa({min_:Jl});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ql(t,e="euclidean",n=null,r=!1){t=ya(t,"x","norm");const a=td(t,e,n);let i=a.shape;if(r){const e=Dn(n,t.shape);i=ko(a.shape,e)}return Ka(a,i)}function td(t,e,n=null){if(0===t.rank)return vc(t);if(1!==t.rank&&null===n)return td(Ka(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return Ya(vc(t),n);if(e===1/0)return Yl(vc(t),n);if(e===-1/0)return Zl(vc(t),n);if("euclidean"===e||2===e)return $a(Ya(ou(vc(t),Ma(2,"int32")),n));throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(n)&&2===n.length){if(1===e)return Yl(Ya(vc(t),n[0]),n[1]-1);if(e===1/0)return Yl(Ya(vc(t),n[1]),n[0]);if(e===-1/0)return Zl(Ya(vc(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return $a(Ya(Ba(t),n));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+n)}const ed=wa({norm_:Ql});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nd(t,e=null,n=!1){return ed(t,"euclidean",e,n)}const rd=wa({euclideanNorm_:nd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ad(t,e=0){const n=ya(t,"x","expandDims","string_or_numeric");Cn(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:e};return pa.runKernel(gt,r,a)}const id=wa({expandDims_:ad});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(t){const e=ya(t,"x","expm1"),n={x:e};return pa.runKernel(bt,n)}const sd=wa({expm1_:od});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ud(t,e,n,r="float32"){null==e&&(e=t);const a=ll([t,e],r),i=t<=e?t:e;for(let s=0;s<i;++s)a.set(1,s,s);const o=Ka(a.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return as(id(o,0),[n[0],1,1]);if(2===n.length)return as(id(id(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return as(id(id(id(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const cd=wa({eye_:ud});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ld(t,e,n=0,r=0){const a=ya(t,"x","gather"),i=ya(e,"indices","gather","int32"),o={x:a,indices:i},s={axis:n,batchDims:r};return pa.runKernel(Ot,o,s)}const dd=wa({gather_:ld});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hd(t){const e=ya(t,"x","isFinite"),n={x:e};return pa.runKernel(At,n)}const pd=wa({isFinite_:hd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fd(t){const e=ya(t,"x","isInf"),n={x:e};return pa.runKernel(Rt,n)}const md=wa({isInf_:fd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(t){const e=ya(t,"x","isNaN"),n={x:e};return pa.runKernel(jt,n)}const bd=wa({isNaN_:gd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yd(t,e=.2){const n=ya(t,"x","leakyRelu"),r={x:n},a={alpha:e};return pa.runKernel(Dt,r,a)}const vd=wa({leakyRelu_:yd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xd(t,e=5,n=1,r=1,a=.5){const i=ya(t,"x","localResponseNormalization");Cn(4===i.rank||3===i.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${i.rank}.`),Cn(Rn(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,s=!1;3===i.rank&&(s=!0,o=Ka(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const u={x:o},c={depthRadius:e,bias:n,alpha:r,beta:a},l=pa.runKernel(Vt,u,c);return s?Ka(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const wd=wa({localResponseNormalization_:xd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kd(t){const e=ya(t,"x","log1p"),n={x:e};return pa.runKernel($t,n)}const Sd=wa({log1p_:kd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Od(t,e){Cn(Hn(t),()=>"The f passed in variableGrads(f) must be a function"),Cn(null==e||Array.isArray(e)&&e.every(t=>t instanceof Xr),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in pa.registeredVariables)e.push(pa.registeredVariables[t])}const r=n?e.filter(t=>!t.trainable):null,a=e.length;e=e.filter(t=>t.trainable),Cn(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const i=!0,{value:o,grads:s}=pa.gradients(t,e,null,i);Cn(s.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Cn(0===o.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const u={};return e.forEach((t,e)=>{null!=s[e]&&(u[t.name]=s[e])}),null!=r&&r.forEach(t=>u[t.name]=null),{value:o,grads:u}}function _d(t){return pa.customGrad(t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Cd(t){const e=ya(t,"x","softplus"),n={x:e};return pa.runKernel(ze,n)}const Td=wa({softplus_:Cd});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Id(t){const e=ya(t,"x","logSigmoid"),n=_d(t=>{const e=Da(Td(Da(t))),n=e=>{const n=_a(e,Xc(Da(t)));return n};return{value:e,gradFunc:n}});return n(e)}const Nd=wa({logSigmoid_:Id});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ed(t,e=-1){const n=ya(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);const r=_d((t,n)=>{const r=!0,a=Yl(t,e,!0),i=Wa(t,a),o=Wa(Sa(i,"float32"),au(Ya(Ko(i),e,r)));n([o]);const s=(t,n)=>{const[r]=n,a=!0,i=Ko(r);return Wa(t,_a(Ya(t,e,a),i))};return{value:o,gradFunc:s}});return r(n)}const Ad=wa({logSoftmax_:Ed});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rd(t,e=null,n=!1){const r=ya(t,"x","logSumExp"),a=Dn(e,r.shape),i=Yl(r,a,!0),o=Wa(r,i),s=Ko(o),u=Ya(s,a),c=au(u),l=ii(Ka(i,c.shape),c);if(n){const t=ko(l.shape,a);return Ka(l,t)}return l}const jd=wa({logSumExp_:Rd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(t){const e=ya(t,"x","logicalNot","bool"),n={x:e};return pa.runKernel(Bt,n)}const Fd=wa({logicalNot_:Dd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Md(t,e){const n=ya(t,"a","logicalOr","bool"),r=ya(e,"b","logicalOr","bool");Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(zt,a)}const Pd=wa({logicalOr_:Md});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $d(t,e){const n=ya(t,"a","logicalXor","bool"),r=ya(e,"b","logicalXor","bool");return Ha(n.shape,r.shape),zi(Pd(t,e),Fd(zi(t,e)))}const Ld=wa({logicalXor_:$d}),Bd=2147483648;
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zd(t,e,n="left"){const r=ya(t,"sortedSequence","searchSorted"),a=ya(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=Ka(r,[-1,i]),u=Ka(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(En(u.shape)>=Bd)throw new Error("values tensor size must less than "+Bd);if(s.shape[1]>=Bd)throw new Error(`trailing dim_size must less than ${Bd} for int32 output type, was ${s.shape[1]}`);const c={sortedSequence:s,values:u},l={side:n};return pa.runKernel(je,c,l)}wa({searchSorted_:zd});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wd(t,e,n,r,a){const i=ya(t,"x","maxPool"),o=1;let s=i,u=!1;3===i.rank&&(u=!0,s=Ka(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Cn(4===s.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`),Cn(vi(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),xi("maxPool",r,a);const c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=pa.runKernel(qt,c,l);return u?Ka(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Vd=wa({maxPool_:Wd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ud(t,e=[1,1,1],n,r,a,i="NDHWC"){const o=ya(t,"x","maxPool3d");let s=o,u=!1;4===o.rank&&(u=!0,s=Ka(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Cn(5===s.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`),Cn("NDHWC"===i,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i),xi("maxPool3d",r,a);const c={x:s},l={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=pa.runKernel(Xt,c,l);return u?Ka(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}wa({maxPool3d_:Ud});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gd(t,e,n,r,a=!1){const i=ya(t,"x","maxPoolWithArgmax"),o={x:i},s={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},u=pa.runKernel(Jt,o,s);return{result:u[0],indexes:u[1]}}wa({maxPoolWithArgmax_:Gd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hd(t,e){let n=ya(t,"a","maximum"),r=ya(e,"b","maximum");[n,r]=ra(n,r),"bool"===n.dtype&&(n=Sa(n,"int32"),r=Sa(r,"int32")),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(Ht,a)}const qd=wa({maximum_:Hd});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kd(t,e=null,n=!1){const r=ya(t,"x","mean"),a={x:r},i={axis:e,keepDims:n};return pa.runKernel(Zt,a,i)}const Xd=wa({mean_:Kd});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Yd(t,e){let n=ya(t,"a","minimum"),r=ya(e,"b","minimum");[n,r]=ra(n,r),"bool"===n.dtype&&(n=Sa(n,"int32"),r=Sa(r,"int32")),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(te,a)}const Jd=wa({minimum_:Yd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zd(t,e,n){Cn("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=ya(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Cn(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a="reflect"===n?1:0;for(let s=0;s<r.rank;s++)Cn(2===e[s].length,()=>"Invalid number of paddings. Must be length of 2 each."),Cn(e[s][0]>=0&&e[s][0]<=r.shape[s]-a&&e[s][1]>=0&&e[s][1]<=r.shape[s]-a,()=>`Padding in dimension ${s} cannot be greater than or equal to ${r.shape[s]-a} or less than 0 for input of shape `+r.shape);const i={paddings:e,mode:n},o={x:r};return pa.runKernel(ee,o,i)}const Qd=wa({mirrorPad_:Zd});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function th(t,e){let n=ya(t,"a","mod"),r=ya(e,"b","mod");[n,r]=ra(n,r);const a={a:n,b:r};return pa.runKernel(ne,a)}const eh=wa({mod_:th});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nh(t,e=null,n=!1){t=ya(t,"x","moments");const r=Dn(e,t.shape),a=Xd(t,r,n);let i=a.shape;n||(i=ko(a.shape,r));const o=Ba(Wa(Sa(t,"float32"),Ka(a,i))),s=Xd(o,r,n);return{mean:a,variance:s}}wa({moments_:nh});function rh(t,e,n,r){const a=ya(e,"data","multiRNNCell"),i=va(n,"c","multiRNNCell"),o=va(r,"h","multiRNNCell");let s=a;const u=[];for(let d=0;d<t.length;d++){const e=t[d](s,i[d],o[d]);u.push(e[0]),u.push(e[1]),s=e[1]}const c=[],l=[];for(let d=0;d<u.length;d+=2)c.push(u[d]),l.push(u[d+1]);return[c,l]}wa({multiRNNCell_:rh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ah(t,e,n,r=!1){const a=ya(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();const s=1===o?Ka(a,[1,-1]):a,u={logits:s},c={numSamples:e,seed:n,normalized:r},l=pa.runKernel(re,u,c);return 1===o?Ka(l,[l.size]):l}wa({multinomial_:ah});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ih(t,e){let n=ya(t,"a","notEqual","string_or_numeric"),r=ya(e,"b","notEqual","string_or_numeric");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r};return pa.runKernel(oe,a)}const oh=wa({notEqual_:ih});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(t){const e=ya(t,"x","onesLike"),n={x:e};return pa.runKernel(le,n)}const uh=wa({onesLike_:sh});function ch(t,e){const n=ya(t,"v1","outerProduct"),r=ya(e,"v2","outerProduct");Cn(1===n.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const a=Ka(n,[-1,1]),i=Ka(r,[1,-1]);return Ii(a,i)}wa({outerProduct_:ch});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lh(t,e,n=0){const r=ya(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},i={x:r};return pa.runKernel(pe,i,a)}const dh=wa({pad_:lh});function hh(t,e,n=0){return Cn(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),dh(t,[e],n)}wa({pad1d_:hh});function ph(t,e,n=0){return Cn(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),dh(t,e,n)}wa({pad2d_:ph});function fh(t,e,n=0){return Cn(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),dh(t,e,n)}wa({pad3d_:fh});function mh(t,e,n=0){return Cn(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),dh(t,e,n)}wa({pad4d_:mh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gh(t,e,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");const s=ya(t,"x","maxPool");let u=s,c=!1;3===s.rank&&(c=!0,u=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Cn(vi(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);const l=li(u.shape,e,i,a,r),d=[l.dilationHeight,l.dilationWidth];let h;h="same"===r?yh([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[f,m]=bh([l.inHeight,l.inWidth],d,h),g=p?r:"valid",b=p?u:Ai(u,d,f),y="avg"===n?()=>Uc(b,e,i,g,o):()=>Vd(b,e,i,g,o),v=y(),x=p?v:tl(v,d,m);return c?Ka(x,[x.shape[1],x.shape[2],x.shape[3]]):x}function bh(t,e,n){const r=n.map(t=>t[0]),a=n.map(t=>t[1]),i=t.concat(r,a),o=e.map((t,e)=>(t-i[e]%t)%t),s=a.map((t,e)=>t+o[e]),u=e.map((t,e)=>[r[e],s[e]]),c=e.map((t,e)=>[0,o[e]]);return[u,c]}function yh(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)),r=n.map(t=>t-1),a=r.map(t=>Math.floor(t/2)),i=r.map((t,e)=>t-a[e]);return r.map((t,e)=>[a[e],i[e]])}const vh=wa({pool_:gh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xh(t,e){const n=ya(t,"x","prelu"),r=ya(e,"alpha","prelu"),a={x:n,alpha:r};return pa.runKernel(me,a)}const wh=wa({prelu_:xh});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kh(t,e=null,n=!1){let r=ya(t,"x","prod");"bool"===r.dtype&&(r=Sa(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return pa.runKernel(ge,a,i)}const Sh=wa({prod_:kh});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(t,e,n,r){const a=t.map((t,e)=>ya(t,"tensors"+e,"raggedGather","int32")),i=ya(e,"paramsDenseValues","raggedGather"),o=ya(n,"indices","raggedGather","int32"),s={paramsNestedSplits:a,paramsDenseValues:i,indices:o},u={outputRaggedRank:r},c=pa.runKernel(be,s,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}wa({raggedGather_:Oh});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _h(t,e,n,r,a){const i=ya(t,"shape","raggedTensorToTensor","int32"),o=ya(e,"values","raggedTensorToTensor"),s=ya(n,"defaultValue","raggedTensorToTensor",o.dtype),u=r.map((t,e)=>ya(t,"tensors"+e,"raggedTensorToTensor","int32")),c={shape:i,values:o,defaultValue:s,rowPartitionTensors:u},l={rowPartitionTypes:a};return pa.runKernel(ye,c,l)}wa({raggedTensorToTensor_:_h});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ch(t,e,n){const r=En(t);let a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(let i=0;i<r;i++)a[i]=e();return pa.makeTensor(a,t,n)}wa({rand_:Ch});var Th="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:{};function Ih(t,e){return e={exports:{}},t(e,e.exports),e.exports}var Nh=Ih((function(t){(function(t,e,n){function r(t){var e=this,n=o();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=n(" "),e.s1=n(" "),e.s2=n(" "),e.s0-=n(t),e.s0<0&&(e.s0+=1),e.s1-=n(t),e.s1<0&&(e.s1+=1),e.s2-=n(t),e.s2<0&&(e.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new r(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}function o(){var t=4022871197,e=function(e){e=String(e);for(var n=0;n<e.length;n++){t+=e.charCodeAt(n);var r=.02519603282416938*t;t=r>>>0,r-=t,r*=t,t=r>>>0,r-=t,t+=4294967296*r}return 2.3283064365386963e-10*(t>>>0)};return e}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.alea=i})(0,t,!1)})),Eh=Ih((function(t){(function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xor128=i})(0,t,!1)})),Ah=Ih((function(t){(function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xorwow=i})(0,t,!1)})),Rh=Ih((function(t){(function(t,e,n){function r(t){var e=this;function n(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;while(r.length<8)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],t^=t>>>7,n=t^t<<24,t=r[a+1&7],n^=t^t>>>10,t=r[a+3&7],n^=t^t>>>3,t=r[a+4&7],n^=t^t<<7,t=r[a+7&7],t^=t<<13,n^=t^t<<9,r[a]=n,e.i=a+1&7,n},n(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xorshift7=i})(0,t,!1)})),jh=Ih((function(t){(function(t,e,n){function r(t){var e=this;function n(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,n=s[127&i]^=r+o,a=0==n?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},n(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xor4096=i})(0,t,!1)})),Dh=Ih((function(t){(function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.tychei=i})(0,t,!1)})),Fh=Ih((function(t){(function(e,r,a){var i,o=256,s=6,u=52,c="random",l=a.pow(o,s),d=a.pow(2,u),h=2*d,p=o-1;function f(t,e,n){var i=[];e=1==e?{entropy:!0}:e||{};var u=y(b(e.entropy?[t,x(r)]:null==t?v():t,3),i),p=new m(i),f=function(){var t=p.g(s),e=l,n=0;while(t<d)t=(t+n)*o,e*=o,n=p.g(1);while(t>=h)t/=2,e/=2,n>>>=1;return(t+n)/e};return f.int32=function(){return 0|p.g(4)},f.quick=function(){return p.g(4)/4294967296},f.double=f,y(x(p.S),r),(e.pass||n||function(t,e,n,r){return r&&(r.S&&g(r,p),t.state=function(){return g(p,{})}),n?(a[c]=t,e):t})(f,u,"global"in e?e.global:this==a,e.state)}function m(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];n||(t=[n++]);while(a<o)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=p&i+t[a%n]+(e=s[a])],s[i]=e;(r.g=function(t){var e,n=0,a=r.i,i=r.j,s=r.S;while(t--)e=s[a=p&a+1],n=n*o+s[p&(s[a]=s[i=p&i+e])+(s[i]=e)];return r.i=a,r.j=i,n})(o)}function g(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function b(t,e){var n,r=[],a=typeof t;if(e&&"object"==a)for(n in t)try{r.push(b(t[n],e-1))}catch(i){}return r.length?r:"string"==a?t:t+"\0"}function y(t,e){var n,r=t+"",a=0;while(a<r.length)e[p&a]=p&(n^=19*e[p&a])+r.charCodeAt(a++);return x(e)}function v(){try{var t;return i&&(t=i.randomBytes)?t=t(o):(t=new Uint8Array(o),(e.crypto||e.msCrypto).getRandomValues(t)),x(t)}catch(s){var n=e.navigator,a=n&&n.plugins;return[+new Date,e,a,e.screen,x(r)]}}function x(t){return String.fromCharCode.apply(0,t)}if(y(a.random(),r),t.exports){t.exports=f;try{i=n(7)}catch(w){}}else a["seed"+c]=f})("undefined"!==typeof self?self:Th,[],Math)}));Fh.alea=Nh,Fh.xor128=Eh,Fh.xorwow=Ah,Fh.xorshift7=Rh,Fh.xor4096=jh,Fh.tychei=Dh;var Mh=Fh,Ph=Mh.alea;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class $h{constructor(t,e,n,r,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=a||Math.random();this.random=Ph(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;while(!n){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);const o=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Lh{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const a=r||Math.random();this.randu=Ph(a.toString()),this.randn=new $h(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,a,i;while(1){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-i+Math.log(i)),a=this.randu(),a<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Bh{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Ph(r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zh(t,e,n=1,r="float32",a){if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);const i=new Lh(e,n,r,a),o=ll(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}wa({randomGamma_:zh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wh(t,e=0,n=1,r,a){if(null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);const i=new $h(e,n,r,!1,a),o=ll(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const Vh=wa({randomNormal_:Wh});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uh(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type "+e);return Vh(t,0,1,e,n)}wa({randomStandardNormal_:Uh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gh(t,e=0,n=1,r="float32",a){const i=ll(t,r),o=new Bh(e,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}const Hh=wa({randomUniform_:Gh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return pa.runKernel(ve,{},a)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kh(t){const e=ya(t,"x","reciprocal"),n={x:e};return pa.runKernel(we,n)}const Xh=wa({reciprocal_:Kh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yh(t){const e=ya(t,"x","relu"),n={x:e};return pa.runKernel(ke,n)}const Jh=wa({relu_:Yh});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(t){const e=ya(t,"x","relu6"),n={x:e};return pa.runKernel(Ie,n)}const Qh=wa({relu6_:Zh});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tp(t,e){const n=ya(t,"x","reverse"),r={x:n},a={dims:e};return pa.runKernel(Ne,r,a)}const ep=wa({reverse_:tp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function np(t){const e=ya(t,"x","reverse");return Cn(1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),ep(e,0)}wa({reverse1d_:np});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rp(t,e){const n=ya(t,"x","reverse");return Cn(2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),ep(n,e)}wa({reverse2d_:rp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ap(t,e){const n=ya(t,"x","reverse");return Cn(3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),ep(n,e)}wa({reverse3d_:ap});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ip(t,e){const n=ya(t,"x","reverse");return Cn(4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),ep(n,e)}wa({reverse4d_:ip});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function op(t){const e=ya(t,"x","round"),n={x:e};return pa.runKernel(Ee,n)}const sp=wa({round_:op});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function up(t){const e=ya(t,"x","selu"),n={x:e};return pa.runKernel(Fe,n)}const cp=wa({selu_:up});function lp(t,e,n,r,a,i=[1,1],o="NHWC"){const s=ya(t,"x","separableConv2d"),u=ya(e,"depthwiseFilter","separableConv2d"),c=ya(n,"pointwiseFilter","separableConv2d");let l=s,d=!1;if(3===s.rank&&(d=!0,l=Ka(s,[1,s.shape[0],s.shape[1],s.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Cn(4===l.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`),Cn(4===u.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),Cn(4===c.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),Cn(1===c.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),Cn(1===c.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=u.shape[2],p=u.shape[3];Cn(c.shape[2]===h*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${c.shape[2]}.`);const f=Ml(l,u,r,a,o,i),m=1,g=io(f,c,m,"valid",o);return d?Ka(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const dp=wa({separableConv2d_:lp});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function hp(t){const e=ya(t,"x","sign"),n={x:e};return pa.runKernel(Le,n)}const pp=wa({sign_:hp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fp(t,e,n){const r=ya(t,"x","slice1d");return Cn(1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Us(r,[e],[n])}wa({slice1d_:fp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mp(t,e,n){const r=ya(t,"x","slice2d");return Cn(2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Us(r,e,n)}wa({slice2d_:mp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gp(t,e,n){const r=ya(t,"x","slice3d");return Cn(3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Us(r,e,n)}wa({slice3d_:gp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t,e,n){const r=ya(t,"x","slice4d");return Cn(4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Us(r,e,n)}wa({slice4d_:bp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yp(t,e=-1){const n=ya(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},a={dim:e};return pa.runKernel(He,r,a)}const vp=wa({softmax_:yp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xp(t){Cn("complex64"===t.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return pa.runKernel(yt,e)}const wp=wa({fft_:xp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kp(t){Cn("complex64"===t.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return pa.runKernel(Nt,e)}const Sp=wa({ifft_:kp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=Ka(t,[n,e]);r=Sp(a)}else{const a=[n,2*(e-1)],i=Ka(Mo(t),[n,e]),o=Ka(Do(t),[n,e]),s=ep(Us(i,[0,1],[n,e-2]),1),u=_a(ep(Us(o,[0,1],[n,e-2]),1),Ma(-1)),c=qc([i,s],1),l=qc([o,u],1),d=Ka(Ro(c,l),[a[0],a[1]]);r=Sp(d)}if(r=Mo(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=Ka(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}const _p=wa({irfft_:Op});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cp(t,e){Cn("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got "+t.dtype);let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(null!=e&&e<n){const r=t.shape.map(t=>0),i=t.shape.map(t=>t);i[t.shape.length-1]=e,a=Us(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,a=qc([t,$s(r)],t.shape.length-1),n=e}else a=t;const i=ti(a),o=Ka(Ro(a,i),[r,n]),s=wp(o),u=Math.floor(n/2)+1,c=Mo(s),l=Do(s),d=Ji(c,[u,n-u],c.shape.length-1),h=Ji(l,[u,n-u],l.shape.length-1),p=a.shape.slice();return p[a.shape.length-1]=u,Ka(Ro(d[0],h[0]),p)}const Tp=wa({rfft_:Cp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ip(t,e){let n=ya(t,"a","squaredDifference"),r=ya(e,"b","squaredDifference");[n,r]=ra(n,r),Ha(n.shape,r.shape);const a={a:n,b:r},i={};return pa.runKernel(Ze,a,i)}const Np=wa({squaredDifference_:Ip});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ep(t,e){const n=ya(t,"x","squeeze","string_or_numeric");return Ka(n,Fn(n.shape,e).newShape)}const Ap=wa({squeeze_:Ep});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rp(t,e=0){const n=va(t,"tensors","stack","string_or_numeric");Cn(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Cn(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:e};return pa.runKernel(he,r,a)}const jp=wa({stack_:Rp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dp(t,e,n,r,a=0,i=0,o=0,s=0,u=0){const c=ya(t,"x","stridedSlice","string_or_numeric"),l={x:c},d={begin:e,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:u};return pa.runKernel(tn,l,d)}const Fp=wa({stridedSlice_:Dp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mp(t){const e=ya(t,"x","tan","float32"),n={x:e};return pa.runKernel(on,n)}const Pp=wa({tan_:Mp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $p(t,e){In(t);const n=ma(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");const r=null;return Fa(t,r,n,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lp(t,e,n){if(In(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=ma(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fa(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Bp(t,e=1,n=!0){const r=ya(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got "+e);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got `+e);const i={x:r},o={k:e,sorted:n},[s,u]=pa.runKernel(cn,i,o);return{values:s,indices:u}}const zp=wa({topk_:Bp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wp(t,e=0,n=1,r,a){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new $h(e,n,r,!0,a),o=ll(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}wa({truncatedNormal_:Wp});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vp(t,e=0){const n=ya(t,"x","unique","string_or_numeric");Cn(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[i,o]=pa.runKernel(hn,r,a);return{values:i,indices:o}}const Up=wa({unique_:Vp});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gp(t,e,n,r,a=!0){const i=ya(t,"v","movingAverage"),o=ya(e,"x","movingAverage"),s=ya(n,"decay","movingAverage");aa(i,o),Cn(An(i.shape,o.shape),()=>"Shape mismatch in v and x");const u=Ma(1),c=Wa(u,s);let l=_a(Wa(o,i),c);if(a){Cn(null!=r,()=>"When using zeroDebias: true, step is required.");const t=ya(r,"step","movingAverage");l=Ra(l,Wa(u,ou(s,t)))}return ii(i,l)}wa({movingAverage_:Gp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t,e,n){const r=ya(t,"indices","scatterND","int32"),a=ya(e,"updates","scatterND");pc(a,r,n);const i={indices:r,updates:a},o={shape:n};return pa.runKernel(Re,i,o)}wa({scatterND_:Hp});function qp(t,e,n,r){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kp(t,e,n,r=0){const a=ya(t,"sparseIndices","sparseToDense","int32"),i=ya(e,"sparseValues","sparseToDense","string_or_numeric"),o=ya(r,"defaultValue","sparseToDense",i.dtype);qp(a,i,n,o);const s={sparseIndices:a,sparseValues:i,defaultValue:o},u={outputShape:n};return pa.runKernel(Je,s,u)}wa({sparseToDense_:Kp});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xp(t,e){const n=ya(e,"indices","gatherND","int32"),r=ya(t,"x","gatherND","string_or_numeric"),a={params:r,indices:n};return pa.runKernel(_t,a)}wa({gatherND_:Xp});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yp(t,e){if(null==e)return t.shape.slice();if(An(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jp(t,e,n,r){const a=ya(t,"x","dropout");if(Cn("float32"===a.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),Cn(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof qr?a.clone():a;const i=Yp(a,n),o=1-e,s=Ra(qs(ii(Hh(i,0,1,"float32",r),o)),o);return _a(a,s)}wa({dropout_:Jp});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zp(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Qp(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return $p(a,"float32")}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function tf(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return _a(t,Ta(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function ef(t,e){let n=e;const r=Ga(t.shape,e.shape);return r.length>0&&(n=Ya(n,r)),Ka(n,t.shape)}function nf(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Jh(t);if("elu"===e)return Hl(t);if("relu6"===e)return Qh(t);if("prelu"===e)return wh(t,n);if("leakyrelu"===e)return vd(t,r);if("sigmoid"===e)return Xc(t);throw new Error(`Unknown fused activation ${e}.`)}const rf=(t,e)=>{const n=t>0;return!n||"linear"===e};
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function af({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",!1===rf(pa.state.gradientDepth,u)){Cn("NHWC"===a,()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let d=io(t,e,n,r,a,i,o);return null!=s&&(d=ii(d,s)),nf(d,u,c,l)}const d=ya(t,"x","conv2d","float32"),h=ya(e,"filter","conv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=Ka(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Cn(4===p.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+p.rank+"."),Cn(4===h.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+h.rank+"."),xi("fused conv2d",r,o);const m="NHWC"===a?p.shape[3]:p.shape[1];Cn(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),Cn(vi(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const g=di(p.shape,h.shape,n,i,r,o);let b,y;if(null!=s&&(b=ya(s,"bias","fused conv2d"),[b]=ra(b,d),"NHWC"===a?Ha(g.outShape,b.shape):(Cn(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),Cn(0===b.shape.length||b.shape[0]===g.outChannels||1===b.shape[0],()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${g.outChannels})`))),null!=c){const t=c.shape;if(Cn(t.length<=1||3===t.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${t.length}.`),1===t.length)Cn(1===t[0]||t[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the number of output channels (${g.outChannels}).`);else if(3===t.length)try{Ha(t,g.outShape)}catch(k){const e=`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(e)}y=ya(c,"prelu weights","fused conv2d")}const v=(t,e)=>{Cn("NHWC"===a,()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[o,s,c,l]=e,d=tf(t,c,u);Cn(yi(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const h=no(s.shape,d,o,n,r),p=to(s,d,o.shape,n,r),f=[h,p];if(null!=l){const t=ef(l,d);f.push(t)}return f},x={x:p,filter:h,bias:b,preluActivationWeights:y},w={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:l};if(null==s){const t=_d((t,e,n)=>{let r=pa.runKernel(xn,x,w);return n([e,t,r]),f&&(r=Ka(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:v}});return t(p,h)}{const t=_d((t,e,n,r)=>{let a=pa.runKernel(xn,x,w);return r([e,t,a,n]),f&&(a=Ka(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:v}});return t(p,h,b)}}wa({fusedConv2d_:af});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function of({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(!1===rf(pa.state.gradientDepth,u)){let d=Ml(t,e,n,r,a,i,o);return null!=s&&(d=ii(d,s)),nf(d,u,c,l)}const d=ya(t,"x","depthwiseConv2d","float32"),h=ya(e,"filter","depthwiseConv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=Ka(d,[1,d.shape[0],d.shape[1],d.shape[2]])),Cn(4===p.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`),Cn(4===h.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),Cn(p.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),null==i&&(i=[1,1]),Cn(vi(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),xi("fused depthwiseConv2d",r,o);const m=di(p.shape,h.shape,n,i,r,o,!0);let g,b;null!=s&&(g=ya(s,"bias","fused conv2d"),[g]=ra(g,d),Ha(m.outShape,g.shape)),null!=c&&(b=ya(c,"prelu weights","fused depthwiseConv2d"));const y=(t,e)=>{Cn(yi(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[a,s,c,l]=e,d=tf(t,c,u),h=Vo(s.shape,d,a,n,r,i,o),p=zo(s,d,a.shape,n,r,i,o);if(null!=l){const t=ef(g,d);return[h,p,t]}return[h,p]},v={x:p,filter:h,bias:g,preluActivationWeights:b},x={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:u,leakyreluAlpha:l};if(null==s){const t=_d((t,e,n)=>{let r=pa.runKernel(wn,v,x);return n([e,t,r]),f&&(r=Ka(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:y}});return t(p,h)}{const t=_d((t,e,n,r)=>{let a=pa.runKernel(wn,v,x);return r([e,t,a,n]),f&&(a=Ka(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:y}});return t(p,h,g)}}wa({fusedDepthwiseConv2d_:of});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sf({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:s=.2}){if(!1===rf(pa.state.gradientDepth,i)){let u=Ii(t,e,n,r);return null!=a&&(u=ii(u,a)),nf(u,i,o,s)}let u=ya(t,"a","fused matMul"),c=ya(e,"b","fused matMul");[u,c]=ra(u,c);const l=n?u.shape[u.rank-2]:u.shape[u.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?u.shape[u.rank-1]:u.shape[u.rank-2],p=r?c.shape[c.rank-2]:c.shape[c.rank-1],f=u.shape.slice(0,-2),m=c.shape.slice(0,-2),g=En(f),b=En(m);Cn(l===d,()=>`Error in fused matMul: inner shapes (${l}) and (${d}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const y=Ha(u.shape.slice(0,-2),c.shape.slice(0,-2)),v=y.concat([h,p]),x=Ka(u,n?[g,l,h]:[g,h,l]),w=Ka(c,r?[b,p,d]:[b,d,p]);let k,S;null!=a&&(k=ya(a,"bias","fused matMul"),[k]=ra(k,u),Ha(v,k.shape)),null!=o&&(S=ya(o,"prelu weights","fused matMul"));const O=(t,e)=>{const[o,s,u,c]=e,l=tf(Ka(t,u.shape),u,i);let d,h;if(n||r?!n&&r?(d=Ii(l,s,!1,!1),h=Ii(l,o,!0,!1)):n&&!r?(d=Ii(s,l,!1,!0),h=Ii(o,l,!1,!1)):(d=Ii(s,l,!0,!0),h=Ii(l,o,!0,!0)):(d=Ii(l,s,!1,!0),h=Ii(o,l,!0,!1)),null!=a){const t=ef(c,l);return[d,h,t]}return[d,h]},_={a:x,b:w,bias:k,preluActivationWeights:S},C={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:s};if(null==a){const t=_d((t,e,n)=>{const r=pa.runKernel(vn,_,C);return n([t,e,r]),{value:Ka(r,v),gradFunc:O}});return t(x,w)}{const t=_d((t,e,n,r)=>{const a=pa.runKernel(vn,_,C);return r([t,e,a,n]),{value:Ka(a,v),gradFunc:O}});return t(x,w,k)}}wa({fusedMatMul_:sf});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uf(t){return Qp(t,.54,.46)}wa({hammingWindow_:uf});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cf(t){return Qp(t,.5,.5)}const lf=wa({hannWindow_:cf});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function df(t,e,n,r=!1,a=0){let i=0;const o=[];while(i+e<=t.size)o.push(Us(t,i,e)),i+=n;if(r)while(i<t.size){const r=i+e-t.size,s=qc([Us(t,i,e-r),pl([r],a)]);o.push(s),i+=n}return 0===o.length?Lp([],[0,e]):Ka(qc(o),[o.length,e])}const hf=wa({frame_:df});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pf(t,e,n,r,a=lf){null==r&&(r=Zp(e));const i=hf(t,e,n),o=_a(i,a(e));return Tp(o,r)}wa({stft_:pf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ff(t,e,n,r,a="bilinear",i=0){const o=ya(t,"image","cropAndResize"),s=ya(e,"boxes","cropAndResize","float32"),u=ya(n,"boxInd","cropAndResize","int32"),c=s.shape[0];Cn(4===o.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),Cn(2===s.rank&&4===s.shape[1],()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${s.shape}.`),Cn(1===u.rank&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${s.shape}.`),Cn(2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),Cn(r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was "+r),Cn("bilinear"===a||"nearest"===a,()=>"method must be bilinear or nearest, but was "+a);const l={image:o,boxes:s,boxInd:u},d={method:a,extrapolationValue:i,cropSize:r},h=pa.runKernel(Q,l,d);return h}wa({cropAndResize_:ff});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mf(t){const e=ya(t,"image","flipLeftRight","float32");Cn(4===e.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e},r=pa.runKernel(xt,n,{});return r}wa({flipLeftRight_:mf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gf(t){const e=ya(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];Cn(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),Cn(1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,as(e,a)}wa({grayscaleToRGB_:gf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bf(t,e,n=0,r=.5){const a=ya(t,"image","rotateWithOffset","float32");Cn(4===a.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const i={image:a},o={radians:e,fillValue:n,center:r},s=pa.runKernel(yn,i,o);return s}wa({rotateWithOffset_:bf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yf(t,e,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);const o=t.shape[0];return n=Math.min(n,o),Cn(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),Cn(2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),Cn(4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]),Cn(1===e.rank,()=>"scores must be a 1D tensor"),Cn(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was `+e.shape[0]),Cn(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vf(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=ya(t,"boxes","nonMaxSuppression","float32"),o=ya(e,"scores","nonMaxSuppression","float32"),s=yf(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return pa.runKernel(se,{boxes:i,scores:o},u)}wa({nonMaxSuppression_:vf});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xf(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=ya(t,"boxes","nonMaxSuppression"),s=ya(e,"scores","nonMaxSuppression"),u=yf(o,s,n,r,a,i);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma;const c={boxes:o,scores:s},l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},d=pa.runKernel(ce,c,l);return{selectedIndices:d[0],selectedScores:d[1]}}wa({nonMaxSuppressionWithScore_:xf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function wf(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=ya(t,"boxes","nonMaxSuppression"),s=ya(e,"scores","nonMaxSuppression"),u=yf(o,s,n,r,a,null),c=u.maxOutputSize,l=u.iouThreshold,d=u.scoreThreshold,h={boxes:o,scores:s},p={maxOutputSize:c,iouThreshold:l,scoreThreshold:d,padToMaxOutputSize:i},f=pa.runKernel(ue,h,p);return{selectedIndices:f[0],validOutputs:f[1]}}wa({nonMaxSuppressionPadded_:wf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function kf(t,e,n=!1,r=!1){const a=ya(t,"images","resizeBilinear");Cn(3===a.rank||4===a.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),Cn(2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."),Cn(!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=Ka(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,s={images:i},u={alignCorners:n,halfPixelCenters:r,size:e},c=pa.runKernel(Ce,s,u);return o?Ka(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const Sf=wa({resizeBilinear_:kf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Of(t,e,n=!1,r=!1){const a=ya(t,"images","resizeNearestNeighbor");Cn(3===a.rank||4===a.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),Cn(2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."),Cn("float32"===a.dtype||"int32"===a.dtype,()=>"`images` must have `int32` or `float32` as dtype"),Cn(!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;3===a.rank&&(o=!0,i=Ka(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,s={images:i},u={alignCorners:n,halfPixelCenters:r,size:e},c=pa.runKernel(Oe,s,u);return o?Ka(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const _f=wa({resizeNearestNeighbor_:Of});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cf(t,e="binary",n=!1,r=.5){const a=ya(t,"image","threshold"),i=.2989,o=.587,s=.114,u=a.shape[0]*a.shape[1];let c,l,d,h,p=_a($p([r]),255);if(Cn(3===a.rank,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),Cn(3===a.shape[2]||1===a.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),Cn("int32"===a.dtype||"float32"===a.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),Cn("otsu"===e||"binary"===e,()=>"Method must be binary or otsu, but was "+e),3===a.shape[2]){[c,l,d]=Ji(a,[1,1,1],-1);const t=_a(c,i),e=_a(l,o),n=_a(d,s);h=ii(ii(t,e),n)}else h=t;if("otsu"===e){const t=ul(Sa(sp(h),"int32"),du([]),256);p=Tf(t,u)}const f=n?Li(h,p):bs(h,p),m=Sa(_a(f,255),"int32");return m}function Tf(t,e){let n,r,a,i,o,s,u=$p([-1]),c=$p([0]),l=$p([0]);for(let d=0;d<t.size-1;d++){n=Us(t,0,d+1),r=Us(t,d+1),o=Ra(Ya(n),e),s=Ra(Ya(r),e);const h=Ya(_a(n,qh(0,n.size)));a=Ra(h,Ya(n));const p=pl(r.shape,n.size),f=ii(qh(0,r.size),p),m=_a(r,f);i=Ra(Ya(m),Ya(r));const g=Wa(a,i),b=Wa(a,i),y=_a(o,s);l=_a(_a(y,g),b);const v=bs(l,c);c=qi(v,l,c),u=qi(v,$p([d]),u)}return u}wa({threshold_:Cf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function If(t,e,n="nearest",r="constant",a=0,i){const o=ya(t,"image","transform","float32"),s=ya(e,"transforms","transform","float32");Cn(4===o.rank,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),Cn(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Cn(null==i||2===i.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const u={image:o,transforms:s},c={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return pa.runKernel(ln,u,c)}wa({transform_:If});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nf(t,e,n){Cn(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Cn(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=ya(t,"a","bandPart");Cn(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[i,o]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=i),n<0&&(n=o);const s=Ka(qh(0,i,1,"int32"),[-1,1]),u=qh(0,o,1,"int32"),c=Wa(s,u),l=zi(Li(c,Ma(+e,"int32")),Pi(c,Ma(-n,"int32"))),d=$s([i,o],r.dtype);return Ka(jp(tu(Ka(r,[-1,i,o])).map(t=>qi(l,t,d))),a)}wa({bandPart_:Nf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ef(t){let e;if(Array.isArray(t)){e=!1,Cn(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)Cn(t[e].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`)}else e=!0,t=Ji(t,t.shape[0],0).map(t=>Ap(t,[0]));Cn(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let a=0;a<t.length;++a)n.push(pa.tidy(()=>{let t=r[a];if(a>0)for(let e=0;e<a;++e){const r=_a(Ya(_a(n[e],t)),n[e]);t=Wa(t,r)}return Ra(t,ed(t,"euclidean"))}));return e?jp(n,0):n}wa({gramSchmidt_:Ef});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Af(t,e=!1){if(Cn(t.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank "+t.rank),2===t.rank)return Rf(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=tu(Ka(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach(t=>{const[n,r]=Rf(t,e);a.push(n),i.push(r)});const o=Ka(jp(a,0),t.shape),s=Ka(jp(i,0),t.shape);return[o,s]}}function Rf(t,e=!1){return pa.tidy(()=>{Cn(2===t.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let a=cd(n),i=Vi(t);const o=Lp([[1]],[1,1]);let s=Vi(o);const u=n>=r?r:n;for(let t=0;t<u;++t){const e=i,u=s,c=a;[s,i,a]=pa.tidy(()=>{const e=Us(i,[t,t],[n-t,1]),u=ed(e),c=Us(i,[t,t],[1,1]),l=qi(bs(c,0),Lp([[-1]]),Lp([[1]])),d=Wa(c,_a(l,u)),h=Ra(e,d);s=1===h.shape[0]?Vi(o):qc([o,Us(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=Da(Ra(Ii(l,d),u)),f=Us(i,[t,0],[n-t,r]),m=_a(p,s),g=$o(s);if(0===t)i=Wa(f,Ii(m,Ii(g,f)));else{const e=Wa(f,Ii(m,Ii(g,f)));i=qc([Us(i,[0,0],[t,r]),e],0)}const b=$o(m),y=Us(a,[0,t],[n,a.shape[1]-t]);if(0===t)a=Wa(y,Ii(Ii(y,s),b));else{const e=Wa(y,Ii(Ii(y,s),b));a=qc([Us(a,[0,0],[n,t]),e],1)}return[s,i,a]}),No([e,u,c])}return!e&&n>r&&(a=Us(a,[0,0],[n,r]),i=Us(i,[0,0],[r,r])),[a,i]})}wa({qr_:Af});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jf;function Df(t,e,n=jf.SUM_BY_NONZERO_WEIGHTS){const r=ya(t,"losses","computeWeightedLoss");let a=null;null!=e&&(a=ya(e,"weights","computeWeightedLoss"));const i=null==a?r:_a(r,a);if(n===jf.NONE)return i;if(n===jf.SUM)return Ya(i);if(n===jf.MEAN){if(null==a)return Xd(i);{const t=r.size/a.size,e=Ra(Ya(i),Ya(a));return t>1?Ra(e,Ma(t)):e}}if(n===jf.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Ra(Ya(i),Ma(r.size));{const t=_a(a,Ls(r.shape)),e=Sa(Ya(oh(t,Ma(0))),"float32");return Ra(Ya(i),e)}}throw Error("Unknown reduction: "+n)}(function(t){t[t["NONE"]=0]="NONE",t[t["MEAN"]=1]="MEAN",t[t["SUM"]=2]="SUM",t[t["SUM_BY_NONZERO_WEIGHTS"]=3]="SUM_BY_NONZERO_WEIGHTS"})(jf||(jf={}));const Ff=wa({computeWeightedLoss_:Df});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mf(t,e,n,r=jf.SUM_BY_NONZERO_WEIGHTS){const a=ya(t,"labels","absoluteDifference"),i=ya(e,"predictions","absoluteDifference");let o=null;null!=n&&(o=ya(n,"weights","absoluteDifference")),Tn(a.shape,i.shape,"Error in absoluteDifference: ");const s=vc(Wa(a,i));return Ff(s,o,r)}wa({absoluteDifference_:Mf});function Pf(t,e,n,r,a=jf.SUM_BY_NONZERO_WEIGHTS){const i=ya(t,"labels","cosineDistance"),o=ya(e,"predictions","cosineDistance");let s=null;null!=r&&(s=ya(r,"weights","cosineDistance")),Tn(i.shape,o.shape,"Error in cosineDistance: ");const u=Ma(1),c=Wa(u,Ya(_a(i,o),n,!0));return Ff(c,s,a)}wa({cosineDistance_:Pf});function $f(t,e,n,r=jf.SUM_BY_NONZERO_WEIGHTS){let a=ya(t,"labels","hingeLoss");const i=ya(e,"predictions","hingeLoss");let o=null;null!=n&&(o=ya(n,"weights","hingeLoss")),Tn(a.shape,i.shape,"Error in hingeLoss: ");const s=Ma(1);a=Wa(_a(Ma(2),a),s);const u=Jh(Wa(s,_a(a,i)));return Ff(u,o,r)}wa({hingeLoss_:$f});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lf(t,e,n,r=1,a=jf.SUM_BY_NONZERO_WEIGHTS){const i=ya(t,"labels","huberLoss"),o=ya(e,"predictions","huberLoss");let s=null;null!=n&&(s=ya(n,"weights","huberLoss")),Tn(i.shape,o.shape,"Error in huberLoss: ");const u=Ma(r),c=vc(Wa(o,i)),l=Jd(c,u),d=Wa(c,l),h=ii(_a(Ma(.5),Ba(l)),_a(u,d));return Ff(h,s,a)}wa({huberLoss_:Lf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bf(t,e,n,r=1e-7,a=jf.SUM_BY_NONZERO_WEIGHTS){const i=ya(t,"labels","logLoss"),o=ya(e,"predictions","logLoss");let s=null;null!=n&&(s=ya(n,"weights","logLoss")),Tn(i.shape,o.shape,"Error in logLoss: ");const u=Ma(1),c=Ma(r),l=Da(_a(i,au(ii(o,c)))),d=_a(Wa(u,i),au(ii(Wa(u,o),c))),h=Wa(l,d);return Ff(h,s,a)}wa({logLoss_:Bf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zf(t,e,n,r=jf.SUM_BY_NONZERO_WEIGHTS){const a=ya(t,"labels","meanSquaredError"),i=ya(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=ya(n,"weights","meanSquaredError")),Tn(a.shape,i.shape,"Error in meanSquaredError: ");const s=Np(a,i);return Ff(s,o,r)}wa({meanSquaredError_:zf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wf(t,e){const n=ya(t,"labels","sigmoidCrossEntropyWithLogits"),r=ya(e,"logits","sigmoidCrossEntropyWithLogits");Tn(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Jh(r),i=_a(r,n),o=Sd(Ko(Da(vc(r))));return ii(Wa(a,i),o)}function Vf(t,e,n,r=0,a=jf.SUM_BY_NONZERO_WEIGHTS){let i=ya(t,"multiClassLabels","sigmoidCrossEntropy");const o=ya(e,"logits","sigmoidCrossEntropy");let s=null;if(null!=n&&(s=ya(n,"weights","sigmoidCrossEntropy")),Tn(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=Ma(r),e=Ma(1),n=Ma(.5);i=ii(_a(i,Wa(e,t)),_a(n,t))}const u=Wf(i,o);return Ff(u,s,a)}wa({sigmoidCrossEntropy_:Vf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uf(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was `+n);const r=_d((t,e,r)=>{const a=!0,i=jd(e,[n],a),o=Wa(Sa(e,"float32"),i);r([t,o]);const s=Da(_a(o,t)),u=Ya(s,[n]),c=(t,e)=>{const[r,a]=e,i=ko(t.shape,[n]);return[_a(Ka(t,i),Wa(Sa(r,"float32"),Ko(a))),_a(Ka(t,i),Wa(Ko(a),Sa(r,"float32")))]};return{value:u,gradFunc:c}});return r(t,e)}function Gf(t,e,n,r=0,a=jf.SUM_BY_NONZERO_WEIGHTS){let i=ya(t,"onehotLabels","softmaxCrossEntropy");const o=ya(e,"logits","softmaxCrossEntropy");let s=null;if(null!=n&&(s=ya(n,"weights","softmaxCrossEntropy")),Tn(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=Ma(r),e=Ma(1),n=Ma(i.shape[1]);i=ii(_a(i,Wa(e,t)),Ra(t,n))}const u=Uf(i,o);return Ff(u,s,a)}wa({softmaxCrossEntropy_:Gf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(t,e,n,r){const a=ya(t,"indices","sparseFillEmptyRows","int32"),i=ya(e,"values","sparseFillEmptyRows"),o=ya(n,"denseShape","sparseFillEmptyRows","int32"),s=ya(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        "+a.shape);if(1!==i.rank)throw new Error("Values should be Tensor1D but received shape "+i.shape);if(1!==o.rank)throw new Error("Dense shape should be Tensor1D but received shape "+o.shape);if(0!==s.rank)throw new Error("Default value should be a scalar but received shape "+s.shape);const u={indices:a,values:i,denseShape:o,defaultValue:s},c=pa.runKernel(qe,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}wa({sparseFillEmptyRows_:Hf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(t,e,n){const r=ya(t,"inputIndices","sparseReshape","int32"),a=ya(e,"inputShape","sparseReshape","int32"),i=ya(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        "+r.shape);if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape "+a.shape);if(1!==i.rank)throw new Error("New shape should be Tensor1D but received shape "+i.shape);const o={inputIndices:r,inputShape:a,newShape:i},s=pa.runKernel(Ke,o);return{outputIndices:s[0],outputShape:s[1]}}wa({sparseReshape_:qf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kf(t,e,n){const r=ya(t,"data","sparseSegmentMean"),a=ya(e,"indices","sparseSegmentMean","int32"),i=ya(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          "+a.shape);if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          "+i.shape);const o={data:r,indices:a,segmentIds:i};return pa.runKernel(Xe,o)}wa({sparseSegmentMean_:Kf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xf(t,e,n){const r=ya(t,"data","sparseSegmentSum"),a=ya(e,"indices","sparseSegmentSum","int32"),i=ya(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         "+a.shape);if(1!==i.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         "+i.shape);const o={data:r,indices:a,segmentIds:i};return pa.runKernel(Ye,o)}wa({sparseSegmentSum_:Xf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yf(t,e,n,r,a,i,o,s){const u=ya(t,"data","stringNGrams","string");if("string"!==u.dtype)throw new Error("Data must be of datatype string");if(1!==u.shape.length)throw new Error("Data must be a vector, saw: "+u.shape);const c=ya(e,"dataSplits","stringNGrams");if("int32"!==c.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},d={data:u,dataSplits:c},h=pa.runKernel(en,d,l);return{nGrams:h[0],nGramsSplits:h[1]}}wa({stringNGrams_:Yf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jf(t,e,n=!0){const r=ya(t,"input","stringSplit","string"),a=ya(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape "+r.shape);if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape "+a.shape);const i={skipEmpty:n},o={input:r,delimiter:a},s=pa.runKernel(nn,o,i);return{indices:s[0],values:s[1],shape:s[2]}}wa({stringSplit_:Jf});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zf(t,e){const n=ya(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return pa.runKernel(rn,a,r)}wa({stringToHashBucketFast_:Zf});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Qf extends mc{minimize(t,e=!1,n){const{value:r,grads:a}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:a[t.name]}));this.applyGradients(t)}else this.applyGradients(a);return No(a),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return Od(t,e)}dispose(){null!=this.iterations_&&No(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Ma(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(Qf,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class tm extends Qf{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=pa.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=pa.registeredVariables[e],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:e+"/accum_grad",variable:Io(()=>ti(r).variable(a))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:e+"/accum_var",variable:Io(()=>ti(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;Io(()=>{const t=ii(_a(o,this.rho),_a(Ba(i),1-this.rho)),e=_a(Ra($a(ii(s,this.epsilon)),$a(ii(o,this.epsilon))),i),n=ii(_a(s,this.rho),_a(Ba(e),1-this.rho));o.assign(t),s.assign(n);const a=ii(_a(e,-this.learningRate),r);r.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(No(this.accumulatedGrads.map(t=>t.variable)),No(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=t.length/2,n=!1;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["rho"],e["epsilon"])}}tm.className="Adadelta",bc(tm);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class em extends Qf{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=pa.registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:e+"/accumulator",variable:Io(()=>pl(r.shape,this.initialAccumulatorValue).variable(t))}}const a=Array.isArray(t)?t[n].tensor:t[e];if(null==a)return;const i=this.accumulatedGrads[n].variable;Io(()=>{const t=ii(i,Ba(a));i.assign(t);const e=ii(_a(Ra(a,$a(ii(t,pa.backend.epsilon()))),-this.learningRate),r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&No(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e["learningRate"],e["initialAccumulatorValue"])}}em.className="Adagrad",bc(em);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class nm extends Qf{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Io(()=>{this.accBeta1=Ma(e).variable(),this.accBeta2=Ma(n).variable()}),null==r&&(this.epsilon=pa.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Io(()=>{const n=Wa(1,this.accBeta1),r=Wa(1,this.accBeta2);e.forEach((e,a)=>{const i=pa.registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:e+"/m",variable:Io(()=>ti(i).variable(o))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:e+"/v",variable:Io(()=>ti(i).variable(o))});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedSecondMoment[a].variable,l=ii(_a(u,this.beta1),_a(s,1-this.beta1)),d=ii(_a(c,this.beta2),_a(Ba(s),1-this.beta2)),h=Ra(l,n),p=Ra(d,r);u.assign(l),c.assign(d);const f=ii(_a(Ra(h,ii($a(p),this.epsilon)),-this.learningRate),i);i.assign(f)}),this.accBeta1.assign(_a(this.accBeta1,this.beta1)),this.accBeta2.assign(_a(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&No(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&No(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),Io(()=>{this.accBeta1.assign(ou(this.beta1,this.iterations_+1)),this.accBeta2.assign(ou(this.beta2,this.iterations_+1))});const e=t.length/2,n=!1;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"])}}nm.className="Adam",bc(nm);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class rm extends Qf{constructor(t,e,n,r=null,a=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Io(()=>{this.iteration=Ma(0).variable(),this.accBeta1=Ma(e).variable()}),null==r&&(this.epsilon=pa.backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Io(()=>{const n=Wa(1,this.accBeta1),r=Ra(-this.learningRate,ii(_a(this.iteration,this.decay),1));e.forEach((e,a)=>{const i=pa.registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:e+"/m",variable:ti(i).variable(o)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:e+"/v",variable:ti(i).variable(o)});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedWeightedInfNorm[a].variable,l=ii(_a(u,this.beta1),_a(s,1-this.beta1)),d=_a(c,this.beta2),h=vc(s),p=qd(d,h);u.assign(l),c.assign(p);const f=ii(_a(Ra(r,n),Ra(l,ii(p,this.epsilon))),i);i.assign(f)}),this.iteration.assign(ii(this.iteration,1)),this.accBeta1.assign(_a(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&No(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&No(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"],e["decay"])}}rm.className="Adamax",bc(rm);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class am extends Qf{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const a=pa.registeredVariables[e];Io(()=>{const t=ii(_a(this.c,r),a);a.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Eo(Ma(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),0!==t.length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e["learningRate"])}}am.className="SGD",bc(am);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class im extends am{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Ma(this.momentum)}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=pa.registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:e+"/momentum",variable:Io(()=>ti(r).variable(t))}}const a=this.accumulations[n].variable,i=Array.isArray(t)?t[n].tensor:t[e];null!=i&&Io(()=>{let t;const e=ii(_a(this.m,a),i);t=this.useNesterov?ii(_a(this.c,ii(i,_a(e,this.m))),r):ii(_a(this.c,e),r),a.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&No(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e["learningRate"],e["momentum"],e["useNesterov"])}}im.className="Momentum",bc(im);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class om extends Qf{constructor(t,e=.9,n=0,r=null,a=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=pa.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=pa.registeredVariables[e],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:e+"/rms",variable:Io(()=>ti(r).variable(a))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:e+"/momentum",variable:Io(()=>ti(r).variable(a))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:e+"/mg",variable:Io(()=>ti(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;Io(()=>{const t=ii(_a(o,this.decay),_a(Ba(i),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,a=ii(_a(e,this.decay),_a(i,1-this.decay)),u=Ra(_a(i,this.learningRate),$a(Wa(t,ii(Ba(a),this.epsilon)))),c=ii(_a(s,this.momentum),u);o.assign(t),e.assign(a),s.assign(c);const l=Wa(r,c);r.assign(l)}else{const t=ii(_a(o,this.decay),_a(Ba(i),1-this.decay)),e=ii(_a(s,this.momentum),Ra(_a(i,this.learningRate),$a(ii(t,this.epsilon))));o.assign(t),s.assign(e);const n=Wa(r,e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&No(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&No(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&No(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e["learningRate"],e["decay"],e["momentum"],e["epsilon"],e["centered"])}}om.className="RMSProp",bc(om);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class sm{static sgd(t){return new am(t)}static momentum(t,e,n=!1){return new im(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,a=!1){return new om(t,e,n,r,a)}static adam(t=.001,e=.9,n=.999,r=null){return new nm(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new tm(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,a=0){return new rm(t,e,n,r,a)}static adagrad(t,e=.1){return new em(t,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */sm.sgd,sm.momentum,sm.adadelta,sm.adagrad,sm.rmsprop,sm.adamax,sm.adam,(()=>{"undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate&&setImmediate})()
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */;
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var um;(function(t){t[t["FIRST_DIM_SIZE"]=0]="FIRST_DIM_SIZE",t[t["VALUE_ROWIDS"]=1]="VALUE_ROWIDS",t[t["ROW_LENGTHS"]=2]="ROW_LENGTHS",t[t["ROW_SPLITS"]=3]="ROW_SPLITS",t[t["ROW_LIMITS"]=4]="ROW_LIMITS",t[t["ROW_STARTS"]=5]="ROW_STARTS"})(um||(um={}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const cm=1.7580993408473768,lm=1.0507009873554805;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function dm(t,e,n){const r=t.shape.slice();r[n]=1;const a=Ka(e,r),i=Al(t,n,!0,!1),o=Al(t,n,!0,!0),s=_a(i,o);return _a(a,s)}function hm(t,e,n){const r=t.shape.length,a=r-n.length,i=So(n,r);let o=t;null!=i&&(o=$o(t,i));const s=o.shape.slice(),u=s.splice(r-n.length,n.length),c=u.reduce((t,e)=>t*e,1);s.push(c);const l=o.reshape(s);let d=dm(l,e,a);if(d=d.reshape(o.shape),null!=i){const t=Oo(i);d=$o(d,t)}return d}const pm={kernelName:ge,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;let i=[];return i=void 0===a||null===a?r.shape.map((t,e)=>e):"number"===typeof a?[a]:a,{x:()=>hm(r,t,i)}}},fm={kernelName:ct,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{const e=Ra(t,Sa(r,"float32")),i=Ga(n.shape,a);return i.length>0?Ka(Ya(e,i),n.shape):e},o=()=>{let e=_a(t,Sa(n,"float32"));const i=Ga(r.shape,a);i.length>0&&(e=Ka(Ya(e,i),r.shape));const o=Ba(r);return Da(Ra(e,Sa(o,"float32")))};return{a:i,b:o}}},mm={kernelName:we,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,Da(Ba(n)))}}},gm={kernelName:Ie,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=_a(Li(n,6),Ta(n));return{x:()=>_a(t,Sa(r,"float32"))}}},bm={kernelName:ke,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,Sa(Ta(n),"float32"))}}},ym={kernelName:Se,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ka(t,n.shape)}}},vm={kernelName:Ce,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r},i=()=>pa.runKernel(Te,a,n);return{images:i}}},xm={kernelName:Oe,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r},i=()=>pa.runKernel(_e,a,n);return{images:i}}},wm={kernelName:Ne,gradFunc:(t,e,n)=>{const{dims:r}=n,a=Dn(r,t.shape);return{x:()=>ep(t,a)}}},km={kernelName:Ee,gradFunc:t=>({x:()=>ti(t)})},Sm={kernelName:Ae,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Da(Ra(t,_a(ou(n,1.5),2)))}}},Om={kernelName:De,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Sa(ti(n),"float32"),t:()=>_a(t,Sa(n,t.dtype)),e:()=>_a(t,Sa(Fd(n),t.dtype))}}},_m={kernelName:Fe,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=bs(n,Ma(0)),r=Ma(cm),a=Ma(lm),i=_a(t,a),o=_a(_a(t,r),Ko(Sa(n,"float32")));return qi(e,i,o)}}}},Cm={kernelName:Be,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,_a(n,Wa(Ma(1),n)))}}},Tm={kernelName:Le,gradFunc:t=>({x:()=>ti(t)})},Im={kernelName:Pe,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(Tl(Sa(n,"float32")),t)}}},Nm={kernelName:$e,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(Nl(Sa(n,"float32")),t)}}},Em={kernelName:Me,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:a,size:i}=n,o=r.shape,[s,u]=fc(r,a,i),c=[];for(let l=0;l<t.rank;l++)c.push([s[l],o[l]-s[l]-u[l]]);return{x:()=>dh(t,c)}}},Am={kernelName:He,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:a}=n,i=!0,o=_a(t,r);return{logits:()=>Wa(o,_a(Ya(o,[a],i),r))}}},Rm={kernelName:ze,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,Xc(n))}}},jm={kernelName:Ue,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>tl(t,r,a)}}},Dm={kernelName:Ge,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>qc(t,r)}}},Fm={kernelName:We,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,_a($a(Sa(n,"float32")),2))}}},Mm={kernelName:Qe,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(t,_a(Sa(n,"float32"),2))}}},Pm={kernelName:Ze,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ma(2),i=()=>_a(t,_a(a,Wa(n,r))),o=()=>_a(t,_a(a,Wa(r,n)));return{a:i,b:o}}},$m={kernelName:gn,gradFunc:t=>({x:()=>ti(t)})},Lm={kernelName:an,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Ha(n.shape,r.shape),i=()=>{let e=t;const r=Ga(n.shape,a);return r.length>0&&(e=Ya(e,r)),Ka(e,n.shape)},o=()=>{let e=t;const n=Ga(r.shape,a);return n.length>0&&(e=Ya(e,n)),Ka(Da(e),r.shape)};return{a:i,b:o}}},Bm={kernelName:Ve,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,a=r.shape.slice(),{axis:i}=n,o=Dn(i,r.shape);o.forEach(t=>{a[t]=1});const s=Ka(t,a),u=_a(s,Ls(r.shape,"float32"));return{x:()=>u}}},zm={kernelName:on,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ra(t,Ba(Tl(n)))}}},Wm={kernelName:sn,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>_a(Wa(Ma(1),Ba(n)),t)}}},Vm={kernelName:un,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:a}=n,i=()=>{let e=ti(r);if(1===r.rank)for(let n=0;n<a[0];++n)e=ii(e,Us(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)e=ii(e,Us(t,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)e=ii(e,Us(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)for(let s=0;s<a[3];++s)e=ii(e,Us(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e};return{x:i}}},Um={kernelName:dn,gradFunc:(t,e,n)=>{const r=n,{perm:a}=r,i=Oo(a);return{x:()=>$o(t,i)}}},Gm={kernelName:pn,gradFunc:(t,e,n)=>{const r=n,{axis:a}=r;return{value:()=>jp(t,a)}}},Hm={kernelName:fn,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e,r=()=>qm(t,n);return{x:r}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qm(t,e){const n=qd(e,ti(e)),r=dd(t,n);let a=Pi(e,Ma(0,"int32"));const i=r.rank-a.rank;for(let s=0;s<i;++s)a=id(a,s+1);a=zi(a,Ls(r.shape,"bool"));const o=ti(r);return qi(a,r,o)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Km={kernelName:mn,gradFunc:t=>({x:()=>ti(t)})},Xm=[Ia,Va,Ua,Ja,Za,ei,ni,ri,oi,si,ui,ci,Si,Ci,Ni,Ri,ji,Di,Fi,Ki,Xi,Zi,oo,ro,ho,mo,yo,Lo,Uo,Go,fm,Ho,Xo,Yo,Jo,Zo,ts,Qo,is,us,ds,hs,ps,fs,ms,ys,vs,xs,ws,Os,Is,Is,As,Ds,Ps,Bs,zs,Ws,Gs,Ks,Xs,Ys,Js,Zs,eu,nu,nu,su,uu,pm,mm,gm,bm,ym,vm,xm,wm,km,Sm,Om,_m,Cm,Tm,Im,Nm,Em,Am,Rm,jm,jm,Dm,Dm,Fm,Pm,Mm,$m,Lm,Bm,zm,Wm,Vm,Um,Gm,Hm,Km];
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */for(const e of Xm)yr(e);
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Kr().prototype.abs=function(){return this.throwIfDisposed(),vc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.acos=function(){return this.throwIfDisposed(),wc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.acosh=function(){return this.throwIfDisposed(),Sc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.add=function(t){return this.throwIfDisposed(),ii(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.all=function(t,e){return this.throwIfDisposed(),Cc(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.any=function(t,e){return this.throwIfDisposed(),Ic(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.argMax=function(t){return this.throwIfDisposed(),Ec(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.argMin=function(t){return this.throwIfDisposed(),Rc(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.asScalar=function(){return this.throwIfDisposed(),Cn(1===this.size,()=>"The array must have only 1 element."),Ka(this,[])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.asType=function(t){return this.throwIfDisposed(),Sa(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.as1D=function(){return this.throwIfDisposed(),Ka(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.as2D=function(t,e){return this.throwIfDisposed(),Ka(this,[t,e])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),Ka(this,[t,e,n])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),Ka(this,[t,e,n,r])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.as5D=function(t,e,n,r,a){return this.throwIfDisposed(),Ka(this,[t,e,n,r,a])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.asin=function(){return this.throwIfDisposed(),Dc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.asinh=function(){return this.throwIfDisposed(),Mc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.atan=function(){return this.throwIfDisposed(),$c(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.atan2=function(t){return this.throwIfDisposed(),Bc(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.atanh=function(){return this.throwIfDisposed(),Wc(this)},Kr().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Uc(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),tl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.batchNorm=function(t,e,n,r,a){return this.throwIfDisposed(),rl(this,t,e,n,r,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Gi(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.cast=function(t){return this.throwIfDisposed(),Sa(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.ceil=function(){return this.throwIfDisposed(),hl(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),ml(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof qr&&(t=[t]),qc([this,...t],e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.conv1d=function(t,e,n,r,a,i){return this.throwIfDisposed(),wl(this,t,e,n,r,a,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.conv2dTranspose=function(t,e,n,r,a){return this.throwIfDisposed(),Sl(this,t,e,n,r,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.conv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),io(this,t,e,n,r,a,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.cos=function(){return this.throwIfDisposed(),Tl(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.cosh=function(){return this.throwIfDisposed(),Nl(this)},
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Al(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),Co(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Dl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.depthwiseConv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),Ml(this,t,e,n,r,a,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.dilation2d=function(t,e,n,r,a){return this.throwIfDisposed(),Ll(this,t,e,n,r,a)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.divNoNan=function(t){return this.throwIfDisposed(),zl(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.div=function(t){return this.throwIfDisposed(),Ra(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.dot=function(t){return this.throwIfDisposed(),Vl(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.elu=function(){return this.throwIfDisposed(),Hl(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.equal=function(t){return this.throwIfDisposed(),Cs(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.erf=function(){return this.throwIfDisposed(),Kl(this)},
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),rd(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.exp=function(){return this.throwIfDisposed(),Ko(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.expandDims=function(t){return this.throwIfDisposed(),id(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.expm1=function(){return this.throwIfDisposed(),sd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.fft=function(){return this.throwIfDisposed(),wp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.flatten=function(){return this.throwIfDisposed(),Ka(this,[this.size])},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.floor=function(){return this.throwIfDisposed(),qs(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.floorDiv=function(t){return this.throwIfDisposed(),Ea(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.gather=function(t,e){return this.throwIfDisposed(),dd(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Pi(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.greater=function(t){return this.throwIfDisposed(),bs(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.ifft=function(){return this.throwIfDisposed(),Sp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.irfft=function(){return this.throwIfDisposed(),_p(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.isFinite=function(){return this.throwIfDisposed(),pd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.isInf=function(){return this.throwIfDisposed(),md(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.isNaN=function(){return this.throwIfDisposed(),bd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.leakyRelu=function(t){return this.throwIfDisposed(),vd(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.lessEqual=function(t){return this.throwIfDisposed(),Li(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.less=function(t){return this.throwIfDisposed(),Es(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),wd(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logSigmoid=function(){return this.throwIfDisposed(),Nd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logSoftmax=function(t){return this.throwIfDisposed(),Ad(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),jd(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.log=function(){return this.throwIfDisposed(),au(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.log1p=function(){return this.throwIfDisposed(),Sd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logicalAnd=function(t){return this.throwIfDisposed(),zi(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logicalNot=function(){return this.throwIfDisposed(),Fd(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logicalOr=function(t){return this.throwIfDisposed(),Pd(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.logicalXor=function(t){return this.throwIfDisposed(),Ld(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Ii(this,t,e,n)},Kr().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),Vd(this,t,e,n,r)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.max=function(t,e){return this.throwIfDisposed(),Yl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.maximum=function(t){return this.throwIfDisposed(),qd(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.mean=function(t,e){return this.throwIfDisposed(),Xd(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.min=function(t,e){return this.throwIfDisposed(),Zl(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.minimum=function(t){return this.throwIfDisposed(),Jd(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),Qd(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.mod=function(t){return this.throwIfDisposed(),eh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.mul=function(t){return this.throwIfDisposed(),_a(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.neg=function(){return this.throwIfDisposed(),Da(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.norm=function(t,e,n){return this.throwIfDisposed(),ed(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.notEqual=function(t){return this.throwIfDisposed(),oh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),sc(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.onesLike=function(){return this.throwIfDisposed(),uh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.pad=function(t,e){return this.throwIfDisposed(),dh(this,t,e)},Kr().prototype.pool=function(t,e,n,r,a,i){return this.throwIfDisposed(),vh(this,t,e,n,r,a,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.pow=function(t){return this.throwIfDisposed(),ou(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.prelu=function(t){return this.throwIfDisposed(),wh(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.prod=function(t,e){return this.throwIfDisposed(),Sh(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.reciprocal=function(){return this.throwIfDisposed(),Xh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.relu=function(){return this.throwIfDisposed(),Jh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.relu6=function(){return this.throwIfDisposed(),Qh(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.reshapeAs=function(t){return this.throwIfDisposed(),Ka(this,t.shape)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.reshape=function(t){return this.throwIfDisposed(),Ka(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Sf(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),_f(this,t,e,n)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.reverse=function(t){return this.throwIfDisposed(),ep(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.rfft=function(){return this.throwIfDisposed(),Tp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.round=function(){return this.throwIfDisposed(),sp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.rsqrt=function(){return this.throwIfDisposed(),ns(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.selu=function(){return this.throwIfDisposed(),cp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.separableConv2d=function(t,e,n,r,a,i){return this.throwIfDisposed(),dp(this,t,e,n,r,a,i)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sigmoid=function(){return this.throwIfDisposed(),Xc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sign=function(){return this.throwIfDisposed(),pp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sin=function(){return this.throwIfDisposed(),fo(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sinh=function(){return this.throwIfDisposed(),bo(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.slice=function(t,e){return this.throwIfDisposed(),Us(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.softmax=function(t){return this.throwIfDisposed(),vp(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.softplus=function(){return this.throwIfDisposed(),Td(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Ai(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.split=function(t,e){return this.throwIfDisposed(),Ji(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sqrt=function(){return this.throwIfDisposed(),$a(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.square=function(){return this.throwIfDisposed(),Ba(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.squaredDifference=function(t){return this.throwIfDisposed(),Np(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.squeeze=function(t){return this.throwIfDisposed(),Ap(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof qr?[this,t]:[this,...t];return jp(n,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.step=function(t){return this.throwIfDisposed(),Ta(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.stridedSlice=function(t,e,n,r,a,i,o,s){return this.throwIfDisposed(),Fp(this,t,e,n,r,a,i,o,s)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sub=function(t){return this.throwIfDisposed(),Wa(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.sum=function(t,e){return this.throwIfDisposed(),Ya(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.tan=function(){return this.throwIfDisposed(),Pp(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.tanh=function(){return this.throwIfDisposed(),Jc(this)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.tile=function(t){return this.throwIfDisposed(),as(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.toBool=function(){return this.throwIfDisposed(),Sa(this,"bool")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.toFloat=function(){return this.throwIfDisposed(),Sa(this,"float32")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.toInt=function(){return this.throwIfDisposed(),Sa(this,"int32")},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.topk=function(t,e){return this.throwIfDisposed(),zp(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.transpose=function(t){return this.throwIfDisposed(),$o(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.unique=function(t){return this.throwIfDisposed(),Up(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),ss(this,t,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.unstack=function(t){return this.throwIfDisposed(),tu(this,t)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.where=function(t,e){return this.throwIfDisposed(),qi(t,this,e)},
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Kr().prototype.zerosLike=function(){return this.throwIfDisposed(),ti(this)};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/** @license See the LICENSE file. */
var Ym="3.21.0",Jm={"tfjs-core":o.version_core,"tfjs-backend-cpu":h.version_cpu,"tfjs-backend-webgl":p.version_webgl,"tfjs-data":d.version_data,"tfjs-layers":c.version_layers,"tfjs-converter":l.version_converter,tfjs:Ym};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Object.keys(o).forEach((function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}})})),Object.keys(c).forEach((function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return c[t]}})})),Object.keys(l).forEach((function(t){"default"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return l[t]}})})),e.data=d,e.version=Jm}).call(this,n("c8ba"),n("4362"),n("b639").Buffer)},3956:function(t,e,n){var r=n("d460"),a=n("3ff1");function i(t){return r(a(t))}t.exports=i},"39a4":function(t,e){},"39cd":function(t,e){},"39ff":function(t,e,n){var r=n("0b07"),a=n("2b3e"),i=r(a,"WeakMap");t.exports=i},"3a0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e){const n=Object(i["a"])(t,"x","reshape","string_or_numeric"),o={x:n},s={shape:e};return r["a"].runKernel(a["vc"],o,s)}const u=Object(o["b"])({reshape_:s})},"3a38":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const i={kernelName:r["Identity"],backendName:"cpu",kernelFunc:a}},"3a54":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.regex)("alphaNum",/^[a-zA-Z0-9]*$/);e.default=a},"3a7c":function(t,e,n){function r(t){return Array.isArray?Array.isArray(t):"[object Array]"===b(t)}function a(t){return"boolean"===typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"===typeof t}function u(t){return"string"===typeof t}function c(t){return"symbol"===typeof t}function l(t){return void 0===t}function d(t){return"[object RegExp]"===b(t)}function h(t){return"object"===typeof t&&null!==t}function p(t){return"[object Date]"===b(t)}function f(t){return"[object Error]"===b(t)||t instanceof Error}function m(t){return"function"===typeof t}function g(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t}function b(t){return Object.prototype.toString.call(t)}e.isArray=r,e.isBoolean=a,e.isNull=i,e.isNullOrUndefined=o,e.isNumber=s,e.isString=u,e.isSymbol=c,e.isUndefined=l,e.isRegExp=d,e.isObject=h,e.isDate=p,e.isError=f,e.isFunction=m,e.isPrimitive=g,e.isBuffer=n("b639").Buffer.isBuffer},"3b1d":function(t,e,n){"use strict";n("8a85")},"3b4a":function(t,e,n){var r=n("0b07"),a=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();t.exports=a},"3bb4":function(t,e,n){var r=n("08cc"),a=n("ec69");function i(t){var e=a(t),n=e.length;while(n--){var i=e[n],o=t[i];e[n]=[i,o,r(o)]}return e}t.exports=i},"3c35":function(t,e){(function(e){t.exports=e}).call(this,{})},"3d68":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("df00"),o=n("f947"),s=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e,n,o,u){i["b"](t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let c=t,l=e,d=!1;4===e.rank&&(d=!0,l=Object(s["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),c=[1,t[0],t[1],t[2],t[3]]);const h=c[4],p=l.shape[4];i["b"](5===c.length,()=>"Error in conv3dDerInput: inShape must be length 5, but got length "+c.length+"."),i["b"](5===l.rank,()=>"Error in conv3dDerInput: dy must be rank 5, but got rank "+l.rank),i["b"](5===n.rank,()=>"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank),i["b"](h===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[3]}.`),i["b"](p===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${p}) must match output depth for filter ${n.shape[4]}.`);const f={dy:l,filter:n},m={pad:u,strides:o,inputShape:c},g=r["a"].runKernel(a["I"],f,m);return d?Object(s["a"])(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const c=Object(o["b"])({conv3DBackpropInput_:u})},"3d7b":function(t,e){},"3e50":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e=0){const n=Object(i["b"])(t,"tensors","stack","string_or_numeric");o["b"](n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&o["b"](e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,u={axis:e};return r["a"].runKernel(a["hc"],s,u)}const c=Object(s["b"])({stack_:u})},"3f84":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n=0){const o=Object(i["a"])(t,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},u={x:o};return r["a"].runKernel(a["ic"],u,s)}const u=Object(o["b"])({pad_:s})},"3fb5":function(t,e){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}},"3ff1":function(t,e,n){var r=n("266a"),a=n("ec69");function i(t){return null==t?[]:r(t,a(t))}t.exports=i},"405a":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Pixelate=void 0;var r=n("f0b4"),a=n("9cb8"),i=n("4971"),o=n("4546"),s=function(t){var e,n,r,i,o,s,u,c,l,d,h,p,f,m,g=Math.ceil(this.pixelSize()),b=t.width,y=t.height,v=Math.ceil(b/g),x=Math.ceil(y/g),w=t.data;if(g<=0)a.Util.error("pixelSize value can not be <= 0");else for(p=0;p<v;p+=1)for(f=0;f<x;f+=1){for(i=0,o=0,s=0,u=0,c=p*g,l=c+g,d=f*g,h=d+g,m=0,e=c;e<l;e+=1)if(!(e>=b))for(n=d;n<h;n+=1)n>=y||(r=4*(b*n+e),i+=w[r+0],o+=w[r+1],s+=w[r+2],u+=w[r+3],m+=1);for(i/=m,o/=m,s/=m,u/=m,e=c;e<l;e+=1)if(!(e>=b))for(n=d;n<h;n+=1)n>=y||(r=4*(b*n+e),w[r+0]=i,w[r+1]=o,w[r+2]=s,w[r+3]=u)}};e.Pixelate=s,r.Factory.addGetterSetter(i.Node,"pixelSize",8,o.getNumberValidator(),r.Factory.afterSetFilter)},"41c3":function(t,e,n){var r=n("1a8c"),a=n("eac5"),i=n("ec8c"),o=Object.prototype,s=o.hasOwnProperty;function u(t){if(!r(t))return i(t);var e=a(t),n=[];for(var o in t)("constructor"!=o||!e&&s.call(t,o))&&n.push(o);return n}t.exports=u},4245:function(t,e,n){var r=n("1290");function a(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}t.exports=a},42454:function(t,e,n){var r=n("f909"),a=n("2ec1"),i=a((function(t,e,n){r(t,e,n)}));t.exports=i},"425a":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n("2ca8"),a=n("60ee");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,n,a,i){const o=r["slice_util"].isSliceContinous(a,e,n),s=r["util"].sizeFromShape(n),u=r["util"].computeStrides(a);if(o){const n=r["slice_util"].computeFlatOffset(e,u);return"string"===i?t.slice(n,n+s):t.subarray(n,n+s)}const c="string"===i?r["backend_util"].fromUint8ToStringArray(t):t,l=Object(r["buffer"])(a,i,c),d=Object(r["buffer"])(n,i);for(let r=0;r<d.size;++r){const t=d.indexToLoc(r),n=t.map((t,n)=>t+e[n]);d.set(l.get(...n),...t)}return"string"===i?r["backend_util"].fromStringArrayToUint8(d.values):d.values}function o(t){const{inputs:e,backend:n,attrs:o}=t,{x:s}=e,{begin:u,size:c}=o;Object(a["a"])(s,"slice");const[l,d]=r["slice_util"].parseSliceParams(s,u,c);r["slice_util"].assertParamsValid(s,l,d);const h=n.data.get(s.dataId).values,p=i(h,l,d,s.shape,s.dtype);return n.makeTensorInfo(d,s.dtype,p)}const s={kernelName:r["Slice"],backendName:"cpu",kernelFunc:o}},4280:function(t,e,n){"use strict";n("5f27")},4284:function(t,e){function n(t,e){var n=-1,r=null==t?0:t.length;while(++n<r)if(e(t[n],n,t))return!0;return!1}t.exports=n},"429b":function(t,e,n){t.exports=n("faa1").EventEmitter},"42a2":function(t,e,n){var r=n("b5a7"),a=n("79bc"),i=n("1cec"),o=n("c869"),s=n("39ff"),u=n("3729"),c=n("dc57"),l="[object Map]",d="[object Object]",h="[object Promise]",p="[object Set]",f="[object WeakMap]",m="[object DataView]",g=c(r),b=c(a),y=c(i),v=c(o),x=c(s),w=u;(r&&w(new r(new ArrayBuffer(1)))!=m||a&&w(new a)!=l||i&&w(i.resolve())!=h||o&&w(new o)!=p||s&&w(new s)!=f)&&(w=function(t){var e=u(t),n=e==d?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case g:return m;case b:return l;case y:return h;case v:return p;case x:return f}return e}),t.exports=w},"42e8":function(t,e,n){"use strict";n.r(e),n.d(e,"CallbackList",(function(){return Hi})),n.d(e,"CustomCallback",(function(){return Xi})),n.d(e,"History",(function(){return Ki})),n.d(e,"Callback",(function(){return zd})),n.d(e,"callbacks",(function(){return Hd})),n.d(e,"EarlyStopping",(function(){return Ud})),n.d(e,"InputSpec",(function(){return ge})),n.d(e,"SymbolicTensor",(function(){return be})),n.d(e,"LayersModel",(function(){return As})),n.d(e,"input",(function(){return zs})),n.d(e,"loadLayersModel",(function(){return Bs})),n.d(e,"model",(function(){return $s})),n.d(e,"registerCallbackConstructor",(function(){return Ws})),n.d(e,"sequential",(function(){return Ls})),n.d(e,"RNN",(function(){return Gu})),n.d(e,"Sequential",(function(){return Ps})),n.d(e,"LayerVariable",(function(){return he})),n.d(e,"version_layers",(function(){return Qo})),n.d(e,"constraints",(function(){return r})),n.d(e,"initializers",(function(){return a})),n.d(e,"layers",(function(){return i})),n.d(e,"metrics",(function(){return o})),n.d(e,"models",(function(){return s})),n.d(e,"regularizers",(function(){return u}));var r={};n.r(r),n.d(r,"maxNorm",(function(){return ki})),n.d(r,"unitNorm",(function(){return Si})),n.d(r,"nonNeg",(function(){return Oi})),n.d(r,"minMaxNorm",(function(){return _i}));var a={};n.r(a),n.d(a,"zeros",(function(){return Ci})),n.d(a,"ones",(function(){return Ti})),n.d(a,"constant",(function(){return Ii})),n.d(a,"randomUniform",(function(){return Ni})),n.d(a,"randomNormal",(function(){return Ei})),n.d(a,"truncatedNormal",(function(){return Ai})),n.d(a,"identity",(function(){return Ri})),n.d(a,"varianceScaling",(function(){return ji})),n.d(a,"glorotUniform",(function(){return Di})),n.d(a,"glorotNormal",(function(){return Fi})),n.d(a,"heNormal",(function(){return Mi})),n.d(a,"heUniform",(function(){return Pi})),n.d(a,"leCunNormal",(function(){return $i})),n.d(a,"leCunUniform",(function(){return Li})),n.d(a,"orthogonal",(function(){return Bi}));var i={};n.r(i),n.d(i,"inputLayer",(function(){return il})),n.d(i,"elu",(function(){return ol})),n.d(i,"reLU",(function(){return sl})),n.d(i,"leakyReLU",(function(){return ul})),n.d(i,"prelu",(function(){return cl})),n.d(i,"softmax",(function(){return ll})),n.d(i,"thresholdedReLU",(function(){return dl})),n.d(i,"conv1d",(function(){return hl})),n.d(i,"conv2d",(function(){return pl})),n.d(i,"conv2dTranspose",(function(){return fl})),n.d(i,"conv3d",(function(){return ml})),n.d(i,"conv3dTranspose",(function(){return gl})),n.d(i,"separableConv2d",(function(){return bl})),n.d(i,"cropping2D",(function(){return yl})),n.d(i,"upSampling2d",(function(){return vl})),n.d(i,"depthwiseConv2d",(function(){return xl})),n.d(i,"activation",(function(){return wl})),n.d(i,"dense",(function(){return kl})),n.d(i,"dropout",(function(){return Sl})),n.d(i,"spatialDropout1d",(function(){return Ol})),n.d(i,"flatten",(function(){return _l})),n.d(i,"repeatVector",(function(){return Cl})),n.d(i,"reshape",(function(){return Tl})),n.d(i,"permute",(function(){return Il})),n.d(i,"embedding",(function(){return Nl})),n.d(i,"add",(function(){return El})),n.d(i,"average",(function(){return Al})),n.d(i,"concatenate",(function(){return Rl})),n.d(i,"maximum",(function(){return jl})),n.d(i,"minimum",(function(){return Dl})),n.d(i,"multiply",(function(){return Fl})),n.d(i,"dot",(function(){return Ml})),n.d(i,"batchNormalization",(function(){return Pl})),n.d(i,"layerNormalization",(function(){return $l})),n.d(i,"zeroPadding2d",(function(){return Ll})),n.d(i,"averagePooling1d",(function(){return Bl})),n.d(i,"avgPool1d",(function(){return zl})),n.d(i,"avgPooling1d",(function(){return Wl})),n.d(i,"averagePooling2d",(function(){return Vl})),n.d(i,"avgPool2d",(function(){return Ul})),n.d(i,"avgPooling2d",(function(){return Gl})),n.d(i,"averagePooling3d",(function(){return Hl})),n.d(i,"avgPool3d",(function(){return ql})),n.d(i,"avgPooling3d",(function(){return Kl})),n.d(i,"globalAveragePooling1d",(function(){return Xl})),n.d(i,"globalAveragePooling2d",(function(){return Yl})),n.d(i,"globalMaxPooling1d",(function(){return Jl})),n.d(i,"globalMaxPooling2d",(function(){return Zl})),n.d(i,"maxPooling1d",(function(){return Ql})),n.d(i,"maxPooling2d",(function(){return td})),n.d(i,"maxPooling3d",(function(){return ed})),n.d(i,"gru",(function(){return nd})),n.d(i,"gruCell",(function(){return rd})),n.d(i,"lstm",(function(){return ad})),n.d(i,"lstmCell",(function(){return id})),n.d(i,"simpleRNN",(function(){return od})),n.d(i,"simpleRNNCell",(function(){return sd})),n.d(i,"convLstm2d",(function(){return ud})),n.d(i,"convLstm2dCell",(function(){return cd})),n.d(i,"rnn",(function(){return ld})),n.d(i,"stackedRNNCells",(function(){return dd})),n.d(i,"bidirectional",(function(){return hd})),n.d(i,"timeDistributed",(function(){return pd})),n.d(i,"globalMaxPool1d",(function(){return fd})),n.d(i,"globalMaxPool2d",(function(){return md})),n.d(i,"maxPool1d",(function(){return gd})),n.d(i,"maxPool2d",(function(){return bd})),n.d(i,"Layer",(function(){return we})),n.d(i,"RNN",(function(){return Gu})),n.d(i,"RNNCell",(function(){return Hu})),n.d(i,"input",(function(){return zs})),n.d(i,"gaussianNoise",(function(){return yd})),n.d(i,"gaussianDropout",(function(){return vd})),n.d(i,"alphaDropout",(function(){return xd})),n.d(i,"masking",(function(){return wd})),n.d(i,"rescaling",(function(){return kd}));var o={};n.r(o),n.d(o,"binaryAccuracy",(function(){return Sd})),n.d(o,"binaryCrossentropy",(function(){return Od})),n.d(o,"sparseCategoricalAccuracy",(function(){return _d})),n.d(o,"categoricalAccuracy",(function(){return Cd})),n.d(o,"categoricalCrossentropy",(function(){return Td})),n.d(o,"precision",(function(){return Id})),n.d(o,"recall",(function(){return Nd})),n.d(o,"cosineProximity",(function(){return Ed})),n.d(o,"meanAbsoluteError",(function(){return Ad})),n.d(o,"meanAbsolutePercentageError",(function(){return Rd})),n.d(o,"MAPE",(function(){return jd})),n.d(o,"mape",(function(){return Dd})),n.d(o,"meanSquaredError",(function(){return Fd})),n.d(o,"MSE",(function(){return Md})),n.d(o,"mse",(function(){return Pd}));var s={};n.r(s),n.d(s,"modelFromJSON",(function(){return js}));var u={};n.r(u),n.d(u,"l1l2",(function(){return $d})),n.d(u,"l1",(function(){return Ld})),n.d(u,"l2",(function(){return Bd}));var c=n("2ca8");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class l extends Error{constructor(t){super(t),Object.setPrototypeOf(this,l.prototype)}}class d extends Error{constructor(t){super(t),Object.setPrototypeOf(this,d.prototype)}}class h extends Error{constructor(t){super(t),Object.setPrototypeOf(this,h.prototype)}}class p extends Error{constructor(t){super(t),Object.setPrototypeOf(this,p.prototype)}}class f extends Error{constructor(t){super(t),Object.setPrototypeOf(this,f.prototype)}}Error;
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class m{constructor(t){this.maxEntries=t||100,this.cache=new Map}get(t){let e;return this.cache.has(t)&&(e=this.cache.get(t),this.cache.delete(t),this.cache.set(t,e)),e}put(t,e){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxEntries){const t=this.cache.keys().next().value;this.cache.delete(t)}this.cache.set(t,e)}getMaxEntries(){return this.maxEntries}setMaxEntries(t){if(t<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${t}.`);if(this.maxEntries>t)for(let e=0;e<this.maxEntries-t;e++){const t=this.cache.keys().next().value;this.cache.delete(t)}this.maxEntries=t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}{const n=new Array(e);return n.fill(t),n}}function b(t,e){if(!t)throw new f(e)}function y(t,e){let n=0;for(const r of t)r===e&&n++;return n}function v(t){return 1===t.length?t[0]:t}function x(t){return Array.isArray(t)?t:[t]}function w(t){const e=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2"),n=e.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==n[0]?n:"private"+n}function k(t){return t.length<=1||-1===t.indexOf("_")?t:t.replace(/[_]+(\w|$)/g,(t,e)=>e.toUpperCase())}let S={};function O(t){if(null===t||void 0===t)return null;const e={};return e["className"]=t.getClassName(),e["config"]=t.getConfig(),e}function _(t){if(null!=t&&"object"===typeof t)if(Array.isArray(t))t.forEach(t=>_(t));else{const e=Object.keys(t);for(const n of e){const e=t[n];null!=e&&"object"===typeof e&&(Array.isArray(e)||"ndarray"!==e["type"]||"number"!==typeof e["value"]?_(e):t[n]=e["value"])}}}function C(t,e={},n={},r="object",a=!1){if("string"===typeof t){const a=t;let i;if(a in n)i=n[a];else if(a in S)i=S[a];else if(i=e[a],null==i)throw new h(`Unknown ${r}: ${t}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}{const i=t;if(null==i["className"]||null==i["config"])throw new h(r+": Improper config format: "+JSON.stringify(i)+".\n'className' and 'config' must set.");const o=i["className"];let s,u;if(o in n?[s,u]=n[o]:o in S?[s,u]=S["className"]:o in e&&([s,u]=e[o]),null==s)throw new h(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(null!=u){const t={};for(const n of Object.keys(S))t[n]=S[n];for(const a of Object.keys(n))t[a]=n[a];const e=i["config"];e["customObjects"]=t;const r=Object.assign({},S);for(const a of Object.keys(n))S[a]=n[a];_(i["config"]);const o=u(s,i["config"],n,a);return S=Object.assign({},r),o}{const t=Object.assign({},S);for(const r of Object.keys(n))S[r]=n[r];const e=new s(i["config"]);return S=Object.assign({},t),e}}}function T(t,e){return t<e?-1:t>e?1:0}function I(t,e){return-1*T(t,e)}function N(t){if(null==t)return t;const e=[];for(const n of t)-1===e.indexOf(n)&&e.push(n);return e}function E(t){if(null==t)throw new h("Invalid value in obj: "+JSON.stringify(t));for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function A(t,e,n){if(null!=n&&t.indexOf(n)<0)throw new h(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function R(t,e,n=0,r=1/0){return b(n>=0),b(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(t=>typeof t===e)}function j(t,e){Array.isArray(t)?(c["util"].assert(t.length>0,()=>e+" is unexpectedly an empty array."),t.forEach((t,n)=>j(t,`element ${n+1} of ${e}`))):c["util"].assert(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got `+D(t)+".")}function D(t){return null===t?"null":Array.isArray(t)?"["+t.map(t=>D(t)).join(",")+"]":"string"===typeof t?`"${t}"`:""+t}function F(t,e,n){let r,a=null!=n?n():c["util"].now();const i=(...i)=>{const o=null!=n?n():c["util"].now();return o-a<e||(a=o,r=t(...i)),r};return i}function M(t){return"relu"===t?"relu":"linear"===t?"linear":"elu"===t?"elu":null}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
let P=0;function $(){return P++}const L={};function B(t=""){return t in L||(L[t]=0),L[t]+=1,t+L[t].toString()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const z=["channelsFirst","channelsLast"],W=["nearest","bilinear"],V=["valid","same","causal"],U=["max","avg"],G=["sum","mul","concat","ave"],H=new Map;function q(t){A(z,"DataFormat",t)}function K(t){A(W,"InterpolationFormat",t)}function X(t){A(V,"PaddingMode",t)}function Y(t){A(U,"PoolMode",t)}const J=[],Z="/";function Q(t,e){J.push(t);try{const t=e();return J.pop(),t}catch(n){throw J.pop(),n}}function tt(){return 0===J.length?"":J.join(Z)+Z}function et(t){if(!at(t))throw new Error("Not a valid tensor name: '"+t+"'");return tt()+t}function nt(t){if(!at(t))throw new Error("Not a valid tensor name: '"+t+"'");H.has(t)||H.set(t,0);const e=H.get(t);if(H.set(t,H.get(t)+1),e>0){const n=`${t}_${e}`;return H.set(n,1),n}return t}const rt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function at(t){return!!t.match(rt)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function it(t){return t===parseInt(t.toString(),10)}function ot(t,e,n){null==e&&(e=0),null==n&&(n=t.length);let r=1;for(let a=e;a<n;++a)r*=t[a];return r}function st(t){if(0===t.length)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function ut(t){if(0===t.length)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function ct(t,e){if(e<t)throw new h(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let lt;function dt(){return null==lt&&(lt=Object(c["backend"])().epsilon()),lt}function ht(){return"channelsLast"}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pt(t,e){return c["cast"](t,e)}function ft(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),c["reshape"](t,n)}function mt(t,e){return Object(c["tidy"])(()=>{if(2!==t.shape.length)throw new h(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=ft(t,1);return St(n,[1,e,1])})}function gt(t){const e=[ot(t.shape)];return c["reshape"](t,e)}function bt(t){if(t.rank<=1)throw new h(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],ot(t.shape,1)];return c["reshape"](t,e)}function yt(t,e,n){return Object(c["tidy"])(()=>{switch(t.rank){case 1:return c["slice1d"](t,e,n);case 2:return c["slice2d"](t,[e,0],[n,t.shape[1]]);case 3:return c["slice3d"](t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return c["slice4d"](t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return c["slice"](t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return c["slice"](t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new h("sliceAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}})}function vt(t,e,n){return Object(c["tidy"])(()=>{switch(t.rank){case 1:return c["slice1d"](t,e,n);case 2:return c["slice2d"](t,[0,e],[t.shape[0],n]);case 3:return c["slice3d"](t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return c["slice4d"](t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new h("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function xt(t,e,n,r){return Object(c["tidy"])(()=>{switch(t.rank){case 1:return c["slice1d"](t,e,n);case 2:switch(r){case 1:return yt(t,e,n);case 2:return vt(t,e,n);default:throw new h("The axis is not within the rank of the tensor "+r)}case 3:switch(r){case 1:return yt(t,e,n);case 2:return c["slice3d"](t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return vt(t,e,n);default:throw new h("The axis is not within the rank of the tensor "+r)}case 4:switch(r){case 1:return yt(t,e,n);case 2:return c["slice4d"](t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return c["slice4d"](t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return vt(t,e,n);default:throw new h("The axis is not within the rank of the tensor "+r)}default:throw new h("sliceAlongLastAxis() received an unsupported tensor rank: "+t.rank)}})}function wt(t,e=-1){let n;return e<0&&(n=t[0].rank,e=0!==n?n:0),e===t[0].rank&&(e=-1),c["concat"](t,e)}function kt(t,e){switch(t.rank){case 1:return c["concat1d"]([t,e]);case 2:return c["concat2d"]([t,e],0);case 3:return c["concat3d"]([t,e],0);case 4:return c["concat4d"]([t,e],0);default:throw new h("concatAlongFirstAxis() received an unsupported tensor rank: "+t.rank)}}function St(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new h(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return c["tile"](t,e)}function Ot(t,e=0,n=1,r,a){return c["randomNormal"](t,e,n,r,a)}function _t(t,e,n,r){if(t.rank<2||e.rank<2)throw new p(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const n=t.shape.slice(-1)[0],r=e.shape.slice(-2)[0];if(n!==r)throw new p(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = `+e.shape)}if(2===t.rank&&2===e.rank){const a=!1,i=!1;return c["fused"].matMul({a:t,b:e,transposeA:a,transposeB:i,bias:r?It(t.rank,r,ht()):null,activation:n})}{const a=t.shape.slice(),i=a.pop();t=c["reshape"](t,[-1,i]);const o=e.shape.slice(),s=o.pop(),u=o.pop(),l=[...o,s],d=Array.from({length:e.rank},(t,n)=>0===n?e.rank-2:n<=e.rank-2?n-1:n);e=c["reshape"](c["transpose"](e,d),[u,-1]);const h=[...a,...l],p=!1,f=!1;return c["reshape"](c["fused"].matMul({a:t,b:e,transposeA:p,transposeB:f,bias:r?It(t.rank,r,ht()):null,activation:n}),h)}}function Ct(t,e,n){return Object(c["tidy"])(()=>(e=Array.isArray(e)?Object(c["tensor1d"])(e,"int32"):c["cast"](e,"int32"),c["gather"](t,e,n)))}function Tt(t){return c["mul"](t,t)}function It(t,e,n){const r=e.shape;if(1!==e.rank&&e.rank!==t)throw new h("Unexpected bias dimensions: "+e.rank+"; expected it to be 1 or "+t);if(5===t){if("channelsFirst"===n)return 1===r.length?c["reshape"](e,[1,r[0],1,1,1]):c["reshape"](e,[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?c["reshape"](e,[1,1,1,1,r[0]]):c["reshape"](e,[1].concat(r))}else if(4===t){if("channelsFirst"===n)return 1===r.length?c["reshape"](e,[1,r[0],1,1]):c["reshape"](e,[1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?c["reshape"](e,[1,1,1,r[0]]):c["reshape"](e,[1].concat(r))}else if(3===t){if("channelsFirst"===n)return 1===r.length?c["reshape"](e,[1,r[0],1]):c["reshape"](e,[1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?c["reshape"](e,[1,1,r[0]]):c["reshape"](e,[1].concat(r))}else if(t<3)return e;throw new h("Unsupported input rank by biasAdd: "+e.rank)}function Nt(t,e,n){return Object(c["tidy"])(()=>(null==n&&(n=ht()),q(n),c["add"](t,It(t.rank,e,n))))}function Et(t,e=1){if(1!==e)throw new p(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return c["elu"](t)}function At(t){return Object(c["tidy"])(()=>c["div"](t,c["add"](c["abs"](t),1)))}function Rt(t,e,n,r){return Object(c["tidy"])(()=>c["dropout"](t,e,n,r))}function jt(t){return Object(c["tidy"])(()=>{const e=c["add"](.5,c["mul"](.2,t));return c["clipByValue"](e,0,1)})}function Dt(t,e,n=!1){return n?t():e()}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Ft=["fanIn","fanOut","fanAvg"],Mt=["normal","uniform","truncatedNormal"];
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Pt(t){A(Ft,"FanMode",t)}function $t(t){A(Mt,"Distribution",t)}class Lt extends c["serialization"].Serializable{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Bt extends Lt{apply(t,e){return Object(c["zeros"])(t,e)}}Bt.className="Zeros",c["serialization"].registerClass(Bt);class zt extends Lt{apply(t,e){return Object(c["ones"])(t,e)}}zt.className="Ones",c["serialization"].registerClass(zt);class Wt extends Lt{constructor(t){if(super(),"object"!==typeof t)throw new h("Expected argument of type ConstantConfig but got "+t);if(void 0===t.value)throw new h("config must have value set but got "+t);this.value=t.value}apply(t,e){return Object(c["tidy"])(()=>Object(c["mul"])(Object(c["scalar"])(this.value),Object(c["ones"])(t,e)))}getConfig(){return{value:this.value}}}Wt.className="Constant",c["serialization"].registerClass(Wt);class Vt extends Lt{constructor(t){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=t.minval||this.DEFAULT_MINVAL,this.maxval=t.maxval||this.DEFAULT_MAXVAL,this.seed=t.seed}apply(t,e){return Object(c["randomUniform"])(t,this.minval,this.maxval,e)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}Vt.className="RandomUniform",c["serialization"].registerClass(Vt);class Ut extends Lt{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32","float32"!==e&&"int32"!==e)throw new p(`randomNormal does not support dType ${e}.`);return Ot(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Ut.className="RandomNormal",c["serialization"].registerClass(Ut);class Gt extends Lt{constructor(t){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=t.mean||this.DEFAULT_MEAN,this.stddev=t.stddev||this.DEFAULT_STDDEV,this.seed=t.seed}apply(t,e){if(e=e||"float32","float32"!==e&&"int32"!==e)throw new p(`truncatedNormal does not support dType ${e}.`);return Object(c["truncatedNormal"])(t,this.mean,this.stddev,e,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}Gt.className="TruncatedNormal",c["serialization"].registerClass(Gt);class Ht extends Lt{constructor(t){super(),this.gain=null!=t.gain?t.gain:1}apply(t,e){return Object(c["tidy"])(()=>{if(2!==t.length||t[0]!==t[1])throw new h("Identity matrix initializer can only be used for 2D square matrices.");return Object(c["mul"])(this.gain,Object(c["eye"])(t[0]))})}getConfig(){return{gain:this.gain}}}function qt(t,e="channelsLast"){let n,r;if(q(e),2===t.length)n=t[0],r=t[1];else if(-1!==[3,4,5].indexOf(t.length)){if("channelsFirst"===e){const e=ot(t,2);n=t[1]*e,r=t[0]*e}else if("channelsLast"===e){const e=ot(t,0,t.length-2);n=t[t.length-2]*e,r=t[t.length-1]*e}}else{const e=ot(t);n=Math.sqrt(e),r=Math.sqrt(e)}return[n,r]}Ht.className="Identity",c["serialization"].registerClass(Ht);class Kt extends Lt{constructor(t){if(super(),t.scale<0)throw new h("scale must be a positive float. Got: "+t.scale);this.scale=null==t.scale?1:t.scale,this.mode=null==t.mode?"fanIn":t.mode,Pt(this.mode),this.distribution=null==t.distribution?"normal":t.distribution,$t(this.distribution),this.seed=t.seed}apply(t,e){const n=qt(t),r=n[0],a=n[1];let i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){const n=Math.sqrt(i);if(e=e||"float32","float32"!==e&&"int32"!==e)throw new p(`${this.getClassName()} does not support dType ${e}.`);return Object(c["truncatedNormal"])(t,0,n,e,this.seed)}{const n=Math.sqrt(3*i);return Object(c["randomUniform"])(t,-n,n,e)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Kt.className="VarianceScaling",c["serialization"].registerClass(Kt);class Xt extends Kt{constructor(t){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}Xt.className="GlorotUniform",c["serialization"].registerClass(Xt);class Yt extends Kt{constructor(t){super({scale:1,mode:"fanAvg",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}Yt.className="GlorotNormal",c["serialization"].registerClass(Yt);class Jt extends Kt{constructor(t){super({scale:2,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}Jt.className="HeNormal",c["serialization"].registerClass(Jt);class Zt extends Kt{constructor(t){super({scale:2,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}Zt.className="HeUniform",c["serialization"].registerClass(Zt);class Qt extends Kt{constructor(t){super({scale:1,mode:"fanIn",distribution:"normal",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}Qt.className="LeCunNormal",c["serialization"].registerClass(Qt);class te extends Kt{constructor(t){super({scale:1,mode:"fanIn",distribution:"uniform",seed:null==t?null:t.seed})}getClassName(){return Kt.className}}te.className="LeCunNormal",c["serialization"].registerClass(te);class ee extends Lt{constructor(t){if(super(),this.DEFAULT_GAIN=1,this.gain=null==t.gain?this.DEFAULT_GAIN:t.gain,this.seed=t.seed,null!=this.seed)throw new p("Random seed is not implemented for Orthogonal Initializer yet.")}apply(t,e){return Object(c["tidy"])(()=>{if(t.length<2)throw new p("Shape must be at least 2D.");t[0]*t[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${t[0]*t[1]}) elements: Slowness may result.`);const e=t[0]>t[1]?[t[1],t[0]]:t,n=Ot(e,0,1,"float32");let r=c["linalg"].gramSchmidt(n);return t[0]>t[1]&&(r=Object(c["transpose"])(r)),Object(c["mul"])(this.gain,r)})}getConfig(){return{gain:this.gain,seed:this.seed}}}ee.className="Orthogonal",c["serialization"].registerClass(ee);const ne={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function re(t,e={}){return C(t,c["serialization"].SerializationMap.getMap().classNameMap,e,"initializer")}function ae(t){return O(t)}function ie(t){if("string"===typeof t){const e=t in ne?ne[t]:t;if("GlorotNormal"===e)return new Yt;if("GlorotUniform"===e)return new Xt;if("HeNormal"===e)return new Jt;if("HeUniform"===e)return new Zt;if("LeCunNormal"===e)return new Qt;if("LeCunUniform"===e)return new te;{const t={};return t["className"]=e,t["config"]={},re(t)}}return t instanceof Lt?t:re(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oe(t){return Array.isArray(t)&&Array.isArray(t[0])}function se(t){return 0===t.length?[]:Array.isArray(t[0])?t:[t]}function ue(t){let e;if(Array.isArray(t)){if(1!==t.length)throw new h("Expected Tensor length to be 1; got "+t.length);e=t[0]}else e=t;return e}function ce(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(1===t.length)return t=t,t[0];throw new h("Expected exactly 1 Shape; got "+t.length)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function le(t){let e=0;for(const n of t)0===n.shape.length?e+=1:e+=n.shape.reduce((t,e)=>t*e);return e}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const de="Variable";class he{constructor(t,e="float32",n=de,r=!0,a=null){this.dtype=null==e?"float32":e,this.shape=t.shape,this.id=$(),n=null==n?de:n,this.originalName=et(n),this.name=nt(this.originalName),this.trainable_=r,this.constraint=a,this.val=c["variable"](t,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(t){return this.assertNotDisposed(),pe(this.val,t),this.val.id!==t.id&&(this.val.assign(t),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(t){this.trainable_=t,this.val.trainable=t}}function pe(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function fe(t){return t.map(t=>t.read())}function me(t){t.forEach(t=>{const e=t[0];e.write(t[1])})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class ge{constructor(t){this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}}}class be{constructor(t,e,n,r,a,i,o){this.dtype=t,this.shape=e,this.sourceLayer=n,this.inputs=r,this.callArgs=a,this.outputTensorIndex=o,this.id=$(),null!=i&&(this.originalName=et(i),this.name=nt(this.originalName)),this.rank=e.length}}let ye=0;class ve{constructor(t,e){this.callArgs=e,this.id=ye++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;for(const n of t.inboundLayers)null!=n&&n.outboundNodes.push(this);t.outboundLayer.inboundNodes.push(this)}getConfig(){const t=[];for(const e of this.inboundLayers)null!=e?t.push(e.name):t.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let xe=0;class we extends c["serialization"].Serializable{constructor(t={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=xe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let e=t.name;if(!e){const t=this.getClassName();e=w(t)+"_"+B(t)}if(this.name=e,this.trainable_=null==t.trainable||t.trainable,null!=t.inputShape||null!=t.batchInputShape){let e;if(null!=t.batchInputShape)e=t.batchInputShape;else if(null!=t.inputShape){let n=null;null!=t.batchSize&&(n=t.batchSize),e=[n].concat(t.inputShape)}this.batchInputShape=e;let n=t.dtype;null==n&&(n=t.inputDType),null==n&&(n="float32"),this.dtype=n}null!=t.weights?this.initialWeights=t.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(t,e){return t.name+"_ib-"+e.toString()}getNodeAtIndex(t,e){if(0===this.inboundNodes.length)throw new d(`The layer has never been called and thus has no defined ${e}.`);if(this.inboundNodes.length<=t)throw new h(`Asked to get ${e} at node ${t}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[t]}getInputAt(t){return v(this.getNodeAtIndex(t,"input").inputTensors)}getOutputAt(t){return v(this.getNodeAtIndex(t,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new l("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new l("Layer "+this.name+" is not connected, no input to return.");return v(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(0===this.inboundNodes.length)throw new l("Layer "+this.name+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new l("Layer "+this.name+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return v(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(t=>t())}get updates(){return this._updates}get built(){return this._built}set built(t){this._built=t}get trainable(){return this.trainable_}set trainable(t){this._trainableWeights.forEach(e=>e.trainable=t),this.trainable_=t}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(t=>t.trainable):[]}set trainableWeights(t){this._trainableWeights=t}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(t=>!t.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(t){this._nonTrainableWeights=t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(t){if(t=x(t),null==this.inputSpec||0===this.inputSpec.length)return;const e=x(this.inputSpec);if(t.length!==e.length)throw new h(`Layer ${this.name} expects ${e.length} inputs, but it received ${t.length} input tensors. Input received: `+t);for(let n=0;n<t.length;n++){const r=t[n],a=e[n];if(null==a)continue;const i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new h(`Input ${n} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${i}`);if(null!=a.maxNDim&&i>a.maxNDim)throw new h(`Input ${n} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${i}`);if(null!=a.minNDim&&i<a.minNDim)throw new h(`Input ${n} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${i}.`);if(null!=a.dtype&&r.dtype!==a.dtype)throw new h(`Input ${n} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${r.dtype}.`);if(a.axes){const t=r.shape;for(const e in a.axes){const r=Number(e),i=a.axes[e],o=r>=0?t[r]:t[t.length+r];if(null!=i&&-1===[i,null].indexOf(o))throw new h(`Input ${n} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${i} but got shape ${t}.`)}}if(null!=a.shape)for(let t=0;t<a.shape.length;++t){const e=a.shape[t],i=r.shape[t];if(null!=e&&null!=i&&e!==i)throw new h(`Input ${n} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${r.shape}.`)}}}call(t,e){return t}invokeCallHook(t,e){null!=this._callHook&&this._callHook(t,e)}setCallHook(t){this._callHook=t}clearCallHook(){this._callHook=null}apply(t,e){e=e||{},this.assertNotDisposed();const n=x(t);let r=!0;for(const i of n)if(!(i instanceof be)){r=!1;break}let a=!0;for(const i of n)if(i instanceof be){a=!1;break}if(r===a)throw new h("Arguments to apply() must be all SymbolicTensors or all Tensors");return Q(this.name,()=>{if(!this.built){this.assertInputCompatibility(t);const e=[];for(const n of x(t))e.push(n.shape);this.build(v(e)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),null===this._refCount&&a&&(this._refCount=1)}if(this.assertInputCompatibility(t),a){let r=this.call(t,e);const a=x(r),i=[];for(let t of a)-1!==n.indexOf(t)&&(t=t.clone()),i.push(t);if(r=v(i),null!=this.activityRegularizer)throw new p("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return r}{const n=ke(t),r=this.computeOutputShape(n);let a;const i=Se(t);if(this.warnOnIncompatibleInputShape(Array.isArray(t)?n[0]:n),a=null!=r&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new be(i,n,this,x(t),e,this.name,r)):new be(i,r,this,x(t),e,this.name),this.addInboundNode(t,a,null,null,n,r,e),this._refCount++,null!=this.activityRegularizer)throw new p("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}})}warnOnIncompatibleInputShape(t){if(null!=this.batchInputShape)if(t.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+JSON.stringify(t)+") does not match that of the "+`batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer `+this.name);else{let e=!1;this.batchInputShape.forEach((n,r)=>{null!=n&&null!=t[r]&&t[r]!==n&&(e=!0)}),e&&console.warn(`The shape of the input tensor (${JSON.stringify(t)}) does not match the expectation of layer ${this.name}: `+JSON.stringify(this.batchInputShape))}}get outputShape(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new l(`The layer ${this.name} has never been called and thus has no defined output shape.`);const t=[];for(const e of this.inboundNodes){const n=JSON.stringify(e.outputShapes);-1===t.indexOf(n)&&t.push(n)}if(1===t.length){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&1===t.length?t[0]:t}throw new l(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new d(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return le(this.weights)}build(t){this.built=!0}getWeights(t=!1){return fe(t?this.trainableWeights:this.weights)}setWeights(t){Object(c["tidy"])(()=>{const e=this.weights;if(e.length!==t.length)throw new h(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${t.length}, but the layer was expecting ${e.length} weights. Provided weights: ${t}...`);if(0===e.length)return;const n=[],r=fe(e);for(let a=0;a<r.length;++a){const i=r[a],o=e[a],s=t[a];if(!c["util"].arraysEqual(i.shape,s.shape))throw new h(`Layer weight shape ${i.shape} not compatible with provided weight shape `+s.shape);n.push([o,s])}me(n)})}addWeight(t,e,n,r,a,i,o,s){if(-1!==this._addedWeightNames.indexOf(t))throw new h(`Duplicate weight name ${t} for layer ${this.name}`);this._addedWeightNames.push(t),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=null!=s?s():ie("zeros"));const u=r.apply(e,n),c=new he(u,n,t,i,o);return u.dispose(),null!=a&&this.addLoss(()=>a.apply(c.read())),null==i&&(i=!0),i?this._trainableWeights.push(c):this._nonTrainableWeights.push(c),c}setFastWeightInitDuringBuild(t){this.fastWeightInitDuringBuild=t}addLoss(t){null==t||Array.isArray(t)&&0===t.length||(t=x(t),void 0!==this._losses&&null!==this._losses&&this.losses.push(...t))}computeOutputShape(t){return t}computeMask(t,e){if(!this.supportsMasking){if(null!=e){if(!Array.isArray(e))throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);e.forEach(t=>{if(null!=t)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)})}return null}return e}addInboundNode(t,e,n,r,a,i,o=null){const s=x(t);e=x(e),n=x(n),r=x(r),a=se(a),i=se(i);const u=[],c=[],l=[];for(const d of s)u.push(d.sourceLayer),c.push(d.nodeIndex),l.push(d.tensorIndex);new ve({outboundLayer:this,inboundLayers:u,nodeIndices:c,tensorIndices:l,inputTensors:s,outputTensors:e,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(let d=0;d<e.length;d++)e[d].sourceLayer=this,e[d].nodeIndex=this.inboundNodes.length-1,e[d].tensorIndex=d}getConfig(){const t={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(t["batchInputShape"]=this.batchInputShape),null!=this.dtype&&(t["dtype"]=this.dtype),t}disposeWeights(){return this.weights.forEach(t=>t.dispose()),this.weights.length}assertNotDisposed(){if(0===this._refCount)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(null===this._refCount)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let t=0;return 0===--this._refCount&&(t=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:t}}}function ke(t){t=x(t);const e=[];for(const n of t)e.push(n.shape);return v(e)}function Se(t){return"float32"}function Oe(t,e,n){if((null==e||null!=n&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),0===e.inboundNodes.length)return[t];{const t=e.inboundNodes[n];if(0===t.inboundLayers.length)return t.inputTensors;{const e=[];for(let n=0;n<t.inboundLayers.length;n++){const r=t.inputTensors[n],a=t.inboundLayers[n],i=t.nodeIndices[n],o=Oe(r,a,i);for(const t of o)-1===e.indexOf(t)&&e.push(t)}return e}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _e extends we{constructor(t){if(super({dtype:t.dtype,name:null!=t.name?t.name:B("input").toString()}),null==t.batchSize&&(t.batchSize=null),null==t.sparse&&(t.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=t.sparse,null!=t.inputShape&&null!=t.batchInputShape)throw new h("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let e=t.batchInputShape;if(null==e){if(null==t.inputShape)throw new h("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");e=[t.batchSize].concat(t.inputShape)}else if(null!=t.batchSize)throw new h("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const n=t.dtype||"float32";this.batchInputShape=e,this.dtype=n,this.inputSpec=[{shape:e}];const r=new be(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new ve({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[e],outputShapes:[e]})}apply(t,e){throw new h("Cannot pass any input to an InputLayer's apply() method. InputLayer name: "+this.name)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}function Ce(t){if(null==t.batchShape&&null==t.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=t.batchShape&&null!=t.shape)throw new h("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;null!=t.shape&&null==e&&(e=[null].concat(t.shape));let n=t.dtype;null==n&&(n="float32");const r=new _e({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}),a=r.inboundNodes[0].outputTensors;return a[0]}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Te(t,e){if(null==t.dtype||t.dtype===e.dtype)return e;try{return Object(c["cast"])(e,t.dtype)}catch(n){throw new h(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}_e.className="InputLayer",c["serialization"].registerClass(_e);class Ie{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof Ie)for(const e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(null==t)return;for(const e of t)this.add(e.key,e.value)}}add(t,e,n){if(null!=this.id2Value[t.id])throw new h(`Duplicate key: name=${t.name}, id=${t.id}`);return this.id2Value[t.id]=Te(t,e),this.name2Id[t.name]=t.id,null!=n&&(this.id2Mask[t.id]=n),this}addFeed(t){this.add(t.key,t.value)}hasKey(t){return null!=this.id2Value[t.id]}names(){return Object.keys(this.name2Id)}getValue(t){if(t instanceof be){if(null==this.id2Value[t.id])throw new h("Nonexistent key: "+t.name);return this.id2Value[t.id]}{const e=this.name2Id[t];if(null==e)throw new h("Feed dict has no SymbolicTensor name: "+t);return this.id2Value[e]}}getMask(t){if(t instanceof be){if(null==this.id2Value[t.id])throw new h("Nonexistent key: "+t.name);return this.id2Mask[t.id]}{const e=this.name2Id[t];if(null==e)throw new h("Feed dict has no SymbolicTensor name: "+t);return this.id2Mask[e]}}disposeMasks(){null!=this.id2Mask&&Object(c["dispose"])(this.id2Mask)}}const Ne=new m,Ee=new m;function Ae(t){null!=Ne&&Ne.setMaxEntries(t),null!=Ee&&Ee.setMaxEntries(t)}function Re(t,e,n,r){const a=null!=n&&n["training"],i=Array.isArray(t),o=i?t:[t],s=o.map(t=>t.name),u=[],l=e.names();for(const c of s)-1!==l.indexOf(c)?u.push(e.getValue(c)):u.push(null);null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);const d=s.join(",")+"|"+e.names().sort().join(",");let h,p=Ne.get(d);if(null==p){const t=je(o,e);p=t.sorted,h=t.recipientCounts,Ne.put(d,p),Ee.put(d,h)}h={},a||Object.assign(h,Ee.get(d));const f=new Ie(e);for(let m=0;m<p.length;++m){if(null!=r){const t=Object(c["memory"])().numTensors;t>r.maxNumTensors&&(r.maxNumTensors=t),t<r.minNumTensors&&(r.minNumTensors=t)}const t=p[m],i=t.sourceLayer;if(i instanceof _e)continue;const o=[],l=[],d=[];let g=!1;for(const n of t.inputs){const t=f.getValue(n),r=f.getMask(n);o.push(t),l.push(r),null!=r&&(g=!0),a||(h[n.name]--,0!==h[n.name]||e.hasKey(n)||-1!==s.indexOf(n.name)||t.isDisposed||!0===n.sourceLayer.stateful||d.push(t))}g&&(n=n||{},n["mask"]=l[0]);const b=x(i.apply(o,n));let y=null;i.supportsMasking&&(y=i.computeMask(o,l));const v=Me(t),w=Array.isArray(v)?v:[v];for(let e=0;e<w.length;++e){f.hasKey(w[e])||f.add(w[e],b[e],Array.isArray(y)?y[0]:y);const t=s.indexOf(w[e].name);-1!==t&&(u[t]=b[e])}a||Object(c["dispose"])(d)}return f.disposeMasks(),i?u:u[0]}function je(t,e){c["util"].assert(null!=t&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(1===t.length){const a=Fe(t[0],e);n=a.sorted,r=a.recipientMap}else{const a=new Set;for(const i of t){const{sorted:t,recipientMap:o}=Fe(i,e);for(const e of t)a.has(e.name)||(n.push(e),a.add(e.name));for(const e in o)null==r[e]&&(r[e]=new Set),o[e].forEach(t=>r[e].add(t))}}return{sorted:n,recipientCounts:De(r)}}function De(t){const e={};for(const n in t)e[n]=t[n].size;return e}function Fe(t,e){const n=new Set,r=[],a={};for(const s of e.names())n.add(s);const i=[],o=[];i.push(t);while(i.length>0){const t=i[i.length-1];if(n.has(t.name)){i.pop();continue}const e=o[o.length-1]===i.length-1;if(0===t.inputs.length||e)i.pop(),r.push(t),n.add(t.name),e&&o.pop();else{o.push(i.length-1);for(const e of t.inputs)null==a[e.name]&&(a[e.name]=new Set),a[e.name].add(t.name),n.has(e.name)||i.push(e)}}return{sorted:r,recipientMap:a}}function Me(t){let e;if(1===t.sourceLayer.inboundNodes.length)e=t.sourceLayer.output;else{let n=null;for(let e=0;e<t.sourceLayer.inboundNodes.length;++e)for(const r of t.sourceLayer.inboundNodes[e].outputTensors)if(r.id===t.id){n=e;break}e=t.sourceLayer.getOutputAt(n)}return e}
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pe=Object(c["env"])();Pe.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Ae);var $e=n("388c"),Le=n("7b50"),Be=n("0db7"),ze=n("aeae");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const We={kernelName:$e["a"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(ze["a"])(Object(Le["a"])(n,"float32"),-1))}}};var Ve=n("fb3e"),Ue=n("ea03"),Ge=n("1ba2"),He=n("330c"),qe=n("c794"),Ke=n("0233");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Xe={kernelName:$e["b"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(qe["a"])(Object(Le["a"])(n,"float32")),r=Object(He["a"])(Object(Ke["a"])(Object(Ge["a"])(1),e));return Object(Ue["a"])(Object(Ve["a"])(t,r))}}}},Ye={kernelName:$e["c"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(He["a"])(Object(Ke["a"])(Object(qe["a"])(Object(Le["a"])(n,"float32")),1));return Object(Ve["a"])(t,e)}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Je=n("ae86"),Ze=n("3a0f"),Qe=n("6c52");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const tn={kernelName:$e["d"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Je["assertAndGetBroadcastShape"](n.shape,r.shape),i=()=>{let e=t;const r=Je["getReductionAxes"](n.shape,a);return r.length>0&&(e=Object(Qe["a"])(e,r)),Object(Ze["a"])(e,n.shape)},o=()=>{let e=t;const n=Je["getReductionAxes"](r.shape,a);return n.length>0&&(e=Object(Qe["a"])(e,n)),Object(Ze["a"])(e,r.shape)};return{a:i,b:o}}},en={kernelName:$e["e"],saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((e,r)=>{n[r]=()=>t.clone()}),n}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nn=n("96d8");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rn={kernelName:$e["h"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(nn["a"])(n)}}},an={kernelName:$e["i"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(nn["a"])(n)}}},on={kernelName:$e["j"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(He["a"])(Object(Ke["a"])(Object(Ge["a"])(1),Object(qe["a"])(Object(Le["a"])(n,"float32")))))}}};
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var sn=n("a08f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const un={kernelName:$e["k"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(He["a"])(Object(sn["a"])(Object(Ge["a"])(1),Object(qe["a"])(Object(Le["a"])(n,"float32"))));return Object(Ve["a"])(t,e)}}}},cn={kernelName:$e["m"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(Je["assertAndGetBroadcastShape"])(n.shape,r.shape),i=()=>{const e=Object(sn["a"])(Object(qe["a"])(n),Object(qe["a"])(r));let i=Object(Be["a"])(t,Object(Ve["a"])(r,e));const o=Object(Je["getReductionAxes"])(n.shape,a);return o.length>0&&(i=Object(Qe["a"])(i,o)),Object(Ze["a"])(i,n.shape)},o=()=>{const e=Object(sn["a"])(Object(qe["a"])(n),Object(qe["a"])(r));let i=Object(Ue["a"])(Object(Be["a"])(t,Object(Ve["a"])(n,e)));const o=Object(Je["getReductionAxes"])(r.shape,a);return o.length>0&&(i=Object(Qe["a"])(i,o)),Object(Ze["a"])(i,r.shape)};return{a:i,b:o}}},ln={kernelName:$e["l"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(sn["a"])(Object(qe["a"])(Object(Le["a"])(n,"float32")),1))}}},dn={kernelName:$e["n"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(Ke["a"])(Object(Ge["a"])(1),Object(qe["a"])(Object(Le["a"])(n,"float32"))))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hn=n("219b"),pn=n("4ffe"),fn=n("df00"),mn=n("086c"),gn=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bn(t,e,n,r,a,i){const o=Object(pn["a"])(t,"dy","avgPool3dGrad"),s=Object(pn["a"])(e,"input","avgPool3dGrad");let u=o,c=s,l=!1;4===s.rank&&(l=!0,u=Object(Ze["a"])(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),c=Object(Ze["a"])(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),fn["b"](5===u.rank,()=>"Error in avgPool3dGrad: dy must be rank 5 but got rank "+u.rank+"."),fn["b"](5===c.rank,()=>"Error in avgPool3dGrad: input must be rank 5 but got rank "+c.rank+"."),Object(mn["a"])("avgPool3dGrad",a,i);const d={dy:u,input:c},h={filterSize:n,strides:r,pad:a,dimRoundingMode:i},p=hn["a"].runKernel($e["q"],d,h);return l?Object(Ze["a"])(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const yn=Object(gn["b"])({avgPool3dGrad_:bn}),vn={kernelName:$e["p"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o,dimRoundingMode:s}=n;return{x:()=>yn(t,r,a,i,o,s)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function xn(t,e,n,r,a){const i=Object(pn["a"])(t,"dy","avgPoolGrad"),o=Object(pn["a"])(e,"input","avgPoolGrad");fn["b"](o.rank===i.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${i.rank})`);let s=o,u=i,c=!1;3===o.rank&&(c=!0,s=Object(Ze["a"])(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=Object(Ze["a"])(i,[1,i.shape[0],i.shape[1],i.shape[2]])),fn["b"](4===u.rank,()=>"Error in avgPoolGrad: dy must be rank 4 but got rank "+u.rank+"."),fn["b"](4===s.rank,()=>"Error in avgPoolGrad: input must be rank 4 but got rank "+s.rank+".");const l={dy:u,input:s},d={filterSize:n,strides:r,pad:a},h=hn["a"].runKernel($e["r"],l,d);return c?Object(Ze["a"])(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const wn=Object(gn["b"])({avgPoolGrad_:xn}),kn={kernelName:$e["o"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:a,strides:i,pad:o}=n;return{x:()=>wn(t,r,a,i,o)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Sn=n("5727");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const On={kernelName:$e["s"],inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,a]=e,{transposeA:i,transposeB:o}=n;return i||o?!i&&o?{a:()=>Object(Sn["a"])(t,a,!1,!1),b:()=>Object(Sn["a"])(t,r,!0,!1)}:i&&!o?{a:()=>Object(Sn["a"])(a,t,!1,!0),b:()=>Object(Sn["a"])(r,t,!1,!1)}:{a:()=>Object(Sn["a"])(a,t,!0,!0),b:()=>Object(Sn["a"])(t,r,!0,!0)}:{a:()=>Object(Sn["a"])(t,a,!1,!0),b:()=>Object(Sn["a"])(r,t,!0,!1)}}};var _n=n("cd00");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cn={kernelName:$e["t"],gradFunc:(t,e,n)=>{const{blockShape:r,crops:a}=n;return{x:()=>Object(_n["a"])(t,r,a)}}},Tn={kernelName:$e["w"],gradFunc:(t,e,n)=>{const r=n,a=r.inputShape,i=r.shape,o=Array.from(i);for(let u=a.length-1;u>=0;u--)if(a[u]===i[u])o[u]=1;else if(1!==a[u])throw new Error(`broadcastTo(): [${a}] cannot be broadcast to [${i}].`);const s=[];for(let u=0;u<o.length;u++)o[u]>1&&s.push(u);return{x:()=>Object(Qe["a"])(t,s,!0)}}},In={kernelName:$e["x"],gradFunc:t=>({x:()=>t.clone()})},Nn={kernelName:$e["y"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var En=n("b970"),An=n("469c"),Rn=n("5dbe"),jn=n("f9cd");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Dn={kernelName:$e["z"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:a,clipValueMax:i}=n;return{x:()=>Object(jn["a"])(Object(Rn["a"])(Object(En["a"])(r,a),Object(An["a"])(r,i)),t,Object(nn["a"])(t))}}},Fn={kernelName:$e["B"],inputsToSave:["x"],gradFunc:We.gradFunc};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Mn=n("8453");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pn={kernelName:$e["C"],saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(t=>t.shape),{axis:a}=n,i=Object(fn["I"])(a,e[0].shape)[0],o=r.map(t=>t[i]),s=Object(Mn["a"])(t,o,i);return s.map(t=>()=>t)}};var $n=n("322b"),Ln=n("609e");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const Bn={kernelName:$e["D"],inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{dilations:i,strides:o,pad:s,dataFormat:u}=n;return fn["b"](mn["j"](i),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`),{x:()=>Object(Ln["a"])(r.shape,t,a,o,s,u),filter:()=>Object($n["a"])(r,t,a.shape,o,s,u)}}};var zn=n("4b53");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wn={kernelName:$e["F"],inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,{strides:i,pad:o,dataFormat:s,dimRoundingMode:u}=n;return{dy:()=>Object(zn["a"])(t,a,i,o,s,1,u),filter:()=>Object($n["a"])(t,r,a.shape,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vn(t,e,n,r,a){let i=t;4===t.rank&&(i=Object(Ze["a"])(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let o=e;4===o.rank&&(o=Object(Ze["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),fn["b"](5===i.rank,()=>"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."),fn["b"](5===o.rank,()=>"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."),fn["b"](5===n.length,()=>"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."),fn["b"](i.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${i.shape[4]}) must match input depth in filter (${n[3]}.`),fn["b"](o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);const s={x:i,dy:o},u={strides:r,pad:a,filterShape:n};return hn["a"].runKernel($e["H"],s,u)}const Un=Object(gn["b"])({conv3DBackpropFilter_:Vn});var Gn=n("3d68");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hn={kernelName:$e["G"],inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i}=n;fn["b"](Object(mn["j"])(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[o,s]=e;return{x:()=>Object(Gn["a"])(o.shape,t,s,a,i),filter:()=>Un(o,t,s.shape,a,i)}}};var qn=n("8820");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kn={kernelName:$e["J"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(Object(Ue["a"])(Object(qn["a"])(Object(Le["a"])(n,"float32"))),t)}}};var Xn=n("d7b7");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yn={kernelName:$e["K"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(Object(Xn["a"])(Object(Le["a"])(n,"float32")),t)}}};var Jn=n("97ca"),Zn=n("1c95"),Qn=n("6cff");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const tr={kernelName:$e["N"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a,exclusive:i,reverse:o}=n;return{x:()=>{const e=Object(Jn["f"])([a],r.rank);let n=Object(Zn["a"])(t,a,i,!o);return null!=e&&(n=Object(Qn["a"])(n,e)),n}}}};var er=n("1be3"),nr=n("7aed");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const rr={kernelName:$e["Q"],inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:a,pad:i,dimRoundingMode:o}=n,s=null==r?[1,1]:r;fn["b"](mn["j"](s),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[u,c]=e;return fn["b"](4===u.rank,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${u.rank}.`),fn["b"](4===c.rank,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),fn["b"](u.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),fn["b"](mn["i"](a,s),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${a} and dilations '${s}'.`),mn["a"]("depthwiseConv2d",i,o),{x:()=>Object(nr["a"])(u.shape,t,c,a,i,s,o),filter:()=>Object(er["a"])(u,t,c.shape,a,i,s,o)}}},ar={kernelName:$e["U"],inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,a]=e,i={x:r,filter:a,dy:t},o={x:r,filter:a,dy:t};return{x:()=>hn["a"].runKernel($e["W"],i,n),filter:()=>hn["a"].runKernel($e["V"],o,n)}}},ir={kernelName:$e["Y"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>hn["a"].runKernel($e["Z"],r)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var or=n("54eb");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sr={kernelName:$e["bb"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Object(Be["a"])(Object(or["a"])(Object(Ue["a"])(Object(qe["a"])(n))),2/Math.sqrt(Math.PI));return{x:()=>Object(Be["a"])(t,r)}}},ur={kernelName:$e["cb"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,n)}}},cr={kernelName:$e["db"],inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>Object(Ze["a"])(t,n.shape)}}},lr={kernelName:$e["eb"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(or["a"])(n))}}},dr={kernelName:$e["ib"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})},hr={kernelName:$e["jb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(Je["assertAndGetBroadcastShape"])(n.shape,r.shape),i=()=>{const e=Object(Ve["a"])(t,Object(Le["a"])(r,"float32")),i=Object(Je["getReductionAxes"])(n.shape,a);return i.length>0?Object(Ze["a"])(Object(Qe["a"])(e,i),n.shape):e},o=()=>{let e=Object(Be["a"])(t,Object(Le["a"])(n,"float32"));const i=Object(Je["getReductionAxes"])(r.shape,a);i.length>0&&(e=Object(Ze["a"])(Object(Qe["a"])(e,i),r.shape));const o=Object(qe["a"])(r);return Object(Ue["a"])(Object(Ve["a"])(e,Object(Le["a"])(o,"float32")))};return{a:i,b:o}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var pr=n("a02a"),fr=n("565f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const mr={kernelName:$e["lb"],inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[a,i,o,s]=e,u=null==s?Object(Ge["a"])(1):s,c=Object(Je["getReductionAxes"])(i.shape,a.shape),l=[];if(1===i.rank){for(let t=0;t<a.shape.length-1;++t)l.push(a.shape[t]);l.push(1)}const d=Object(Ke["a"])(a,i),h=Object(Be["a"])(t,u),p=Object(pr["a"])(Object(sn["a"])(o,Object(Ge["a"])(r))),f=Object(Be["a"])(Object(Be["a"])(Object(Be["a"])(p,p),p),Object(Ge["a"])(-.5)),m=()=>1===i.rank?Object(Ze["a"])(Object(Be["a"])(Object(Be["a"])(t,Object(fr["a"])(Object(Ze["a"])(p,[1,1,1,i.shape[0]]),l)),u),a.shape):Object(Ze["a"])(Object(Be["a"])(Object(Be["a"])(t,p),u),a.shape),g=()=>{let t=Object(Be["a"])(Object(Be["a"])(p,Object(Ge["a"])(-1)),h);return 1===i.rank&&(t=Object(Qe["a"])(t,c)),Object(Ze["a"])(t,i.shape)},b=()=>{let t=Object(Be["a"])(Object(Be["a"])(f,d),h);return 1===i.rank&&(t=Object(Qe["a"])(t,c)),Object(Ze["a"])(t,i.shape)},y=()=>{const e=Object(Be["a"])(d,p);let n=Object(Be["a"])(t,e);return 1===i.rank&&(n=Object(Qe["a"])(n,c)),Object(Ze["a"])(n,i.shape)},v=()=>{let e=t;return 1===i.rank&&(e=Object(Qe["a"])(e,c)),Object(Ze["a"])(e,i.shape)};return{x:m,mean:g,variance:b,scale:y,offset:v}}};var gr=n("f388");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const br={kernelName:$e["pb"],inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,a]=e,{axis:i}=n,o=Object(fn["I"])(i,r.shape)[0],s=()=>{const e=r.shape,n=a.size,s=e.slice(0,o),u=s.length,c=e.slice(i,e.length).slice(1),l=c.length,d=yr(0,u),h=yr(u+1,u+1+l),p=vr([s,[n],c]),f=Object(Ze["a"])(t,p),m=Object(Ze["a"])(a,[n]),g=vr([[u],d,h]),b=Object(Qn["a"])(f,g);let y=Object(gr["a"])(b,m,r.shape[o]);const v=Object(Jn["h"])(g);return y=Object(Qn["a"])(y,v),y};return{x:s,indices:()=>a}}};function yr(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function vr(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xr={kernelName:$e["rb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Object(nn["a"])(n),b:()=>Object(nn["a"])(r)}}},wr={kernelName:$e["tb"],gradFunc:t=>({x:()=>Object(Le["a"])(t,"float32")})},kr={kernelName:$e["vb"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})},Sr={kernelName:$e["wb"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})},Or={kernelName:$e["xb"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _r=n("744c");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cr={kernelName:$e["Ab"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:a}=n,i=Object(_r["a"])(r,0);return{x:()=>Object(jn["a"])(i,t,Object(Be["a"])(t,a))}}},Tr={kernelName:$e["Fb"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(sn["a"])(n,1))}}},Ir={kernelName:$e["Eb"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(Le["a"])(n,"float32"))}}},Nr={kernelName:$e["Gb"],inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;return{logits:()=>{const e=!0,n=Object(or["a"])(r);return Object(Ke["a"])(t,Object(Be["a"])(Object(Qe["a"])(t,a,e),n))}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Er(t,e,n,r=5,a=1,i=1,o=.5){const s={x:t,y:e,dy:n},u={depthRadius:r,bias:a,alpha:i,beta:o};return hn["a"].runKernel($e["zb"],s,u)}const Ar=Object(gn["b"])({localResponseNormalizationBackprop_:Er}),Rr={kernelName:$e["yb"],inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{depthRadius:i,bias:o,alpha:s,beta:u}=n;return{x:()=>Ar(r,a,t,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var jr=n("bfff");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(t,e,n,r){return e.rank<n.rank&&(e=Object(Ze["a"])(e,Jn["e"](e.shape,r))),t.rank<n.rank&&(t=Object(Ze["a"])(t,Jn["e"](t.shape,r))),{x:()=>{const r=Object(Be["a"])(t,Object(Le["a"])(Object(jr["a"])(n,e),t.dtype));return r}}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fr={kernelName:$e["Mb"],inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:a}=r,i=e[0],o=e[1],s=fn["I"](a,i.shape),u=Dr(t,o,i,s);return{x:()=>u["x"]()}}};var Mr=n("bd11");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pr={kernelName:$e["Sb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=()=>Object(Be["a"])(t,Object(Le["a"])(Object(En["a"])(n,r),"float32")),i=()=>Object(Be["a"])(t,Object(Le["a"])(Object(Mr["a"])(n,r),"float32"));return{a:a,b:i}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t,e,n,r,a,i,o){const s=Object(pn["a"])(t,"dy","maxPool3dGrad"),u=Object(pn["a"])(e,"input","maxPool3dGrad"),c=Object(pn["a"])(n,"output","maxPool3dGrad");let l=s,d=u,h=c,p=!1;4===u.rank&&(p=!0,l=Object(Ze["a"])(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=Object(Ze["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),h=Object(Ze["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),fn["b"](5===l.rank,()=>"Error in maxPool3dGrad: dy must be rank 5 but got rank "+l.rank+"."),fn["b"](5===d.rank,()=>"Error in maxPool3dGrad: input must be rank 5 but got rank "+d.rank+"."),fn["b"](5===h.rank,()=>"Error in maxPool3dGrad: output must be rank 5 but got rank "+h.rank+"."),Object(mn["a"])("maxPool3dGrad",i,o);const f={dy:l,input:d,output:h},m={filterSize:r,strides:a,pad:i,dimRoundingMode:o},g=hn["a"].runKernel($e["Pb"],f,m);return p?Object(Ze["a"])(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Lr=Object(gn["b"])({maxPool3dGrad_:$r}),Br={kernelName:$e["Ob"],inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:u}=n;return{x:()=>Lr(t,r,a,i,o,s,u)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function zr(t,e,n,r,a,i,o){const s=Object(pn["a"])(t,"dy","maxPoolGrad"),u=Object(pn["a"])(e,"input","maxPoolGrad"),c=Object(pn["a"])(n,"output","maxPoolGrad");fn["b"](u.rank===s.rank,()=>`Rank of input (${u.rank}) does not match rank of dy (${s.rank})`),fn["b"](4===s.rank,()=>"Error in maxPoolGrad: dy must be rank 4 but got rank "+s.rank+"."),fn["b"](4===u.rank,()=>"Error in maxPoolGrad: input must be rank 4 but got rank "+u.rank+"."),mn["a"]("maxPoolGrad",i,o);const l={dy:s,input:u,output:c},d={filterSize:r,strides:a,pad:i,dimRoundingMode:o};return hn["a"].runKernel($e["Qb"],l,d)}const Wr=Object(gn["b"])({maxPoolGrad_:zr}),Vr={kernelName:$e["Nb"],inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,a]=e,{filterSize:i,strides:o,pad:s}=n;return{x:()=>Wr(t,r,a,i,o,s)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ur=n("858d");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gr={kernelName:$e["Tb"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n,i=fn["I"](a,r.shape),o=Object(Jn["d"])(r.shape,i),s=o[1],u=fn["O"](s),c=()=>{const e=r.shape.slice();i.forEach(t=>{e[t]=1});const n=Object(Ze["a"])(t,e),a=Object(Ve["a"])(Object(Be["a"])(n,Object(Ur["a"])(r.shape,"float32")),u);return a};return{x:c}}},Hr={kernelName:$e["Ub"],inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:a}=r,[i,o]=e,s=fn["I"](a,i.shape),u=Dr(t,o,i,s);return{x:()=>u["x"]()}}},qr={kernelName:$e["Vb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=()=>Object(Be["a"])(t,Object(Le["a"])(Object(An["a"])(n,r),"float32")),i=()=>Object(Be["a"])(t,Object(Le["a"])(Object(_r["a"])(n,r),"float32"));return{a:a,b:i}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Kr=n("ed77");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xr={kernelName:$e["Wb"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Object(Kr["a"])(t,i,r.shape)}}};var Yr=n("c779");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jr={kernelName:$e["Xb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(Je["assertAndGetBroadcastShape"])(n.shape,r.shape),i=()=>{const e=Object(Je["getReductionAxes"])(n.shape,a);return e.length>0?Object(Ze["a"])(Object(Qe["a"])(t,e),n.shape):t},o=()=>{const e=Object(Be["a"])(t,Object(Ue["a"])(Object(Yr["a"])(Object(Ve["a"])(n,r)))),i=Object(Je["getReductionAxes"])(r.shape,a);return i.length>0?Object(Ze["a"])(Object(Qe["a"])(e,i),r.shape):e};return{a:i,b:o}}},Zr={kernelName:$e["Zb"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(Je["assertAndGetBroadcastShape"])(n.shape,r.shape),i=()=>{const e=Object(Be["a"])(t,Object(Le["a"])(r,"float32")),i=Object(Je["getReductionAxes"])(n.shape,a);return i.length>0?Object(Ze["a"])(Object(Qe["a"])(e,i),n.shape):e},o=()=>{const e=Object(Be["a"])(t,Object(Le["a"])(n,"float32")),i=Object(Je["getReductionAxes"])(r.shape,a);return i.length>0?Object(Ze["a"])(Object(Qe["a"])(e,i),r.shape):e};return{a:i,b:o}}},Qr={kernelName:$e["ac"],gradFunc:t=>({x:()=>Object(Ue["a"])(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ta=n("c879");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ea={kernelName:$e["fc"],inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Object(ta["a"])(n.shape,"float32")}}},na={kernelName:$e["gc"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ra=n("7eec");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aa={kernelName:$e["hc"],saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n,a=Object(ra["a"])(t,r);return a.map(t=>()=>t)}},ia={kernelName:$e["ic"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:a}=n,i=a.map(t=>t[0]);return{x:()=>Object(Kr["a"])(t,i,r.shape)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var oa=n("5470"),sa=n("5e33");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const ua={kernelName:$e["kc"],inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,a]=e,i=n,o=r,s=Je["assertAndGetBroadcastShape"](i.shape,o.shape),u=()=>{const e=Object(Le["a"])(o,"float32");let n=Object(Be["a"])(t,Object(Be["a"])(e,Object(sa["a"])(i,Object(Ke["a"])(e,Object(Ge["a"])(1)))));const r=Je["getReductionAxes"](i.shape,s);return r.length>0&&(n=Object(Qe["a"])(n,r)),Object(Ze["a"])(n,i.shape)},c=()=>{const e=Object(_r["a"])(i,0),n=Object(jn["a"])(e,Object(oa["a"])(i),Object(nn["a"])(i));let r=Object(Be["a"])(t,Object(Be["a"])(a,n));const u=Je["getReductionAxes"](o.shape,s);return u.length>0&&(r=Object(Qe["a"])(r,u)),Object(Ze["a"])(r,o.shape)};return{a:u,b:c}}},ca={kernelName:$e["lc"],inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(_r["a"])(n,0);return{x:()=>Object(jn["a"])(a,t,Object(Be["a"])(t,r)),alpha:()=>{let e=Object(jn["a"])(a,Object(nn["a"])(t),Object(Be["a"])(t,n));const i=Object(Je["getReductionAxes"])(r.shape,t.shape);return i.length>0&&(e=Object(Qe["a"])(e,i)),Object(Ze["a"])(e,r.shape)}}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var la=n("f137"),da=n("c76e");
/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ha(t,e,n){const r=t.shape.slice();r[n]=1;const a=Object(Ze["a"])(e,r),i=Object(da["a"])(t,n,!0,!1),o=Object(da["a"])(t,n,!0,!0),s=Object(Be["a"])(i,o);return Object(Be["a"])(a,s)}function pa(t,e,n){const r=t.shape.length,a=r-n.length,i=la["ce"].getAxesPermutation(n,r);let o=t;null!=i&&(o=Object(Qn["a"])(t,i));const s=o.shape.slice(),u=s.splice(r-n.length,n.length),c=u.reduce((t,e)=>t*e,1);s.push(c);const l=o.reshape(s);let d=ha(l,e,a);if(d=d.reshape(o.shape),null!=i){const t=la["ce"].getUndoAxesPermutation(i);d=Object(Qn["a"])(d,t)}return d}const fa={kernelName:$e["mc"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:a}=n;let i=[];return i=void 0===a||null===a?r.shape.map((t,e)=>e):"number"===typeof a?[a]:a,{x:()=>pa(r,t,i)}}},ma={kernelName:$e["rc"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Je["assertAndGetBroadcastShape"](n.shape,r.shape),i=()=>{const e=Object(Ve["a"])(t,Object(Le["a"])(r,"float32")),i=Je["getReductionAxes"](n.shape,a);return i.length>0?Object(Ze["a"])(Object(Qe["a"])(e,i),n.shape):e},o=()=>{let e=Object(Be["a"])(t,Object(Le["a"])(n,"float32"));const i=Je["getReductionAxes"](r.shape,a);i.length>0&&(e=Object(Ze["a"])(Object(Qe["a"])(e,i),r.shape));const o=Object(qe["a"])(r);return Object(Ue["a"])(Object(Ve["a"])(e,Object(Le["a"])(o,"float32")))};return{a:i,b:o}}},ga={kernelName:$e["sc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(Ue["a"])(Object(qe["a"])(n)))}}},ba={kernelName:$e["uc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=Object(Be["a"])(Object(An["a"])(n,6),Object(ze["a"])(n));return{x:()=>Object(Be["a"])(t,Object(Le["a"])(r,"float32"))}}},ya={kernelName:$e["tc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(Le["a"])(Object(ze["a"])(n),"float32"))}}},va={kernelName:$e["vc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ze["a"])(t,n.shape)}}},xa={kernelName:$e["wc"],inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r},i=()=>hn["a"].runKernel($e["xc"],a,n);return{images:i}}},wa={kernelName:$e["yc"],inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,a={dy:t,images:r},i=()=>hn["a"].runKernel($e["zc"],a,n);return{images:i}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ka=n("16d4");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sa={kernelName:$e["Ac"],gradFunc:(t,e,n)=>{const{dims:r}=n,a=Object(fn["I"])(r,t.shape);return{x:()=>Object(ka["a"])(t,a)}}},Oa={kernelName:$e["Cc"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})},_a={kernelName:$e["Dc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ue["a"])(Object(Ve["a"])(t,Object(Be["a"])(Object(sa["a"])(n,1.5),2)))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ca=n("4db8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ta={kernelName:$e["Gc"],inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>Object(Le["a"])(Object(nn["a"])(n),"float32"),t:()=>Object(Be["a"])(t,Object(Le["a"])(n,t.dtype)),e:()=>Object(Be["a"])(t,Object(Le["a"])(Object(Ca["a"])(n),t.dtype))}}};var Ia=n("1cc6");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Na={kernelName:$e["Hc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const e=Object(_r["a"])(n,Object(Ge["a"])(0)),r=Object(Ge["a"])(Ia["b"]),a=Object(Ge["a"])(Ia["a"]),i=Object(Be["a"])(t,a),o=Object(Be["a"])(Object(Be["a"])(t,r),Object(or["a"])(Object(Le["a"])(n,"float32")));return Object(jn["a"])(e,i,o)}}}},Ea={kernelName:$e["Ic"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(Be["a"])(n,Object(Ke["a"])(Object(Ge["a"])(1),n)))}}},Aa={kernelName:$e["Jc"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ra=n("8df9");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja={kernelName:$e["Kc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(Object(Ra["a"])(Object(Le["a"])(n,"float32")),t)}}};var Da=n("050a");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fa={kernelName:$e["Lc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(Object(Da["a"])(Object(Le["a"])(n,"float32")),t)}}};var Ma=n("3f84"),Pa=n("9b7a");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const $a={kernelName:$e["Mc"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:a,size:i}=n,o=r.shape,[s,u]=Object(Pa["parseSliceParams"])(r,a,i),c=[];for(let l=0;l<t.rank;l++)c.push([s[l],o[l]-s[l]-u[l]]);return{x:()=>Object(Ma["a"])(t,c)}}},La={kernelName:$e["Nc"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:a}=n,i=!0,o=Object(Be["a"])(t,r);return{logits:()=>Object(Ke["a"])(o,Object(Be["a"])(Object(Qe["a"])(o,[a],i),r))}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ba=n("8ab3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const za={kernelName:$e["Oc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(Ba["a"])(n))}}};var Wa=n("70be");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Va={kernelName:$e["Pc"],gradFunc:(t,e,n)=>{const{blockShape:r,paddings:a}=n;return{x:()=>Object(Wa["a"])(t,r,a)}}};var Ua=n("19d5");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ga={kernelName:$e["Vc"],gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Object(Ua["a"])(t,r)}}},Ha={kernelName:$e["Wc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(Be["a"])(Object(He["a"])(Object(Le["a"])(n,"float32")),2))}}},qa={kernelName:$e["Xc"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(t,Object(Be["a"])(Object(Le["a"])(n,"float32"),2))}}},Ka={kernelName:$e["Yc"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Object(Ge["a"])(2),i=()=>Object(Be["a"])(t,Object(Be["a"])(a,Object(Ke["a"])(n,r))),o=()=>Object(Be["a"])(t,Object(Be["a"])(a,Object(Ke["a"])(r,n)));return{a:i,b:o}}},Xa={kernelName:$e["Zc"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})},Ya={kernelName:$e["ed"],inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,a=Je["assertAndGetBroadcastShape"](n.shape,r.shape),i=()=>{let e=t;const r=Je["getReductionAxes"](n.shape,a);return r.length>0&&(e=Object(Qe["a"])(e,r)),Object(Ze["a"])(e,n.shape)},o=()=>{let e=t;const n=Je["getReductionAxes"](r.shape,a);return n.length>0&&(e=Object(Qe["a"])(e,n)),Object(Ze["a"])(Object(Ue["a"])(e),r.shape)};return{a:i,b:o}}},Ja={kernelName:$e["fd"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,a=r.shape.slice(),{axis:i}=n,o=Object(fn["I"])(i,r.shape);o.forEach(t=>{a[t]=1});const s=Object(Ze["a"])(t,a),u=Object(Be["a"])(s,Object(Ur["a"])(r.shape,"float32"));return{x:()=>u}}},Za={kernelName:$e["gd"],inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Ve["a"])(t,Object(qe["a"])(Object(Ra["a"])(n)))}}},Qa={kernelName:$e["hd"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Object(Be["a"])(Object(Ke["a"])(Object(Ge["a"])(1),Object(qe["a"])(n)),t)}}},ti={kernelName:$e["id"],inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:a}=n,i=()=>{let e=Object(nn["a"])(r);if(1===r.rank)for(let n=0;n<a[0];++n)e=Object(sn["a"])(e,Object(Kr["a"])(t,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)e=Object(sn["a"])(e,Object(Kr["a"])(t,[n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)e=Object(sn["a"])(e,Object(Kr["a"])(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(let n=0;n<a[0];++n)for(let i=0;i<a[1];++i)for(let o=0;o<a[2];++o)for(let s=0;s<a[3];++s)e=Object(sn["a"])(e,Object(Kr["a"])(t,[n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e};return{x:i}}},ei={kernelName:$e["ld"],gradFunc:(t,e,n)=>{const r=n,{perm:a}=r,i=Jn["h"](a);return{x:()=>Object(Qn["a"])(t,i)}}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ni=n("3e50");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ri={kernelName:$e["nd"],gradFunc:(t,e,n)=>{const r=n,{axis:a}=r;return{value:()=>Object(ni["a"])(t,a)}}};var ai=n("0d7e"),ii=n("ed06"),oi=n("353b");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const si={kernelName:$e["od"],inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e,r=()=>ui(t,n);return{x:r}}};function ui(t,e){const n=Object(oi["a"])(e,Object(nn["a"])(e)),r=Object(ii["a"])(t,n);let a=Object(En["a"])(e,Object(Ge["a"])(0,"int32"));const i=r.rank-a.rank;for(let s=0;s<i;++s)a=Object(ai["a"])(a,s+1);a=Object(Rn["a"])(a,Object(Ur["a"])(r.shape,"bool"));const o=Object(nn["a"])(r);return Object(jn["a"])(a,r,o)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ci={kernelName:$e["qd"],gradFunc:t=>({x:()=>Object(nn["a"])(t)})};var li=n("3182");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const di=[We,Xe,Ye,tn,en,rn,an,on,un,cn,ln,dn,vn,kn,On,Cn,Tn,In,Nn,Dn,Fn,Pn,Wn,Bn,Hn,Kn,Yn,tr,rr,ar,ma,ir,sr,ur,cr,lr,hr,dr,mr,br,xr,wr,kr,Sr,Or,Cr,Tr,Ir,Nr,Rr,Fr,Fr,Pr,Br,Vr,Gr,Hr,qr,Xr,Jr,Zr,Qr,ea,na,aa,ia,ia,ua,ca,fa,ga,ba,ya,va,xa,wa,Sa,Oa,_a,Ta,Na,Ea,Aa,ja,Fa,$a,La,za,Va,Va,Ga,Ga,Ha,Ka,qa,Xa,Ya,Ja,Za,Qa,ti,ei,ri,si,ci];for(const qd of di)Object(li["e"])(qd);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function hi(t,e){return Object(c["tidy"])(()=>c["sqrt"](c["sum"](c["mul"](t,t),e,!0)))}class pi extends c["serialization"].Serializable{getConfig(){return{}}}class fi extends pi{constructor(t){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(c["tidy"])(()=>{const e=hi(t,this.axis),n=c["clipByValue"](e,0,this.maxValue);return c["mul"](t,c["div"](n,c["add"](dt(),e)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}fi.className="MaxNorm",c["serialization"].registerClass(fi);class mi extends pi{constructor(t){super(),this.defaultAxis=0,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(c["tidy"])(()=>c["div"](t,c["add"](dt(),hi(t,this.axis))))}getConfig(){return{axis:this.axis}}}mi.className="UnitNorm",c["serialization"].registerClass(mi);class gi extends pi{apply(t){return c["relu"](t)}}gi.className="NonNeg",c["serialization"].registerClass(gi);class bi extends pi{constructor(t){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=null!=t.minValue?t.minValue:this.defaultMinValue,this.maxValue=null!=t.maxValue?t.maxValue:this.defaultMaxValue,this.rate=null!=t.rate?t.rate:this.defaultRate,this.axis=null!=t.axis?t.axis:this.defaultAxis}apply(t){return Object(c["tidy"])(()=>{const e=hi(t,this.axis),n=c["add"](c["mul"](this.rate,c["clipByValue"](e,this.minValue,this.maxValue)),c["mul"](1-this.rate,e));return c["mul"](t,c["div"](n,c["add"](dt(),e)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}bi.className="MinMaxNorm",c["serialization"].registerClass(bi);const yi={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function vi(t){return O(t)}function xi(t,e={}){return C(t,c["serialization"].SerializationMap.getMap().classNameMap,e,"constraint")}function wi(t){if(null==t)return null;if("string"===typeof t){const e=t in yi?yi[t]:t,n={className:e,config:{}};return xi(n)}return t instanceof pi?t:xi(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ki(t){return new fi(t)}function Si(t){return new mi(t)}function Oi(){return new gi}function _i(t){return new bi(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ci(){return new Bt}function Ti(){return new zt}function Ii(t){return new Wt(t)}function Ni(t){return new Vt(t)}function Ei(t){return new Ut(t)}function Ai(t){return new Gt(t)}function Ri(t){return new Ht(t)}function ji(t){return new Kt(t)}function Di(t){return new Xt(t)}function Fi(t){return new Yt(t)}function Mi(t){return new Jt(t)}function Pi(t){return new Zt(t)}function $i(t){return new Qt(t)}function Li(t){return new te(t)}function Bi(t){return new ee(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function zi(t){if(null==t)return;const e=[],n=[],r=[];for(const a in t){const i=t[a];if("number"!==typeof i){const t=i;e.push(t.data()),n.push(a),r.push(t)}}if(e.length>0){const a=await Promise.all(e);for(let e=0;e<a.length;++e)t[n[e]]=a[e][0];Object(c["dispose"])(r)}}function Wi(t){if(null!=t)for(const e in t){const n=t[e];"number"!==typeof n&&n.dispose()}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Vi;(function(t){t[t["SILENT"]=0]="SILENT",t[t["VERBOSE"]=1]="VERBOSE"})(Vi||(Vi={}));const Ui=125;class Gi{constructor(){this.validationData=null}setParams(t){this.params=t}async onEpochBegin(t,e){}async onEpochEnd(t,e){}async onBatchBegin(t,e){}async onBatchEnd(t,e){}async onTrainBegin(t){}async onTrainEnd(t){}setModel(t){}}class Hi{constructor(t,e=10){null==t&&(t=[]),this.callbacks=t,this.queueLength=e}append(t){this.callbacks.push(t)}setParams(t){for(const e of this.callbacks)e.setParams(t)}setModel(t){for(const e of this.callbacks)e.setModel(t)}async onEpochBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochBegin(t,e)}async onEpochEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onEpochEnd(t,e)}async onBatchBegin(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchBegin(t,e)}async onBatchEnd(t,e){null==e&&(e={});for(const n of this.callbacks)await n.onBatchEnd(t,e)}async onTrainBegin(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainBegin(t)}async onTrainEnd(t){null==t&&(t={});for(const e of this.callbacks)await e.onTrainEnd(t)}}class qi extends Gi{constructor(){super()}async onEpochBegin(t){this.seen=0,this.totals={}}async onBatchEnd(t,e){null==e&&(e={});const n=null==e["size"]?0:e["size"];this.seen+=n;for(const r in e){const t=e[r];if("number"===typeof t)this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+t*n;else{let e;r in this.totals?e=this.totals[r]:this.totals[r]=0;const a=Object(c["tidy"])(()=>Object(c["add"])(this.totals[r],Object(c["mul"])(t,n)));this.totals[r]=a,null!=e&&e.dispose()}}}async onEpochEnd(t,e){if(null!=e)for(const n of this.params["metrics"])null!=this.totals[n]&&("number"===typeof this.totals[n]?e[n]=this.totals[n]/this.seen:Object(c["tidy"])(()=>{const t=Object(c["mul"])(Object(c["div"])(1,this.seen),this.totals[n]);e[n]=t,this.totals[n].dispose(),Object(c["keep"])(e[n])}))}}class Ki extends Gi{async onTrainBegin(t){this.epoch=[],this.history={}}async onEpochEnd(t,e){null==e&&(e={}),this.epoch.push(t);for(const n in e)null==this.history[n]&&(this.history[n]=[]),this.history[n].push(e[n])}async syncData(){const t=[],e=[],n=[];for(const a in this.history){const r=this.history[a];for(let i=0;i<r.length;++i)if("number"!==typeof r[i]){const o=r[i];t.push(o.data()),e.push(a),n.push(i)}}const r=await Promise.all(t);for(let a=0;a<r.length;++a){const t=this.history[e[a]][n[a]];t.dispose(),this.history[e[a]][n[a]]=r[a][0]}}}class Xi extends Gi{constructor(t,e){if(super(),this.currentEpoch=0,this.nowFunc=t.nowFunc,this.nextFrameFunc=t.nextFrameFunc||c["nextFrame"],this.yieldEvery=e||"auto","auto"===this.yieldEvery&&(this.yieldEvery=Ui),"never"===this.yieldEvery&&null!=t.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");c["util"].isNumber(this.yieldEvery)&&(this.maybeWait=F(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=t.onTrainBegin,this.trainEnd=t.onTrainEnd,this.epochBegin=t.onEpochBegin,this.epochEnd=t.onEpochEnd,this.batchBegin=t.onBatchBegin,this.batchEnd=t.onBatchEnd,this.yield=t.onYield}async maybeWait(t,e,n){const r=[];null!=this.yield&&(await zi(n),r.push(this.yield(t,e,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(t,e){this.currentEpoch=t,null!=this.epochBegin&&(await zi(e),await this.epochBegin(t,e))}async onEpochEnd(t,e){const n=[];null!=this.epochEnd&&(await zi(e),n.push(this.epochEnd(t,e))),"epoch"===this.yieldEvery&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(t,e){null!=this.batchBegin&&(await zi(e),await this.batchBegin(t,e))}async onBatchEnd(t,e){const n=[];null!=this.batchEnd&&(await zi(e),n.push(this.batchEnd(t,e))),"batch"===this.yieldEvery?n.push(this.nextFrameFunc()):c["util"].isNumber(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,t,e)),await Promise.all(n)}async onTrainBegin(t){null!=this.trainBegin&&(await zi(t),await this.trainBegin(t))}async onTrainEnd(t){null!=this.trainEnd&&(await zi(t),await this.trainEnd(t))}}function Yi(t,e){if(null==t&&(t={}),t instanceof Gi)return[t];if(Array.isArray(t)&&t[0]instanceof Gi)return t;const n=x(t);return n.map(t=>new Xi(t,e))}class Ji{constructor(){}static registerCallbackConstructor(t,e){c["util"].assert(t>=0&&Number.isInteger(t),()=>"Verbosity level is expected to be an integer >= 0, but got "+t),Ji.checkForDuplicate(e),null==Ji.constructors[t]&&(Ji.constructors[t]=[]),Ji.constructors[t].push(e)}static checkForDuplicate(t){for(const e in Ji.constructors){const n=Ji.constructors[+e];n.forEach(e=>{if(e===t)throw new h("Duplicate callback constructor.")})}}static clear(){Ji.constructors={}}static createCallbacks(t){const e=[];for(const n in Ji.constructors){const r=+n;t>=r&&e.push(...Ji.constructors[r])}return e.map(t=>new t)}}function Zi(t,e,n,r,a,i,o,s,u){const c=new Ki,l=[new qi,...Ji.createCallbacks(e)];null!=t&&l.push(...t),l.push(c);const d=new Hi(l);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:e,doValidation:s,metrics:u}),{callbackList:d,history:c}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Qi(t,e={},n=!1){return C(t,c["serialization"].SerializationMap.getMap().classNameMap,e,"layer",n)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function to(t,e){return Object(c["tidy"])(()=>{"float32"!==t.dtype&&(t=c["cast"](t,"float32"));const n=c["sum"](Tt(t),e,!0),r=c["fill"](n.shape,dt()),a=c["sqrt"](c["maximum"](n,r));return c["div"](t,a)})}function eo(t,e){return Object(c["tidy"])(()=>c["mean"](Tt(c["sub"](e,t)),-1))}function no(t,e){return Object(c["tidy"])(()=>c["mean"](c["abs"](c["sub"](e,t)),-1))}function ro(t,e){return Object(c["tidy"])(()=>{const n=c["sub"](t,e),r=c["clipByValue"](c["abs"](t),dt(),Number.MAX_VALUE),a=c["abs"](c["div"](n,r));return c["mul"](100,c["mean"](a,-1))})}function ao(t,e){return Object(c["tidy"])(()=>{const n=c["clipByValue"](e,dt(),Number.MAX_VALUE),r=c["log"](c["add"](1,n)),a=c["clipByValue"](t,dt(),Number.MAX_VALUE),i=c["log"](c["add"](1,a));return c["mean"](Tt(c["sub"](r,i)),-1)})}function io(t,e){return Object(c["tidy"])(()=>{const n=c["maximum"](0,c["sub"](1,c["mul"](t,e)));return c["mean"](Tt(n),-1)})}function oo(t,e){return Object(c["tidy"])(()=>{const n=c["maximum"](0,c["sub"](1,c["mul"](t,e)));return c["mean"](n,-1)})}function so(t,e){return Object(c["tidy"])(()=>{const n=c["sum"](c["mul"](t,e),-1),r=c["max"](c["mul"](c["sub"](1,t),e),-1);return c["maximum"](0,c["add"](1,c["sub"](r,n)))})}function uo(t,e){return Object(c["tidy"])(()=>{const n=Math.log(2),r=c["sub"](e,t),a=c["sub"](c["add"](r,c["softplus"](c["mul"](-2,r))),n);return c["mean"](a,-1)})}function co(t,e,n=!1){return Object(c["tidy"])(()=>{if(n)e=c["softmax"](e);else{const t=c["sum"](e,e.shape.length-1,!0);e=c["div"](e,t)}return e=c["clipByValue"](e,dt(),1-dt()),c["neg"](c["sum"](c["mul"](c["cast"](t,"float32"),c["log"](e)),e.shape.length-1))})}function lo(t,e,n=!1){return Object(c["tidy"])(()=>{const r=c["cast"](c["floor"](gt(t)),"int32");e=c["clipByValue"](e,dt(),1-dt());const a=e.shape,i=c["reshape"](c["oneHot"](r,a[a.length-1]),a);return co(i,e,n)})}function ho(t,e){if(!c["util"].arraysEqual(t.shape,e.shape))throw new h(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Object(c["tidy"])(()=>{const n=c["relu"](e),r=c["neg"](c["abs"](e));return c["add"](c["sub"](n,c["mul"](e,t)),c["log1p"](c["exp"](r)))})}function po(t,e){return Object(c["tidy"])(()=>{let n;return n=c["clipByValue"](e,dt(),1-dt()),n=c["log"](c["div"](n,c["sub"](1,n))),c["mean"](ho(t,n),-1)})}function fo(t,e){return Object(c["tidy"])(()=>{const n=c["clipByValue"](t,dt(),1),r=c["clipByValue"](e,dt(),1);return c["sum"](c["mul"](t,c["log"](c["div"](n,r))),-1)})}function mo(t,e){return Object(c["tidy"])(()=>{const n=c["log"](c["add"](dt(),e));return c["mean"](c["sub"](e,c["mul"](t,n)),-1)})}function go(t,e){return Object(c["tidy"])(()=>{const n=to(t,-1),r=to(e,-1),a=c["mul"](n,r);return c["neg"](c["sum"](a,-1))})}Ji.constructors={};const bo={meanSquaredError:eo,meanAbsoluteError:no,meanAbsolutePercentageError:ro,meanSquaredLogarithmicError:ao,squaredHinge:io,hinge:oo,categoricalHinge:so,logcosh:uo,categoricalCrossentropy:co,sparseCategoricalCrossentropy:lo,binaryCrossentropy:po,kullbackLeiblerDivergence:fo,poisson:mo,cosineProximity:go};function yo(t){if("string"===typeof t){if(t in bo)return bo[t];let e="Unknown loss "+t;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new h(e)}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vo(t,e){return Object(c["tidy"])(()=>{const n=c["mul"](.5,c["onesLike"](e)),r=pt(c["greater"](e,n),t.dtype);return c["mean"](c["equal"](t,r),-1)})}function xo(t,e){return Object(c["tidy"])(()=>pt(c["equal"](c["argMax"](t,-1),c["argMax"](e,-1)),"float32"))}function wo(t,e){return Object(c["tidy"])(()=>c["cast"](c["sum"](c["logicalAnd"](c["equal"](t,1),c["equal"](e,1))),"float32"))}function ko(t,e){return Object(c["tidy"])(()=>c["cast"](c["sum"](c["logicalAnd"](c["equal"](t,1),c["equal"](e,0))),"float32"))}function So(t,e){return Object(c["tidy"])(()=>c["cast"](c["sum"](c["logicalAnd"](c["equal"](t,0),c["equal"](e,1))),"float32"))}function Oo(t,e){return Object(c["tidy"])(()=>{const n=wo(t,e),r=So(t,e),a=c["add"](n,r);return c["cast"](c["where"](c["greater"](a,0),c["div"](n,a),0),"float32")})}function _o(t,e){return Object(c["tidy"])(()=>{const n=wo(t,e),r=ko(t,e),a=c["add"](n,r);return c["cast"](c["where"](c["greater"](a,0),c["div"](n,a),0),"float32")})}function Co(t,e){return po(t,e)}function To(t,e){return t.rank===e.rank&&(t=c["squeeze"](t,[t.rank-1])),e=c["argMax"](e,-1),e.dtype!==t.dtype&&(e=c["cast"](e,t.dtype)),c["cast"](c["equal"](t,e),"float32")}const Io=eo,No=eo,Eo=no,Ao=no,Ro=ro,jo=ro,Do=co,Fo=go,Mo=lo,Po={binaryAccuracy:vo,categoricalAccuracy:xo,precision:Oo,categoricalCrossentropy:Do,sparseCategoricalCrossentropy:Mo,mse:Io,MSE:No,mae:Eo,MAE:Ao,mape:Ro,MAPE:jo,cosine:Fo};function $o(t){if("string"===typeof t&&t in Po)return Po[t];if("string"!==typeof t&&null!=t)return t;throw new h("Unknown metric "+t)}function Lo(t){if(b(null!==t,"Unknown LossOrMetricFn "+t),"string"===typeof t)return t;{let e;for(const n of Object.keys(bo))if(bo[n]===t){e=n;break}if(void 0!==e)return e;for(const n of Object.keys(Po))if(Po[n]===t){e=n;break}return void 0!==e?e:t.name}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bo(t){const e={Adagrad:()=>c["train"].adagrad(.01),Adadelta:()=>c["train"].adadelta(1,.95,dt()),Adam:()=>c["train"].adam(.001,.9,.999,dt()),Adamax:()=>c["train"].adamax(.002,.9,.999,dt(),0),RMSProp:()=>c["train"].rmsprop(.001,.9,0,dt()),SGD:()=>c["train"].sgd(.01)};if(e["adagrad"]=e["Adagrad"],e["adadelta"]=e["Adadelta"],e["adam"]=e["Adam"],e["adamax"]=e["Adamax"],e["rmsprop"]=e["RMSProp"],e["sgd"]=e["SGD"],t in e)return e[t]();throw new h("Unknown Optimizer "+t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zo=1048576;function Wo(t,e,n=!1){if(null==t||"object"!==typeof t||Object.getPrototypeOf(t)!==Object.prototype||!Vo(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const n=JSON.stringify(t);n.length>zo&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= `+zo+".")}}function Vo(t){if(null===t)return!0;if("object"===typeof t){if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e){if("string"!==typeof n)return!1;if(!Vo(t[n]))return!1}return!0}if(Array.isArray(t)){for(const e of t)if(!Vo(e))return!1;return!0}return!1}{const e=typeof t;return"string"===e||"number"===e||"boolean"===e}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uo(t,e,n,r=console.log){const a=Ho(t),i=["Layer (type)","Input Shape","Output shape","Param #"];let o;if(a?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(t=>Math.floor(e*t))),!a){i.push("Receives inputs"),o=[];for(const e in t.nodesByDepth)o.push(...t.nodesByDepth[e])}r("_".repeat(e)),qo(i,n,r),r("=".repeat(e));const s=t.layers;for(let l=0;l<s.length;++l)a?Ko(s[l],n,r):Xo(s[l],n,o,r),r((l===s.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const u=Go(t),c=le(t.nonTrainableWeights);r("Total params: "+(u+c)),r("Trainable params: "+u),r("Non-trainable params: "+c),r("_".repeat(e))}function Go(t){let e;return e=null!=t.collectedTrainableWeights?le(t.collectedTrainableWeights):le(t.trainableWeights),e}function Ho(t){let e=!0;const n=[],r=[];for(const a in t.nodesByDepth)n.push(t.nodesByDepth[a]);for(const a of n){if(a.length>1||1===a.length&&a[0].inboundLayers.length>1){e=!1;break}r.push(...a)}if(e)for(const a of t.layers){let t=!1;for(const n of a.inboundNodes)if(-1!==r.indexOf(n)){if(t){e=!1;break}t=!0}if(!e)break}return e}function qo(t,e,n=console.log){let r="";for(let a=0;a<t.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r+=t[a],r=r.slice(0,e[a]),r+=" ".repeat(e[a]-r.length);n(r)}function Ko(t,e,n){let r,a;try{a=t.inboundNodes.map(t=>JSON.stringify(t.inputShapes)).join(",")}catch(u){a="multiple"}try{r=JSON.stringify(t.outputShape)}catch(u){r="multiple"}const i=t.name,o=t.getClassName(),s=[`${i} (${o})`,a,r,t.countParams().toString()];qo(s,e,n)}function Xo(t,e,n,r){let a,i;try{i=t.inboundNodes.map(t=>JSON.stringify(t.inputShapes)).join(",")}catch(d){i="multiple"}try{a=JSON.stringify(t.outputShape)}catch(d){a="multiple"}const o=[];for(const h of t.inboundNodes)if(!(null!=n&&n.length>0&&-1===n.indexOf(h)))for(let t=0;t<h.inboundLayers.length;++t){const e=h.inboundLayers[t].name,n=h.nodeIndices[t],r=h.tensorIndices[t];o.push(`${e}[${n}][${r}]`)}const s=t.name,u=t.getClassName(),c=0===o.length?"":o[0],l=[`${s} (${u})`,i,a,t.countParams().toString(),c];qo(l,e,r);for(let h=1;h<o.length;++h)qo(["","","","",o[h]],e,r)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yo(t,e,n){return("inboundNodes"===t||"outputLayers"===t||"inputLayers"===t)&&0===e&&"string"===typeof n}function Jo(t,e){if(null===t)return null;if("string"===typeof t)return k(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let a=0;a<r;++a){const r=t[a];Yo(e,a,r)?n.push(r):n.push(Jo(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n];if("name"===n&&"string"===typeof r)e[n]=r;else{const t=k(n);e[t]=Jo(r,t)}}return e}}function Zo(t,e){if(null===t||void 0===t)return null;if("string"===typeof t)return w(t);if("number"===typeof t||"boolean"===typeof t)return t;if(t instanceof Array){const n=[],r=t.length;for(let a=0;a<r;++a){const r=t[a];Yo(e,a,r)?n.push(r):n.push(Zo(r,e))}return n}{const e={};for(const n of Object.keys(t)){const r=t[n],a=w(n);e[a]="name"!==n&&"className"!==n||"string"!==typeof r?Zo(r,n):r}return e}}
/** @license See the LICENSE file. */const Qo="3.21.0";
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ts extends we{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,null==this.name){const t=this.getClassName().toLowerCase();this.name=B(t)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],N(this.inputs).length!==this.inputs.length)throw new h("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+this.inputs.map(t=>t.name));N(this.outputs).length!==this.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+this.outputs.map(t=>t.name)),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const d of this.outputs){const t=d.sourceLayer,e=d.nodeIndex,n=d.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(e),this.outputLayersTensorIndices.push(n)}for(const d of this.inputs){const t=d.sourceLayer,e=d.nodeIndex,n=d.tensorIndex;b(0===e,"input layer has >1 nodes"),b(0===n,"input layer has >1 tensors"),this.inputLayers.push(t),this.inputLayersNodeIndices.push(e),this.inputLayersTensorIndices.push(n)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let d=0;d<this.inputLayers.length;d++){const e=this.inputLayers[d];if(!(e instanceof _e))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${d} (0-based) originates from layer type ${e.getClassName()}.`);this.inputNames.push(e.name),this.feedInputShapes.push(e.batchInputShape),this.feedInputNames.push(e.name)}for(const d of this.outputLayers)this.outputNames.push(d.name);this.internalInputShapes=this.inputs.map(t=>t.shape),this.internalOutputShapes=this.outputs.map(t=>t.shape);const e={},n={},r={},a={},i={},o=[],s=(t,e,n,r,a,u)=>{null!=r&&null!=a&&null!=u||(r=t.sourceLayer,a=t.nodeIndex,u=t.tensorIndex);const c=r.inboundNodes[a];if(-1!==n.indexOf(c))throw new d(`The tensor ${t.name} at layer "${r.name}" is part of a cycle.`);if(-1!==e.indexOf(c))return;this.containerNodes.add(ts.nodeKey(r,a)),r.id in i||(i[r.id]=Object.keys(i).length),-1===n.indexOf(c)&&n.push(c);const l=c.inboundLayers.length;for(let i=0;i<l;i++){const t=c.inputTensors[i],r=c.inboundLayers[i],a=c.nodeIndices[i],o=c.tensorIndices[i];s(t,e,n,r,a,o)}e.push(c);while(n.indexOf(c)>=0)n.splice(n.indexOf(c),1);o.push(c)},u=[],c=[];for(const d of this.outputs)s(d,u,c);const l=o.slice().reverse();for(const d of l){n[d.id]=d,d.id in e||(e[d.id]=0);let t=e[d.id];const i=null==r[d.outboundLayer.id]?0:r[d.outboundLayer.id];t=Math.max(t,i),r[d.outboundLayer.id]=t,a[d.outboundLayer.id]=d.outboundLayer,e[d.id]=t;for(let r=0;r<d.inboundLayers.length;r++){const a=d.inboundLayers[r],i=d.nodeIndices[r],o=a.inboundNodes[i],s=null==e[o.id]?0:e[o.id];e[o.id]=Math.max(t+1,s),n[o.id]=o}}const p={};for(const d in e){const t=e[d];t in p||(p[t]=[]),p[t].push(n[d])}const f={};for(const d in r){const t=r[d];t in f||(f[t]=[]),f[t].push(a[d])}let m=Object.keys(f).map(t=>parseInt(t,10)).sort(I);this.layers=[];for(const d of m){const t=f[d];t.sort((t,e)=>{const n=i[t.id],r=i[e.id];return n<r?-1:n>r?1:0});for(const e of t)e instanceof ts&&this.internalContainerRefs.push(e),this.layers.push(e)}this.layersByDepth=f,m=Object.keys(p).map(t=>parseInt(t,10)).sort(I);const g=this.inputs.slice(),y=[];for(const h of m)for(const t of p[h]){const e=t.outboundLayer;if(null!=e){for(const n of t.inputTensors)if(-1===g.indexOf(n))throw new d("Graph disconnected: cannot obtain value for tensor "+n+` at layer "${e.name}". The following previous layers were accessed without issue: `+y);for(const e of t.outputTensors)g.push(e);y.push(e.name)}}this.nodesByDepth=p;const v=this.layers.map(t=>t.name);for(const h of v){const t=v.filter(t=>t===h).length;if(1!==t)throw new d(`The name "${h}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(v))}this.outboundNodes=[],this.inboundNodes=[],new ve({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(t=>null),outputMasks:this.outputs.map(t=>null),inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs.map(t=>t.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(0===this._refCount)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const t={refCountAfterDispose:null,numDisposedVariables:0};if(0===--this._refCount){for(const e of this.layers)t.numDisposedVariables+=e.dispose().numDisposedVariables;for(const e of this.internalContainerRefs)t.numDisposedVariables+=e.dispose().numDisposedVariables}return t.refCountAfterDispose=this._refCount,t}get trainable(){return this.trainable_}set trainable(t){this.layers.forEach(e=>{e._trainableWeights.forEach(e=>e.trainable=t)}),this.trainable_=t}get trainableWeights(){if(this._trainableWeights.length>0)throw new h("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let t=[];for(const e of this.layers)t=t.concat(e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.layers)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.layers)e.push(...t.trainableWeights);return e.concat(t)}return t}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(t,e=!0){const n={};let r=0;for(const i of this.layers)for(const t of i.weights){if(null!=n[t.originalName])throw new h("Duplicate weight name: "+t.originalName);n[t.originalName]=t,r++}const a=[];for(const i in t){let r=i;if(null==n[i]){const t=i.split("/"),e=t.slice(0,-2).concat([t[t.length-1]]);r=e.join("/")}if(null!=n[r])a.push([n[r],t[i]]);else if(e)throw new h("Provided weight data has no target variable: "+i);delete n[r]}if(e){const t=[];for(const e in n)t.push(e);if(t.length>0)throw new h(`${t.length} of ${r} weights are not set: `+t)}me(a)}updatedConfig(){const t=this.getConfig(),e={};return e["className"]=this.getClassName(),e["config"]=t,e["kerasVersion"]="tfjs-layers "+Qo,e["backend"]="TensorFlow.js",e}toJSON(t,e=!0){const n=Zo(this.updatedConfig());return e?JSON.stringify(n):n}call(t,e){return Object(c["tidy"])(()=>{t=x(t);const n=new Ie;for(let e=0;e<this.inputs.length;++e)n.add(this.inputs[e],t[e]);return Re(this.outputs,n,e)})}computeMask(t,e){return Object(c["tidy"])(()=>{let n;return t=x(t),n=null==e?g(null,t.length):x(e),this.runInternalGraph(t,n)[1]})}computeOutputShape(t){const e=se(t);if(e.length!==this.inputLayers.length)throw new h(`Invalid inputShape argument ${t}: model has ${this.inputLayers.length} tensor inputs.`);const n={};for(let o=0;o<e.length;o++){const t=this.inputLayers[o],r=e[o],a=t.name+"_0_0";n[a]=r}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(I);if(r.length>1)for(const o of r){const t=this.nodesByDepth[o];for(const e of t){const t=e.outboundLayer;if(-1!==this.inputLayers.map(t=>t.id).indexOf(t.id))continue;const r=[];for(let s=0;s<e.inboundLayers.length;s++){const t=e.inboundLayers[s],a=e.nodeIndices[s],i=e.tensorIndices[s],o=`${t.name}_${a}_${i}`,u=n[o];r.push(u)}const a=t.computeOutputShape(v(r)),i=se(a),o=t.inboundNodes.indexOf(e);for(let e=0;e<i.length;e++){const r=`${t.name}_${o}_${e}`;n[r]=i[e]}}}const a=[],i=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],e=this.outputLayersNodeIndices[o],n=this.outputLayersTensorIndices[o],r=`${t.name}_${e}_${n}`;i.push(r)}for(let o=0;o<i.length;o++){const t=i[o];b(t in n),a.push(n[t])}return v(a)}runInternalGraph(t,e){null==e&&(e=g(null,t.length));const n={};for(let s=0;s<this.inputs.length;++s){const r=this.inputs[s],a=t[s],i=e[s];n[r.id]=[a,i]}const r=Object.keys(this.nodesByDepth).map(t=>parseInt(t,10)).sort(I);for(const s of r){const t=this.nodesByDepth[s];for(const e of t){const t=e.outboundLayer,r=e.inputTensors,a=e.outputTensors,i=new Array;for(const e of r)e.id in n&&i.push(n[e.id]);if(i.length===r.length){let r,o,s,u,c={};if(null!=e.callArgs&&(c=e.callArgs),1===i.length){const[e,n]=i[0];null==c["mask"]&&(c["mask"]=n),s=x(t.call(e,c)),u=x(t.computeMask(e,n)),r=[e],o=[n]}else r=i.map(t=>t[0]),o=i.map(t=>t[1]),null==c["mask"]&&(c["mask"]=o),s=x(t.call(r,c)),u=x(t.computeMask(r,o));if(t.activityRegularizer)throw new p("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let t=0;t<a.length;++t){const e=a[t],r=s[t],i=u[t];n[e.id]=[r,i]}}}}const a=[],i=[],o=[];for(const s of this.outputs){b(s.id in n,`Could not compute output ${s.name} : ${s.id}`);const[t,e]=n[s.id];o.push(t.shape),a.push(t),i.push(e)}return[a,i,o]}buildNodeConversionMap(t){const e={};let n;for(const r of this.layers){n=r instanceof ts?1:0;for(let t=0;t<r.inboundNodes.length;t++){const a=ts.nodeKey(r,t);this.containerNodes.has(a)&&(e[a]=n,n+=1)}}return e}getLayer(t,e){if(null!=e){if(this.layers.length<=e)throw new h(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}if(null==t)throw new h("Provide either a layer name or layer index");for(const n of this.layers)if(n.name===t)return n;throw new h("No such layer: "+t)}calculateLosses(){return Object(c["tidy"])(()=>{const t=[];for(const e of this.layers)for(let n=0;n<e.inboundNodes.length;++n){const r=ts.nodeKey(e,n);this.containerNodes.has(r)&&t.push(...e.calculateLosses())}return t})}getConfig(){const t={name:this.name},e=this.buildNodeConversionMap(this.layers),n=[];for(const o of this.layers){const t=o.getClassName(),r=o.getConfig(),a=[];for(let n=0;n<o.inboundNodes.length;n++){const t=o.inboundNodes[n],r=ts.nodeKey(o,n);let s={};if(this.containerNodes.has(r)){if(t.callArgs)try{JSON.stringify(t.callArgs),s=t.callArgs}catch(i){console.warn(`Layer ${o.name} was passed non-serializable keyword arguments: `+t.callArgs+". They will not be included in the serialized model (and thus will be missing at deserialization time)."),s={}}if(t.inboundLayers.length>0){const n=[];for(let r=0;r<t.inboundLayers.length;r++){const a=t.inboundLayers[r],i=t.nodeIndices[r],o=t.tensorIndices[r],u=ts.nodeKey(a,i);let c=e[u];null==c&&(c=0),n.push([a.name,c,o,s])}a.push(n)}}}const s={};s["name"]=o.name,s["className"]=t,s["config"]=r,s["inboundNodes"]=a,n.push(s)}t["layers"]=n;const r=[];for(let o=0;o<this.inputLayers.length;o++){const t=this.inputLayers[o],n=this.inputLayersNodeIndices[o],a=ts.nodeKey(t,n);if(!this.containerNodes.has(a))continue;let i=e[a];null!==i&&void 0!==i||(i=0);const s=this.inputLayersTensorIndices[o];r.push([t.name,i,s])}t["inputLayers"]=r;const a=[];for(let o=0;o<this.outputLayers.length;o++){const t=this.outputLayers[o],n=this.outputLayersNodeIndices[o],r=ts.nodeKey(t,n);if(!this.containerNodes.has(r))continue;let i=e[r];null!==i&&void 0!==i||(i=0);const s=this.outputLayersTensorIndices[o];a.push([t.name,i,s])}return t["outputLayers"]=a,t}static fromConfig(t,e,n={},r=!1){const a={},i={};function o(t,e){t.name in i?i[t.name].push(e):i[t.name]=[e]}function s(t,e){const n=[];let r;for(const i of e){const s=i[0],u=i[1],c=i[2];if(r=null==i[3]?{}:i[3],!(s in a))return void o(t,e);const l=a[s];if(l.inboundNodes.length<=u)return void o(t,e);const d=l.inboundNodes[u];n.push(d.outputTensors[c])}n.length>0&&t.apply(v(n),r)}function u(t){const n=t["name"],i=Qi(t,null!=e["customObjects"]?e["customObjects"]:{});i.setFastWeightInitDuringBuild(r),a[n]=i;const s=t["inboundNodes"];s.forEach(t=>{if(!(t instanceof Array))throw new h("Corrupted configuration, expected array for nodeData: "+t);o(i,t)})}const c=e["name"],l=e["layers"];for(const h of l)u(h);while(!E(i))for(const t of l){const e=a[t["name"]];if(e.name in i){const t=i[e.name];delete i[e.name];for(const n of t)s(e,n)}}const d=[],p=[],f=e["inputLayers"];for(const h of f){const t=h[0],e=h[1],n=h[2];b(t in a);const r=a[t],i=r.inboundNodes[e].outputTensors;d.push(i[n])}const m=e["outputLayers"];for(const h of m){const t=h[0],e=h[1],n=h[2];b(t in a);const r=a[t],i=r.inboundNodes[e].outputTensors;p.push(i[n])}return new t({inputs:d,outputs:p,name:c})}get stateful(){if(this._stateful)throw new h("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const t of this.layers)if(t.stateful)return!0;return!1}resetStates(){Object(c["tidy"])(()=>{this.layers.forEach(t=>{t.stateful&&t.resetStates()})})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function es(t,e,n){const r=e.length;if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>null);if(1===r)return Array.isArray(t)&&1===t.length?t:"object"===typeof t&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}if("object"===typeof t&&Object.keys(t).length>0&&"object"===typeof t[Object.keys(t)[0]]){const n=[];return e.forEach(e=>{e in t?n.push(t[e]):n.push(null)}),n}throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function ns(t,e){return es(t,e,"classWeight")}async function rs(t,e,n,r){if(null!=e||null!=r)throw new Error("Support sampleWeight is not implemented yet");if(null!=n){const e=Object(c["tidy"])(()=>{if(1===t.shape.length)return Object(c["clone"])(t);if(2===t.shape.length){if(t.shape[1]>1){const e=1;return Object(c["argMax"])(t,e)}if(1===t.shape[1])return Object(c["reshape"])(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await e.data());Object(c["dispose"])(e);const a=[];return r.forEach(t=>{if(null==n[t])throw new Error(`classWeight must contain all classes in the training data. The class ${t} exists in the data but not in classWeight`);a.push(n[t])}),Object(c["tensor1d"])(a,"float32")}return null}function as(t,e){return Object(c["mul"])(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const is=32;function os(t,e){let n,r;const a=e;n=a["xs"],r=a["ys"],c["util"].assert(null!=n&&null!=r,()=>"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+e);const i=ss("input",t.inputNames,n),o=ss("output",t.outputNames,r),s=i[0].shape[0];c["util"].assert(i.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${i.length} inputs.  (Expected input keys: `+JSON.stringify(t.inputNames)+")"),c["util"].assert(o.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: `+JSON.stringify(t.outputNames)+")");for(let u=0;u<i.length;u++)c["util"].assert(i[u].shape[0]===s,()=>`Batch size mismatch: input ${t.inputNames[u]} has ${i[u].shape[0]}; expected  ${s} based on input ${t.inputNames[0]}.`);for(let u=0;u<o.length;u++)c["util"].assert(o[u].shape[0]===s,()=>`Batch size mismatch: output ${t.outputNames[u]} has ${o[u].shape[0]}; expected  ${s} based on input ${t.inputNames[0]}.`);return{xs:i,ys:o}}function ss(t,e,n){if(n instanceof c["Tensor"])return[n];if(Array.isArray(n))return c["util"].assert(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const a of e){if(null==n[a])throw new h(`The feature data generated by the dataset lacks the required ${t} key '${a}'.`);r.push(n[a])}return r}}function us(t){if(3===t.length)throw new p("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function cs(t,e,n){const r=null!=n.batchesPerEpoch;if(c["util"].assert(null!=t.optimizer,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),c["util"].assert(null!=n,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),c["util"].assert(null!=n.epochs&&n.epochs>0&&Number.isInteger(n.epochs),()=>"For fitDataset(), config.epochs is expected to be a positive integer, but got "+n.epochs),c["util"].assert(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>"For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got "+n.batchesPerEpoch),c["util"].assert(null==n["validationSplit"],()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const a=null!=n.validationData;let i,o;if(a)if(ds(n.validationData))c["util"].assert(null==n.validationBatches||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got "+n.validationBatches);else{const t=us(n.validationData);i=t.xs,o=t.ys}const s=t.makeTrainFunction(),u=t.getDedupedMetricsNames();let l;l=a?u.slice().concat(u.map(t=>"val_"+t)):u.slice();const d=Yi(n.callbacks,n.yieldEvery),h=null==n.verbose?1:n.verbose,{callbackList:p,history:f}=Zi(d,h,n.epochs,null,null,ls(e,n),null,a,l);p.setModel(t),t.history=f,await p.onTrainBegin(),t.stopTraining_=!1;let m=null==n.initialEpoch?0:n.initialEpoch,g=await e.iterator();while(m<n.epochs){const l={};await p.onEpochBegin(m);let d=0,h=0;r||(g=await e.iterator());while(!r||d<n.batchesPerEpoch){const e=await g.next();if(r&&e.done){console.warn("You provided `batchesPerEpoch` as "+n.batchesPerEpoch+", but your dataset iterator ran out of data after "+d+" batches; interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+n.batchesPerEpoch*n.epochs+" batches). You may need to use the repeat() function when building your dataset.");break}if(null!=e.value){const{xs:r,ys:a}=os(t,e.value),i={};i["batch"]=h,i["size"]=r[0].shape[0],await p.onBatchBegin(h,i);const o=[];if(null!=n.classWeight){const e=ns(n.classWeight,t.outputNames);for(let t=0;t<e.length;++t)o.push(await rs(a[t],null,e[t]))}const l=r.concat(a).concat(o),f=s(l);c["dispose"](l);for(let t=0;t<u.length;++t){const e=u[t],n=f[t];i[e]=n,c["keep"](n)}await p.onBatchEnd(h,i),Wi(i),h++,d++}if(r?d>=n.batchesPerEpoch:e.done){if(a){let e;e=ds(n.validationData)?x(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):x(t.evaluate(i,o,{batchSize:null==n.validationBatchSize?is:n.validationBatchSize,verbose:0}));for(let n=0;n<t.metricsNames.length;++n)l["val_"+t.metricsNames[n]]=e[n]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(m,l),m++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function ls(t,e){let n=null;return null!=e.batchesPerEpoch?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function ds(t){return"function"===typeof t.iterator}function hs(t){return"function"===typeof t.next}async function ps(t,e,n){n=n||{};const r=null!=n.batches,a=t.testFunction;let i=[];if(n.verbose>0)throw new p("Verbose mode is not implemented yet.");c["util"].assert(!r||n.batches>0&&Number.isInteger(n.batches),()=>"Test loop expects `batches` to be a positive integer, but received "+JSON.stringify(n.batches));const o=hs(e)?e:await e.iterator();let s=0,u=0;while(!r||u<n.batches){const e=await o.next();if(i=c["tidy"](()=>{if(e.value){const{xs:n,ys:r}=os(t,e.value),o=n.concat(r),l=c["tidy"](()=>a(o));if(c["dispose"](o),0===u)for(let t=0;t<l.length;++t)i.push(Object(c["scalar"])(0));const d=o[0].shape[0];for(let t=0;t<l.length;++t){const e=l[t],n=i[t];i[t]=c["tidy"](()=>c["add"](i[t],c["mul"](d,e))),u>0&&c["dispose"](n)}c["dispose"](l),s+=d,++u}return i}),e.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let l=0;l<i.length;++l){const t=i[l];i[l]=c["div"](i[l],s),c["dispose"](t)}return v(i)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fs(t){c["util"].assert(t>0&&Number.isInteger(t),()=>"batchSize is required to be a positive integer, but got "+t)}function ms(t,e,n){return null==t?[null]:Array.isArray(t)?t.map(t=>yt(t,e,n-e)):yt(t,e,n-e)}function gs(t,e){return c["tidy"](()=>null==t?null:Array.isArray(t)?t.map(t=>gs(t,e)):Ct(t,"int32"===e.dtype?e:c["cast"](e,"int32")))}function bs(t,e){const n=[];let r=0,a=null;while(r<t)a=r+e,a>=t&&(a=t),n.push([r,a]),r=a;return n}async function ys(t,e,n,r,a,i,o,s,u,l,d,f,m,g,b){null==a&&(a=32),null==i&&(i=1),null==d&&(d=!0),null==m&&(m=0);let y=!1;if(null!=u&&null!=l&&(y=!0),null!=b&&(y=!0,null==g))throw new h("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=t.checkNumSamples(n,a,g,"steps_per_epoch");let x;null!=v&&(x=ct(0,v)),null==o&&(o=1);const{callbackList:w,history:k}=Zi(s,o,i,m,v,g,a,y,f);w.setModel(t),t.history=k,await w.onTrainBegin(),t.stopTraining_=!1;for(let h=m;h<i;++h){await w.onEpochBegin(h);const i={};if(null!=g)throw new p("stepsPerEpoch mode is not implemented yet.");{if("batch"===d)throw new p("batch shuffling is not implemneted yet");d&&c["util"].shuffle(x);const o=Object(c["tensor1d"])(x),s=bs(v,a);for(let d=0;d<s.length;++d){const h={};if(await w.onBatchBegin(d,h),c["tidy"](()=>{const p=s[d][0],f=s[d][1],m=yt(o,p,f-p);h["batch"]=d,h["size"]=f-p;const g=gs(n,m),b=e(g);for(let t=0;t<r.length;++t){const e=r[t],n=b[t];h[e]=n,c["keep"](n)}if(d===s.length-1&&y){const e=t.testLoop(u,l,a);for(let t=0;t<r.length;++t){const n=r[t],a=e[t];c["keep"](a),i["val_"+n]=a}}}),await w.onBatchEnd(d,h),Wi(h),t.stopTraining_)break}o.dispose()}if(await w.onEpochEnd(h,i),t.stopTraining_)break}return await w.onTrainEnd(),await t.history.syncData(),t.history}async function vs(t,e,n,r={}){if(t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");let a,i,o,s,u,l,d,f,m;t.isTraining=!0;try{const g=null==r.batchSize?32:r.batchSize;fs(g);const b=!1,y=await t.standardizeUserData(e,n,r.sampleWeight,r.classWeight,b,g);a=y[0],i=y[1],m=y[2];let v,x=!1;if(null!=r.validationData&&r.validationData.length>0){if(x=!0,2!==r.validationData.length)throw 3===r.validationData.length?new p("validationData including sample weights is not supported yet."):new h("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+r.validationData+" is invalid.");u=r.validationData[0],l=r.validationData[1];const e=!0,n=await t.standardizeUserData(u,l,null,null,e,g);d=n[0],f=n[1],v=d.concat(f)}else if(null!=r.validationSplit&&r.validationSplit>0&&r.validationSplit<1){x=!0;const t=Math.floor(a[0].shape[0]*(1-r.validationSplit)),e=a[0].shape[0];d=ms(a,t,e),o=a,a=ms(a,0,t),f=ms(i,t,e),s=i,i=ms(i,0,t),v=d.concat(f)}else null!=r.validationSteps&&(x=!0);const w=a.concat(i).concat(m);t.checkTrainableWeightsConsistency();const k=t.makeTrainFunction(),S=t.getDedupedMetricsNames();let O,_;x?(t.makeTestFunction(),O=t.testFunction,_=S.slice().concat(S.map(t=>"val_"+t))):(O=null,v=[],_=S.slice());const C=Yi(r.callbacks,r.yieldEvery),T=await ys(t,k,w,S,g,r.epochs,r.verbose,C,O,v,r.shuffle,_,r.initialEpoch,null,null);return T}finally{t.isTraining=!1,ws(a,e),ws(i,n),ws(o,e),ws(s,n),ws(d,u),ws(f,l),null!=m&&c["dispose"](m)}}function xs(t){const e=[];t instanceof c["Tensor"]&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(1===r.rank)e.push(ft(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function ws(t,e){if(null==t)return;const n=[];if(e instanceof c["Tensor"])n.push(e.id);else if(Array.isArray(e))e.forEach(t=>n.push(t.id));else if(null!=e)for(const a in e){const t=e[a];n.push(t.id)}const r=[];if(t instanceof c["Tensor"])-1===n.indexOf(t.id)&&r.push(t);else if(Array.isArray(t))t.forEach(t=>{-1===n.indexOf(t.id)&&r.push(t)});else if(null!=t)for(const a in t){const e=t[a];-1===n.indexOf(e.id)&&r.push(e)}r.forEach(t=>{t.isDisposed||t.dispose()})}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ks(t){return t instanceof c["Tensor"]}function Ss(t){return Array.isArray(t)}function Os(t){return!ks(t)&&!Ss(t)}function _s(t,e,n,r=!0,a=""){if(null==e||0===e.length){if(null!=t){let e=!1;if(Ss(t)&&t.length>0)e=!0;else if(Os(t)){for(const n in t)if(t.hasOwnProperty(n)){e=!0;break}}else e=!0;if(e)throw new h(`Error when checking model ${a} expected no data, but got `+t)}return[]}if(null==t)return e.map(t=>null);let i;if(Os(t)){t=t,i=[];for(const n of e){if(null==t[n])throw new h(`No data provided for "${n}". Need data for each key in: `+e);i.push(t[n])}}else if(Ss(t)){if(t=t,t.length!==e.length)throw new h(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): `+t);i=t}else{if(t=t,e.length>1)throw new h(`The model ${a} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape `+t.shape);i=[t]}if(i=xs(i),null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=i[o];if(t.shape.length!==n[o].length)throw new h(`Error when checking ${a}: expected ${e[o]} to have ${n[o].length} dimension(s). but got array with shape `+t.shape);for(let e=0;e<n[o].length;++e){if(0===e&&!r)continue;const i=t.shape[e],s=n[o][e];if(null!=s&&s>=0&&i!==s)throw new h(a+" expected a batch of elements where each "+`example has shape [${n[o].slice(1,n[o].length)}] `+`(i.e.,tensor shape [*,${n[o].slice(1,n[o].length)}])`+` but the ${a} received an input with ${t.shape[0]}`+` examples, each with shape [${t.shape.slice(1,t.shape.length)}]`+` (tensor shape [${t.shape}])`)}}return i}function Cs(t,e,n){const r=N(t.map(t=>t.shape[0]));r.sort();const a=N(e.map(t=>t.shape[0]));if(a.sort(),r.length>1)throw new h("All input Tensors (x) should have the same number of samples. Got array shapes: "+JSON.stringify(t.map(t=>t.shape)));if(a.length>1)throw new h("All target Tensors (y) should have the same number of samples. Got array shapes: "+JSON.stringify(e.map(t=>t.shape)));if(r.length>0&&a.length>0&&!c["util"].arraysEqual(r,a))throw new h(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${a[0]} target sample(s).`)}function Ts(t,e,n){const r=[eo,po,co];for(let a=0;a<t.length;++a){const i=t[a],o=e[a],s=n[a];if(null!=o){if(o===co&&1===i.shape[i.shape.length-1])throw new h(`You are passing a target array of shape ${i.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(-1!==r.indexOf(o)){const t=i.shape.slice(1),e=s.slice(1);for(let n=0;n<t.length;++n){const r=t[n],a=e[n];if(null!=a&&r!==a)throw new h(`A target Tensor with shape ${i.shape} was passed for an output of shape ${s}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function Is(t,e,n,r=!0,a=""){let i;if(Array.isArray(t)){if(t.length!==e.length)throw new h(`Error when checking model ${a}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);i=t}else{if(e.length>1)throw new h(`The model expects ${e.length} ${a} Tensors, but only received one Tensor. Found: array with shape `+JSON.stringify(t.shape)+".");i=[t]}if(null!=n)for(let o=0;o<e.length;++o){if(null==n[o])continue;const t=i[o];if(t.shape.length!==n[o].length)throw new h(`Error when checking ${a}: expected ${e[o]} to have ${n[o].length} dimension(s), but got array with shape `+JSON.stringify(t.shape));for(let i=0;i<n[o].length;++i){if(0===i&&!r)continue;const s=t.shape[i],u=n[o][i];if(null!=u&&u!==s)throw new h(`Error when checking ${a}: expected ${e[o]} to have shape ${JSON.stringify(n[o])} but got array with shape ${JSON.stringify(t.shape)}.`)}}}function Ns(t,e){if(null==t||Array.isArray(t)&&0===t.length)return e.map(t=>[]);let n;if("string"===typeof t||"function"===typeof t)n=[t];else{if(!Array.isArray(t)&&"object"!==typeof t)throw new TypeError("Type of metrics argument not understood. Expected an string,function, Array, or Object, found: "+t);n=t}if(Array.isArray(n))return e.map(t=>n);{const t=[];for(const r of e){let e=n.hasOwnProperty(r)?n[r]:[];Array.isArray(e)||(e=[e]),t.push(e)}return t}}const Es="layers-model";class As extends ts{constructor(t){super(t),this.isTraining=!1}summary(t,e,n=console.log){if(!this.built)throw new h("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Uo(this,t,e,n)}compile(t){if(null==t.loss&&(t.loss=[]),this.loss=t.loss,"string"===typeof t.optimizer)this.optimizer_=Bo(t.optimizer),this.isOptimizerOwned=!0;else{if(!(t.optimizer instanceof c["Optimizer"]))throw new h("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=t.optimizer,this.isOptimizerOwned=!1}let e=[];if(Array.isArray(t.loss)||"string"===typeof t.loss||"function"===typeof t.loss)if(Array.isArray(t.loss)){if(t.loss.length!==this.outputs.length)throw new h(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${t.loss}.`);const n=t.loss;e=n.map(t=>yo(t))}else{const n=yo(t.loss);this.outputs.forEach(t=>{e.push(n)})}else{t.loss=t.loss;for(const e in t.loss)if(-1===this.outputNames.indexOf(e))throw new h(`Unknown entry in loss dictionary: "${e}". Only expected the following keys: `+this.outputNames);for(const n of this.outputNames)null==t.loss[n]&&console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),e.push(yo(t.loss[n]))}this.lossFunctions=e,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const t=this.internalOutputShapes[i],e=this.outputNames[i];this.feedOutputNames.push(e),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[i])}const n=[];this.metrics=t.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Q("loss",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=this.lossFunctions[t];this.outputs.length>1&&(this.metricsTensors.push([e,t]),this.metricsNames.push(this.outputNames[t]+"_loss"))}});const r=Ns(t.metrics,this.outputNames),a=(t,e,n)=>{this.outputNames.length>1&&(e=this.outputNames[t]+"_"+e),this.metricsNames.push(e),this.metricsTensors.push([n,t])};Q("metric",()=>{for(let t=0;t<this.outputs.length;++t){if(-1!==n.indexOf(t))continue;const e=r[t],i=e=>{const n="";let r,i,o;for(const s of e){if("string"===typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){const e=this.internalOutputShapes[t];let a;1===e[e.length-1]||this.lossFunctions[t]===po?-1!==["accuracy","acc"].indexOf(s)?i=vo:-1!==["crossentropy","ce"].indexOf(s)&&(i=Co):this.lossFunctions[t]===lo?-1!==["accuracy","acc"].indexOf(s)?i=To:-1!==["crossentropy","ce"].indexOf(s)&&(i=Mo):-1!==["accuracy","acc"].indexOf(s)?i=xo:-1!==["crossentropy","ce"].indexOf(s)&&(i=Do),-1!==["accuracy","acc"].indexOf(s)?a="acc":-1!==["crossentropy","ce"].indexOf(s)&&(a="ce"),o=i,r=n+a}else{const t=$o(s);o=t,r=n+Lo(s)}let e;Q(r,()=>{e=o}),a(t,r,e)}};i(e)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(t,e,n={}){const r=null==n.batchSize?32:n.batchSize;fs(r);const a=!0,i=this.standardizeUserDataXY(t,e,a,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const o=this.testFunction,s=this.testLoop(o,a,r,n.verbose,n.steps);return v(s)}finally{ws(i[0],t),ws(i[1],e)}}async evaluateDataset(t,e){return this.makeTestFunction(),ps(this,t,e)}checkNumSamples(t,e,n,r="steps"){let a;if(null!=n){if(a=null,null!=e)throw new h(`If ${r} is set, batchSize must be null or undefined.Got batchSize = `+e)}else{if(null==t)throw new h("Either the input data should have a defined shape, or "+r+" shoud be specified.");a=Array.isArray(t)?t[0].shape[0]:t.shape[0]}return a}execute(t,e){if(Array.isArray(e)&&0===e.length)throw new h("`outputs` is an empty Array, which is not allowed.");const n=Array.isArray(e),r=n?e:[e],a=this.retrieveSymbolicTensors(r),i=new Ie;if(t instanceof c["Tensor"]&&(t=[t]),Array.isArray(t)){if(t.length!==this.inputs.length)throw new h(`The number of inputs provided (${t.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let e=0;e<this.inputs.length;++e)i.add(this.inputs[e],t[e])}else for(const s of this.inputs){const e=t[s.name];if(null==e)throw new h("No value is provided for the model's input "+s.name);i.add(s,e)}const o=Re(a,i);return n?o:o[0]}retrieveSymbolicTensors(t){const e=g(null,t.length);let n=t.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(t=>t.name);for(let r=0;r<t.length;++r){const o=i.indexOf(t[r]);if(-1!==o&&(e[r]=a[o],n--),0===n)break}if(0===n)break}if(n>0){const n=[];throw e.forEach((e,r)=>{null==e&&n.push(t[r])}),new h("Cannot find SymbolicTensors for output name(s): "+JSON.stringify(n))}return e}predictLoop(t,e=32,n=!1){return c["tidy"](()=>{const r=this.checkNumSamples(t);if(n)throw new p("Verbose predictLoop() is not implemented yet.");const a=bs(r,e),i=this.outputs.map(t=>[]);for(let e=0;e<a.length;++e){const n=c["tidy"](()=>{const n=a[e][0],r=a[e][1],i=ms(t,n,r),o=[];if(Array.isArray(i))for(let t=0;t<i.length;++t)o.push({key:this.inputs[t],value:i[t]});else o.push({key:this.inputs[0],value:i});const s=new Ie(o);return Re(this.outputs,s)});n.forEach((t,e)=>i[e].push(t))}return v(i.map(t=>c["concat"](t,0)))})}predict(t,e={}){const n=xs(t);Is(n,this.inputNames,this.feedInputShapes,!1);try{const r=null==e.batchSize?32:e.batchSize;return fs(r),this.predictLoop(n,r)}finally{ws(n,t)}}predictOnBatch(t){Is(t,this.inputNames,this.feedInputShapes,!0);const e=(Array.isArray(t)?t[0]:t).shape[0];return this.predictLoop(t,e)}standardizeUserDataXY(t,e,n=!0,r){if(null==this.optimizer_)throw new d("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const t=this.feedOutputShapes[i],e=this.feedLossFns[i];e===lo?a.push(t.slice(0,t.length-1).concat([1])):a.push(t)}if(t=_s(t,this.feedInputNames,this.feedInputShapes,!1,"input"),e=_s(e,this.feedOutputNames,a,!1,"target"),Cs(t,e,null),Ts(e,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=r&&r>0&&t[0].shape[0]%r!==0)throw new h(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${t[0].shape[0]} sample(s).`);return[t,e]}async standardizeUserData(t,e,n,r,a=!0,i){const[o,s]=this.standardizeUserDataXY(t,e,a,i);if(null!=n)throw new Error("sample weight is not supported yet.");let u=null;if(null!=r){const t=ns(r,this.outputNames);u=[];for(let e=0;e<t.length;++e)u.push(await rs(s[e],null,t[e]))}return[o,s,u]}testLoop(t,e,n,r=0,a){return c["tidy"](()=>{const i=this.checkNumSamples(e,n,a,"steps"),o=[];if(r>0)throw new p("Verbose mode is not implemented yet.");if(null!=a)throw new p("steps mode in testLoop() is not implemented yet");{const r=bs(i,n),a=Object(c["tensor1d"])(ct(0,i));for(let n=0;n<r.length;++n){const i=r[n][0],s=r[n][1],u=yt(a,i,s-i),l=gs(e,u),d=t(l);if(0===n)for(let t=0;t<d.length;++t)o.push(Object(c["scalar"])(0));for(let t=0;t<d.length;++t){const e=d[t];o[t]=c["add"](o[t],c["mul"](s-i,e))}}for(let t=0;t<o.length;++t)o[t]=c["div"](o[t],i)}return o})}getDedupedMetricsNames(){const t=this.metricsNames,e=[];for(let n=0;n<t.length;++n){const r=t[n];let a=r;if(y(t,r)>1){const e=y(t.slice(0,n),r);a+="_"+e}e.push(a)}return e}makeTrainFunction(){return t=>{const e=[],n=t.slice(0,this.inputs.length),r=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=t.slice(this.inputs.length+this.outputs.length,this.inputs.length+2*this.outputs.length),i=[],o=()=>{const t=[];for(let e=0;e<this.inputs.length;++e)t.push({key:this.inputs[e],value:n[e]});const o=new Ie(t),s=Re(this.outputs,o,{training:!0});let u;for(let n=0;n<this.lossFunctions.length;++n){const t=this.lossFunctions[n];let i=t(r[n],s[n]);null!=a[n]&&(i=as(i,a[n]));const o=c["mean"](i);e.push(o),u=0===n?i:c["add"](u,i)}for(let n=0;n<this.metricsTensors.length;++n){let t;if(this.outputs.length>1&&n<this.outputs.length)t=e[n];else{const e=this.metricsTensors[n][0],a=this.metricsTensors[n][1];t=c["mean"](e(r[a],s[a]))}c["keep"](t),i.push(t)}return u=c["mean"](u),this.calculateLosses().forEach(t=>{u=c["add"](u,t)}),u},s=this.collectedTrainableWeights.map(t=>t.read()),u=!0,l=this.optimizer_.minimize(o,u,s);return[l].concat(i)}}makeTestFunction(){this.testFunction=t=>c["tidy"](()=>{const e=[];let n;const r=t.slice(0,this.inputs.length),a=t.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let t=0;t<this.inputs.length;++t)i.push({key:this.inputs[t],value:r[t]});const o=new Ie(i),s=Re(this.outputs,o);for(let t=0;t<this.lossFunctions.length;++t){const r=this.lossFunctions[t],i=c["mean"](r(a[t],s[t]));n=0===t?i:c["add"](n,i),e.push(n)}for(let t=0;t<this.metricsTensors.length;++t){const n=this.metricsTensors[t][0],r=this.metricsTensors[t][1],i=c["mean"](n(a[r],s[r]));e.push(i)}return e})}async fit(t,e,n={}){return vs(this,t,e,n)}async fitDataset(t,e){return cs(this,t,e)}async trainOnBatch(t,e){const n=await this.standardizeUserData(t,e),r=n[0],a=n[1],i=this.makeTrainFunction(),o=i(r.concat(a)),s=[];for(const u of o){const t=await u.data();s.push(t[0])}return c["dispose"](o),ws(n[0],t),ws(n[1],e),v(s)}getNamedWeights(t){const e=[],n=null!=t&&t.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n);for(let i=0;i<r.length;++i)n&&!r[i].trainable||e.push({name:r[i].originalName,tensor:a[i]});return e}set stopTraining(t){this.stopTraining_=t}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(t){this.optimizer_!==t&&(this.optimizer_=t,this.isOptimizerOwned=!1)}dispose(){const t=super.dispose();if(0===t.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){const e=c["memory"]().numTensors;this.optimizer_.dispose(),t.numDisposedVariables+=e-c["memory"]().numTensors}return t}getLossIdentifiers(){let t;if("string"===typeof this.loss)t=w(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if("string"!==typeof t)throw new Error("Serialization of non-string loss is not supported.");t=this.loss.map(t=>w(t))}else{const e=Object.keys(this.loss);t={};const n=this.loss;for(const r of e){if("string"!==typeof n[r])throw new Error("Serialization of non-string loss is not supported.");t[r]=w(n[r])}}return t}getMetricIdentifiers(){if("string"===typeof this.metrics||"function"===typeof this.metrics)return[w(Lo(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(t=>w(Lo(t)));{const t={};for(const e in this.metrics)t[e]=w(Lo(this.metrics[e]));return t}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(t){if(null!=t.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=t.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=t.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");const e=Jo(t.optimizer_config),n=Qi(e);let r,a;if("string"===typeof t.loss)r=k(t.loss);else if(Array.isArray(t.loss))r=t.loss.map(t=>k(t));else if(null!=t.loss){r={};for(const e in t.loss)r[e]=k(t.loss[e])}if(Array.isArray(t.metrics))a=t.metrics.map(t=>k(t));else if(null!=t.metrics){a={};for(const e in t.metrics)a[e]=k(t.metrics[e])}this.compile({loss:r,metrics:a,optimizer:n})}async save(t,e){if("string"===typeof t){const e=c["io"].getSaveHandlers(t);if(0===e.length)throw new h(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new h(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new h("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const n=await c["io"].encodeWeights(this.getNamedWeights(e)),r=!1,a=null,i=this.toJSON(a,r),o={modelTopology:i,format:Es,generatedBy:"TensorFlow.js tfjs-layers v"+Qo,convertedBy:null},s=null!=e&&e.includeOptimizer;if(s&&null!=this.optimizer){o.trainingConfig=this.getTrainingConfig();const t="optimizer",{data:e,specs:r}=await c["io"].encodeWeights(await this.optimizer.getWeights(),t);n.specs.push(...r),n.data=c["io"].concatenateArrayBuffers([n.data,e])}if(null!=this.userDefinedMetadata){const t=!0;Wo(this.userDefinedMetadata,this.name,t),o.userDefinedMetadata=this.userDefinedMetadata}return o.weightData=n.data,o.weightSpecs=n.specs,t.save(o)}setUserDefinedMetadata(t){Wo(t,this.name),this.userDefinedMetadata=t}getUserDefinedMetadata(){return this.userDefinedMetadata}}As.className="Model",c["serialization"].registerClass(As);class Rs extends As{}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
async function js(t,e){"modelTopology"in t||(t={modelTopology:t}),t=t;let n=t.modelTopology;null!=n["model_config"]&&(n=n["model_config"]);const r=Jo(n),a=Qi(r,e);if(null!=t.weightsManifest){const e=await c["io"].loadWeights(t.weightsManifest,t.pathPrefix,a.weights.map(t=>t.originalName)),n={};for(const t of a.weights)n[t.originalName]=e[t.originalName];a.loadWeights(n),Object(c["dispose"])(e)}return a}async function Ds(t,e){if(null==e&&(e={}),"string"===typeof t){const n=c["io"].getLoadHandlers(t,e);if(0===n.length)n.push(c["io"].browserHTTPRequest(t,e));else if(n.length>1)throw new h(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return Fs(t,void 0,e)}async function Fs(t,e,n){if(null==n&&(n={}),null==t.load)throw new h("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const r=await t.load();let a=r.modelTopology;null!=a["model_config"]&&(a=a["model_config"]);const i=null==n.strict||n.strict,o=null!=r.weightData&&null!=r.weightSpecs&&i,s=Qi(Jo(a),e,o),u=r.trainingConfig;if(null!=u&&s.loadTrainingConfig(u),null!=r.userDefinedMetadata&&s.setUserDefinedMetadata(r.userDefinedMetadata),null!=r.weightData){if(null==r.weightSpecs)throw new h("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:t,optimizerWeights:e}=Ms(r.weightData,r.weightSpecs);s.loadWeights(t,i),null!=s.optimizer&&e.length>0&&await s.optimizer.setWeights(e),Object(c["dispose"])(t),Object(c["dispose"])(e.map(t=>t.tensor))}return s}function Ms(t,e){const n=c["io"].decodeWeights(t,e),r={},a=[];return e.forEach(t=>{"optimizer"===t.group?a.push({name:t.name,tensor:n[t.name]}):r[t.name]=n[t.name]}),{modelWeights:r,optimizerWeights:a}}Rs.className="Functional",c["serialization"].registerClass(Rs);class Ps extends As{constructor(t){if(super({inputs:[],outputs:[]}),t=t||{},this.trainable=!0,this.built=!1,this.name=null!=t.name?t.name:B("sequential_"),null!=t.layers)for(const e of t.layers)this.add(e)}checkShape(t){const e=t.inboundNodes[0].outputTensors[0].shape;if(e.some(t=>t<0))throw new h("Negative dimension size caused by adding layer "+t.name+" with input shape ["+t.inboundNodes[0].inputTensors[0].shape+"]")}add(t){const e=t instanceof Ps||t instanceof As;let n;if(e){if(n=t,1!==n.outputs.length)throw new h("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==n.inputs.length)throw new h("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===t.inboundNodes.length){if(null==t.batchInputShape)throw new h("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const e=Ce({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+"_input"});t.apply(e)}if(e)this.outputs=n.outputs,this.inputs=n.inputs;else{if(1!==t.inboundNodes.length)throw new h(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(1!==t.inboundNodes[0].outputTensors.length)throw new h("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=Oe(this.outputs[0])}this.inboundNodes=[],new ve({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:g(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(t=>t.shape),outputShapes:this.outputs[0].shape})}else{const e=t.apply(this.outputs[0]);if(Array.isArray(e))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const t=this.layers.length-1;this.layers[t].outboundNodes=[],this.outputs=[this.layers[t].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(t,e){return null==this.model&&this.build(),this.model.call(t,e)}build(t){if(ce(t),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new As({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(t,e,n=console.log){this.built||this.build(),super.summary(t,e,n)}setWeights(t){null==this.model&&this.build(),this.model.setWeights(t)}evaluate(t,e,n={}){if(!this.built)throw new d("The model needs to be compiled before being used.");return this.model.evaluate(t,e,n)}async evaluateDataset(t,e){if(!this.built)throw new d("The model needs to be compiled before being used.");return this.model.evaluateDataset(t,e)}predict(t,e={}){return null==this.model&&this.build(),this.model.predict(t,e)}predictOnBatch(t){return null==this.model&&this.build(),this.model.predictOnBatch(t)}compile(t){this.build(),this.model.compile(t),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return null==this.model?void 0:this.model.optimizer}set optimizer(t){this.model.optimizer=t}async fit(t,e,n={}){if(!this.built)throw new d("The model needs to be compiled before being used.");return this.model.fit(t,e,n)}async fitDataset(t,e){if(!this.built)throw new d("The model needs to be compiled before being used.");return this.model.fitDataset(t,e)}async trainOnBatch(t,e){return this.model.trainOnBatch(t,e)}static fromConfig(t,e,n={},r=!1){let a,i={};if(e instanceof Array){if(null==e[0].className||"Merge"===e[0]["className"])throw new h("Legacy serialization format not supported yet.");a=e}else c["util"].assert(null!=e["layers"],()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=e["layers"],delete e["layers"],i=e;const o=new t(i);if(!(o instanceof Ps))throw new p("Sequential.fromConfig called on non-Sequential input: "+o);for(const s of a){const t=void 0,e=Qi(s,t,r);r&&e.setFastWeightInitDuringBuild(!0),o.add(e)}return o}set stopTraining(t){if(null==this.model)throw new h("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=t}get stopTraining(){if(null==this.model)throw new h("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const t=[];for(const e of this.layers){const n={};n["className"]=e.getClassName(),n["config"]=e.getConfig(),t.push(n)}return{name:this.name,layers:t}}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function $s(t){return new As(t)}function Ls(t){return new Ps(t)}function Bs(t,e){return null==e&&(e={}),Ds(t,e)}function zs(t){return Ce(t)}function Ws(t,e){Ji.registerCallbackConstructor(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */Ps.className="Sequential",c["serialization"].registerClass(Ps);class Vs extends c["serialization"].Serializable{getConfig(){return{}}}class Us extends Vs{apply(t,e=1){return Et(t,e)}}Us.className="elu",c["serialization"].registerClass(Us);class Gs extends Vs{apply(t){return c["selu"](t)}}Gs.className="selu",c["serialization"].registerClass(Gs);class Hs extends Vs{apply(t){return c["relu"](t)}}Hs.className="relu",c["serialization"].registerClass(Hs);class qs extends Vs{apply(t){return Object(c["tidy"])(()=>c["minimum"](6,c["relu"](t)))}}qs.className="relu6",c["serialization"].registerClass(qs);class Ks extends Vs{apply(t){return t}}Ks.className="linear",c["serialization"].registerClass(Ks);class Xs extends Vs{apply(t){return c["sigmoid"](t)}}Xs.className="sigmoid",c["serialization"].registerClass(Xs);class Ys extends Vs{apply(t){return jt(t)}}Ys.className="hardSigmoid",c["serialization"].registerClass(Ys);class Js extends Vs{apply(t){return c["softplus"](t)}}Js.className="softplus",c["serialization"].registerClass(Js);class Zs extends Vs{apply(t){return At(t)}}Zs.className="softsign",c["serialization"].registerClass(Zs);class Qs extends Vs{apply(t){return c["tanh"](t)}}Qs.className="tanh",c["serialization"].registerClass(Qs);class tu extends Vs{apply(t,e=-1){return c["softmax"](t,e)}}tu.className="softmax",c["serialization"].registerClass(tu);class eu extends Vs{apply(t,e=-1){return c["logSoftmax"](t,e)}}eu.className="logSoftmax",c["serialization"].registerClass(eu);class nu extends Vs{apply(t,e=1){return Object(c["tidy"])(()=>c["mul"](c["sigmoid"](c["mul"](t,e)),t))}}nu.className="swish",c["serialization"].registerClass(nu);class ru extends Vs{apply(t){return Object(c["tidy"])(()=>c["mul"](t,c["tanh"](c["softplus"](t))))}}function au(t){return t.getClassName()}function iu(t,e={}){return C(t,c["serialization"].SerializationMap.getMap().classNameMap,e,"activation")}function ou(t){if(null==t){const t={className:"linear",config:{}};return iu(t)}if("string"===typeof t){const e={};return e["className"]=t,e["config"]={},iu(e)}return t instanceof Vs?t:iu(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function su(t){if(null!=t&&"object"!==typeof t)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an object, but received: "+t)}ru.className="mish",c["serialization"].registerClass(ru);class uu extends c["serialization"].Serializable{}class cu extends uu{constructor(t){super(),su(t),this.l1=null==t||null==t.l1?.01:t.l1,this.l2=null==t||null==t.l2?.01:t.l2,this.hasL1=0!==this.l1,this.hasL2=0!==this.l2}apply(t){return Object(c["tidy"])(()=>{let e=Object(c["zeros"])([1]);return this.hasL1&&(e=Object(c["add"])(e,Object(c["sum"])(c["mul"](this.l1,Object(c["abs"])(t))))),this.hasL2&&(e=Object(c["add"])(e,Object(c["sum"])(c["mul"](this.l2,Tt(t))))),c["reshape"](e,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(t,e){return new t({l1:e["l1"],l2:e["l2"]})}}function lu(t){return su(t),new cu({l1:null!=t?t.l1:null,l2:0})}function du(t){return su(t),new cu({l2:null!=t?t.l2:null,l1:0})}cu.className="L1L2",c["serialization"].registerClass(cu);const hu={l1l2:"L1L2"};function pu(t){return O(t)}function fu(t,e={}){return C(t,c["serialization"].SerializationMap.getMap().classNameMap,e,"regularizer")}function mu(t){if(null==t)return null;if("string"===typeof t){const e=t in hu?hu[t]:t,n={className:e,config:{}};return fu(n)}return t instanceof uu?t:fu(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class gu extends we{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,null!=t&&(this.maxValue=t.maxValue)}call(t,e){t=ue(t);let n=Object(c["relu"])(t);return null!=this.maxValue&&(n=Object(c["clipByValue"])(n,0,this.maxValue)),n}computeOutputShape(t){return t}getConfig(){const t={maxValue:this.maxValue},e=super.getConfig();return Object.assign(t,e),t}}gu.className="ReLU",c["serialization"].registerClass(gu);class bu extends we{constructor(t){super(null==t?{}:t),this.DEFAULT_ALPHA=.3,null==t&&(t={}),this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=ue(t);return Object(c["leakyRelu"])(n,this.alpha)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}bu.className="LeakyReLU",c["serialization"].registerClass(bu);class yu extends we{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA_INITIALIZER="zeros",null==t&&(t={}),this.supportsMasking=!0,this.alphaInitializer=ie(t.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=mu(t.alphaRegularizer),this.alphaConstraint=wi(t.alphaConstraint),null==t.sharedAxes)this.sharedAxes=null;else if(Array.isArray(t.sharedAxes))this.sharedAxes=t.sharedAxes;else{if("number"!==typeof t.sharedAxes)throw new h("Expected sharedAxes to be a number or an array of numbers, but got "+t.sharedAxes);this.sharedAxes=[t.sharedAxes]}}build(t){t=ce(t);const e=t.slice(1);if(null!=this.sharedAxes)for(const r of this.sharedAxes)e[r-1]=1;this.alpha=this.addWeight("alpha",e,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const n={};if(null!=this.sharedAxes)for(let r=1;r<t.length;++r)n[r]=t[r];this.inputSpec=[new ge({ndim:t.length,axes:n})],this.built=!0}call(t,e){return t=ue(t),Object(c["prelu"])(t,this.alpha.read())}getConfig(){const t={alphaInitializer:ae(this.alphaInitializer),alphaRegularizer:pu(this.alphaRegularizer),alphaConstraint:vi(this.alphaConstraint),sharedAxes:this.sharedAxes},e=super.getConfig();return Object.assign(t,e),t}}yu.className="PReLU",c["serialization"].registerClass(yu);class vu extends we{constructor(t){if(super(null==t?{}:t),this.DEFAULT_ALPHA=1,null==t&&(t={}),null!=t.alpha&&t.alpha!==this.DEFAULT_ALPHA)throw new p(`Non-default alpha value (${t.alpha}) is not supported by the ELU layer yet.`);this.alpha=null==t.alpha?this.DEFAULT_ALPHA:t.alpha}call(t,e){const n=ue(t);return Object(c["elu"])(n)}computeOutputShape(t){return t}getConfig(){const t={alpha:this.alpha},e=super.getConfig();return Object.assign(t,e),t}}vu.className="ELU",c["serialization"].registerClass(vu);class xu extends we{constructor(t){super(null==t?{}:t),this.DEFAULT_THETA=1,null==t&&(t={}),this.theta=null==t.theta?this.DEFAULT_THETA:t.theta}call(t,e){const n=ue(t);return Object(c["mul"])(n,Object(c["cast"])(Object(c["greater"])(n,this.theta),"float32"))}computeOutputShape(t){return t}getConfig(){const t={theta:this.theta},e=super.getConfig();return Object.assign(t,e),t}}xu.className="ThresholdedReLU",c["serialization"].registerClass(xu);class wu extends we{constructor(t){super(null==t?{}:t),this.DEFAULT_AXIS=1,null==t&&(t={}),this.softmax=(new tu).apply,this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis}call(t,e){const n=ue(t);return this.softmax(n,this.axis)}computeOutputShape(t){return t}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function ku(t,e,n){if("number"===typeof t)return g(t,e);if(t.length!==e)throw new h(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const a=t[r];if(!it(a))throw new h(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number `+a)}return t}function Su(t,e,n,r,a=1){if(null==t)return t;const i=e+(e-1)*(a-1);let o;return o="same"===n?t:t-i+1,Math.floor((o+r-1)/r)}function Ou(t,e,n,r){if(null==t)return null;if("valid"===r)t=t*e+ut([n-e,0]);else{if("same"!==r)throw new h(`Unsupport padding mode: ${r}.`);t*=e}return t}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _u(t,e){return Object(c["tidy"])(()=>(q(e),"channelsFirst"===e?c["transpose"](t,[0,2,3,1]):t))}function Cu(t,e){return Object(c["tidy"])(()=>(q(e),"channelsFirst"===e?c["transpose"](t,[0,2,3,4,1]):t))}function Tu(t,e,n,r=1,a="valid",i,o=1){return Object(c["tidy"])(()=>{if(null==i&&(i=ht()),q(i),3!==t.shape.length)throw new h("The input of a conv1dWithBias operation should be 3, but is "+t.shape.length+" instead.");if(3!==e.shape.length)throw new h("The kernel for a conv1dWithBias operation should be 3, but is "+e.shape.length+" instead");if(null!=n&&1!==n.shape.length)throw new h("The bias for a conv1dWithBias operation should be 1, but is "+e.shape.length+" instead");if("channelsFirst"===i&&(t=c["transpose"](t,[0,2,1])),"causal"===a)throw new p("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let s=c["conv1d"](t,e,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=Nt(s,n)),s})}function Iu(t,e,n,r=[1,1],a="valid",i,o,s=null){return Object(c["tidy"])(()=>{if(null==i&&(i=ht()),q(i),3!==t.rank&&4!==t.rank)throw new h(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(3!==e.rank&&4!==e.rank)throw new h(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let u=_u(t,i);if("causal"===a)throw new p("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=c["fused"].conv2d({x:u,filter:e,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=c["transpose"](u,[0,3,1,2])),u})}function Nu(t,e,n,r=[1,1,1],a="valid",i,o){return Object(c["tidy"])(()=>{if(null==i&&(i=ht()),q(i),4!==t.rank&&5!==t.rank)throw new h("conv3dWithBias expects input to be of rank 4 or 5, but received "+t.rank+".");if(4!==e.rank&&5!==e.rank)throw new h("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+t.rank+".");let s=Cu(t,i);if("causal"===a)throw new p("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=c["conv3d"](s,e,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=Nt(s,n)),"channelsFirst"===i&&(s=c["transpose"](s,[0,4,1,2,3])),s})}wu.className="Softmax",c["serialization"].registerClass(wu);class Eu extends we{constructor(t,e){if(super(e),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Eu.verifyArgs(e),this.rank=t,j(this.rank,"rank"),1!==this.rank&&2!==this.rank&&3!==this.rank)throw new p(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=ku(e.kernelSize,t,"kernelSize"),this.strides=ku(null==e.strides?1:e.strides,t,"strides"),this.padding=null==e.padding?"valid":e.padding,X(this.padding),this.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,q(this.dataFormat),this.activation=ou(e.activation),this.useBias=null==e.useBias||e.useBias,this.biasInitializer=ie(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=wi(e.biasConstraint),this.biasRegularizer=mu(e.biasRegularizer),this.activityRegularizer=mu(e.activityRegularizer),this.dilationRate=ku(null==e.dilationRate?1:e.dilationRate,t,"dilationRate"),1===this.rank&&Array.isArray(this.dilationRate)&&1!==this.dilationRate.length)throw new h("dilationRate must be a number or an array of a single number for 1D convolution, but received "+JSON.stringify(this.dilationRate));if(2===this.rank){if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate];else if(2!==this.dilationRate.length)throw new h("dilationRate must be a number or array of two numbers for 2D convolution, but received "+JSON.stringify(this.dilationRate))}else if(3===this.rank)if("number"===typeof this.dilationRate)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(3!==this.dilationRate.length)throw new h("dilationRate must be a number or array of three numbers for 3D convolution, but received "+JSON.stringify(this.dilationRate))}static verifyArgs(t){if(b("kernelSize"in t,"required key 'kernelSize' not in config"),"number"!==typeof t.kernelSize&&!R(t.kernelSize,"number",1,3))throw new h(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(t.kernelSize)}.`)}getConfig(){const t={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:au(this.activation),useBias:this.useBias,biasInitializer:ae(this.biasInitializer),biasRegularizer:pu(this.biasRegularizer),activityRegularizer:pu(this.activityRegularizer),biasConstraint:vi(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}class Au extends Eu{constructor(t,e){super(t,e),this.kernel=null,Au.verifyArgs(e),this.filters=e.filters,j(this.filters,"filters"),this.kernelInitializer=ie(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=wi(e.kernelConstraint),this.kernelRegularizer=mu(e.kernelRegularizer)}build(t){t=ce(t);const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new h("The channel dimension of the input should be defined. Found "+t[e]);const n=t[e],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[e]:n}}],this.built=!0}call(t,e){return Object(c["tidy"])(()=>{let e;t=ue(t);const n=null==this.bias?null:this.bias.read(),r=M(this.activation.getClassName());if(null!=r&&2===this.rank)e=Iu(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(1===this.rank)e=Tu(t,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(2===this.rank)e=Iu(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else{if(3!==this.rank)throw new p("convolutions greater than 3D are not implemented yet.");e=Nu(t,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate)}null!=this.activation&&(e=this.activation.apply(e))}return e})}computeOutputShape(t){t=ce(t);const e=[],n="channelsLast"===this.dataFormat?t.slice(1,t.length-1):t.slice(2);for(let a=0;a<n.length;++a){const t=Su(n[a],this.kernelSize[a],this.padding,this.strides[a],"number"===typeof this.dilationRate?this.dilationRate:this.dilationRate[a]);e.push(t)}let r=[t[0]];return"channelsLast"===this.dataFormat?(r=r.concat(e),r.push(this.filters)):(r.push(this.filters),r=r.concat(e)),r}getConfig(){const t={filters:this.filters,kernelInitializer:ae(this.kernelInitializer),kernelRegularizer:pu(this.kernelRegularizer),kernelConstraint:vi(this.kernelConstraint)},e=super.getConfig();return Object.assign(t,e),t}static verifyArgs(t){if(!("filters"in t)||"number"!==typeof t.filters||t.filters<1)throw new h("Convolution layer expected config.filters to be a 'number' > 0 but got "+JSON.stringify(t.filters))}}class Ru extends Au{constructor(t){super(2,t),Ru.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t["rank"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!R(t.kernelSize,"number",1,2))throw new h(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(t.kernelSize)}.`)}}Ru.className="Conv2D",c["serialization"].registerClass(Ru);class ju extends Au{constructor(t){super(3,t),ju.verifyArgs(t)}getConfig(){const t=super.getConfig();return delete t["rank"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&(!Array.isArray(t.kernelSize)||1!==t.kernelSize.length&&3!==t.kernelSize.length))throw new h(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(t.kernelSize)}.`)}}ju.className="Conv3D",c["serialization"].registerClass(ju);class Du extends Ru{constructor(t){if(super(t),this.inputSpec=[new ge({ndim:4})],"same"!==this.padding&&"valid"!==this.padding)throw new h("Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+this.padding)}build(t){if(t=ce(t),4!==t.length)throw new h("Input should have rank 4; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new h("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ge({ndim:4,axes:{[e]:n}})],this.built=!0}call(t,e){return c["tidy"](()=>{let e=ue(t);if(4!==e.shape.length)throw new h("Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);const n=e.shape,r=n[0];let a,i;"channelsFirst"===this.dataFormat?(a=2,i=3):(a=1,i=2);const o=n[a],s=n[i],u=this.kernelSize[0],l=this.kernelSize[1],d=this.strides[0],p=this.strides[1],f=Ou(o,d,u,this.padding),m=Ou(s,p,l,this.padding),g=[r,f,m,this.filters];"channelsLast"!==this.dataFormat&&(e=c["transpose"](e,[0,2,3,1]));let b=c["conv2dTranspose"](e,this.kernel.read(),g,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(b=c["transpose"](b,[0,3,1,2])),null!=this.bias&&(b=Nt(b,this.bias.read(),this.dataFormat)),null!=this.activation&&(b=this.activation.apply(b)),b})}computeOutputShape(t){t=ce(t);const e=t.slice();let n,r,a;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3):(n=3,r=1,a=2);const i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return e[n]=this.filters,e[r]=Ou(e[r],s,i,this.padding),e[a]=Ou(e[a],u,o,this.padding),e}getConfig(){const t=super.getConfig();return delete t["dilationRate"],t}}Du.className="Conv2DTranspose",c["serialization"].registerClass(Du);class Fu extends ju{constructor(t){if(super(t),this.inputSpec=[new ge({ndim:5})],"same"!==this.padding&&"valid"!==this.padding)throw new h("Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode "+this.padding)}build(t){if(t=ce(t),5!==t.length)throw new h("Input should have rank 5; Received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e])throw new h("The channel dimension of the inputs should be defined. Found `None`.");const n=t[e],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new ge({ndim:5,axes:{[e]:n}})],this.built=!0}call(t,e){return c["tidy"](()=>{let e=ue(t);if(5!==e.shape.length)throw new h("Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-"+e.shape.length);const n=e.shape,r=n[0];let a,i,o;"channelsFirst"===this.dataFormat?(o=2,a=3,i=4):(o=1,a=2,i=3);const s=n[o],u=n[a],l=n[i],d=this.kernelSize[0],p=this.kernelSize[1],f=this.kernelSize[2],m=this.strides[0],g=this.strides[1],b=this.strides[2],y=Ou(s,m,d,this.padding),v=Ou(u,g,p,this.padding),x=Ou(l,b,f,this.padding),w=[r,y,v,x,this.filters];"channelsLast"!==this.dataFormat&&(e=c["transpose"](e,[0,2,3,4,1]));let k=c["conv3dTranspose"](e,this.kernel.read(),w,this.strides,this.padding);return"channelsLast"!==this.dataFormat&&(k=c["transpose"](k,[0,4,1,2,3])),null!==this.bias&&(k=Nt(k,this.bias.read(),this.dataFormat)),null!==this.activation&&(k=this.activation.apply(k)),k})}computeOutputShape(t){t=ce(t);const e=t.slice();let n,r,a,i;"channelsFirst"===this.dataFormat?(n=1,r=2,a=3,i=4):(n=4,r=1,a=2,i=3);const o=this.kernelSize[0],s=this.kernelSize[1],u=this.kernelSize[2],c=this.strides[0],l=this.strides[1],d=this.strides[2];return e[n]=this.filters,e[r]=Ou(e[r],c,o,this.padding),e[a]=Ou(e[a],l,s,this.padding),e[i]=Ou(e[i],d,u,this.padding),e}getConfig(){const t=super.getConfig();return delete t["dilationRate"],t}}Fu.className="Conv3DTranspose",c["serialization"].registerClass(Fu);class Mu extends Au{constructor(t,e){if(super(t,e),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,null==e.filters)throw new h("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=e.kernelInitializer||null!=e.kernelRegularizer||null!=e.kernelConstraint)throw new h("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=e.padding&&"same"!==e.padding&&"valid"!==e.padding)throw new h(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received `+JSON.stringify(e.padding));this.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,this.depthwiseInitializer=ie(e.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=mu(e.depthwiseRegularizer),this.depthwiseConstraint=wi(e.depthwiseConstraint),this.pointwiseInitializer=ie(e.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=mu(e.pointwiseRegularizer),this.pointwiseConstraint=wi(e.pointwiseConstraint)}build(t){if(t=ce(t),t.length<this.rank+2)throw new h(`Inputs to SeparableConv${this.rank}D should have rank `+(this.rank+2)+", but received input shape: "+JSON.stringify(t));const e="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[e]||t[e]<0)throw new h("The channel dimension of the inputs should be defined, but found "+JSON.stringify(t[e]));const n=t[e],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[];for(let o=0;o<this.rank;++o)a.push(1);a.push(n*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new ge({ndim:this.rank+2,axes:{[e]:n}})],this.built=!0}call(t,e){return Object(c["tidy"])(()=>{let e;if(t=ue(t),1===this.rank)throw new p("1D separable convolution is not implemented yet.");return 2===this.rank&&("channelsFirst"===this.dataFormat&&(t=c["transpose"](t,[0,2,3,1])),e=c["separableConv2d"](t,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(e=Nt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),"channelsFirst"===this.dataFormat&&(e=c["transpose"](e,[0,3,1,2])),e})}getConfig(){const t=super.getConfig();return delete t["rank"],delete t["kernelInitializer"],delete t["kernelRegularizer"],delete t["kernelConstraint"],t["depthwiseInitializer"]=ae(this.depthwiseInitializer),t["pointwiseInitializer"]=ae(this.pointwiseInitializer),t["depthwiseRegularizer"]=pu(this.depthwiseRegularizer),t["pointwiseRegularizer"]=pu(this.pointwiseRegularizer),t["depthwiseConstraint"]=vi(this.depthwiseConstraint),t["pointwiseConstraint"]=vi(this.pointwiseConstraint),t}}Mu.className="SeparableConv";class Pu extends Mu{constructor(t){super(2,t)}}Pu.className="SeparableConv2D",c["serialization"].registerClass(Pu);class $u extends Au{constructor(t){super(1,t),$u.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){const t=super.getConfig();return delete t["rank"],delete t["dataFormat"],t}static verifyArgs(t){if("number"!==typeof t.kernelSize&&!R(t.kernelSize,"number",1,1))throw new h(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(t.kernelSize)}.`)}}$u.className="Conv1D",c["serialization"].registerClass($u);class Lu extends we{constructor(t){super(t),"number"===typeof t.cropping?this.cropping=[[t.cropping,t.cropping],[t.cropping,t.cropping]]:"number"===typeof t.cropping[0]?this.cropping=[[t.cropping[0],t.cropping[0]],[t.cropping[1],t.cropping[1]]]:this.cropping=t.cropping,this.dataFormat=void 0===t.dataFormat?"channelsLast":t.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(t){return"channelsFirst"===this.dataFormat?[t[0],t[1],t[2]-this.cropping[0][0]-this.cropping[0][1],t[3]-this.cropping[1][0]-this.cropping[1][1]]:[t[0],t[1]-this.cropping[0][0]-this.cropping[0][1],t[2]-this.cropping[1][0]-this.cropping[1][1],t[3]]}call(t,e){return Object(c["tidy"])(()=>{if(t=ue(t),"channelsLast"===this.dataFormat){const e=xt(t,this.cropping[0][0],t.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return xt(e,this.cropping[1][0],t.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}{const e=xt(t,this.cropping[0][0],t.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return xt(e,this.cropping[1][0],t.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const t={cropping:this.cropping,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}Lu.className="Cropping2D",c["serialization"].registerClass(Lu);class Bu extends we{constructor(t){super(t),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=null==t.size?this.DEFAULT_SIZE:t.size,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,q(this.dataFormat),this.interpolation=null==t.interpolation?"nearest":t.interpolation,K(this.interpolation)}computeOutputShape(t){if("channelsFirst"===this.dataFormat){const e=null==t[2]?null:this.size[0]*t[2],n=null==t[3]?null:this.size[1]*t[3];return[t[0],t[1],e,n]}{const e=null==t[1]?null:this.size[0]*t[1],n=null==t[2]?null:this.size[1]*t[2];return[t[0],e,n,t[3]]}}call(t,e){return c["tidy"](()=>{let e=ue(t);const n=e.shape;if("channelsFirst"===this.dataFormat){e=c["transpose"](e,[0,2,3,1]);const t=this.size[0]*n[2],r=this.size[1]*n[3],a="nearest"===this.interpolation?c["image"].resizeNearestNeighbor(e,[t,r]):c["image"].resizeBilinear(e,[t,r]);return c["transpose"](a,[0,3,1,2])}{const t=this.size[0]*n[1],r=this.size[1]*n[2];return"nearest"===this.interpolation?c["image"].resizeNearestNeighbor(e,[t,r]):c["image"].resizeBilinear(e,[t,r])}})}getConfig(){const t={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function zu(t,e,n=[1,1],r="valid",a,i){return Object(c["tidy"])(()=>{null==a&&(a=ht()),q(a);let o=_u(t,a);if(4!==t.rank)throw new h("Input for depthwiseConv2d is required to be 4-D, but is instead "+t.rank+"-D");if(4!==e.rank)throw new h("depthwiseKernel is required to be 4-D, but is instead "+e.rank+"-D");return o=c["depthwiseConv2d"](o,e,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=c["transpose"](o,[0,3,1,2])),o})}Bu.className="UpSampling2D",c["serialization"].registerClass(Bu);class Wu extends Eu{constructor(t){super(2,t),this.depthwiseKernel=null,this.depthMultiplier=null==t.depthMultiplier?1:t.depthMultiplier,this.depthwiseInitializer=ie(t.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=wi(t.depthwiseConstraint),this.depthwiseRegularizer=mu(t.depthwiseRegularizer)}build(t){if(t=ce(t),t.length<4)throw new h(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(t)}.`);const e="channelsFirst"===this.dataFormat?1:3;if(null==t[e]||t[e]<0)throw new h(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${t[e]}).`);const n=t[e],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(c["tidy"])(()=>{t=ue(t);let e=zu(t,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(e=Nt(e,this.bias.read(),this.dataFormat)),null!=this.activation&&(e=this.activation.apply(e)),e})}computeOutputShape(t){t=ce(t);const e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[1]*this.depthMultiplier:t[3]*this.depthMultiplier,a=Su(e,this.kernelSize[0],this.padding,this.strides[0]),i=Su(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[t[0],r,a,i]:[t[0],a,i,r]}getConfig(){const t=super.getConfig();return t["depthMultiplier"]=this.depthMultiplier,t["depthwiseInitializer"]=ae(this.depthwiseInitializer),t["depthwiseRegularizer"]=pu(this.depthwiseRegularizer),t["depthwiseConstraint"]=vi(this.depthwiseRegularizer),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Vu(t,e,n,r){if(Array.isArray(t)){if(null!=e||null!=n)throw new h("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function a(t){return null==t||Array.isArray(t)?t:[t]}return e=a(e),n=a(n),{inputs:t,initialState:e,constants:n}}function Uu(t,e,n,r=!1,a,i,o=!1,s=!1){return c["tidy"](()=>{const u=e.shape.length;if(u<3)throw new h(`Input should be at least 3D, but is ${u}D.`);const l=[1,0].concat(ct(2,u));if(e=c["transpose"](e,l),null!=i)throw new p("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&(a=c["cast"](c["cast"](a,"bool"),"float32"),a.rank===u-1&&(a=c["expandDims"](a,-1)),a=c["transpose"](a,l)),r&&(e=c["reverse"](e,0),null!=a&&(a=c["reverse"](a,0)));const d=[];let f,m=n;const g=e.shape[0],b=c["unstack"](e);let y,v;null!=a&&(y=c["unstack"](a));for(let e=0;e<g;++e){const n=b[e],r=c["tidy"](()=>t(n,m));if(null==a)f=r[0],m=r[1];else{const t=c["tidy"](()=>{const t=y[e],n=c["sub"](c["onesLike"](t),t),a=c["add"](c["mul"](r[0],t),c["mul"](m[0],n)),i=m.map((e,a)=>c["add"](c["mul"](r[1][a],t),c["mul"](e,n)));return{output:a,newStates:i}});f=t.output,m=t.newStates}s&&d.push(f)}if(s){const t=1;v=c["stack"](d,t)}return[f,v,m]})}Wu.className="DepthwiseConv2D",c["serialization"].registerClass(Wu);class Gu extends we{constructor(t){let e;if(super(t),null==t.cell)throw new h("cell property is missing for the constructor of RNN.");if(e=Array.isArray(t.cell)?new Qu({cells:t.cell}):t.cell,null==e.stateSize)throw new h("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=e,this.returnSequences=null!=t.returnSequences&&t.returnSequences,this.returnState=null!=t.returnState&&t.returnState,this.goBackwards=null!=t.goBackwards&&t.goBackwards,this._stateful=null!=t.stateful&&t.stateful,this.unroll=null!=t.unroll&&t.unroll,this.supportsMasking=!0,this.inputSpec=[new ge({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ct(0,t).map(t=>null)}return this.states_}setStates(t){this.states_=t}computeOutputShape(t){oe(t)&&(t=t[0]),t=t;let e=this.cell.stateSize;Array.isArray(e)||(e=[e]);const n=e[0];let r;if(r=this.returnSequences?[t[0],t[1],n]:[t[0],n],this.returnState){const n=[];for(const r of e)n.push([t[0],r]);return[r].concat(n)}return r}computeMask(t,e){return c["tidy"](()=>{Array.isArray(e)&&(e=e[0]);const t=this.returnSequences?e:null;if(this.returnState){const e=this.states.map(t=>null);return[t].concat(e)}return t})}get states(){if(null==this.states_){const t=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,e=[];for(let n=0;n<t;++n)e.push(null);return e}return this.states_}set states(t){this.states_=t}build(t){const e=null;if(null!=this.numConstants)throw new p("Constants support is not implemented in RNN yet.");oe(t)&&(t=t[0]),t=t;const n=this.stateful?t[0]:null,r=t.slice(2);this.inputSpec[0]=new ge({shape:[n,null,...r]});const a=[t[0]].concat(t.slice(2));if(null!=e)throw new p("Constants support is not implemented in RNN yet.");let i;if(this.cell.build(a),i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!c["util"].arraysEqual(this.stateSpec.map(t=>t.shape[t.shape.length-1]),i))throw new h(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is `+this.cell.stateSize)}else this.stateSpec=i.map(t=>new ge({shape:[null,t]}));this.stateful&&this.resetStates()}resetStates(t,e=!1){Object(c["tidy"])(()=>{if(!this.stateful)throw new l("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape[0];if(null==n)throw new h("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.states_)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>c["zeros"]([n,t])):this.states_=[c["zeros"]([n,this.cell.stateSize])];else if(null==t)c["dispose"](this.states_),null!=this.keptStates&&(c["dispose"](this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(t=>c["zeros"]([n,t])):this.states_[0]=c["zeros"]([n,this.cell.stateSize]);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new h(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);!0===e?this.keptStates.push(this.states_.slice()):c["dispose"](this.states_);for(let e=0;e<this.states_.length;++e){const r=t[e],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[e]:this.cell.stateSize,i=[n,a];if(!c["util"].arraysEqual(r.shape,i))throw new h(`State ${e} is incompatible with layer ${this.name}: expected shape=${i}, received shape=${r.shape}`);this.states_[e]=r}}this.states_=this.states_.map(t=>c["keep"](t.clone()))})}apply(t,e){let n=null==e?null:e["initialState"],r=null==e?null:e["constants"];null==e&&(e={});const a=Vu(t,n,r,this.numConstants);t=a.inputs,n=a.initialState,r=a.constants;let i=[],o=[];if(null!=n){e["initialState"]=n,i=i.concat(n),this.stateSpec=[];for(const t of n)this.stateSpec.push(new ge({shape:t.shape}));o=o.concat(this.stateSpec)}null!=r&&(e["constants"]=r,i=i.concat(r),this.numConstants=r.length);const s=i[0]instanceof be;if(s){const n=[t].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=a,s}return super.apply(t,e)}call(t,e){return Object(c["tidy"])(()=>{const n=null==e?null:e["mask"],r=null==e?null:e["training"];let a=null==e?null:e["initialState"];t=ue(t),null==a&&(a=this.stateful?this.states_:this.getInitialState(t));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new h(`RNN Layer has ${i} state(s) but was passed `+a.length+" initial state(s).");this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:r},s=(t,e)=>{const n=this.cell.call([t].concat(e),o);return[n[0],n.slice(1)]},u=Uu(s,t,a,this.goBackwards,n,null,this.unroll,this.returnSequences),c=u[0],l=u[1],d=u[2];this.stateful&&this.resetStates(d,r);const p=this.returnSequences?l:c;return this.returnState?[p].concat(d):p})}getInitialState(t){return Object(c["tidy"])(()=>{let e=c["zeros"](t.shape);return e=c["sum"](e,[1,2]),e=ft(e),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(t=>t>1?St(e,[1,t]):e):this.cell.stateSize>1?[St(e,[1,this.cell.stateSize])]:[e]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(t)}getConfig(){const t=super.getConfig(),e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e["numConstants"]=this.numConstants);const n=this.cell.getConfig();return this.getClassName()===Gu.className&&(e["cell"]={className:this.cell.getClassName(),config:n}),Object.assign({},n,t,e)}static fromConfig(t,e,n={}){const r=e["cell"],a=Qi(r,n);return new t(Object.assign(e,{cell:a}))}}Gu.className="RNN",c["serialization"].registerClass(Gu);class Hu extends we{}class qu extends Hu{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,j(this.units,"units"),this.activation=ou(null==t.activation?this.DEFAULT_ACTIVATION:t.activation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ie(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ie(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ie(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=mu(t.kernelRegularizer),this.recurrentRegularizer=mu(t.recurrentRegularizer),this.biasRegularizer=mu(t.biasRegularizer),this.kernelConstraint=wi(t.kernelConstraint),this.recurrentConstraint=wi(t.recurrentConstraint),this.biasConstraint=wi(t.biasConstraint),this.dropout=st([1,ut([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=st([1,ut([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=ce(t),this.kernel=this.addWeight("kernel",[t[t.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(c["tidy"])(()=>{if(t=t,2!==t.length)throw new h(`SimpleRNNCell expects 2 input Tensors, got ${t.length}.`);let n=t[1];t=t[0];const r=null!=e["training"]&&e["training"];let a;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=tc({ones:()=>c["onesLike"](t),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=tc({ones:()=>c["onesLike"](n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;a=_t(null!=i?c["mul"](t,i):t,this.kernel.read()),null!=this.bias&&(a=Nt(a,this.bias.read())),null!=o&&(n=c["mul"](n,o));let s=c["add"](a,_t(n,this.recurrentKernel.read()));return null!=this.activation&&(s=this.activation.apply(s)),[s,s]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:au(this.activation),useBias:this.useBias,kernelInitializer:ae(this.kernelInitializer),recurrentInitializer:ae(this.recurrentInitializer),biasInitializer:ae(this.biasInitializer),kernelRegularizer:pu(this.kernelRegularizer),recurrentRegularizer:pu(this.recurrentRegularizer),biasRegularizer:pu(this.biasRegularizer),activityRegularizer:pu(this.activityRegularizer),kernelConstraint:vi(this.kernelConstraint),recurrentConstraint:vi(this.recurrentConstraint),biasConstraint:vi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},t,e)}}qu.className="SimpleRNNCell",c["serialization"].registerClass(qu);class Ku extends Gu{constructor(t){t.cell=new qu(t),super(t)}call(t,e){return Object(c["tidy"])(()=>{null!=this.cell.dropoutMask&&(c["dispose"](this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(c["dispose"](this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],a=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return new t(e)}}Ku.className="SimpleRNN",c["serialization"].registerClass(Ku);class Xu extends Hu{constructor(t){if(super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",t.resetAfter)throw new h("GRUCell does not support reset_after parameter set to true.");this.units=t.units,j(this.units,"units"),this.activation=ou(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=ou(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ie(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ie(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ie(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=mu(t.kernelRegularizer),this.recurrentRegularizer=mu(t.recurrentRegularizer),this.biasRegularizer=mu(t.biasRegularizer),this.kernelConstraint=wi(t.kernelConstraint),this.recurrentConstraint=wi(t.recurrentConstraint),this.biasConstraint=wi(t.biasConstraint),this.dropout=st([1,ut([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=st([1,ut([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){t=ce(t);const e=t[t.length-1];this.kernel=this.addWeight("kernel",[e,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(t,e){return Object(c["tidy"])(()=>{if(t=t,2!==t.length)throw new h("GRUCell expects 2 input Tensors (inputs, h, c), got "+t.length+".");const n=null!=e["training"]&&e["training"];let r=t[1];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=tc({ones:()=>c["onesLike"](t),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=tc({ones:()=>c["onesLike"](r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let o,s,u;0<this.dropout&&this.dropout<1&&(t=c["mul"](t,a[0]));let l=_t(t,this.kernel.read());this.useBias&&(l=Nt(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=c["mul"](r,i[0]));const d=this.recurrentKernel.read(),[p,f]=c["split"](d,[2*this.units,this.units],d.rank-1),m=_t(r,p),[g,b,y]=c["split"](l,3,l.rank-1),[v,x]=c["split"](m,2,m.rank-1);o=this.recurrentActivation.apply(c["add"](g,v)),s=this.recurrentActivation.apply(c["add"](b,x));const w=_t(c["mul"](s,r),f);u=this.activation.apply(c["add"](y,w));const k=c["add"](c["mul"](o,r),c["mul"](c["add"](1,c["neg"](o)),u));return[k,k]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:au(this.activation),recurrentActivation:au(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ae(this.kernelInitializer),recurrentInitializer:ae(this.recurrentInitializer),biasInitializer:ae(this.biasInitializer),kernelRegularizer:pu(this.kernelRegularizer),recurrentRegularizer:pu(this.recurrentRegularizer),biasRegularizer:pu(this.biasRegularizer),activityRegularizer:pu(this.activityRegularizer),kernelConstraint:vi(this.kernelConstraint),recurrentConstraint:vi(this.recurrentConstraint),biasConstraint:vi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},t,e)}}Xu.className="GRUCell",c["serialization"].registerClass(Xu);class Yu extends Gu{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Xu(t),super(t)}call(t,e){return Object(c["tidy"])(()=>{null!=this.cell.dropoutMask&&(c["dispose"](this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(c["dispose"](this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],a=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return 0===e["implmentation"]&&(e["implementation"]=1),new t(e)}}Yu.className="GRU",c["serialization"].registerClass(Yu);class Ju extends Hu{constructor(t){super(t),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=t.units,j(this.units,"units"),this.activation=ou(void 0===t.activation?this.DEFAULT_ACTIVATION:t.activation),this.recurrentActivation=ou(void 0===t.recurrentActivation?this.DEFAULT_RECURRENT_ACTIVATION:t.recurrentActivation),this.useBias=null==t.useBias||t.useBias,this.kernelInitializer=ie(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ie(t.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ie(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=t.unitForgetBias,this.kernelRegularizer=mu(t.kernelRegularizer),this.recurrentRegularizer=mu(t.recurrentRegularizer),this.biasRegularizer=mu(t.biasRegularizer),this.kernelConstraint=wi(t.kernelConstraint),this.recurrentConstraint=wi(t.recurrentConstraint),this.biasConstraint=wi(t.biasConstraint),this.dropout=st([1,ut([0,null==t.dropout?0:t.dropout])]),this.recurrentDropout=st([1,ut([0,null==t.recurrentDropout?0:t.recurrentDropout])]),this.dropoutFunc=t.dropoutFunc,this.implementation=t.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(t){var e;t=ce(t);const n=t[t.length-1];let r;if(this.kernel=this.addWeight("kernel",[n,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){const t=this.biasInitializer,n=this.units;r=new(e=class extends Lt{apply(e,r){const a=t.apply([n]),i=(new zt).apply([n]),o=t.apply([2*n]);return kt(kt(a,i),o)}},e.className="CustomInit",e)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(t,e){return Object(c["tidy"])(()=>{const n=null!=e["training"]&&e["training"];if(t=t,3!==t.length)throw new h("LSTMCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");let r=t[1];const a=t[2];t=t[0],0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=tc({ones:()=>c["onesLike"](t),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=tc({ones:()=>c["onesLike"](r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,o=this.recurrentDropoutMask;let s,u,l,d;0<this.dropout&&this.dropout<1&&(t=c["mul"](t,i[0]));let p=_t(t,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=c["mul"](r,o[0])),p=c["add"](p,_t(r,this.recurrentKernel.read())),this.useBias&&(p=Nt(p,this.bias.read()));const[f,m,g,b]=c["split"](p,4,p.rank-1);s=this.recurrentActivation.apply(f),u=this.recurrentActivation.apply(m),l=c["add"](c["mul"](u,a),c["mul"](s,this.activation.apply(g))),d=this.recurrentActivation.apply(b);const y=c["mul"](d,this.activation.apply(l));return[y,y,l]})}getConfig(){const t=super.getConfig(),e={units:this.units,activation:au(this.activation),recurrentActivation:au(this.recurrentActivation),useBias:this.useBias,kernelInitializer:ae(this.kernelInitializer),recurrentInitializer:ae(this.recurrentInitializer),biasInitializer:ae(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:pu(this.kernelRegularizer),recurrentRegularizer:pu(this.recurrentRegularizer),biasRegularizer:pu(this.biasRegularizer),activityRegularizer:pu(this.activityRegularizer),kernelConstraint:vi(this.kernelConstraint),recurrentConstraint:vi(this.recurrentConstraint),biasConstraint:vi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},t,e)}}Ju.className="LSTMCell",c["serialization"].registerClass(Ju);class Zu extends Gu{constructor(t){0===t.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),t.cell=new Ju(t),super(t)}call(t,e){return Object(c["tidy"])(()=>{null!=this.cell.dropoutMask&&(c["dispose"](this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(c["dispose"](this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const n=null==e?null:e["mask"],r=null==e?null:e["training"],a=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:a})})}static fromConfig(t,e){return 0===e["implmentation"]&&(e["implementation"]=1),new t(e)}}Zu.className="LSTM",c["serialization"].registerClass(Zu);class Qu extends Hu{constructor(t){super(t),this.cells=t.cells}get stateSize(){const t=[];for(const e of this.cells.slice().reverse())Array.isArray(e.stateSize)?t.push(...e.stateSize):t.push(e.stateSize);return t}call(t,e){return Object(c["tidy"])(()=>{t=t;let n=t.slice(1);const r=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?r.push(n.splice(0,t.stateSize.length)):r.push(n.splice(0,1));r.reverse();const a=[];let i;for(let o=0;o<this.cells.length;++o){const s=this.cells[o];n=r[o],i=0===o?[t[0]].concat(n):[i[0]].concat(n),i=s.call(i,e),a.push(i.slice(1))}n=[];for(const t of a.slice().reverse())n.push(...t);return[i[0]].concat(n)})}build(t){let e;oe(t)&&(t=t[0]),t=t,this.cells.forEach((n,r)=>{Q("RNNCell_"+r,()=>{n.build(t),e=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,t=[t[0],e]})}),this.built=!0}getConfig(){const t=super.getConfig(),e=t=>({className:t.getClassName(),config:t.getConfig()}),n=this.cells.map(e),r={cells:n};return Object.assign({},t,r)}static fromConfig(t,e,n={}){const r=[];for(const a of e["cells"])r.push(Qi(a,n));return new t({cells:r})}get trainableWeights(){if(!this.trainable)return[];const t=[];for(const e of this.cells)t.push(...e.trainableWeights);return t}get nonTrainableWeights(){const t=[];for(const e of this.cells)t.push(...e.nonTrainableWeights);if(!this.trainable){const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e.concat(t)}return t}getWeights(){const t=[];for(const e of this.cells)t.push(...e.weights);return fe(t)}setWeights(t){const e=[];for(const n of this.cells){const r=n.weights.length,a=t.splice(r);for(let t=0;t<n.weights.length;++t)e.push([n.weights[t],a[t]])}me(e)}}function tc(t){const{ones:e,rate:n,training:r=!1,count:a=1,dropoutFunc:i}=t,o=()=>null!=i?i(e(),n):Rt(e(),n),s=()=>Dt(o,e,r);if(!a||a<=1)return c["keep"](s().clone());const u=Array(a).fill(void 0).map(s);return u.map(t=>c["keep"](t.clone()))}
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */Qu.className="StackedRNNCells",c["serialization"].registerClass(Qu);var ec=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]])}return n};class nc extends Gu{constructor(t){if(t.unroll)throw new p("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(t.cell))throw new p("It is not possible at the moment to stack convolutional cells.");super(t),this.inputSpec=[new ge({ndim:5})]}call(t,e){return c["tidy"](()=>{if(null!=this.cell.dropoutMask&&(c["dispose"](this.cell.dropoutMask),this.cell.dropoutMask=null),null!=this.cell.recurrentDropoutMask&&(c["dispose"](this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),e&&e["constants"])throw new h("ConvRNN2D cell does not support constants");const n=null==e?null:e["mask"],r=null==e?null:e["training"],a=null==e?null:e["initialState"];return super.call(t,{mask:n,training:r,initialState:a})})}computeOutputShape(t){let e=this.computeSingleOutputShape(t);return this.returnSequences||(e=[e[0],...e.slice(2)]),this.returnState&&(e=[e,...Array(2).fill([t[0],...e.slice(-3)])]),e}getInitialState(t){return c["tidy"](()=>{const{stateSize:e}=this.cell,n=t.shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)],i=c["zeros"](a);return Array.isArray(e)?Array(e.length).fill(i):[i]})}resetStates(t,e=!1){c["tidy"](()=>{if(!this.stateful)throw new l("Cannot call resetStates() on an RNN Layer that is not stateful.");const n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),a=[r[0],...r.slice(2)],i=n[0];if(null==i)throw new h("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==this.getStates())Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>c["zeros"](a)):this.states_=[c["zeros"](a)];else if(null==t)c["dispose"](this.states_),null!=this.keptStates&&(c["dispose"](this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>c["zeros"](a)):this.states_[0]=c["zeros"](a);else{if(Array.isArray(t)||(t=[t]),t.length!==this.states_.length)throw new h(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${t.length} state value(s). Input received: `+t);e?this.keptStates.push(this.states_.slice()):c["dispose"](this.states_);for(let e=0;e<this.states_.length;++e){const n=t[e],r=a;if(!c["util"].arraysEqual(n.shape,r))throw new h(`State ${e} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[e]=n}}this.states_=this.states_.map(t=>c["keep"](t.clone()))})}computeSingleOutputShape(t){const{dataFormat:e,filters:n,kernelSize:r,padding:a,strides:i,dilationRate:o}=this.cell,s="channelsFirst"===e,u=t[s?3:2],c=t[s?4:3],l=Su(u,r[0],a,i[0],o[0]),d=Su(c,r[1],a,i[1],o[1]),h=[...t.slice(0,2),...s?[n,l,d]:[l,d,n]];return h}}nc.className="ConvRNN2D";class rc extends Ju{constructor(t){const{filters:e,kernelSize:n,strides:r,padding:a,dataFormat:i,dilationRate:o}=t;super(Object.assign({},t,{units:e})),this.filters=e,j(this.filters,"filters"),this.kernelSize=ku(n,2,"kernelSize"),this.kernelSize.forEach(t=>j(t,"kernelSize")),this.strides=ku(r||1,2,"strides"),this.strides.forEach(t=>j(t,"strides")),this.padding=a||"valid",X(this.padding),this.dataFormat=i||"channelsLast",q(this.dataFormat),this.dilationRate=ku(o||1,2,"dilationRate"),this.dilationRate.forEach(t=>j(t,"dilationRate"))}build(t){var e;t=ce(t);const n="channelsFirst"===this.dataFormat?1:t.length-1;if(null==t[n])throw new h("The channel dimension of the input should be defined. Found "+t[n]);const r=t[n],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let t;if(this.unitForgetBias){const n=this.biasInitializer,r=this.filters;t=new(e=class extends Lt{apply(t,e){const a=n.apply([r]),i=c["ones"]([r]),o=n.apply([2*r]);return wt([a,i,o])}},e.className="CustomInit",e)}else t=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,t,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(t,e){return c["tidy"](()=>{if(3!==t.length)throw new h("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+t.length+".");const n=e["training"]||!1,r=t[0],a=t[1],i=t[2],o=4;0<this.dropout&&this.dropout<1&&null==this.dropoutMask&&(this.dropoutMask=tc({ones:()=>c["onesLike"](r),rate:this.dropout,training:n,count:o,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,u=(t,e,n)=>e&&e[n]?c["mul"](e[n],t):t;let l=u(r,s,0),d=u(r,s,1),p=u(r,s,2),f=u(r,s,3);0<this.recurrentDropout&&this.recurrentDropout<1&&null==this.recurrentDropoutMask&&(this.recurrentDropoutMask=tc({ones:()=>c["onesLike"](a),rate:this.recurrentDropout,training:n,count:o,dropoutFunc:this.dropoutFunc}));const m=this.recurrentDropoutMask;let g=u(a,m,0),b=u(a,m,1),y=u(a,m,2),v=u(a,m,3);const x=3,[w,k,S,O]=c["split"](this.kernel.read(),o,x),[_,C,T,I]=this.useBias?c["split"](this.bias.read(),o):[null,null,null,null];l=this.inputConv(l,w,_,this.padding),d=this.inputConv(d,k,C,this.padding),p=this.inputConv(p,S,T,this.padding),f=this.inputConv(f,O,I,this.padding);const[N,E,A,R]=c["split"](this.recurrentKernel.read(),o,x);g=this.recurrentConv(g,N),b=this.recurrentConv(b,E),y=this.recurrentConv(y,A),v=this.recurrentConv(v,R);const j=this.recurrentActivation.apply(c["add"](l,g)),D=this.recurrentActivation.apply(c["add"](d,b)),F=c["add"](c["mul"](D,i),c["mul"](j,this.activation.apply(c["add"](p,y)))),M=c["mul"](this.recurrentActivation.apply(c["add"](f,v)),this.activation.apply(F));return[M,M,F]})}getConfig(){const t=super.getConfig(),{units:e}=t,n=ec(t,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},n,r)}inputConv(t,e,n,r){const a=c["conv2d"](t,e,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Nt(a,n,this.dataFormat):a}recurrentConv(t,e){const n=1;return c["conv2d"](t,e,n,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}rc.className="ConvLSTM2DCell",c["serialization"].registerClass(rc);class ac extends nc{constructor(t){const e=new rc(t);super(Object.assign({},t,{cell:e}))}static fromConfig(t,e){return new t(e)}}ac.className="ConvLSTM2D",c["serialization"].registerClass(ac);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class ic extends we{constructor(t){super(t),this.rate=Math.max(Math.min(t.rate,1),0),this.noiseShape=t.noiseShape,this.seed=t.seed,this.supportsMasking=!0}getNoiseShape(t){if(null==this.noiseShape)return this.noiseShape;const e=t.shape,n=[];for(let r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?e[r]:this.noiseShape[r]);return n}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t);if(0<this.rate&&this.rate<1){const t=null!=e["training"]&&e["training"],r=this.getNoiseShape(n),a=Dt(()=>Rt(n,this.rate,r,this.seed),()=>n,t);return a}return t})}getConfig(){const t={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},e=super.getConfig();return Object.assign(t,e),t}dispose(){return super.dispose()}}ic.className="Dropout",c["serialization"].registerClass(ic);class oc extends ic{constructor(t){super(t),this.inputSpec=[{ndim:3}]}getNoiseShape(t){const e=t.shape;return[e[0],1,e[2]]}}oc.className="SpatialDropout1D",c["serialization"].registerClass(oc);class sc extends we{constructor(t){if(super(t),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",null==t.batchInputShape&&null==t.inputShape&&null!=t.inputDim){let e=null;null!=t.batchSize&&(e=t.batchSize),this.batchInputShape=[e,t.inputDim]}this.units=t.units,j(this.units,"units"),this.activation=ou(t.activation),null!=t.useBias&&(this.useBias=t.useBias),this.kernelInitializer=ie(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ie(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=wi(t.kernelConstraint),this.biasConstraint=wi(t.biasConstraint),this.kernelRegularizer=mu(t.kernelRegularizer),this.biasRegularizer=mu(t.biasRegularizer),this.activityRegularizer=mu(t.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(t){t=ce(t);const e=t[t.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[e,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:e}}],this.built=!0}computeOutputShape(t){t=ce(t);const e=t.slice();return e[e.length-1]=this.units,e}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t),r=M(this.activation.getClassName());let a;return null!=r?a=_t(n,this.kernel.read(),r,this.bias?this.bias.read():null):(a=_t(n,this.kernel.read()),null!=this.bias&&(a=Nt(a,this.bias.read())),null!=this.activation&&(a=this.activation.apply(a))),a})}getConfig(){const t={units:this.units,activation:au(this.activation),useBias:this.useBias,kernelInitializer:ae(this.kernelInitializer),biasInitializer:ae(this.biasInitializer),kernelRegularizer:pu(this.kernelRegularizer),biasRegularizer:pu(this.biasRegularizer),activityRegularizer:pu(this.activityRegularizer),kernelConstraint:vi(this.kernelConstraint),biasConstraint:vi(this.biasConstraint)},e=super.getConfig();return Object.assign(t,e),t}}sc.className="Dense",c["serialization"].registerClass(sc);class uc extends we{constructor(t){t=t||{},super(t),this.inputSpec=[{minNDim:3}],this.dataFormat=t.dataFormat}computeOutputShape(t){t=ce(t);for(const e of t.slice(1))if(null==e)throw new h(`The shape of the input to "Flatten" is not fully defined (got ${t.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[t[0],ot(t,1)]}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);let n=ue(t);if("channelsFirst"===this.dataFormat&&n.rank>1){const t=[0];for(let e=2;e<n.rank;++e)t.push(e);t.push(1),n=Object(c["transpose"])(n,t)}return bt(n)})}getConfig(){const t={};null!=this.dataFormat&&(t["dataFormat"]=this.dataFormat);const e=super.getConfig();return Object.assign(t,e),t}}uc.className="Flatten",c["serialization"].registerClass(uc);class cc extends we{constructor(t){super(t),this.supportsMasking=!0,this.activation=ou(t.activation)}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t);return this.activation.apply(n)})}getConfig(){const t={activation:au(this.activation)},e=super.getConfig();return Object.assign(t,e),t}}cc.className="Activation",c["serialization"].registerClass(cc);class lc extends we{constructor(t){super(t),this.n=t.n,this.inputSpec=[{ndim:2}]}computeOutputShape(t){return[t[0],this.n,t[1]]}call(t,e){return Object(c["tidy"])(()=>(t=ue(t),mt(t,this.n)))}getConfig(){const t={n:this.n},e=super.getConfig();return Object.assign(t,e),t}}lc.className="RepeatVector",c["serialization"].registerClass(lc);class dc extends we{constructor(t){super(t),this.targetShape=t.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(t){return t<0||null==t}fixUnknownDimension(t,e){const n="Total size of new array must be unchanged.",r=e.slice();let a=1,i=null;for(let s=0;s<r.length;++s){const t=r[s];if(this.isUnknown(t)){if(null!==i)throw new h("Can only specifiy one unknown dimension.");i=s}else a*=t}const o=ot(t);if(null!==i){if(0===a||o%a!==0)throw new h(n);r[i]=o/a}else if(o!==a)throw new h(n);return r}computeOutputShape(t){let e=!1;for(let n=0;n<t.length;++n)if(this.isUnknown(t[n])){e=!0;break}return e?t.slice(0,1).concat(this.targetShape):t.slice(0,1).concat(this.fixUnknownDimension(t.slice(1),this.targetShape))}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t),r=n.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Object(c["reshape"])(n,a)})}getConfig(){const t={targetShape:this.targetShape},e=super.getConfig();return Object.assign(t,e),t}}dc.className="Reshape",c["serialization"].registerClass(dc);class hc extends we{constructor(t){if(super(t),null==t.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(t.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+t.dims+" instead.");const e=ct(1,t.dims.length+1);if(!c["util"].arraysEqual(t.dims.slice().sort(),e))throw new Error("Invalid permutation `dims`: "+JSON.stringify(t.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=t.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new ge({ndim:this.dims.length+1})]}computeOutputShape(t){t=ce(t);const e=t.slice();return this.dims.forEach((n,r)=>{e[r+1]=t[n]}),e}call(t,e){return Object(c["transpose"])(ue(t),this.dimsIncludingBatch)}getConfig(){const t={dims:this.dims},e=super.getConfig();return Object.assign(t,e),t}}hc.className="Permute",c["serialization"].registerClass(hc);class pc extends we{constructor(t){super(null==t?{}:t),this.supportsMasking=!0,this.maskValue=null!=t?null==t.maskValue?0:t.maskValue:0}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={maskValue:this.maskValue};return Object.assign(e,t),e}computeMask(t,e){const n=ue(t),r=-1;return Object(c["any"])(Object(c["notEqual"])(n,this.maskValue),r)}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t),r=-1,a=!0,i=Object(c["any"])(Object(c["notEqual"])(n,this.maskValue),r,a),o=Object(c["mul"])(n,Object(c["cast"])(i,n.dtype));return o})}}pc.className="Masking",c["serialization"].registerClass(pc);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class fc extends we{constructor(t){if(super(t),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==t.batchInputShape&&null==t.inputShape){let e=null;null!=t.batchSize&&(e=t.batchSize),null==t.inputLength?this.batchInputShape=[e,null]:this.batchInputShape=[e].concat(x(t.inputLength))}this.inputDim=t.inputDim,j(this.inputDim,"inputDim"),this.outputDim=t.outputDim,j(this.outputDim,"outputDim"),this.embeddingsInitializer=ie(t.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=mu(t.embeddingsRegularizer),this.activityRegularizer=mu(t.activityRegularizer),this.embeddingsConstraint=wi(t.embeddingsConstraint),this.maskZero=t.maskZero,this.supportsMasking=t.maskZero,this.inputLength=t.inputLength}build(t){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(t){}computeMask(t,e){return Object(c["tidy"])(()=>this.maskZero?(t=ue(t),Object(c["notEqual"])(t,Object(c["zerosLike"])(t))):null)}computeOutputShape(t){if(t=ce(t),null==this.inputLength)return[...t,this.outputDim];const e=x(this.inputLength);if(e.length!==t.length-1)throw new h(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);{let n=0;for(let r=0;r<e.length;++r){const a=e[r],i=t[r+1];if(null!=a&&null!=i&&a!==i)throw new h(`"inputLength" is ${this.inputLength}, but received input shape has shape `+t);null==a&&(e[n]=i),n++}}return[t[0],...e,this.outputDim]}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);let n=ue(t);"int32"!==n.dtype&&(n=pt(n,"int32"));const r=Ct(this.embeddings.read(),Object(c["reshape"])(n,[n.size]));return Object(c["reshape"])(r,ce(this.computeOutputShape(n.shape)))})}getConfig(){const t={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:ae(this.embeddingsInitializer),embeddingsRegularizer:pu(this.embeddingsRegularizer),activityRegularizer:pu(this.activityRegularizer),embeddingsConstraint:vi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},e=super.getConfig();return Object.assign(t,e),t}}fc.className="Embedding",c["serialization"].registerClass(fc);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class mc extends we{constructor(t){super(t||{}),this.supportsMasking=!0}mergeFunction(t){throw new p}computeElementwiseOpOutputShape(t,e){if(null==t||null==e)return null;if(t.length<e.length)return this.computeElementwiseOpOutputShape(e,t);if(0===e.length)return t;const n=t.slice(0,t.length-e.length);for(let r=0;r<e.length;++r){const a=t[t.length-e.length+r],i=e[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new h("Operands could not be broadcast together with shapes "+JSON.stringify(t)+" "+JSON.stringify(e));n.push(a)}}return n}build(t){if(Array.isArray(t)&&!Array.isArray(t[0])&&(t=[ce(t)]),t=t,t.length<2)throw new h(`A merge layer should be called on an Array of at least 2 inputs. Got ${t.length} input(s).`);let e=[];for(const a of t)null!=a&&null!==a[0]&&e.push(a[0]);if(e=N(e),e.length>1)throw new h(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(t)}.`);let n=null==t[0]?null:t[0].slice(1);for(let a=1;a<t.length;++a){const e=null==t[a]?null:t[a].slice(1);n=this.computeElementwiseOpOutputShape(n,e)}const r=t.map(t=>t.length);-1===t.indexOf(null)&&1===N(r).length?this.reshapeRequired=!1:this.reshapeRequired=!0}call(t,e){return Object(c["tidy"])(()=>{if(t=t,this.reshapeRequired){const e=[],n=t.map(t=>t.rank);if(-1===n.indexOf(null)){const r=ut(n);for(let n of t){const t=n.rank;for(let e=0;e<r-t;++e)n=ft(n,1);e.push(n)}return this.mergeFunction(e)}{let n=!1;for(const i of t){const t=i.rank;if(null==t){const t=i.shape,r=t[0],a=t.slice(1).concat([r]);let o=c["reshape"](i,[r].concat(ot(t.slice(1))));o=c["transpose"](o,[1,0]),o=c["reshape"](o,a),e.push(o),n=!0}else if(t>1){const r=ct(1,t).concat([0]);e.push(c["transpose"](i,r)),n=!0}else e.push(i)}let r=this.mergeFunction(e);const a=r.rank;if(n)if(null==a){const t=r.shape,e=t.length,n=t[e-1],a=[n].concat(t.slice(0,t.length-1));r=c["reshape"](c["transpose"](c["reshape"](r,[-1,n]),[1,0]),a)}else if(a>1){const t=[a-1].concat(ct(0,a-1));r=c["transpose"](r,t)}return r}}return this.mergeFunction(t)})}computeOutputShape(t){let e;t=t,e=null==t[0]?null:t[0].slice(1);for(let r=1;r<t.length;++r){const n=null==t[r]?null:t[r].slice(1);e=this.computeElementwiseOpOutputShape(e,n)}let n=[];for(const r of t)null!=r&&null!==r[0]&&n.push(r[0]);return n=N(n),e=1===n.length?n.concat(e):[null].concat(e),e}computeMask(t,e){return c["tidy"](()=>{if(null==e)return null;if(!Array.isArray(e))throw new h("`mask` should be an Array");if(!Array.isArray(t))throw new h("`inputs` should be an Array");if(e.length!==t.length)throw new h(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${t.length} vs ${e.length})`);if(e.every(t=>null==t))return null;e=e.map(t=>null==t?t:c["expandDims"](t,0));let n=e[0];for(let t=1;t<e.length-1;++t)n=c["logicalAnd"](n,e[t]);return n})}}class gc extends mc{constructor(t){super(t)}mergeFunction(t){return Object(c["tidy"])(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=c["add"](e,t[n]);return e})}}gc.className="Add",c["serialization"].registerClass(gc);class bc extends mc{constructor(t){super(t)}mergeFunction(t){return Object(c["tidy"])(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=c["mul"](e,t[n]);return e})}}bc.className="Multiply",c["serialization"].registerClass(bc);class yc extends mc{constructor(t){super(t)}mergeFunction(t){return Object(c["tidy"])(()=>{let e=t[0].clone();for(let n=1;n<t.length;++n)e=c["add"](e,t[n]);return c["mul"](1/t.length,e)})}}yc.className="Average",c["serialization"].registerClass(yc);class vc extends mc{constructor(t){super(t)}mergeFunction(t){return Object(c["tidy"])(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=c["maximum"](e,t[n]);return e})}}vc.className="Maximum",c["serialization"].registerClass(vc);class xc extends mc{constructor(t){super(t)}mergeFunction(t){return Object(c["tidy"])(()=>{let e=t[0];for(let n=1;n<t.length;++n)e=c["minimum"](e,t[n]);return e})}}xc.className="Minimum",c["serialization"].registerClass(xc);class wc extends mc{constructor(t){super(t),this.DEFAULT_AXIS=-1,null==t&&(t={}),this.axis=null==t.axis?this.DEFAULT_AXIS:t.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){if(!Array.isArray(t)||!Array.isArray(t[0])||1===t.length)throw new h("A `Concatenate` layer should be called on a list of at least 2 inputs");t=t;let e=!0;for(const r of t)if(null!=r){e=!1;break}if(e)return;const n=[];for(let r=0;r<t.length;++r){const e=t[r].slice();e.splice(this.axis,1);let a=!1;for(const t of n)if(c["util"].arraysEqual(t,e)){a=!0;break}a||n.push(e)}if(n.length>1)throw new h("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(t))}mergeFunction(t){return Object(c["tidy"])(()=>wt(t,this.axis))}computeOutputShape(t){if(!Array.isArray(t)||!Array.isArray(t[0]))throw new h("A `Concatenate` layer should be called on a list of inputs.");const e=t,n=e[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(const a of e.slice(1)){if(null==n[r]||null==a[r]){n[r]=null;break}n[r]+=a[r]}return n}computeMask(t,e){if(null==e)return null;if(!Array.isArray(e))throw new h("`mask` should be an array for Concatenate");if(!Array.isArray(t))throw new h("`inputs` should be an array for Concatenate");if(e.length!==t.length)throw new h(`Mismatch in the length of mask (${e.length}) and the legnth of inputs (${t.length})`);return c["tidy"](()=>{let n=!0;if(e.forEach(t=>{null==t||(n=!1)}),n)return null;const r=[];for(let i=0;i<t.length;++i)null==e[i]?r.push(c["cast"](c["onesLike"](t[i]),"bool")):e[i].rank<t[i].rank?r.push(c["expandDims"](e[i],-1)):r.push(e[i]);const a=c["concat"](r,this.axis);return c["all"](a,-1,!1)})}getConfig(){const t={axis:this.axis},e=super.getConfig();return Object.assign(t,e),t}}function kc(t,e){while(t<0)t+=e;return t}function Sc(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new p("batchDot is not implemented for tensors of 4D or higher rank yet");if(c["util"].assert(t.shape.length>=2,()=>"batchDot requires the rank of x to be >= 2, but got "+t.shape.length),c["util"].assert(t.shape.length>=2,()=>"batchDot requires the rank of y to be >= 2, but got "+e.shape.length),"number"===typeof n&&(n=[n,n]),"complex64"===t.dtype||"complex64"===e.dtype)throw new p("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,a=e.shape.length;null==n&&(n=[r-1,a-2]);const i=n;return c["tidy"](()=>{let n,o;if(r>a){n=r-a;const t=[];for(let e=0;e<n;++e)t.push(1);e=c["reshape"](e,e.shape.concat(t))}else if(a>r){n=a-r;const e=[];for(let t=0;t<n;++t)e.push(1);t=c["reshape"](t,t.shape.concat(e))}else n=0;if(2===t.shape.length&&2===e.shape.length)o=i[0]===i[1]?c["sum"](c["mul"](t,e),i[0]):c["sum"](c["mul"](c["transpose"](t,[1,0]),e),i[1]);else{const n=i[0]!==t.shape.length-1,r=i[1]===e.shape.length-1;o=c["matMul"](t,e,n,r)}if(n>0){let t;t=r>a?r+a-3:r-1;const e=[];for(let r=t;r<t+n;++r)e.push(r);o=c["squeeze"](o,e)}return 1===o.shape.length&&(o=c["expandDims"](o,1)),o})}wc.className="Concatenate",c["serialization"].registerClass(wc);class Oc extends mc{constructor(t){super(t),this.axes=t.axes,this.normalize=null!=t.normalize&&t.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(t){c["util"].assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0],n=t[1];if(e.length>3||n.length>3)throw new p("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);if(e[r[0]]!==n[r[1]])throw new h(`Dimension incompatibility: ${e[r[0]]} !== ${n[r[1]]}`)}mergeFunction(t){if(2!==t.length)throw new h(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${t.length} input(s).`);let e,n=t[0],r=t[1];return e=Array.isArray(this.axes)?this.axes.map((e,n)=>kc(e,t[n].shape.length)):[kc(this.axes,n.shape.length),kc(this.axes,r.shape.length)],this.normalize&&(n=to(n,e[0]),r=to(r,e[1])),Sc(n,r,e)}interpretAxes(t,e){let n;return n=Array.isArray(this.axes)?this.axes:[kc(this.axes,t.length),kc(this.axes,e.length)],n}computeOutputShape(t){c["util"].assert(Array.isArray(t)&&2===t.length&&Array.isArray(t[0])&&Array.isArray(t[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const e=t[0].slice(),n=t[1].slice();if(e.length>3||n.length>3)throw new p("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(e,n);e.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);const a=e.concat(n);return 1===a.length&&a.push(1),a}computeMask(t,e){return null}getConfig(){const t={axes:this.axes,normalize:this.normalize},e=super.getConfig();return Object.assign(t,e),t}}Oc.className="Dot",c["serialization"].registerClass(Oc);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class _c extends we{constructor(t){super(t),this.supportsMasking=!0,this.stddev=t.stddev}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={stddev:this.stddev};return Object.assign(e,t),e}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t),r=()=>Object(c["add"])(Ot(n.shape,0,this.stddev),n),a=Dt(r,()=>n,e["training"]||!1);return a})}}_c.className="GaussianNoise",c["serialization"].registerClass(_c);class Cc extends we{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e);const n=ue(t);if(this.rate>0&&this.rate<1){const t=()=>{const t=Math.sqrt(this.rate/(1-this.rate));return Object(c["mul"])(n,Ot(n.shape,1,t))};return Dt(t,()=>n,e["training"]||!1)}return n})}}Cc.className="GaussianDropout",c["serialization"].registerClass(Cc);class Tc extends we{constructor(t){super(t),this.supportsMasking=!0,this.rate=t.rate,this.noiseShape=t.noiseShape}_getNoiseShape(t){return this.noiseShape||ue(t).shape}computeOutputShape(t){return t}getConfig(){const t=super.getConfig(),e={rate:this.rate};return Object.assign(e,t),e}call(t,e){return Object(c["tidy"])(()=>{if(this.rate<1&&this.rate>0){const n=this._getNoiseShape(t),r=()=>{const e=ue(t),r=1.6732632423543772,a=1.0507009873554805,i=-r*a;let o=Object(c["greaterEqual"])(Object(c["randomUniform"])(n),this.rate);o=pt(o,"float32");const s=((1-this.rate)*(1+this.rate*i**2))**-.5,u=-s*i*this.rate,l=Object(c["add"])(Object(c["mul"])(e,o),Object(c["mul"])(Object(c["add"])(o,-1),i));return Object(c["add"])(Object(c["mul"])(l,s),u)};return Dt(r,()=>ue(t),e["training"]||!1)}return t})}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Ic(t,e,n,r,a,i=.001){let o;if(2===t.rank)o=c["batchNorm2d"](t,e,n,r,a,i);else if(3===t.rank)o=c["batchNorm3d"](t,e,n,r,a,i);else{if(4!==t.rank)throw new p(`batchNormalization is not implemented for array of rank ${t.rank} yet`);o=c["batchNorm4d"](t,e,n,r,a,i)}return o}function Nc(t,e,n,r,a=.001){return Object(c["tidy"])(()=>{const i=c["moments"](t,r),o=i.mean,s=i.variance,u=Ic(t,o,s,n,e,a);return[u,o,s]})}function Ec(t,e,n,r,a=.001){return Object(c["tidy"])(()=>{const i=c["moments"](t,r),o=i.mean,s=i.variance,u=[];for(const e of ct(0,t.rank))-1!==r.indexOf(e)?u.push(1):u.push(t.shape[e]);const l=Object(c["reshape"])(o,u),d=Object(c["reshape"])(s,u),h=null==e?null:Object(c["reshape"])(e,u),p=null==n?null:Object(c["reshape"])(n,u),f=Ic(t,l,d,p,h,a);return[f,o,s]})}function Ac(t,e,n,r,a=.001){return c["util"].arraysEqual(r.slice().sort(),ct(0,t.rank-1))?Nc(t,e,n,r,a):Ec(t,e,n,r,a)}Tc.className="AlphaDropout",c["serialization"].registerClass(Tc);class Rc extends we{constructor(t){null==t&&(t={}),super(t),this.supportsMasking=!0,this.axis=null==t.axis?-1:t.axis,this.momentum=null==t.momentum?.99:t.momentum,this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=ie(t.betaInitializer||"zeros"),this.gammaInitializer=ie(t.gammaInitializer||"ones"),this.movingMeanInitializer=ie(t.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ie(t.movingVarianceInitializer||"ones"),this.betaConstraint=wi(t.betaConstraint),this.gammaConstraint=wi(t.gammaConstraint),this.betaRegularizer=mu(t.betaRegularizer),this.gammaRegularizer=mu(t.gammaRegularizer)}build(t){t=ce(t);const e=this.axis>=0?this.axis:this.axis+t.length,n=t[e];if(null==n)throw new h(`Axis ${e} of input tensor should have a defined dimension but the layer received an input with shape `+JSON.stringify(t)+".");this.inputSpec=[new ge({ndim:t.length,axes:{[e]:n}})];const r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(t,e){return Object(c["tidy"])(()=>{const n=null!=e["training"]&&e["training"],r=ue(t),a=r.shape,i=a.length,o=ct(0,i),s=this.axis>=0?this.axis:this.axis+i;o.splice(s,1);const u=g(1,i);u[s]=a[s];const l=o.slice();l.sort();const d=!c["util"].arraysEqual(l,ct(0,i).slice(0,i-1)),h=()=>{if(d){const t=Object(c["reshape"])(this.movingMean.read(),u),e=Object(c["reshape"])(this.movingVariance.read(),u),n=this.center?Object(c["reshape"])(this.beta.read(),u):null,a=this.scale?Object(c["reshape"])(this.gamma.read(),u):null;return Ic(r,t,e,n,a,this.epsilon)}return Ic(r,this.movingMean.read(),this.movingVariance.read(),null==this.beta?null:this.beta.read(),null==this.gamma?null:this.gamma.read(),this.epsilon)};if(!n)return h();const[p,f,m]=Ac(r,this.gamma.read(),this.beta.read(),o,this.epsilon),b=(t,e,n)=>{c["tidy"](()=>{const r=1-n,a=t.read(),i=c["mul"](c["sub"](a,e),r);t.write(c["sub"](a,i))})},y=()=>{b(this.movingMean,f,this.momentum),b(this.movingVariance,m,this.momentum)};return y(),p})}getConfig(){const t={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ae(this.betaInitializer),gammaInitializer:ae(this.gammaInitializer),movingMeanInitializer:ae(this.movingMeanInitializer),movingVarianceInitializer:ae(this.movingVarianceInitializer),betaRegularizer:pu(this.betaRegularizer),gammaRegularizer:pu(this.gammaRegularizer),betaConstraint:vi(this.betaConstraint),gammaConstraint:vi(this.gammaConstraint)},e=super.getConfig();return Object.assign(t,e),t}}Rc.className="BatchNormalization",c["serialization"].registerClass(Rc);class jc extends we{constructor(t){if(null==t&&(t={}),super(t),this.axis=null==t.axis?-1:t.axis,"number"===typeof this.axis){if(!Number.isInteger(this.axis))throw new Error("Expected axis to be an integer, but received "+this.axis)}else{if(!Array.isArray(this.axis))throw new Error("Expected axis to be an integer or an array of integers, but received "+JSON.stringify(this.axis));for(const t of this.axis)if(!Number.isInteger(t))throw new Error("Expected axis to be an array of integers, but received "+JSON.stringify(this.axis))}this.epsilon=null==t.epsilon?.001:t.epsilon,this.center=null==t.center||t.center,this.scale=null==t.scale||t.scale,this.betaInitializer=ie(t.betaInitializer||"zeros"),this.gammaInitializer=ie(t.gammaInitializer||"ones"),this.betaRegularizer=mu(t.betaRegularizer),this.gammaRegularizer=mu(t.gammaRegularizer),this.supportsMasking=!0}build(t){t=ce(t);const e=t.length;"number"===typeof this.axis&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=e);for(const a of this.axis)if(a<0||a>=e)throw new Error("Invalid axis: "+a);if(this.axis.length!==N(this.axis).length)throw new Error("Found duplicate axes in: "+this.axis);const n=this.axis.map(e=>t[e]),r=!0;this.scale?this.gamma=this.addWeight("gamma",n,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",n,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(t,e){const n=ue(t),r=n.shape,a=r.length;return Object(c["tidy"])(()=>{const t=!0;let{mean:e,variance:i}=Object(c["moments"])(n,this.axis,t);const o=g(1,a);for(const n of this.axis)o[n]=r[n];const s=t=>null!=t&&t.shape.length!==a?c["reshape"](t,o):t;let u=this.scale?s(this.gamma.read()):null,l=this.center?s(this.beta.read()):null;const d=[],h=[];for(let n=0;n<a;++n)-1!==this.axis.indexOf(n)?(d.push(r[n]),h.push(1)):(d.push(1),h.push(r[n]));return e=c["tile"](e,d),i=c["tile"](i,d),null!=u&&(u=c["tile"](u,h)),null!=l&&(l=c["tile"](l,h)),Ic(n,e,i,l,u,this.epsilon)})}getConfig(){const t={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:ae(this.betaInitializer),gammaInitializer:ae(this.gammaInitializer),betaRegularizer:pu(this.betaRegularizer),gammaRegularizer:pu(this.gammaRegularizer)},e=super.getConfig();return Object.assign(t,e),t}}function Dc(t,e,n){return Object(c["tidy"])(()=>{if(4!==t.rank)throw new h("temporalPadding expects input tensor to be 4-D, but received a "+t.rank+"-D tensor.");if(null==e&&(e=[[1,1],[1,1]]),2!==e.length||2!==e[0].length||2!==e[1].length)throw new h("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n=ht()),"channelsLast"!==n&&"channelsFirst"!==n)throw new h(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r="channelsFirst"===n?[[0,0],[0,0],e[0],e[1]]:[[0,0],e[0],e[1],[0,0]],c["pad"](t,r)})}jc.className="LayerNormalization",c["serialization"].registerClass(jc);class Fc extends we{constructor(t){if(null==t&&(t={}),super(t),this.dataFormat=null==t.dataFormat?ht():t.dataFormat,null==t.padding)this.padding=[[1,1],[1,1]];else if("number"===typeof t.padding)this.padding=[[t.padding,t.padding],[t.padding,t.padding]];else{if(t.padding=t.padding,2!==t.padding.length)throw new h(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${t.padding.length} array.`);let e,n;if("number"===typeof t.padding[0])e=[t.padding[0],t.padding[0]],n=[t.padding[1],t.padding[1]];else{if(t.padding=t.padding,2!==t.padding[0].length)throw new h(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${t.padding[0].length} array.`);if(e=t.padding[0],2!==t.padding[1].length)throw new h(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${t.padding[1].length} array.`);n=t.padding[1]}this.padding=[e,n]}this.inputSpec=[new ge({ndim:4})]}computeOutputShape(t){let e,n;return t=ce(t),"channelsFirst"===this.dataFormat?(e=null!=t[2]&&t[2]>=0?t[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[3]&&t[3]>=0?t[3]+this.padding[1][0]+this.padding[1][1]:null,[t[0],t[1],e,n]):(e=null!=t[1]&&t[1]>=0?t[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=t[2]&&t[2]>=0?t[2]+this.padding[1][0]+this.padding[1][1]:null,[t[0],e,n,t[3]])}call(t,e){return Object(c["tidy"])(()=>Dc(ue(t),this.padding,this.dataFormat))}getConfig(){const t={padding:this.padding,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function Mc(t,e,n,r,a,i){return Object(c["tidy"])(()=>{let o;q(a),Y(i),X(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a=ht()),null==i&&(i="max"),t=_u(t,a);const s="same"===r?"same":"valid";return o="max"===i?c["maxPool"](t,e,n,s):c["avgPool"](t,e,n,s),"channelsFirst"===a&&(o=c["transpose"](o,[0,3,1,2])),o})}function Pc(t,e,n,r,a,i){return Object(c["tidy"])(()=>{let o;q(a),Y(i),X(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a=ht()),null==i&&(i="max"),t=Cu(t,a);const s="same"===r?"same":"valid";return o="max"===i?c["maxPool3d"](t,e,n,s):c["avgPool3d"](t,e,n,s),"channelsFirst"===a&&(o=c["transpose"](o,[0,4,1,2,3])),o})}Fc.className="ZeroPadding2D",c["serialization"].registerClass(Fc);class $c extends we{constructor(t){if(null==t.poolSize&&(t.poolSize=2),super(t),"number"===typeof t.poolSize)this.poolSize=[t.poolSize];else{if(!Array.isArray(t.poolSize)||1!==t.poolSize.length||"number"!==typeof t.poolSize[0])throw new h("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.poolSize));this.poolSize=t.poolSize}if(j(this.poolSize,"poolSize"),null==t.strides)this.strides=this.poolSize;else if("number"===typeof t.strides)this.strides=[t.strides];else{if(!Array.isArray(t.strides)||1!==t.strides.length||"number"!==typeof t.strides[0])throw new h("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+JSON.stringify(t.strides));this.strides=t.strides}j(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,X(this.padding),this.inputSpec=[new ge({ndim:3})]}computeOutputShape(t){t=ce(t);const e=Su(t[1],this.poolSize[0],this.padding,this.strides[0]);return[t[0],e,t[2]]}call(t,e){return Object(c["tidy"])(()=>{this.invokeCallHook(t,e),t=ft(ue(t),2);const n=this.poolingFunction(ue(t),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return c["squeeze"](n,[2])})}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides},e=super.getConfig();return Object.assign(t,e),t}}class Lc extends $c{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Mc(t,e,n,r,a,"max")}}Lc.className="MaxPooling1D",c["serialization"].registerClass(Lc);class Bc extends $c{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Mc(t,e,n,r,a,"avg")}}Bc.className="AveragePooling1D",c["serialization"].registerClass(Bc);class zc extends we{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(2!==t.strides.length)throw new h("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides];j(this.poolSize,"poolSize"),j(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,q(this.dataFormat),X(this.padding),this.inputSpec=[new ge({ndim:4})]}computeOutputShape(t){t=ce(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2];return e=Su(e,this.poolSize[0],this.padding,this.strides[0]),n=Su(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n]:[t[0],e,n,t[3]]}call(t,e){return Object(c["tidy"])(()=>(this.invokeCallHook(t,e),this.poolingFunction(ue(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Wc extends zc{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Mc(t,e,n,r,a,"max")}}Wc.className="MaxPooling2D",c["serialization"].registerClass(Wc);class Vc extends zc{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Mc(t,e,n,r,a,"avg")}}Vc.className="AveragePooling2D",c["serialization"].registerClass(Vc);class Uc extends we{constructor(t){if(null==t.poolSize&&(t.poolSize=[2,2,2]),super(t),this.poolSize=Array.isArray(t.poolSize)?t.poolSize:[t.poolSize,t.poolSize,t.poolSize],null==t.strides)this.strides=this.poolSize;else if(Array.isArray(t.strides)){if(3!==t.strides.length)throw new h("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+t.strides.length+".");this.strides=t.strides}else this.strides=[t.strides,t.strides,t.strides];j(this.poolSize,"poolSize"),j(this.strides,"strides"),this.padding=null==t.padding?"valid":t.padding,this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,q(this.dataFormat),X(this.padding),this.inputSpec=[new ge({ndim:5})]}computeOutputShape(t){t=ce(t);let e="channelsFirst"===this.dataFormat?t[2]:t[1],n="channelsFirst"===this.dataFormat?t[3]:t[2],r="channelsFirst"===this.dataFormat?t[4]:t[3];return e=Su(e,this.poolSize[0],this.padding,this.strides[0]),n=Su(n,this.poolSize[1],this.padding,this.strides[1]),r=Su(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[t[0],t[1],e,n,r]:[t[0],e,n,r,t[4]]}call(t,e){return Object(c["tidy"])(()=>(this.invokeCallHook(t,e),this.poolingFunction(ue(t),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const t={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Gc extends Uc{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Pc(t,e,n,r,a,"max")}}Gc.className="MaxPooling3D",c["serialization"].registerClass(Gc);class Hc extends Uc{constructor(t){super(t)}poolingFunction(t,e,n,r,a){return q(a),X(r),Pc(t,e,n,r,a,"avg")}}Hc.className="AveragePooling3D",c["serialization"].registerClass(Hc);class qc extends we{constructor(t){super(t),this.inputSpec=[new ge({ndim:3})]}computeOutputShape(t){return[t[0],t[2]]}call(t,e){throw new p}}class Kc extends qc{constructor(t){super(t||{})}call(t,e){return Object(c["tidy"])(()=>{const e=ue(t);return c["mean"](e,1)})}}Kc.className="GlobalAveragePooling1D",c["serialization"].registerClass(Kc);class Xc extends qc{constructor(t){super(t||{})}call(t,e){return Object(c["tidy"])(()=>{const e=ue(t);return c["max"](e,1)})}}Xc.className="GlobalMaxPooling1D",c["serialization"].registerClass(Xc);class Yc extends we{constructor(t){super(t),this.dataFormat=null==t.dataFormat?"channelsLast":t.dataFormat,q(this.dataFormat),this.inputSpec=[new ge({ndim:4})]}computeOutputShape(t){return t=t,"channelsLast"===this.dataFormat?[t[0],t[3]]:[t[0],t[1]]}call(t,e){throw new p}getConfig(){const t={dataFormat:this.dataFormat},e=super.getConfig();return Object.assign(t,e),t}}class Jc extends Yc{call(t,e){return Object(c["tidy"])(()=>{const e=ue(t);return"channelsLast"===this.dataFormat?c["mean"](e,[1,2]):c["mean"](e,[2,3])})}}Jc.className="GlobalAveragePooling2D",c["serialization"].registerClass(Jc);class Zc extends Yc{call(t,e){return Object(c["tidy"])(()=>{const e=ue(t);return"channelsLast"===this.dataFormat?c["max"](e,[1,2]):c["max"](e,[2,3])})}}Zc.className="GlobalMaxPooling2D",c["serialization"].registerClass(Zc);
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class Qc extends we{constructor(t){super(t),this.layer=t.layer}build(t){this.built=!0}get trainable(){return null!=this.layer&&this.layer.trainable}set trainable(t){null!=this.layer&&(this.layer.trainable=t)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(t){this.layer.setWeights(t)}getConfig(){const t={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},e=super.getConfig();return Object.assign(t,e),t}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(t)}static fromConfig(t,e,n={}){const r=e["layer"],a=Qi(r,n);delete e["layer"];const i={layer:a};return Object.assign(i,e),new t(i)}}class tl extends Qc{constructor(t){super(t),this.supportsMasking=!0}build(t){if(t=ce(t),t.length<3)throw new h("TimeDistributed layer expects an input shape >= 3D, but received input shape "+JSON.stringify(t));this.inputSpec=[{shape:t}];const e=[t[0]].concat(t.slice(2));this.layer.built||(this.layer.build(e),this.layer.built=!0),super.build(t)}computeOutputShape(t){t=ce(t);const e=[t[0]].concat(t.slice(2)),n=this.layer.computeOutputShape(e),r=t[1];return[n[0],r].concat(n.slice(1))}call(t,e){return Object(c["tidy"])(()=>{t=ue(t);const n=(t,n)=>{const r=ue(this.layer.call(t,e));return[r,[]]},r=Uu(n,t,[],!1,null,null,!1,!0),a=r[1];return a})}}function el(t){A(G,"BidirectionalMergeMode",t)}tl.className="TimeDistributed",c["serialization"].registerClass(tl);const nl="concat";class rl extends Qc{constructor(t){super(t);const e=t.layer.getConfig(),n={};n["className"]=t.layer.getClassName(),n["config"]=e,this.forwardLayer=Qi(n),e["goBackwards"]=!0!==e["goBackwards"];const r={};if(r["className"]=t.layer.getClassName(),r["config"]=e,this.backwardLayer=Qi(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=void 0===t.mergeMode?nl:t.mergeMode,el(this.mergeMode),t.weights)throw new p("weights support is not implemented for Bidirectional layer yet.");this._stateful=t.layer.stateful,this.returnSequences=t.layer.returnSequences,this.returnState=t.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=t.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(t){this._trainable=t,null!=this.forwardLayer&&(this.forwardLayer.trainable=t),null!=this.backwardLayer&&(this.backwardLayer.trainable=t)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(t){const e=t.length,n=Math.floor(e/2);this.forwardLayer.setWeights(t.slice(0,n)),this.backwardLayer.setWeights(t.slice(n))}computeOutputShape(t){let e,n,r,a=this.forwardLayer.computeOutputShape(t);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState?(r=a.slice(1),e=a[0]):e=a[0],e=e,"concat"===this.mergeMode?(e[e.length-1]*=2,n=[e]):n=null==this.mergeMode?[e,e.slice()]:[e],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[e].concat(r).concat(r.slice()):v(n)}apply(t,e){let n=null==e?null:e["initialState"],r=null==e?null:e["constants"];null==e&&(e={});const a=Vu(t,n,r,this.numConstants);if(t=a.inputs,n=a.initialState,r=a.constants,Array.isArray(t)&&(n=t.slice(1),t=t[0]),(null==n||0===n.length)&&null==r)return super.apply(t,e);const i=[],o=[];if(null!=n){const t=n.length;if(t%2>0)throw new h("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");e["initialState"]=n,i.push(...n);const r=n.map(t=>new ge({shape:t.shape}));this.forwardLayer.stateSpec=r.slice(0,t/2),this.backwardLayer.stateSpec=r.slice(t/2),o.push(...r)}if(null!=r)throw new p("Support for constants in Bidirectional layers is not implemented yet.");const s=i[0]instanceof be;for(const u of i)if(u instanceof be!==s)throw new h("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(s){const n=[t].concat(i),r=this.inputSpec.concat(o),a=this.inputSpec;this.inputSpec=r;const s=super.apply(n,e);return this.inputSpec=a,s}return super.apply(t,e)}call(t,e){return Object(c["tidy"])(()=>{const n=e["initialState"];let r,a,i,o;if(null==n)r=this.forwardLayer.call(t,e),a=this.backwardLayer.call(t,e);else{const i=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(t,Object.assign(e,{initialState:i})),a=this.backwardLayer.call(t,Object.assign(e,{initialState:o}))}return this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=c["reverse"](a,1)),"concat"===this.mergeMode?o=wt([r,a]):"sum"===this.mergeMode?o=c["add"](r,a):"ave"===this.mergeMode?o=c["mul"](.5,c["add"](r,a)):"mul"===this.mergeMode?o=c["mul"](r,a):null==this.mergeMode&&(o=[r,a]),this.returnState?null==this.mergeMode?o.concat(i):[o].concat(i):o})}resetStates(t){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(t){Q(this.forwardLayer.name,()=>{this.forwardLayer.build(t)}),Q(this.backwardLayer.name,()=>{this.backwardLayer.build(t)}),this.built=!0}computeMask(t,e){let n;if(Array.isArray(e)&&(e=e[0]),n=this.returnSequences?null==this.mergeMode?[e,e]:e:null==this.mergeMode?[null,null]:null,this.returnState){const t=this.forwardLayer.states,e=t.map(t=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e).concat(e)}return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(t){super.setFastWeightInitDuringBuild(t),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(t),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(t)}getConfig(){const t={mergeMode:this.mergeMode},e=super.getConfig();return Object.assign(t,e),t}static fromConfig(t,e){const n=Qi(e["layer"]);if(delete e["layer"],null!=e["numConstants"])throw new p("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=e;return r["layer"]=n,new t(r)}}rl.className="Bidirectional",c["serialization"].registerClass(rl);
/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
class al extends we{constructor(t){super(t),this.scale=t.scale,t.offset?this.offset=t.offset:this.offset=0}getConfig(){const t={scale:this.scale,offset:this.offset},e=super.getConfig();return Object.assign(t,e),t}call(t,e){return Object(c["tidy"])(()=>(t=ue(t),"float32"!==t.dtype&&(t=pt(t,"float32")),Object(c["add"])(Object(c["mul"])(t,this.scale),this.offset)))}}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
function il(t){return new _e(t)}function ol(t){return new vu(t)}function sl(t){return new gu(t)}function ul(t){return new bu(t)}function cl(t){return new yu(t)}function ll(t){return new wu(t)}function dl(t){return new xu(t)}function hl(t){return new $u(t)}function pl(t){return new Ru(t)}function fl(t){return new Du(t)}function ml(t){return new ju(t)}function gl(t){return new Fu(t)}function bl(t){return new Pu(t)}function yl(t){return new Lu(t)}function vl(t){return new Bu(t)}function xl(t){return new Wu(t)}function wl(t){return new cc(t)}function kl(t){return new sc(t)}function Sl(t){return new ic(t)}function Ol(t){return new oc(t)}function _l(t){return new uc(t)}function Cl(t){return new lc(t)}function Tl(t){return new dc(t)}function Il(t){return new hc(t)}function Nl(t){return new fc(t)}function El(t){return new gc(t)}function Al(t){return new yc(t)}function Rl(t){return new wc(t)}function jl(t){return new vc(t)}function Dl(t){return new xc(t)}function Fl(t){return new bc(t)}function Ml(t){return new Oc(t)}function Pl(t){return new Rc(t)}function $l(t){return new jc(t)}function Ll(t){return new Fc(t)}function Bl(t){return new Bc(t)}function zl(t){return Bl(t)}function Wl(t){return Bl(t)}function Vl(t){return new Vc(t)}function Ul(t){return Vl(t)}function Gl(t){return Vl(t)}function Hl(t){return new Hc(t)}function ql(t){return Hl(t)}function Kl(t){return Hl(t)}function Xl(t){return new Kc(t)}function Yl(t){return new Jc(t)}function Jl(t){return new Xc(t)}function Zl(t){return new Zc(t)}function Ql(t){return new Lc(t)}function td(t){return new Wc(t)}function ed(t){return new Gc(t)}function nd(t){return new Yu(t)}function rd(t){return new Xu(t)}function ad(t){return new Zu(t)}function id(t){return new Ju(t)}function od(t){return new Ku(t)}function sd(t){return new qu(t)}function ud(t){return new ac(t)}function cd(t){return new rc(t)}function ld(t){return new Gu(t)}function dd(t){return new Qu(t)}function hd(t){return new rl(t)}function pd(t){return new tl(t)}al.className="Rescaling",c["serialization"].registerClass(al);const fd=Jl,md=Zl,gd=Ql,bd=td;function yd(t){return new _c(t)}function vd(t){return new Cc(t)}function xd(t){return new Tc(t)}function wd(t){return new pc(t)}function kd(t){return new al(t)}function Sd(t,e){return vo(t,e)}function Od(t,e){return Co(t,e)}function _d(t,e){return To(t,e)}function Cd(t,e){return xo(t,e)}function Td(t,e){return Do(t,e)}function Id(t,e){return Oo(t,e)}function Nd(t,e){return _o(t,e)}function Ed(t,e){return go(t,e)}function Ad(t,e){return no(t,e)}function Rd(t,e){return ro(t,e)}function jd(t,e){return ro(t,e)}function Dd(t,e){return ro(t,e)}function Fd(t,e){return eo(t,e)}function Md(t,e){return eo(t,e)}function Pd(t,e){return eo(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $d(t){return new cu(t)}function Ld(t){return lu(t)}function Bd(t){return du(t)}
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zd extends Gi{constructor(){super(...arguments),this.model=null}setModel(t){if(!(t instanceof As))throw new Error("model must be a LayersModel, not some other Container");this.model=t}}function Wd(t,e){return t<e}function Vd(t,e){return t>e}class Ud extends zd{constructor(t){if(super(),null==t&&(t={}),t.restoreBestWeights)throw new p("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=t.monitor||"val_loss",this.minDelta=Math.abs(t.minDelta||0),this.patience=t.patience||0,this.verbose=t.verbose||0,this.mode=t.mode||"auto",this.baseline=t.baseline,-1===["auto","min","max"].indexOf(this.mode)&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),"min"===this.mode?this.monitorFunc=Wd:"max"===this.mode||-1!==this.monitor.indexOf("acc")?this.monitorFunc=Vd:this.monitorFunc=Wd,this.monitorFunc===Wd&&(this.minDelta*=-1)}async onTrainBegin(t){this.wait=0,this.stoppedEpoch=0,null!=this.baseline?this.best=this.baseline:this.best=this.monitorFunc===Wd?1/0:-1/0}async onEpochEnd(t,e){await zi(e);const n=this.getMonitorValue(e);null!=n&&(this.monitorFunc(n-this.minDelta,this.best)?(this.best=n,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=t,this.model.stopTraining=!0)))}async onTrainEnd(t){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(t){null==t&&(t={});const e=t[this.monitor];return null==e&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: `+Object.keys(t)),e}}function Gd(t){return new Ud(t)}const Hd={earlyStopping:Gd};
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */},"432a":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t-e),s=Object(i["b"])((t,e,n,r)=>({real:t-n,imag:e-r})),u=Object(i["a"])(r["Sub"],o,s),c={kernelName:r["Sub"],backendName:"cpu",kernelFunc:u}},4359:function(t,e){function n(t,e){var n=-1,r=t.length;e||(e=Array(r));while(++n<r)e[n]=t[n];return e}t.exports=n},4362:function(t,e,n){e.nextTick=function(t){var e=Array.prototype.slice.call(arguments);e.shift(),setTimeout((function(){t.apply(null,e)}),0)},e.platform=e.arch=e.execPath=e.title="browser",e.pid=1,e.browser=!0,e.env={},e.argv=[],e.binding=function(t){throw new Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";e.cwd=function(){return r},e.chdir=function(e){t||(t=n("df7c")),r=t.resolve(e,r)}}(),e.exit=e.kill=e.umask=e.dlopen=e.uptime=e.memoryUsage=e.uvCounters=function(){},e.features={}},"43c6":function(t,e){},4546:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getComponentValidator=e.getBooleanValidator=e.getNumberArrayValidator=e.getFunctionValidator=e.getStringOrGradientValidator=e.getStringValidator=e.getNumberOrAutoValidator=e.getNumberOrArrayOfNumbersValidator=e.getNumberValidator=e.alphaComponent=e.RGBComponent=void 0;var r=n("d777"),a=n("9cb8");function i(t){return a.Util._isString(t)?'"'+t+'"':"[object Number]"===Object.prototype.toString.call(t)||a.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function o(t){return t>255?255:t<0?0:Math.round(t)}function s(t){return t>1?1:t<1e-4?1e-4:t}function u(){if(r.Konva.isUnminified)return function(t,e){return a.Util._isNumber(t)||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function c(t){if(r.Konva.isUnminified)return function(e,n){var r=a.Util._isNumber(e),o=a.Util._isArray(e)&&e.length==t;return r||o||a.Util.warn(i(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function l(){if(r.Konva.isUnminified)return function(t,e){var n=a.Util._isNumber(t),r="auto"===t;return n||r||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function d(){if(r.Konva.isUnminified)return function(t,e){return a.Util._isString(t)||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function h(){if(r.Konva.isUnminified)return function(t,e){var n=a.Util._isString(t),r="[object CanvasGradient]"===Object.prototype.toString.call(t);return n||r||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function p(){if(r.Konva.isUnminified)return function(t,e){return a.Util._isFunction(t)||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function f(){if(r.Konva.isUnminified)return function(t,e){return a.Util._isArray(t)?t.forEach((function(t){a.Util._isNumber(t)||a.Util.warn('"'+e+'" attribute has non numeric element '+t+". Make sure that all elements are numbers.")})):a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.'),t}}function m(){if(r.Konva.isUnminified)return function(t,e){var n=!0===t||!1===t;return n||a.Util.warn(i(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function g(t){if(r.Konva.isUnminified)return function(e,n){return a.Util.isObject(e)||a.Util.warn(i(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}e.RGBComponent=o,e.alphaComponent=s,e.getNumberValidator=u,e.getNumberOrArrayOfNumbersValidator=c,e.getNumberOrAutoValidator=l,e.getStringValidator=d,e.getStringOrGradientValidator=h,e.getFunctionValidator=p,e.getNumberArrayValidator=f,e.getBooleanValidator=m,e.getComponentValidator=g},4587:function(t,e,n){},"45b8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.regex)("numeric",/^[0-9]*$/);e.default=a},"45ef":function(t,e,n){"use strict";n.r(e),function(t,r,a){n.d(e,"AdadeltaOptimizer",(function(){return Qp})),n.d(e,"AdagradOptimizer",(function(){return tf})),n.d(e,"AdamOptimizer",(function(){return ef})),n.d(e,"AdamaxOptimizer",(function(){return nf})),n.d(e,"Add",(function(){return Or})),n.d(e,"AddN",(function(){return _r})),n.d(e,"BroadcastTo",(function(){return Rr})),n.d(e,"DataStorage",(function(){return pi})),n.d(e,"Div",(function(){return Cr})),n.d(e,"ENV",(function(){return h})),n.d(e,"Environment",(function(){return c})),n.d(e,"FromPixels",(function(){return Pr})),n.d(e,"FusedBatchNorm",(function(){return Tr})),n.d(e,"Identity",(function(){return Dr})),n.d(e,"KernelBackend",(function(){return fi})),n.d(e,"MaxPoolWithArgmax",(function(){return $r})),n.d(e,"MomentumOptimizer",(function(){return af})),n.d(e,"NonMaxSuppressionV5",(function(){return Ar})),n.d(e,"OneHot",(function(){return jr})),n.d(e,"Optimizer",(function(){return Zp})),n.d(e,"PadV2",(function(){return Mr})),n.d(e,"RMSPropOptimizer",(function(){return of})),n.d(e,"Rank",(function(){return Tt})),n.d(e,"Reduction",(function(){return Ad})),n.d(e,"SGDOptimizer",(function(){return rf})),n.d(e,"Square",(function(){return Nr})),n.d(e,"SquaredDifference",(function(){return Ir})),n.d(e,"Tensor",(function(){return Ct})),n.d(e,"TensorBuffer",(function(){return kt})),n.d(e,"Tile",(function(){return Fr})),n.d(e,"Transpose",(function(){return Er})),n.d(e,"Variable",(function(){return Rt})),n.d(e,"abs",(function(){return Vr})),n.d(e,"acos",(function(){return Ur})),n.d(e,"acosh",(function(){return Gr})),n.d(e,"add",(function(){return Lr})),n.d(e,"addN",(function(){return ec})),n.d(e,"addStrict",(function(){return Sa})),n.d(e,"all",(function(){return Yl})),n.d(e,"any",(function(){return Jl})),n.d(e,"argMax",(function(){return Zl})),n.d(e,"argMin",(function(){return Ql})),n.d(e,"asin",(function(){return Hr})),n.d(e,"asinh",(function(){return qr})),n.d(e,"atan",(function(){return Kr})),n.d(e,"atan2",(function(){return Oa})),n.d(e,"atanh",(function(){return Xr})),n.d(e,"avgPool",(function(){return Ll})),n.d(e,"avgPool3d",(function(){return Wl})),n.d(e,"backend",(function(){return gn})),n.d(e,"backend_util",(function(){return Ai})),n.d(e,"basicLSTMCell",(function(){return md})),n.d(e,"batchNorm",(function(){return sc})),n.d(e,"batchNorm2d",(function(){return lc})),n.d(e,"batchNorm3d",(function(){return pc})),n.d(e,"batchNorm4d",(function(){return gc})),n.d(e,"batchNormalization",(function(){return oc})),n.d(e,"batchNormalization2d",(function(){return cc})),n.d(e,"batchNormalization3d",(function(){return hc})),n.d(e,"batchNormalization4d",(function(){return mc})),n.d(e,"batchToSpaceND",(function(){return ur})),n.d(e,"booleanMaskAsync",(function(){return pl})),n.d(e,"broadcastTo",(function(){return bc})),n.d(e,"browser",(function(){return Gp})),n.d(e,"buffer",(function(){return or})),n.d(e,"cast",(function(){return cr})),n.d(e,"ceil",(function(){return Yr})),n.d(e,"clipByValue",(function(){return Jr})),n.d(e,"clone",(function(){return yc})),n.d(e,"complex",(function(){return Dn})),n.d(e,"concat",(function(){return tr})),n.d(e,"concat1d",(function(){return er})),n.d(e,"concat2d",(function(){return nr})),n.d(e,"concat3d",(function(){return rr})),n.d(e,"concat4d",(function(){return ar})),n.d(e,"conv1d",(function(){return bl})),n.d(e,"conv2d",(function(){return yl})),n.d(e,"conv2dTranspose",(function(){return Cl})),n.d(e,"conv3d",(function(){return vl})),n.d(e,"conv3dTranspose",(function(){return Tl})),n.d(e,"cos",(function(){return Zr})),n.d(e,"cosh",(function(){return Qr})),n.d(e,"cumsum",(function(){return lr})),n.d(e,"customGrad",(function(){return ui})),n.d(e,"deprecationWarn",(function(){return Qe})),n.d(e,"depthToSpace",(function(){return dr})),n.d(e,"depthwiseConv2d",(function(){return kl})),n.d(e,"diag",(function(){return Id})),n.d(e,"disableDeprecationWarnings",(function(){return Ze})),n.d(e,"dispose",(function(){return on})),n.d(e,"disposeVariables",(function(){return tn})),n.d(e,"div",(function(){return Ba})),n.d(e,"divNoNan",(function(){return _c})),n.d(e,"divStrict",(function(){return _a})),n.d(e,"dot",(function(){return Nl})),n.d(e,"dropout",(function(){return Nd})),n.d(e,"elu",(function(){return sd})),n.d(e,"enableDebugMode",(function(){return Je})),n.d(e,"enableProdMode",(function(){return Ye})),n.d(e,"engine",(function(){return en})),n.d(e,"env",(function(){return d})),n.d(e,"equal",(function(){return Jc})),n.d(e,"equalStrict",(function(){return Zc})),n.d(e,"erf",(function(){return ta})),n.d(e,"exp",(function(){return ea})),n.d(e,"expandDims",(function(){return hr})),n.d(e,"expm1",(function(){return na})),n.d(e,"eye",(function(){return Tc})),n.d(e,"fft",(function(){return wd})),n.d(e,"fill",(function(){return Xn})),n.d(e,"findBackend",(function(){return pn})),n.d(e,"findBackendFactory",(function(){return fn})),n.d(e,"floor",(function(){return ra})),n.d(e,"floorDiv",(function(){return Ca})),n.d(e,"frame",(function(){return Dd})),n.d(e,"fused",(function(){return mh})),n.d(e,"gather",(function(){return dl})),n.d(e,"gatherND",(function(){return Td})),n.d(e,"gather_util",(function(){return Wa})),n.d(e,"getBackend",(function(){return dn})),n.d(e,"getGradient",(function(){return g})),n.d(e,"getKernel",(function(){return m})),n.d(e,"getKernelsForBackend",(function(){return b})),n.d(e,"grad",(function(){return ri})),n.d(e,"grads",(function(){return ai})),n.d(e,"greater",(function(){return Qc})),n.d(e,"greaterEqual",(function(){return tl})),n.d(e,"greaterEqualStrict",(function(){return el})),n.d(e,"greaterStrict",(function(){return nl})),n.d(e,"hammingWindow",(function(){return jd})),n.d(e,"hannWindow",(function(){return Rd})),n.d(e,"ifft",(function(){return kd})),n.d(e,"imag",(function(){return Mn})),n.d(e,"image",(function(){return sh})),n.d(e,"inTopKAsync",(function(){return Pd})),n.d(e,"io",(function(){return zp})),n.d(e,"irfft",(function(){return Od})),n.d(e,"isFinite",(function(){return ma})),n.d(e,"isInf",(function(){return fa})),n.d(e,"isNaN",(function(){return pa})),n.d(e,"keep",(function(){return sn})),n.d(e,"leakyRelu",(function(){return ud})),n.d(e,"less",(function(){return rl})),n.d(e,"lessEqual",(function(){return al})),n.d(e,"lessEqualStrict",(function(){return il})),n.d(e,"lessStrict",(function(){return ol})),n.d(e,"linalg",(function(){return Zd})),n.d(e,"linspace",(function(){return Yn})),n.d(e,"localResponseNormalization",(function(){return pd})),n.d(e,"log",(function(){return aa})),n.d(e,"log1p",(function(){return ia})),n.d(e,"logSigmoid",(function(){return oa})),n.d(e,"logSoftmax",(function(){return di})),n.d(e,"logSumExp",(function(){return td})),n.d(e,"logicalAnd",(function(){return vc})),n.d(e,"logicalNot",(function(){return xc})),n.d(e,"logicalOr",(function(){return wc})),n.d(e,"logicalXor",(function(){return kc})),n.d(e,"losses",(function(){return qd})),n.d(e,"matMul",(function(){return Il})),n.d(e,"math",(function(){return Vp})),n.d(e,"max",(function(){return ed})),n.d(e,"maxPool",(function(){return $l})),n.d(e,"maxPool3d",(function(){return zl})),n.d(e,"maxPoolWithArgmax",(function(){return Vl})),n.d(e,"maximum",(function(){return Ta})),n.d(e,"maximumStrict",(function(){return Ia})),n.d(e,"mean",(function(){return nd})),n.d(e,"memory",(function(){return nn})),n.d(e,"min",(function(){return rd})),n.d(e,"minimum",(function(){return Na})),n.d(e,"minimumStrict",(function(){return Ea})),n.d(e,"mod",(function(){return Aa})),n.d(e,"modStrict",(function(){return Ra})),n.d(e,"moments",(function(){return ad})),n.d(e,"movingAverage",(function(){return bd})),n.d(e,"mul",(function(){return ja})),n.d(e,"mulStrict",(function(){return Da})),n.d(e,"multiRNNCell",(function(){return gd})),n.d(e,"multinomial",(function(){return Ic})),n.d(e,"neg",(function(){return sa})),n.d(e,"nextFrame",(function(){return lf})),n.d(e,"norm",(function(){return fd})),n.d(e,"notEqual",(function(){return sl})),n.d(e,"notEqualStrict",(function(){return ul})),n.d(e,"oneHot",(function(){return Nc})),n.d(e,"ones",(function(){return qn})),n.d(e,"onesLike",(function(){return Zn})),n.d(e,"op",(function(){return jn})),n.d(e,"outerProduct",(function(){return El})),n.d(e,"pad",(function(){return Ec})),n.d(e,"pad1d",(function(){return Ac})),n.d(e,"pad2d",(function(){return Rc})),n.d(e,"pad3d",(function(){return jc})),n.d(e,"pad4d",(function(){return Dc})),n.d(e,"pool",(function(){return Bl})),n.d(e,"pow",(function(){return Fa})),n.d(e,"powStrict",(function(){return Ma})),n.d(e,"prelu",(function(){return cd})),n.d(e,"print",(function(){return sr})),n.d(e,"prod",(function(){return od})),n.d(e,"profile",(function(){return rn})),n.d(e,"rand",(function(){return Fc})),n.d(e,"randomGamma",(function(){return Gc})),n.d(e,"randomNormal",(function(){return Hc})),n.d(e,"randomUniform",(function(){return qc})),n.d(e,"range",(function(){return Jn})),n.d(e,"ready",(function(){return ln})),n.d(e,"real",(function(){return Fn})),n.d(e,"reciprocal",(function(){return ua})),n.d(e,"registerBackend",(function(){return mn})),n.d(e,"registerGradient",(function(){return v})),n.d(e,"registerKernel",(function(){return y})),n.d(e,"relu",(function(){return ld})),n.d(e,"relu6",(function(){return dd})),n.d(e,"removeBackend",(function(){return hn})),n.d(e,"reshape",(function(){return pr})),n.d(e,"reverse",(function(){return Al})),n.d(e,"reverse1d",(function(){return Rl})),n.d(e,"reverse2d",(function(){return jl})),n.d(e,"reverse3d",(function(){return Dl})),n.d(e,"reverse4d",(function(){return Fl})),n.d(e,"rfft",(function(){return Sd})),n.d(e,"round",(function(){return ca})),n.d(e,"rsqrt",(function(){return la})),n.d(e,"scalar",(function(){return Ln})),n.d(e,"scatterND",(function(){return xd})),n.d(e,"scatter_util",(function(){return Ka})),n.d(e,"selu",(function(){return hd})),n.d(e,"separableConv2d",(function(){return _l})),n.d(e,"serialization",(function(){return Xp})),n.d(e,"setBackend",(function(){return cn})),n.d(e,"setPlatform",(function(){return bn})),n.d(e,"setdiff1dAsync",(function(){return yr})),n.d(e,"sigmoid",(function(){return da})),n.d(e,"sign",(function(){return ha})),n.d(e,"signal",(function(){return Md})),n.d(e,"sin",(function(){return ga})),n.d(e,"sinh",(function(){return ba})),n.d(e,"slice",(function(){return Ul})),n.d(e,"slice1d",(function(){return Gl})),n.d(e,"slice2d",(function(){return Hl})),n.d(e,"slice3d",(function(){return ql})),n.d(e,"slice4d",(function(){return Kl})),n.d(e,"slice_util",(function(){return ni})),n.d(e,"softmax",(function(){return li})),n.d(e,"softplus",(function(){return ya})),n.d(e,"spaceToBatchND",(function(){return fr})),n.d(e,"sparseToDense",(function(){return Cd})),n.d(e,"spectral",(function(){return _d})),n.d(e,"split",(function(){return ir})),n.d(e,"sqrt",(function(){return va})),n.d(e,"square",(function(){return Kc})),n.d(e,"squaredDifference",(function(){return Xc})),n.d(e,"squaredDifferenceStrict",(function(){return Pa})),n.d(e,"squeeze",(function(){return mr})),n.d(e,"stack",(function(){return gr})),n.d(e,"step",(function(){return xa})),n.d(e,"stft",(function(){return Fd})),n.d(e,"stridedSlice",(function(){return yd})),n.d(e,"sub",(function(){return $a})),n.d(e,"subStrict",(function(){return La})),n.d(e,"sum",(function(){return id})),n.d(e,"sumOutType",(function(){return Ft})),n.d(e,"tan",(function(){return wa})),n.d(e,"tanh",(function(){return ka})),n.d(e,"tensor",(function(){return Pn})),n.d(e,"tensor1d",(function(){return Bn})),n.d(e,"tensor2d",(function(){return zn})),n.d(e,"tensor3d",(function(){return Wn})),n.d(e,"tensor4d",(function(){return Vn})),n.d(e,"tensor5d",(function(){return Un})),n.d(e,"tensor6d",(function(){return Gn})),n.d(e,"tensor_util",(function(){return Bt})),n.d(e,"test_util",(function(){return zc})),n.d(e,"tidy",(function(){return an})),n.d(e,"tile",(function(){return Cc})),n.d(e,"time",(function(){return un})),n.d(e,"topk",(function(){return vd})),n.d(e,"train",(function(){return uf})),n.d(e,"transpose",(function(){return hi})),n.d(e,"truncatedNormal",(function(){return Yc})),n.d(e,"unregisterGradient",(function(){return w})),n.d(e,"unregisterKernel",(function(){return x})),n.d(e,"unsortedSegmentSum",(function(){return hl})),n.d(e,"unstack",(function(){return br})),n.d(e,"util",(function(){return ht})),n.d(e,"valueAndGrad",(function(){return ii})),n.d(e,"valueAndGrads",(function(){return oi})),n.d(e,"variable",(function(){return Hn})),n.d(e,"variableGrads",(function(){return si})),n.d(e,"version_core",(function(){return Yp})),n.d(e,"webgl",(function(){return Jp})),n.d(e,"where",(function(){return Sc})),n.d(e,"whereAsync",(function(){return Oc})),n.d(e,"zeros",(function(){return Kn})),n.d(e,"zerosLike",(function(){return Qn}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function s(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function u(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var c=function(){function t(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return t.prototype.setPlatform=function(t,e){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+e+"."),this.platformName=t,this.platform=e},t.prototype.registerFlag=function(t,e,n){if(this.flagRegistry[t]={evaluationFn:e,setHook:n},null!=this.urlFlags[t]){var r=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+r+"."),this.set(t,r)}},t.prototype.get=function(t){return t in this.flags||(this.flags[t]=this.evaluateFlag(t)),this.flags[t]},t.prototype.getNumber=function(t){return this.get(t)},t.prototype.getBool=function(t){return this.get(t)},t.prototype.getFlags=function(){return this.flags},Object.defineProperty(t.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),t.prototype.set=function(t,e){if(null==this.flagRegistry[t])throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=e,null!=this.flagRegistry[t].setHook&&this.flagRegistry[t].setHook(e)},t.prototype.evaluateFlag=function(t){if(null==this.flagRegistry[t])throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},t.prototype.setFlags=function(t){this.flags=Object.assign({},t)},t.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},t.prototype.populateURLFlags=function(){var t=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,n,r=(e=this.global.location.search,n={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return l(n,e[0],e[1]),e.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(e){var n=e.split(":"),r=n[0],a=n[1];t.urlFlags[r]=function(t,e){if("true"===(e=e.toLowerCase())||"false"===e)return"true"===e;if(""+ +e===e)return+e;throw new Error("Could not parse value flag value "+e+" for flag "+t+".")}(r,a)}))}},t}();function l(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function d(){return h}var h=null,p=new Map,f=new Map;function m(t,e){var n=k(t,e);return p.get(n)}function g(t){return f.get(t)}function b(t){for(var e=p.entries(),n=[];;){var r=e.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===t&&n.push(s)}return n}function y(t){var e=t.kernelName,n=t.backendName,r=k(e,n);if(p.has(r))throw new Error("The kernel '"+e+"' for backend '"+n+"' is already registered");p.set(r,t)}function v(t){var e=t.kernelName;f.has(e)&&console.warn("Overriding the gradient for '"+e+"'"),f.set(e,t)}function x(t,e){var n=k(t,e);if(!p.has(n))throw new Error("The kernel '"+t+"' for backend '"+e+"' is not registered");p.delete(n)}function w(t){if(!f.has(t))throw new Error("The gradient '"+t+"' for backend is not registered");f.delete(t)}function k(t,e){return e+"_"+t}function S(t){for(var e=t.length,n=0,r=0;e>0;)r=Math.random()*e|0,n=t[--e],t[e]=t[r],t[r]=n}function O(t,e,n){return Math.max(t,Math.min(e,n))}function _(t){return t%2==0?t:t+1}function C(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error("string"==typeof e?e:e())}function I(t,e,n){void 0===n&&(n=""),T(R(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))}function N(t){T(null!=t,(function(){return"The input to the tensor constructor must be a non-null value."}))}function E(t,e,n){if(void 0===e&&(e=[]),void 0===n&&(n=!1),null==e&&(e=[]),Array.isArray(t)||H(t)&&!n)for(var r=0;r<t.length;++r)E(t[r],e,n);else e.push(t);return e}function A(t){if(0===t.length)return 1;for(var e=t[0],n=1;n<t.length;n++)e*=t[n];return e}function R(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function j(t){return t%1==0}function D(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;var e=Math.exp(2*t);return(e-1)/(e+1)}function F(t){var e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function M(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function P(t,e,n){return void 0===e&&(e=function(t){return 0}),new Promise((function(r,a){var i=0,o=function(){if(t())r();else{i++;var s=e(i);null!=n&&i>=n?a():setTimeout(o,s)}};o()}))}function $(t,e){for(var n=1,r=-1,a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(-1===t[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(t[a]<0)throw Error("Shapes can not be < 0. Found "+t[a]+" at dim "+a);if(-1===r){if(e>0&&e!==n)throw Error("Size("+e+") must match the product of shape "+t);return t}if(0===n)throw Error("Cannot infer the missing size in ["+t+"] when there are 0 elements");if(e%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+e+" / "+n);var i=t.slice();return i[r]=e/n,i}function L(t,e){var n=e.length;return T((t=null==t?e.map((function(t,e){return e})):[].concat(t)).every((function(t){return t>=-n&&t<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+t})),T(t.every((function(t){return j(t)})),(function(){return"All values in axis param must be integers but got axis "+t})),t.map((function(t){return t<0?n+t:t}))}function B(t,e){for(var n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:L(e,t).sort(),o=0,s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+t[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function z(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function W(t,e){var n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function V(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+e+" being uploaded contains "+r+".")}}function U(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function G(t,e){return"complex64"!==e&&("float32"!==e||"complex64"===t)&&("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)}function H(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array}function q(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function K(t){if(null==t)return 0;var e=0;return t.forEach((function(t){return e+=t.length})),e}function X(t){return"string"==typeof t||t instanceof String}function Y(t){return"boolean"==typeof t}function J(t){return"number"==typeof t}function Z(t){return Array.isArray(t)?Z(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array?"int32":J(t)?"float32":X(t)?"string":Y(t)?"bool":"float32"}function Q(t){return!!(t&&t.constructor&&t.call&&t.apply)}function tt(t,e){for(var n=e;n<t;++n)if(t%n==0)return n;return t}function et(t){var e=t.length;if(e<2)return[];var n=new Array(e-1);n[e-2]=t[e-1];for(var r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function nt(t,e,n){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=E(t)),n&&V(t,e),function(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){for(var r=new Uint8Array(t.length),a=0;a<r.length;++a)0!==Math.round(t[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+e)}function rt(t,e){if(0===t.length)return e[0];var n=t.reduce((function(t,e){return t*e}));if(0===n)return[];if(n!==e.length)throw new Error("["+t+"] does not match the input size.");return function t(e,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[e+o];else{i=n[0];var s=n.slice(1),u=s.reduce((function(t,e){return t*e}));for(o=0;o<i;o++)a[o]=t(e+o*u,s,r)}return a}(0,t,e)}function at(t,e){for(var n=it(t,e),r=0;r<n.length;r++)n[r]=1;return n}function it(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function ot(){return d().platform.now()}function st(t){t.forEach((function(e){T(Number.isInteger(e)&&e>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+t+"]."}))}))}function ut(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",d().platform.encode(t,e)}function ct(t,e){return void 0===e&&(e="utf-8"),e=e||"utf-8",d().platform.decode(t,e)}function lt(t,e,n){if(0===e)return 0;if(1===e)return t[0];for(var r=t[t.length-1],a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function dt(t,e,n){if(0===e)return[];if(1===e)return[t];for(var r=new Array(e),a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}var ht=Object.freeze({shuffle:S,clamp:O,nearestLargerEven:_,sum:C,randUniform:function(t,e){var n=Math.random();return e*n+(1-n)*t},distSquared:function(t,e){for(var n=0,r=0;r<t.length;r++){var a=Number(t[r])-Number(e[r]);n+=a*a}return n},assert:T,assertShapesMatch:I,assertNonNull:N,flatten:E,sizeFromShape:A,isScalarShape:function(t){return 0===t.length},arraysEqual:R,isInt:j,tanh:D,sizeToSquarishShape:F,createShuffledIndices:function(t){for(var e=new Uint32Array(t),n=0;n<t;++n)e[n]=n;return S(e),e},rightPad:M,repeatedTry:P,inferFromImplicitShape:$,parseAxisParam:L,squeezeShape:B,getTypedArrayFromDType:z,getArrayFromDType:W,checkConversionForErrors:V,isValidDtype:U,hasEncodingLoss:G,isTypedArray:H,bytesPerElement:q,bytesFromStringArray:K,isString:X,isBoolean:Y,isNumber:J,inferDtype:Z,isFunction:Q,nearestDivisor:tt,computeStrides:et,toTypedArray:nt,toNestedArray:rt,makeOnesTypedArray:at,makeZerosTypedArray:it,now:ot,assertNonNegativeIntegerDimensions:st,fetch:function(t,e){return d().platform.fetch(t,e)},encodeString:ut,decodeString:ct,locToIndex:lt,indexToLoc:dt}),pt=function(){function t(t,e){this.backendTimer=t,this.logger=e,null==e&&(this.logger=new ft)}return t.prototype.profileKernel=function(t,e,n){var r,a=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(t,e,n){if("float32"!==e)return!1;for(var r=0;r<t.length;r++){var a=t[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,t),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(t,n,r,i.kernelMs,e,o)}))}))})),r},t}(),ft=function(){function t(){}return t.prototype.logKernelProfile=function(t,e,n,r,a,i){var o="number"==typeof r?M(r+"ms",9):r.error,s=M(t,25),u=e.rank,c=e.size,l=M(e.shape.toString(),14),d="";for(var h in a){var p=a[h].shape||e.shape,f=p.length;d+=h+": "+f+"D "+(f>0?p:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+d+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},t}(),mt=20,gt=3,bt=7;function yt(t,e,n,r){var a=et(e),i=function(t,e,n,r){var a=A(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,u="complex64"===n?wt(t):t;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,d=0;d<i;d++)o[d]=Math.max(o[d],vt(u[l+d],0,n).length);return o}(t,e,n,a),o=e.length,s=function t(e,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[vt(wt(e)[0],0,r)]:"bool"===r?[xt(e[0])]:[e[0].toString()];if(1===c){if(u>mt){var l=gt*s,d=Array.from(e.slice(0,l)),h=Array.from(e.slice((u-gt)*s,u*s));return"complex64"===r&&(d=wt(d),h=wt(h)),["["+d.map((function(t,e){return vt(t,i[e],r)})).join(", ")+", ..., "+h.map((function(t,e){return vt(t,i[u-gt+e],r)})).join(", ")+"]"]}return["["+("complex64"===r?wt(e):Array.from(e)).map((function(t,e){return vt(t,i[e],r)})).join(", ")+"]"]}var p=n.slice(1),f=a.slice(1),m=a[0]*s,g=[];if(u>mt){for(var b=0;b<gt;b++){var y=(v=b*m)+m;g.push.apply(g,t(e.slice(v,y),p,r,f,i,!1))}for(g.push("..."),b=u-gt;b<u;b++)y=(v=b*m)+m,g.push.apply(g,t(e.slice(v,y),p,r,f,i,b===u-1))}else for(b=0;b<u;b++){var v;y=(v=b*m)+m,g.push.apply(g,t(e.slice(v,y),p,r,f,i,b===u-1))}var x=2===c?",":"";for(g[0]="["+g[0]+x,b=1;b<g.length-1;b++)g[b]=" "+g[b]+x;var w=",\n";for(b=2;b<c;b++)w+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(o?"":w),g}(t,e,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+e+"]"),u.push("  values:")),u.push(s.map((function(t){return"    "+t})).join("\n")),u.join("\n")}function vt(t,e,n){return M(Array.isArray(t)?parseFloat(t[0].toFixed(bt))+" + "+parseFloat(t[1].toFixed(bt))+"j":X(t)?"'"+t+"'":"bool"===n?xt(t):parseFloat(t.toFixed(bt)).toString(),e)}function xt(t){return 0===t?"false":"true"}function wt(t){for(var e=[],n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var kt=function(){function t(t,e,n){var r=this;if(this.dtype=e,this.shape=t.slice(),this.size=A(t),null!=n){var a=n.length;T(a===this.size,(function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||W(e,this.size),this.strides=et(t)}return t.prototype.set=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),T(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+e.rank+")"}));var a=this.locToIndex(n);this.values[a]=t},t.prototype.get=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0===t.length&&(t=[0]);for(var n=0,r=0,a=t;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]},t.prototype.locToIndex=function(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];for(var e=t[t.length-1],n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e},t.prototype.indexToLoc=function(t){if(0===this.rank)return[];if(1===this.rank)return[t];for(var e=new Array(this.shape.length),n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.toTensor=function(){return St().makeTensor(this.values,this.shape,this.dtype)},t}(),St=null,Ot=null,_t=null,Ct=function(){function t(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=A(t),this.strides=et(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return t.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},t.prototype.asScalar=function(){return this.throwIfDisposed(),T(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},t.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},t.prototype.as2D=function(t,e){return this.throwIfDisposed(),this.reshape([t,e])},t.prototype.as3D=function(t,e,n){return this.throwIfDisposed(),this.reshape([t,e,n])},t.prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),this.reshape([t,e,n,r])},t.prototype.as5D=function(t,e,n,r,a){return this.throwIfDisposed(),this.reshape([t,e,n,r,a])},t.prototype.asType=function(t){return this.throwIfDisposed(),Ot.cast(this,t)},Object.defineProperty(t.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),t.prototype.buffer=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,Ot.buffer(this.shape,this.dtype,t)]}}))}))},t.prototype.bufferSync=function(){return Ot.buffer(this.shape,this.dtype,this.dataSync())},t.prototype.array=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return[4,this.data()];case 1:return t=e.sent(),[2,rt(this.shape,t)]}}))}))},t.prototype.arraySync=function(){return rt(this.shape,this.dataSync())},t.prototype.data=function(){return s(this,void 0,void 0,(function(){var t,e;return u(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),t=St().read(this.dataId),"string"!==this.dtype?[3,2]:[4,t];case 1:e=n.sent();try{return[2,e.map((function(t){return ct(t)}))]}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,t]}}))}))},t.prototype.dataSync=function(){this.throwIfDisposed();var t=St().readSync(this.dataId);if("string"===this.dtype)try{return t.map((function(t){return ct(t)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},t.prototype.bytes=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return this.throwIfDisposed(),[4,St().read(this.dataId)];case 1:return t=e.sent(),"string"===this.dtype?[2,t]:[2,new Uint8Array(t.buffer)]}}))}))},t.prototype.dispose=function(){this.isDisposed||(St().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(t.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),t.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},t.prototype.toFloat=function(){return this.asType("float32")},t.prototype.toInt=function(){return this.asType("int32")},t.prototype.toBool=function(){return this.asType("bool")},t.prototype.print=function(t){return void 0===t&&(t=!1),Ot.print(this,t)},t.prototype.reshape=function(t){return this.throwIfDisposed(),Ot.reshape(this,t)},t.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},t.prototype.expandDims=function(t){return void 0===t&&(t=0),Ot.expandDims(this,t)},t.prototype.cumsum=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=!1),void 0===n&&(n=!1),Ot.cumsum(this,t,e,n)},t.prototype.squeeze=function(t){return this.throwIfDisposed(),Ot.squeeze(this,t)},t.prototype.clone=function(){return this.throwIfDisposed(),Ot.clone(this)},t.prototype.toString=function(t){return void 0===t&&(t=!1),yt(this.dataSync(),this.shape,this.dtype,t)},t.prototype.gather=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),Ot.gather(this,t,e)},t.prototype.matMul=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=!1),this.throwIfDisposed(),Ot.matMul(this,t,e,n)},t.prototype.dot=function(t){return this.throwIfDisposed(),Ot.dot(this,t)},t.prototype.norm=function(t,e,n){return void 0===t&&(t="euclidean"),void 0===e&&(e=null),void 0===n&&(n=!1),this.throwIfDisposed(),Ot.norm(this,t,e,n)},t.prototype.slice=function(t,e){return this.throwIfDisposed(),Ot.slice(this,t,e)},t.prototype.reverse=function(t){return this.throwIfDisposed(),Ot.reverse(this,t)},t.prototype.concat=function(e,n){return void 0===n&&(n=0),this.throwIfDisposed(),e instanceof t&&(e=[e]),Ot.concat([this].concat(e),n)},t.prototype.split=function(t,e){return void 0===e&&(e=0),this.throwIfDisposed(),Ot.split(this,t,e)},t.prototype.stack=function(t,e){return void 0===e&&(e=0),Ot.stack([this,t],e)},t.prototype.unstack=function(t){return void 0===t&&(t=0),Ot.unstack(this,t)},t.prototype.batchNormalization=function(t,e,n,r,a){return void 0===n&&(n=.001),_t("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,e,a,r,n)},t.prototype.all=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.all(this,t,e)},t.prototype.any=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.any(this,t,e)},t.prototype.logSumExp=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.logSumExp(this,t,e)},t.prototype.sum=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.sum(this,t,e)},t.prototype.prod=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.prod(this,t,e)},t.prototype.mean=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.mean(this,t,e)},t.prototype.min=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.min(this,t,e)},t.prototype.max=function(t,e){return void 0===t&&(t=null),void 0===e&&(e=!1),this.throwIfDisposed(),Ot.max(this,t,e)},t.prototype.argMin=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),Ot.argMin(this,t)},t.prototype.argMax=function(t){return void 0===t&&(t=null),this.throwIfDisposed(),Ot.argMax(this,t)},t.prototype.cast=function(t){return this.throwIfDisposed(),Ot.cast(this,t)},t.prototype.addStrict=function(t){return this.throwIfDisposed(),Ot.addStrict(this,t)},t.prototype.atan2=function(t){return this.throwIfDisposed(),Ot.atan2(this,t)},t.prototype.sub=function(t){return this.throwIfDisposed(),Ot.sub(this,t)},t.prototype.subStrict=function(t){return this.throwIfDisposed(),Ot.subStrict(this,t)},t.prototype.pow=function(t){return this.throwIfDisposed(),Ot.pow(this,t)},t.prototype.powStrict=function(t){return this.throwIfDisposed(),Ot.powStrict(this,t)},t.prototype.mul=function(t){return this.throwIfDisposed(),Ot.mul(this,t)},t.prototype.mulStrict=function(t){return this.throwIfDisposed(),Ot.mulStrict(this,t)},t.prototype.floorDiv=function(t){return this.throwIfDisposed(),Ot.floorDiv(this,t)},t.prototype.divStrict=function(t){return this.throwIfDisposed(),Ot.divStrict(this,t)},t.prototype.minimum=function(t){return this.throwIfDisposed(),Ot.minimum(this,t)},t.prototype.minimumStrict=function(t){return this.throwIfDisposed(),Ot.minimumStrict(this,t)},t.prototype.maximum=function(t){return this.throwIfDisposed(),Ot.maximum(this,t)},t.prototype.maximumStrict=function(t){return this.throwIfDisposed(),Ot.maximumStrict(this,t)},t.prototype.mod=function(t){return this.throwIfDisposed(),Ot.mod(this,t)},t.prototype.modStrict=function(t){return this.throwIfDisposed(),Ot.modStrict(this,t)},t.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),Ot.squaredDifferenceStrict(this,t)},t.prototype.notEqual=function(t){return this.throwIfDisposed(),Ot.notEqual(this,t)},t.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),Ot.notEqualStrict(this,t)},t.prototype.less=function(t){return this.throwIfDisposed(),Ot.less(this,t)},t.prototype.lessStrict=function(t){return this.throwIfDisposed(),Ot.lessStrict(this,t)},t.prototype.equal=function(t){return this.throwIfDisposed(),Ot.equal(this,t)},t.prototype.equalStrict=function(t){return this.throwIfDisposed(),Ot.equalStrict(this,t)},t.prototype.lessEqual=function(t){return this.throwIfDisposed(),Ot.lessEqual(this,t)},t.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),Ot.lessEqualStrict(this,t)},t.prototype.greater=function(t){return this.throwIfDisposed(),Ot.greater(this,t)},t.prototype.greaterStrict=function(t){return this.throwIfDisposed(),Ot.greaterStrict(this,t)},t.prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ot.greaterEqual(this,t)},t.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),Ot.greaterEqualStrict(this,t)},t.prototype.logicalAnd=function(t){return this.throwIfDisposed(),Ot.logicalAnd(this,t)},t.prototype.logicalOr=function(t){return this.throwIfDisposed(),Ot.logicalOr(this,t)},t.prototype.logicalNot=function(){return this.throwIfDisposed(),Ot.logicalNot(this)},t.prototype.logicalXor=function(t){return this.throwIfDisposed(),Ot.logicalXor(this,t)},t.prototype.where=function(t,e){return this.throwIfDisposed(),Ot.where(t,this,e)},t.prototype.neg=function(){return this.throwIfDisposed(),Ot.neg(this)},t.prototype.ceil=function(){return this.throwIfDisposed(),Ot.ceil(this)},t.prototype.floor=function(){return this.throwIfDisposed(),Ot.floor(this)},t.prototype.sign=function(){return this.throwIfDisposed(),Ot.sign(this)},t.prototype.isNaN=function(){return this.throwIfDisposed(),Ot.isNaN(this)},t.prototype.isInf=function(){return this.throwIfDisposed(),Ot.isInf(this)},t.prototype.isFinite=function(){return this.throwIfDisposed(),Ot.isFinite(this)},t.prototype.exp=function(){return this.throwIfDisposed(),Ot.exp(this)},t.prototype.expm1=function(){return this.throwIfDisposed(),Ot.expm1(this)},t.prototype.log=function(){return this.throwIfDisposed(),Ot.log(this)},t.prototype.log1p=function(){return this.throwIfDisposed(),Ot.log1p(this)},t.prototype.sqrt=function(){return this.throwIfDisposed(),Ot.sqrt(this)},t.prototype.rsqrt=function(){return this.throwIfDisposed(),Ot.rsqrt(this)},t.prototype.square=function(){return this.throwIfDisposed(),Ot.square(this)},t.prototype.reciprocal=function(){return this.throwIfDisposed(),Ot.reciprocal(this)},t.prototype.abs=function(){return this.throwIfDisposed(),Ot.abs(this)},t.prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ot.clipByValue(this,t,e)},t.prototype.relu=function(){return this.throwIfDisposed(),Ot.relu(this)},t.prototype.relu6=function(){return this.throwIfDisposed(),Ot.relu6(this)},t.prototype.elu=function(){return this.throwIfDisposed(),Ot.elu(this)},t.prototype.selu=function(){return this.throwIfDisposed(),Ot.selu(this)},t.prototype.leakyRelu=function(t){return void 0===t&&(t=.2),this.throwIfDisposed(),Ot.leakyRelu(this,t)},t.prototype.prelu=function(t){return this.throwIfDisposed(),Ot.prelu(this,t)},t.prototype.sigmoid=function(){return this.throwIfDisposed(),Ot.sigmoid(this)},t.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ot.logSigmoid(this)},t.prototype.softplus=function(){return this.throwIfDisposed(),Ot.softplus(this)},t.prototype.zerosLike=function(){return this.throwIfDisposed(),Ot.zerosLike(this)},t.prototype.onesLike=function(){return this.throwIfDisposed(),Ot.onesLike(this)},t.prototype.sin=function(){return this.throwIfDisposed(),Ot.sin(this)},t.prototype.cos=function(){return this.throwIfDisposed(),Ot.cos(this)},t.prototype.tan=function(){return this.throwIfDisposed(),Ot.tan(this)},t.prototype.asin=function(){return this.throwIfDisposed(),Ot.asin(this)},t.prototype.acos=function(){return this.throwIfDisposed(),Ot.acos(this)},t.prototype.atan=function(){return this.throwIfDisposed(),Ot.atan(this)},t.prototype.sinh=function(){return this.throwIfDisposed(),Ot.sinh(this)},t.prototype.cosh=function(){return this.throwIfDisposed(),Ot.cosh(this)},t.prototype.tanh=function(){return this.throwIfDisposed(),Ot.tanh(this)},t.prototype.asinh=function(){return this.throwIfDisposed(),Ot.asinh(this)},t.prototype.acosh=function(){return this.throwIfDisposed(),Ot.acosh(this)},t.prototype.atanh=function(){return this.throwIfDisposed(),Ot.atanh(this)},t.prototype.erf=function(){return this.throwIfDisposed(),Ot.erf(this)},t.prototype.round=function(){return this.throwIfDisposed(),Ot.round(this)},t.prototype.step=function(t){return void 0===t&&(t=0),this.throwIfDisposed(),Ot.step(this,t)},t.prototype.softmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),Ot.softmax(this,t)},t.prototype.logSoftmax=function(t){return void 0===t&&(t=-1),this.throwIfDisposed(),Ot.logSoftmax(this,t)},t.prototype.resizeBilinear=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),Ot.image.resizeBilinear(this,t,e)},t.prototype.resizeNearestNeighbor=function(t,e){return void 0===e&&(e=!1),this.throwIfDisposed(),Ot.image.resizeNearestNeighbor(this,t,e)},t.prototype.conv1d=function(t,e,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),Ot.conv1d(this,t,e,n,r,a,i)},t.prototype.conv2d=function(t,e,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),Ot.conv2d(this,t,e,n,r,a,i)},t.prototype.conv2dTranspose=function(t,e,n,r,a){return this.throwIfDisposed(),Ot.conv2dTranspose(this,t,e,n,r,a)},t.prototype.depthwiseConv2D=function(t,e,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),Ot.depthwiseConv2d(this,t,e,n,r,a,i)},t.prototype.separableConv2d=function(t,e,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),Ot.separableConv2d(this,t,e,n,r,a,i)},t.prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),Ot.avgPool(this,t,e,n,r)},t.prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),Ot.maxPool(this,t,e,n,r)},t.prototype.localResponseNormalization=function(t,e,n,r){return void 0===t&&(t=5),void 0===e&&(e=1),void 0===n&&(n=1),void 0===r&&(r=.5),Ot.localResponseNormalization(this,t,e,n,r)},t.prototype.pool=function(t,e,n,r,a){return this.throwIfDisposed(),Ot.pool(this,t,e,n,r,a)},t.prototype.variable=function(t,e,n){return void 0===t&&(t=!0),this.throwIfDisposed(),St().makeVariable(this,t,e,n)},t.prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),Ot.unsortedSegmentSum(this,t,e)},t.prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Ot.batchToSpaceND(this,t,e)},t.prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),Ot.spaceToBatchND(this,t,e)},t.prototype.topk=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=!0),this.throwIfDisposed(),Ot.topk(this,t,e)},t.prototype.stridedSlice=function(t,e,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),Ot.stridedSlice(this,t,e,n,r,a,i,o,s)},t.prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),Ot.depthToSpace(this,t,e)},t.prototype.fft=function(){return this.throwIfDisposed(),Ot.spectral.fft(this)},t.prototype.ifft=function(){return this.throwIfDisposed(),Ot.spectral.ifft(this)},t.prototype.rfft=function(){return this.throwIfDisposed(),Ot.spectral.rfft(this)},t.prototype.irfft=function(){return this.throwIfDisposed(),Ot.spectral.irfft(this)},t}();Object.defineProperty(Ct,Symbol.hasInstance,{value:function(t){return!!t&&null!=t.dataId&&null!=t.shape&&null!=t.dtype}});var Tt,It,Nt,Et,At,Rt=function(t){function e(e,n,r,a){var i=t.call(this,e.shape,e.dtype,e.dataId,a)||this;return i.trainable=n,i.name=r,i}return o(e,t),e.prototype.assign=function(t){if(t.dtype!==this.dtype)throw new Error("dtype of the new value ("+t.dtype+") and previous value ("+this.dtype+") must match");if(!R(t.shape,this.shape))throw new Error("shape of the new value ("+t.shape+") and previous value ("+this.shape+") must match");St().disposeTensor(this),this.dataId=t.dataId,St().incRef(this,null)},e.prototype.dispose=function(){St().disposeVariable(this),this.isDisposedInternal=!0},e}(Ct);Object.defineProperty(Rt,Symbol.hasInstance,{value:function(t){return t instanceof Ct&&null!=t.assign&&t.assign instanceof Function}}),function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"}(Tt||(Tt={})),function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"}(It||(It={})),function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"}(Nt||(Nt={})),function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"}(Et||(Et={})),function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"}(At||(At={}));var jt={float32:Et,int32:It,bool:Nt,complex64:At};function Dt(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error("Can not upcast "+t+" with "+e)}return jt[t][e]}function Ft(t){return Dt(t,"int32")}function Mt(t,e){if(t.dtype===e.dtype)return[t,e];var n=Dt(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function Pt(t,e){T(t.dtype===e.dtype,(function(){return"The dtypes of the first("+t.dtype+") and second("+e.dtype+") input must match"}))}function $t(t){var e=[];return function t(e,n,r){if(null!=e)if(e instanceof Ct)n.push(e);else if(a=e,Array.isArray(a)||"object"==typeof a){var a,i=e;for(var o in i){var s=i[o];r.has(s)||(r.add(s),t(s,n,r))}}}(t,e,new Set),e}var Lt,Bt=Object.freeze({makeTypesMatch:Mt,assertTypesMatch:Pt,isTensorInList:function(t,e){return e.some((function(e){return e.id===t.id}))},getTensorsInContainer:$t}),zt=function(){function t(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return t.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},t}(),Wt=function(){function t(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new zt}return t.prototype.ready=function(){return s(this,void 0,void 0,(function(){var t,e,n;return u(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];t=this.getSortedBackends(),e=0,r.label=1;case 1:return e<t.length?(n=t[e],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return e++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(t.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var t=this.initializeBackendsAndReturnBest(),e=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+e+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(e)}return this.backendInstance},enumerable:!0,configurable:!0}),t.prototype.backendNames=function(){return Object.keys(this.registryFactory)},t.prototype.findBackend=function(t){if(!(t in this.registry)){if(!(t in this.registryFactory))return null;if(this.initializeBackend(t).asyncInit)return null}return this.registry[t]},t.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},t.prototype.registerBackend=function(t,e,n){return void 0===n&&(n=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:e,priority:n},!0)},t.prototype.setBackend=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(a){switch(a.label){case 0:if(null==this.registryFactory[t])throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,null!=this.registry[t]?[3,4]:(this.backendInstance=null,e=this.initializeBackend(t),n=e.success,e.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new pt(this.backendInstance),[2,!0]}}))}))},t.prototype.setupRegisteredKernels=function(){var t=this;b(this.backendName).forEach((function(e){null!=e.setupFunc&&e.setupFunc(t.backendInstance)}))},t.prototype.disposeRegisteredKernels=function(t){var e=this;b(t).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(e.registry[t])}))},t.prototype.initializeBackend=function(t){var e=this,n=this.registryFactory[t];if(null==n)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<e.pendingBackendInitId)&&(e.registry[t]=n,e.pendingBackendInit=null,!0)})).catch((function(n){return!(a<e.pendingBackendInitId)&&(e.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[t]=r,{success:!0,asyncInit:!1}}catch(e){return console.warn("Initialization of backend "+t+" failed"),console.warn(e.stack||e.message),{success:!1,asyncInit:!1}}},t.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},t.prototype.getSortedBackends=function(){var t=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(e,n){return t.registryFactory[n].priority-t.registryFactory[e].priority}))},t.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),e=0;e<t.length;e++){var n=t[e],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},t.prototype.moveData=function(t,e){var n=this.state.tensorInfo.get(e),r=n.backend,a=this.readSync(e);r.disposeData(e),n.backend=t,t.move(e,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},t.prototype.tidy=function(t,e){var n,r=this,a=null;if(null==e){if("function"!=typeof t)throw new Error("Please provide a function to tidy()");e=t}else{if("string"!=typeof t&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof e)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=t}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=e())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},t.prototype.scopedRun=function(t,e,n){t();try{var r=n();return e(),r}catch(t){throw e(),t}},t.prototype.nextTensorId=function(){return t.nextTensorId++},t.prototype.nextVariableId=function(){return t.nextVariableId++},t.prototype.clone=function(t){var e=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),n={x:t};return this.addTapeNode(this.state.activeScope.name,n,[e],(function(t){return{x:function(){return t.toFloat()}}}),[],{}),e},t.prototype.runKernel=function(t,e,n,r,a){return this.runKernelFunc(null,e,null,t,n,r,a)},t.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},t.prototype.checkKernelForMemLeak=function(t,e,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(t){a+="complex64"===t.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-e-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+t+"'")},t.prototype.runKernelFunc=function(t,e,n,r,a,i,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var d,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var f,g=m(r,this.backendName);if(null!=g)d=function(){var t=u.backend.numDataIds();f=g.kernelFunc({inputs:e,attrs:a,backend:u.backend});var n=Array.isArray(f)?f:[f];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n);var s=n.map((function(t){var e=t.dataId,n=t.shape,r=t.dtype;return u.makeTensorFromDataId(e,n,r)}));if(l){var d=u.getTensorsForGradient(r,e,s);if(null==d){null==o&&(o=[]);var h=s.filter((function(t,e){return o[e]}));d=(i||[]).slice().concat(h)}c=u.saveTensorsForBackwardMode(d)}return s};else{var b=function(t){l&&(c=t.map((function(t){return u.keep(u.clone(t))})))};d=function(){var e=u.backend.numDataIds();f=u.tidy((function(){return t(u.backend,b)}));var n=Array.isArray(f)?f:[f];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,e,(function(){return d()})):d()})),l&&this.addTapeNode(r,e,s,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(e).map((function(t){return e[t].shape})),outputShapes:s.map((function(t){return t.shape}))}),Array.isArray(f)?s:s[0]},t.prototype.saveTensorsForBackwardMode=function(t){var e=this;return t.map((function(t){return e.keep(e.clone(t))}))},t.prototype.getTensorsForGradient=function(t,e,n){var r=g(t);if(null!=r){var a=r.inputsToSave||[],i=r.outputsToSave||[],o=void 0;r.saveAllInputs?(T(Array.isArray(e),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(e).map((function(t){return e[t]}))):o=a.map((function(t){return e[t]}));var s=n.filter((function(t,e){return i[e]}));return o.concat(s)}return null},t.prototype.makeTensor=function(t,e,n,r){if(null==t)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=t;"string"===n&&X(t[0])&&(a=t.map((function(t){return ut(t)})));var i=r.write(a,e,n),o=new Ct(e,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=K(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},t.prototype.makeTensorFromDataId=function(t,e,n,r){var a=new Ct(e,n=n||"float32",t,this.nextTensorId());return this.incRef(a,r),a},t.prototype.makeVariable=function(t,e,n,r){void 0===e&&(e=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==t.dtype&&(t=t.asType(r));var a=new Rt(t,e,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},t.prototype.incRef=function(t,e){var n=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,"string"===t.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==t.dtype&&"string"!==t.dtype&&(r=t.size*q(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:e||this.backend,dtype:t.dtype,shape:t.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof Rt||this.track(t)},t.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,"string"===t.dtype&&this.state.numStringTensors--;var e=this.state.tensorInfo.get(t.dataId);e.refCount<=1?("complex64"!==t.dtype&&(this.state.numBytes-=e.bytes),this.state.numDataBuffers--,e.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},t.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var e=this.state.registeredVariables[t];this.disposeVariable(e)}},t.prototype.disposeVariable=function(t){this.disposeTensor(t),null!=this.state.registeredVariables[t.name]&&delete this.state.registeredVariables[t.name]},t.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,null==t.reasons&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},t.prototype.profile=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){return this.state.profiling=!0,e=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(t){return t.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-e,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},t.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},t.prototype.addTapeNode=function(t,e,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:e,outputs:n,saved:a},u=g(t);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(t){return t=t.map((function(t,e){if(null==t){var r=n[e],a=it(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return t})),r(t.length>1?t:t[0],a,i)}),this.state.activeTape.push(s)},t.prototype.keep=function(t){return t.kept=!0,t},t.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},t.prototype.endTape=function(){this.state.gradientDepth--},t.prototype.startScope=function(t){var e={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(e.name=t),this.state.scopeStack.push(e),this.state.activeScope=e},t.prototype.endScope=function(t){for(var e=this,n=$t(t),r=new Set(n.map((function(t){return t.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(t){t.kept||t.scopeId!==o.id||e.track(t)}))},t.prototype.gradients=function(t,e,n,r){var a=this;if(void 0===r&&(r=!1),T(e.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",t)}));T(i instanceof Ct,(function(){return"The result y returned by f() must be a tensor."}));var o=function(t,e,n){for(var r={},a={},i=0;i<e.length;i++)r[e[i].id]=!0;for(i=0;i<t.length;i++){var o=(f=t[i]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<e.length;l++)if(r[u.id]){f.outputs.forEach((function(t){return r[t.id]=!0})),c=!0,a[f.id]=!0;break}if(c)break}}var d={};d[n.id]=!0;var h={};for(i=t.length-1;i>=0;i--)for(o=(f=t[i]).inputs,l=0;l<f.outputs.length;l++)if(d[f.outputs[l].id]){for(var s in o)d[o[s].id]=!0,h[f.id]=!0;break}var p=[];for(i=0;i<t.length;i++){var f;if(a[(f=t[i]).id]&&h[f.id]){var m={};for(var s in f.inputs){var g=f.inputs[s];r[g.id]&&(m[s]=g)}var b=Object.assign({},f);b.inputs=m,b.outputs=f.outputs,p.push(b)}}return p}(this.state.activeTape,e,i);if(!r&&0===o.length&&e.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var t,r,s={};s[i.id]=null==n?(t=i.shape,r=at(A(t),"float32"),Vt.makeTensor(r,t,"float32")):n,function(t,e,n){for(var r=function(r){var a=e[r],i=[];if(a.outputs.forEach((function(e){var n=t[e.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.kernelName+".");var o=a.gradient(i),s=function(e){if(!(e in o))throw new Error("Cannot backprop through input "+e+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[e]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input "+e+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[e];if(!R(r.shape,i.shape))throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input '"+e+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==t[i.id])t[i.id]=r;else{var s=t[i.id];t[i.id]=s.add(r),s.dispose()}};for(var u in a.inputs)s(u)},a=e.length-1;a>=0;a--)r(a)}(s,o,(function(t){return a.tidy(t)}));var u=e.map((function(t){return s[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(t){for(var e=0,n=t.saved;e<n.length;e++)n[e].dispose()})),a.state.activeTape=null),{value:i,grads:u}}))},t.prototype.customGrad=function(t){var e=this;return T(Q(t),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];T(r.every((function(t){return t instanceof Ct})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(t,e){i[e]=t})),e.runKernelFunc((function(e,a){return T((n=t.apply(void 0,r.concat([a]))).value instanceof Ct,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),T(Q(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(t,e){var a=n.gradFunc(t,e),i=Array.isArray(a)?a:[a];T(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),T(i.every((function(t){return t instanceof Ct})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return i.forEach((function(t,e){o[e]=function(){return t}})),o}))}},t.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},t.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},t.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){switch(r.label){case 0:return e=ot(),[4,this.backend.time(t)];case 1:return(n=r.sent()).wallMs=ot()-e,[2,n]}}))}))},t.prototype.track=function(t){return null!=this.state.activeScope&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(t.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),t.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new zt,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},t.nextTensorId=0,t.nextVariableId=0,t}(),Vt=function(){var e=function(){if(null==Lt){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof t)e=t;else if("undefined"!=typeof r)e=r;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Lt=e}return Lt}();if(null==e._tfengine){var n=new c(e);e._tfengine=new Wt(n)}return function(t){h=t}(e._tfengine.ENV),St=function(){return e._tfengine},e._tfengine}();function Ut(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Gt=d();Gt.registerFlag("DEBUG",(function(){return!1}),(function(t){t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Gt.registerFlag("IS_BROWSER",(function(){return Ut()})),Gt.registerFlag("IS_NODE",(function(){return"undefined"!=typeof r&&void 0!==r.versions&&void 0!==r.versions.node})),Gt.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Gt.registerFlag("PROD",(function(){return!1})),Gt.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Gt.getBool("DEBUG")})),Gt.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Gt.registerFlag("IS_TEST",(function(){return!1}));var Ht,qt,Kt,Xt={},Yt={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Jt(t,e){Xt[t]=e}function Zt(t){t in Xt||(Xt[t]=function(t){if(1!==t&&2!==t)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var e=function(t){if("undefined"!=typeof OffscreenCanvas&&2===t)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(t);return e.addEventListener("webglcontextlost",(function(e){e.preventDefault(),delete Xt[t]}),!1),1===t?e.getContext("webgl",Yt)||e.getContext("experimental-webgl",Yt):e.getContext("webgl2",Yt)}(t));var e=Xt[t];return e.isContextLost()?(delete Xt[t],Zt(t)):(e.disable(e.DEPTH_TEST),e.disable(e.STENCIL_TEST),e.disable(e.BLEND),e.disable(e.DITHER),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SAMPLE_COVERAGE),e.enable(e.SCISSOR_TEST),e.enable(e.CULL_FACE),e.cullFace(e.BACK),Xt[t])}function Qt(t,e){return[e,t]}function te(t){var e=A(t);return F(Math.ceil(e/4))}function ee(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function ne(t,e){var n,r,a,i,o,s,u,c,l,h=t;return 2===d().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=t.RGBA,r=t.RGBA,a=t.RGBA,i=h.RGBA,o=t.RGBA,s=4,u=4,c=null!=e?e.HALF_FLOAT_OES:null,l=t.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:t.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function re(t,e,n){var r=n();return e&&function(t){var e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+se(t,e))}(t),r}!function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"}(Ht||(Ht={})),function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"}(qt||(qt={})),function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Kt||(Kt={}));var ae=5.96e-8,ie=65504;function oe(t){return!!(d().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===t||ae<Math.abs(t)&&Math.abs(t)<ie)}function se(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+e}}function ue(t,e,n){return Ae(t,e,(function(){return t.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function ce(t,e,n){var r=Ae(t,e,(function(){return t.createShader(t.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(re(t,e,(function(){return t.shaderSource(r,n)})),re(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw console.log(t.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function le(t,e,n){var r=Ae(t,e,(function(){return t.createShader(t.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(re(t,e,(function(){return t.shaderSource(r,n)})),re(t,e,(function(){return t.compileShader(r)})),!1===t.getShaderParameter(r,t.COMPILE_STATUS))throw function(t,e){var n=pe.exec(e);if(null==n)return console.log("Couldn't parse line number in error: "+e),void console.log(t);for(var r=+n[1],a=t.split("\n"),i=a.length.toString().length+2,o=a.map((function(t,e){return M((e+1).toString(),i)+t})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),d=o.slice(r);console.log(c.join("\n")),console.log(e.split("\n")[0]),console.log("%c "+M(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join("\n"))}(n,t.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var de,he,pe=/ERROR: [0-9]+:([0-9]+):/g;function fe(t,e){return Ae(t,e,(function(){return t.createProgram()}),"Unable to create WebGLProgram.")}function me(t,e,n){if(re(t,e,(function(){return t.linkProgram(n)})),!1===t.getProgramParameter(n,t.LINK_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function ge(t,e,n){if(re(t,e,(function(){return t.validateProgram(n)})),!1===t.getProgramParameter(n,t.VALIDATE_STATUS))throw console.log(t.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function be(t,e,n){var r=Ae(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return re(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),re(t,e,(function(){return t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function ye(t,e,n){var r=Ae(t,e,(function(){return t.createBuffer()}),"Unable to create WebGLBuffer");return re(t,e,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r)})),re(t,e,(function(){return t.bufferData(t.ELEMENT_ARRAY_BUFFER,n,t.STATIC_DRAW)})),r}function ve(t,e){return Ae(t,e,(function(){return t.createTexture()}),"Unable to create WebGLTexture.")}function xe(t,e){var n=d().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){var r="["+t+"x"+e+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n)throw r="["+t+"x"+e+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function we(t,e){return Ae(t,e,(function(){return t.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function ke(t,e,n,r,a,i,o,s){var u=t.getAttribLocation(n,r);return-1!==u&&(re(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,a)})),re(t,e,(function(){return t.vertexAttribPointer(u,i,t.FLOAT,!1,o,s)})),re(t,e,(function(){return t.enableVertexAttribArray(u)})),!0)}function Se(t,e,n,r){Re(t,r),re(t,e,(function(){return t.activeTexture(t.TEXTURE0+r)})),re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)}))}function Oe(t,e,n,r){return Ae(t,e,(function(){return t.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function _e(t,e,n){return t.getUniformLocation(e,n)}function Ce(t,e,n,r,a,i){re(t,e,(function(){return Se(t,e,r,i)})),re(t,e,(function(){return t.uniform1i(a,i)}))}function Te(t,e,n,r){re(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,r)})),re(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}))}function Ie(t,e,n){re(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,n)})),re(t,e,(function(){return t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}))}function Ne(t){var e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Ee(t,e))}function Ee(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+e}}function Ae(t,e,n,r){var a=re(t,e,(function(){return n()}));if(null==a)throw new Error(r);return a}function Re(t,e){var n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function je(t,e){return void 0===e&&(e=2),A(t.slice(0,t.length-e))}function De(t){if(0===t.length)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Fe(t){var e=[1,1,1];return 0===t.length||1===t.length&&1===t[0]||(e=[je(t)].concat(De(t))),e}function Me(t,e){var n;void 0===e&&(e=!1);var r=d().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e&&(r*=2,1===(t=t.map((function(e,n){return n>=t.length-2?_(t[n]):t[n]}))).length&&(t=[2,t[0]])),2!==t.length){var a=B(t);t=a.newShape}var i=A(t);if(t.length<=1&&i<=r)return[1,i];if(2===t.length&&t[0]<=r&&t[1]<=r)return t;if(3===t.length&&t[0]*t[1]<=r&&t[2]<=r)return[t[0]*t[1],t[2]];if(3===t.length&&t[0]<=r&&t[1]*t[2]<=r)return[t[0],t[1]*t[2]];if(4===t.length&&t[0]*t[1]*t[2]<=r&&t[3]<=r)return[t[0]*t[1]*t[2],t[3]];if(4===t.length&&t[0]<=r&&t[1]*t[2]*t[3]<=r)return[t[0],t[1]*t[2]*t[3]];if(e){var o=je(t),s=2,u=2;return t.length&&(s=(n=De(t))[0],u=n[1]),F(i=o*(s/2)*(u/2)).map((function(t){return 2*t}))}return F(i)}function Pe(t){return t%2==0}function $e(t,e){if(R(t=t.slice(-2),e=e.slice(-2)))return!0;if(!t.length||!e.length)return!0;if(0===t[0]||0===t[1]||0===e[0]||0===e[1])return!0;if(t.length!==e.length){var n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r)return!0;if(Pe(n)&&Pe(r)&&(1===t[0]||1===e[0]))return!0}return t[1]===e[1]&&Pe(t[0])&&Pe(e[0])}function Le(t){if(null==de){var e=Zt(t);de=e.getParameter(e.MAX_TEXTURE_SIZE)}return de}function Be(t){if(null==he){var e=Zt(t);he=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,he)}function ze(t){if(0===t)return 0;var e=Zt(t);return We(e,"EXT_disjoint_timer_query_webgl2")&&2===t?2:We(e,"EXT_disjoint_timer_query")?1:0}function We(t,e){return null!=t.getExtension(e)}function Ve(t){try{if(null!=Zt(t))return!0}catch(t){return!1}return!1}function Ue(t){if(0===t)return!1;var e=Zt(t);if(1===t){if(!We(e,"OES_texture_float"))return!1}else if(!We(e,"EXT_color_buffer_float"))return!1;return He(e)}function Ge(t){if(0===t)return!1;var e=Zt(t);if(1!==t){if(We(e,"EXT_color_buffer_float"))return He(e);if(We(e,"EXT_color_buffer_half_float")){var n=e.getExtension("EXT_color_buffer_half_float");return function(t,e){var n=ne(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(a),i}(e,n)}return!1}return!!We(e,"OES_texture_float")&&!!We(e,"WEBGL_color_buffer_float")&&He(e)}function He(t){var e=ne(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);var r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(r),a}function qe(t){return 2===t&&null!=Zt(t).fenceSync}var Ke=Object.freeze({callAndCheck:re,canBeRepresented:oe,getWebGLErrorMessage:se,getExtensionOrThrow:ue,createVertexShader:ce,createFragmentShader:le,createProgram:fe,linkProgram:me,validateProgram:ge,createStaticVertexBuffer:be,createStaticIndexBuffer:ye,getNumChannels:function(){return 2===d().getNumber("WEBGL_VERSION")?1:4},createTexture:ve,validateTextureSize:xe,createFramebuffer:we,bindVertexBufferToProgramAttribute:ke,bindTextureUnit:Se,unbindTextureUnit:function(t,e,n){Re(t,n),re(t,e,(function(){return t.activeTexture(t.TEXTURE0+n)})),re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:Oe,getProgramUniformLocation:_e,bindTextureToProgramUniformSampler:Ce,bindCanvasToFramebuffer:function(t,e){re(t,e,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),re(t,e,(function(){return t.viewport(0,0,t.canvas.width,t.canvas.height)})),re(t,e,(function(){return t.scissor(0,0,t.canvas.width,t.canvas.height)}))},bindColorTextureToFramebuffer:Te,unbindColorTextureFromFramebuffer:Ie,validateFramebuffer:Ne,getFramebufferErrorMessage:Ee,getBatchDim:je,getRowsCols:De,getShapeAs3D:Fe,getTextureShapeFromLogicalShape:Me,isReshapeFree:$e,getWebGLMaxTextureSize:Le,resetMaxTextureSize:function(){de=null},resetMaxTexturesInShader:function(){he=null},getMaxTexturesInShader:Be,getWebGLDisjointQueryTimerVersion:ze,hasExtension:We,isWebGLVersionEnabled:Ve,isCapableOfRenderingToFloatTexture:Ue,isDownloadFloatTextureEnabled:Ge,isWebGLFenceEnabled:qe}),Xe=d();function Ye(){d().set("PROD",!0)}function Je(){d().set("DEBUG",!0)}function Ze(){d().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Qe(t){d().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function tn(){Vt.disposeVariables()}function en(){return Vt}function nn(){return Vt.memory()}function rn(t){return Vt.profile(t)}function an(t,e){return Vt.tidy(t,e)}function on(t){$t(t).forEach((function(t){return t.dispose()}))}function sn(t){return Vt.keep(t)}function un(t){return Vt.time(t)}function cn(t){return Vt.setBackend(t)}function ln(){return Vt.ready()}function dn(){return Vt.backendName}function hn(t){Vt.removeBackend(t)}function pn(t){return Vt.findBackend(t)}function fn(t){return Vt.findBackendFactory(t)}function mn(t,e,n){return void 0===n&&(n=1),Vt.registerBackend(t,e,n)}function gn(){return Vt.backend}function bn(t,e){d().setPlatform(t,e)}function yn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];d().getBool("IS_TEST")||console.warn.apply(console,t)}function vn(t,e){var n=t;if(H(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];for(var r=[];Array.isArray(n)||H(n)&&"string"!==e;)r.push(n.length),n=n[0];return Array.isArray(t)&&d().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function t(e,n,r){if(r=r||[],Array.isArray(e)||H(e)){T(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+e.length+" elements"})),T(e.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+e.length+" elements"}));for(var a=n.slice(1),i=0;i<e.length;++i)t(e[i],a,r.concat(i))}else T(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(t,r,[]),r}function xn(t,e,n,r){if(null!=t&&("numeric"!==t&&t!==e||"numeric"===t&&"string"===e))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+t+" tensor, but got "+e+" tensor")}function wn(t,e,n,r){if(void 0===r&&(r="numeric"),t instanceof Ct)return xn(r,t.dtype,e,n),t;var a=Z(t);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),xn(r,a,e,n),null==t||!H(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t){var i=null==t?"null":t.constructor.name;throw new Error("Argument '"+e+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=vn(t,a);H(t)||Array.isArray(t)||(t=[t]);var s="string"!==a?nt(t,a,d().getBool("DEBUG")):E(t,[],!0);return Vt.makeTensor(s,o,a)}function kn(t,e,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(t))throw new Error("Argument "+e+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return t.map((function(t,r){return wn(t,e+"["+r+"]",n)}),r)}function Sn(t,e){for(var n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function On(t,e,n){for(var r=t.length+e.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function _n(t,e){for(var n=[],r=t.length,a=0;a<r;a++)-1===e.indexOf(a)&&n.push(t[a]);return[n,e.map((function(e){return t[e]}))]}function Cn(t,e){return On(t,e.map((function(t){return 1})),e)}function Tn(t,e,n){T(Sn(e,n),(function(){return t+" supports only inner-most axes for now. Got axes "+e+" and rank-"+n+" input."}))}function In(t,e){if(Sn(t,e))return null;for(var n=[],r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach((function(t){return n.push(t)})),n}function Nn(t){return t.map((function(t,e){return[e,t]})).sort((function(t,e){return t[1]-e[1]})).map((function(t){return t[0]}))}function En(t,e){for(var n=[],r=e-t;r<e;++r)n.push(r);return n}function An(t,e){var n=t[0].length;t.forEach((function(t,e){T(t.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+e+"] must be the same as the rank of the rest ("+n+")"}))})),T(e>=0&&e<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=t[0];t.forEach((function(t,a){for(var i=0;i<n;i++)T(i===e||t[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+t+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."}))}))}function Rn(t,e){for(var n=t[0].slice(),r=1;r<t.length;r++)n[e]+=t[r][e];return n}function jn(t){var e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");var n=e[0],r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Vt.startScope(n);try{var a=r.apply(void 0,t);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Vt.endScope(a),a}catch(t){throw Vt.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}Xe.registerFlag("HAS_WEBGL",(function(){return Xe.getNumber("WEBGL_VERSION")>0})),Xe.registerFlag("WEBGL_VERSION",(function(){return Ve(2)?2:Ve(1)?1:0})),Xe.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Xe.get("WEBGL_VERSION")})),Xe.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Xe.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Xe.registerFlag("WEBGL_PACK",(function(){return Xe.getBool("HAS_WEBGL")})),Xe.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_CLIP",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Xe.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_PACK_REDUCE",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_CONV_IM2COL",(function(){return Xe.getBool("WEBGL_PACK")})),Xe.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return Le(Xe.getNumber("WEBGL_VERSION"))})),Xe.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return Be(Xe.getNumber("WEBGL_VERSION"))})),Xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var t=Xe.getNumber("WEBGL_VERSION");return 0===t?0:ze(t)})),Xe.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Xe.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(t=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))));var t})),Xe.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return Ue(Xe.getNumber("WEBGL_VERSION"))})),Xe.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Xe.getBool("WEBGL_FORCE_F16_TEXTURES")&&Xe.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Xe.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Ge(Xe.getNumber("WEBGL_VERSION"))})),Xe.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return qe(Xe.getNumber("WEBGL_VERSION"))})),Xe.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Xe.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),_t=Qe;var Dn=jn({complex_:function(t,e){var n=wn(t,"real","complex"),r=wn(e,"imag","complex");return I(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),Vt.runKernelFunc((function(t){return t.complex(n,r)}),{$real:n,$imag:r})}}),Fn=jn({real_:function(t){var e=wn(t,"input","real");return Vt.runKernelFunc((function(t){return t.real(e)}),{$input:e})}}),Mn=jn({imag_:function(t){var e=wn(t,"input","imag");return Vt.runKernelFunc((function(t){return t.imag(e)}),{$input:e})}});function Pn(t,e,n){return $n(t,e,vn(t,n),n)}function $n(t,e,n,r){if(null==r&&(r=Z(t)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!H(t)&&!Array.isArray(t)&&"number"!=typeof t&&"boolean"!=typeof t&&"string"!=typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){st(e);var a=A(e),i=A(n);T(a===i,(function(){return"Based on the provided shape, ["+e+"], the tensor should have "+a+" values but has "+i}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==A(e.slice(o));T(n[o]===e[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+e+"). "}))}}return H(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==r?nt(t,r,d().getBool("DEBUG")):E(t,[],!0),Vt.makeTensor(t,e,r)}function Ln(t,e){if((H(t)&&"string"!==e||Array.isArray(t))&&"complex64"!==e)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===e&&H(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return $n(t,[],[],e)}function Bn(t,e){N(t);var n=vn(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return $n(t,null,n,e)}function zn(t,e,n){if(N(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");var r=vn(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return $n(t,e,r,n)}function Wn(t,e,n){if(N(t),null!=e&&3!==e.length)throw new Error("tensor3d() requires shape to have three numbers");var r=vn(t,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return $n(t,e,r,n)}function Vn(t,e,n){if(N(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");var r=vn(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return $n(t,e,r,n)}function Un(t,e,n){if(N(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");var r=vn(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return $n(t,e,r,n)}function Gn(t,e,n){if(N(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");var r=vn(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return $n(t,e=e||r,r,n)}function Hn(t,e,n,r){return void 0===e&&(e=!0),Vt.makeVariable(t,e,n,r)}function qn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=qn(t,"float32"),r=Kn(t,"float32");return Dn(n,r)}var a=at(A(t),e);return Vt.makeTensor(a,t,e)}function Kn(t,e){if(void 0===e&&(e="float32"),"complex64"===e){var n=Kn(t,"float32"),r=Kn(t,"float32");return Dn(n,r)}var a=it(A(t),e);return Vt.makeTensor(a,t,e)}function Xn(t,e,n){return Vt.runKernelFunc((function(r){return r.fill(t,e,n)}),{})}function Yn(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");return Vt.runKernelFunc((function(r){return r.linspace(t,e,n)}),{})}function Jn(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(t===e||t<e&&n<0||e<t&&n>1)return Kn([0],r);var a=it(Math.abs(Math.ceil((e-t)/n)),r);e<t&&1===n&&(n=-1),a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return Bn(a,r)}var Zn=jn({onesLike_:function(t){var e=wn(t,"x","onesLike");if("complex64"===e.dtype){var n=Zn(Fn(e)),r=Qn(Mn(e));return Dn(n,r)}return Vt.runKernelFunc((function(t){return t.onesLike(e)}),{x:e},(function(t,e){return{x:function(){return Qn(t)}}}),"OnesLike")}}),Qn=jn({zerosLike_:function(t){var e=wn(t,"x","zerosLike");return Vt.runKernelFunc((function(t){return t.zerosLike(e)}),{x:e},(function(t,e){return{x:function(){return Qn(t)}}}),"ZerosLike")}}),tr=jn({concat_:function(t,e){void 0===e&&(e=0),T(t.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=kn(t,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(t){if("complex64"!==t.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+t.dtype+". ")})),e=L(e,n[0].shape)[0];var r=Rn(n.map((function(t){return t.shape})),e);if(0===A(r))return Pn([],r);if(1===(n=n.filter((function(t){return t.size>0}))).length)return n[0];var a=n.map((function(t){return t.shape}));An(a,e);var i=n,o={axis:e};return Vt.runKernelFunc((function(t){return t.concat(n,e)}),i,(function(t){var n=a.map((function(t){return t[e]}));return ir(t,n,e).map((function(t){return function(){return t}}))}),"Concat",o)}}),er=jn({concat1d_:function(t){return tr(t,0)}}),nr=jn({concat2d_:function(t,e){return tr(t,e)}}),rr=jn({concat3d_:function(t,e){return tr(t,e)}}),ar=jn({concat4d_:function(t,e){return tr(t,e)}}),ir=jn({split_:function(t,e,n){void 0===n&&(n=0);var r,a=wn(t,"x","split");return n=L(n,a.shape)[0],"number"==typeof e?(T(a.shape[n]%e==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(e).fill(a.shape[n]/e)):(T(a.shape[n]===e.reduce((function(t,e){return t+e})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=e),Vt.runKernelFunc((function(t){return t.split(a,r,n)}),{$x:a},(function(t){return{$x:function(){return tr(t,n)}}}))}});function or(t,e,n){return void 0===e&&(e="float32"),e=e||"float32",st(t),new kt(t,e,n)}function sr(t,e){void 0===e&&(e=!1),console.log(t.toString(e))}var ur=jn({batchToSpaceND_:function(t,e,n){var r=wn(t,"x","batchToSpaceND"),a=e.reduce((function(t,e){return t*e}));return T(r.rank>=1+e.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+e.length})),T(n.length===e.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+e.length})),T(r.shape[0]%a==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+e.join(" * ")+" === "+a})),Vt.runKernelFunc((function(t){return t.batchToSpaceND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.spaceToBatchND(e,n)}}}))}}),cr=jn({cast_:function(t,e){var n=wn(t,"x","cast");if(!U(e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:e};return Vt.runKernelFunc((function(t){return t.cast(n,e)}),{x:n},(function(t){return{x:function(){return t.clone()}}}),"Cast",r)}}),lr=jn({cumsum_:function(t,e,n,r){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=wn(t,"x","cumsum"),i=In([e|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=En(1,a.rank)[0],u=Vt.runKernelFunc((function(t){return t.cumsum(o,s,n,r)}),{permutedX:o},(function(t){return{permutedX:function(){return t.cumsum(e,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),dr=jn({depthToSpace_:function(t,e,n){void 0===n&&(n="NHWC");var r=wn(t,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return T(a*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+e+"  for depthToSpace with input shape\n      "+r.shape})),T(i*e>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+e+" for depthToSpace with input shape\n          "+r.shape})),T(o%(e*e)==0,(function(){return"Dimension size must be evenly divisible by "+e*e+" but is "+o+" for depthToSpace with input shape "+r.shape})),Vt.runKernelFunc((function(t){return t.depthToSpace(r,e,n)}),{$x:r})}}),hr=jn({expandDims_:function(t,e){void 0===e&&(e=0);var n=wn(t,"x","expandDims",null);T(e<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return e<0&&(T(-(n.rank+1)<=e,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),e=n.rank+e+1),r.splice(e,0,1),pr(n,r)}}),pr=jn({reshape_:function(t,e){var n=wn(t,"x","reshape",null);e=$(e,n.size),T(n.size===A(e),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:e};return Vt.runKernelFunc((function(t){return t.reshape(n,e)}),{x:n},(function(t){return{x:function(){return t.reshape(n.shape)}}}),"Reshape",r)}}),fr=jn({spaceToBatchND_:function(t,e,n){var r=wn(t,"x","spaceToBatchND");return T(r.rank>=1+e.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+e.length})),T(n.length===e.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+e.length})),T(r.shape.reduce((function(t,r,a){return a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]==0:t}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+e.toString()})),Vt.runKernelFunc((function(t){return t.spaceToBatchND(r,e,n)}),{$x:r},(function(t){return{$x:function(){return t.batchToSpaceND(e,n)}}}))}}),mr=jn({squeeze_:function(t,e){var n=wn(t,"x","squeeze");return pr(n,B(n.shape,e).newShape)}}),gr=jn({stack_:function(t,e){void 0===e&&(e=0);var n=kn(t,"tensors","stack");if(T(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(e);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;T(e<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(t){I(a,t.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(t){T(i===t.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(t){return t.expandDims(e)}));return tr(o,e)}}),br=jn({unstack_:function(t,e){void 0===e&&(e=0),e=e||0;var n=wn(t,"x","unstack");T(e>=-n.shape.length&&e<n.shape.length,(function(){return"Axis = "+e+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),e<0&&(e+=n.shape.length);var r={axis:e};return Vt.runKernelFunc((function(t){return t.unstack(n,e)}),{x:n},(function(t){return{x:function(){return gr(t,e)}}}),"Unpack",r)}}),yr=function(t,e){return s(this,void 0,void 0,(function(){var n,r,a,i,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:return n=wn(t,"x","setdiff1d"),r=wn(e,"y","setdiff1d"),T(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),T(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),T(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return a=u.sent(),[4,r.data()];case 2:for(i=u.sent(),o=new Set(i),s=0,d=0;d<a.length;d++)o.has(a[d])||s++;for(c=new kt([s],n.dtype),l=new kt([s],"int32"),d=0,h=0;d<a.length;d++)o.has(a[d])||(c.values[h]=a[d],l.values[h]=d,h++);return[2,[c.toTensor(),l.toTensor()]]}}))}))};function vr(t,e,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(e.slice(0))).push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);for(var i=e.length,o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function xr(t,e,n){void 0===n&&(n=!0);var r=[];if(n){r.push(e);for(var a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<t;++a)a>=2*e+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function wr(t,e,n,r){void 0===r&&(r=!0);var a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(var i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function kr(t,e){for(var n=[0],r=0;r<e;++r)n.push(t[r][0]);return n}function Sr(t,e,n){for(var r=t.slice(0,1),a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}var Or="Add",_r="AddN",Cr="Div",Tr="FusedBatchNorm",Ir="SquaredDifference",Nr="Square",Er="Transpose",Ar="NonMaxSuppressionV5",Rr="BroadcastTo",jr="OneHot",Dr="Identity",Fr="Tile",Mr="PadV2",Pr="FromPixels",$r="MaxPoolWithArgmax",Lr=jn({add_:function(t,e){var n,r=wn(t,"a","add"),a=wn(e,"b","add");n=Mt(r,a),r=n[0],a=n[1];var i={a:r,b:a};return Vt.runKernelFunc((function(t,e){var n=t.add(r,a);return e([r,a]),n}),i,null,Or)}});function Br(t,e){for(var n=t.length,r=[],a=0;a<n;a++){var i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function zr(t,e){for(var n=[],r=0;r<e.length;r++){var a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function Wr(t,e){for(var n=[],r=Math.max(t.length,e.length),a=0;a<r;a++){var i=t[t.length-a-1];null==i&&(i=1);var o=e[e.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+t+" and "+e+".");n.unshift(i)}}return n}var Vr=jn({abs_:function(t){var e=wn(t,"x","abs");return"complex64"===e.dtype?Vt.runKernelFunc((function(t){return t.complexAbs(e)}),{$x:e}):Vt.runKernelFunc((function(t,n){var r=t.abs(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().step(-1))}}}),"Abs")}}),Ur=jn({acos_:function(t){var e=wn(t,"x","acos");return Vt.runKernelFunc((function(t,n){var r=t.acos(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Ln(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Gr=jn({acosh_:function(t){var e=wn(t,"x","acosh");return Vt.runKernelFunc((function(t,n){var r=t.acosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Hr=jn({asin_:function(t){var e=wn(t,"x","asin");return Vt.runKernelFunc((function(t,n){var r=t.asin(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Ln(1).sub(n.toFloat().square()).sqrt())}}}))}}),qr=jn({asinh_:function(t){var e=wn(t,"x","asinh");return Vt.runKernelFunc((function(t,n){var r=t.asinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.divStrict(Ln(1).add(n.toFloat().square()).sqrt())}}}))}}),Kr=jn({atan_:function(t){var e=wn(t,"x","atan");return Vt.runKernelFunc((function(t,n){var r=t.atan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().square().add(1))}}}))}}),Xr=jn({atanh_:function(t){var e=wn(t,"x","atanh");return Vt.runKernelFunc((function(t,n){var r=t.atanh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(Ln(1).sub(n.toFloat().square()))}}}))}}),Yr=jn({ceil_:function(t){var e=wn(t,"x","ceil");return Vt.runKernelFunc((function(t){return t.ceil(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),Jr=jn({clipByValue_:function(t,e,n){var r=wn(t,"x","clipByValue");T(e<=n,(function(){return"Error in clip: min ("+e+") must be less than or equal to max ("+n+")."}));var a=[r],i={min:e,max:n};return Vt.runKernelFunc((function(t,a){var i=t.clip(r,e,n);return a([r]),i}),{x:r},(function(t,r){var a=r[0];return{x:function(){return t.where(a.greaterEqual(e).logicalAnd(a.lessEqual(n)),Qn(t))}}}),"ClipByValue",i,a)}}),Zr=jn({cos_:function(t){var e=wn(t,"x","cos"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.cos(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().sin().neg().mul(t)}}}),"Cos",{},n)}}),Qr=jn({cosh_:function(t){var e=wn(t,"x","cosh");return Vt.runKernelFunc((function(t,n){var r=t.cosh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().sinh().mulStrict(t)}}}))}}),ta=jn({erf_:function(t){var e=wn(t,"x","erf");return T("int32"===e.dtype||"float32"===e.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===e.dtype&&(e=e.toFloat()),Vt.runKernelFunc((function(t,n){var r=t.erf(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),ea=jn({exp_:function(t){var e=wn(t,"x","exp");return Vt.runKernelFunc((function(t,n){var r=t.exp(e);return n([r]),r}),{x:e},(function(t,e){return{x:function(){return t.mulStrict(e[0])}}}),"Exp",{},[],[!0])}}),na=jn({expm1_:function(t){var e=wn(t,"x","expm1");return Vt.runKernelFunc((function(t,n){var r=t.expm1(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.exp())}}}))}}),ra=jn({floor_:function(t){var e=wn(t,"x","floor");return Vt.runKernelFunc((function(t){return t.floor(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),aa=jn({log_:function(t){var e=wn(t,"x","log"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.log(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.toFloat())}}}),"Log",{},n)}}),ia=jn({log1p_:function(t){var e=wn(t,"x","log1p");return Vt.runKernelFunc((function(t,n){var r=t.log1p(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.add(1))}}}))}}),oa=jn({logSigmoid_:function(t){var e=wn(t,"x","logSigmoid");return Vt.runKernelFunc((function(t,n){var r=t.softplus(e.neg()).neg();return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.neg().sigmoid())}}}))}}),sa=jn({neg_:function(t){var e=wn(t,"x","neg"),n=[e];return Vt.runKernelFunc((function(t){return t.neg(e)}),{x:e},(function(t){return{x:function(){return t.neg()}}}),"Neg",{},n)}}),ua=jn({reciprocal_:function(t){var e=wn(t,"x","reciprocal");return Vt.runKernelFunc((function(t,n){var r=t.reciprocal(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.square().neg())}}}))}}),ca=jn({round_:function(t){var e=wn(t,"x","round");return Vt.runKernelFunc((function(t){return t.round(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),la=jn({rsqrt_:function(t){var e=wn(t,"x","rsqrt"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.rsqrt(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),da=jn({sigmoid_:function(t){var e=wn(t,"x","sigmoid");return Vt.runKernelFunc((function(t,n){var r=t.sigmoid(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mul(n.mul(Ln(1).sub(n)))}}}),"Sigmoid")}}),ha=jn({sign_:function(t){var e=wn(t,"x","sign");return Vt.runKernelFunc((function(t){return t.sign(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),pa=jn({isNaN_:function(t){var e=wn(t,"x","isNaN");return Vt.runKernelFunc((function(t){return t.isNaN(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),fa=jn({isInf_:function(t){var e=wn(t,"x","isInf");return Vt.runKernelFunc((function(t){return t.isInf(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),ma=jn({isFinite_:function(t){var e=wn(t,"x","isFinite");return Vt.runKernelFunc((function(t){return t.isFinite(e)}),{$x:e},(function(t){return{$x:function(){return Qn(t)}}}))}}),ga=jn({sin_:function(t){var e=wn(t,"x","sin"),n=[e];return Vt.runKernelFunc((function(t,n){var r=t.sin(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return n.toFloat().cos().mul(t)}}}),"Sin",{},n)}}),ba=jn({sinh_:function(t){var e=wn(t,"x","sinh");return Vt.runKernelFunc((function(t,n){var r=t.sinh(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return n.toFloat().cosh().mulStrict(t)}}}))}}),ya=jn({softplus_:function(t){var e=wn(t,"x","softplus");return Vt.runKernelFunc((function(t,n){var r=t.softplus(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.mul(n.sigmoid())}}}))}}),va=jn({sqrt_:function(t){var e=wn(t,"x","sqrt");return Vt.runKernelFunc((function(t,n){var r=t.sqrt(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.toFloat().sqrt().mul(2))}}}))}}),xa=jn({step_:function(t,e){void 0===e&&(e=0);var n=wn(t,"x","step");return Vt.runKernelFunc((function(t){return t.step(n,e)}),{$x:n},(function(t){return{$x:function(){return Qn(t)}}}))}}),wa=jn({tan_:function(t){var e=wn(t,"x","tan");return Vt.runKernelFunc((function(t,n){var r=t.tan(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return t.div(n.cos().square())}}}))}}),ka=jn({tanh_:function(t){var e=wn(t,"x","tanh");return Vt.runKernelFunc((function(t,n){var r=t.tanh(e);return n([r]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return Ln(1).sub(n.square()).mulStrict(t)}}}),"Tanh",{},null,[!0])}}),Sa=jn({addStrict_:function(t,e){var n=wn(t,"a","addStrict"),r=wn(e,"b","addStrict");return I(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),Oa=jn({atan2_:function(t,e){var n,r=wn(t,"a","atan2"),a=wn(e,"b","atan2");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape);return Vt.runKernelFunc((function(t,e){var n=t.atan2(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=Lr(n.square(),r.square()),a=t.mul(r.div(e)),o=zr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var e=Lr(n.square(),r.square()),a=sa(t.mul(n.div(e))),o=zr(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}))}}),_a=jn({divStrict_:function(t,e){var n=wn(t,"a","div"),r=wn(e,"b","div");return I(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Ca=jn({floorDiv_:function(t,e){var n,r=wn(t,"a","floorDiv"),a=wn(e,"b","floorDiv");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape);return Vt.runKernelFunc((function(t,e){var n=t.floorDiv(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.div(r.toFloat()),a=zr(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=zr(r.shape,i);a.length>0&&(e=e.sum(a).reshape(r.shape));var o=r.square();return e.div(o.toFloat()).neg()}}}),"FloorDiv")}}),Ta=jn({maximum_:function(t,e){var n,r=wn(t,"a","maximum"),a=wn(e,"b","maximum");return n=Mt(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Wr(r.shape,a.shape),Vt.runKernelFunc((function(t,e){var n=t.maximum(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.greaterEqual(r).toFloat())},b:function(){return t.mul(n.less(r).toFloat())}}}),"Maximum")}}),Ia=jn({maximumStrict_:function(t,e){var n=wn(t,"a","maximumStrict"),r=wn(e,"b","maximumStrict");return I(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Na=jn({minimum_:function(t,e){var n,r=wn(t,"a","minimum"),a=wn(e,"b","minimum");return n=Mt(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),Wr(r.shape,a.shape),Vt.runKernelFunc((function(t,e){var n=t.minimum(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){return t.mul(n.lessEqual(r).toFloat())},b:function(){return t.mul(n.greater(r).toFloat())}}}),"Minimum")}}),Ea=jn({minimumStrict_:function(t,e){var n=wn(t,"a","minimumStrict"),r=wn(e,"b","minimumStrict");return I(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Aa=jn({mod_:function(t,e){var n,r=wn(t,"a","mod"),a=wn(e,"b","mod");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape);return Vt.runKernelFunc((function(t,e){var n=t.mod(r,a);return e([r,a]),n}),{$a:r,$b:a},(function(t,e){var n=e[0],r=e[1];return{$a:function(){var e=zr(n.shape,i);return e.length>0?t.sum(e).reshape(n.shape):t},$b:function(){var e=t.mul(n.div(r).floor().neg()),a=zr(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}}))}}),Ra=jn({modStrict_:function(t,e){var n=wn(t,"a","modStrict"),r=wn(e,"b","modStrict");return I(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),ja=jn({mul_:function(t,e){var n,r=wn(t,"a","mul"),a=wn(e,"b","mul");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape);return Vt.runKernelFunc((function(t,e){var n=t.multiply(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){var e=t.mul(r.toFloat()),a=zr(n.shape,i);return a.length>0?e.sum(a).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),a=zr(r.shape,i);return a.length>0?e.sum(a).reshape(r.shape):e}}}),"Mul")}}),Da=jn({mulStrict_:function(t,e){var n=wn(t,"a","mul"),r=wn(e,"b","mul");return I(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Fa=jn({pow_:function(t,e){var n,r=wn(t,"base","pow"),a=wn(e,"exp","pow");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape),o=[r,a];return Vt.runKernelFunc((function(t,e){var n=t.pow(r,a);return e([r,a,n]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1],a=e[2];return{a:function(){var e=r.toFloat(),a=t.mul(e.mul(n.pow(e.sub(Ln(1))))),o=zr(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var e=n.greater(0),o=n.log().where(e,Qn(n)),s=t.mul(a.mul(o)),u=zr(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},o,[!0])}}),Ma=jn({powStrict_:function(t,e){return I(t.shape,e.shape,"Error in powStrict: "),t.pow(e)}}),Pa=jn({squaredDifferenceStrict_:function(t,e){var n=wn(t,"a","squaredDifferenceStrict"),r=wn(e,"b","squaredDifferenceStrict");return I(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),$a=jn({sub_:function(t,e){var n,r=wn(t,"a","sub"),a=wn(e,"b","sub");n=Mt(r,a),r=n[0],a=n[1];var i=Wr(r.shape,a.shape);return Vt.runKernelFunc((function(t){return t.subtract(r,a)}),{a:r,b:a},(function(t){return{a:function(){var e=t,n=zr(r.shape,i);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)},b:function(){var e=t,n=zr(a.shape,i);return n.length>0&&(e=e.sum(n)),e.neg().reshape(a.shape)}}}),"Sub")}}),La=jn({subStrict_:function(t,e){var n=wn(t,"a","subStrict"),r=wn(e,"b","subStrict");return I(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Ba=jn({div_:function(t,e){var n,r=wn(t,"a","div"),a=wn(e,"b","div");if(n=Mt(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return Ca(r,a);var i={a:r,b:a};return Vt.runKernelFunc((function(t,e){var n=t.realDivide(r,a);return e([r,a]),n}),i,null,Cr,{})}});function za(t,e){if(t.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==e.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.shape[e.rank-1]>t.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+e.shape[e.rank-1]+" vs. "+t.rank);if(0===t.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+t.shape+".");for(var n=e.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=t.shape,s=n.slice();s.pop();var u=1;for(i=r;i<t.rank;++i)u*=o[i],s.push(o[i]);var c=et(t.shape).map((function(t){return t/u})).concat([1]).slice(0,r);return[s,a,u,c]}var Wa=Object.freeze({prepareAndValidate:za}),Va=30;function Ua(t){return t<=Va?t:tt(t,Math.floor(Math.sqrt(t)))}function Ga(t,e,n){var r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+e.shape+", shape: "+t+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != "+(a+t.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+e.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+t[o+a]+")")}function Ha(t,e,n){if(e.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}Ga(n,e,t)}function qa(t,e,n){for(var r=e.shape.length,a=r>1?e.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:A(e.shape)/u,sliceSize:o,strides:et(n.slice(0,a)).concat([1]),outputSize:A(n)}}var Ka=Object.freeze({validateUpdateShape:Ga,validateInput:Ha,calculateShapes:qa});function Xa(t,e,n){T(t.rank===e.length,(function(){return"Error in slice"+t.rank+"D: Length of begin "+e+" must match the rank of the array ("+t.rank+")."})),T(t.rank===n.length,(function(){return"Error in slice"+t.rank+"D: Length of size "+n+" must match the rank of the array ("+t.rank+")."}));for(var r=function(r){T(e[r]+n[r]<=t.shape[r],(function(){return"Error in slice"+t.rank+"D: begin["+r+"] + size["+r+"] ("+(e[r]+n[r])+") would overflow input.shape["+r+"] ("+t.shape[r]+")"}))},a=0;a<t.rank;++a)r(a)}function Ya(t){for(var e=[],n=0;t>0;)1&t&&e.push(n),t/=2,n++;return e}function Ja(t,e,n){for(var r=[],a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function Za(t,e,n,r,a){var i=e[a],o=n[a]||1;(t&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),O(0,i,s-1)}function Qa(t,e,n,r,a){var i=e[a],o=n[a]||1;(t&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?O(0,i,s):O(-1,i,s-1)}function ti(t,e,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function ei(t,e){for(var n=t.length>0?t[t.length-1]:1,r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}var ni=Object.freeze({assertParamsValid:Xa,maskToAxes:Ya,computeOutShape:Ja,startForAxis:Za,stopForAxis:Qa,isSliceContinous:ti,computeFlatOffset:ei});function ri(t){return T(Q(t),(function(){return"The f passed in grad(f) must be a function"})),function(e,n){var r=wn(e,"x","tf.grad",null),a=null!=n?wn(n,"dy","tf.grad"):null;return Vt.tidy((function(){var e=Vt.gradients((function(){return t(r)}),[r],a),n=e.value,i=e.grads;return null!=a&&I(n.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ci(i),i[0]}))}}function ai(t){return T(Q(t),(function(){return"The f passed in grads(f) must be a function"})),function(e,n){T(Array.isArray(e),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=kn(e,"args","tf.grads",null),a=null!=n?wn(n,"dy","tf.grads"):null;return Vt.tidy((function(){var e=Vt.gradients((function(){return t.apply(void 0,r)}),r,a),n=e.value,i=e.grads;return null!=a&&I(n.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ci(i),i}))}}function ii(t){return T(Q(t),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(e,n){T(e instanceof Ct,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),T(null==n||n instanceof Ct,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=Vt.gradients((function(){return t(e)}),[e],n),a=r.grads,i=r.value;return ci(a),{grad:a[0],value:i}}}function oi(t){return T(Q(t),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(e,n){T(Array.isArray(e)&&e.every((function(t){return t instanceof Ct})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),T(null==n||n instanceof Ct,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=Vt.gradients((function(){return t.apply(void 0,e)}),e,n);return null!=n&&I(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ci(r.grads),r}}function si(t,e){T(Q(t),(function(){return"The f passed in variableGrads(f) must be a function"})),T(null==e||Array.isArray(e)&&e.every((function(t){return t instanceof Rt})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=e;if(!n)for(var r in e=[],Vt.registeredVariables)e.push(Vt.registeredVariables[r]);var a=n?e.filter((function(t){return!t.trainable})):null,i=e.length;T((e=e.filter((function(t){return t.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var o=Vt.gradients(t,e,null,!0),s=o.value,u=o.grads;T(u.some((function(t){return null!=t})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),T(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return e.forEach((function(t,e){null!=u[e]&&(c[t.name]=u[e])})),null!=a&&a.forEach((function(t){return c[t.name]=null})),{value:s,grads:c}}function ui(t){return Vt.customGrad(t)}function ci(t){if(t.filter((function(t){return null==t})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}var li=jn({softmax_:function(t,e){void 0===e&&(e=-1);var n=wn(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+e);return Vt.runKernelFunc((function(t,r){var a=t.softmax(n,e);return r([a]),a}),{logits:n},(function(t,n){var r=n[0],a=t.mul(r);return{logits:function(){return a.sub(a.sum([e],!0).mul(r))}}}),"Softmax",{dim:e},[],[!0])}}),di=jn({logSoftmax_:function(t,e){void 0===e&&(e=-1);var n=wn(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+e);return ui((function(t,n){var r=t.max(e,!0),a=t.sub(r),i=a.toFloat().sub(a.exp().sum(e,!0).log());return n([i]),{value:i,gradFunc:function(t,n){var r=n[0].exp();return t.sub(t.sum(e,!0).mul(r))}}}))(n)}}),hi=jn({transpose_:function(t,e){var n=wn(t,"x","transpose");if(null==e&&(e=n.shape.map((function(t,e){return e})).reverse()),T(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+e+"."})),e.forEach((function(t){T(t>=0&&t<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+e}))})),n.rank<=1)return n.clone();var r={perm:e};return Vt.runKernelFunc((function(t){return t.transpose(n,e)}),{x:n},null,"Transpose",r)}}),pi=function(){function t(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}return t.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},t.prototype.set=function(t,e){this.dataIdsCount++,this.data.set(t,e)},t.prototype.has=function(t){return this.data.has(t)},t.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},t.prototype.numDataIds=function(){return this.dataIdsCount},t}(),fi=function(){function t(){}return t.prototype.time=function(t){return mi("time")},t.prototype.read=function(t){return mi("read")},t.prototype.readSync=function(t){return mi("readSync")},t.prototype.numDataIds=function(){return mi("numDataIds")},t.prototype.disposeData=function(t){return mi("disposeData")},t.prototype.write=function(t,e,n){return mi("write")},t.prototype.move=function(t,e,n,r){return mi("move")},t.prototype.memory=function(){return mi("memory")},t.prototype.floatPrecision=function(){return mi("floatPrecision")},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.batchMatMul=function(t,e,n,r){return mi("batchMatMul")},t.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,mi("fusedBatchMatMul")},t.prototype.slice=function(t,e,n){return mi("slice")},t.prototype.stridedSlice=function(t,e,n,r){return mi("stridedSlice")},t.prototype.unstack=function(t,e){return mi("unstack")},t.prototype.reverse=function(t,e){return mi("reverse")},t.prototype.concat=function(t,e){return mi("concat")},t.prototype.neg=function(t){return mi("neg")},t.prototype.add=function(t,e){return mi("add")},t.prototype.addN=function(t){return mi("addN")},t.prototype.subtract=function(t,e){return mi("subtract")},t.prototype.multiply=function(t,e){return mi("multiply")},t.prototype.realDivide=function(t,e){return mi("realDivide")},t.prototype.floorDiv=function(t,e){return mi("floorDiv")},t.prototype.sum=function(t,e){return mi("sum")},t.prototype.prod=function(t,e){return mi("prod")},t.prototype.unsortedSegmentSum=function(t,e,n){return mi("unsortedSegmentSum")},t.prototype.argMin=function(t,e){return mi("argMin")},t.prototype.argMax=function(t,e){return mi("argMax")},t.prototype.equal=function(t,e){return mi("equal")},t.prototype.notEqual=function(t,e){return mi("notEqual")},t.prototype.less=function(t,e){return mi("less")},t.prototype.lessEqual=function(t,e){return mi("lessEqual")},t.prototype.greater=function(t,e){return mi("greater")},t.prototype.greaterEqual=function(t,e){return mi("greaterEqual")},t.prototype.logicalNot=function(t){return mi("logicalNot")},t.prototype.logicalAnd=function(t,e){return mi("logicalAnd")},t.prototype.logicalOr=function(t,e){return mi("logicalOr")},t.prototype.where=function(t){return mi("where")},t.prototype.select=function(t,e,n){return mi("select")},t.prototype.topk=function(t,e,n){return mi("topk")},t.prototype.min=function(t,e){return mi("min")},t.prototype.minimum=function(t,e){return mi("minimum")},t.prototype.mod=function(t,e){return mi("mod")},t.prototype.max=function(t,e){return mi("max")},t.prototype.maximum=function(t,e){return mi("maximum")},t.prototype.all=function(t,e){return mi("all")},t.prototype.any=function(t,e){return mi("any")},t.prototype.squaredDifference=function(t,e){return mi("squaredDifference")},t.prototype.ceil=function(t){return mi("ceil")},t.prototype.floor=function(t){return mi("floor")},t.prototype.round=function(t){return mi("round")},t.prototype.sign=function(t){return mi("sign")},t.prototype.isNaN=function(t){return mi("isNaN")},t.prototype.isInf=function(t){return mi("isInf")},t.prototype.isFinite=function(t){return mi("isFinite")},t.prototype.pow=function(t,e){return mi("pow")},t.prototype.exp=function(t){return mi("exp")},t.prototype.expm1=function(t){return mi("expm1")},t.prototype.softmax=function(t,e){return mi("softmax")},t.prototype.log=function(t){return mi("log")},t.prototype.log1p=function(t){return mi("log1p")},t.prototype.sqrt=function(t){return mi("sqrt")},t.prototype.rsqrt=function(t){return mi("rsqrt")},t.prototype.square=function(t){return mi("square")},t.prototype.reciprocal=function(t){return mi("reciprocal")},t.prototype.relu=function(t){return mi("relu")},t.prototype.relu6=function(t){return mi("relu6")},t.prototype.prelu=function(t,e){return mi("prelu")},t.prototype.elu=function(t){return mi("elu")},t.prototype.eluDer=function(t,e){return mi("eluDer")},t.prototype.selu=function(t){return mi("selu")},t.prototype.int=function(t){return mi("int")},t.prototype.clip=function(t,e,n){return mi("clip")},t.prototype.abs=function(t){return mi("abs")},t.prototype.complexAbs=function(t){return mi("complexAbs")},t.prototype.sigmoid=function(t){return mi("sigmoid")},t.prototype.softplus=function(t){return mi("softplus")},t.prototype.sin=function(t){return mi("sin")},t.prototype.cos=function(t){return mi("cos")},t.prototype.tan=function(t){return mi("tan")},t.prototype.asin=function(t){return mi("asin")},t.prototype.acos=function(t){return mi("acos")},t.prototype.atan=function(t){return mi("atan")},t.prototype.atan2=function(t,e){return mi("atan2")},t.prototype.sinh=function(t){return mi("sinh")},t.prototype.cosh=function(t){return mi("cosh")},t.prototype.tanh=function(t){return mi("tanh")},t.prototype.asinh=function(t){return mi("asinh")},t.prototype.acosh=function(t){return mi("acosh")},t.prototype.atanh=function(t){return mi("atanh")},t.prototype.erf=function(t){return mi("erf")},t.prototype.step=function(t,e){return mi("step")},t.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,mi("fusedConv2d")},t.prototype.conv2d=function(t,e,n){return mi("conv2d")},t.prototype.conv2dDerInput=function(t,e,n){return mi("conv2dDerInput")},t.prototype.conv2dDerFilter=function(t,e,n){return mi("conv2dDerFilter")},t.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,mi("fusedDepthwiseConv2D")},t.prototype.depthwiseConv2D=function(t,e,n){return mi("depthwiseConv2D")},t.prototype.depthwiseConv2DDerInput=function(t,e,n){return mi("depthwiseConv2DDerInput")},t.prototype.depthwiseConv2DDerFilter=function(t,e,n){return mi("depthwiseConv2DDerFilter")},t.prototype.conv3d=function(t,e,n){return mi("conv3d")},t.prototype.conv3dDerInput=function(t,e,n){return mi("conv3dDerInput")},t.prototype.conv3dDerFilter=function(t,e,n){return mi("conv3dDerFilter")},t.prototype.maxPool=function(t,e){return mi("maxPool")},t.prototype.maxPoolBackprop=function(t,e,n,r){return mi("maxPoolBackprop")},t.prototype.avgPool=function(t,e){return mi("avgPool")},t.prototype.avgPoolBackprop=function(t,e,n){return mi("avgPoolBackprop")},t.prototype.avgPool3d=function(t,e){return mi("avgPool3d")},t.prototype.avgPool3dBackprop=function(t,e,n){return mi("avgPool3dBackprop")},t.prototype.maxPool3d=function(t,e){return mi("maxPool3d")},t.prototype.maxPool3dBackprop=function(t,e,n,r){return mi("maxPool3dBackprop")},t.prototype.reshape=function(t,e){return mi("reshape")},t.prototype.cast=function(t,e){return mi("cast")},t.prototype.tile=function(t,e){return mi("tile")},t.prototype.pad=function(t,e,n){return mi("pad")},t.prototype.transpose=function(t,e){return mi("transpose")},t.prototype.gather=function(t,e,n){return mi("gather")},t.prototype.gatherND=function(t,e){return mi("gatherND")},t.prototype.scatterND=function(t,e,n){return mi("scatterND")},t.prototype.batchToSpaceND=function(t,e,n){return mi("batchToSpaceND")},t.prototype.spaceToBatchND=function(t,e,n){return mi("spaceToBatchND")},t.prototype.resizeBilinear=function(t,e,n,r){return mi("resizeBilinear")},t.prototype.resizeBilinearBackprop=function(t,e,n){return mi("resizeBilinearBackprop")},t.prototype.resizeNearestNeighbor=function(t,e,n,r){return mi("resizeNearestNeighbor")},t.prototype.resizeNearestNeighborBackprop=function(t,e,n){return mi("resizeNearestNeighborBackprop")},t.prototype.batchNormalization=function(t,e,n,r,a,i){return mi("batchNormalization")},t.prototype.localResponseNormalization4D=function(t,e,n,r,a){return mi("localResponseNormalization4D")},t.prototype.LRNGrad=function(t,e,n,r,a,i,o){return mi("LRNGrad")},t.prototype.multinomial=function(t,e,n,r){return mi("multinomial")},t.prototype.oneHot=function(t,e,n,r){return mi("oneHot")},t.prototype.cumsum=function(t,e,n,r){return mi("cumsum")},t.prototype.nonMaxSuppression=function(t,e,n,r,a){return mi("nonMaxSuppression")},t.prototype.fft=function(t){return mi("fft")},t.prototype.ifft=function(t){return mi("ifft")},t.prototype.complex=function(t,e){return mi("complex")},t.prototype.real=function(t){return mi("real")},t.prototype.imag=function(t){return mi("imag")},t.prototype.cropAndResize=function(t,e,n,r,a,i){return mi("cropAndResize")},t.prototype.depthToSpace=function(t,e,n){return mi("depthToSpace")},t.prototype.split=function(t,e,n){return mi("split")},t.prototype.sparseToDense=function(t,e,n,r){return mi("sparseToDense")},t.prototype.diag=function(t){return mi("diag")},t.prototype.fill=function(t,e,n){return mi("fill")},t.prototype.onesLike=function(t){return mi("onesLike")},t.prototype.zerosLike=function(t){return mi("zerosLike")},t.prototype.linspace=function(t,e,n){return mi("linspace")},t.prototype.dispose=function(){return mi("dispose")},t}();function mi(t){throw new Error("'"+t+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function gi(t,e,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,u=wi(e),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,t[3],t[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,t[1],t[1]]}return yi(t,s,n,r,a,i,!1,o)}function bi(t,e,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,u,c=ki(e),l=c[0],d=c[1],h=c[2];if("NDHWC"===o)u="channelsLast",s=[l,d,h,t[4],t[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,d,h,t[1],t[1]]}return vi(t,s,n,r,a,!1,u,i)}function yi(t,e,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],h=u[3];if("channelsLast"===s)c=t[0],l=t[1],d=t[2],h=t[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=t[0],h=t[1],l=t[2],d=t[3]}var p,f=e[0],m=e[1],g=e[3],b=wi(n),y=b[0],v=b[1],x=wi(r),w=x[0],k=x[1],S=Si(f,w),O=Si(m,k),_=function(t,e,n,r,a,i,o,s){var u,c,l;if("number"==typeof t){u={top:t,bottom:t,left:t,right:t,type:0===t?"VALID":"NUMBER"};var d=function(t,e,n,r,a){null==r&&(r=xi(t,e,n));var i=t[0],o=t[1],s=Oi((i-e+2*r)/n+1,a);T(j(s),(function(){return"The output # of rows ("+s+") must be an integer. Change the stride and/or zero pad parameters"}));var u=Oi((o-e+2*r)/n+1,a);return T(j(u),(function(){return"The output # of columns ("+u+") must be an integer. Change the stride and/or zero pad parameters"})),[s,u]}([e,n],i,r,t,s);c=d[0],l=d[1]}else if("same"===t){c=Math.ceil(e/r),l=Math.ceil(n/a);var h=Math.max(0,(c-1)*r+i-e),p=Math.max(0,(l-1)*a+o-n),f=Math.floor(h/2),m=h-f,g=Math.floor(p/2);u={top:f,bottom:m,left:g,right:p-g,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),l=Math.ceil((n-o+1)/a)}return{padInfo:u,outHeight:c,outWidth:l}}(a,l,d,y,v,S,O,i),C=_.padInfo,I=_.outHeight,N=_.outWidth,E=o?g*h:g;return"channelsFirst"===s?p=[c,E,I,N]:"channelsLast"===s&&(p=[c,I,N,E]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:d,inChannels:h,outHeight:I,outWidth:N,outChannels:E,padInfo:C,strideHeight:y,strideWidth:v,filterHeight:f,filterWidth:m,effectiveFilterHeight:S,effectiveFilterWidth:O,dilationHeight:w,dilationWidth:k,inShape:t,outShape:p,filterShape:e}}function vi(t,e,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],d=u[2],h=u[3],p=u[4];if("channelsLast"===o)c=t[0],l=t[1],d=t[2],h=t[3],p=t[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=t[0],p=t[1],l=t[2],d=t[3],h=t[4]}var f,m=e[0],g=e[1],b=e[2],y=e[4],v=ki(n),x=v[0],w=v[1],k=v[2],S=ki(r),O=S[0],_=S[1],C=S[2],I=Si(m,O),N=Si(g,_),E=Si(b,C),A=function(t,e,n,r,a,i,o,s,u,c,l){var d,h,p,f;if("number"==typeof t){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:0===t?"VALID":"NUMBER"};var m=function(t,e,n,r,a,i){null==a&&(a=xi(t,e,r));var o=t[0],s=t[1],u=t[2],c=Oi((o-e+2*a)/r+1,i);T(j(c),(function(){return"The output # of depths ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=Oi((s-e+2*a)/r+1,i);T(j(l),(function(){return"The output # of rows ("+l+") must be an integer. Change the stride and/or zero pad parameters"}));var d=Oi((u-e+2*a)/r+1,i);return T(j(d),(function(){return"The output # of columns ("+d+") must be an integer. Change the stride and/or zero pad parameters"})),[c,l,d,n]}([e,n,r,1],s,1,a,t,l);h=m[0],p=m[1],f=m[2]}else if("same"===t){h=Math.ceil(e/a),p=Math.ceil(n/i),f=Math.ceil(r/o);var g=(h-1)*a+s-e,b=(p-1)*i+u-n,y=(f-1)*o+c-r,v=Math.floor(g/2),x=g-v,w=Math.floor(b/2),k=b-w,S=Math.floor(y/2);d={top:w,bottom:k,left:S,right:y-S,front:v,back:x,type:"SAME"}}else{if("valid"!==t)throw Error("Unknown padding parameter: "+t);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((e-s+1)/a),p=Math.ceil((n-u+1)/i),f=Math.ceil((r-c+1)/o)}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(a,l,d,h,x,w,k,I,N,E,s),R=A.padInfo,D=A.outDepth,F=A.outHeight,M=A.outWidth,P=i?y*p:y;return"channelsFirst"===o?f=[c,P,D,F,M]:"channelsLast"===o&&(f=[c,D,F,M,P]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:d,inWidth:h,inChannels:p,outDepth:D,outHeight:F,outWidth:M,outChannels:P,padInfo:R,strideDepth:x,strideHeight:w,strideWidth:k,filterDepth:m,filterHeight:g,filterWidth:b,effectiveFilterDepth:I,effectiveFilterHeight:N,effectiveFilterWidth:E,dilationDepth:O,dilationHeight:_,dilationWidth:C,inShape:t,outShape:f,filterShape:e}}function xi(t,e,n,r){void 0===r&&(r=1);var a=Si(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function wi(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}function ki(t){return"number"==typeof t?[t,t,t]:t}function Si(t,e){return e<=1?t:t+(t-1)*(e-1)}function Oi(t,e){if(!e)return t;switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error("Unknown roundingMode "+e)}}function _i(t){var e=wi(t),n=e[0],r=e[1],a=e[2];return 1===n&&1===r&&1===a}function Ci(t,e){return _i(t)||_i(e)}function Ti(t){if("NHWC"===t)return"channelsLast";if("NCHW"===t)return"channelsFirst";throw new Error("Unknown dataFormat "+t)}function Ii(t,e,n){if("complex64"===e){if("complex64"===t.dtype)return t.clone();var r=Kn(t.shape),a=t.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!G(t.dtype,e))return Vt.makeTensorFromDataId(t.dataId,t.shape,e);if("complex64"===t.dtype){var o=n.real(t);return i=o.cast(e),o.dispose(),i}if("int32"===e)return n.int(t);if("bool"===e){var s=Ln(0,t.dtype);return i=n.notEqual(t,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+t.dtype+" to "+e)}function Ni(t,e){return Vt.makeTensorFromDataId(t.dataId,e,t.dtype)}function Ei(t,e,n){var r=(e-t)/(n-1),a=it(n,"float32");a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return Bn(a,"float32")}var Ai=Object.freeze({castTensor:Ii,reshapeTensor:Ni,linspaceImpl:Ei,upcastType:Dt,axesAreInnerMostDims:Sn,combineLocations:On,computeOutAndReduceShapes:_n,expandShapeToKeepDim:Cn,assertAxesAreInnerMostDims:Tn,getAxesPermutation:In,getUndoAxesPermutation:Nn,getInnerMostAxes:En,getBroadcastDims:Br,getReductionAxes:zr,assertAndGetBroadcastShape:Wr,assertParamsConsistent:An,computeOutShape:Rn,computePool2DInfo:gi,computePool3DInfo:bi,computeConv2DInfo:yi,computeConv3DInfo:vi,computeDefaultPad:xi,tupleValuesAreOne:_i,eitherStridesOrDilationsAreOne:Ci,convertConv2DDataFormat:Ti,PARALLELIZE_THRESHOLD:Va,computeOptimalWindowSize:Ua});function Ri(t,e){if(t.length!==e.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+t.length+", imag: "+e.length+".");for(var n=new Float32Array(2*t.length),r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function ji(t,e){return{real:t[2*e],imag:t[2*e+1]}}function Di(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Fi(t,e,n){var r=(n?2:-2)*Math.PI*(t/e);return{real:Math.cos(r),imag:Math.sin(r)}}function Mi(t,e,n){var r=function(t,e,n){return function(t,e,n){for(var r=0,a=t.length,i=0,o=!1;r<a;){var s=n(e,t[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(t,e,n||Pi)}(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function Pi(t,e){return t>e?1:t<e?-1:0}function $i(t,e,n,r,a){return Bi(t,e,n,r,a,0).selectedIndices}function Li(t,e,n,r,a,i){var o=Bi(t,e,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function Bi(t,e,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var u=Array.from(e).map((function(t,e){return{score:t,boxIndex:e,suppressBeginIndex:0}})).filter((function(t){return t.score>a})).sort(Vi),c=i>0?-.5/i:0,l=[],d=[];l.length<n&&u.length>0;){var h=u.pop(),p=h.score,f=h.boxIndex,m=h.suppressBeginIndex;if(p<a)break;for(var g=!1,b=l.length-1;b>=m;--b){var y=zi(t,f,l[b]);if(y>=r){g=!0;break}if(h.score=h.score*Wi(r,c,y),h.score<=a)break}h.suppressBeginIndex=l.length,g||(h.score===p?(l.push(f),d.push(h.score)):h.score>a&&Mi(u,h,Vi))}var v=l.length;return s&&(l.fill(0,v),d.fill(0,v)),{selectedIndices:Bn(l,"int32"),selectedScores:Bn(d,"float32"),numValidOutputs:Ln(v,"int32")}}function zi(t,e,n){var r=t.subarray(4*e,4*e+4),a=t.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),p=(s-i)*(u-o),f=(d-c)*(h-l);if(p<=0||f<=0)return 0;var m=Math.max(i,c),g=Math.max(o,l),b=Math.min(s,d),y=Math.min(u,h),v=Math.max(b-m,0)*Math.max(y-g,0);return v/(p+f-v)}function Wi(t,e,n){var r=Math.exp(e*n*n);return n<=t?r:0}function Vi(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}function Ui(t,e,n){var r=new Array(t.rank).fill(0),a=t.shape.slice();return e.map((function(e){a[n]=e;var i=t.slice(r,a);return r[n]+=e,i}))}function Gi(t,e){for(var n=new Array(t.rank),r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];var a=or(n,t.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(t.rank),s=0;s<o.length;s++)o[s]=i[s]%t.shape[s];var u=t.locToIndex(o);a.values[r]=t.values[u]}return a.toTensor()}function Hi(t,e,n,r,a){for(var i=e[e.length-1],o=[t.length/i,i],s=o[0],u=o[1],c=z(n,s*r),l=z("int32",s*r),d=0;d<s;d++){for(var h=d*u,p=t.subarray(h,h+u),f=[],m=0;m<p.length;m++)f.push({value:p[m],index:m});f.sort((function(t,e){return e.value-t.value}));var g=d*r,b=c.subarray(g,g+r),y=l.subarray(g,g+r);for(m=0;m<r;m++)b[m]=f[m].value,y[m]=f[m].index}var v=e.slice();return v[v.length-1]=r,[Pn(c,v,n),Pn(l,v,"int32")]}function qi(t,e){for(var n=[],r=0;r<e.length;r++)e[r]&&n.push(r);var a=or(t,"int32"),i=or([n.length,t.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*t.length;i.values.set(o,s)}return i.toTensor()}var Ki=function(t,e){this.outputShape=[],this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("float v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Xi=function(t,e){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=e.map((function(t,e){return"T"+e}));var n=[];this.variableNames.forEach((function(t){n.push("vec4 v"+t+" = get"+t+"AtOutCoords();")}));var r=this.variableNames.map((function(t){return"v"+t})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Yi=function(t,e,n){this.variableNames=["A"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===e?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Ji(t,e){return["x","y","z","w","u","v"].slice(0,e).map((function(e){return t+"."+e}))}function Zi(t,e){return 1===e?[t]:Ji(t,e)}function Qi(){var t,e,n,r,a,i,o,s,u,c;return 2===d().getNumber("WEBGL_VERSION")?(t="#version 300 es",e="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(t="",e="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function to(t,e,n){void 0===n&&(n="index");var r=et(e);return r.map((function(e,a){return"int "+t[a]+" = "+n+" / "+e+"; "+(a===r.length-1?"int "+t[a+1]+" = "+n+" - "+t[a]+" * "+e:"index -= "+t[a]+" * "+e)+";"})).join("")}function eo(t){var e=et(t).map((function(t){return t.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+e[0]+" + coords.y * "+e[1]+" + coords.z;\n  }\n"}var no="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function ro(t,e,n,r){var a=[];t.forEach((function(t){var e=A(t.shapeInfo.logicalShape);t.shapeInfo.isUniform?a.push("uniform float "+t.name+(e>1?"["+e+"]":"")+";"):(a.push("uniform sampler2D "+t.name+";"),a.push("uniform int offset"+t.name+";"))}));var i,o,s=a.join("\n"),u=t.map((function(t){return function(t,e,n){void 0===n&&(n=!1);var r="";r+=n?io(t):ao(t);var a=t.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(r+=n?function(t,e){var n,r=t.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=t.shapeInfo.logicalShape.length,s=e.logicalShape.length,u=Br(t.shapeInfo.logicalShape,e.logicalShape),c=po(s),l=s-o,d=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(t){return"coords."+d[t+l]+" = 0;"})).join("\n");var h="";h=s<2&&o>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+d[e+l]})).join(", ");var p="return outputValue;",f=1===A(t.shapeInfo.logicalShape),m=1===A(e.logicalShape);if(1!==o||f||m){if(f&&!m)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=o-2,b=o-1;u.indexOf(g)>-1&&u.indexOf(b)>-1?p="return vec4(outputValue.x);":u.indexOf(g)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(b)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+h+");\n      "+p+"\n    }\n  "}(t,e):function(t,e){var n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===u&&null==t.shapeInfo.flatOffset&&R(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=po(u),d=Br(t.shapeInfo.logicalShape,e.logicalShape),h=u-s,p=["x","y","z","w","u","v"];c=0===s?"":u<2&&d.length>=1?"coords = 0;":d.map((function(t){return"coords."+p[t+h]+" = 0;"})).join("\n");var f="";return f=u<2&&s>0?"coords":t.shapeInfo.logicalShape.map((function(t,e){return"coords."+p[e+h]})).join(", "),"\n    float "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+f+");\n    }\n  "}(t,e)),r}(t,e,r)})).join("\n"),c=e.texShape,l=Qi(),d=function(t){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+t.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),h=function(t){return t.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+t.varyingFs+" vec2 resultUV;\n    "+t.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+t.defineSpecialNaN+"\n    "+t.defineSpecialInf+"\n    "+t.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+oo+"\n    "+so+"\n    "+uo+"\n  "}(l);return e.isPacked?(i=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,e);case 2:return function(t,e){var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(R(t,e))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(t[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=t,r=e,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Math.ceil(n[2]/2),o=i*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(t,e){for(var n=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),a=r*Math.ceil(t[t.length-2]/2),i=a,o="",s="b, r, c",u=2;u<t.length-1;u++)i*=t[t.length-u-1],o="\n      int b"+u+" = index / "+i+";\n      index -= b"+u+" * "+i+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+t.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+t.length+"("+s+");\n    }\n  "}(t,e)}var n,r,a,i,o}(e.logicalShape,c),o=function(t){return"\n    void setOutput(vec4 val) {\n      "+t.output+" = val;\n    }\n  "}(l)):(i=function(t,e){switch(t.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(t,e){return 1===e[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+e[1]+".0);\n      }\n    ":1===e[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+e[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      return resTexRC.x * "+e[1]+" + resTexRC.y;\n    }\n  "}(0,e);case 2:return function(t,e){return R(t,e)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+e[0]+", "+e[1]+"));\n      }\n    ":1===t[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===t[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+e[0]+", "+e[1]+"));\n        int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      int r = index / "+t[1]+";\n      int c = index - r * "+t[1]+";\n      return ivec2(r, c);\n    }\n  "}(t,e);case 3:return n=e,r=to(["r","c","d"],t),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(t,e){var n=to(["r","c","d","d2"],t);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(t,e);case 5:return function(t,e){var n=to(["r","c","d","d2","d3"],t);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+e[0]+",\n                             "+e[1]+"));\n\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(t,e);case 6:return function(t,e){var n=to(["r","c","d","d2","d3","d4"],t);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+e[0]+", "+e[1]+"));\n      int index = resTexRC.x * "+e[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(t,e);default:throw new Error(t.length+"-D output sampling is not yet supported")}var n,r}(e.logicalShape,c),o=function(t){return"\n    void setOutput(float val) {\n      "+t.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(h+=co),[h,d,o,s,i,u,n].join("\n")}function ao(t){var e=t.shapeInfo.logicalShape;switch(e.length){case 0:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"float "+n+"() {return "+e+";}";var r=t.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=t.shapeInfo.texShape,s=o[0],u=o[1],c=lo(e);return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+s+", "+u+", "+c+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1);if(t.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+ho(t)+"\n      }\n    ";var r=t.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+e+", halfCR);\n      }\n    ";var o=lo(e);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+e+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+e+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape;if(null!=a&&R(e,a)){var i=a[0],o=a[1];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var s=B(e),u=s.newShape,c=s.keptDims,l=u;if(l.length<e.length){var d=fo(t,l);return"\n      "+ao(d)+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+mo(["row","col"],c)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+e[1]+", 1)));\n        "+ho(t)+"\n      }\n    ";var h=a[0],p=a[1],f=lo(n);return 1===p?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+h+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===h?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+f+"), vec3("+e[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+p+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+e[1]+" + col + "+f+";\n    vec2 uv = uvFromFlat("+h+", "+p+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[1]*e[2],i=e[2],o=B(e),s=o.newShape,u=o.keptDims,c=s;if(c.length<e.length){var l=fo(t,c);return"\n        "+ao(l)+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+mo(["row","col","depth"],u)+");\n        }\n      "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+ho(t)+"\n      }\n    ";var d=t.shapeInfo.texShape,h=d[0],p=d[1],f=t.shapeInfo.flatOffset;if(p===a&&null==f)return"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+p+".0, "+h+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ";if(p===i&&null==f)return"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+e[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+p+".0, "+h+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ";var m=lo(n);return"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+m+";\n        vec2 uv = uvFromFlat("+h+", "+p+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(t);case 4:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[3],i=e[2]*a,o=e[1]*i,s=B(e),u=s.newShape,c=s.keptDims;if(u.length<e.length){var l=fo(t,u);return"\n      "+ao(l)+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+mo(["row","col","depth","depth2"],c)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+ho(t)+"\n      }\n    ";var d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,p=h[0],f=h[1];if(f===o&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+f+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(f===a&&null==d)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+e[1]*e[2]+", "+e[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+f+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var m=lo(n);return"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+p+", "+f+", index + "+m+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 5:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],i=e[3]*a,o=e[2]*i,s=e[1]*o,u=B(e),c=u.newShape,l=u.keptDims;if(c.length<e.length){var d=fo(t,c);return"\n      "+ao(d)+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+mo(["row","col","depth","depth2","depth3"],l)+");\n      }\n    "}if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+ho(t)+"\n      }\n    ";var h=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];if(m===s&&null==h)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+m+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(m===a&&null==h)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]+",\n               "+e[2]*e[3]+", "+e[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+m+".0, "+f+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var g=lo(n);return"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+g+";\n      vec2 uv = uvFromFlat("+f+", "+m+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);case 6:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=B(e),i=a.newShape,o=a.keptDims;if(i.length<e.length){var s=fo(t,i);return"\n      "+ao(s)+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+mo(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    "}var u=e[5],c=e[4]*u,l=e[3]*c,d=e[2]*l,h=e[1]*d;if(t.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+h+", "+d+", "+l+", "+c+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+u+", 1)));\n        "+ho(t)+"\n      }\n    ";var p=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,m=f[0],g=f[1];if(g===h&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+d+", "+l+", "+c+", "+u+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+g+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";if(g===u&&null==p)return"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+e[1]*e[2]*e[3]*e[4]+",\n               "+e[2]*e[3]*e[4]+",\n               "+e[3]*e[4]+",\n               "+e[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+g+".0, "+m+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ";var b=lo(n);return"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+h+" + col * "+d+" + depth * "+l+" +\n          depth2 * "+c+" + depth3 * "+u+" + depth4 + "+b+";\n      vec2 uv = uvFromFlat("+m+", "+g+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(t);default:throw new Error(e.length+"-D input sampling is not yet supported")}}function io(t){var e,n,r;switch(t.shapeInfo.logicalShape.length){case 0:return e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Qi(),"\n    vec4 "+n+"() {\n      return "+r.texture2D+"("+e+", halfCR);\n    }\n  ";case 1:return function(t){var e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=t.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Qi();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+e+", uv);\n    }\n  "}(t);case 2:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=a[0],o=a[1],s=Qi();if(null!=a&&R(e,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(e[1]/2);return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+c+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(t);case 3:return function(t){var e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===e[0]){var o=e.slice(1),s=fo(t,o);return"\n        "+io(s)+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+mo(["b","row","col"],[1,2])+");\n        }\n      "}var u=i[0],c=i[1],l=Math.ceil(e[2]/2),d=l*Math.ceil(e[1]/2),h=Qi();return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+u+", "+c+", "+d+", "+l+", b, row, col);\n      return "+h.texture2D+"("+n+", uv);\n    }\n  "}(t);default:return function(t){for(var e=t.shapeInfo.logicalShape,n=e.length,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(e[n-1]/2),l=c*Math.ceil(e[n-2]/2),d="int b, int row, int col",h="b * "+l+" + (row / 2) * "+c+" + (col / 2)",p=2;p<n-1;p++)d="int b"+p+", "+d,l*=e[n-p-1],h="b"+p+" * "+l+" + "+h;var f=Qi();return"\n    vec4 "+a+"("+d+") {\n      int index = "+h+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+f.texture2D+"("+r+", uv);\n    }\n  "}(t)}}var oo="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",so="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",uo="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",co="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function lo(t){return"offset"+t}function ho(t){var e=t.name,n=A(t.shapeInfo.logicalShape);return n<2?"return "+e+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+e+"[i];\n      }\n    }\n  "}function po(t){if(t<=1)return"int";if(2===t)return"ivec2";if(3===t)return"ivec3";if(4===t)return"ivec4";if(5===t)return"ivec5";if(6===t)return"ivec6";throw Error("GPU for rank "+t+" is not yet supported")}function fo(t,e){var n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function mo(t,e){return e.map((function(e){return t[e]})).join(", ")}var go=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(t.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var a=t[t.length-1],i=Math.ceil(a/e);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=po(c),d=Zi("coords",c);if(1===i){var h=po(s=c+1);o="\n        "+h+" sourceLocR = "+h+"("+d.join()+", 0);\n        ++"+d[c-1]+";\n        "+h+" sourceLocG = "+h+"("+d.join()+", 0);\n        ++"+d[c-2]+";\n        "+h+" sourceLocA = "+h+"("+d.join()+", 0);\n        --"+d[c-1]+";\n        "+h+" sourceLocB = "+h+"("+d.join()+", 0);\n        --"+d[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+d[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+d[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+d[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+d[c-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),f="."+p[s-1],m=p.map((function(t){return"int "+t})),g=Zi("sourceLocR",s-1).concat("inIdx.r"),b=Zi("sourceLocG",s-1).concat("inIdx.g"),y=Zi("sourceLocB",s-1).concat("inIdx.b"),v=Zi("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+b.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+v.join()+")));",k="vec4(\n            getAChannel("+g.join()+"),\n            hasNextCol ? getAChannel("+b.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+v.join()+") : 0.)",S=r?"":"\n      float getBestIndicesAChannel("+m.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+m.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+S+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+d[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+d[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+f+", sourceLocG"+f+",\n          sourceLocB"+f+", sourceLocA"+f+") * "+e+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+k+";\n\n        for (int i = 0; i < "+e+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+k+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},bo=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=s-1-t.padInfo.top,l=u-1-t.padInfo.left,d=1/(e*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+d+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yo=function(t){this.variableNames=["dy"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,d=t.effectiveFilterHeight,h=t.effectiveFilterWidth,p=l-1-t.padInfo.front,f=d-1-t.padInfo.top,m=h-1-t.padInfo.left,g=1/(e*n*r);this.userCode="\n      const ivec3 pads = ivec3("+p+", "+f+", "+m+");\n      const float avgMultiplier = float("+g+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+d+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},vo=function(t,e,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Wr(t,e),Wr(t,n);var o="0.0";null!=r&&(Wr(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(Wr(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},xo=function(t,e,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Wr(t,e),Wr(t,n);var o="vec4(0.0)";null!=r&&(Wr(t,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(Wr(t,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},wo="return areal * breal - aimag * bimag;",ko="return areal * bimag + aimag * breal;",So=function(t,e,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Wr(e,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+t+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},Oo="return a + b;",_o="return a - b;",Co="return a * b;",To="\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",Io="return (a < 0.) ? b * a : a;",No=function(t,e,n){this.variableNames=["A","B"],this.outputShape=Wr(e,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+t+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Eo="\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",Ao="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Ro=function(t,e,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Wr(e,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===A(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+po(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=Zi("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},jo=function(){function t(t){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Do=function(){function t(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t,e){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,t),r.gl.uniform1f(n.maxLoc,e)}},t}(),Fo=function(t){this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Mo=function(t){this.outputShape=[],this.outputShape=Rn(t,1),this.variableNames=t.map((function(t,e){return"T"+e}));var e=new Array(t.length-1);e[0]=t[0][1];for(var n=1;n<e.length;n++)e[n]=e[n-1]+t[n][1];var r=["if (yC < "+e[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<e.length;n++){var a=e[n-1];r.push("else if (yC < "+e[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=e.length,o=e[e.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Po=function(t,e){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Rn(t,e);var n=this.outputShape,r=n.length,a=po(r),i=Zi("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=t.map((function(t,e){return"T"+e}));var s=new Array(t.length-1);s[0]=t[0][e];for(var u=1;u<s.length;u++)s[u]=s[u-1]+t[u][e];var c=o[e],l=o.slice(-2),d=o.join(),h="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+d+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var p=s[u-1];h+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+$o(o,c,p)+"),\n            vec2("+$o(l,c,p)+"));\n        }"}var f=s.length,m=s[s.length-1];h+="\n        return getChannel(\n          getT"+f+"("+$o(o,c,m)+"),\n          vec2("+$o(l,c,m)+"));",this.userCode="\n      float getValue("+o.map((function(t){return"int "+t}))+") {\n        "+h+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function $o(t,e,n){var r=t.indexOf(e);return t.map((function(t,e){return e===r?t+" - "+n:t})).join()}var Lo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Bo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i="channelsLast"===t.dataFormat,o=e-1-t.padInfo.top,s=n-1-t.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},zo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.padInfo.front,i=t.padInfo.top,o=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yF = 0; yF < "+t.outDepth+"; yF++) {\n            int xF = wF + yF * "+e+" - "+a+";\n\n            if (xF < 0 || xF >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Wo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterDepth,n=t.filterHeight,r=t.filterWidth,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=e-1-t.padInfo.front,u=n-1-t.padInfo.top,c=r-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+e+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+t.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+e+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+t.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Vo=function(t){this.variableNames=["x","dy"],this.outputShape=t.filterShape;var e=t.strideHeight,n=t.strideWidth,r=t.padInfo.top,a=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+t.batchSize+"; b++) {\n          for (int yR = 0; yR < "+t.outHeight+"; yR++) {\n            int xR = wR + yR * "+e+" - "+r+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+t.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Uo=function(t){this.variableNames=["dy","W"],this.outputShape=t.inShape;var e=t.filterHeight,n=t.filterWidth,r=t.strideHeight,a=t.strideWidth,i=e-1-t.padInfo.top,o=n-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+e+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+e+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Go=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.padInfo.top,i=t.padInfo.left,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterHeight,d=t.filterWidth,h=4*Math.floor(t.inChannels/4),p=t.inChannels%4,f="channelsLast"===t.dataFormat,m=f?1:2,g=f?2:3,b=f?3:1,y="",v="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",v="result = activation(result);");var x=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+b+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+m+"], coords["+g+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+t.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+f+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===p)+") {\n\n              if ("+f+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+h+") *\n                    getW(wR, wC, "+h+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+h+", xR, xC) *\n                    getW(wR, wC, "+h+", d2);\n              }\n\n            } else if ("+(2===p)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2)\n              );\n\n              if ("+f+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===p)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2),\n                getW(wR, wC, "+h+" + 2, d2)\n              );\n\n              if ("+f+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1),\n                  getX(batch, xR, xC, "+h+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC),\n                  getX(batch, "+h+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+v+"\n        setOutput(result);\n      }\n    "},Ho=function(t){this.variableNames=["x","W"],this.outputShape=t.outShape;var e=t.padInfo.front,n=t.padInfo.top,r=t.padInfo.left,a=t.strideDepth,i=t.strideHeight,o=t.strideWidth,s=t.dilationDepth,u=t.dilationHeight,c=t.dilationWidth,l=t.filterDepth,d=t.filterHeight,h=t.filterWidth,p=4*Math.floor(t.inChannels/4),f=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+e+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+d+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===f)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+p+") *\n                  getW(wF, wR, wC, "+p+", d2);\n              } else if ("+(2===f)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===f)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1),\n                  getX(batch, xF, xR, xC, "+p+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2),\n                  getW(wF, wR, wC, "+p+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},qo=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=t.outShape;var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,p=t.filterWidth,f=t.outChannels/t.inChannels,m="",g="";n&&(m=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",g="result = activation(result);");var b=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+m+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+f+";\n        int q = d2 - d1 * "+f+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+h+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+d+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+b+"\n        "+g+"\n        setOutput(result);\n      }\n    "},Ko=function(t,e,n,r){void 0===e&&(e=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var a=t.inHeight,i=t.inWidth,o=t.padInfo.top,s=t.padInfo.left,u=t.strideHeight,c=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,h=t.filterHeight,p=t.filterWidth,f=p,m="int xR; int xC; int xCOffset;",g=0;g<h;g++)for(var b=0;b<p;b++)m+="\n          vec4 xTexelR"+g+"C"+2*b+" = vec4(0.);\n          vec4 wR"+g+"C"+b+" = vec4(0.);\n          vec4 xR"+g+"C"+b+" = vec4(0.);";for(g=0;g<h;g++)for(var y=0;y<f;y++){if(m+="\n          xR = xRCorner + "+g*l+";\n          xC = xCCorner + "+(b=2*y)*d+";\n        ",1===c){if(b<p&&(m+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+b+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+g+"C"+b+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+g+"C"+b+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+g+"C"+b+" = vec4(previous.zw, xTexelR"+g+"C"+b+".xy);\n                } else {\n                  xR"+g+"C"+b+" = vec4(0, 0, xTexelR"+g+"C"+b+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+g+"C"+b+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+b+" = vec4(0.);\n                }\n\n                xR"+g+"C"+b+" = xTexelR"+g+"C"+b+";\n              ",b+1<p)){var v=s%2==0?_(d):d;d%2==0&&s%2==1||d%2!=0&&s%2!=1?(m+="\n                  xCOffset = xC + "+s%2+" + "+v+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+g+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",d>1&&(m+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+g+"C"+b+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+g+"C"+b+" = vec4(0.);\n                    }\n                  "),m+="\n                  xR"+g+"C"+(b+1)+" = vec4(\n                    xTexelR"+g+"C"+b+".zw, xTexelR"+g+"C"+(b+2)+".xy);\n                "):m+="\n                  xCOffset = xC + "+v+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+g+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+g+"C"+(b+1)+" = xTexelR"+g+"C"+(b+2)+";\n                "}}else b<p&&(m+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(m+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+b+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+b+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+g+"C"+(b+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+g+"C"+(b+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+b+" = vec4(\n                  xTexelR"+g+"C"+b+".zw, xTexelR"+g+"C"+(b+2)+".zw);\n              ",b+1<p&&(m+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+g+"C"+(b+1)+" = vec4(xTexelR"+g+"C"+(b+2)+".xy, final.xy);\n                ")):(m+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+g+"C"+b+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+g+"C"+b+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+g+"C"+(b+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+g+"C"+(b+2)+" = vec4(0.);\n                }\n\n                xR"+g+"C"+b+" = vec4(\n                  xTexelR"+g+"C"+b+".xy, xTexelR"+g+"C"+(b+2)+".xy);\n              ",b+1<p&&(m+="\n                  xR"+g+"C"+(b+1)+" = vec4(\n                    xTexelR"+g+"C"+b+".zw, xTexelR"+g+"C"+(b+2)+".zw);\n                ")),m+="}");b<p&&(m+="\n            vec4 wTexelR"+g+"C"+b+" = getW("+g+", "+b+", d1, q);\n            wR"+g+"C"+b+" = vec4(wTexelR"+g+"C"+b+".xz, wTexelR"+g+"C"+b+".xz);\n          ",b+1<p&&(m+="\n              vec4 wTexelR"+g+"C"+(b+1)+" = getW("+g+", "+(b+1)+", d1, q);\n              wR"+g+"C"+(b+1)+" =\n                vec4(wTexelR"+g+"C"+(b+1)+".xz, wTexelR"+g+"C"+(b+1)+".xz);"))}for(g=0;g<h;g++)for(b=0;b<p;b++)m+="dotProd += xR"+g+"C"+b+" * wR"+g+"C"+b+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var k=e?"result += getBiasAtOutCoords();":"";e&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+m+"\n\n        vec4 result = dotProd;\n        "+k+"\n        "+w+"\n        setOutput(result);\n      }\n    "},Xo=function(t,e,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=t[0],o=t[1],s=t[2],u=t[3],c=e[0],l=n[0],d=n[1];this.outputShape=[c,l,d,u];var h="bilinear"===r?1:0,p=[o-1+".0",s-1+".0"],f=p[0],m=p[1],g=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+f+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+f],b=g[0],y=g[1],v=g[2],x=d>1?[""+(s-1)/(d-1),"(x2-x1) * width_ratio","x1*"+m+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+m],w=x[0],k=x[1],S=x[2];this.userCode="\n      const float height_ratio = float("+b+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+k+";\n\n        float in_y = "+v+";\n        if( in_y < 0.0 || in_y > "+f+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+S+";\n        if( in_x < 0.0 || in_x > "+m+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+h+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},Yo=function(t,e,n){this.variableNames=["x"],this.outputShape=t;var r=t.length,a=t[t.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+po(r)+" coords = getOutputCoords();\n        int end = "+Jo(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+e+") {\n            continue;\n          }\n          "+Jo(r,"coords")+" = idx;\n          val += getX("+function(t,e){if(1===t)return""+e;if(2===t)return e+".x, "+e+".y";if(3===t)return e+".x, "+e+".y, "+e+".z";if(4===t)return e+".x, "+e+".y, "+e+".z, "+e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Jo(t,e){if(1===t)return""+e;if(2===t)return e+".y";if(3===t)return e+".z";if(4===t)return e+".w";throw Error("Cumulative sum for rank "+t+" is not yet supported")}var Zo=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ht.DENSE;var e=te(t),n=Qi();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+to(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},Qo=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ht.DENSE;var e=te(t),n=Qi();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+to(["r","c","d"],t)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+e[0]+", "+e[1]+"));\n        int index = 4 * (resTexRC.x * "+e[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},ts=function(){function t(t,e,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=e,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+e+";\n      int offset_h = imod(h, "+e+");\n      int in_w = w / "+e+";\n      int offset_w = imod(w, "+e+");\n      int offset_d = (offset_h * "+e+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return t.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},t.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},t.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},t.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},t.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},t}(),es=function(t){this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},ns=function(t){this.variableNames=["A"],this.outTexUsage=qt.DOWNLOAD;var e=Qi();this.outputShape=t,this.userCode="\n      "+no+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+e.output+" = encode_float(x);\n      }\n    "},rs=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qt.DOWNLOAD;var e=Qi();this.outputShape=t,this.userCode="\n      "+no+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+e.output+" = encode_float(x);\n      }\n    "},as=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Qi(),a=e[0],i=e[1];this.outputShape=t;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+eo(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},is=function(t,e,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Qi(),a=e[0],i=e[1];this.outputShape=t;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+t[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+t[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+eo(t)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},os="return real * expR - imag * expI;",ss="return real * expI + imag * expR;",us=function(t,e,n){this.variableNames=["real","imag"];var r=e[1];this.outputShape=e;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+t+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},cs=function(){function t(t,e){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.valueLoc&&(e.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(e.valueLoc,t)}},t}(),ls=function(t,e,n){this.variableNames=["A","indices"];var r=t.slice();r[n]=e,this.outputShape=r,this.rank=r.length;var a=po(this.rank),i=function(t,e){var n=t.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<t.length;i++)i===e?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(t,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},ds=function(t,e,n){this.sliceDim=t,this.strides=e,this.variableNames=["x","indices"],this.outputShape=n;var r=po(e.length),a=po(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function hs(t,e){var n=Qi();return ce(t,e,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function ps(t,e){return be(t,e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function fs(t,e){return ye(t,e,new Uint16Array([0,1,2,2,1,3]))}function ms(t,e,n,r,a,i,o){xe(n,r);var s=ve(t,e),u=t.TEXTURE_2D;return re(t,e,(function(){return t.bindTexture(u,s)})),re(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)})),re(t,e,(function(){return t.texParameteri(u,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)})),re(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MIN_FILTER,t.NEAREST)})),re(t,e,(function(){return t.texParameteri(u,t.TEXTURE_MAG_FILTER,t.NEAREST)})),re(t,e,(function(){return t.texImage2D(u,0,a,n,r,0,i,o,null)})),re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)})),s}function gs(t,e,n,r,a){var i=Qt(n,r);return ms(t,e,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,t.FLOAT)}function bs(t,e,n,r,a){var i=Qt(n,r);return ms(t,e,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function ys(t,e,n,r,a){var i=Qt(n,r);return ms(t,e,i[0],i[1],t.RGBA,t.RGBA,t.UNSIGNED_BYTE)}function vs(t,e,n,r,a){var i=ee(n,r);return ms(t,e,i[0],i[1],a.internalFormatPackedFloat,t.RGBA,t.FLOAT)}function xs(t,e,n,r,a){var i=ee(n,r);return ms(t,e,i[0],i[1],a.internalFormatPackedHalfFloat,t.RGBA,a.textureTypeHalfFloat)}function ws(t,e,n,r){return re(t,e,(function(){return t.bindBuffer(t.ARRAY_BUFFER,r)})),ke(t,e,n,"clipSpacePos",r,3,20,0)&&ke(t,e,n,"uv",r,2,20,12)}function ks(t,e,n,r,a,i,o){var s,u,c;re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),u=t.UNSIGNED_BYTE,c=t.RGBA):(s=new Float32Array(r*a*4),u=t.FLOAT,c=o.internalFormatPackedFloat),s.set(i),re(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,c,r,a,0,t.RGBA,u,s)})),re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Ss(t,e,n,r){re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,n)})),r.data instanceof Uint8Array?re(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,t.UNSIGNED_BYTE,r.data)})):re(t,e,(function(){return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),re(t,e,(function(){return t.bindTexture(t.TEXTURE_2D,null)}))}function Os(t,e,n,r,a){var i=t.createBuffer();re(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,i)}));var o=16*n*r;return re(t,e,(function(){return t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)})),re(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,0)})),re(t,e,(function(){return t.bindBuffer(t.PIXEL_PACK_BUFFER,null)})),i}function _s(t,e,n){var r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function Cs(t,e,n,r,a){var i=Qt(n,r),o=i[0],s=i[1],u=new Uint8Array(n*r*4);return re(t,e,(function(){return t.readPixels(0,0,o,s,a.downloadTextureFormat,t.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function Ts(t,e,n,r,a,i,o,s){var u=t,c=new Float32Array(function(t,e){var n=ee(t,e);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function Is(t,e,n,r){var a=new Float32Array(n*r*4);return re(t,e,(function(){return t.readPixels(0,0,r,n,t.RGBA,t.FLOAT,a)})),a}var Ns=Object.freeze({createVertexShader:hs,createVertexBuffer:ps,createIndexBuffer:fs,createFloat32MatrixTexture:gs,createFloat16MatrixTexture:bs,createUnsignedBytesMatrixTexture:ys,createPackedMatrixTexture:vs,createFloat16PackedMatrixTexture:xs,bindVertexProgramAttributeStreams:ws,uploadDenseMatrixToTexture:ks,uploadPixelDataToTexture:Ss,createBufferFromOutputTexture:Os,downloadFloat32MatrixFromBuffer:_s,downloadByteEncodedFloatMatrixFromOutputTexture:Cs,downloadPackedMatrixFromBuffer:Ts,downloadMatrixFromPackedOutputTexture:Is}),Es=function(){function t(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var e=d().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,Jt(e,t)):this.gl=Zt(e);var n="WEBGL_color_buffer_float";if(1===d().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=ue(this.gl,this.debug,"OES_texture_float"),We(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ue(this.gl,this.debug,"OES_texture_half_float");else if(d().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),We(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ue(this.gl,this.debug,"EXT_color_buffer_half_float");else if(d().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",We(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!We(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=ps(this.gl,this.debug),this.indexBuffer=fs(this.gl,this.debug),this.framebuffer=we(this.gl,this.debug),this.textureConfig=ne(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(t.prototype,"debug",{get:function(){return d().getBool("DEBUG")},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){var t=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var e=this.gl;re(e,this.debug,(function(){return e.finish()})),re(e,this.debug,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),re(e,this.debug,(function(){return e.deleteFramebuffer(t.framebuffer)})),re(e,this.debug,(function(){return e.bindBuffer(e.ARRAY_BUFFER,null)})),re(e,this.debug,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)})),re(e,this.debug,(function(){return e.deleteBuffer(t.indexBuffer)})),this.disposed=!0}},t.prototype.createFloat32MatrixTexture=function(t,e){return this.throwIfDisposed(),gs(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createFloat16MatrixTexture=function(t,e){return this.throwIfDisposed(),bs(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createUnsignedBytesMatrixTexture=function(t,e){return this.throwIfDisposed(),ys(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.uploadPixelDataToTexture=function(t,e){this.throwIfDisposed(),Ss(this.gl,this.debug,t,e)},t.prototype.uploadDenseMatrixToTexture=function(t,e,n,r){this.throwIfDisposed(),ks(this.gl,this.debug,t,e,n,r,this.textureConfig)},t.prototype.createFloat16PackedMatrixTexture=function(t,e){return this.throwIfDisposed(),xs(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.createPackedMatrixTexture=function(t,e){return this.throwIfDisposed(),vs(this.gl,this.debug,t,e,this.textureConfig)},t.prototype.deleteMatrixTexture=function(t){var e=this;this.throwIfDisposed(),this.outputTexture===t&&(Ie(this.gl,this.debug,this.framebuffer),this.outputTexture=null),re(this.gl,this.debug,(function(){return e.gl.deleteTexture(t)}))},t.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Cs(r.gl,r.debug,e,n,r.textureConfig)}))},t.prototype.downloadPackedMatrixFromBuffer=function(t,e,n,r,a,i){return Ts(this.gl,t,0,0,0,a,i,this.textureConfig)},t.prototype.downloadFloat32MatrixFromBuffer=function(t,e){return _s(this.gl,t,e)},t.prototype.createBufferFromTexture=function(t,e,n){this.bindTextureToFrameBuffer(t);var r=Os(this.gl,this.debug,e,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},t.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},t.prototype.createFence=function(t){var e,n,r=this;if(d().getBool("WEBGL_FENCE_API_ENABLED")){var a=t,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),n=function(){var t=a.clientWaitSync(i,0,0);return t===a.ALREADY_SIGNALED||t===a.CONDITION_SATISFIED},e=i}else d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(e=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(e,d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:e,isFencePassed:n}},t.prototype.downloadMatrixFromPackedTexture=function(t,e,n){var r=this;return this.downloadMatrixDriver(t,(function(){return Is(r.gl,r.debug,e,n)}))},t.prototype.createProgram=function(t){this.throwIfDisposed();var e=this.gl,n=le(e,this.debug,t),r=hs(e,this.debug),a=fe(e,this.debug);return re(e,this.debug,(function(){return e.attachShader(a,r)})),re(e,this.debug,(function(){return e.attachShader(a,n)})),me(e,this.debug,a),this.debug&&ge(e,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=ws(e,this.debug,this.program,this.vertexBuffer)),a},t.prototype.deleteProgram=function(t){var e=this;this.throwIfDisposed(),t===this.program&&(this.program=null),null!=t&&re(this.gl,this.debug,(function(){return e.gl.deleteProgram(t)}))},t.prototype.setProgram=function(t){var e=this;this.throwIfDisposed(),this.program=t,null!=this.program&&this.debug&&ge(this.gl,this.debug,this.program),re(this.gl,this.debug,(function(){return e.gl.useProgram(t)}))},t.prototype.getUniformLocation=function(t,e,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?Oe(this.gl,this.debug,t,e):_e(this.gl,t,e)},t.prototype.getAttributeLocation=function(t,e){var n=this;return this.throwIfDisposed(),re(this.gl,this.debug,(function(){return n.gl.getAttribLocation(t,e)}))},t.prototype.getUniformLocationNoThrow=function(t,e){return this.throwIfDisposed(),this.gl.getUniformLocation(t,e)},t.prototype.setInputMatrixTexture=function(t,e,n){this.throwIfDisposed(),this.throwIfNoProgram(),Ce(this.gl,this.debug,this.program,t,e,n)},t.prototype.setOutputMatrixTexture=function(t,e,n){this.setOutputMatrixTextureDriver(t,n,e)},t.prototype.setOutputPackedMatrixTexture=function(t,e,n){this.throwIfDisposed();var r=ee(e,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(t,a,i)},t.prototype.setOutputMatrixWriteRegion=function(t,e,n,r){this.setOutputMatrixWriteRegionDriver(n,t,r,e)},t.prototype.setOutputPackedMatrixWriteRegion=function(t,e,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},t.prototype.debugValidate=function(){null!=this.program&&ge(this.gl,this.debug,this.program),Ne(this.gl)},t.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),re(t,this.debug,(function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)}))},t.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),re(this.gl,this.debug,(function(){return t.gl.finish()}))},t.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=ue(this.gl,this.debug,2===d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},t.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},t.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},t.prototype.beginQuery=function(){if(2===d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.gl,e=this.getQueryTimerExtensionWebGL2(),n=t.createQuery();return t.beginQuery(e.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},t.prototype.endQuery=function(){if(2!==d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var e=this.gl,n=this.getQueryTimerExtensionWebGL2();e.endQuery(n.TIME_ELAPSED_EXT)}},t.prototype.waitForQueryAndGetTime=function(t){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(n){switch(n.label){case 0:return[4,P((function(){return e.disposed||e.isQueryAvailable(t,d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(t,d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},t.prototype.getQueryTime=function(t,e){if(0===e)return null;if(2===e){var n=this.gl;return n.getQueryParameter(t,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(t,r.QUERY_RESULT_EXT)/1e6},t.prototype.isQueryAvailable=function(t,e){if(0===e)return!0;if(2===e){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(t,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},t.prototype.pollFence=function(t){var e=this;return new Promise((function(n){e.addItemToPoll((function(){return t.isFencePassed()}),(function(){return n()}))}))},t.prototype.pollItems=function(){for(var t=function(t){for(var e=0;e<t.length;++e)if(!t[e]())break;return e-1}(this.itemsToPoll.map((function(t){return t.isDoneFn}))),e=0;e<=t;++e)(0,this.itemsToPoll[e].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},t.prototype.addItemToPoll=function(t,e){var n=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:e}),this.itemsToPoll.length>1||P((function(){return n.pollItems(),0===n.itemsToPoll.length}))},t.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Te(this.gl,this.debug,t,this.framebuffer),this.debug&&Ne(this.gl)},t.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Te(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Ne(this.gl)):Ie(this.gl,this.debug,this.framebuffer)},t.prototype.downloadMatrixDriver=function(t,e){this.bindTextureToFrameBuffer(t);var n=e();return this.unbindTextureToFrameBuffer(),n},t.prototype.setOutputMatrixTextureDriver=function(t,e,n){this.throwIfDisposed();var r=this.gl;Te(r,this.debug,t,this.framebuffer),this.debug&&Ne(r),this.outputTexture=t,re(r,this.debug,(function(){return r.viewport(0,0,e,n)})),re(r,this.debug,(function(){return r.scissor(0,0,e,n)}))},t.prototype.setOutputMatrixWriteRegionDriver=function(t,e,n,r){var a=this;this.throwIfDisposed(),re(this.gl,this.debug,(function(){return a.gl.scissor(t,e,n,r)}))},t.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},t.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},t}();function As(t,e){if(t.length!==e.length)throw Error("Binary was compiled with "+t.length+" inputs, but was executed with "+e.length+" inputs");t.forEach((function(t,n){var r=t.logicalShape,a=e[n],i=a.shape;if(!R(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!t.isUniform||!a.isUniform){var o=t.texShape,s=a.isUniform?null:a.texData.texShape;if(!R(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var Rs=function(t,e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,d=n.dataFormat,h=s.left,p=s.top,f=a*r,m=Qi(),g="channelsLast"===d,b=g?0:1,y=g?1:2,v="",x=0;x<=1;x++)for(var w=0;w<=1;w++)v+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+t[1]+" && pos < "+t[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+p+";\n            d0 = offsetY + "+l+" * (pos / "+f+");\n\n            if(d0 < "+e[b]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+f+".) / "+a+".));\n\n              if(d1 < "+e[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+g+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+v+"\n\n        "+m.output+" = result;\n      }\n    "},js=function(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},Ds=function(t,e,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=e,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+e+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+e+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Fs=function(t,e,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=e,s=t[3]-1;this.outputShape=t;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},Ms=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideHeight,n=t.strideWidth,r=t.dilationHeight,a=t.effectiveFilterHeight,i=t.effectiveFilterWidth,o=a-1-t.padInfo.top,s=i-1-t.padInfo.left,u=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+e+".0;\n\n          if (dyR < 0.0 || dyR >= "+t.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Ps=function(t){this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var e=t.strideDepth,n=t.strideHeight,r=t.strideWidth,a=t.dilationDepth,i=t.dilationHeight,o=t.dilationWidth,s=t.effectiveFilterDepth,u=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.front,d=u-1-t.padInfo.top,h=c-1-t.padInfo.left,p=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+d+", "+h+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+e+".0;\n\n          if (dyD < 0.0 || dyD >= "+t.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+t.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+t.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+p+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},$s=function(t,e,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;var s=n?t[1]:t[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",d=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",f="";i&&(p=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",f="result = activation(result);");var m=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+d[0]+" * "+h[0]+");\n          result += ("+d[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+m+"\n\n        "+f+"\n\n        setOutput(result);\n      }\n    "},Ls=function(){function t(t,e,n){this.variableNames=["probs"],this.outputShape=[t,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(e-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(e-1)+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;return function(n,r){null==e.seedLoc&&(e.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(e.seedLoc,t)}},t}(),Bs=function(t,e,n,r){this.variableNames=["indices"],this.outputShape=[t,e],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},zs=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var e=t.length;if(0===e)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=Zi("rc",e),r=po(e),a=function(t,e,n){if(1===t)return"rc > "+e[0];for(var r="",a=t-2;a<t;a++)r+=n[a]+" >= "+e[a],a<t-1&&(r+="||");return r}(e,t,n),i=function(t,e,n,r){if(1===t)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+e+";\n    bool rEdge = rp1 >= "+n+";\n  "}(e,t[t.length-1],t[t.length-2],n),o=function(t,e){var n=t.length,r=function(t,e){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<t;o++)i=e[e.length-1-o]+","+i;n.push(i)}return n}(n,e);return 1===n?"getA(rc),\n            rc + 1 >= "+t[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(t,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},Ws=function(t,e,n){this.variableNames=["x"],this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));var r=t.length,a=po(r),i=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Vs=function(t,e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.map((function(e,n){return e[0]+t[n]+e[1]}));for(var r=t.length,a=po(r),i=e.map((function(t){return t[0]})).join(","),o=e.map((function(e,n){return e[0]+t[n]})).join(","),s=Zi("rc",r),u=Zi("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",d=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",f=0,m=1===r?2:4;f<m;f++)p+="\n        "+d[f]+"\n        if ("+h+") {\n          result["+f+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+f+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";p+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+p+"\n        setOutput(result);\n      }\n    "},Us=function(t,e,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var i=t.filterWidth,o=t.strideHeight,s=t.strideWidth,u=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var f="avg"===e,m="((batch  * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + d",g="(xR * "+t.inWidth+" + xC) * "+t.inChannels+" + d",b="0.0";if(f||(b="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+s+");\n        const ivec2 pads = ivec2("+h+", "+p+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+d+";\n                wC += "+c+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+t.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = "+(r?a?m:g:"wR * "+d+" + wC")+";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(y="avgValue / count");var v=4*Math.floor(i/4),x=i%4,w="\n      if ("+f+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+h+", "+p+");\n      const float initializationValue = "+b+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+b+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+u+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+t.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+c+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              getValue(batch, xR, xC + 3 * "+c+", d)\n            );\n\n            "+w+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(2===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(3===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              initializationValue\n            );\n\n            "+w+"\n          }\n        }\n        setOutput("+y+");\n      }\n    "}},Gs=function(t,e,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===e&&n)throw new Error("Cannot compute positions for average pool.");var i=t.filterWidth,o=t.strideDepth,s=t.strideHeight,u=t.strideWidth,c=t.dilationDepth,l=t.dilationHeight,d=t.dilationWidth,h=t.effectiveFilterDepth,p=t.effectiveFilterHeight,f=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,b=t.padInfo.left;this.outputShape=t.outShape;var y="avg"===e,v="0.0";if(y||(v="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+s+", "+u+");\n        const ivec3 pads = ivec3("+m+", "+g+", "+b+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+h+";\n              wD += "+c+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+t.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+p+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+t.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+f+";\n                  wC += "+d+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+t.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = "+(r?a?"(((batch * "+t.inDepth+" + xD) * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"((xD * "+t.inHeight+" + xR) * "+t.inWidth+" + xC) * "+t.inChannels+" + ch":"wD * "+p+" * "+f+" +\n                      wR * "+f+" + wC")+";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var x=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===e&&(x="avgValue / count");var w=4*Math.floor(i/4),k=i%4,S="\n      if ("+y+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+s+", "+u+");\n      const ivec3 pads = ivec3("+m+", "+g+", "+b+");\n      const float initializationValue = "+v+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+t.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+v+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+h+";\n            wD += "+c+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+t.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+p+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+t.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+w+"; wC += 4) {\n              int xC = xCCorner + wC * "+d+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+d+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+d+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+d+", ch)\n              );\n\n              "+S+"\n            }\n\n            int xC = xCCorner + "+w+";\n            if ("+(1===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+S+"\n            } else if ("+(2===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+d+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+S+"\n            } else if ("+(3===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+d+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+d+", ch),\n                initializationValue\n              );\n\n              "+S+"\n            }\n          }\n          setOutput("+x+");\n        }\n      }\n    "}},Hs=function(t,e){this.variableNames=["x"];var n=t.windowSize,r=t.batchSize,a=t.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===e?o="1.0":"min"===e?(o="1.0 / 1e-20",s="min"):"max"===e&&(o="-1.0 / 1e-20",s="max");var u=e+"("+e+"("+e+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===e?u="sumValue":"prod"===e?u="prodValue":"all"===e?u="allValue":"any"===e&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,d="\n      if ("+("sum"===e)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===e)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="vec4";"all"===e?(o="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===e&&(o="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+p+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+d+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(2===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+d+"\n        } else if ("+(3===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+d+"\n        }\n        setOutput("+u+");\n      }\n    "},qs=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+to(["r","c","d"],e)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+eo(t)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+t[1]+";\n        int cols = "+t[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Ks=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,a=r[1],i=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],h=c[1]/l[1],p=1/d,f=1/h,m=2*Math.ceil(p)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Xs=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Ys=function(t,e,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Js=function(t,e,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=e.shape;var r=e.shape,a=r[1],i=r[2],o=t.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],d=c[0]/l[0],h=c[1]/l[1],p=1/d,f=1/h,m=2*Math.ceil(p)+2,g=2*Math.ceil(f)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+d+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+f+");\n\n        const int winHeight = int("+m+");\n        const int winWidth = int("+g+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},Zs=function(t,e,n,r){this.variableNames=["A"],this.outputShape=[];var a=t[0],i=t[1],o=t[2],s=t[3];this.outputShape=[a,e,n,s];var u=[r&&e>1?i-1:i,r&&n>1?o-1:o],c=[r&&e>1?e-1:e,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Qs=function(t,e){this.variableNames=["x"];var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=t,1!==n){var r=t.map((function(n,r){return function(n){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),a=po(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+t[0]+" - coord - 1));\n        }\n      "},tu=function(t,e){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=t.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=t;var r=Zi("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=po(n);function s(n){var r=t.map((function(r,a){return function(n,r){return-1!==e.indexOf(n)&&1!==t[n]?t[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+t[0]+" - rc - 1),\n            "+t[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+t[0]+" - (rc  + 1) - 1),\n                "+t[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(t){return s(t)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",s(t)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(t){return t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(t){return t[n-1]="("+t[n-1]+" + 1)",t[n-2]="("+t[n-2]+" + 1)",s(t)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},eu=function(t,e,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=po(a.length),u=po(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",d="";1===r?d="i":2===r&&(d="i, coords[1]");var h="getUpdates("+d+")",p=e>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+t+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+e+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+p+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+h+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},nu=function(t,e){this.variableNames=["x","segmentIds"];var n=t.windowSize,r=t.batchSize,a=t.inSize,i=t.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var d="";a%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+d+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},ru=function(t,e,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=e,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<e.length;u++)s.push(""+i[u]),u<t&&o.push(""+i[u]);r=o.join(),a=s.join()}var c=po(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},au=function(){function t(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var e,n=po(this.rank),r="uniform int start["+this.rank+"];",a=function(t){if(1===t)return"sourceLoc";if(t<=6)return iu.slice(0,t).map((function(t){return"sourceLoc."+t})).join(",");throw Error("Slicing for rank "+t+" is not yet supported")}(this.rank);e="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+t.map((function(t,e){return"sourceLoc."+iu[e]+" = start["+e+"] + coords."+iu[e]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+e+"\n        setOutput(getSource("+a+"));\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),iu=["x","y","z","w","u","v"],ou=function(){function t(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var e=po(this.rank),n=Zi("coords",this.rank),r=Zi("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+t[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+t[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+e+"("+t.map((function(t,e){return"start["+e+"]"})).join()+");":t.map((function(t,e){return r[e]+" = "+n[e]+" + start["+e+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+e+" coords = getOutputCoords();\n        "+e+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return t.prototype.getCustomSetupFunc=function(t){var e=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(n,r){null==e.startLoc&&(e.startLoc=n.getUniformLocationNoThrow(r,"start"),null==e.startLoc)||n.gl.uniform1iv(e.startLoc,t)}},t}(),su=function(t,e,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=po(n.length),i=po(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(t,e){return s++,1===n.length?"coords * strides["+e+"] + begin["+e+"]":"coords["+(s-1)+"] * strides["+e+"] + begin["+e+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+t+");\n      "+a+" strides = "+a+"("+e+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},uu=function(){function t(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return t.prototype.acquireTexture=function(t,e,n){var r,a=cu(e,n),i=lu(t,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===Kt.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):a===Kt.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):a===Kt.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):a===Kt.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):a===Kt.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[i].push(r),r},t.prototype.releaseTexture=function(t,e,n,r){if(null!=this.freeTextures){var a=lu(e,cu(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(t),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(t);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},t.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},t.prototype.getNumUsedTextures=function(){return this.numUsedTextures},t.prototype.getNumFreeTextures=function(){return this.numFreeTextures},t.prototype.dispose=function(){var t=this;if(null!=this.freeTextures){for(var e in this.freeTextures)this.freeTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));for(var e in this.usedTextures)this.usedTextures[e].forEach((function(e){t.gpgpu.deleteMatrixTexture(e)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},t}();function cu(t,e){if(t===qt.UPLOAD)return Kt.PACKED_2X2_FLOAT32;if(t===qt.RENDER||null==t)return function(t){return d().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Kt.PACKED_2X2_FLOAT32:Kt.UNPACKED_FLOAT32:t?Kt.PACKED_2X2_FLOAT16:Kt.UNPACKED_FLOAT16}(e);if(t===qt.DOWNLOAD||t===qt.PIXELS)return Kt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+t)}function lu(t,e,n){return t[0]+"_"+t[1]+"_"+e+"_"+n}var du=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[r]*e[r];this.outputShape=n,this.rank=n.length;var a=po(this.rank),i=function(t){var e=t.length;if(e>5)throw Error("Tile for rank "+e+" is not yet supported");if(1===e)return"imod(resRC, "+t[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<t.length;a++)r.push("imod("+n[a]+", "+t[a]+")");return r.join()}(t);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},hu=1.7580993408473768,pu=1.0507009873554805,fu=function(t,e){this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        "+e+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},mu="if (isnan(x)) return x;",gu="return x;",bu="return abs(x);",yu=mu+"\n  return (x < 0.0) ? 0.0 : x;\n",vu=mu+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",xu="return (x >= 0.0) ? x : (exp(x) - 1.0);",wu="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+hu+";\n  float scale = "+pu+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",ku="return -x;",Su="return ceil(x);",Ou="return floor(x);",_u="return exp(x);",Cu="return exp(x) - 1.0;",Tu=mu+"\n  return sin(x);\n",Iu=mu+"\n  return cos(x);\n",Nu=mu+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",Eu=mu+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",Au=mu+"\n  return atan(x);\n",Ru=mu+"return log(x + sqrt(x * x + 1.0));",ju=mu+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Du=mu+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Fu="return x;",Mu="return x;",Pu="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",$u="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Lu="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Bu=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},zu=function(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var e=t.length,n=Zi("rc",e),r=po(e),a=function(t,e){if(1===t)return"rc";for(var n="",r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}(e,n),i=n.slice(-2),o=e<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},Wu={};function Vu(t,e){if(void 0===e&&(e=!1),"linear"===t)return e?Mu:gu;if("relu"===t)return e?Pu:yu;if("elu"===t)return e?Lu:xu;if("relu6"===t)return e?$u:vu;if("prelu"===t)return e?Ao:Io;throw new Error("Activation "+t+" has not been implemented for the WebGL backend.")}var Uu=600,Gu=function(t){function e(e){var n,r=t.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!d().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var a=Zt(d().getNumber("WEBGL_VERSION"));r.binaryCache=((n=d().getNumber("WEBGL_VERSION"))in Wu||(Wu[n]={}),Wu[n]),r.gpgpu=new Es(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new uu(r.gpgpu),r.numMBBeforeWarning=null==d().global.screen?1024:d().global.screen.height*d().global.screen.width*window.devicePixelRatio*Uu/1024/1024,r.texData=new pi(r,Vt),r}return o(e,t),e.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},e.prototype.write=function(t,e,n){if(d().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n&&null!=t)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:e,dtype:n,values:t,usage:qt.UPLOAD}),r},e.prototype.move=function(t,e,n,r){if(d().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(t,{shape:n,dtype:r,values:e,usage:qt.UPLOAD})},e.prototype.readSync=function(t){var e=this.texData.get(t),n=e.values,r=e.dtype,a=e.complexTensors,i=e.slice,o=e.shape,s=e.isPacked;if(null!=i){var u=void 0;u=s?new Bu(o,Fu):new fu(o,Fu);var c=this.runWebGLProgram(u,[{dataId:t,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(t);if("string"===r)return n;var d,h,p=null!=this.activeTimers;return p&&(d=ot()),h="complex64"===r?Ri(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(t),p&&(this.downloadWaitMs+=ot()-d),this.convertAndCacheOnCPU(t,h)},e.prototype.read=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a,i,o,s,c,l,h,p,f,m,g,b,y,v,x,w,k,S,O;return u(this,(function(u){switch(u.label){case 0:if(this.pendingRead.has(t))return e=this.pendingRead.get(t),[2,new Promise((function(t){return e.push(t)}))];if(n=this.texData.get(t),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.complexTensors,c=n.isPacked,null!=i)return l=void 0,l=c?new Bu(a,Fu):new fu(a,Fu),h=this.runWebGLProgram(l,[{dataId:t,shape:a,dtype:o}],o),p=this.read(h.dataId),this.disposeData(h.dataId),[2,p];if(null!=r)return[2,this.convertAndCacheOnCPU(t)];if(!d().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===d().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return f=null,"complex64"!==o&&d().get("WEBGL_BUFFER_SUPPORTED")&&(m=this.decode(t),g=this.texData.get(m.dataId),f=(O=this.gpgpu).createBufferFromTexture.apply(O,[g.texture].concat(te(a)))),this.pendingRead.set(t,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:u.sent(),u.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return y=u.sent(),v=y[0],x=y[1],b=Ri(v,x),[3,5];case 4:null==f?b=this.getValuesFromTexture(t):(w=A(a),b=this.gpgpu.downloadFloat32MatrixFromBuffer(f,w)),u.label=5;case 5:return null!=m&&this.disposeData(m.dataId),k=this.convertAndCacheOnCPU(t,b),S=this.pendingRead.get(t),this.pendingRead.delete(t),S.forEach((function(t){return t(k)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),[2,k]}}))}))},e.prototype.checkNumericalProblems=function(t){if(null!=t)for(var e=0;e<t.length;e++){var n=t[e];if(!oe(n)){if(d().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},e.prototype.getValuesFromTexture=function(t){var e,n=this.texData.get(t),r=n.shape,a=n.dtype,i=n.isPacked,o=A(r);if(d().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(t),u=this.texData.get(s.dataId),c=(e=this.gpgpu).downloadMatrixFromPackedTexture.apply(e,[u.texture].concat(te(r))).subarray(0,o);return this.disposeData(s.dataId),c}var l=d().getBool("WEBGL_PACK")&&!0===i,h=l?Fe(r):r,p=l?new rs(h):new ns(h),f=this.runWebGLProgram(p,[{shape:h,dtype:a,dataId:t}],"float32"),m=this.texData.get(f.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(m.texture,m.texShape[0],m.texShape[1]).subarray(0,o);return this.disposeData(f.dataId),g},e.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a,i,o,s;return u(this,(function(u){switch(u.label){case 0:return e=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,t(),a=E(this.activeTimers.map((function(t){return t.query}))).filter((function(t){return null!=t})),i=E(this.activeTimers.map((function(t){return t.name}))).filter((function(t){return null!=t})),this.activeTimers=e,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return s=u.sent(),o.kernelMs=C(s),o.getExtraProfileInfo=function(){return s.map((function(t,e){return{name:i[e],ms:t}})).map((function(t){return t.name+": "+t.ms})).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}}))}))},e.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},e.prototype.startTimer=function(){return d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:ot(),endMs:null}},e.prototype.endTimer=function(t){return d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),t):(t.endMs=ot(),t)},e.prototype.getQueryTime=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return d().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(t)]:[2,(e=t).endMs-e.startMs]}))}))},e.prototype.disposeData=function(t){if(!this.pendingDisposal.has(t)){if(this.pendingRead.has(t))return this.pendingDisposal.add(t),void this.pendingDeletes++;if(this.texData.has(t)){this.releaseGPUData(t);var e=this.texData.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.texData.delete(t)}}},e.prototype.releaseGPUData=function(t){var e=this.texData.get(t),n=e.texture,r=e.dtype,a=e.texShape,i=e.usage,o=e.isPacked,s=e.slice,u=s&&s.origDataId||t,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(t);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},e.prototype.getTexture=function(t){return this.uploadToGPU(t),this.texData.get(t).texture},e.prototype.getDataInfo=function(t){return this.texData.get(t)},e.prototype.getCPUBackend=function(){return d().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Vt.findBackend("cpu")),this.cpuBackend):null},e.prototype.shouldExecuteOnCPU=function(t,e){var n=this;return void 0===e&&(e=128),null!=this.getCPUBackend()&&t.every((function(t){return null==n.texData.get(t.dataId).texture&&A(t.shape)<e}))},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.complex=function(t,e){var n=this.makeOutput(t.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:Vt.keep(t.clone()),imag:Vt.keep(e.clone())},n},e.prototype.real=function(t){return this.texData.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.texData.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.slice(t,e,n);if(0===A(n))return Pn([],n,t.dtype);var r=this.texData.get(t.dataId).isPacked,a=ti(t.shape,e,n);if(r||!a){var i=d().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ou(n):new au(n),o=i.getCustomSetupFunc(e);return this.compileAndRun(i,[t],null,o)}return this.uploadToGPU(t.dataId),this.shallowSlice(t,e,n)},e.prototype.shallowSlice=function(t,e,n){var r=this.texData.get(t.dataId),a=this.makeOutput(n,t.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=t.dtype;var o=ei(e,t.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||t.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},e.prototype.stridedSlice=function(t,e,n,r){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.stridedSlice(t,e,n,r);var a=Ja(e,n,r);if(a.some((function(t){return 0===t})))return Pn([],a);var i=new su(e,r,a);return this.compileAndRun(i,[t])},e.prototype.reverse=function(t,e){var n=d().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tu(t.shape,e):new Qs(t.shape,e);return this.compileAndRun(n,[t])},e.prototype.concat=function(t,e){if("complex64"===t[0].dtype){var n=t.map((function(t){return Fn(t)})),r=t.map((function(t){return Mn(t)}));return Dn(this.concat(n,e),this.concat(r,e))}if(this.shouldExecuteOnCPU(t))return this.cpuBackend.concat(t,e);if(1===t.length)return t[0];if(t.length>d().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(t.length/2),i=this.concat(t.slice(0,a),e),o=this.concat(t.slice(a),e);return this.concat([i,o],e)}if(d().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].rank>1){var s=new Po(t.map((function(t){return t.shape})),e);return this.compileAndRun(s,t)}var u=Rn(t.map((function(t){return t.shape})),e),c=t.map((function(t){return t.as2D(-1,A(t.shape.slice(e)))})),l=new Mo(c.map((function(t){return t.shape})));return this.compileAndRun(l,c).reshape(u)},e.prototype.neg=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.neg(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,ku,t.dtype);var e=new fu(t.shape,ku);return this.compileAndRun(e,[t])},e.prototype.batchMatMul=function(t,e,n,r){var a=n?t.shape[2]:t.shape[1],i=r?e.shape[1]:e.shape[2],o=n?t.shape[1]:t.shape[2],s=t.shape[0];if((1===a||1===i)&&o>1e3){n&&(t=hi(t,[0,2,1])),r&&(e=hi(e,[0,2,1]));var u=1===i?t:t.as3D(s,o,1),c=1===i?2:1,l=1===i?e.as3D(s,1,o):e;return this.multiply(u,l).sum(c,!0)}var d=Dt(t.dtype,e.dtype),h=new $s(t.shape,[s,a,i],n,r);return this.compileAndRun(h,[t,e],d)},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,a=t.transposeB,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=r?e.shape[2]:e.shape[1],c=a?n.shape[1]:n.shape[2],l=e.shape[0],d=Dt(e.dtype,n.dtype),h=null!=i,p=null!=s,f=o?Vu(o,!0):null,m=new $s(e.shape,[l,u,c],r,a,h,f,p),g=[e,n];return i&&g.push(i),s&&g.push(s),this.compileAndRun(m,g,d)},e.prototype.multiply=function(t,e){if("complex64"===t.dtype){var n=this.texData.get(t.dataId),r=this.texData.get(e.dataId),a=new So(wo,t.shape,e.shape),i=new So(ko,t.shape,e.shape),o=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag),this.makeComplexComponentTensorInfo(e,r.complexTensors.real),this.makeComplexComponentTensorInfo(e,r.complexTensors.imag)],s=this.compileAndRun(a,o),u=this.compileAndRun(i,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.multiply(t,e);if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Co,t.dtype);var l=new No(Co,t.shape,e.shape);return this.compileAndRun(l,[t,e],t.dtype)},e.prototype.batchNormalization=function(t,e,n,r,a,i){var o=[t,e,n],s=null;null!=i&&(s=i.shape,o.push(i));var u=null;if(null!=a&&(u=a.shape,o.push(a)),d().getBool("WEBGL_PACK_NORMALIZATION")){var c=new xo(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(c,o)}var l=new vo(t.shape,e.shape,n.shape,s,u,r);return this.compileAndRun(l,o)},e.prototype.localResponseNormalization4D=function(t,e,n,r,a){var i=d().getBool("WEBGL_PACK_NORMALIZATION")?new Fs(t.shape,e,n,r,a):new js(t.shape,e,n,r,a);return this.compileAndRun(i,[t])},e.prototype.LRNGrad=function(t,e,n,r,a,i,o){var s=new Ds(e.shape,r,a,i,o);return this.compileAndRun(s,[e,n,t])},e.prototype.tile=function(t,e){if("string"===t.dtype){var n=this.readSync(t.dataId).map((function(t){return ct(t)}));return Gi(or(t.shape,t.dtype,n),e)}var r=new du(t.shape,e);return this.compileAndRun(r,[t])},e.prototype.pad=function(t,e,n){var r=d().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vs(t.shape,e,n):new Ws(t.shape,e,n);return this.compileAndRun(r,[t])},e.prototype.gather=function(t,e,n){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.gather(t,e,n);var r=new ls(t.shape,e.size,n);return this.compileAndRun(r,[t,e])},e.prototype.batchToSpaceND=function(t,e,n){T(t.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),a=vr(t.shape,e,r),i=xr(a.length,e.length),o=wr(t.shape,e,r),s=kr(n,e.length),u=Sr(o,n,e.length);return hi(t.reshape(a),i).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){T(t.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=e.reduce((function(t,e){return t*e})),a=[[0,0]];a.push.apply(a,n);for(var i=1+e.length;i<t.shape.length;++i)a.push([0,0]);var o=t.pad(a),s=vr(o.shape,e,r,!1),u=xr(s.length,e.length,!1),c=wr(o.shape,e,r,!1);return hi(o.reshape(s),u).reshape(c)},e.prototype.reduce=function(t,e,n){var r=t.shape[0],a=t.shape[1],i=Ua(a),o=new Hs({windowSize:i,inSize:a,batchSize:r},e),s=this.compileAndRun(o,[t],n);return 1===s.shape[1]?s:this.reduce(s,e,n)},e.prototype.argReduce=function(t,e,n){void 0===n&&(n=null);var r=t.shape[0],a=t.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=Ua(a),o=new Yi({windowSize:i,inSize:a,batchSize:r},e,null==n),s=[t];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(t,e,u)},e.prototype.argReducePacked=function(t,e,n){void 0===n&&(n=null);var r=null!=n?n.shape:t.shape,a=Ua(r[r.length-1]),i=new go(r,a,e,null==n),o=null==n?[t]:[t,n],s=this.compileAndRun(i,o,"int32");return s.rank===t.rank?this.argReducePacked(t,e,s):s},e.prototype.sum=function(t,e){Tn("sum",e,t.rank);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a),o=Ft(t.dtype);return this.reduce(i,"sum",o).reshape(r)},e.prototype.prod=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.prod(t,e);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a),o=Ft(t.dtype);return this.reduce(i,"prod",o).reshape(r)},e.prototype.unsortedSegmentSum=function(t,e,n){var r=0,a=In([r],t.rank),i=t;null!=a&&(i=hi(t,a),r=En(1,t.rank)[0]);var o=function(t,e,n){for(var r=[],a=t.length,i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}(i.shape,r,n),s=A([i.shape[r]]),u=i.as2D(-1,s),c=Ft(t.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",e,c,n).reshape(o);return null!=a&&(l=hi(l,Nn(a))),l},e.prototype.segOpCompute=function(t,e,n,r,a){var i=t.shape[0],o=t.shape[1],s=function(t,e){var n,r=!1;for(t<=Va?(n=t,r=!0):n=tt(t,Math.floor(Math.sqrt(t)));!r;)n>e||n===t?r=!0:n=tt(t,n+1);return n}(o,a),u=new nu({windowSize:s,inSize:o,batchSize:i,numSegments:a},e),c=this.compileAndRun(u,[t,n],r);return c.shape[1]===a?c:(n=Jn(0,a).tile([o/s]),this.segOpCompute(c,e,n,r,a))},e.prototype.argMinMaxReduce=function(t,e,n){var r=[e];if(Tn("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,t.rank),!d().getBool("WEBGL_PACK_REDUCE")||t.rank<=2){var a=_n(t.shape,r),i=a[0],o=A(a[1]),s=t.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(t,n)},e.prototype.argMin=function(t,e){return this.argMinMaxReduce(t,e,"min")},e.prototype.argMax=function(t,e){return this.argMinMaxReduce(t,e,"max")},e.prototype.cumsum=function(t,e,n,r){if(e!==t.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(t.rank-1)+" but got axis="+e);var a=new Yo(t.shape,n,r);return this.compileAndRun(a,[t])},e.prototype.equal=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(equal(a, b));\n","bool");var n=new No("return float(a == b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.notEqual=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(notEqual(a, b));\n","bool");var n=new No("return float(a != b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.less=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.less(t,e);if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThan(a, b));\n","bool");var n=new No("return float(a < b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.lessEqual=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new No("return float(a <= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greater=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.greater(t,e);if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new No("return float(a > b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.greaterEqual=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new No("return float(a >= b);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalNot=function(t){var e=new fu(t.shape,"return float(!(x >= 1.0));");return this.compileAndRun(e,[t])},e.prototype.logicalAnd=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new No("return float(a >= 1.0 && b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.logicalOr=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new No("return float(a >= 1.0 || b >= 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e],"bool")},e.prototype.select=function(t,e,n){var r=new ru(t.rank,e.shape,e.rank);return this.compileAndRun(r,[t,e,n],Dt(e.dtype,n.dtype))},e.prototype.where=function(t){yn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var e=t.dataSync();return qi(t.shape,e)},e.prototype.topk=function(t,e,n){return Hi(t.dataSync(),t.shape,t.dtype,e)},e.prototype.min=function(t,e){Tn("min",e,t.rank);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},e.prototype.minimum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.minimum(t,e);var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new No("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.mod=function(t,e){var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new No("if (b == 0.0) return NAN;\n  return mod(a, b);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.max=function(t,e){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.max(t,e);Tn("max",e,t.rank);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},e.prototype.maximum=function(t,e){if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.maximum(t,e);var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new No("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.all=function(t,e){Tn("all",e,t.rank);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},e.prototype.any=function(t,e){Tn("any",e,t.rank);var n=_n(t.shape,e),r=n[0],a=A(n[1]),i=t.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},e.prototype.floorDiv=function(t,e){if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new No("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",t.shape,e.shape);return this.compileAndRun(n,[t,e],"int32")},e.prototype.add=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,Oo);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.add(t,e);var n=Dt(t.dtype,e.dtype);if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,Oo,n);var r=new No(Oo,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.packedUnaryOp=function(t,e,n){var r=new Bu(t.shape,e);return this.compileAndRun(r,[t],n)},e.prototype.packedBinaryOp=function(t,e,n,r,a){void 0===a&&(a=!1);var i=new Ro(n,t.shape,e.shape,a);return this.compileAndRun(i,[t,e],r)},e.prototype.complexSeparableBinaryOp=function(t,e,n){var r=this,a=this.texData.get(t.dataId),i=this.texData.get(e.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(t,i),u=r.makeComplexComponentTensorInfo(e,o),c=new No(n,t.shape,e.shape);return r.compileAndRun(c,[s,u],Dt(i.dtype,o.dtype))})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},e.prototype.makeComplexComponentTensorInfo=function(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}},e.prototype.addN=function(t){if(1===t.length)return t[0];if(t.length>d().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var e=Math.floor(t.length/2),n=this.addN(t.slice(0,e)),r=this.addN(t.slice(e));return this.addN([n,r])}var a=t.map((function(t){return t.dtype})).reduce((function(t,e){return Dt(t,e)})),i=t.map((function(t){return t.shape})),o=d().getBool("WEBGL_PACK")?new Xi(t[0].shape,i):new Ki(t[0].shape,i);return this.compileAndRun(o,t,a)},e.prototype.subtract=function(t,e){if("complex64"===t.dtype&&"complex64"===e.dtype)return this.complexSeparableBinaryOp(t,e,_o);if(this.shouldExecuteOnCPU([t,e]))return this.cpuBackend.subtract(t,e);var n=Dt(t.dtype,e.dtype);if(d().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(t,e,_o,t.dtype);var r=new No(_o,t.shape,e.shape);return this.compileAndRun(r,[t,e],n)},e.prototype.pow=function(t,e){var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new No("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",t.shape,e.shape),r=Dt(t.dtype,e.dtype);return this.compileAndRun(n,[t,e],r)},e.prototype.ceil=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.ceil(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Su,t.dtype);var e=new fu(t.shape,Su);return this.compileAndRun(e,[t])},e.prototype.floor=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.floor(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Ou,t.dtype);var e=new fu(t.shape,Ou);return this.compileAndRun(e,[t])},e.prototype.sign=function(t){var e=new fu(t.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(e,[t])},e.prototype.isNaN=function(t){var e=new fu(t.shape,"return float(isnan(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isInf=function(t){var e=new fu(t.shape,"return float(isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.isFinite=function(t){var e=new fu(t.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(e,[t],"bool")},e.prototype.round=function(t){var e=new fu(t.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(e,[t])},e.prototype.exp=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.exp(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,_u,t.dtype);var e=new fu(t.shape,_u);return this.compileAndRun(e,[t])},e.prototype.expm1=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.expm1(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Cu,t.dtype);var e=new fu(t.shape,Cu);return this.compileAndRun(e,[t])},e.prototype.softmax=function(t,e){var n=L([e],t.shape),r=this.max(t,n),a=Cn(r.shape,n),i=this.subtract(t,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return Ba(o,s)},e.prototype.log=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.log(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",t.dtype);var e=new fu(t.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(e,[t])},e.prototype.log1p=function(t){var e=new fu(t.shape,"return log(1.0 + x);");return this.compileAndRun(e,[t])},e.prototype.sqrt=function(t){var e=new fu(t.shape,"return sqrt(x);");return this.compileAndRun(e,[t])},e.prototype.rsqrt=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.rsqrt(t);var e=new fu(t.shape,"return inversesqrt(x);");return this.compileAndRun(e,[t])},e.prototype.reciprocal=function(t){var e=new fu(t.shape,"return 1.0 / x;");return this.compileAndRun(e,[t])},e.prototype.relu=function(t){var e;return e=d().getBool("WEBGL_PACK")?new Bu(t.shape,Pu):new fu(t.shape,yu),this.compileAndRun(e,[t])},e.prototype.relu6=function(t){var e;return e=d().getBool("WEBGL_PACK")?new Bu(t.shape,$u):new fu(t.shape,vu),this.compileAndRun(e,[t])},e.prototype.prelu=function(t,e){var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro(Ao,t.shape,e.shape):new No(Io,t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.elu=function(t){if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,Lu,t.dtype);var e=new fu(t.shape,xu);return this.compileAndRun(e,[t])},e.prototype.eluDer=function(t,e){var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",t.shape,e.shape):new No("return (b >= 1.0) ? a : a * (b + 1.0);",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.selu=function(t){var e=new fu(t.shape,wu);return this.compileAndRun(e,[t])},e.prototype.int=function(t){var e=new fu(t.shape,"return float(int(x));");return this.compileAndRun(e,[t],"int32")},e.prototype.clip=function(t,e,n){var r,a=(r=d().getBool("WEBGL_PACK_CLIP")?new Do(t.shape):new jo(t.shape)).getCustomSetupFunc(e,n);return this.compileAndRun(r,[t],null,a)},e.prototype.abs=function(t){if(this.shouldExecuteOnCPU([t]))return this.cpuBackend.abs(t);if(d().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(t,bu,t.dtype);var e=new fu(t.shape,bu);return this.compileAndRun(e,[t])},e.prototype.complexAbs=function(t){var e=this.texData.get(t.dataId),n=new Fo(t.shape),r=[this.makeComplexComponentTensorInfo(t,e.complexTensors.real),this.makeComplexComponentTensorInfo(t,e.complexTensors.imag)];return this.compileAndRun(n,r)},e.prototype.sigmoid=function(t){var e=new fu(t.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(e,[t])},e.prototype.softplus=function(t){var e=new fu(t.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(e,[t])},e.prototype.sin=function(t){var e=new fu(t.shape,Tu);return this.compileAndRun(e,[t])},e.prototype.cos=function(t){var e=new fu(t.shape,Iu);return this.compileAndRun(e,[t])},e.prototype.tan=function(t){var e=new fu(t.shape,"return tan(x);");return this.compileAndRun(e,[t])},e.prototype.asin=function(t){var e=new fu(t.shape,Nu);return this.compileAndRun(e,[t])},e.prototype.acos=function(t){var e=new fu(t.shape,Eu);return this.compileAndRun(e,[t])},e.prototype.atan=function(t){var e=new fu(t.shape,Au);return this.compileAndRun(e,[t])},e.prototype.atan2=function(t,e){var n=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",t.shape,e.shape):new No("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",t.shape,e.shape);return this.compileAndRun(n,[t,e])},e.prototype.sinh=function(t){var e=new fu(t.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.cosh=function(t){var e=new fu(t.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(e,[t])},e.prototype.tanh=function(t){var e=new fu(t.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(e,[t])},e.prototype.asinh=function(t){var e=new fu(t.shape,Ru);return this.compileAndRun(e,[t])},e.prototype.acosh=function(t){var e=new fu(t.shape,ju);return this.compileAndRun(e,[t])},e.prototype.atanh=function(t){var e=new fu(t.shape,Du);return this.compileAndRun(e,[t])},e.prototype.erf=function(t){var e=new fu(t.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(e,[t])},e.prototype.step=function(t,e){var n=new fu(t.shape,function(t){return void 0===t&&(t=0),mu+"\n    return x > 0.0 ? 1.0 : float("+t+");\n  "}(e));return this.compileAndRun(n,[t])},e.prototype.conv2dByMatMul=function(t,e,n,r,a,i){var o=t.shape,s=this.texData.get(t.dataId),u=n.inChannels,c=o[0]*o[1]*o[2],l=n.outChannels,h="channelsLast"===n.dataFormat,p=(1===c||1===l)&&u>1e3,f=o[2]%2!=0&&!!s.isPacked;if(p||!d().getBool("WEBGL_LAZILY_UNPACK")||!d().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!f){var m=h?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],g=this.reshape(t,[1,m,n.inChannels]),b=this.reshape(e,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:g,b:b,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var y=h?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),v={dataId:t.dataId,shape:[1,y,n.inChannels],dtype:t.dtype},x=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,T($e(s.shape,v.shape),(function(){return"packed reshape "+s.shape+" to "+v.shape+" isn't free"}));var w=this.reshape(e,[1,n.inChannels,n.outChannels]),k=this.fusedBatchMatMul({a:v,b:w,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),S=this.texData.get(k.dataId);return T(S.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=x,S.shape=n.outShape,Vt.makeTensorFromDataId(k.dataId,n.outShape,k.dtype)},e.prototype.conv2dWithIm2Row=function(t,e,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,d="channelsLast"===n.dataFormat,h=o*s*u,p=l*c,f=[h,p],m=t.squeeze([0]),g=e.reshape([1,h,-1]),b=new Rs(f,m.shape,n),y=this.compileAndRun(b,[m]).reshape([1,f[0],f[1]]),v=null!=r,x=null!=i,w=a?Vu(a,!0):null,k=new $s(y.shape,[1,p,n.outChannels],!0,!1,v,w,x),S=[y,g];r&&S.push(r),x&&S.push(i);var O=this.compileAndRun(k,S);return d?O.reshape([1,l,c,n.outChannels]):O.reshape([1,n.outChannels,l,c])},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(e,n,r,a,i,o);if(d().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,n,r,a,i,o);var s=null!=a,u=null!=o,c=i?Vu(i,!1):null,l=new Go(r,s,c,u),h=[e,n];return a&&h.push(a),o&&h.push(o),this.compileAndRun(l,h)},e.prototype.conv2d=function(t,e,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(t,e,n);if(d().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,e,n);var r=new Go(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerInput=function(t,e,n){var r=new Bo(n);return this.compileAndRun(r,[t,e])},e.prototype.conv2dDerFilter=function(t,e,n){var r=new Lo(n);return this.compileAndRun(r,[t,e])},e.prototype.fusedDepthwiseConv2D=function(t){var e,n=t.input,r=t.filter,a=t.convInfo,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=d().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?Vu(o,u):null,l=[n,r],h=null!=i,p=null!=s;return h&&l.push(i),p&&l.push(s),u?(e=new Ko(a,h,c,p),this.compileAndRun(e,l)):(e=new qo(a,h,c,p),this.compileAndRun(e,l))},e.prototype.depthwiseConv2D=function(t,e,n){var r;return d().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Ko(n),this.compileAndRun(r,[t,e])):(r=new qo(n),this.compileAndRun(r,[t,e]))},e.prototype.depthwiseConv2DDerInput=function(t,e,n){var r=new Uo(n);return this.compileAndRun(r,[t,e])},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){var r=new Vo(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3d=function(t,e,n){var r=new Ho(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerInput=function(t,e,n){var r=new Wo(n);return this.compileAndRun(r,[t,e])},e.prototype.conv3dDerFilter=function(t,e,n){var r=new zo(n);return this.compileAndRun(r,[t,e])},e.prototype.maxPool=function(t,e){var n=new Us(e,"max",!1);return this.compileAndRun(n,[t])},e.prototype.avgPool=function(t,e){var n=new Us(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPoolBackprop=function(t,e,n,r){var a=new Us(r,"max",!0),i=this.compileAndRun(a,[e]),o=new Ms(r),s=this.compileAndRun(o,[t,i],e.dtype);return i.dispose(),s},e.prototype.avgPoolBackprop=function(t,e,n){var r=new bo(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.cast=function(t,e){return Ii(t,e,this)},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),a=0,i=0;i<t.rank;i++)i!==e&&(r[a++]=t.shape[i]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[e]=i,u[i]=this.slice(t,o,s).reshape(r);return u},e.prototype.avgPool3d=function(t,e){var n=new Gs(e,"avg",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.avgPool3dBackprop=function(t,e,n){var r=new yo(n);return this.compileAndRun(r,[t],e.dtype)},e.prototype.maxPool3d=function(t,e){var n=new Gs(e,"max",!1);return this.compileAndRun(n,[t],"float32")},e.prototype.maxPool3dBackprop=function(t,e,n,r){var a=new Gs(r,"max",!0),i=this.compileAndRun(a,[e]),o=new Ps(r),s=this.compileAndRun(o,[t,i],e.dtype);return i.dispose(),s},e.prototype.reshape=function(t,e){var n=this.texData.get(t.dataId);if(n.isPacked&&!$e(t.shape,e)&&(null===n.texture||!$e(n.shape,e))){var r=this.packedReshape(t,e);return Vt.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Ni(t,e)},e.prototype.resizeBilinear=function(t,e,n,r){var a=d().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Ys(t.shape,e,n,r):new Xs(t.shape,e,n,r);return this.compileAndRun(a,[t],"float32")},e.prototype.resizeBilinearBackprop=function(t,e,n){var r=new Ks(t,e,n);return this.compileAndRun(r,[t])},e.prototype.resizeNearestNeighbor=function(t,e,n,r){var a=new Zs(t.shape,e,n,r);return this.compileAndRun(a,[t])},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){var r=new Js(t,e,n);return this.compileAndRun(r,[t])},e.prototype.multinomial=function(t,e,n,r){var a=e?t:li(t),i=a.shape[0],o=a.shape[1],s=new Ls(i,o,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",u)},e.prototype.oneHot=function(t,e,n,r){var a=new Bs(t.size,e,n,r);return this.compileAndRun(a,[t])},e.prototype.diag=function(t){var e=new es(t.size);return this.compileAndRun(e,[t])},e.prototype.nonMaxSuppression=function(t,e,n,r,a){return yn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),$i(t.dataSync(),e.dataSync(),n,r,a)},e.prototype.cropAndResize=function(t,e,n,r,a,i){var o=new Xo(t.shape,e.shape,r,a,i);return this.compileAndRun(o,[t,e,n],"float32")},e.prototype.depthToSpace=function(t,e,n){T(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));var r=t.shape[0],a="NHWC"===n?t.shape[1]:t.shape[2],i="NHWC"===n?t.shape[2]:t.shape[3],o="NHWC"===n?t.shape[3]:t.shape[1],s=a*e,u=i*e,c=o/(e*e),l=new ts("NHWC"===n?[r,s,u,c]:[r,c,s,u],e,n);return this.compileAndRun(l,[t])},e.prototype.split=function(t,e,n){return Ui(t,e,n)},e.prototype.scatterND=function(t,e,n){var r=qa(0,t,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=t.reshape([i,a]),d=e.reshape([i,o]);if(0===u)return Ni(Pn([]),n);var h=Ln(0),p=new eu(i,a,l.rank,d.rank,s,c);return this.compileAndRun(p,[d,l,h]).reshape(n)},e.prototype.sparseToDense=function(t,e,n,r){var a=qa(0,t,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,u=a.outputSize,c=new eu(o,i,t.rank,e.rank,s,[u,1],!1);return this.compileAndRun(c,[e,t,r]).reshape(n)},e.prototype.fft=function(t){return this.fftImpl(t,!1)},e.prototype.ifft=function(t){return this.fftImpl(t,!0)},e.prototype.fftImpl=function(t,e){var n=this.texData.get(t.dataId),r=new us(os,t.shape,e),a=new us(ss,t.shape,e),i=[this.makeComplexComponentTensorInfo(t,n.complexTensors.real),this.makeComplexComponentTensorInfo(t,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),u=this.complex(o,s).as2D(t.shape[0],t.shape[1]);return o.dispose(),s.dispose(),u},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],a=za(t,e),i=a[0],o=a[1],s=a[2],u=a[3],c=e.reshape([o,r]),l=t.reshape([t.size/s,s]),d=new ds(r,u,[o,s]);return this.compileAndRun(d,[l,c]).reshape(i)},e.prototype.fill=function(t,e,n){if("string"===(n=n||Z(e))){var r=W(n,A(t));return r.fill(e),Vt.makeTensor(r,t,n,this)}var a=new cs(t,e),i=a.getCustomSetupFunc(e);return this.compileAndRun(a,[],n,i)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){return this.fill(t.shape,"string"===t.dtype?"":0,t.dtype)},e.prototype.linspace=function(t,e,n){return Ei(t,e,n)},e.prototype.makeTensorInfo=function(t,e){var n=this.write(null,t,e);return this.texData.get(n).usage=null,{dataId:n,shape:t,dtype:e}},e.prototype.makeOutput=function(t,e){var n=this.makeTensorInfo(t,e).dataId;return Vt.makeTensorFromDataId(n,t,e,this)},e.prototype.unpackTensor=function(t){var e=new zu(t.shape);return this.runWebGLProgram(e,[t],t.dtype)},e.prototype.packTensor=function(t){var e=new zs(t.shape);return this.runWebGLProgram(e,[t],t.dtype,null,!0)},e.prototype.packedReshape=function(t,e){var n=[je(t.shape)].concat(De(t.shape)),r={dtype:t.dtype,shape:n,dataId:t.dataId},a=[je(e)].concat(De(e)),i=new qs(a,n),o=this.runWebGLProgram(i,[r],t.dtype,null,!0);return{dataId:o.dataId,shape:e,dtype:o.dtype}},e.prototype.decode=function(t){var e,n=this.texData.get(t),r=n.isPacked,a=n.shape,i=n.dtype,o=Fe(a);return e=r?new Qo(o):new Zo(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(e,[{shape:o,dtype:i,dataId:t}],i,null,!0).dataId}},e.prototype.runWebGLProgram=function(t,e,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(t.outputShape,n),s=this.texData.get(o.dataId);if(t.packedOutput&&(s.isPacked=!0),t.outPackingScheme===Ht.DENSE){var u=te(t.outputShape);s.texShape=u.map((function(t){return 2*t}))}if(null!=t.outTexUsage&&(s.usage=t.outTexUsage),0===A(o.shape))return s.values=z(o.dtype,0),o;var c=[],l=e.map((function(e){if("complex64"===e.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(e.dataId);if(null==n.texture){if(!t.packedInputs&&A(e.shape)<=d().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:e.shape,texData:null,isUniform:!0,uniformValues:n.values};t.packedInputs&&(n.isPacked=!0,n.shape=e.shape)}else if(!!n.isPacked!=!!t.packedInputs)e=n.isPacked?i.unpackTensor(e):i.packTensor(e),c.push(e),n=i.texData.get(e.dataId);else if(n.isPacked&&!$e(n.shape,e.shape)){var r=e,a=e.shape;e.shape=n.shape,e=i.packedReshape(e,a),c.push(e),n=i.texData.get(e.dataId),r.shape=a}return i.uploadToGPU(e.dataId),{shape:e.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var h,p={shape:o.shape,texData:s,isUniform:!1},f=function(t,e,n){var r="";e.concat(n).forEach((function(t){var e=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0,n=t.isUniform?"uniform":t.texData.texShape;r+=t.shape+"_"+n+"_"+e}));var a=t.userCode,i=t.constructor.name;return i+"_"+r+"_"+a}(t,l,p),m=this.getAndSaveBinary(f,(function(){return function(t,e,n,r){var a=e.userCode,i=n.map((function(t,n){var r={logicalShape:t.shape,texShape:t.isUniform?null:t.texData.texShape,isUniform:t.isUniform,isPacked:!t.isUniform&&t.texData.isPacked,flatOffset:null};return null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0&&(r.flatOffset=t.texData.slice.flatOffset),{name:e.variableNames[n],shapeInfo:r}})),o=i.map((function(t){return t.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=ro(i,s,a,e.packedInputs),c=t.createProgram(u),l=null,h=t.getUniformLocation(c,"NAN",!1);1===d().getNumber("WEBGL_VERSION")&&(l=t.getUniformLocation(c,"INFINITY",!1));for(var p={},f=0;f<e.variableNames.length;f++){var m=e.variableNames[f];p[m]=t.getUniformLocation(c,m,!1),p["offset"+m]=t.getUniformLocation(c,"offset"+m,!1)}return{program:e,source:u,webGLProgram:c,uniformLocations:p,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:h}}(i.gpgpu,t,l,p)})),g=null!=this.activeTimers;if(g&&(h=this.startTimer()),function(t,e,n,r,a){As(e.inShapeInfos,n),As([e.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i,o[0],o[1]):t.setOutputMatrixTexture(i,o[0],o[1]),t.setProgram(e.webGLProgram),1===d().getNumber("WEBGL_VERSION")&&null!==e.infLoc&&t.gl.uniform1f(e.infLoc,1/0),null!==e.nanLoc&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((function(n,r){var a=e.program.variableNames[r],i=e.uniformLocations[a],o=e.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(A(n.shape)<2)t.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),t.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&t.gl.uniform1i(o,n.texData.slice.flatOffset),t.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(t,e.webGLProgram),t.executeProgram()}(this.gpgpu,m,l,p,r),c.forEach((function(t){return i.disposeData(t.dataId)})),g&&(h=this.endTimer(h),this.activeTimers.push({name:t.constructor.name,query:this.getQueryTime(h)})),!d().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var b=this.unpackTensor(o);return this.disposeData(o.dataId),b}return o},e.prototype.compileAndRun=function(t,e,n,r,a){void 0===a&&(a=!1),n=n||e[0].dtype;var i=this.runWebGLProgram(t,e,n,r,a);return Vt.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},e.prototype.getAndSaveBinary=function(t,e){return t in this.binaryCache||(this.binaryCache[t]=e()),this.binaryCache[t]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){var t=this;this.disposed||(d().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(e){t.gpgpu.deleteProgram(t.binaryCache[e].webGLProgram),delete t.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},e.prototype.floatPrecision=function(){var t=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=an((function(){if(!d().get("WEBGL_RENDER_FLOAT32_ENABLED")){var e=d().getBool("DEBUG");d().set("DEBUG",!1);var n=t.abs(Ln(1e-8)).dataSync()[0];if(d().set("DEBUG",e),n>0)return 32}return 16}))),this.floatPrecisionValue},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.uploadToGPU=function(t){var e,n=this.texData.get(t),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=ot());var d=n.texShape;if(null==d&&(d=Me(r,u),n.texShape=d),null!=i){var h=Fe(r),p=void 0,f=d[1],m=d[0],g=i instanceof Uint8Array;u?(f=(e=ee(d[0],d[1]))[0],m=e[1],p=new is(h,[m,f],g)):p=new as(h,[m,f],g);var b=this.makeTensorInfo([m,f],a);this.texData.get(b.dataId).usage=g?qt.PIXELS:qt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),f,m,i);var y=this.runWebGLProgram(p,[b],a,null,!0),v=this.texData.get(y.dataId);n.texture=v.texture,n.texShape=v.texShape,n.isPacked=v.isPacked,n.usage=v.usage,this.disposeData(b.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=ot()-c)}else{var x=this.acquireTexture(d,s,a,u);n.texture=x}}},e.prototype.convertAndCacheOnCPU=function(t,e){var n=this.texData.get(t),r=n.dtype;return this.releaseGPUData(t),null!=e&&(n.values=function(t,e){if("float32"===e||"complex64"===e)return t;if("int32"===e||"bool"===e){for(var n="int32"===e?new Int32Array(t.length):new Uint8Array(t.length),r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}throw new Error("Unknown dtype "+e)}(e,r)),n.values},e.prototype.acquireTexture=function(t,e,n,r){if(this.numBytesInGPU+=this.computeBytes(t,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(t,e,r)},e.prototype.computeBytes=function(t,e){return t[0]*t[1]*q(e)},e}(fi);function Hu(t,e){return t(e={exports:{}},e.exports),e.exports}Ut()&&Vt.registerBackend("webgl",(function(){return new Gu}),2),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t||"undefined"!=typeof self&&self;var qu=Hu((function(t){!function(t,e,n){function r(t){var e,n=this,r=(e=4022871197,function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});n.next=function(){var t=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=t-(n.c=0|t)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(t),n.s0<0&&(n.s0+=1),n.s1-=r(t),n.s1<0&&(n.s1+=1),n.s2-=r(t),n.s2<0&&(n.s2+=1),r=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function i(t,e){var n=new r(t),i=e&&e.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.alea=i}(0,t,!1)})),Ku=Hu((function(t){!function(t,e,n){function r(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xor128=i}(0,t,!1)})),Xu=Hu((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xorwow=i}(0,t,!1)})),Yu=Hu((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],n=(t^=t>>>7)^t<<24,n^=(t=r[a+1&7])^t>>>10,n^=(t=r[a+3&7])^t>>>3,n^=(t=r[a+4&7])^t<<7,t=r[a+7&7],n^=(t^=t<<13)^t<<9,r[a]=n,e.i=a+1&7,n},function(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xorshift7=i}(0,t,!1)})),Ju=Hu((function(t){!function(t,e,n){function r(t){var e=this;e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},function(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function i(t,e){null==t&&(t=+new Date);var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.xor4096=i}(0,t,!1)})),Zu=Hu((function(t){!function(t,e,n){function r(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function i(t,e){var n=new r(t),i=e&&e.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var t=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}e&&e.exports?e.exports=i:n&&n.amd?n((function(){return i})):this.tychei=i}(0,t,!1)})),Qu=Hu((function(t){!function(e,r){var a,i=this,o=256,s=6,u="random",c=r.pow(o,s),l=r.pow(2,52),d=2*l,h=o-1;function p(t,n,h){var p=[],y=g(function t(e,n){var r,a=[],i=typeof e;if(n&&"object"==i)for(r in e)try{a.push(t(e[r],n-1))}catch(t){}return a.length?a:"string"==i?e:e+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[t,b(e)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(o):(t=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(t)),b(t)}catch(t){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,b(e)]}}():t,3),p),v=new f(p),x=function(){for(var t=v.g(s),e=c,n=0;t<l;)t=(t+n)*o,e*=o,n=v.g(1);for(;t>=d;)t/=2,e/=2,n>>>=1;return(t+n)/e};return x.int32=function(){return 0|v.g(4)},x.quick=function(){return v.g(4)/4294967296},x.double=x,g(b(v.S),e),(n.pass||h||function(t,e,n,a){return a&&(a.S&&m(a,v),t.state=function(){return m(v,{})}),n?(r[u]=t,e):t})(x,y,"global"in n?n.global:this==r,n.state)}function f(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(t=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=h&i+t[a%n]+(e=s[a])],s[i]=e;(r.g=function(t){for(var e,n=0,a=r.i,i=r.j,s=r.S;t--;)e=s[a=h&a+1],n=n*o+s[h&(s[a]=s[i=h&i+e])+(s[i]=e)];return r.i=a,r.j=i,n})(o)}function m(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){for(var n,r=t+"",a=0;a<r.length;)e[h&a]=h&(n^=19*e[h&a])+r.charCodeAt(a++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(r["seed"+u]=p,g(r.random(),e),t.exports){t.exports=p;try{a=n(8)}catch(t){}}}([],Math)}));Qu.alea=qu,Qu.xor128=Ku,Qu.xorwow=Xu,Qu.xorshift7=Yu,Qu.xor4096=Ju,Qu.tychei=Zu;var tc=Qu.alea,ec=jn({addN_:function(t){T(Array.isArray(t),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),T(t.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+t.length}));var e=t.map((function(t,e){return wn(t,"tensors"+e,"addN")})),n=e[0];e.forEach((function(t){if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),e.forEach((function(t){if(!R(t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=e;return Vt.runKernelFunc((function(t,n){return t.addN(e)}),r,null,"AddN")}});function nc(){Qe("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function rc(t){return 0===t.rank||1===t.rank?t.as4D(1,1,1,t.size):2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}function ac(t,e,n,r,a,i){null==i&&(i=.001);var o,s,u=wn(t,"x","batchNorm"),c=wn(e,"mean","batchNorm"),l=wn(n,"variance","batchNorm");null!=a&&(o=wn(a,"scale","batchNorm")),null!=r&&(s=wn(r,"offset","batchNorm")),T(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),T(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),T(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var d={x:u,scale:o,offset:s,mean:c,variance:l},h={varianceEpsilon:i};return Vt.runKernelFunc((function(t,e){var n=rc(u),r=t.batchNormalization(n,ic(c),ic(l),i,ic(o),ic(s));return e([u,c,l,o]),r}),d,null,"FusedBatchNorm",h).reshape(u.shape)}function ic(t){return null==t?null:0===t.rank?t.as1D():1===t.rank?t:2===t.rank?t.as4D(1,1,t.shape[0],t.shape[1]):3===t.rank?t.as4D(1,t.shape[0],t.shape[1],t.shape[2]):t}var oc=jn({batchNormalization_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),nc(),ac(t,e,n,i,a,r)}}),sc=jn({batchNorm_:ac});function uc(t,e,n,r,a,i){var o,s,u=wn(t,"x","batchNorm"),c=wn(e,"mean","batchNorm"),l=wn(n,"variance","batchNorm");return null!=a&&(o=wn(a,"scale","batchNorm")),null!=r&&(s=wn(r,"offset","batchNorm")),T(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),T(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),T(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),sc(u,c,l,s,o,i)}var cc=jn({batchNormalization2d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),nc(),uc(t,e,n,i,a,r)}}),lc=jn({batchNorm2d_:uc});function dc(t,e,n,r,a,i){var o,s,u=wn(t,"x","batchNorm"),c=wn(e,"mean","batchNorm"),l=wn(n,"variance","batchNorm");return null!=a&&(o=wn(a,"scale","batchNorm")),null!=r&&(s=wn(r,"offset","batchNorm")),T(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),T(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),T(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),sc(u,c,l,s,o,i)}var hc=jn({batchNormalization3d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),nc(),dc(t,e,n,i,a,r)}}),pc=jn({batchNorm3d_:dc});function fc(t,e,n,r,a,i){var o,s,u=wn(t,"x","batchNorm"),c=wn(e,"mean","batchNorm"),l=wn(n,"variance","batchNorm");return null!=a&&(o=wn(a,"scale","batchNorm")),null!=r&&(s=wn(r,"offset","batchNorm")),T(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),T(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),T(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&T(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&T(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),sc(u,c,l,s,o,i)}var mc=jn({batchNormalization4d_:function(t,e,n,r,a,i){return void 0===r&&(r=.001),nc(),fc(t,e,n,i,a,r)}}),gc=jn({batchNorm4d_:fc}),bc=jn({broadcastTo_:function(t,e){var n=wn(t,"broadcastTo","x"),r=n.shape;if(e.some((function(t){return!(t>0)||t%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+e+"].");if(e.length<n.rank)throw new Error("broadcastTo(): shape.length="+e.length+" < input.rank="+n.rank+".");if(e.length>n.rank){for(var a=n.shape.slice();a.length<e.length;)a.unshift(1);n=n.reshape(a)}for(var i=n.shape,o=Array.from(e),s=e.length-1;s>=0;s--)if(i[s]===e[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+e+"].");var u=o.map((function(t,e){return t>1?e:-1})).filter((function(t){return t>=0}));if(0===u.length)return n.clone();var c={x:n},l={shape:e,inputShape:i};return Vt.runKernelFunc((function(t){return t.tile(n,o)}),c,(function(t){return{x:function(){return t.sum(u,!0)}}}),Rr,l)}}),yc=jn({clone_:function(t){var e=wn(t,"x","clone",null);return Vt.runKernelFunc((function(){return Vt.makeTensorFromDataId(e.dataId,e.shape,e.dtype)}),{x:e},null,Dr)}}),vc=jn({logicalAnd_:function(t,e){var n=wn(t,"a","logicalAnd","bool"),r=wn(e,"b","logicalAnd","bool");return Wr(n.shape,r.shape),Vt.runKernelFunc((function(t){return t.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),xc=jn({logicalNot_:function(t){var e=wn(t,"x","logicalNot","bool");return Vt.runKernelFunc((function(t){return t.logicalNot(e)}),{$x:e})}}),wc=jn({logicalOr_:function(t,e){var n=wn(t,"a","logicalOr","bool"),r=wn(e,"b","logicalOr","bool");return Wr(n.shape,r.shape),Vt.runKernelFunc((function(t){return t.logicalOr(n,r)}),{$a:n,$b:r})}}),kc=jn({logicalXor_:function(t,e){var n=wn(t,"a","logicalXor","bool"),r=wn(e,"b","logicalXor","bool");return Wr(n.shape,r.shape),wc(t,e).logicalAnd(vc(t,e).logicalNot())}}),Sc=jn({where_:function(t,e,n){var r=wn(e,"a","where"),a=wn(n,"b","where"),i=wn(t,"condition","where","bool");return I(r.shape,a.shape,"Error in where: "),1===i.rank?T(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):I(i.shape,a.shape,"Error in where: "),Vt.runKernelFunc((function(t,e){var n=t.select(i,r,a);return e([i]),n}),{$condition:i,$a:r,$b:a},(function(t,e){var n=e[0];return{$condition:function(){return Qn(n).toFloat()},$a:function(){return t.mul(n.cast(t.dtype))},$b:function(){return t.mul(n.logicalNot().cast(t.dtype))}}}))}}),Oc=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(a){switch(a.label){case 0:return[4,(e=wn(t,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=qi(e.shape,n),t!==e&&e.dispose(),[2,r]}}))}))},_c=jn({divNoNan_:function(t,e){var n,r=wn(t,"a","div"),a=wn(e,"b","div");r=(n=Mt(r,a))[0],a=n[1];var i=Ba(r,a),o=Qn(i),s=a.equal(o);return Sc(s,o,i)}}),Cc=jn({tile_:function(t,e){var n=wn(t,"x","tile",null);T(n.rank===e.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+e+"."}));var r=[n],a={x:n},i={reps:e};return Vt.runKernelFunc((function(t,r){var a=t.tile(n,e);return r([n]),a}),a,null,Fr,i,r)}}),Tc=jn({eye_:function(t,e,n,r){void 0===r&&(r="float32"),null==e&&(e=t);for(var a=or([t,e],r),i=t<=e?t:e,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(t,e);if(null==n)return s;if(1===n.length)return Cc(hr(s,0),[n[0],1,1]);if(2===n.length)return Cc(hr(hr(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return Cc(hr(hr(hr(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Ic=jn({multinomial_:function(t,e,n,r){void 0===r&&(r=!1);var a=wn(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,u=Vt.runKernelFunc((function(t){return t.multinomial(s,r,e,n)}),{logits2D:s});return 1===o?u.as1D():u}}),Nc=jn({oneHot_:function(t,e,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);var a=wn(t,"indices","oneHot","int32"),i=a.shape.concat([e]),o={indices:a=a.flatten()},s={depth:e,onValue:n,offValue:r};return Vt.runKernelFunc((function(t,i){return i([a]),t.oneHot(a,e,n,r)}),o,null,jr,s).reshape(i)}}),Ec=jn({pad_:function(t,e,n){void 0===n&&(n=0);var r=wn(t,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:e,constantValue:n},i={x:r};return Vt.runKernelFunc((function(t,a){return a([r]),t.pad(r,e,n)}),i,null,Mr,a)}}),Ac=jn({pad1d_:function(t,e,n){return void 0===n&&(n=0),T(2===e.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Ec(t,[e],n)}}),Rc=jn({pad2d_:function(t,e,n){return void 0===n&&(n=0),T(2===e.length&&2===e[0].length&&2===e[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ec(t,e,n)}}),jc=jn({pad3d_:function(t,e,n){return void 0===n&&(n=0),T(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ec(t,e,n)}}),Dc=jn({pad4d_:function(t,e,n){return void 0===n&&(n=0),T(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ec(t,e,n)}}),Fc=jn({rand_:function(t,e,n){var r=A(t),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=e();return Vt.makeTensor(a,t,n)}}),Mc=.001,Pc=.1;function $c(){return 32===Vt.backend.floatPrecision()?Mc:Pc}function Lc(t,e,n){var r=!0;if((H(t)||H(e))&&(r=!1),H(t)&&H(e)&&(r=!0),r){var a=t.constructor.name,i=e.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(t)&&Array.isArray(e)){var o=vn(t),s=vn(e);if(!R(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=H(t)?t:E(t),c=H(e)?e:E(e);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var d=u[l],h=c[l];if(!n(d,h))throw new Error("Arrays differ: actual["+l+"] = "+d+", expected["+l+"] = "+h+".\nActual:   "+u+".\nExpected: "+c+".")}}function Bc(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}var zc=Object.freeze({TEST_EPSILON_FLOAT16:Pc,expectArraysClose:function(t,e,n){return null==n&&(n=$c()),Lc(t,e,(function(t,e){return Bc(t,e,n)}))},testEpsilon:$c,expectPromiseToFail:function(t,e){t().then((function(){return e.fail()}),(function(){return e()}))},expectArraysEqual:function(t,e){var n="string"==typeof e||"number"==typeof e||"boolean"==typeof e?[e]:e;return X(t)||X(t[0])||X(e)||X(e[0])?Lc(t,n,(function(t,e){return t==e})):Lc(t,e,(function(t,e){return Bc(t,e,0)}))},expectNumbersClose:function(t,e,n){if(null==n&&(n=$c()),!Bc(t,e,n))throw new Error("Numbers differ: actual === "+t+", expected === "+e)},expectValuesInRange:function(t,e,n){for(var r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error("Value out of range:"+t[r]+" low: "+e+", high: "+n)},expectArrayBuffersEqual:function(t,e){expect(new Float32Array(t)).toEqual(new Float32Array(e))}}),Wc=function(){function t(t,e,n,r,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=tc(i.toString())}return t.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var e,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(e)},t.prototype.convertValue=function(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)},t.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},t}(),Vc=function(){function t(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;var a=r||Math.random();this.randu=tc(a.toString()),this.randn=new Wc(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return t.prototype.nextValue=function(){for(var t,e,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,e=1-.331*(t=r*r)*t,n=.5*t+this.d*(1-i+Math.log(i)),(a=this.randu())<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},t.prototype.convertValue=function(t){return"float32"===this.dtype?t:Math.round(t)},t}(),Uc=function(){function t(t,e,n,r){var a=this;if(void 0===t&&(t=0),void 0===e&&(e=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+e+" <= 1 and dtype is not float");this.random=tc(r)}return t.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},t.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},t}(),Gc=jn({randomGamma_:function(t,e,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new Vc(e,n,r,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Hc=jn({randomNormal_:function(t,e,n,r,a){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new Wc(e,n,r,!1,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),qc=jn({randomUniform_:function(t,e,n,r,a){void 0===e&&(e=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=or(t,r),o=new Uc(e,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),Kc=jn({square_:function(t){var e=wn(t,"x","square"),n=[e];return Vt.runKernelFunc((function(t,n){return n([e]),t.square(e)}),{x:e},null,"Square",{},n,[])}}),Xc=jn({squaredDifference_:function(t,e){var n,r=wn(t,"a","squaredDifference"),a=wn(e,"b","squaredDifference");n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape);var i={a:r,b:a},o=[r,a];return Vt.runKernelFunc((function(t,e){var n=t.squaredDifference(r,a);return e([r,a]),n}),i,(function(t,e){var n=e[0],r=e[1],a=Ln(2);return{a:function(){return t.mul(n.sub(r).mul(a))},b:function(){return t.mul(r.sub(n).mul(a))}}}),Ir,{},o,[])}}),Yc=jn({truncatedNormal_:function(t,e,n,r,a){if(void 0===e&&(e=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new Wc(e,n,r,!0,a),o=or(t,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),Jc=jn({equal_:function(t,e){var n,r=wn(t,"a","equal"),a=wn(e,"b","equal");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t){return t.equal(r,a)}),{$a:r,$b:a})}}),Zc=jn({equalStrict_:function(t,e){var n=wn(t,"a","equalStrict"),r=wn(e,"b","equalStrict");return I(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),Qc=jn({greater_:function(t,e){var n,r=wn(t,"a","greater"),a=wn(e,"b","greater");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t){return t.greater(r,a)}),{a:r,b:a},null,"Greater")}}),tl=jn({greaterEqual_:function(t,e){var n,r=wn(t,"a","greaterEqual"),a=wn(e,"b","greaterEqual");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t,e){var n=t.greaterEqual(r,a);return e([r,a]),n}),{a:r,b:a},(function(t,e){var n=e[0],r=e[1];return{a:function(){return Qn(n)},b:function(){return Qn(r)}}}),"GreaterEqual")}}),el=jn({greaterEqualStrict_:function(t,e){var n=wn(t,"a","greaterEqualStrict"),r=wn(e,"b","greaterEqualStrict");return I(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),nl=jn({greaterStrict_:function(t,e){var n=wn(t,"a","greaterStrict"),r=wn(e,"b","greaterStrict");return I(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),rl=jn({less_:function(t,e){var n,r=wn(t,"a","less"),a=wn(e,"b","less");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t){return t.less(r,a)}),{a:r,b:a},null,"Less")}}),al=jn({lessEqual_:function(t,e){var n,r=wn(t,"a","lessEqual"),a=wn(e,"b","lessEqual");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t,e){var n=t.lessEqual(r,a);return e([r,a]),n}),{a:r,b:a},null,"LessEqual")}}),il=jn({lessEqualStrict_:function(t,e){var n=wn(t,"a","lessEqualStrict"),r=wn(e,"b","lessEqualStrict");return I(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),ol=jn({lessStrict_:function(t,e){var n=wn(t,"a","lessStrict"),r=wn(e,"b","lessStrict");return I(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),sl=jn({notEqual_:function(t,e){var n,r=wn(t,"a","notEqual"),a=wn(e,"b","notEqual");return n=Mt(r,a),r=n[0],a=n[1],Wr(r.shape,a.shape),Vt.runKernelFunc((function(t){return t.notEqual(r,a)}),{a:r,b:a},null,"NotEqual")}}),ul=jn({notEqualStrict_:function(t,e){var n=wn(t,"a","notEqualStrict"),r=wn(e,"b","notEqualStrict");return I(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function cl(t,e){for(var n=[],r=t;r<e;++r)n.push(r);return n}function ll(t){for(var e=[],n=0;n<t.length;++n)for(var r=0;r<t[n].length;++r)e.push(t[n][r]);return e}var dl=jn({gather_:function(t,e,n){void 0===n&&(n=0);var r=wn(t,"x","gather"),a=wn(e,"indices","gather","int32");n=L(n,r.shape)[0];var i=function(t,e,n){for(var r=t.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(t.shape[s]),i*=t.shape[s];for(s=0;s<e.rank;s++)a.push(e.shape[s]);for(s=n+1;s<t.rank;s++)a.push(t.shape[s]),o*=t.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return Vt.runKernelFunc((function(t,e){var i=t.gather(r,a.flatten(),n);return e([a]),i}),{x:r,indices:a},(function(t,e){var a=e[0];return{x:function(){var e=r.shape,i=a.size,o=e.slice(0,n),s=o.length,u=e.slice(n,e.length).slice(1),c=u.length,l=cl(0,s),d=cl(s+1,s+1+c),h=ll([o,[i],u]),p=t.reshape(h),f=a.reshape([i]),m=ll([[s],l,d]),g=p.transpose(m),b=hl(g,f,r.shape[n]),y=Nn(m);return b.transpose(y)},indices:function(){return a}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),hl=jn({unsortedSegmentSum_:function(t,e,n){var r=wn(t,"x","unsortedSegmentSum"),a=wn(e,"segmentIds","unsortedSegmentSum","int32");return T(j(n),(function(){return"numSegments must be of dtype int"})),Vt.runKernelFunc((function(t,e){var i=t.unsortedSegmentSum(r,a,n);return e([a]),i}),{$x:r},(function(t,e){var n=e[0];return{$x:function(){return function(t,e){for(var n=Ta(e,Qn(e)),r=dl(t,n),a=tl(e,Ln(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=hr(a,o+1);a=vc(a,qn(r.shape,"bool"));var s=Qn(r);return Sc(a,r,s)}(t,n)}}}))}}),pl=function(t,e,n){return s(this,void 0,void 0,(function(){var r,a,i,o,s,c,l,d,h,p,f,m,g;return u(this,(function(u){switch(u.label){case 0:for(r=wn(t,"tensor","boolMask"),a=wn(e,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape,T(o>0,(function(){return"mask cannot be scalar"})),I(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=i;l<i+o;l++)c*=s[l];return d=s.slice(0,i).concat([c],s.slice(i+o)),h=r.reshape(d),p=a.reshape([-1]),[4,Oc(p)];case 1:return f=u.sent(),m=f.squeeze([1]),g=dl(h,m,i),t!==r&&r.dispose(),e!==a&&a.dispose(),m.dispose(),h.dispose(),p.dispose(),f.dispose(),[2,g]}}))}))};function fl(t,e,n,r,a,i,o){void 0===i&&(i="NHWC"),T(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var s=t,u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]),s=[1,t[0],t[1],t[2]]),T(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),T(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),T(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],d="NHWC"===i?u.shape[3]:u.shape[1];T(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),T(d===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+d+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&T(j(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var h=Ti(i),p=yi(s,n.shape,r,1,a,o,!1,h),f=Vt.runKernelFunc((function(t,e){var r=t.conv2dDerInput(u,n,p);return e([n,u]),r}),{dy4D:u,filter:n},(function(t,e){var n=e[0],s=e[1];return{dy4D:function(){return yl(t,n,r,a,i,1,o)},filter:function(){return xl(t,s,n.shape,r,a,i,o)}}}));return c?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function ml(t){var e=function(t){return"number"==typeof t?[t,t,t]:2===t.length?[t[0],t[1],1]:t}(t),n=e[0],r=e[1],a=e[2];return 1===n&&1===r&&1===a}function gl(t,e,n,r,a){T(t.length===e.rank,(function(){return"Length of inShape ("+t.length+") and rank of dy ("+e.rank+") must match"}));var i=t,o=e,s=!1;4===e.rank&&(s=!0,o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]),i=[1,t[0],t[1],t[2],t[3]]);var u=i[4],c=o.shape[4];T(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),T(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),T(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),T(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),T(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=vi(i,n.shape,r,1,a),d=Vt.runKernelFunc((function(t){return t.conv3dDerInput(o,n,l)}),{dy5D:o});return s?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}var bl=jn({conv1d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=wn(t,"x","conv1d"),u=wn(e,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),T(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),T(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&T(j(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),T(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),T(Ci(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),T("NWC"===a,(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var d=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),h=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),p=yl(h,d,[1,n],r,"NHWC",[1,i],o);return l?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),yl=jn({conv2d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=wn(t,"x","conv2d"),u=wn(e,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&T(j(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var d="NHWC"===a?c.shape[3]:c.shape[1];T(d===u.shape[2],(function(){return"Error in conv2d: depth of input ("+d+") must match input depth for filter "+u.shape[2]+"."})),T(Ci(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var h=Ti(a),p=yi(c.shape,u.shape,n,i,r,o,!1,h),f=[u,c],m=Vt.runKernelFunc((function(t,e){var n=t.conv2d(c,u,p);return e([u,c]),n}),{x:c,filter:u},(function(t,e){var o=e,s=o[0],u=o[1];return T(_i(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return wl(u.shape,t,s,n,r,a)},filter:function(){return xl(u,t,s.shape,n,r,a)}}}),"Conv2D",p,f);return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),vl=jn({conv3d_:function(t,e,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=wn(t,"x","conv3d"),s=wn(e,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),T(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),T(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),T(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),T(function(t,e){return ml(t)||ml(e)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),T("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var l=vi(u.shape,s.shape,n,i,r),d=Vt.runKernelFunc((function(t,e){var n=t.conv3d(u,s,l);return e([u,s]),n}),{x:u,$filter:s},(function(t,e){T(ml(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var a=e[0],o=e[1];return{x:function(){return gl(a.shape,t,o,n,r)},$filter:function(){return function(t,e,n,r,a){var i=t;4===t.rank&&(i=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]));var o=e;4===o.rank&&(o=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3])),T(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),T(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),T(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),T(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),T(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=vi(i.shape,n,r,1,a);return Vt.runKernelFunc((function(t){return t.conv3dDerFilter(i,o,s)}),{x5D:i,dy5D:o})}(a,t,o.shape,n,r)}}}));return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),xl=jn({conv2dDerFilter_:function(t,e,n,r,a,i,o){void 0===i&&(i="NHWC");var s=t;3===t.rank&&(s=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var u=e;3===u.rank&&(u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),T(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),T(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),T(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];T(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),T(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&T(j(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var d=Ti(i),h=yi(s.shape,n,r,1,a,o,!1,d);return Vt.runKernelFunc((function(t){return t.conv2dDerFilter(s,u,h)}),{x4D:s,dy4D:u})}}),wl=jn({conv2dDerInput_:fl}),kl=jn({depthwiseConv2d_:function(t,e,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=wn(t,"x","depthwiseConv2d"),u=wn(e,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),T(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),T(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),T(Ci(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=o&&T(j(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var d=yi(c.shape,u.shape,n,i,r,o,!0),h=[c,u],p=Vt.runKernelFunc((function(t,e){var n=t.depthwiseConv2D(c,u,d);return e([c,u]),n}),{x:c,filter:u},(function(t,e){T(_i(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=e[0],r=e[1];return{x:function(){return Sl(n.shape,t,r,d)},filter:function(){return Ol(n,t,r.shape,d)}}}),"DepthwiseConv2dNative",d,h);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),Sl=jn({depthwiseConv2dDerInput_:function(t,e,n,r){var a=e,i=!1;3===e.rank&&(i=!0,a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var o=Vt.runKernelFunc((function(t){return t.depthwiseConv2DDerInput(a,n,r)}),{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),Ol=jn({depthwiseConv2dDerFilter_:function(t,e,n,r){var a=t;3===t.rank&&(a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var i=e;return 3===i.rank&&(i=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),Vt.runKernelFunc((function(t){return t.depthwiseConv2DDerFilter(a,i,r)}),{x4D:a,dy4D:i})}}),_l=jn({separableConv2d_:function(t,e,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=wn(t,"x","separableConv2d"),u=wn(e,"depthwiseFilter","separableConv2d"),c=wn(n,"pointwiseFilter","separableConv2d"),l=s,d=!1;if(3===s.rank&&(d=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),T(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),T(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),T(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),T(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var h=u.shape[2],p=u.shape[3];T(c.shape[2]===h*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*p+", but got "+c.shape[2]+"."}));var f=kl(l,u,r,a,o,i),m=yl(f,c,1,"valid",o);return d?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m}}),Cl=jn({conv2dTranspose_:function(t,e,n,r,a,i){return fl(n,wn(t,"x","conv2dTranspose"),wn(e,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),Tl=jn({conv3dTranspose_:function(t,e,n,r,a){return gl(n,wn(t,"x","conv3dTranspose"),wn(e,"filter","conv3dTranspose"),r,a)}}),Il=jn({matMul_:function(t,e,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=wn(t,"a","matMul"),o=wn(e,"b","matMul");a=Mt(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],d=i.shape.slice(0,-2),h=o.shape.slice(0,-2),p=A(d),f=A(h);T(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."})),T(R(d,h),(function(){return"Error in matMul: outer dimensions ("+d+") and ("+h+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."})),T(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var m=i.shape.slice(0,-2).concat([c,l]),g=n?i.as3D(p,s,c):i.as3D(p,c,s),b=r?o.as3D(f,l,u):o.as3D(f,u,l),y={transposeA:n,transposeB:r};return Vt.runKernelFunc((function(t,e){var a=t.batchMatMul(g,b,n,r);return e([g,b]),a}),{a:g,b:b},(function(t,e){var a=e,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return t.matMul(o,!1,!1)},b:function(){return t.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(t,!1,!0)},b:function(){return i.matMul(t,!1,!1)}}:{a:function(){return o.matMul(t,!0,!0)},b:function(){return t.matMul(i,!0,!0)}}:{a:function(){return t.matMul(o,!1,!0)},b:function(){return i.matMul(t,!0,!1)}}}),"BatchMatMul",y).reshape(m)}}),Nl=jn({dot_:function(t,e){var n=wn(t,"t1","dot"),r=wn(e,"t2","dot");T(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return T(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),El=jn({outerProduct_:function(t,e){var n=wn(t,"v1","outerProduct"),r=wn(e,"v2","outerProduct");return T(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Al=jn({reverse_:function(t,e){var n=wn(t,"x","reverse");if(0===n.rank)return n.clone();var r=L(e,n.shape);return Vt.runKernelFunc((function(t){return t.reverse(n,r)}),{$x:n},(function(t){return{$x:function(){return t.reverse(r)}}})).reshapeAs(n)}}),Rl=jn({reverse1d_:function(t){var e=wn(t,"x","reverse");return T(1===e.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+e.rank+"."})),Al(e,0)}}),jl=jn({reverse2d_:function(t,e){var n=wn(t,"x","reverse");return T(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),Al(n,e)}}),Dl=jn({reverse3d_:function(t,e){var n=wn(t,"x","reverse");return T(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),Al(n,e)}}),Fl=jn({reverse4d_:function(t,e){var n=wn(t,"x","reverse");return T(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),Al(n,e)}});function Ml(t,e,n,r,a,i){var o=wn(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),T(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),T(Ci(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&T(j(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=gi(s.shape,e,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&R(c.inShape,c.outShape))return o.clone();var l=[s],d=Vt.runKernelFunc((function(t,e){var n=t.maxPool(s,c);return e([s,n]),n}),{x:s},(function(t,i){var o=i[0],s=i[1];return{x:function(){return function(t,e,n,r,a,i,o,s){var u=wn(t,"dy","maxPoolBackprop"),c=wn(e,"input","maxPoolBackprop"),l=wn(n,"output","maxPoolBackprop");T(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),T(Ci(a,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),T(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),T(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."})),null!=s&&T(j(o),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var d=gi(c.shape,r,a,i,o,s);return Vt.runKernelFunc((function(t){return t.maxPoolBackprop(u,c,l,d)}),{$dy:u,$input:c})}(t,o,s,e,n,r,a)}}}),"MaxPool",c,l);return u?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function Pl(t,e,n,r,a,i){var o=wn(t,"x","avgPool","float32");null==r&&(r=[1,1]),T(Ci(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&T(j(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=gi(s.shape,e,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&R(c.inShape,c.outShape))return o.clone();var l=Vt.runKernelFunc((function(t){return t.avgPool(s,c)}),{x:s},(function(t){return{x:function(){return function(t,e,n,r,a,i){var o=wn(t,"dy","avgPoolBackprop"),s=wn(e,"input","avgPoolBackprop");T(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==a&&(a=[1,1]),T(Ci(r,a),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),T(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var d=gi(u.shape,n,r,a,i),h=Vt.runKernelFunc((function(t){return t.avgPoolBackprop(c,u,d)}),{dy4D:c,input4D:u});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}(t,s,e,n,r,a)}}}),"AvgPool",c);return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var $l=jn({maxPool_:function(t,e,n,r,a){return Ml(t,e,n,1,r,a)}}),Ll=jn({avgPool_:function(t,e,n,r,a){return Pl(t,e,n,1,r,a)}}),Bl=jn({pool_:function(t,e,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=wn(t,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),T(Ci(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var c,l=gi(s.shape,e,i,a,r),d=[l.dilationHeight,l.dilationWidth];c="same"===r?function(t,e){var n=t.map((function(t,n){return t+(t-1)*(e[n]-1)})).map((function(t){return t-1})),r=n.map((function(t){return Math.floor(t/2)})),a=n.map((function(t,e){return t-r[e]}));return n.map((function(t,e){return[r[e],a[e]]}))}([l.filterHeight,l.filterWidth],d):[[0,0],[0,0]];var h=1===d[0]&&1===d[1],p=function(t,e,n){var r=n.map((function(t){return t[0]})),a=n.map((function(t){return t[1]})),i=t.concat(r,a),o=e.map((function(t,e){return(t-i[e]%t)%t})),s=a.map((function(t,e){return t+o[e]})),u=e.map((function(t,e){return[r[e],s[e]]})),c=e.map((function(t,e){return[0,o[e]]}));return[u,c]}([l.inHeight,l.inWidth],d,c),f=p[0],m=p[1],g=h?r:"valid",b=h?s:fr(s,d,f),y=("avg"===n?function(){return Pl(b,e,i,1,g)}:function(){return Ml(b,e,i,1,g)})(),v=h?y:ur(y,d,m);return u?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),zl=jn({maxPool3d_:function(t,e,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=wn(t,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),T(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),T("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),T(Ci(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&T(j(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=bi(u.shape,e,n,o,r,a,i),d=Vt.runKernelFunc((function(t,e){var n=t.maxPool3d(u,l);return e([u,n]),n}),{x:u},(function(t,i){var s=i[0],u=i[1];return{x:function(){return function(t,e,n,r,a,i,o,s){var u=wn(t,"dy","maxPool3dBackprop"),c=wn(e,"input","maxPool3dBackprop"),l=wn(n,"output","maxPool3dBackprop"),d=u,h=c,p=l,f=!1;4===c.rank&&(f=!0,d=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),h=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),p=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),T(5===d.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+d.rank+"."})),T(5===h.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+h.rank+"."})),T(5===p.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+p.rank+"."})),null==i&&(i=[1,1,1]),T(Ci(a,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),null!=s&&T(j(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var m=bi(h.shape,r,a,i,o,s),g=Vt.runKernelFunc((function(t){return t.maxPool3dBackprop(d,h,p,m)}),{dy5D:d,input5D:h});return f?g.as4D(g.shape[1],g.shape[2],g.shape[3],g.shape[4]):g}(t,s,u,e,n,o,r,a)}}}));return c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Wl=jn({avgPool3d_:function(t,e,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=wn(t,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),T(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),T("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),T(Ci(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&T(j(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=bi(u.shape,e,n,o,r,a,i),d=Vt.runKernelFunc((function(t){return t.avgPool3d(u,l)}),{x:u},(function(t){return{x:function(){return function(t,e,n,r,a,i,o){var s=wn(t,"dy","avgPool3dBackprop"),u=wn(e,"input","avgPool3dBackprop"),c=s,l=u,d=!1;4===u.rank&&(d=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),T(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),T(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==a&&(a=[1,1,1]),T(Ci(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"})),null!=o&&T(j(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=bi(l.shape,n,r,a,i,o),p=Vt.runKernelFunc((function(t){return t.avgPool3dBackprop(c,l,h)}),{dy5D:c,input5D:l});return d?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(t,u,e,n,o,r,a)}}}));return d=d.cast(u.dtype),c?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}}),Vl=jn({maxPoolWithArgmax_:function(t,e,n,r,a){void 0===a&&(a=!1);var i=wn(t,"x","maxPoolWithArgmax"),o={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},s=Vt.runKernel("MaxPoolWithArgmax",{x:i},o);return{result:s[0],indexes:s[1]}}}),Ul=jn({slice_:function(t,e,n){var r,a,i=wn(t,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof e?[e].concat(new Array(i.rank-1).fill(0)):e.length<i.rank?e.concat(new Array(i.rank-e.length).fill(0)):e.slice()).forEach((function(t){T(-1!==t,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(t,e){return t>=0?t:(T(-1===t,(function(){return"Negative size values should be exactly -1 but got "+t+" for the slice() size at index "+e+"."})),i.shape[e]-r[e])})),Xa(i,r,a);var o=i.shape,s={begin:r,size:a};return Vt.runKernelFunc((function(t){return t.slice(i,r,a)}),{x:i},(function(t){for(var e=[],n=0;n<t.rank;n++)e.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return Ec(t,e)}}}),"Slice",s)}}),Gl=jn({slice1d_:function(t,e,n){var r=wn(t,"x","slice1d");return T(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Ul(r,[e],[n])}}),Hl=jn({slice2d_:function(t,e,n){var r=wn(t,"x","slice2d");return T(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Ul(r,e,n)}}),ql=jn({slice3d_:function(t,e,n){var r=wn(t,"x","slice3d");return T(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Ul(r,e,n)}}),Kl=jn({slice4d_:function(t,e,n){var r=wn(t,"x","slice4d");return T(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Ul(r,e,n)}});function Xl(t,e,n,r,a){return e.rank<n.rank&&(e=e.reshape(Cn(e.shape,r))),t.rank<n.rank&&(t=t.reshape(Cn(t.shape,r))),{x:function(){var r=t.mul(n.equal(e).cast(t.dtype));return null==a?r:r.transpose(a)}}}var Yl=jn({all_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","all","bool"),a=L(e,r.shape),i=a,o=In(i,r.rank);null!=o&&(r=r.transpose(o),i=En(i.length,r.rank));var s=Vt.runKernelFunc((function(t){return t.all(r,i)}),{$x:r});if(n){var u=Cn(s.shape,a);return s.reshape(u)}return s}}),Jl=jn({any_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","any","bool"),a=L(e,r.shape),i=a,o=In(i,r.rank);null!=o&&(r=r.transpose(o),i=En(i.length,r.rank));var s=Vt.runKernelFunc((function(t){return t.any(r,i)}),{$x:r});if(n){var u=Cn(s.shape,a);return s.reshape(u)}return s}}),Zl=jn({argMax_:function(t,e){void 0===e&&(e=0);var n=wn(t,"x","argMax");null==e&&(e=0);var r=L(e,n.shape),a=In(r,n.rank);null!=a&&(n=n.transpose(a),r=En(r.length,n.rank));var i={axis:r[0]},o=[n];return Vt.runKernelFunc((function(t,e){var a=t.argMax(n,r[0]);return e([n]),a}),{x:n},(function(t,e){var n=e[0];return{x:function(){return Qn(n)}}}),"ArgMax",i,o)}}),Ql=jn({argMin_:function(t,e){void 0===e&&(e=0);var n=wn(t,"x","argMin");null==e&&(e=0);var r=L(e,n.shape),a=In(r,n.rank);return null!=a&&(n=n.transpose(a),r=En(r.length,n.rank)),Vt.runKernelFunc((function(t,e){var a=t.argMin(n,r[0]);return e([n]),a}),{$x:n},(function(t,e){var n=e[0];return{$x:function(){return Qn(n)}}}))}}),td=jn({logSumExp_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","logSumExp"),a=L(e,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var u=Cn(s.shape,a);return s.reshape(u)}return s}}),ed=jn({max_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","max"),a=r,i=L(e,r.shape),o=i,s=In(o,r.rank);null!=s&&(r=r.transpose(s),o=En(o.length,r.rank));var u=[r],c=Vt.runKernelFunc((function(t,e){var n=t.max(r,o);return e([a,n]),n}),{x:r},(function(t,e){return Xl(t,e[1],e[0],i,s)}),"Max",{axes:o},u,[!0]);if(n){var l=Cn(c.shape,i);c=c.reshape(l)}return c}}),nd=jn({mean_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","mean"),a=L(e,r.shape),i=A(_n(r.shape,a)[1]);return ui((function(t){var r=Ln(i);return{value:(r.dtype===t.dtype?t:t.cast(r.dtype)).div(r).sum(e,n),gradFunc:function(e){var n=t.shape.slice();return a.forEach((function(t){n[t]=1})),e.reshape(n).mul(qn(t.shape,"float32")).div(i)}}}))(r)}}),rd=jn({min_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","min"),a=r,i=L(e,r.shape),o=i,s=In(o,r.rank);null!=s&&(r=r.transpose(s),o=En(o.length,r.rank));var u=[r],c=Vt.runKernelFunc((function(t,e){var n=t.min(r,o);return e([a,n]),n}),{x:r},(function(t,e){return Xl(t,e[1],e[0],i,s)}),"Min",{axes:o},u,[!0]);if(n){var l=Cn(c.shape,i);c=c.reshape(l)}return c}}),ad=jn({moments_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=L(e,(t=wn(t,"x","moments")).shape),a=t.mean(r,n),i=a.shape;n||(i=Cn(a.shape,r));var o=t.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),id=jn({sum_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=L(e,r.shape);return ui((function(t){var e=In(a,t.rank),r=a,i=t;null!=e&&(i=t.transpose(e),r=En(r.length,t.rank));var o=function(e){var n=t.shape.slice();return a.forEach((function(t){n[t]=1})),e.reshape(n).mul(qn(t.shape,"float32"))},s={axes:r},u=Vt.runKernelFunc((function(t){return t.sum(i,r)}),{x:i},(function(t){return{x:function(){return o(t)}}}),"Sum",s);if(n){var c=Cn(u.shape,a);u=u.reshape(c)}return{value:u,gradFunc:o}}))(r)}}),od=jn({prod_:function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=!1);var r=wn(t,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=L(e,r.shape),i=In(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=En(o.length,r.rank));var u=Vt.runKernelFunc((function(t){return t.prod(s,o)}),{permutedX:s});if(n){var c=Cn(u.shape,a);u=u.reshape(c)}return u}}),sd=jn({elu_:function(t){var e=wn(t,"x","elu");return Vt.runKernelFunc((function(t,n){var r=t.elu(e);return n([r]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){return Vt.runKernelFunc((function(e){return e.eluDer(t,n)}),{dy:t,y:n})}}}))}}),ud=jn({leakyRelu_:function(t,e){void 0===e&&(e=.2);var n=wn(t,"x","leakyRelu");return Ta(Ln(e).mul(n),n)}}),cd=jn({prelu_:function(t,e){var n=wn(t,"x","prelu"),r=wn(e,"alpha","prelu");return Vt.runKernelFunc((function(t,e){var a=t.prelu(n,r);return e([n,r]),a}),{x:n,alpha:r},(function(t,e){var n=e[0],r=e[1],a=n.greater(0);return{x:function(){return Sc(a,t,t.mul(r))},alpha:function(){var e=Sc(a,Qn(t),t.mul(n)),i=zr(r.shape,t.shape);return i.length>0&&(e=e.sum(i)),e.reshape(r.shape)}}}),"Prelu")}}),ld=jn({relu_:function(t){var e=wn(t,"x","relu");return"bool"===e.dtype?e.toInt():Vt.runKernelFunc((function(t,n){var r=t.relu(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0];return{x:function(){return t.mulStrict(n.step().toFloat())}}}),"Relu")}}),dd=jn({relu6_:function(t){var e=wn(t,"x","relu6");return"bool"===e.dtype?e.toInt():Vt.runKernelFunc((function(t,n){var r=t.relu6(e);return n([e]),r}),{x:e},(function(t,e){var n=e[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return t.mulStrict(r.toFloat())}}}),"Relu6")}}),hd=jn({selu_:function(t){var e=wn(t,"x","selu");return Vt.runKernelFunc((function(t,n){var r=t.selu(e);return n([e]),r}),{$x:e},(function(t,e){var n=e[0];return{$x:function(){var e=n.greater(Ln(0)),r=Ln(hu),a=Ln(pu),i=t.mul(a),o=t.mul(r).mul(n.toFloat().exp());return Sc(e,i,o)}}}))}}),pd=jn({localResponseNormalization_:function(t,e,n,r,a){void 0===e&&(e=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=wn(t,"x","localResponseNormalization");T(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),T(j(e),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+e+"."}));var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=Vt.runKernelFunc((function(t,i){var s=t.localResponseNormalization4D(o,e,n,r,a);return i([o,s]),s}),{x4D:o},(function(t,i){var o=i[0],s=i[1];return{x4D:function(){return Vt.runKernelFunc((function(i){return i.LRNGrad(t,o,s,e,n,r,a)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),fd=jn({norm_:function(t,e,n,r){void 0===e&&(e="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function t(e,n,r){if(void 0===r&&(r=null),0===e.rank)return e.abs();if(1!==e.rank&&null===r)return t(e.reshape([-1]),n,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return e.abs().sum(r);if(n===1/0)return e.abs().max(r);if(n===-1/0)return e.abs().min(r);if("euclidean"===n||2===n)return e.abs().pow(Ln(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return e.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return e.abs().sum(r[1]).max(r[0]);if(n===-1/0)return e.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return e.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(t=wn(t,"x","norm"),e,n),i=a.shape;if(r){var o=L(n,t.shape);i=Cn(a.shape,o)}return a.reshape(i)}}),md=jn({basicLSTMCell_:function(t,e,n,r,a,i){var o=wn(t,"forgetBias","basicLSTMCell"),s=wn(e,"lstmKernel","basicLSTMCell"),u=wn(n,"lstmBias","basicLSTMCell"),c=wn(r,"data","basicLSTMCell"),l=wn(a,"c","basicLSTMCell"),d=wn(i,"h","basicLSTMCell"),h=c.concat(d,1).matMul(s).add(u),p=h.shape[0],f=h.shape[1]/4,m=[p,f],g=h.slice([0,0],m),b=h.slice([0,f],m),y=h.slice([0,2*f],m),v=h.slice([0,3*f],m),x=g.sigmoid().mulStrict(b.tanh()).addStrict(l.mulStrict(o.add(y).sigmoid())),w=x.tanh().mulStrict(v.sigmoid());return[x,w]}}),gd=jn({multiRNNCell_:function(t,e,n,r){for(var a=wn(e,"data","multiRNNCell"),i=kn(n,"c","multiRNNCell"),o=kn(r,"h","multiRNNCell"),s=a,u=[],c=0;c<t.length;c++){var l=t[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var d=[],h=[];for(c=0;c<u.length;c+=2)d.push(u[c]),h.push(u[c+1]);return[d,h]}}),bd=jn({movingAverage_:function(t,e,n,r,a){void 0===a&&(a=!0);var i=wn(t,"v","movingAverage"),o=wn(e,"x","movingAverage"),s=wn(n,"decay","movingAverage");Pt(i,o),T(R(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=Ln(1),c=u.sub(s),l=o.sub(i).mul(c);if(a){T(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var d=wn(r,"step","movingAverage");l=l.div(u.sub(Fa(s,d)))}return i.add(l)}}),yd=jn({stridedSlice_:function(t,e,n,r,a,i,o,s,u){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(e.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=wn(t,"x","stridedSlice"),l=Ya(s),d=c.shape.slice();l.forEach((function(t){e[t]=0,n[t]=1,d.splice(t,0,1)})),c=c.reshape(d);for(var h=0;h<c.rank;h++)e[h]=Za(a,e,r,c.shape,h),n[h]=Qa(i,n,r,c.shape,h),r[h]=r[h]||1;var p=Ya(u);p.forEach((function(t){n[t]=e[t]+1,r[t]=1}));var f=Ja(e,n,r),m=f.filter((function(t,e){return-1===p.indexOf(e)}));return r.every((function(t){return 1===t}))?Ul(c,e,f).reshape(m):Vt.runKernelFunc((function(t){return t.stridedSlice(c,e,n,r)}),{$x:c}).reshape(m)}}),vd=jn({topk_:function(t,e,n){void 0===e&&(e=1),void 0===n&&(n=!0);var r=wn(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(e>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+e);var i=Vt.runKernelFunc((function(t){return t.topk(r,e,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),xd=jn({scatterND_:function(t,e,n){var r=wn(t,"indices","scatterND","int32"),a=wn(e,"updates","scatterND");return Ha(a,r,n),Vt.runKernelFunc((function(t){return t.scatterND(r,a,n)}),{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),wd=jn({fft_:function(t){T("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Vt.runKernelFunc((function(t){return t.fft(r)}),{input:t}).reshape(t.shape)}}),kd=jn({ifft_:function(t){T("complex64"===t.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+t.dtype+"."}));var e=t.shape[t.shape.length-1],n=t.size/e,r=t.as2D(n,e);return Vt.runKernelFunc((function(t){return t.ifft(r)}),{input:t}).reshape(t.shape)}}),Sd=jn({rfft_:function(t,e){T("float32"===t.dtype,(function(){return"The dtype for rfft() must be real value but got "+t.dtype}));var n,r=t.shape[t.shape.length-1],a=t.size/r;if(null!=e&&e<r){var i=t.shape.map((function(t){return 0})),o=t.shape.map((function(t){return t}));o[t.shape.length-1]=e,n=t.slice(i,o),r=e}else if(null!=e&&e>r){var s=t.shape.map((function(t){return t}));s[t.shape.length-1]=e-r,n=t.concat(Kn(s),t.shape.length-1),r=e}else n=t;var u=n.zerosLike(),c=Dn(n,u).as2D(a,r),l=wd(c),d=Math.floor(r/2)+1,h=Fn(l),p=Mn(l),f=h.split([d,r-d],h.shape.length-1),m=p.split([d,r-d],p.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=d,Dn(f[0],m[0]).reshape(g)}}),Od=jn({irfft_:function(t){var e=t.shape[t.shape.length-1],n=t.size/e;if(e<=2){var r=t.as2D(n,e),a=kd(r);return Fn(a)}var i=[n,2*(e-1)],o=Fn(t).as2D(n,e),s=Mn(t).as2D(n,e),u=o.slice([0,1],[n,e-2]).reverse(1),c=s.slice([0,1],[n,e-2]).reverse(1).mul(Ln(-1)),l=o.concat(u,1),d=s.concat(c,1);return r=Dn(l,d).as2D(i[0],i[1]),a=kd(r),Fn(a)}}),_d=Object.freeze({fft:wd,ifft:kd,rfft:Sd,irfft:Od}),Cd=jn({sparseToDense_:function(t,e,n,r){void 0===r&&(r=0);var a=wn(t,"sparseIndices","sparseToDense","int32"),i=wn(e,"sparseValues","sparseToDense"),o=wn(r,"defaultValue","sparseToDense",i.dtype);return function(t,e,n,r){if("int32"!==t.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+t.shape+".");var a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error("sparseValues has incorrect shape "+e.shape+", should be [] or ["+a+"]");if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),Vt.runKernelFunc((function(t){return t.sparseToDense(a,i,n,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),Td=jn({gatherND_:function(t,e){var n=wn(e,"indices","gatherND","int32"),r=wn(t,"x","gatherND");return Vt.runKernelFunc((function(t){return t.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Id=jn({diag_:function(t){var e=wn(t,"x","diag").flatten(),n=t.shape.concat(t.shape);return Vt.runKernelFunc((function(t){return t.diag(e)}),{$x:e}).reshape(n)}}),Nd=jn({dropout_:function(t,e,n,r){var a=wn(t,"x","dropout");if(T("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),T(e>=0&&e<1,(function(){return"rate must be a float in the range [0, 1), but got "+e+"."})),0===e)return t instanceof Ct?a.clone():a;var i=function(t,e){if(null==e)return t.shape.slice();if(R(t.shape,e))return e;if(t.shape.length===e.length){for(var n=[],r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}(a,n),o=1-e,s=qc(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function Ed(t,e,n){for(var r=1-t%2,a=new Float32Array(t),i=0;i<t;++i){var o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return Bn(a,"float32")}var Ad,Rd=jn({hannWindow_:function(t){return Ed(t,.5,.5)}}),jd=jn({hammingWindow_:function(t){return Ed(t,.54,.46)}}),Dd=jn({frame_:function(t,e,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+e<=t.size;)o.push(Ul(t,i,e)),i+=n;if(r)for(;i<t.size;){var s=i+e-t.size,u=tr([Ul(t,i,e-s),Xn([s],a)]);o.push(u),i+=n}return 0===o.length?zn([],[0,e]):tr(o).as2D(o.length,e)}}),Fd=jn({stft_:function(t,e,n,r,a){var i;void 0===a&&(a=Rd),null==r&&(i=e,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=Dd(t,e,n),s=ja(o,a(e)),u=[],c=0;c<o.shape[0];c++)u.push(Sd(s.slice([c,0],[1,e]),r));return tr(u)}}),Md=Object.freeze({hannWindow:Rd,hammingWindow:jd,frame:Dd,stft:Fd}),Pd=function(t,e,n){return void 0===n&&(n=1),s(this,void 0,void 0,(function(){var r,a,i,o,s,c,l,d,h,p,f,m,g,b;return u(this,(function(u){switch(u.label){case 0:return r=wn(t,"predictions","inTopK"),a=wn(e,"targets","inTopK"),T(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),T(r.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank})),I(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],T(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return o=u.sent(),[4,a.data()];case 2:for(s=u.sent(),c=[o.length/i,i],d=c[1],h=z("bool",l=c[0]),p=0;p<l;p++){for(f=p*d,m=o.subarray(f,f+d),g=[],b=0;b<m.length;b++)g.push({value:m[b],index:b});for(g.sort((function(t,e){return e.value-t.value})),h[p]=0,b=0;b<n;b++)if(g[b].index===s[p]){h[p]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),[2,Pn(h,a.shape,"bool")]}}))}))};!function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(Ad||(Ad={}));var $d=jn({absoluteDifference_:function(t,e,n,r){void 0===r&&(r=Ad.SUM_BY_NONZERO_WEIGHTS);var a=wn(t,"labels","absoluteDifference"),i=wn(e,"predictions","absoluteDifference"),o=null;null!=n&&(o=wn(n,"weights","absoluteDifference")),I(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return Ld(s,o,r)}}),Ld=jn({computeWeightedLoss_:function(t,e,n){void 0===n&&(n=Ad.SUM_BY_NONZERO_WEIGHTS);var r=wn(t,"losses","computeWeightedLoss"),a=null;null!=e&&(a=wn(e,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===Ad.NONE)return i;if(n===Ad.SUM)return i.sum();if(n===Ad.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(Ln(o)):s}if(n===Ad.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(Ln(r.size));var u=a.mul(qn(r.shape)).notEqual(Ln(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Bd=jn({cosineDistance_:function(t,e,n,r,a){void 0===a&&(a=Ad.SUM_BY_NONZERO_WEIGHTS);var i=wn(t,"labels","cosineDistance"),o=wn(e,"predictions","cosineDistance"),s=null;null!=r&&(s=wn(r,"weights","cosineDistance")),I(i.shape,o.shape,"Error in cosineDistance: ");var u=Ln(1).sub(i.mul(o).sum(n,!0));return Ld(u,s,a)}}),zd=jn({hingeLoss_:function(t,e,n,r){void 0===r&&(r=Ad.SUM_BY_NONZERO_WEIGHTS);var a=wn(t,"labels","hingeLoss"),i=wn(e,"predictions","hingeLoss"),o=null;null!=n&&(o=wn(n,"weights","hingeLoss")),I(a.shape,i.shape,"Error in hingeLoss: ");var s=Ln(1);a=Ln(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return Ld(u,o,r)}}),Wd=jn({huberLoss_:function(t,e,n,r,a){void 0===r&&(r=1),void 0===a&&(a=Ad.SUM_BY_NONZERO_WEIGHTS);var i=wn(t,"labels","huberLoss"),o=wn(e,"predictions","huberLoss"),s=null;null!=n&&(s=wn(n,"weights","huberLoss")),I(i.shape,o.shape,"Error in huberLoss: ");var u=Ln(r),c=o.sub(i).abs(),l=Na(c,u),d=c.sub(l),h=Ln(.5).mul(l.square()).add(u.mul(d));return Ld(h,s,a)}}),Vd=jn({logLoss_:function(t,e,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=Ad.SUM_BY_NONZERO_WEIGHTS);var i=wn(t,"labels","logLoss"),o=wn(e,"predictions","logLoss"),s=null;null!=n&&(s=wn(n,"weights","logLoss")),I(i.shape,o.shape,"Error in logLoss: ");var u=Ln(1),c=Ln(r),l=i.mul(o.add(c).log()).neg().sub(u.sub(i).mul(u.sub(o).add(c).log()));return Ld(l,s,a)}}),Ud=jn({meanSquaredError_:function(t,e,n,r){void 0===r&&(r=Ad.SUM_BY_NONZERO_WEIGHTS);var a=wn(t,"labels","meanSquaredError"),i=wn(e,"predictions","meanSquaredError"),o=null;null!=n&&(o=wn(n,"weights","meanSquaredError")),I(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return Ld(s,o,r)}}),Gd=jn({sigmoidCrossEntropy_:function(t,e,n,r,a){void 0===r&&(r=0),void 0===a&&(a=Ad.SUM_BY_NONZERO_WEIGHTS);var i=wn(t,"multiClassLabels","sigmoidCrossEntropy"),o=wn(e,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=wn(n,"weights","sigmoidCrossEntropy")),I(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Ln(r),c=Ln(1),l=Ln(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var d=function(t,e){var n=wn(t,"labels","sigmoidCrossEntropyWithLogits"),r=wn(e,"logits","sigmoidCrossEntropyWithLogits");I(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return Ld(d,s,a)}}),Hd=jn({softmaxCrossEntropy_:function(t,e,n,r,a){void 0===r&&(r=0),void 0===a&&(a=Ad.SUM_BY_NONZERO_WEIGHTS);var i=wn(t,"onehotLabels","softmaxCrossEntropy"),o=wn(e,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=wn(n,"weights","softmaxCrossEntropy")),I(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Ln(r),c=Ln(1),l=Ln(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var d=function(t,e,n){if(void 0===n&&(n=-1),-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+e.rank+" and dim was "+n);return ui((function(t,e,r){var a=e.logSumExp([n],!0),i=e.toFloat().sub(a);return r([t,i]),{value:i.mul(t).neg().sum([n]),gradFunc:function(t,e){var r=e[0],a=e[1],i=Cn(t.shape,[n]);return[t.reshape(i).mul(r.toFloat().sub(a.exp())),t.reshape(i).mul(a.exp().sub(r.toFloat()))]}}}))(t,e)}(i,o);return Ld(d,s,a)}}),qd=Object.freeze({get Reduction(){return Ad},absoluteDifference:$d,computeWeightedLoss:Ld,cosineDistance:Bd,hingeLoss:zd,huberLoss:Wd,logLoss:Vd,meanSquaredError:Ud,sigmoidCrossEntropy:Gd,softmaxCrossEntropy:Hd});function Kd(t,e){return void 0===e&&(e=!1),Vt.tidy((function(){if(2!==t.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+t.shape.length+"D Tensor.");for(var n=t.shape[0],r=t.shape[1],a=Tc(n),i=t.clone(),o=zn([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(t){var e,u=i,c=s,l=a;e=Vt.tidy((function(){var e=i.slice([t,t],[n-t,1]),u=e.norm(),c=i.slice([t,t],[1,1]),l=zn([[-1]]).where(c.greater(0),zn([[1]])),d=c.sub(l.mul(u)),h=e.div(d);s=1===h.shape[0]?o.clone():o.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var p=l.matMul(d).div(u).neg(),f=i.slice([t,0],[n-t,r]),m=p.mul(s),g=s.transpose();if(0===t)i=f.sub(m.matMul(g.matMul(f)));else{var b=f.sub(m.matMul(g.matMul(f)));i=i.slice([0,0],[t,r]).concat(b,0)}var y=m.transpose(),v=a.slice([0,t],[n,a.shape[1]-t]);if(0===t)a=v.sub(v.matMul(s).matMul(y));else{var x=v.sub(v.matMul(s).matMul(y));a=a.slice([0,0],[n,t]).concat(x,1)}return[s,i,a]})),s=e[0],i=e[1],a=e[2],on([u,c,l])},l=0;l<u;++l)c(l);return!e&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]}))}var Xd=jn({bandPart_:function(t,e,n){if(e%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+e+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=wn(t,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),o=i[0],s=i[1];if(!(e<=o))throw new Error("bandPart(): numLower ("+e+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");e<0&&(e=o),n<0&&(n=s);var u=Jn(0,o,1,"int32").reshape([-1,1]),c=Jn(0,s,1,"int32"),l=$a(u,c),d=vc(l.lessEqual(Ln(+e,"int32")),l.greaterEqual(Ln(-n,"int32"))),h=Kn([o,s],r.dtype);return gr(br(r.reshape([-1,o,s])).map((function(t){return Sc(d,t,h)}))).reshape(a)}}),Yd=jn({gramSchmidt_:function(t){var e;if(Array.isArray(t)){e=!1,T(null!=t&&t.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=t[0].shape[0],r=function(e){T(t[e].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+t[e].shape[0]+" vs. "+n+")"}))},a=1;a<t.length;++a)r(a)}else e=!0,t=ir(t,t.shape[0],0).map((function(t){return mr(t,[0])}));T(t.length<=t[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+t.length+") exceeds number of dimensions ("+t[0].shape[0]+")."}));var i=[],o=t,s=function(t){i.push(Vt.tidy((function(){var e=o[t];if(t>0)for(var n=0;n<t;++n){var r=id(i[n].mulStrict(e)).mul(i[n]);e=e.sub(r)}return e.div(fd(e,"euclidean"))})))};for(a=0;a<t.length;++a)s(a);return e?gr(i,0):i}}),Jd=jn({qr_:function(t,e){if(void 0===e&&(e=!1),t.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+t.rank);if(2===t.rank)return Kd(t,e);var n=t.shape.slice(0,t.shape.length-2).reduce((function(t,e){return t*e})),r=br(t.reshape([n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];return r.forEach((function(t){var n=Kd(t,e),r=n[0],o=n[1];a.push(r),i.push(o)})),[gr(a,0).reshape(t.shape),gr(i,0).reshape(t.shape)]}}),Zd=Object.freeze({bandPart:Xd,gramSchmidt:Yd,qr:Jd});function Qd(t,e,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=t.shape[0];return n=Math.min(n,o),T(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),T(2===t.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+t.rank+"'"})),T(4===t.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]})),T(1===e.rank,(function(){return"scores must be a 1D tensor"})),T(e.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+e.shape[0]})),T(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var th=jn({resizeBilinear_:function(t,e,n){void 0===n&&(n=!1);var r=wn(t,"images","resizeBilinear");T(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),T(2===e.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Vt.runKernelFunc((function(t,e){return e([a]),t.resizeBilinear(a,o,s,n)}),{x:a},(function(t,e){return{x:function(){return Vt.runKernelFunc((function(r){return r.resizeBilinearBackprop(t,e[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),eh=jn({resizeNearestNeighbor_:function(t,e,n){void 0===n&&(n=!1);var r=wn(t,"images","resizeNearestNeighbor");T(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),T(2===e.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."})),T("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=e[0],s=e[1],u=Vt.runKernelFunc((function(t,e){return e([a]),t.resizeNearestNeighbor(a,o,s,n)}),{batchImages:a},(function(t,e){return{batchImages:function(){return Vt.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(t,e[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),nh=jn({nonMaxSuppression_:function(t,e,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=wn(t,"boxes","nonMaxSuppression"),o=wn(e,"scores","nonMaxSuppression"),s=Qd(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return Vt.runKernelFunc((function(t){return t.nonMaxSuppression(i,o,n,r,a)}),{boxes:i,scores:o},null,"NonMaxSuppressionV3",u)}}),rh=function(t,e,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),s(this,void 0,void 0,(function(){var i,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:return i=wn(t,"boxes","nonMaxSuppressionAsync"),o=wn(e,"scores","nonMaxSuppressionAsync"),s=Qd(i,o,n,r,a),n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return c=u.sent(),l=c[0],d=c[1],h=$i(l,d,n,r,a),i!==t&&i.dispose(),o!==e&&o.dispose(),[2,h]}}))}))},ah=jn({nonMaxSuppressionWithScore_:function(t,e,n,r,a,i){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var o=wn(t,"boxes","nonMaxSuppression"),s=wn(e,"scores","nonMaxSuppression"),u=Qd(o,s,n,r,a,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=Vt.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),ih=function(t,e,n,r,a,i){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),s(this,void 0,void 0,(function(){var o,s,c,l,d,h,p;return u(this,(function(u){switch(u.label){case 0:return o=wn(t,"boxes","nonMaxSuppressionAsync"),s=wn(e,"scores","nonMaxSuppressionAsync"),c=Qd(o,s,n,r,a,i),n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return l=u.sent(),d=l[0],h=l[1],p=Li(d,h,n,r,a,i),o!==t&&o.dispose(),s!==e&&s.dispose(),[2,p]}}))}))},oh=jn({cropAndResize_:function(t,e,n,r,a,i){var o=wn(t,"image","cropAndResize"),s=wn(e,"boxes","cropAndResize","float32"),u=wn(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return T(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),T(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),T(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),T(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),T(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),T("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was "+a})),Vt.runKernelFunc((function(t,e){return t.cropAndResize(o,s,u,r,a,i)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),sh=Object.freeze({resizeBilinear:th,resizeNearestNeighbor:eh,nonMaxSuppression:nh,nonMaxSuppressionAsync:rh,nonMaxSuppressionWithScore:ah,nonMaxSuppressionWithScoreAsync:ih,cropAndResize:oh}),uh=function(t,e){return!(t>0)||"linear"===e},ch=function(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return t.mul(e.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},lh=function(t,e){var n=e,r=zr(t.shape,e.shape);return r.length>0&&(n=n.sum(r)),n.reshape(t.shape)},dh=function(t,e,n){if("linear"===e)return t;if("relu"===e)return ld(t);if("elu"===e)return sd(t);if("relu6"===e)return dd(t);if("prelu"===e)return cd(t,n);throw new Error("Unknown fused activation "+e+".")},hh=jn({fusedMatMul_:function(t){var e,n=t.a,r=t.b,a=t.transposeA,i=void 0!==a&&a,o=t.transposeB,s=void 0!==o&&o,u=t.bias,c=t.activation,l=void 0===c?"linear":c,d=t.preluActivationWeights;if(!1===uh(Vt.state.gradientDepth,l)){var h=Il(n,r,i,s);return null!=u&&(h=Lr(h,u)),dh(h,l,d)}var p=wn(n,"a","fused matMul"),f=wn(r,"b","fused matMul");e=Mt(p,f),p=e[0],f=e[1];var m=i?p.shape[p.rank-2]:p.shape[p.rank-1],g=s?f.shape[f.rank-1]:f.shape[f.rank-2],b=i?p.shape[p.rank-1]:p.shape[p.rank-2],y=s?f.shape[f.rank-2]:f.shape[f.rank-1],v=p.shape.slice(0,-2),x=f.shape.slice(0,-2),w=A(v),k=A(x);T(p.rank>=2&&f.rank>=2&&p.rank===f.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+f.rank+"."})),T(R(v,x),(function(){return"Error in fused matMul: outer dimensions ("+v+") and ("+x+") of Tensors with shapes "+p.shape+" and "+f.shape+" must match."})),T(m===g,(function(){return"Error in fused matMul: inner shapes ("+m+") and ("+g+") of Tensors with shapes "+p.shape+" and "+f.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var S,O,_=p.shape.slice(0,-2).concat([b,y]),C=i?p.as3D(w,m,b):p.as3D(w,b,m),I=s?f.as3D(k,y,g):f.as3D(k,g,y);null!=u&&Wr(_,(S=Mt(S=wn(u,"bias","fused matMul"),p)[0]).shape),null!=d&&(O=wn(d,"prelu weights","fused matMul"));var N={a:C,b:I};null!=u&&(N.bias=S),null!=d&&(N.preluActivationWeights=O);var E=[C,I];return Vt.runKernelFunc((function(t,e){var n=t.fusedBatchMatMul({a:C,b:I,transposeA:i,transposeB:s,bias:S,activation:l,preluActivationWeights:O});return e([C,I,n]),n}),N,(function(t,e){var n=e[0],r=e[1],a=e[2],o=ch(t,a,l),c={};return null!=u&&(c={bias:function(){return lh(S,o)}}),i||s?!i&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},E,[!0]).reshape(_)}}),ph=jn({fusedConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,h=void 0===d?"linear":d,p=t.preluActivationWeights;if(h=h||"linear",!1===uh(Vt.state.gradientDepth,h)){var f=yl(e,n,r,a,o,u,c);return null!=l&&(f=Lr(f,l)),dh(f,h,p)}var m=wn(e,"x","conv2d"),g=wn(n,"filter","conv2d"),b=m,y=!1;3===m.rank&&(y=!0,b=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),T(4===b.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+b.rank+"."})),T(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."})),null!=c&&T(j(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."})),T(b.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input ("+b.shape[3]+") must match input depth for filter "+g.shape[2]+"."})),T(Ci(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),T("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var v,x,w=yi(b.shape,g.shape,r,u,a,c);null!=l&&(v=Mt(v=wn(l,"bias","fused conv2d"),m)[0],Wr(w.outShape,v.shape)),null!=p&&(x=wn(p,"prelu weights","fused conv2d"));var k={x:b,filter:g};null!=l&&(k.bias=v),null!=p&&(k.preluActivationWeights=x);var S=[g,b],O=Vt.runKernelFunc((function(t,e){var n=t.fusedConv2d({input:b,filter:g,convInfo:w,bias:v,activation:h,preluActivationWeights:x});return e([g,b,n]),n}),k,(function(t,e){var n=e,i=n[0],o=n[1],s=n[2],c=ch(t,s,h);T(_i(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var d={};return null!=l&&(d={bias:function(){return lh(v,c)}}),Object.assign({x:function(){return wl(o.shape,c,i,r,a)},filter:function(){return xl(o,c,i.shape,r,a)}},d)}),"FusedConv2D",{convInfo:w,activation:h},S,[!0]);return y?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O}}),fh=jn({fusedDepthwiseConv2d_:function(t){var e=t.x,n=t.filter,r=t.strides,a=t.pad,i=t.dataFormat,o=void 0===i?"NHWC":i,s=t.dilations,u=void 0===s?[1,1]:s,c=t.dimRoundingMode,l=t.bias,d=t.activation,h=void 0===d?"linear":d,p=t.preluActivationWeights;if(!1===uh(Vt.state.gradientDepth,h)){var f=kl(e,n,r,a,o,u,c);return null!=l&&(f=Lr(f,l)),dh(f,h,p)}var m=wn(e,"x","depthwiseConv2d"),g=wn(n,"filter","depthwiseConv2d"),b=m,y=!1;3===m.rank&&(y=!0,b=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),T(4===b.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+b.rank+"."})),T(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."})),T(b.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+b.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."})),null==u&&(u=[1,1]),T(Ci(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&T(j(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."}));var v,x,w=yi(b.shape,g.shape,r,u,a,c,!0);null!=l&&(v=Mt(v=wn(l,"bias","fused conv2d"),m)[0],Wr(w.outShape,v.shape)),null!=p&&(x=wn(p,"prelu weights","fused depthwiseConv2d"));var k={x:b,filter:g};null!=l&&(k.bias=v),null!=p&&(k.preluActivationWeights=x);var S=[g,b],O=Vt.runKernelFunc((function(t,e){var n=t.fusedDepthwiseConv2D({input:b,filter:g,convInfo:w,bias:v,activation:h,preluActivationWeights:x});return e([g,b,n]),n}),k,(function(t,e){T(_i(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=e[0],r=e[1],a=e[2],i=ch(t,a,h),o={};return null!=l&&(o={bias:function(){return lh(v,i)}}),Object.assign({x:function(){return Sl(r.shape,i,n,w)},filter:function(){return Ol(r,i,n.shape,w)}},o)}),"FusedDepthwiseConv2D",{convInfo:w,activation:h},S,[!0]);return y?O.as3D(O.shape[1],O.shape[2],O.shape[3]):O}}),mh=Object.freeze({matMul:hh,conv2d:ph,depthwiseConv2d:fh}),gh=Object.freeze({image:sh,linalg:Zd,losses:qd,spectral:_d,fused:mh,signal:Md,add:Lr,addN:ec,batchNorm:sc,batchNormalization:oc,batchNorm2d:lc,batchNormalization2d:cc,batchNorm3d:pc,batchNormalization3d:hc,batchNorm4d:gc,batchNormalization4d:mc,broadcastTo:bc,clone:yc,div:Ba,divNoNan:_c,eye:Tc,multinomial:Ic,oneHot:Nc,pad:Ec,pad1d:Ac,pad2d:Rc,pad3d:jc,pad4d:Dc,rand:Fc,randomGamma:Gc,randomNormal:Hc,randomUniform:qc,square:Kc,squaredDifference:Xc,tile:Cc,truncatedNormal:Yc,conv1d:bl,conv2d:yl,conv3d:vl,depthwiseConv2d:kl,separableConv2d:_l,conv2dTranspose:Cl,conv3dTranspose:Tl,op:jn,booleanMaskAsync:pl,complex:Dn,real:Fn,imag:Mn,concat:tr,concat1d:er,concat2d:nr,concat3d:rr,concat4d:ar,split:ir,matMul:Il,dot:Nl,outerProduct:El,reverse:Al,reverse1d:Rl,reverse2d:jl,reverse3d:Dl,reverse4d:Fl,maxPool:$l,avgPool:Ll,pool:Bl,maxPool3d:zl,avgPool3d:Wl,maxPoolWithArgmax:Vl,slice:Ul,slice1d:Gl,slice2d:Hl,slice3d:ql,slice4d:Kl,abs:Vr,acos:Ur,acosh:Gr,asin:Hr,asinh:qr,atan:Kr,atanh:Xr,ceil:Yr,clipByValue:Jr,cos:Zr,cosh:Qr,erf:ta,exp:ea,expm1:na,floor:ra,log:aa,log1p:ia,logSigmoid:oa,neg:sa,reciprocal:ua,round:ca,rsqrt:la,sigmoid:da,sign:ha,isNaN:pa,isInf:fa,isFinite:ma,sin:ga,sinh:ba,softplus:ya,sqrt:va,step:xa,tan:wa,tanh:ka,all:Yl,any:Jl,argMax:Zl,argMin:Ql,logSumExp:td,max:ed,mean:nd,min:rd,moments:ad,sum:id,prod:od,equal:Jc,equalStrict:Zc,greater:Qc,greaterEqual:tl,greaterEqualStrict:el,greaterStrict:nl,less:rl,lessEqual:al,lessEqualStrict:il,lessStrict:ol,notEqual:sl,notEqualStrict:ul,addStrict:Sa,atan2:Oa,divStrict:_a,floorDiv:Ca,maximum:Ta,maximumStrict:Ia,minimum:Na,minimumStrict:Ea,mod:Aa,modStrict:Ra,mul:ja,mulStrict:Da,pow:Fa,powStrict:Ma,squaredDifferenceStrict:Pa,sub:$a,subStrict:La,elu:sd,leakyRelu:ud,prelu:cd,relu:ld,relu6:dd,selu:hd,logicalAnd:vc,logicalNot:xc,logicalOr:wc,logicalXor:kc,where:Sc,whereAsync:Oc,buffer:or,print:sr,batchToSpaceND:ur,cast:cr,cumsum:lr,depthToSpace:dr,expandDims:hr,reshape:pr,spaceToBatchND:fr,squeeze:mr,stack:gr,unstack:br,setdiff1dAsync:yr,fill:Xn,linspace:Yn,ones:qn,range:Jn,scalar:Ln,tensor:Pn,tensor1d:Bn,tensor2d:zn,tensor3d:Wn,tensor4d:Vn,tensor5d:Un,tensor6d:Gn,variable:Hn,zeros:Kn,onesLike:Zn,zerosLike:Qn,transpose:hi,softmax:li,logSoftmax:di,localResponseNormalization:pd,norm:fd,gather:dl,unsortedSegmentSum:hl,basicLSTMCell:md,multiRNNCell:gd,movingAverage:bd,stridedSlice:yd,topk:vd,scatterND:xd,fft:wd,ifft:kd,rfft:Sd,irfft:Od,sparseToDense:Cd,gatherND:Td,diag:Id,dropout:Nd,hannWindow:Rd,hammingWindow:jd,frame:Dd,stft:Fd,inTopKAsync:Pd});function bh(t,e){Array.isArray(t)||(t=[t]),t.forEach((function(t){null!=t&&T("complex64"!==t.dtype,(function(){return e+" does not support complex64 tensors."}))}))}function yh(t,e,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,d=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,f="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=or(a.outShape,n),g=m.values,b=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],v=a.outShape[3],x=0;x<a.batchSize;++x)for(var w=x*b,k=x*r[0],S=0;S<a.inChannels;++S)for(var O=0;O<a.outHeight;++O)for(var _=O*o-h,C=Math.max(0,_),T=Math.min(a.inHeight,l+_),I=w+O*y,N=0;N<a.outWidth;++N){for(var E=N*s-p,A=Math.max(0,E),R=Math.min(a.inWidth,d+E),j=f,D=0,F=0,M=C;M<T;M+=u){for(var P=k+M*r[1],$=A;$<R;$+=c){var L=t[P+$*r[2]+S];"max"===i&&L>j?j=L:"avg"===i&&(D+=L,F++)}if(isNaN(j))break}g[I+N*v+S]="avg"===i?D/F:j}return m}function vh(t,e,n,r,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1);for(var o=or(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,f=r.padInfo.left,m=or(e,n,t),g=0;g<r.batchSize;++g)for(var b=0;b<r.inChannels;++b)for(var y=0;y<r.outHeight;++y){for(var v=y*s-p,x=v;x<0;)x+=c;for(var w=Math.min(r.inHeight,d+v),k=0;k<r.outWidth;++k){for(var S=k*u-f,O=S;O<0;)O+=l;for(var _=Math.min(r.inWidth,h+S),C=Number.NEGATIVE_INFINITY,T=-1,I=x;I<w;I+=c)for(var N=I-v,E=O;E<_;E+=l){var A=E-S,R=m.get(g,I,E,b);R>C&&(C=R,T=a?i?((g*r.inHeight+I)*r.inWidth+E)*r.inChannels+b:(I*r.inWidth+E)*r.inChannels+b:N*h+A)}o.set(T,g,y,k,b)}}return o}function xh(t,e,n,r){if("linear"===n)return t.linear(e);if("relu"===n)return t.relu(e);if("elu"===n)return t.elu(e);if("relu6"===n)return t.relu6(e);if("prelu"===n)return t.prelu(e,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var wh=function(t){function e(){var e=t.call(this)||this;return e.blockSize=48,e.firstUse=!0,e.data=new pi(e,Vt),e}return o(e,t),e.prototype.write=function(t,e,n){this.firstUse&&(this.firstUse=!1,d().get("IS_NODE")&&yn("\n============================\nHi there 👋. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:t,dtype:n}),r},e.prototype.move=function(t,e,n,r){this.data.set(t,{values:e,dtype:r})},e.prototype.numDataIds=function(){return this.data.numDataIds()},e.prototype.read=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.readSync(t)]}))}))},e.prototype.readSync=function(t){var e=this.data.get(t),n=e.dtype,r=e.complexTensors;return"complex64"===n?Ri(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(t).values},e.prototype.bufferSync=function(t){var e=this.readSync(t.dataId),n=e;if("string"===t.dtype)try{n=e.map((function(t){return ct(t)}))}catch(t){throw new Error("Failed to decode encoded string bytes into utf-8")}return or(t.shape,t.dtype,n)},e.prototype.makeOutput=function(t,e,n){var r=this.write(t,e,n);return Vt.makeTensorFromDataId(r,e,n,this)},e.prototype.disposeData=function(t){if(this.data.has(t)){var e=this.data.get(t).complexTensors;null!=e&&(e.real.dispose(),e.imag.dispose()),this.data.delete(t)}},e.prototype.time=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return e=ot(),t(),[2,{kernelMs:ot()-e}]}))}))},e.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},e.prototype.complex=function(t,e){var n=this.makeOutput(null,t.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:Vt.keep(t.clone()),imag:Vt.keep(e.clone())},n},e.prototype.real=function(t){return this.data.get(t.dataId).complexTensors.real.clone()},e.prototype.imag=function(t){return this.data.get(t.dataId).complexTensors.imag.clone()},e.prototype.slice=function(t,e,n){if(bh(t,"slice"),ti(t.shape,e,n)){var r=ei(e,t.strides),a=A(n);return Pn(this.readSync(t.dataId).subarray(r,r+a),n,t.dtype)}for(var i=or(n,t.dtype),o=this.bufferSync(t),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(t,n){return t+e[n]}));i.values[s]=o.get.apply(o,u)}return i.toTensor()},e.prototype.stridedSlice=function(t,e,n,r){bh(t,"stridedSlice");var a=Ja(e,n,r);if(a.some((function(t){return 0===t})))return Pn([],a);for(var i=or(a,t.dtype),o=this.bufferSync(t),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+e[l];i.set.apply(i,[o.get.apply(o,c)].concat(u))}return i.toTensor()},e.prototype.diag=function(t){for(var e=this.readSync(t.dataId),n=or([t.size,t.size],t.dtype),r=n.values,a=0;a<e.length;a++)r[a*t.size+a]=e[a];return n.toTensor()},e.prototype.unstack=function(t,e){for(var n=t.shape[e],r=new Array(t.rank-1),a=0,i=0;i<t.rank;i++)i!==e&&(r[a++]=t.shape[i]);var o=new Array(t.rank).fill(0),s=t.shape.slice();s[e]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[e]=i,u[i]=this.slice(t,o,s).reshape(r);return u},e.prototype.reverse=function(t,e){bh(t,"reverse");for(var n=or(t.shape,t.dtype),r=this.bufferSync(t),a=function(a){var i=n.indexToLoc(a),o=i.slice();e.forEach((function(e){return o[e]=t.shape[e]-1-o[e]})),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},e.prototype.concat=function(t,e){var n=this;if("complex64"===t[0].dtype){var r=t.map((function(t){return Fn(t)})),a=t.map((function(t){return Mn(t)}));return Dn(this.concat(r,e),this.concat(a,e))}var i=t.map((function(t){var n=A(t.shape.slice(e));return t.as2D(-1,n)})),o=Rn(i.map((function(t){return t.shape})),1),s=or(o,t[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(t){s.set(n.readSync(t.dataId),u),u+=t.size}))}else{var c=0;i.forEach((function(t){for(var e=n.readSync(t.dataId),r=0,a=0;a<t.shape[0];++a)for(var i=a*o[1]+c,u=0;u<t.shape[1];++u)s[i+u]=e[r++];c+=t.shape[1]}))}var l=Rn(t.map((function(t){return t.shape})),e);return Pn(s,l,t[0].dtype)},e.prototype.neg=function(t){return bh(t,"neg"),this.multiply(Ln(-1),t)},e.prototype.add=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t+n,imag:e+r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t+e}))},e.prototype.addN=function(t){var e=this;bh(t,"addN");for(var n=t.map((function(t){return e.readSync(t.dataId)})),r=or(t[0].shape,t[0].dtype),a=r.values,i=0;i<t.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},e.prototype.softmax=function(t,e){var n=L([e],t.shape),r=this.max(t,n),a=Cn(r.shape,n),i=this.subtract(t,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return Ba(o,s)},e.prototype.subtract=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t-n,imag:e-r}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t-e}))},e.prototype.pow=function(t,e){return bh([t,e],"pow"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.pow(t,e)}))},e.prototype.batchMatMul=function(t,e,n,r){bh([t,e],"matMul");for(var a=n?t.shape[1]:t.shape[2],i=n?t.shape[2]:t.shape[1],o=r?e.shape[1]:e.shape[2],s=t.shape[0],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=n?[t.strides[0],1,t.strides[1]]:[t.strides[0],t.strides[1],1],d=l[0],h=l[1],p=l[2],f=r?[1,e.strides[1],e.strides[0]]:[e.strides[1],1,e.strides[0]],m=f[0],g=f[1],b=f[2],y=i*o,v=or([s,i,o],t.dtype),x=v.values,w=this.blockSize,k=0;k<s;k++)for(var S=0;S<i;S+=w)for(var O=0;O<o;O+=w)for(var _=0;_<a;_+=w)for(var C=Math.min(S+w,i),T=Math.min(O+w,o),I=Math.min(_+w,a),N=S;N<C;N++)for(var E=O;E<T;E++){for(var A=0,R=_;R<I;R++)A+=u[k*d+N*h+R*p]*c[R*m+E*g+k*b];x[k*y+(N*o+E)]+=A}return v.toTensor()},e.prototype.fusedBatchMatMul=function(t){var e=t.a,n=t.b,r=t.transposeA,a=t.transposeB,i=t.bias,o=t.activation,s=t.preluActivationWeights,u=this.batchMatMul(e,n,r,a);return i&&(u=this.add(u,i)),o&&(u=xh(this,u,o,s)),u},e.prototype.multiply=function(t,e){return"complex64"===t.dtype||"complex64"===e.dtype?this.broadcastedBinaryComplexOp(t.cast("complex64"),e.cast("complex64"),(function(t,e,n,r){return{real:t*n-e*r,imag:t*r+e*n}})):this.broadcastedBinaryOp(t,e,Dt(t.dtype,e.dtype),(function(t,e){return t*e}))},e.prototype.floorDiv=function(t,e){return bh([t,e],"floorDiv"),this.broadcastedBinaryOp(t,e,"int32",(function(t,e){return Math.floor(t/e)}))},e.prototype.sum=function(t,e){bh(t,"sum"),Tn("sum",e,t.rank);for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,Dt(t.dtype,"int32")),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=0,h=0;h<o;++h)d+=u[l+h];s[c]=d}return i},e.prototype.prod=function(t,e){bh(t,"sum");for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,Dt(t.dtype,"int32")),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=1,h=0;h<o;++h)d*=u[l+h];s[c]=d}return i},e.prototype.unsortedSegmentSum=function(t,e,n){bh(t,"unsortedSegmentSum");for(var r=[],a=t.rank-e.rank,i=0;i<a;++i)e=e.expandDims(i+1);for(i=0;i<n;++i){var o=Ln(i,"int32"),s=Jc(o,e).asType("float32").mul(t).sum(0);r.push(s)}return gr(r)},e.prototype.argMin=function(t,e){bh(t,"argMin");var n=[e];Tn("argMin",n,t.rank);for(var r=_n(t.shape,n),a=r[0],i=r[1],o=Kn(a,"int32"),s=A(i),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var d=l*s,h=c[d],p=0,f=0;f<s;++f){var m=c[d+f];m<h&&(h=m,p=f)}u[l]=p}return o},e.prototype.argMax=function(t,e){bh(t,"argMax");var n=[e];Tn("argMax",n,t.rank);for(var r=_n(t.shape,n),a=r[0],i=r[1],o=Kn(a,"int32"),s=A(i),u=this.readSync(o.dataId),c=this.readSync(t.dataId),l=0;l<u.length;++l){for(var d=l*s,h=c[d],p=0,f=0;f<s;++f){var m=c[d+f];m>h&&(h=m,p=f)}u[l]=p}return o},e.prototype.cumsum=function(t,e,n,r){if(bh(t,"cumsum"),e!==t.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(t.rank-1)+" but got axis="+e);for(var a=Dt(t.dtype,"int32"),i=Kn(t.shape,a),o=this.readSync(i.dataId),s=this.readSync(t.dataId),u=t.shape[t.rank-1],c=r?function(t,e){return t+u-e-1}:function(t,e){return t+e},l=0;l<s.length;l+=u)for(var d=0;d<u;d++){var h=c(l,d);if(0===d)o[h]=n?0:s[h];else{var p=c(l,d-1);o[h]=n?s[p]+o[p]:s[h]+o[p]}}return i},e.prototype.equal=function(t,e){return bh([t,e],"equal"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t===e?1:0}))},e.prototype.notEqual=function(t,e){return bh([t,e],"notEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t!==e?1:0}))},e.prototype.less=function(t,e){return bh([t,e],"less"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<e?1:0}))},e.prototype.lessEqual=function(t,e){return bh([t,e],"lessEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t<=e?1:0}))},e.prototype.greater=function(t,e){return bh([t,e],"greater"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>e?1:0}))},e.prototype.greaterEqual=function(t,e){return bh([t,e],"greaterEqual"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t>=e?1:0}))},e.prototype.logicalNot=function(t){bh(t,"logicalNot");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)n[r]=e[r]?0:1;return this.makeOutput(n,t.shape,"bool")},e.prototype.logicalAnd=function(t,e){return bh([t,e],"logicalAnd"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t&&e}))},e.prototype.logicalOr=function(t,e){return bh([t,e],"logicalOr"),this.broadcastedBinaryOp(t,e,"bool",(function(t,e){return t||e}))},e.prototype.select=function(t,e,n){bh([t,e,n],"select");for(var r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=this.readSync(n.dataId),o=Kn(e.shape,Dt(e.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===t.rank||t.rank>1||1===e.rank?1:A(e.shape.slice(1)),l=0;l<r.length;l++)for(var d=0;d<c;d++)1===r[l]?s[u++]=a[l]:s[u++]=i[l];return o},e.prototype.where=function(t){bh([t],"where");var e=this.readSync(t.dataId);return qi(t.shape,e)},e.prototype.topk=function(t,e,n){return bh(t,"topk"),Hi(this.readSync(t.dataId),t.shape,t.dtype,e)},e.prototype.min=function(t,e){bh(t,"min"),Tn("min",e,t.rank);for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,t.dtype),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],h=0;h<o;++h){var p=u[l+h];p<d&&(d=p)}s[c]=d}return i},e.prototype.minimum=function(t,e){return bh([t,e],"minimum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.min(t,e)}))},e.prototype.mod=function(t,e){return bh([t,e],"mod"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}))},e.prototype.max=function(t,e){bh(t,"max"),Tn("max",e,t.rank);for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,t.dtype),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],h=0;h<o;++h){var p=u[l+h];p>d&&(d=p)}s[c]=d}return i},e.prototype.maximum=function(t,e){return bh([t,e],"maximum"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.max(t,e)}))},e.prototype.all=function(t,e){bh(t,"all"),Tn("all",e,t.rank);for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,t.dtype),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],h=0;h<o;++h){var p=u[l+h];d=d&&p}s[c]=d}return i},e.prototype.any=function(t,e){bh(t,"any"),Tn("any",e,t.rank);for(var n=_n(t.shape,e),r=n[0],a=n[1],i=Kn(r,t.dtype),o=A(a),s=this.readSync(i.dataId),u=this.readSync(t.dataId),c=0;c<s.length;++c){for(var l=c*o,d=u[l],h=0;h<o;++h){var p=u[l+h];d=d||p}s[c]=d}return i},e.prototype.squaredDifference=function(t,e){return bh([t,e],"squaredDifference"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){var n=t-e;return n*n}))},e.prototype.ceil=function(t){bh(t,"ceil");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.ceil(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.floor=function(t){bh(t,"floor");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.floor(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.sign=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)e[r]<0?n[r]=-1:e[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,t.shape,"float32")},e.prototype.isNaN=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isNaN(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isInf=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Math.abs(e[r])===1/0&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.isFinite=function(t){bh(t,"x");for(var e=this.readSync(t.dataId),n=new Uint8Array(e.length),r=0;r<e.length;++r)Number.isFinite(e[r])&&(n[r]=1);return this.makeOutput(n,t.shape,"bool")},e.prototype.round=function(t){bh(t,"round");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=Math.floor(e[r]);e[r]-a<.5?n[r]=Math.floor(e[r]):e[r]-a>.5?n[r]=Math.ceil(e[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,t.shape,"float32")},e.prototype.exp=function(t){bh(t,"exp");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.exp(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.expm1=function(t){bh(t,"expm1");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=Math.expm1(e[r]);return this.makeOutput(n,t.shape,"float32")},e.prototype.log=function(t){bh(t,"log");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.log(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.log1p=function(t){bh(t,"log1p");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.log1p(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.sqrt=function(t){bh(t,"sqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.rsqrt=function(t){bh(t,"rsqrt");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r){var a=e[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,t.shape,"float32")},e.prototype.reciprocal=function(t){bh(t,"reciprocal");for(var e=this.readSync(t.dataId),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=1/e[r];return this.makeOutput(n,t.shape,"float32")},e.prototype.linear=function(t){return t},e.prototype.relu=function(t){bh(t,"relu");for(var e=Kn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return e},e.prototype.relu6=function(t){bh(t,"relu");for(var e=Kn(t.shape,t.dtype),n=this.readSync(e.dataId),r=this.readSync(t.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return e},e.prototype.prelu=function(t,e){return bh([t,e],"prelu"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return t<0?e*t:t}))},e.prototype.elu=function(t){bh(t,"elu");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var a=n[r];e[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(e,t.shape,"float32")},e.prototype.eluDer=function(t,e){bh([t,e],"eluDer");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,e.shape,"float32")},e.prototype.selu=function(t){bh(t,"selu");for(var e=hu,n=pu,r=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>=0?n*o:e*(Math.exp(o)-1)}return this.makeOutput(r,t.shape,"float32")},e.prototype.clip=function(t,e,n){bh(t,"clip");for(var r=new Float32Array(t.size),a=this.readSync(t.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<e?e:o}return this.makeOutput(r,t.shape,"float32")},e.prototype.abs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.abs(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.complexAbs=function(t){for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<t.size;++r){var a=n[2*r],i=n[2*r+1];e[r]=Math.hypot(a,i)}return this.makeOutput(e,t.shape,"float32")},e.prototype.int=function(t){bh(t,"int");for(var e=new Int32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=n[r];return this.makeOutput(e,t.shape,"int32")},e.prototype.sigmoid=function(t){bh(t,"sigmoid");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(e,t.shape,"float32")},e.prototype.softplus=function(t){bh(t,"softplus");for(var e=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(t.size),r=this.readSync(t.dataId),a=0;a<r.length;++a){var i=r[a]>-e,o=r[a]<e,s=Math.exp(r[a]),u=void 0;u=o?s:i?r[a]:Math.log(1+s),n[a]=u}return this.makeOutput(n,t.shape,"float32")},e.prototype.sin=function(t){bh(t,"sin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cos=function(t){bh(t,"cos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tan=function(t){bh(t,"tan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.tan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asin=function(t){bh(t,"asin");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asin(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acos=function(t){bh(t,"acos");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acos(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan=function(t){bh(t,"atan");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atan(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atan2=function(t,e){return bh([t,e],"atan2"),this.broadcastedBinaryOp(t,e,t.dtype,(function(t,e){return Math.atan2(t,e)}))},e.prototype.sinh=function(t){bh(t,"sinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.sinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.cosh=function(t){bh(t,"cosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.cosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.tanh=function(t){bh(t,"tanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=D(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.asinh=function(t){bh(t,"asinh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.asinh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.acosh=function(t){bh(t,"acosh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.acosh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.atanh=function(t){bh(t,"atanh");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r)e[r]=Math.atanh(n[r]);return this.makeOutput(e,t.shape,"float32")},e.prototype.erf=function(t){bh(t,"erf");for(var e=new Float32Array(t.size),n=this.readSync(t.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);e[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(e,t.shape,"float32")},e.prototype.step=function(t,e){void 0===e&&(e=0),bh(t,"step");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:e}return this.makeOutput(n,t.shape,"float32")},e.prototype.fusedConv2d=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights,s=this.conv2d(e,n,r);return a&&(s=this.add(s,a)),i&&(s=xh(this,s,i,o)),s},e.prototype.conv2d=function(t,e,n){bh([t,e],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=or(n.outShape,t.dtype),d=t.strides[0],h=c?t.strides[1]:t.strides[2],p=c?t.strides[2]:1,f=c?1:t.strides[1],m=l.strides[0],g=c?l.strides[1]:l.strides[2],b=c?l.strides[2]:1,y=c?1:l.strides[1],v=this.readSync(t.dataId),x=this.readSync(e.dataId),w=l.values,k=0;k<n.batchSize;++k)for(var S=k*d,O=k*m,_=0;_<n.outHeight;++_)for(var C=O+_*g,T=_*n.strideHeight-u,I=0;I<r;I++){var N=T+I*i;if(!(N<0||N>=n.inHeight))for(var E=I*e.strides[0],A=S+N*h,R=0;R<n.outWidth;++R)for(var j=C+R*b,D=R*n.strideWidth-s,F=0;F<a;F++){var M=D+F*o;if(!(M<0||M>=n.inWidth))for(var P=A+M*p,$=E+F*e.strides[1],L=0;L<n.inChannels;++L){for(var B=v[P+L*f],z=0;z<n.outChannels;++z)w[j+z*y]+=B*x[$+z];$+=n.outChannels}}}return l.toTensor()},e.prototype.conv3d=function(t,e,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,d=n.padInfo.top,h=or(n.outShape,t.dtype),p=this.readSync(t.dataId),f=this.readSync(e.dataId),m=h.values,g=0;g<n.batchSize;++g)for(var b=g*t.strides[0],y=g*h.strides[0],v=0;v<n.outDepth;++v)for(var x=y+v*h.strides[1],w=v*n.strideDepth-c,k=0;k<r;k++){var S=w+k*o;if(!(S<0||S>=n.inDepth))for(var O=k*e.strides[0],_=b+S*t.strides[1],C=0;C<n.outHeight;++C)for(var T=x+C*h.strides[2],I=C*n.strideHeight-d,N=0;N<a;N++){var E=I+N*s;if(!(E<0||E>=n.inHeight))for(var A=O+N*e.strides[1],R=_+E*t.strides[2],j=0;j<n.outWidth;++j)for(var D=T+j*n.outChannels,F=j*n.strideWidth-l,M=0;M<i;M++){var P=F+M*u;if(!(P<0||P>=n.inWidth))for(var $=A+M*e.strides[2],L=R+P*n.inChannels,B=$,z=0;z<n.inChannels;++z){for(var W=p[L+z],V=0;V<n.outChannels;++V)m[D+V]+=W*f[B+V];B+=n.outChannels}}}}return h.toTensor()},e.prototype.conv2dDerInput=function(t,e,n){bh([t,e],"conv2dDerInput");for(var r=or(n.inShape,"float32"),a=r.values,i=this.readSync(t.dataId),o=this.readSync(e.dataId),s=e.strides,u=s[0],c=s[1],l=s[2],d=n.batchSize,h=n.filterHeight,p=n.filterWidth,f=n.inChannels,m=n.inHeight,g=n.inWidth,b=n.outChannels,y=n.outHeight,v=n.outWidth,x=n.strideHeight,w=n.strideWidth,k=n.dataFormat,S=h-1-n.padInfo.top,O=p-1-n.padInfo.left,_="channelsLast"===k,C=r.strides[0],T=_?r.strides[1]:r.strides[2],I=_?r.strides[2]:1,N=_?1:r.strides[1],E=t.strides[0],A=_?t.strides[1]:t.strides[2],R=_?t.strides[2]:1,j=_?1:t.strides[1],D=0;D<d;++D)for(var F=0;F<f;++F)for(var M=0;M<m;++M)for(var P=M-S,$=Math.max(0,Math.ceil(P/x)),L=Math.min(y,(h+P)/x),B=0;B<g;++B){for(var z=B-O,W=Math.max(0,Math.ceil(z/w)),V=Math.min(v,(p+z)/w),U=0,G=$;G<L;++G)for(var H=G*x-P,q=W;q<V;++q)for(var K=E*D+A*G+R*q,X=u*(h-1-H)+c*(p-1-(q*w-z))+l*F,Y=0;Y<b;++Y)U+=i[K+j*Y]*o[X+Y];a[C*D+T*M+I*B+N*F]=U}return r.toTensor()},e.prototype.conv3dDerInput=function(t,e,n){for(var r=or(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(t.dataId),d=t.strides,h=d[0],p=d[1],f=d[2],m=d[3],g=this.readSync(e.dataId),b=e.strides,y=b[0],v=b[1],x=b[2],w=b[3],k=n.batchSize,S=n.filterDepth,O=n.filterHeight,_=n.filterWidth,C=n.inChannels,T=n.inDepth,I=n.inHeight,N=n.inWidth,E=n.outChannels,A=n.outDepth,R=n.outHeight,j=n.outWidth,D=n.strideDepth,F=n.strideHeight,M=n.strideWidth,P=S-1-n.padInfo.front,$=O-1-n.padInfo.top,L=_-1-n.padInfo.left,B=0;B<k;++B)for(var z=0;z<C;++z)for(var W=0;W<T;++W)for(var V=W-P,U=Math.max(0,Math.ceil(V/D)),G=Math.min(A,(S+V)/D),H=0;H<I;++H)for(var q=H-$,K=Math.max(0,Math.ceil(q/F)),X=Math.min(R,(O+q)/F),Y=0;Y<N;++Y){for(var J=Y-L,Z=Math.max(0,Math.ceil(J/M)),Q=Math.min(j,(_+J)/M),tt=0,et=U;et<G;++et)for(var nt=et*D-V,rt=K;rt<X;++rt)for(var at=rt*F-q,it=Z;it<Q;++it)for(var ot=h*B+p*et+f*rt+m*it,st=y*(S-1-nt)+v*(O-1-at)+x*(_-1-(it*M-J))+w*z,ut=0;ut<E;++ut)tt+=l[ot+ut]*g[st+ut];a[o*B+s*W+u*H+c*Y+z]=tt}return r.toTensor()},e.prototype.conv2dDerFilter=function(t,e,n){bh([t,e],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=or(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,d=this.bufferSync(t),h=this.bufferSync(e),p=0;p<i;++p)for(var f=Math.max(0,Math.ceil((l-p)/r)),m=Math.min(n.outHeight,(n.inHeight+l-p)/r),g=0;g<o;++g)for(var b=Math.max(0,Math.ceil((c-g)/a)),y=Math.min(n.outWidth,(n.inWidth+c-g)/a),v=0;v<n.inChannels;++v)for(var x=0;x<n.outChannels;++x){for(var w=0,k=0;k<n.batchSize;++k)for(var S=f;S<m;++S)for(var O=p+S*r-l,_=b;_<y;++_){var C=g+_*a-c;w+=s?d.get(k,O,C,v)*h.get(k,S,_,x):d.get(k,v,O,C)*h.get(k,x,S,_)}u.set(w,p,g,v,x)}return u.toTensor()},e.prototype.conv3dDerFilter=function(t,e,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=or(n.filterShape,"float32"),l=c.values,d=c.strides,h=d[0],p=d[1],f=d[2],m=d[3],g=this.readSync(e.dataId),b=e.strides,y=b[0],v=b[1],x=b[2],w=b[3],k=this.readSync(t.dataId),S=t.strides,O=S[0],_=S[1],C=S[2],T=S[3],I=n.padInfo.front,N=n.padInfo.left,E=n.padInfo.top,A=0;A<o;++A)for(var R=Math.max(0,Math.ceil((I-A)/r)),j=Math.min(n.outDepth,(n.inDepth+I-A)/r),D=A*h,F=0;F<s;++F)for(var M=Math.max(0,Math.ceil((E-F)/a)),P=Math.min(n.outHeight,(n.inHeight+E-F)/a),$=F*p+D,L=0;L<u;++L)for(var B=Math.max(0,Math.ceil((N-L)/i)),z=Math.min(n.outWidth,(n.inWidth+N-L)/i),W=L*f+$,V=0;V<n.inChannels;++V)for(var U=V*m+W,G=0;G<n.outChannels;++G){for(var H=0,q=0;q<n.batchSize;++q)for(var K=q*O,X=q*y,Y=R;Y<j;++Y)for(var J=(A+Y*r-I)*_+K,Z=Y*v+X,Q=M;Q<P;++Q)for(var tt=(F+Q*a-E)*C+J,et=Q*x+Z,nt=B;nt<z;++nt){var rt=nt*w+et;H+=k[(L+nt*i-N)*T+tt+V]*g[rt+G]}l[U+G]=H}return c.toTensor()},e.prototype.fusedDepthwiseConv2D=function(t){var e=t.input,n=t.filter,r=t.convInfo,a=t.bias,i=t.activation,o=t.preluActivationWeights,s=this.depthwiseConv2D(e,n,r);return a&&(s=this.add(s,a)),i&&(s=xh(this,s,i,o)),s},e.prototype.depthwiseConv2D=function(t,e,n){bh([t,e],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=or(n.outShape,t.dtype),d=this.readSync(t.dataId),h=this.readSync(e.dataId),p=l.values,f=0;f<n.batchSize;++f)for(var m=f*t.strides[0],g=f*l.strides[0],b=0;b<n.outHeight;++b)for(var y=g+b*l.strides[1],v=b*n.strideHeight-s,x=0;x<r;++x){var w=v+x*i;if(!(w<0||w>=n.inHeight))for(var k=x*e.strides[0],S=m+w*t.strides[1],O=0;O<n.outWidth;++O)for(var _=y+O*l.strides[2],C=O*n.strideWidth-u,T=0;T<a;++T){var I=C+T*o;if(!(I<0||I>=n.inWidth))for(var N=k+T*e.strides[1],E=S+I*n.inChannels,A=_,R=N,j=0;j<n.inChannels;++j){for(var D=d[E+j],F=0;F<c;++F)p[A+F]+=D*h[R+F];A+=c,R+=c}}}return l.toTensor()},e.prototype.depthwiseConv2DDerInput=function(t,e,n){bh([t,e],"depthwiseConv2DDerInput");for(var r=or(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=this.readSync(t.dataId),l=t.strides,d=l[0],h=l[1],p=l[2],f=this.readSync(e.dataId),m=e.strides,g=m[0],b=m[1],y=m[2],v=n.batchSize,x=n.filterHeight,w=n.filterWidth,k=n.inChannels,S=n.inHeight,O=n.inWidth,_=n.outChannels,C=n.outHeight,T=n.outWidth,I=n.strideHeight,N=n.strideWidth,E=x-1-n.padInfo.top,A=w-1-n.padInfo.left,R=_/k,j=0;j<v;++j)for(var D=0;D<k;++D)for(var F=0;F<S;++F)for(var M=F-E,P=Math.max(0,Math.ceil(M/I)),$=Math.min(C,(x+M)/I),L=0;L<O;++L){for(var B=L-A,z=Math.max(0,Math.ceil(B/N)),W=Math.min(T,(w+B)/N),V=0,U=P;U<$;++U)for(var G=U*I-M,H=z;H<W;++H)for(var q=d*j+h*U+p*H,K=g*(x-1-G)+b*(w-1-(H*N-B))+y*D,X=0;X<R;++X)V+=c[q+(D*R+X)]*f[K+X];a[o*j+s*F+u*L+D]=V}return r.toTensor()},e.prototype.depthwiseConv2DDerFilter=function(t,e,n){bh([t,e],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=or(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,d=this.bufferSync(t),h=this.bufferSync(e),p=0;p<i;++p)for(var f=Math.max(0,Math.ceil((c-p)/r)),m=Math.min(n.outHeight,(n.inHeight+c-p)/r),g=0;g<o;++g)for(var b=Math.max(0,Math.ceil((u-g)/a)),y=Math.min(n.outWidth,(n.inWidth+u-g)/a),v=0;v<n.outChannels;++v){for(var x=Math.trunc(v/l),w=v%l,k=0,S=0;S<n.batchSize;++S)for(var O=f;O<m;++O)for(var _=p+O*r-c,C=b;C<y;++C){var T=g+C*a-u;k+=d.get(S,_,T,x)*h.get(S,O,C,v)}s.set(k,p,g,x,w)}return s.toTensor()},e.prototype.tile=function(t,e){return bh(t,"tile"),Gi(this.bufferSync(t),e)},e.prototype.pad=function(t,e,n){bh(t,"pad");var r=e.map((function(e,n){return e[0]+t.shape[n]+e[1]})),a=e.map((function(t){return t[0]})),i=this.bufferSync(t),o=or(r,t.dtype);0!==n&&o.values.fill(n);for(var s=0;s<t.size;s++){var u=i.indexToLoc(s),c=u.map((function(t,e){return t+a[e]}));o.set.apply(o,[i.get.apply(i,u)].concat(c))}return o.toTensor()},e.prototype.gather=function(t,e,n){bh([t,e],"gather");var r=t.shape.slice(),a=this.readSync(e.dataId);r[n]=a.length;for(var i=or(r,t.dtype),o=this.bufferSync(t),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=a[u[n]];var l=o.locToIndex(c);i.values[s]=o.values[l]}return i.toTensor()},e.prototype.batchToSpaceND=function(t,e,n){bh([t],"batchToSpaceND");var r=e.reduce((function(t,e){return t*e})),a=vr(t.shape,e,r),i=xr(a.length,e.length),o=wr(t.shape,e,r),s=kr(n,e.length),u=Sr(o,n,e.length);return hi(t.reshape(a),i).reshape(o).slice(s,u)},e.prototype.spaceToBatchND=function(t,e,n){bh([t],"spaceToBatchND");var r=e.reduce((function(t,e){return t*e})),a=[[0,0]];a.push.apply(a,n);for(var i=1+e.length;i<t.shape.length;++i)a.push([0,0]);var o=t.pad(a),s=vr(o.shape,e,r,!1),u=xr(s.length,e.length,!1),c=wr(o.shape,e,r,!1);return hi(o.reshape(s),u).reshape(c)},e.prototype.maxPool=function(t,e){return bh(t,"maxPool"),yh(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"max").toTensor()},e.prototype.maxPoolBackprop=function(t,e,n,r){bh([e,n],"maxPoolBackprop");for(var a=this.readSync(e.dataId),i=or(r.outShape,e.dtype,vh(a,e.shape,e.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=d-1-r.padInfo.left,p=l-1-r.padInfo.top,f=or(e.shape,"float32"),m=this.bufferSync(t),g=0;g<r.batchSize;++g)for(var b=0;b<r.inChannels;++b)for(var y=0;y<r.inHeight;++y)for(var v=0;v<r.inWidth;++v){for(var x=y-p,w=v-h,k=0,S=0;S<l;S+=u){var O=(x+S)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var _=0;_<d;_+=c){var C=(w+_)/s;if(!(C<0||C>=r.outWidth||Math.floor(C)!==C)){var T=l*d-1-i.get(g,O,C,b)===S*d+_?1:0;0!==T&&(k+=m.get(g,O,C,b)*T)}}}f.set(k,g,y,v,b)}return f.toTensor()},e.prototype.avgPoolBackprop=function(t,e,n){bh([t,e],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,d=l-1-n.padInfo.left,h=c-1-n.padInfo.top,p=or(e.shape,"float32"),f=1/(i*o),m=this.bufferSync(t),g=0;g<n.batchSize;++g)for(var b=0;b<n.inChannels;++b)for(var y=0;y<n.inHeight;++y)for(var v=0;v<n.inWidth;++v){for(var x=y-h,w=v-d,k=0,S=0;S<c;S+=s){var O=(x+S)/r;if(!(O<0||O>=n.outHeight||Math.floor(O)!==O))for(var _=0;_<l;_+=u){var C=(w+_)/a;C<0||C>=n.outWidth||Math.floor(C)!==C||(k+=m.get(g,O,C,b))}}p.set(k*f,g,y,v,b)}return p.toTensor()},e.prototype.pool3d=function(t,e,n){bh(t,"pool3d");for(var r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(t.dataId),b=or(e.outShape,t.dtype),y=b.values,v=e.outShape[1]*e.outShape[2]*e.outShape[3]*e.outShape[4],x=e.outShape[2]*e.outShape[3]*e.outShape[4],w=e.outShape[3]*e.outShape[4],k=e.outShape[4],S=0;S<e.batchSize;++S)for(var O=S*v,_=S*t.strides[0],C=0;C<e.inChannels;++C)for(var T=0;T<e.outDepth;++T){for(var I=T*r-h,N=I;N<0;)N+=o;for(var E=Math.min(e.inDepth,c+I),A=O+T*x,R=0;R<e.outHeight;++R){for(var j=R*a-p,D=j;D<0;)D+=s;for(var F=Math.min(e.inHeight,l+j),M=A+R*w,P=0;P<e.outWidth;++P){for(var $=P*i-f,L=$;L<0;)L+=u;for(var B=Math.min(e.inWidth,d+$),z=M+P*k,W=m,V=0,U=0,G=N;G<E;G+=o){for(var H=_+G*t.strides[1],q=D;q<F;q+=s){for(var K=H+q*t.strides[2],X=L;X<B;X+=u){var Y=g[K+X*t.strides[3]+C];if("max"===n&&Y>W?W=Y:"avg"===n&&(V+=Y,U++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}y[z+C]="avg"===n?V/U:W}}}return b.toTensor()},e.prototype.avgPool3d=function(t,e){return bh(t,"avgPool3d"),this.pool3d(t,e,"avg").toFloat()},e.prototype.avgPool3dBackprop=function(t,e,n){bh([t,e],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,d=n.dilationWidth,h=n.effectiveFilterDepth,p=n.effectiveFilterHeight,f=n.effectiveFilterWidth,m=h-1-n.padInfo.front,g=f-1-n.padInfo.left,b=p-1-n.padInfo.top,y=or(e.shape,"float32"),v=1/(o*s*u),x=this.bufferSync(t),w=0;w<n.batchSize;++w)for(var k=0;k<n.inChannels;++k)for(var S=0;S<n.inDepth;++S)for(var O=0;O<n.inHeight;++O)for(var _=0;_<n.inWidth;++_){for(var C=S-m,T=O-b,I=_-g,N=0,E=0;E<h;E+=c){var A=(C+E)/r;if(!(A<0||A>=n.outDepth||Math.floor(A)!==A))for(var R=0;R<p;R+=l){var j=(T+R)/a;if(!(j<0||j>=n.outHeight||Math.floor(j)!==j))for(var D=0;D<f;D+=d){var F=(I+D)/i;F<0||F>=n.outWidth||Math.floor(F)!==F||(N+=x.get(w,A,j,F,k))}}}y.set(N*v,w,S,O,_,k)}return y.toTensor()},e.prototype.maxPool3d=function(t,e){return bh(t,"maxPool3d"),this.pool3d(t,e,"max").toFloat()},e.prototype.maxPool3dPositions=function(t,e){for(var n=or(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,l=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,f=e.padInfo.left,m=this.bufferSync(t),g=0;g<e.batchSize;++g)for(var b=0;b<e.inChannels;++b)for(var y=0;y<e.outDepth;++y){for(var v=y*r-h,x=v;x<0;)x+=o;for(var w=Math.min(e.inDepth,c+v),k=0;k<e.outHeight;++k){for(var S=k*a-p,O=S;O<0;)O+=s;for(var _=Math.min(e.inHeight,l+S),C=0;C<e.outWidth;++C){for(var T=C*i-f,I=T;I<0;)I+=u;for(var N=Math.min(e.inWidth,d+T),E=Number.NEGATIVE_INFINITY,A=-1,R=x;R<w;R+=o)for(var j=R-v,D=O;D<_;D+=s)for(var F=D-S,M=I;M<N;M+=u){var P=M-T,$=m.get(g,R,D,M,b);$>=E&&(E=$,A=j*l*d+F*l+P)}n.set(A,g,y,k,C,b)}}}return n.toTensor()},e.prototype.maxPool3dBackprop=function(t,e,n,r){bh([e,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(e,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,d=r.effectiveFilterDepth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=d-1-r.padInfo.front,m=p-1-r.padInfo.left,g=h-1-r.padInfo.top,b=or(e.shape,"float32"),y=this.bufferSync(a),v=this.bufferSync(t),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var k=0;k<r.inDepth;++k)for(var S=0;S<r.inHeight;++S)for(var O=0;O<r.inWidth;++O){for(var _=k-f,C=S-g,T=O-m,I=0,N=0;N<d;N+=u){var E=(_+N)/i;if(!(E<0||E>=r.outDepth||Math.floor(E)!==E))for(var A=0;A<h;A+=c){var R=(C+A)/o;if(!(R<0||R>=r.outHeight||Math.floor(R)!==R))for(var j=0;j<p;j+=l){var D=(T+j)/s;if(!(D<0||D>=r.outWidth||Math.floor(D)!==D)){var F=d*h*p-1-y.get(x,E,R,D,w)===N*h*p+A*p+j?1:0;0!==F&&(I+=v.get(x,E,R,D,w)*F)}}}}b.set(I,x,k,S,O,w)}return b.toTensor()},e.prototype.cast=function(t,e){return Ii(t,e,this)},e.prototype.reshape=function(t,e){return Ni(t,e)},e.prototype.avgPool=function(t,e){return bh(t,"avgPool"),bh(t,"maxPool"),yh(this.readSync(t.dataId),t.shape,t.dtype,t.strides,e,"avg").toTensor().toFloat()},e.prototype.resizeBilinear=function(t,e,n,r){bh(t,"resizeBilinear");for(var a=t.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(t.dataId),l=new Float32Array(A([i,e,n,u])),d=[r&&e>1?o-1:o,r&&n>1?s-1:s],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],p=0,f=d[0]/h[0],m=d[1]/h[1],g=0;g<i;g++)for(var b=0;b<e;b++)for(var y=f*b,v=Math.floor(y),x=y-v,w=Math.min(o-1,Math.ceil(y)),k=g*t.strides[0]+v*t.strides[1],S=g*t.strides[0]+w*t.strides[1],O=0;O<n;O++)for(var _=m*O,C=Math.floor(_),T=_-C,I=Math.min(s-1,Math.ceil(_)),N=k+C*t.strides[2],E=S+C*t.strides[2],R=k+I*t.strides[2],j=S+I*t.strides[2],D=0;D<u;D++){var F=c[N+D],M=c[E+D],P=F+(c[R+D]-F)*T,$=P+(M+(c[j+D]-M)*T-P)*x;l[p++]=$}return Pn(l,[i,e,n,u])},e.prototype.resizeBilinearBackprop=function(t,e,n){bh([t,e],"resizeBilinearBackprop");for(var r=e.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],d=new Float32Array(a*i*o*s),h=[n&&c>1?i-1:i,n&&l>1?o-1:o],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],f=h[0]/p[0],m=h[1]/p[1],g=this.readSync(t.dataId),b=0,y=0;y<a;y++)for(var v=y*e.strides[0],x=0;x<c;x++)for(var w=x*f,k=Math.floor(w),S=Math.min(Math.ceil(w),i-1),O=v+k*e.strides[1],_=v+S*e.strides[1],C=w-k,T=1-C,I=0;I<l;I++)for(var N=I*m,E=Math.floor(N),A=Math.min(Math.ceil(N),o-1),R=N-E,j=1-R,D=O+E*e.strides[2],F=O+A*e.strides[2],M=_+E*e.strides[2],P=_+A*e.strides[2],$=T*j,L=T*R,B=C*j,z=C*R,W=0;W<s;W++){var V=g[b++];d[D+W]+=V*$,d[F+W]+=V*L,d[M+W]+=V*B,d[P+W]+=V*z}return Vn(d,[a,o,i,s],e.dtype)},e.prototype.resizeNearestNeighbor=function(t,e,n,r){bh(t,"resizeNearestNeighbor");for(var a=t.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(t.dataId),l=new Float32Array(i*e*n*u),d=[r&&e>1?o-1:o,r&&n>1?s-1:s],h=[r&&e>1?e-1:e,r&&n>1?n-1:n],p=d[0]/h[0],f=d[1]/h[1],m=0,g=0;g<i;g++)for(var b=g*t.strides[0],y=0;y<e;y++)for(var v=p*y,x=b+Math.min(o-1,r?Math.round(v):Math.floor(v))*t.strides[1],w=0;w<n;w++)for(var k=f*w,S=x+Math.min(s-1,r?Math.round(k):Math.floor(k))*t.strides[2],O=0;O<u;O++){var _=c[S+O];l[m++]=_}return Pn(l,[i,e,n,u],t.dtype)},e.prototype.resizeNearestNeighborBackprop=function(t,e,n){bh([t,e],"resizeNearestNeighborBackprop");for(var r=e.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=t.shape,c=u[1],l=u[2],d=new Float32Array(a*i*o*s),h=this.readSync(t.dataId),p=[n&&c>1?i-1:i,n&&l>1?o-1:o],f=[n&&c>1?c-1:c,n&&l>1?l-1:l],m=p[0]/f[0],g=p[1]/f[1],b=1/m,y=1/g,v=2*Math.ceil(b)+2,x=2*Math.ceil(y)+2,w=0;w<a;w++)for(var k=w*e.strides[0],S=0;S<i;S++)for(var O=k+S*e.strides[1],_=Math.floor(S*b),C=Math.floor(_-v/2),T=0;T<o;T++)for(var I=O+T*e.strides[2],N=Math.floor(T*y),E=Math.floor(N-x/2),A=0;A<s;A++){for(var R=0,j=0;j<v;j++){var D=j+C;if(!(D<0||D>=c)){var F=k+D*t.strides[1],M=D*m;if(S===Math.min(i-1,n?Math.round(M):Math.floor(M)))for(var P=0;P<x;P++){var $=P+E;if(!($<0||$>=l)){var L=F+$*t.strides[2],B=$*g;T===Math.min(o-1,n?Math.round(B):Math.floor(B))&&(R+=h[L+A])}}}}d[I+A]=R}return Vn(d,e.shape,e.dtype)},e.prototype.batchNormalization=function(t,e,n,r,a,i){bh([t,e,n,a,i],"batchNorm");for(var o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),d=new Float32Array(o.length),h=l.length,p=c.length,f=u.length,m=s.length,g=0,b=0,y=0,v=0,x=0;x<o.length;++x)d[x]=l[g++]+(o[x]-s[b++])*c[y++]/Math.sqrt(u[v++]+r),g>=h&&(g=0),b>=m&&(b=0),y>=p&&(y=0),v>=f&&(v=0);return Vn(d,t.shape)},e.prototype.localResponseNormalization4D=function(t,e,n,r,a){bh(t,"localResponseNormalization4D");var i=t.shape[3],o=i-1,s=this.readSync(t.dataId),u=t.size,c=new Float32Array(u);function l(t){for(var n=t%i,r=t-n+Math.max(0,n-e),a=t-n+Math.min(n+e,o),u=0;r<=a;r++){var c=s[r];u+=c*c}return u}for(var d=0;d<u;d++){var h=l(d),p=s[d]*Math.pow(n+r*h,-a);c[d]=p}return Vn(c,t.shape)},e.prototype.LRNGrad=function(t,e,n,r,a,i,o){bh(t,"LRNGrad");for(var s=t.shape[3],u=this.readSync(t.dataId),c=this.readSync(e.dataId),l=this.readSync(n.dataId),d=new Float32Array(t.size),h=t.size,p=0;p<h;p++){for(var f=p%s,m=p-f+Math.max(0,f-r),g=p-f+Math.min(s,f+r+1),b=0,y=m;y<g;y++)b+=Math.pow(c[y],2);for(b=i*b+a,y=m;y<g;y++){var v=-2*i*o*c[y]*l[p]/b;p===y&&(v+=Math.pow(b,-o)),v*=u[p],d[y]+=v}}return Vn(d,t.shape)},e.prototype.multinomial=function(t,e,n,r){bh(t,"multinomial");for(var a=e?t:li(t),i=a.shape[0],o=a.shape[1],s=Kn([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var d=l*o,h=new Float32Array(o-1);h[0]=c[d];for(var p=1;p<h.length;++p)h[p]=h[p-1]+c[d+p];for(var f=tc(r.toString()),m=l*n,g=0;g<n;++g){var b=f();u[m+g]=h.length;for(var y=0;y<h.length;y++)if(b<h[y]){u[m+g]=y;break}}}return s},e.prototype.oneHot=function(t,e,n,r){bh(t,"oneHot");var a=new Float32Array(t.size*e);a.fill(r);for(var i=this.readSync(t.dataId),o=0;o<t.size;++o)i[o]>=0&&i[o]<e&&(a[o*e+i[o]]=n);return zn(a,[t.size,e],"int32")},e.prototype.nonMaxSuppression=function(t,e,n,r,a){return bh(t,"nonMaxSuppression"),$i(this.readSync(t.dataId),this.readSync(e.dataId),n,r,a)},e.prototype.fft=function(t){return this.fftBatch(t,!1)},e.prototype.ifft=function(t){return this.fftBatch(t,!0)},e.prototype.fftBatch=function(t,e){for(var n=t.shape[0],r=t.shape[1],a=or(t.shape,"float32"),i=or(t.shape,"float32"),o=Fn(t).as2D(n,r),s=Mn(t).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),d=Dn(c,l),h=this.readSync(this.fftImpl(d,e).dataId),p=0;p<r;p++){var f=ji(h,p);a.values[u*r+p]=f.real,i.values[u*r+p]=f.imag}return Dn(a.toTensor(),i.toTensor()).as2D(n,r)},e.prototype.fftImpl=function(t,e){var n=t.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,e).as2D(t.shape[0],t.shape[1]);return e&&(a=Dn(Fn(a).div(Ln(r)),Mn(a).div(Ln(r)))),a}var i=this.readSync(t.dataId),o=function(t){for(var e=new Float32Array(t.length/2),n=new Float32Array(t.length/2),r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}(this.fourierTransformByMatmul(i,r,e));return Dn(o.real,o.imag).as2D(t.shape[0],t.shape[1])},e.prototype.isExponentOf2=function(t){return 0==(t&t-1)},e.prototype.fftRadix2=function(t,e,n){if(1===e)return t;var r=this.readSync(t.dataId),a=e/2,i=function(t){for(var e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}(r),o=Dn(i.real,i.imag).as1D(),s=function(t){for(var e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e),a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}(r),u=Dn(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),u=this.fftRadix2(u,a,n);var c=function(t,e){for(var n=new Float32Array(t/2),r=new Float32Array(t/2),a=0;a<Math.ceil(t/2);a++){var i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(e,n),l=Dn(c.real,c.imag).mul(u),d=o.add(l),h=o.sub(l),p=Fn(d).concat(Fn(h)),f=Mn(d).concat(Mn(h));return Dn(p,f).as1D()},e.prototype.fourierTransformByMatmul=function(t,e,n){for(var r=new Float32Array(2*e),a=0;a<e;a++){for(var i=0,o=0,s=0;s<e;s++){var u=Fi(a*s,e,n),c=ji(t,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=e,o/=e),Di(r,i,o,a)}return r},e.prototype.depthToSpace=function(t,e,n){T("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),T(e>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+e}));for(var r=t.shape[0],a=t.shape[1],i=t.shape[2],o=t.shape[3],s=a*e,u=i*e,c=o/(e*e),l=this.readSync(t.dataId),d=new Float32Array(r*s*u*c),h=0,p=0;p<r;++p)for(var f=0;f<s;++f)for(var m=Math.floor(f/e),g=f%e,b=0;b<u;++b)for(var y=Math.floor(b/e),v=(g*e+b%e)*c,x=0;x<c;++x){var w=x+v+o*(y+i*(m+a*p));d[h++]=l[w]}return Vn(d,[r,s,u,c])},e.prototype.broadcastedBinaryOp=function(t,e,n,r){var a=Wr(t.shape,e.shape),i=or(a,n),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Br(t.shape,a),c=Br(e.shape,a),l=i.values;if(u.length+c.length===0)for(var d=0;d<l.length;++d)l[d]=r(o[d%o.length],s[d%s.length]);else{var h=this.bufferSync(t),p=this.bufferSync(e),f=function(n){var a=i.indexToLoc(n),d=a.slice(-t.rank);u.forEach((function(t){return d[t]=0}));var f=h.locToIndex(d),m=a.slice(-e.rank);c.forEach((function(t){return m[t]=0}));var g=p.locToIndex(m);l[n]=r(o[f],s[g])};for(d=0;d<l.length;++d)f(d)}return i.toTensor()},e.prototype.broadcastedBinaryComplexOp=function(t,e,n){var r=Wr(t.shape,e.shape),a=or(r,"float32"),i=or(r,"float32"),o=this.readSync(t.dataId),s=this.readSync(e.dataId),u=Br(t.shape,r),c=Br(e.shape,r),l=a.values,d=i.values;if(u.length+c.length===0)for(var h=0;h<l.length;h++){var p=h%o.length,f=h%s.length,m=n(o[2*p],o[2*p+1],s[2*f],s[2*f+1]);l[h]=m.real,d[h]=m.imag}else{var g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),b=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=function(r){var i=a.indexToLoc(r),h=i.slice(-t.rank);u.forEach((function(t){return h[t]=0}));var p=g.locToIndex(h),f=i.slice(-e.rank);c.forEach((function(t){return f[t]=0}));var m=b.locToIndex(f),y=n(o[2*p],o[2*p+1],s[2*m],s[2*m+1]);l[r]=y.real,d[r]=y.imag};for(h=0;h<l.length;h++)y(h)}return this.complex(a.toTensor(),i.toTensor())},e.prototype.split=function(t,e,n){return Ui(t,e,n)},e.prototype.dispose=function(){},e.prototype.floatPrecision=function(){return 32},e.prototype.epsilon=function(){return 1e-7},e.prototype.cropAndResize=function(t,e,n,r,a,i){for(var o=t.shape,s=o[0],u=o[1],c=o[2],l=o[3],d=e.shape[0],h=r[0],p=r[1],f=or([d,h,p,l],"float32"),m=this.readSync(e.dataId),g=this.readSync(n.dataId),b=this.readSync(t.dataId),y=t.strides,v=f.strides,x=0;x<d;x++){var w=4*x,k=m[w],S=m[w+1],O=m[w+2],_=m[w+3],C=g[x];if(!(C>=s))for(var T=h>1?(O-k)*(u-1)/(h-1):0,I=p>1?(_-S)*(c-1)/(p-1):0,N=0;N<h;N++){var E=h>1?k*(u-1)+N*T:.5*(k+O)*(u-1);if(E<0||E>u-1)for(var A=0;A<p;A++)for(var R=0;R<l;R++){var j=R+A*v[2]+N*v[1]+x*v[0];f.values[j]=i}else if("bilinear"===a){var D=Math.floor(E),F=Math.ceil(E),M=E-D;for(A=0;A<p;A++)if((G=p>1?S*(c-1)+A*I:.5*(S+_)*(c-1))<0||G>c-1)for(R=0;R<l;R++)j=R+A*v[2]+N*v[1]+x*v[0],f.values[j]=i;else{var P=Math.floor(G),$=Math.ceil(G),L=G-P;for(R=0;R<l;R++){var B=b[j=R+P*y[2]+D*y[1]+C*y[0]],z=b[j=R+$*y[2]+D*y[1]+C*y[0]],W=b[j=R+P*y[2]+F*y[1]+C*y[0]],V=B+(z-B)*L,U=W+(b[j=R+$*y[2]+F*y[1]+C*y[0]]-W)*L;j=R+A*v[2]+N*v[1]+x*v[0],f.values[j]=V+(U-V)*M}}}else for(A=0;A<p;++A){var G;if((G=p>1?S*(c-1)+A*I:.5*(S+_)*(c-1))<0||G>c-1)for(R=0;R<l;R++)j=R+A*v[2]+N*v[1]+x*v[0],f.values[j]=i;else{var H=Math.round(G),q=Math.round(E);for(R=0;R<l;R++){var K=R+H*y[2]+q*y[1]+C*y[0],X=R+A*v[2]+N*v[1]+x*v[0];f.values[X]=b[K]}}}}}return f.toTensor()},e.prototype.sparseToDense=function(t,e,n,r){var a=qa(0,t,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,u=a.strides,c=a.outputSize;return this.scatter(t,e,n,c,s,o,i,u,r,!1)},e.prototype.gatherND=function(t,e){var n=e.shape,r=n[n.length-1],a=za(t,e),i=a[0],o=a[1],s=a[2],u=a[3];if(0===o)return Pn([],i,t.dtype);for(var c=new kt([o,s],t.dtype),l=this.readSync(e.dataId),d=this.readSync(t.dataId),h=0;h<o;h++){for(var p=[],f=0,m=0;m<r;m++){var g=l[h*r+m];f+=g*u[m],p.push(g)}if(f<0||f>=t.size/s)throw new Error("Invalid indices: "+p+" does not index into "+t.shape);for(var b=0;b<s;b++)c.values[h*s+b]=d[f*s+b]}return c.toTensor().reshape(i)},e.prototype.scatterND=function(t,e,n){var r=qa(0,t,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=Ln(0);return this.scatter(t,e,n,u,o,i,a,s,c,!0)},e.prototype.fill=function(t,e,n){var r=W(n=n||Z(e),A(t));return r.fill(e),Vt.makeTensor(r,t,n,this)},e.prototype.onesLike=function(t){if("string"===t.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(t.shape,1,t.dtype)},e.prototype.zerosLike=function(t){var e=W(t.dtype,A(t.shape));return this.makeOutput(e,t.shape,t.dtype)},e.prototype.linspace=function(t,e,n){return Ei(t,e,n)},e.prototype.scatter=function(t,e,n,r,a,i,o,s,u,c){var l=[r/a,a],d=this.readSync(t.dataId),h=this.readSync(e.dataId);if(0===r)return Pn([],n,e.dtype);var p=new kt(l,e.dtype);p.values.fill(this.readSync(u.dataId)[0]);for(var f=0;f<i;f++){for(var m=[],g=0,b=0;b<o;b++){var y=d[f*o+b];m.push(y),g+=y*s[b]}if(g<0||g>=r/a)throw new Error("Invalid indices: "+m+" does not index into "+n);for(var v=0;v<a;v++)c?p.values[g*a+v]+=h[f*a+v]:p.values[g*a+v]=0===e.rank?h[0]:h[f*a+v]}return p.toTensor().reshape(n)},e}(fi);function kh(t,e){return{kernelName:t,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,a=n.backend,i=r,o=i.a,s=i.b,u=a;bh([o,s],t);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,d=e(o.shape,s.shape,c,l,o.dtype),h=d[0],p=d[1];return{dataId:u.write(h,p,o.dtype),shape:p,dtype:o.dtype}}}}function Sh(t){return function(e,n,r,a,i){var o=Wr(e,n),s=o.length,u=et(o),c=z(i,A(o)),l=e.length,d=n.length,h=et(e),p=et(n),f=Br(e,o),m=Br(n,o);if(f.length+m.length===0)for(var g=0;g<c.length;++g)c[g]=t(r[g%r.length],a[g%a.length]);else{var b=function(e){var n=dt(e,s,u),i=n.slice(-l);f.forEach((function(t){return i[t]=0}));var o=lt(i,l,h),g=n.slice(-d);m.forEach((function(t){return g[t]=0}));var b=lt(g,d,p);c[e]=t(r[o],a[b])};for(g=0;g<c.length;++g)b(g)}return[c,o]}}Vt.registerBackend("cpu",(function(){return new wh}),1);var Oh=Sh((function(t,e){return t/e})),_h=kh(Cr,Oh),Ch={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;bh(a,"MaxPoolWithArgmax");var d=l.data.get(a.dataId).values,h=gi(a.shape,o,s,[1,1],u),p=function(t,e,n,r,a){var i=yh(t,0,n,et(e),a,"max"),o=vh(t,e,n,a,!0,r);return[i.values,o.values]}(d,a.shape,a.dtype,c,h),f=p[0],m=p[1],g=l.write(f,h.outShape,a.dtype),b=l.write(m,h.outShape,a.dtype);return[{dataId:g,shape:h.outShape,dtype:a.dtype},{dataId:b,shape:h.outShape,dtype:"int32"}]}},Th={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,h=n;bh(i,"NonMaxSuppressionWithScore");var p=Li(h.data.get(i.dataId).values,h.data.get(o.dataId).values,u,c,l,d);return[p.selectedIndices,p.selectedScores]}},Ih={kernelName:"Square",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=n;bh(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Nh=Sh((function(t,e){var n=t-e;return n*n}));function Eh(t,e,n,r,a){for(var i=A(e),o=e.length,s=et(e),u=et(a),c=z(n,A(a)),l=0;l<i;++l){for(var d=dt(l,o,s),h=new Array(d.length),p=0;p<h.length;p++)h[p]=d[r[p]];c[lt(h,o,u)]=t[l]}return c}for(var Ah=0,Rh=[Th,Ih,kh(Ir,Nh),_h,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,i=n.perm,o=r;bh(a,"transpose");for(var s=a.shape.length,u=new Array(s),c=0;c<u.length;c++)u[c]=a.shape[i[c]];var l=Eh(o.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:o.write(l,u,a.dtype),shape:u,dtype:a.dtype}}},Ch];Ah<Rh.length;Ah++)y(Rh[Ah]);for(var jh,Dh=function(t){this.variableNames=["A"];var e=Qi(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+e.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Fh=function(t){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var e=Qi(),n=t[0],r=t[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+e.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+e.output+" = result;\n      }\n    "},Mh=function(t,e){this.variableNames=["A"];for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];this.outputShape=n,this.rank=n.length;var a=po(this.rank),i=function(t){var e=t.length;if(e>6)throw Error("Transpose for rank "+e+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e),a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}(e);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},Ph=function(t,e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t[e[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=po(this.rank),i=Ji("rc",this.rank),o=new Array(this.rank);for(r=0;r<e.length;r++)o[e[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},$h=0,Lh=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs,a=e.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,u=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=u[0],l=u[1],h=[l,c],p=[l,c,i];(s||o)&&(null==jh&&(jh=document.createElement("canvas").getContext("2d")),jh.canvas.width=c,jh.canvas.height=l,jh.drawImage(a,0,0,c,l),a=jh.canvas);var f=n.makeTensorInfo(h,"int32");n.texData.get(f.dataId).usage=qt.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),a);var m=d().getBool("WEBGL_PACK")?new Fh(p):new Dh(p),g=n.runWebGLProgram(m,[f],"int32");return n.disposeData(f.dataId),g}},{kernelName:Cr,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e;return function(t,e,n){var r=new No(To,t.shape,e.shape);return d().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new Ro(Eo,t.shape,e.shape,!0)),n.runWebGLProgram(r,[t,e],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=t.attrs;yn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=e,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,d=s.softNmsSigma,h=n,p=Li(h.readSync(i.dataId),h.readSync(o.dataId),u,c,l,d);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e.x,a=n,i=new fu(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Ir,backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.backend,r=e,a=r.a,i=r.b,o=n,s=d().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ro("return (a - b) * (a - b);",a.shape,i.shape):new No("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(t){for(var e,n=t.inputs,r=t.attrs,a=t.backend,i=n.x,o=r.perm,s=a,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var h=Eh(s.texData.get(i.dataId).values,i.shape,i.dtype,o,c);e=s.makeTensorInfo(c,i.dtype),s.texData.get(e.dataId).values=h}else e=function(t,e,n){var r=d().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ph(t.shape,e):new Mh(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}(i,o,s);return e}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(t){var e=t.inputs,n=t.attrs,r=t.backend,a=e.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;T(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.shape.length+"."}));var d=[1,1];T(Ci(s,d),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+d+"'"}));var h=gi(a.shape,o,s,d,u),p=function(t,e,n,r){var a=new Us(n,"max",!1),i=r.runWebGLProgram(a,[t],"float32");return a=new Us(n,"max",!0,!0,e),[i,r.runWebGLProgram(a,[t],"float32")]}(a,c,h,l);return[p[0],p[1]]}}];$h<Lh.length;$h++)y(Lh[$h]);for(var Bh=0,zh=[{kernelName:Or,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],a=Wr(n.shape,r.shape);return{a:function(){var e=t,r=zr(n.shape,a);return r.length>0&&(e=e.sum(r)),e.reshape(n.shape)},b:function(){var e=t,n=zr(r.shape,a);return n.length>0&&(e=e.sum(n)),e.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(t,e){var n={};return e.forEach((function(e,r){n[r]=function(){return t.clone()}})),n}},{kernelName:Rr,gradFunc:function(t,e,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+i+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return t.sum(u,!0)}}}},{kernelName:Cr,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],a=Wr(n.shape,r.shape);return{a:function(){var e=Ba(t,r.toFloat()),i=zr(n.shape,a);return i.length>0?id(e,i).reshape(n.shape):e},b:function(){var e=t.mul(n.toFloat()),i=zr(r.shape,a);i.length>0&&(e=id(e,i).reshape(r.shape));var o=Kc(r);return sa(Ba(e,o.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(t,e,n){var r=n.varianceEpsilon,a=e[0],i=e[1],o=e[2],s=e[3],u=rc(a),c=null==s?Ln(1):s,l=zr(i.shape,u.shape),d=[];if(1===i.rank){for(var h=0;h<u.shape.length-1;++h)d.push(u.shape[h]);d.push(1)}var p=$a(a,i),f=ja(t,c),m=la(Lr(o,Ln(r))),g=ja(ja(ja(m,m),m),Ln(-.5));return{x:function(){return 1===i.rank?pr(ja(ja(t,Cc(m.as4D(1,1,1,i.shape[0]),d)),c),a.shape):pr(ja(ja(t,m),c),a.shape)},mean:function(){var t=ja(ja(m,Ln(-1)),f);return 1===i.rank&&(t=id(t,l)),pr(t,i.shape)},variance:function(){var t=ja(ja(g,p),f);return 1===i.rank&&(t=id(t,l)),pr(t,i.shape)},scale:function(){var e=ja(p,m),n=ja(t,e);return 1===i.rank&&(n=id(n,l)),pr(n,i.shape)},offset:function(){var e=t;return 1===i.rank&&(e=id(e,l)),pr(e,i.shape)}}}},{kernelName:Dr,gradFunc:function(t){return{x:function(){return t.toFloat()}}}},{kernelName:jr,inputsToSave:["indices"],gradFunc:function(t,e){var n=e[0];return{indices:function(){return Kn(n.shape,"float32")}}}},{kernelName:Mr,inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],a=n.paddings.map((function(t){return t[0]}));return{x:function(){return t.slice(a,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(t,e){var n=e[0];return{x:function(){return t.mul(n.toFloat().mul(2))}}}},{kernelName:Ir,inputsToSave:["a","b"],gradFunc:function(t,e){var n=e[0],r=e[1],a=Ln(2);return{a:function(){return ja(t,ja(a,$a(n,r)))},b:function(){return ja(t,ja(a,$a(r,n)))}}}},{kernelName:Fr,inputsToSave:["x"],gradFunc:function(t,e,n){var r=e[0],a=n.reps;return{x:function(){var e=Qn(r);if(1===r.rank)for(var n=0;n<a[0];++n)e=e.add(t.slice([n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<a[0];++n)for(var i=0;i<a[1];++i)e=e.add(t.slice([n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(var o=0;o<a[2];++o)e=e.add(t.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(o=0;o<a[2];++o)for(var s=0;s<a[3];++s)e=e.add(t.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return e}}}},{kernelName:"Transpose",gradFunc:function(t,e,n){var r=Nn(n.perm);return{x:function(){return hi(t,r)}}}}];Bh<zh.length;Bh++)v(zh[Bh]);var Wh=function(){function t(){}return t.prototype.fetch=function(t,e){return fetch(t,e)},t.prototype.now=function(){return performance.now()},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Browser's encoder only supports utf-8, but got "+e);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return new TextDecoder(e).decode(t)},t}();d().get("IS_BROWSER")&&d().setPlatform("browser",new Wh);var Vh,Uh=function(){return n(9)},Gh=function(){function t(){this.util=n(10),this.textEncoder=new this.util.TextEncoder}return t.prototype.fetch=function(t,e){return null!=d().global.fetch?d().global.fetch(t,e):(null==Vh&&(Vh=Uh()),Vh(t,e))},t.prototype.now=function(){var t=r.hrtime();return 1e3*t[0]+t[1]/1e6},t.prototype.encode=function(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)},t.prototype.decode=function(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)},t}();d().get("IS_NODE")&&d().setPlatform("node",new Gh);var Hh={float32:4,int32:4,uint16:2,uint8:1,bool:1},qh=4;function Kh(t,e){for(var n={},r=0,a=function(e){var a=e.name,i=e.dtype,o=e.shape,s=A(o),u=void 0;if("quantization"in e){var c=e.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+e.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=Hh[c.dtype],d=t.slice(r,r+s*l),h="uint8"===c.dtype?new Uint8Array(d):new Uint16Array(d);if("float32"===i)u=Float32Array.from(h,(function(t){return t*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=Int32Array.from(h,(function(t){return Math.round(t*c.scale+c.min)}))}r+=s*l}else if("string"===i){var p=A(e.shape);u=[];for(var f=0;f<p;f++){var m=new Uint32Array(t.slice(r,r+qh))[0];r+=qh;var g=new Uint8Array(t.slice(r,r+m));u.push(g),r+=m}}else{var b=Hh[i];if(d=t.slice(r,r+s*b),"float32"===i)u=new Float32Array(d);else if("int32"===i)u=new Int32Array(d);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=new Uint8Array(d)}r+=s*b}n[a]=Pn(u,o,i)},i=0,o=e;i<o.length;i++)a(o[i]);return n}function Xh(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));var e=0,n=[];t.forEach((function(t){if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)}));var r=new Uint8Array(e),a=0;return n.forEach((function(t){r.set(new Uint8Array(t.buffer),a),a+=t.byteLength})),r.buffer}var Yh="undefined"!=typeof a&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Jh(t){return Yh?a.byteLength(t):new Blob([t]).size}function Zh(t){var e=0;t.forEach((function(t){e+=t.byteLength}));var n=new Uint8Array(e),r=0;return t.forEach((function(t){n.set(new Uint8Array(t),r),r+=t.byteLength})),n.buffer}function Qh(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);var e=t.split("/");return e[e.length-1]}function tp(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:Jh(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:Jh(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}var ep=function(){function t(){this.saveRouters=[],this.loadRouters=[]}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerSaveRouter=function(e){t.getInstance().saveRouters.push(e)},t.registerLoadRouter=function(e){t.getInstance().loadRouters.push(e)},t.getSaveHandlers=function(e){return t.getHandlers(e,"save")},t.getLoadHandlers=function(e,n){return t.getHandlers(e,"load",n)},t.getHandlers=function(e,n,r){var a=[];return("load"===n?t.getInstance().loadRouters:t.getInstance().saveRouters).forEach((function(t){var n=t(e,r);null!==n&&a.push(n)})),a},t}(),np="://",rp=function(){function t(){this.managers={}}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t.registerManager=function(e,n){T(null!=e,(function(){return"scheme must not be undefined or null."})),e.endsWith(np)&&(e=e.slice(0,e.indexOf(np))),T(e.length>0,(function(){return"scheme must not be an empty string."}));var r=t.getInstance();T(null==r.managers[e],(function(){return"A model store manager is already registered for scheme '"+e+"'."})),r.managers[e]=n},t.getManager=function(t){var e=this.getInstance().managers[t];if(null==e)throw new Error("Cannot find model manager for scheme '"+t+"'");return e},t.getSchemes=function(){return Object.keys(this.getInstance().managers)},t}();function ap(t){if(-1===t.indexOf(np))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+rp.getSchemes().join(","));return{scheme:t.split(np)[0],path:t.split(np)[1]}}function ip(t,e,n){return void 0===n&&(n=!1),s(this,void 0,void 0,(function(){var r,a,i,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:return T(t!==e,(function(){return"Old path and new path are the same: '"+t+"'"})),T((r=ep.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+t+"."})),T(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+t+"."})),a=r[0],T((i=ep.getSaveHandlers(e)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+e+"."})),T(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+e+"."})),o=i[0],s=ap(t).scheme,c=ap(t).path,l=s===ap(t).scheme,[4,a.load()];case 1:return d=u.sent(),n&&l?[4,rp.getManager(s).removeModel(c)]:[3,3];case 2:u.sent(),u.label=3;case 3:return[4,o.save(d)];case 4:return h=u.sent(),!n||l?[3,6]:[4,rp.getManager(s).removeModel(c)];case 5:u.sent(),u.label=6;case 6:return[2,h.modelArtifactsInfo]}}))}))}var op="models_store",sp="model_info_store";function up(){if(!d().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var t=window||self,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(null==e)throw new Error("The current browser does not appear to support IndexedDB.");return e}function cp(t){var e=t.result;e.createObjectStore(op,{keyPath:"modelPath"}),e.createObjectStore(sp,{keyPath:"modelPath"})}var lp=function(){function t(t){if(this.indexedDB=up(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.databaseAction(this.modelPath)]}))}))},t.prototype.databaseAction=function(t,e){var n=this;return new Promise((function(t,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return cp(a)},a.onsuccess=function(){var i=a.result;if(null==e){var o=i.transaction(op,"readonly"),s=o.objectStore(op).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));t(s.result.modelArtifacts)},s.onerror=function(t){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=tp(e),l=i.transaction(sp,"readwrite"),d=l.objectStore(sp),h=d.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var a=(u=i.transaction(op,"readwrite")).objectStore(op).put({modelPath:n.modelPath,modelArtifacts:e,modelArtifactsInfo:c});a.onsuccess=function(){return t({modelArtifactsInfo:c})},a.onerror=function(t){var e=(d=l.objectStore(sp)).delete(n.modelPath);e.onsuccess=function(){return i.close(),r(a.error)},e.onerror=function(t){return i.close(),r(a.error)}}},h.onerror=function(t){return i.close(),r(h.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(t){return r(a.error)}}))},t.URL_SCHEME="indexeddb://",t}(),dp=function(t){return d().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(lp.URL_SCHEME)?(e=t.slice(lp.URL_SCHEME.length),new lp(e)):null;var e};ep.registerSaveRouter(dp),ep.registerLoadRouter(dp);var hp=function(){function t(){this.indexedDB=up()}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(e){return[2,new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return cp(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(sp,"readonly"),i=a.objectStore(sp).getAll();i.onsuccess=function(){for(var t={},n=0,r=i.result;n<r.length;n++){var a=r[n];t[a.modelPath]=a.modelArtifactsInfo}e(t)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(t){return n(r.error)}}))]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e=this;return u(this,(function(n){var r;return t=(r=t).startsWith(lp.URL_SCHEME)?r.slice(lp.URL_SCHEME.length):r,[2,new Promise((function(n,r){var a=e.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return cp(a)},a.onsuccess=function(){var e,i=a.result,o=i.transaction(sp,"readwrite"),s=o.objectStore(sp),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var a=s.delete(t),o=function(){var a=(e=i.transaction(op,"readwrite")).objectStore(op).delete(t);a.onsuccess=function(){return n(u.result.modelArtifactsInfo)},a.onerror=function(t){return r(u.error)}};a.onsuccess=o,a.onerror=function(t){return o(),i.close(),r(u.error)}},u.onerror=function(t){return i.close(),r(u.error)},o.oncomplete=function(){null==e?i.close():e.oncomplete=function(){return i.close()}}},a.onerror=function(t){return r(a.error)}}))]}))}))},t}();if(d().getBool("IS_BROWSER"))try{rp.registerManager(lp.URL_SCHEME,new hp)}catch(i){}var pp="/",fp="tensorflowjs_models",mp="info",gp="model_topology",bp="weight_specs",yp="weight_data",vp="model_metadata";function xp(t){return{info:[fp,t,mp].join(pp),topology:[fp,t,gp].join(pp),weightSpecs:[fp,t,bp].join(pp),weightData:[fp,t,yp].join(pp),modelMetadata:[fp,t,vp].join(pp)}}function wp(t){var e=t.split(pp);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(pp)}var kp=function(){function t(t){if(!d().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=xp(this.modelPath)}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r;return u(this,(function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");e=JSON.stringify(t.modelTopology),n=JSON.stringify(t.weightSpecs),r=tp(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,e),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(t){if(Yh)return a.from(t).toString("base64");for(var e=new Uint8Array(t),n="",r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(t){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,i,o,s;return u(this,(function(u){if(null==(t=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(e={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(e.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(e.weightSpecs=r,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),e.format=o.format,e.generatedBy=o.generatedBy,e.convertedBy=o.convertedBy,e.userDefinedMetadata=o.userDefinedMetadata),null==(s=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return e.weightData=function(t){if(Yh){var e=a.from(t,"base64");return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}for(var n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r.set([n.charCodeAt(i)],i);return r.buffer}(s),[2,e]}))}))},t.URL_SCHEME="localstorage://",t}(),Sp=function(t){return d().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(kp.URL_SCHEME)?(e=t.slice(kp.URL_SCHEME.length),new kp(e)):null;var e};ep.registerSaveRouter(Sp),ep.registerLoadRouter(Sp);var Op=function(){function t(){T(d().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),T("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return t.prototype.listModels=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,a,i;return u(this,(function(o){for(t={},e=fp+pp,n=pp+mp,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(e)&&a.endsWith(n)&&(i=wp(a),t[i]=JSON.parse(this.LS.getItem(a)));return[2,t]}))}))},t.prototype.removeModel=function(t){return s(this,void 0,void 0,(function(){var e,n;return u(this,(function(r){var a;if(t=(a=t).startsWith(kp.URL_SCHEME)?a.slice(kp.URL_SCHEME.length):a,e=xp(t),null==this.LS.getItem(e.info))throw new Error("Cannot find model at path '"+t+"'");return n=JSON.parse(this.LS.getItem(e.info)),this.LS.removeItem(e.info),this.LS.removeItem(e.topology),this.LS.removeItem(e.weightSpecs),this.LS.removeItem(e.weightData),[2,n]}))}))},t}();if(d().getBool("IS_BROWSER"))try{rp.registerManager(kp.URL_SCHEME,new Op)}catch(i){}var _p="model",Cp=".json",Tp=".weights.bin";function Ip(t){return new Promise((function(t){return setTimeout(t)})).then(t)}var Np=function(){function t(e){if(!d().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(t.URL_SCHEME)&&(e=e.slice(t.URL_SCHEME.length)),null!=e&&0!==e.length||(e=_p),this.modelTopologyFileName=e+Cp,this.weightDataFileName=e+Tp}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a,i,o;return u(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,Ip((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==t.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=e,[4,Ip((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:tp(t)}]}}))}))},t.URL_SCHEME="downloads://",t}(),Ep=function(){function t(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n=this;return u(this,(function(r){return t=this.files[0],e=this.files.slice(1),[2,new Promise((function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===e.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,e)}catch(t){return void a(t)}var l=[],d=[],h=[];u.forEach((function(t){t.paths.forEach((function(t){d.push(t),h.push(null)})),l.push.apply(l,t.weights)})),u.forEach((function(t){t.paths.forEach((function(t){var e=new FileReader;e.onload=function(e){var n=e.target.result,a=d.indexOf(t);h[a]=n,-1===h.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:Zh(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},e.onerror=function(e){return a("Failed to weights data from file of path '"+t+"'.")},e.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(t)}))]}))}))},t.prototype.checkManifestAndWeightFiles=function(t,e){for(var n=[],r=e.map((function(t){return Qh(t.name)})),a={},i=0,o=t;i<o.length;i++)o[i].paths.forEach((function(t){var i=Qh(t);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[t]=e[r.indexOf(i)]}));if(n.length!==e.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+e.length+").");return a},t}();function Ap(t,e,n,r){!function(t){T(null!=t&&Array.isArray(t)&&t.length>0,(function(){return"promises must be a none empty array"}))}(t),function(t,e){T(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+t})),T(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+e})),T(e>=t,(function(){return"startFraction must be no more than endFraction, but got startFraction "+t+" and endFraction "+e}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(t.map((function(i){return i.then((function(i){var o=n+ ++a/t.length*(r-n);return e(o),i})),i})))}function Rp(t,e){return s(this,void 0,void 0,(function(){var n,r,a,i,o,s,c,l,h;return u(this,(function(u){switch(u.label){case 0:return null==e&&(e={}),n=null==e.fetchFunc?d().platform.fetch:e.fetchFunc,r=t.map((function(t){return n(t,e.requestInit,{isBinary:!0})})),a=0,i=.5,null!=e.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=u.sent(),[3,4];case 2:return[4,Ap(r,e.onProgress,a,i)];case 3:o=u.sent(),u.label=4;case 4:return s=o.map((function(t){return t.arrayBuffer()})),c=.5,l=1,null!=e.onProgress?[3,6]:[4,Promise.all(s)];case 5:return h=u.sent(),[3,8];case 6:return[4,Ap(s,e.onProgress,c,l)];case 7:h=u.sent(),u.label=8;case 8:return[2,h]}}))}))}function jp(t){var e=this;return function(n,r,a){return void 0===r&&(r=""),s(e,void 0,void 0,(function(){var e,i,o,s,c,l,d,h,p,f;return u(this,(function(u){switch(u.label){case 0:if(e=n.map((function(){return!1})),i={},o=null!=a?a.map((function(){return!1})):[],s=[],n.forEach((function(t,n){var r=0;t.weights.forEach((function(t){var u="quantization"in t?t.quantization.dtype:t.dtype,c=Hh[u]*A(t.shape),l=function(){e[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:t,groupOffset:r,sizeBytes:c})};null!=a?a.forEach((function(e,n){e===t.name&&(l(),o[n]=!0)})):l(),s.push(t.name),r+=c}))})),!o.every((function(t){return t})))throw c=a.filter((function(t,e){return!o[e]})),new Error("Could not find weights in manifest with names: "+c.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return l=e.reduce((function(t,e,n){return e&&t.push(n),t}),[]),d=[],l.forEach((function(t){n[t].paths.forEach((function(t){var e=r+(r.endsWith("/")?"":"/")+t;d.push(e)}))})),[4,t(d)];case 1:return h=u.sent(),p={},f=0,l.forEach((function(t){for(var e=n[t].paths.length,r=0,a=0;a<e;a++)r+=h[f+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<e;c++){var l=new Uint8Array(h[f+c]);s.set(l,u),u+=l.byteLength}i[t].forEach((function(t){var e=Kh(o.slice(t.groupOffset,t.groupOffset+t.sizeBytes),[t.manifestEntry]);for(var n in e)p[n]=e[n]})),f+=e})),[2,p]}}))}))}}ep.registerSaveRouter((function(t){return d().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Np.URL_SCHEME)?function(t){return void 0===t&&(t="model"),new Np(t)}(t.slice(Np.URL_SCHEME.length)):null}));var Dp=function(){function t(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,null!=e.fetchFunc?(T("function"==typeof e.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=e.fetchFunc):this.fetch=d().platform.fetch,T(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&T(2===t.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."})),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a;return u(this,(function(i){switch(i.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:n},e.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,e)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:tp(t),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}}))}))},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r,a,i,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=u.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");u.label=2;case 2:return u.trys.push([2,4,,5]),[4,t.json()];case 3:return e=u.sent(),[3,5];case 4:throw u.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=e.modelTopology,a=e.weightsManifest,i=e.generatedBy,o=e.convertedBy,s=e.format,c=e.userDefinedMetadata,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:h=u.sent(),l=h[0],d=h[1],u.label=7;case 7:return[2,{modelTopology:r,weightSpecs:l,weightData:d,userDefinedMetadata:c,generatedBy:i,convertedBy:o,format:s}]}}))}))},t.prototype.loadWeights=function(t){return s(this,void 0,void 0,(function(){var e,n,r,a,i,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:for(e=Array.isArray(this.path)?this.path[1]:this.path,n=function(t){var e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}(e),r=n[0],a=n[1],i=this.weightPathPrefix||r,o=[],s=0,c=t;s<c.length;s++)l=c[s],o.push.apply(o,l.weights);return d=[],t.forEach((function(t){t.paths.forEach((function(t){d.push(i+t+a)}))})),[4,Rp(d,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return h=u.sent(),[2,[o,Zh(h)]]}}))}))},t.URL_SCHEME_REGEX=/^https?:\/\//,t}();function Fp(t){return null!=t.match(Dp.URL_SCHEME_REGEX)}var Mp=function(t,e){return"undefined"==typeof fetch?null:(Array.isArray(t)?t.every((function(t){return Fp(t)})):Fp(t))?Pp(t,{onProgress:e}):null};function Pp(t,e){return new Dp(t,e)}ep.registerSaveRouter(Mp),ep.registerLoadRouter(Mp);var $p,Lp=function(){function t(t){this.modelArtifacts=t}return t.prototype.load=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return[2,this.modelArtifacts]}))}))},t}(),Bp=function(){function t(t){this.saveHandler=t}return t.prototype.save=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){return[2,this.saveHandler(t)]}))}))},t}(),zp=Object.freeze({browserFiles:function(t){return new Ep(t)},browserHTTPRequest:function(t,e){return Pp(t,e)},concatenateArrayBuffers:Zh,decodeWeights:Kh,encodeWeights:function(t,e){return s(this,void 0,void 0,(function(){var n,r,a,i,o,c=this;return u(this,(function(l){switch(l.label){case 0:for(n=[],r=[],a=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t),i=function(i){var o=a[i],l=Array.isArray(t)?t[i].tensor:t[o];if("float32"!==l.dtype&&"int32"!==l.dtype&&"bool"!==l.dtype&&"string"!==l.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+l.dtype);var d={name:o,shape:l.shape,dtype:l.dtype};if("string"===l.dtype){var h=new Promise((function(t){return s(c,void 0,void 0,(function(){var e,n,r,a,i,o,s;return u(this,(function(u){switch(u.label){case 0:return[4,l.bytes()];case 1:for(e=u.sent(),n=e.reduce((function(t,e){return t+e.length}),0)+qh*e.length,r=new Uint8Array(n),a=0,i=0;i<e.length;i++)o=e[i],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,a),a+=qh,r.set(o,a),a+=o.length;return t(r),[2]}}))}))}));r.push(h)}else r.push(l.data());null!=e&&(d.group=e),n.push(d)},o=0;o<a.length;++o)i(o);return[4,Promise.all(r)];case 1:return[2,{data:Xh(l.sent()),specs:n}]}}))}))},fromMemory:function(t,e,n,r){return 1===arguments.length?null!=t.modelTopology||null!=t.weightSpecs?new Lp(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Lp({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Lp({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))},getLoadHandlers:function(t,e){return ep.getLoadHandlers(t,e)},getModelArtifactsInfoForJSON:tp,getSaveHandlers:function(t){return ep.getSaveHandlers(t)},http:Pp,isHTTPScheme:Fp,loadWeights:function(t,e,n,r){return void 0===e&&(e=""),s(this,void 0,void 0,(function(){return u(this,(function(a){return[2,jp((function(t){return Rp(t,{requestInit:r})}))(t,e,n)]}))}))},registerLoadRouter:function(t){return ep.registerLoadRouter(t)},registerSaveRouter:function(t){return ep.registerSaveRouter(t)},weightsLoaderFactory:jp,withSaveHandler:function(t){return new Bp(t)},copyModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,ip(t,e,!1)]}))}))},listModels:function(){return s(this,void 0,void 0,(function(){var t,e,n,r,a,i,o;return u(this,(function(s){switch(s.label){case 0:t=rp.getSchemes(),e={},n=0,r=t,s.label=1;case 1:return n<r.length?(a=r[n],[4,rp.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())e[a+np+o]=i[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},moveModel:function(t,e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return[2,ip(t,e,!0)]}))}))},removeModel:function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){return e=ap(t),[2,rp.getManager(e.scheme).removeModel(e.path)]}))}))}}),Wp=jn({confusionMatrix_:function(t,e,n){var r=wn(t,"labels","confusionMatrix"),a=wn(e,"predictions","confusionMatrix");T(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),T(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),T(1===a.rank,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),T(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),T(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=Nc(r.asType("int32"),n),o=Nc(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),Vp=Object.freeze({confusionMatrix:Wp}),Up=jn({fromPixels_:function(t,e){if(void 0===e&&(e=3),e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else{if(null==t.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);o=!0}if(a&&a&&t.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=m("FromPixels",Vt.backendName))return Vt.runKernel("FromPixels",{pixels:t},{numChannels:e});var s,u,c=a?[t.videoWidth,t.videoHeight]:[t.width,t.height],l=c[0],d=c[1];if(o?s=t.getContext("2d").getImageData(0,0,l,d).data:r||n?s=t.data:(i||a)&&(null==$p&&($p=document.createElement("canvas").getContext("2d")),$p.canvas.width=l,$p.canvas.height=d,$p.drawImage(t,0,0,l,d),s=$p.getImageData(0,0,l,d).data),4===e)u=new Int32Array(s);else{var h=l*d;u=new Int32Array(h*e);for(var p=0;p<h;p++)for(var f=0;f<e;++f)u[p*e+f]=s[4*p+f]}return Wn(u,[d,l,e],"int32")}}),Gp=Object.freeze({toPixels:function(t,e){return s(this,void 0,void 0,(function(){var n,r,a,i,o,s,c,l,d,h,p,f,m,g,b,y,v,x,w,k,S,O,_;return u(this,(function(u){switch(u.label){case 0:if(n=wn(t,"img","toPixels"),t instanceof Ct||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=u.sent(),c=n.min(),l=n.max(),[4,Promise.all([c.data(),l.data()])];case 2:if(d=u.sent(),h=d[0],p=d[1],f=h[0],m=p[0],c.dispose(),l.dispose(),"float32"===n.dtype){if(f<0||m>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+f+" - "+m+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(f<0||m>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+f+" - "+m+"].")}for(g="float32"===n.dtype?255:1,b=new Uint8ClampedArray(i*a*4),y=0;y<a*i;++y)v=void 0,x=void 0,w=void 0,k=void 0,1===o?(v=s[y]*g,x=s[y]*g,w=s[y]*g,k=255):3===o?(v=s[3*y]*g,x=s[3*y+1]*g,w=s[3*y+2]*g,k=255):4===o&&(v=s[4*y]*g,x=s[4*y+1]*g,w=s[4*y+2]*g,k=s[4*y+3]*g),b[0+(S=4*y)]=Math.round(v),b[S+1]=Math.round(x),b[S+2]=Math.round(w),b[S+3]=Math.round(k);return null!=e&&(e.width=i,e.height=a,O=e.getContext("2d"),_=new ImageData(b,i,a),O.putImageData(_,0,0)),n!==t&&n.dispose(),[2,b]}}))}))},fromPixels:Up}),Hp=function(){function t(){}return t.prototype.getClassName=function(){return this.constructor.className},t.fromConfig=function(t,e){return new t(e)},t}(),qp=function(){function t(){this.classNameMap={}}return t.getMap=function(){return null==t.instance&&(t.instance=new t),t.instance},t.register=function(e){t.getMap().classNameMap[e.className]=[e,e.fromConfig]},t}();function Kp(t){T(null!=t.className,(function(){return"Class being registered does not have the static className property defined."})),T("string"==typeof t.className,(function(){return"className is required to be a string, but got type "+typeof t.className})),T(t.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),qp.register(t)}var Xp=Object.freeze({Serializable:Hp,SerializationMap:qp,registerClass:Kp}),Yp="1.7.4",Jp=Object.freeze({gpgpu_util:Ns,webgl_util:Ke,forceHalfFloat:function(){d().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Gu,setWebGLContext:Jt,GPGPUContext:Es}),Zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.minimize=function(t,e,n){void 0===e&&(e=!1);var r=this.computeGradients(t,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(t){return{name:t.name,tensor:i[t.name]}}));this.applyGradients(o)}else this.applyGradients(i);return on(i),e?a:(a.dispose(),null)},Object.defineProperty(e.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),e.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},e.prototype.computeGradients=function(t,e){return si(t,e)},e.prototype.dispose=function(){null!=this.iterations_&&on(this.iterations_)},e.prototype.saveIterations=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Ln(this.iterations_,"int32")}]}))}))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},e.prototype.extractIterations=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return e=this,[4,t[0].tensor.data()];case 1:return e.iterations_=n.sent()[0],[2,t.slice(1)]}}))}))},e}(Hp);Object.defineProperty(Zp,Symbol.hasInstance,{value:function(t){return null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients}});var Qp=function(t){function e(e,n,r){void 0===r&&(r=null);var a=t.call(this)||this;return a.learningRate=e,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=Vt.backend.epsilon()),a}return o(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Vt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:an((function(){return Qn(a).variable(!1)}))}),null==e.accumulatedUpdates[r]&&(e.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:an((function(){return Qn(a).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable,s=e.accumulatedUpdates[r].variable;an((function(){var t=o.mul(e.rho).add(i.square().mul(1-e.rho)),n=s.add(e.epsilon).sqrt().div(o.add(e.epsilon).sqrt()).mul(i),r=s.mul(e.rho).add(n.square().mul(1-e.rho));o.assign(t),s.assign(r);var u=n.mul(-e.learningRate).add(a);a.assign(u)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedUpdates&&(on(this.accumulatedGrads.map((function(t){return t.variable}))),on(this.accumulatedUpdates.map((function(t){return t.variable}))))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=t.length/2,this.accumulatedGrads=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.rho,e.epsilon)},e.className="Adadelta",e}(Zp);Kp(Qp);var tf=function(t){function e(e,n){void 0===n&&(n=.1);var r=t.call(this)||this;return r.learningRate=e,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return o(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Vt.registeredVariables[n];null==e.accumulatedGrads[r]&&(e.accumulatedGrads[r]={originalName:n+"/accumulator",variable:an((function(){return Xn(a.shape,e.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedGrads[r].variable;an((function(){var t=o.add(i.square());o.assign(t);var n=i.div(t.add(Vt.backend.epsilon()).sqrt()).mul(-e.learningRate).add(a);a.assign(n)}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedGrads&&on(this.accumulatedGrads.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulatedGrads.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulatedGrads=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},e.fromConfig=function(t,e){return new t(e.learningRate,e.initialAccumulatorValue)},e.className="Adagrad",e}(Zp);Kp(tf);var ef=function(t){function e(e,n,r,a){void 0===a&&(a=null);var i=t.call(this)||this;return i.learningRate=e,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],an((function(){i.accBeta1=Ln(n).variable(),i.accBeta2=Ln(r).variable()})),null==a&&(i.epsilon=Vt.backend.epsilon()),i}return o(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);an((function(){var r=$a(1,e.accBeta1),a=$a(1,e.accBeta2);n.forEach((function(n,i){var o=Vt.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:n+"/m",variable:an((function(){return Qn(o).variable(!1)}))}),null==e.accumulatedSecondMoment[i]&&(e.accumulatedSecondMoment[i]={originalName:n+"/v",variable:an((function(){return Qn(o).variable(!1)}))});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedSecondMoment[i].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),d=c.mul(e.beta2).add(s.square().mul(1-e.beta2)),h=l.div(r),p=d.div(a);u.assign(l),c.assign(d);var f=h.div(p.sqrt().add(e.epsilon)).mul(-e.learningRate).add(o);o.assign(f)}})),e.accBeta1.assign(e.accBeta1.mul(e.beta1)),e.accBeta2.assign(e.accBeta2.mul(e.beta2))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&on(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedSecondMoment&&on(this.accumulatedSecondMoment.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e,n=this;return u(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(t)];case 1:return t=r.sent(),an((function(){n.accBeta1.assign(Fa(n.beta1,n.iterations_+1)),n.accBeta2.assign(Fa(n.beta2,n.iterations_+1))})),e=t.length/2,this.accumulatedFirstMoment=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon)},e.className="Adam",e}(Zp);Kp(ef);var nf=function(t){function e(e,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=t.call(this)||this;return o.learningRate=e,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],an((function(){o.iteration=Ln(0).variable(),o.accBeta1=Ln(n).variable()})),null==a&&(o.epsilon=Vt.backend.epsilon()),o}return o(e,t),e.prototype.applyGradients=function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t);an((function(){var r=$a(1,e.accBeta1),a=Ba(-e.learningRate,e.iteration.mul(e.decay).add(1));n.forEach((function(n,i){var o=Vt.registeredVariables[n];null==e.accumulatedFirstMoment[i]&&(e.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Qn(o).variable(!1)}),null==e.accumulatedWeightedInfNorm[i]&&(e.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:Qn(o).variable(!1)});var s=Array.isArray(t)?t[i].tensor:t[n];if(null!=s){var u=e.accumulatedFirstMoment[i].variable,c=e.accumulatedWeightedInfNorm[i].variable,l=u.mul(e.beta1).add(s.mul(1-e.beta1)),d=c.mul(e.beta2),h=s.abs(),p=d.maximum(h);u.assign(l),c.assign(p);var f=a.div(r).mul(l.div(p.add(e.epsilon))).add(o);o.assign(f)}})),e.iteration.assign(e.iteration.add(1)),e.accBeta1.assign(e.accBeta1.mul(e.beta1))})),this.incrementIterations()},e.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&on(this.accumulatedFirstMoment.map((function(t){return t.variable}))),null!=this.accumulatedWeightedInfNorm&&on(this.accumulatedWeightedInfNorm.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(t){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},e.fromConfig=function(t,e){return new t(e.learningRate,e.beta1,e.beta2,e.epsilon,e.decay)},e.className="Adamax",e}(Zp);Kp(nf);var rf=function(t){function e(e){var n=t.call(this)||this;return n.learningRate=e,n.setLearningRate(e),n}return o(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Array.isArray(t)?t[r].tensor:t[n];if(null!=a){var i=Vt.registeredVariables[n];an((function(){var t=e.c.mul(a).add(i);i.assign(t)}))}})),this.incrementIterations()},e.prototype.setLearningRate=function(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=sn(Ln(-t))},e.prototype.dispose=function(){this.c.dispose()},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()]]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:if(0!==(t=e.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate}},e.fromConfig=function(t,e){return new t(e.learningRate)},e.className="SGD",e}(Zp);Kp(rf);var af=function(t){function e(e,n,r){void 0===r&&(r=!1);var a=t.call(this,e)||this;return a.learningRate=e,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=Ln(a.momentum),a}return o(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Vt.registeredVariables[n];null==e.accumulations[r]&&(e.accumulations[r]={originalName:n+"/momentum",variable:an((function(){return Qn(a).variable(!1)}))});var i=e.accumulations[r].variable,o=Array.isArray(t)?t[r].tensor:t[n];null!=o&&an((function(){var t,n=e.m.mul(i).add(o);t=e.useNesterov?e.c.mul(o.add(n.mul(e.m))).add(a):e.c.mul(n).add(a),i.assign(n),a.assign(t)}))})),this.incrementIterations()},e.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&on(this.accumulations.map((function(t){return t.variable})))},e.prototype.setMomentum=function(t){this.momentum=t},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(this.accumulations.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,this.extractIterations(t)];case 1:return t=e.sent(),this.accumulations=t.map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},e.fromConfig=function(t,e){return new t(e.learningRate,e.momentum,e.useNesterov)},e.className="Momentum",e}(rf);Kp(af);var of=function(t){function e(e,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=t.call(this)||this;if(o.learningRate=e,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=Vt.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return o(e,t),e.prototype.applyGradients=function(t){var e=this;(Array.isArray(t)?t.map((function(t){return t.name})):Object.keys(t)).forEach((function(n,r){var a=Vt.registeredVariables[n];null==e.accumulatedMeanSquares[r]&&(e.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:an((function(){return Qn(a).variable(!1)}))}),null==e.accumulatedMoments[r]&&(e.accumulatedMoments[r]={originalName:n+"/momentum",variable:an((function(){return Qn(a).variable(!1)}))}),null==e.accumulatedMeanGrads[r]&&e.centered&&(e.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:an((function(){return Qn(a).variable(!1)}))});var i=Array.isArray(t)?t[r].tensor:t[n];if(null!=i){var o=e.accumulatedMeanSquares[r].variable,s=e.accumulatedMoments[r].variable;an((function(){var t=o.mul(e.decay).add(i.square().mul(1-e.decay));if(e.centered){var n=e.accumulatedMeanGrads[r].variable,u=n.mul(e.decay).add(i.mul(1-e.decay)),c=s.mul(e.momentum).add(i.mul(e.learningRate).div(t.sub(u.square().add(e.epsilon)).sqrt()));o.assign(t),n.assign(u),s.assign(c);var l=a.sub(c);a.assign(l)}else{var d=o.mul(e.decay).add(i.square().mul(1-e.decay));c=s.mul(e.momentum).add(i.mul(e.learningRate).div(d.add(e.epsilon).sqrt())),o.assign(d),s.assign(c),l=a.sub(c),a.assign(l)}}))}})),this.incrementIterations()},e.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&on(this.accumulatedMeanSquares.map((function(t){return t.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&on(this.accumulatedMeanGrads.map((function(t){return t.variable}))),null!=this.accumulatedMoments&&on(this.accumulatedMoments.map((function(t){return t.variable})))},e.prototype.getWeights=function(){return s(this,void 0,void 0,(function(){var t;return u(this,(function(e){switch(e.label){case 0:return t=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&t.push.apply(t,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(t.map((function(t){return{name:t.originalName,tensor:t.variable}})))]}}))}))},e.prototype.setWeights=function(t){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(t)];case 1:return t=n.sent(),e=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(e,2*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map((function(t){return{originalName:t.name,variable:t.tensor.variable(!1)}}))),[2]}}))}))},e.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},e.fromConfig=function(t,e){return new t(e.learningRate,e.decay,e.momentum,e.epsilon,e.centered)},e.className="RMSProp",e}(Zp);Kp(of);var sf=function(){function t(){}return t.sgd=function(t){return new rf(t)},t.momentum=function(t,e,n){return void 0===n&&(n=!1),new af(t,e,n)},t.rmsprop=function(t,e,n,r,a){return void 0===e&&(e=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new of(t,e,n,r,a)},t.adam=function(t,e,n,r){return void 0===t&&(t=.001),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new ef(t,e,n,r)},t.adadelta=function(t,e,n){return void 0===t&&(t=.001),void 0===e&&(e=.95),void 0===n&&(n=null),new Qp(t,e,n)},t.adamax=function(t,e,n,r,a){return void 0===t&&(t=.002),void 0===e&&(e=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new nf(t,e,n,r,a)},t.adagrad=function(t,e){return void 0===e&&(e=.1),new tf(t,e)},t}(),uf={sgd:sf.sgd,momentum:sf.momentum,adadelta:sf.adadelta,adagrad:sf.adagrad,rmsprop:sf.rmsprop,adamax:sf.adamax,adam:sf.adam},cf="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(t){return t()};function lf(){return new Promise((function(t){return cf((function(){return t()}))}))}Ct.prototype.add=function(t){return Lr(this,t)},Ct.prototype.broadcastTo=function(t){return bc(this,t)},Ct.prototype.div=function(t){return Ba(this,t)},Ct.prototype.divNoNan=function(t){return _c(this,t)},Ct.prototype.squaredDifference=function(t){return Xc(this,t)},Ct.prototype.tile=function(t){return Cc(this,t)},Ct.prototype.oneHot=function(t,e,n){return void 0===e&&(e=1),void 0===n&&(n=0),Nc(this,t,e,n)},Ct.prototype.transpose=function(t){return hi(this,t)},Ct.prototype.pad=function(t,e){return Ec(this,t,e)},Ct.prototype.batchNorm=function(t,e,n,r,a){return sc(this,t,e,n,r,a)},Ot=gh}.call(this,n("c8ba"),n("4362"),n("b639").Buffer)},"461e":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HSV=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n,r,a,i,o=t.data,s=o.length,u=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,d=u*c*Math.cos(l*Math.PI/180),h=u*c*Math.sin(l*Math.PI/180),p=.299*u+.701*d+.167*h,f=.587*u-.587*d+.33*h,m=.114*u-.114*d-.497*h,g=.299*u-.299*d-.328*h,b=.587*u+.413*d+.035*h,y=.114*u-.114*d+.293*h,v=.299*u-.3*d+1.25*h,x=.587*u-.586*d-1.05*h,w=.114*u+.886*d-.2*h;for(e=0;e<s;e+=4)n=o[e+0],r=o[e+1],a=o[e+2],i=o[e+3],o[e+0]=p*n+f*r+m*a,o[e+1]=g*n+b*r+y*a,o[e+2]=v*n+x*r+w*a,o[e+3]=i};e.HSV=o,r.Factory.addGetterSetter(a.Node,"hue",0,i.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"saturation",0,i.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"value",0,i.getNumberValidator(),r.Factory.afterSetFilter)},4681:function(t,e,n){"use strict";var r=n("966d");function a(t,e){var n=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,r.nextTick(o,this,t)):r.nextTick(o,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted||(n._writableState.errorEmitted=!0,r.nextTick(o,n,t)):r.nextTick(o,n,t):e&&e(t)})),this)}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(t,e){t.emit("error",e)}t.exports={destroy:a,undestroy:i}},"469c":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","lessEqual","string_or_numeric"),u=Object(o["a"])(e,"b","lessEqual","string_or_numeric");[n,u]=Object(i["makeTypesMatch"])(n,u),Object(s["assertAndGetBroadcastShape"])(n.shape,u.shape);const c={a:n,b:u};return r["a"].runKernel(a["Cb"],c)}const l=Object(u["b"])({lessEqual_:c})},"46bc":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"maxValue",max:t},(function(e){return!(0,r.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e<=+t}))};e.default=a},4705:function(t,e,n){"use strict";(function(t,r){
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
let a;function i(){if(null==a){let e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof t)e=t;else if("undefined"!==typeof r)e=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}a=e}return a}function o(){const t=i();return null==t._tfGlobals&&(t._tfGlobals=new Map),t._tfGlobals}function s(t,e){const n=o();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}))}).call(this,n("c8ba"),n("4362"))},"476e":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UV_COORDS=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]]},"47f5":function(t,e,n){var r=n("2b03"),a=n("d9a8"),i=n("099a");function o(t,e,n){return e===e?i(t,e,n):r(t,a,n)}t.exports=o},"483a":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},"48a0":function(t,e,n){var r=n("242e"),a=n("950a"),i=a(r);t.exports=i},4971:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Node=e._removeName=e._addName=e._removeId=e.names=e.ids=void 0;var r=n("9cb8"),a=n("f0b4"),i=n("f655"),o=n("d777"),s=n("df93"),u=n("4546");e.ids={},e.names={};var c=function(t,n){n&&(e.ids[n]=t)},l=function(t,n){t&&e.ids[t]===n&&delete e.ids[t]};e._removeId=l;var d=function(t,n){n&&(e.names[n]||(e.names[n]=[]),e.names[n].push(t))};e._addName=d;var h=function(t,n){if(t){var r=e.names[t];if(r){for(var a=0;a<r.length;a++){var i=r[a];i._id===n&&r.splice(a,1)}0===r.length&&delete e.names[t]}}};e._removeName=h;var p="absoluteOpacity",f="allEventListeners",m="absoluteTransform",g="absoluteScale",b="canvas",y="Change",v="children",x="konva",w="listening",k="mouseenter",S="mouseleave",O="name",_="set",C="Shape",T=" ",I="stage",N="transform",E="Stage",A="visible",R=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(T),j=(["scaleXChange.konva","scaleYChange.konva"].join(T),new r.Collection),D=1,F=function(){function t(t){this._id=D++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this.children=j,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}return t.prototype.hasChildren=function(){return!1},t.prototype.getChildren=function(){return j},t.prototype._clearCache=function(t){t!==N&&t!==m||!this._cache.get(t)?t?this._cache.delete(t):this._cache.clear():this._cache.get(t).dirty=!0},t.prototype._getCache=function(t,e){var n=this._cache.get(t),r=t===N||t===m,a=void 0===n||r&&!0===n.dirty;return a&&(n=e.call(this),this._cache.set(t,n)),n},t.prototype._calculate=function(t,e,n){var r=this;if(!this._attachedDepsListeners.get(t)){var a=e.map((function(t){return t+"Change.konva"})).join(T);this.on(a,(function(){r._clearCache(t)})),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,n)},t.prototype._getCanvasCache=function(){return this._cache.get(b)},t.prototype._clearSelfAndDescendantCache=function(t,e){this._clearCache(t),e&&t===m&&this.fire("_clearTransformCache"),this.isCached()||this.children&&this.children.each((function(e){e._clearSelfAndDescendantCache(t,!0)}))},t.prototype.clearCache=function(){return this._cache.delete(b),this._clearSelfAndDescendantCache(),this},t.prototype.cache=function(t){var e=t||{},n={};void 0!==e.x&&void 0!==e.y&&void 0!==e.width&&void 0!==e.height||(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var a=Math.ceil(e.width||n.width),o=Math.ceil(e.height||n.height),s=e.pixelRatio,u=void 0===e.x?n.x:e.x,c=void 0===e.y?n.y:e.y,l=e.offset||0,d=e.drawBorder||!1;if(a&&o){a+=2*l,o+=2*l,u-=l,c-=l;var h=new i.SceneCanvas({pixelRatio:s,width:a,height:o}),f=new i.SceneCanvas({pixelRatio:s,width:0,height:0}),m=new i.HitCanvas({pixelRatio:1,width:a,height:o}),y=h.getContext(),v=m.getContext();return m.isCache=!0,h.isCache=!0,this._cache.delete("canvas"),this._filterUpToDate=!1,!1===e.imageSmoothingEnabled&&(h.getContext()._context.imageSmoothingEnabled=!1,f.getContext()._context.imageSmoothingEnabled=!1),y.save(),v.save(),y.translate(-u,-c),v.translate(-u,-c),this._isUnderCache=!0,this._clearSelfAndDescendantCache(p),this._clearSelfAndDescendantCache(g),this.drawScene(h,this),this.drawHit(m,this),this._isUnderCache=!1,y.restore(),v.restore(),d&&(y.save(),y.beginPath(),y.rect(0,0,a,o),y.closePath(),y.setAttr("strokeStyle","red"),y.setAttr("lineWidth",5),y.stroke(),y.restore()),this._cache.set(b,{scene:h,filter:f,hit:m,x:u,y:c}),this}r.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")},t.prototype.isCached=function(){return this._cache.has("canvas")},t.prototype.getClientRect=function(t){throw new Error('abstract "getClientRect" method call')},t.prototype._transformedRect=function(t,e){var n,r,a,i,o=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],s=this.getAbsoluteTransform(e);return o.forEach((function(t){var e=s.point(t);void 0===n&&(n=a=e.x,r=i=e.y),n=Math.min(n,e.x),r=Math.min(r,e.y),a=Math.max(a,e.x),i=Math.max(i,e.y)})),{x:n,y:r,width:a-n,height:i-r}},t.prototype._drawCachedSceneCanvas=function(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);var e=this._getCanvasCache();t.translate(e.x,e.y);var n=this._getCachedSceneCanvas(),r=n.pixelRatio;t.drawImage(n._canvas,0,0,n.width/r,n.height/r),t.restore()},t.prototype._drawCachedHitCanvas=function(t){var e=this._getCanvasCache(),n=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(n._canvas,0,0),t.restore()},t.prototype._getCachedSceneCanvas=function(){var t,e,n,a,i=this.filters(),o=this._getCanvasCache(),s=o.scene,u=o.filter,c=u.getContext();if(i){if(!this._filterUpToDate){var l=s.pixelRatio;u.setSize(s.width/s.pixelRatio,s.height/s.pixelRatio);try{for(t=i.length,c.clear(),c.drawImage(s._canvas,0,0,s.getWidth()/l,s.getHeight()/l),e=c.getImageData(0,0,u.getWidth(),u.getHeight()),n=0;n<t;n++)a=i[n],"function"===typeof a?(a.call(this,e),c.putImageData(e,0,0)):r.Util.error("Filter should be type of function, but got "+typeof a+" instead. Please check correct filters")}catch(d){r.Util.error("Unable to apply filter. "+d.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return u}return s},t.prototype.on=function(t,e){if(this._cache&&this._cache.delete(f),3===arguments.length)return this._delegate.apply(this,arguments);var n,r,a,i,o,s=t.split(T),u=s.length;for(n=0;n<u;n++)r=s[n],a=r.split("."),i=a[0],o=a[1]||"",this.eventListeners[i]||(this.eventListeners[i]=[]),this.eventListeners[i].push({name:o,handler:e});return this},t.prototype.off=function(t,e){var n,r,a,i,o,s,u=(t||"").split(T),c=u.length;if(this._cache&&this._cache.delete(f),!t)for(r in this.eventListeners)this._off(r);for(n=0;n<c;n++)if(a=u[n],i=a.split("."),o=i[0],s=i[1],o)this.eventListeners[o]&&this._off(o,s,e);else for(r in this.eventListeners)this._off(r,s,e);return this},t.prototype.dispatchEvent=function(t){var e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this},t.prototype.addEventListener=function(t,e){return this.on(t,(function(t){e.call(this,t.evt)})),this},t.prototype.removeEventListener=function(t){return this.off(t),this},t.prototype._delegate=function(t,e,n){var a=this;this.on(t,(function(t){for(var i=t.target.findAncestors(e,!0,a),o=0;o<i.length;o++)t=r.Util.cloneObject(t),t.currentTarget=i[o],n.call(i[o],t)}))},t.prototype.remove=function(){return this.isDragging()&&this.stopDrag(),s.DD._dragElements.delete(this._id),this._remove(),this},t.prototype._clearCaches=function(){this._clearSelfAndDescendantCache(m),this._clearSelfAndDescendantCache(p),this._clearSelfAndDescendantCache(g),this._clearSelfAndDescendantCache(I),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(w)},t.prototype._remove=function(){this._clearCaches();var t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)},t.prototype.destroy=function(){e._removeId(this.id(),this);for(var t=(this.name()||"").split(/\s/g),n=0;n<t.length;n++){var r=t[n];e._removeName(r,this._id)}return this.remove(),this},t.prototype.getAttr=function(t){var e="get"+r.Util._capitalize(t);return r.Util._isFunction(this[e])?this[e]():this.attrs[t]},t.prototype.getAncestors=function(){var t=this.getParent(),e=new r.Collection;while(t)e.push(t),t=t.getParent();return e},t.prototype.getAttrs=function(){return this.attrs||{}},t.prototype.setAttrs=function(t){var e=this;return this._batchTransformChanges((function(){var n,a;if(!t)return e;for(n in t)n!==v&&(a=_+r.Util._capitalize(n),r.Util._isFunction(e[a])?e[a](t[n]):e._setAttr(n,t[n]))})),this},t.prototype.isListening=function(){return this._getCache(w,this._isListening)},t.prototype._isListening=function(t){var e=this.listening();if(!e)return!1;var n=this.getParent();return!n||n===t||this===t||n._isListening(t)},t.prototype.isVisible=function(){return this._getCache(A,this._isVisible)},t.prototype._isVisible=function(t){var e=this.visible();if(!e)return!1;var n=this.getParent();return!n||n===t||this===t||n._isVisible(t)},t.prototype.shouldDrawHit=function(t,e){if(void 0===e&&(e=!1),t)return this._isVisible(t)&&this._isListening(t);var n=this.getLayer(),r=!1;s.DD._dragElements.forEach((function(t){"dragging"===t.dragStatus&&("Stage"===t.node.nodeType||t.node.getLayer()===n)&&(r=!0)}));var a=!e&&!o.Konva.hitOnDragEnabled&&r;return this.isListening()&&this.isVisible()&&!a},t.prototype.show=function(){return this.visible(!0),this},t.prototype.hide=function(){return this.visible(!1),this},t.prototype.getZIndex=function(){return this.index||0},t.prototype.getAbsoluteZIndex=function(){var t,e,n,r,a=this.getDepth(),i=this,o=0;function s(u){for(t=[],e=u.length,n=0;n<e;n++)r=u[n],o++,r.nodeType!==C&&(t=t.concat(r.getChildren().toArray())),r._id===i._id&&(n=e);t.length>0&&t[0].getDepth()<=a&&s(t)}return i.nodeType!==E&&s(i.getStage().getChildren()),o},t.prototype.getDepth=function(){var t=0,e=this.parent;while(e)t++,e=e.parent;return t},t.prototype._batchTransformChanges=function(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(N),this._clearSelfAndDescendantCache(m,!0)),this._needClearTransformCache=!1},t.prototype.setPosition=function(t){var e=this;return this._batchTransformChanges((function(){e.x(t.x),e.y(t.y)})),this},t.prototype.getPosition=function(){return{x:this.x(),y:this.y()}},t.prototype.getAbsolutePosition=function(t){var e=!1,n=this.parent;while(n){if(n.isCached()){e=!0;break}n=n.parent}e&&!t&&(t=!0);var a=this.getAbsoluteTransform(t).getMatrix(),i=new r.Transform,o=this.offset();return i.m=a.slice(),i.translate(o.x,o.y),i.getTranslation()},t.prototype.setAbsolutePosition=function(t){var e=this._clearTransform();this.attrs.x=e.x,this.attrs.y=e.y,delete e.x,delete e.y,this._clearCache(N);var n=this._getAbsoluteTransform().copy();return n.invert(),n.translate(t.x,t.y),t={x:this.attrs.x+n.getTranslation().x,y:this.attrs.y+n.getTranslation().y},this._setTransform(e),this.setPosition({x:t.x,y:t.y}),this._clearCache(N),this._clearSelfAndDescendantCache(m),this},t.prototype._setTransform=function(t){var e;for(e in t)this.attrs[e]=t[e]},t.prototype._clearTransform=function(){var t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t},t.prototype.move=function(t){var e=t.x,n=t.y,r=this.x(),a=this.y();return void 0!==e&&(r+=e),void 0!==n&&(a+=n),this.setPosition({x:r,y:a}),this},t.prototype._eachAncestorReverse=function(t,e){var n,r,a=[],i=this.getParent();if(!e||e._id!==this._id){a.unshift(this);while(i&&(!e||i._id!==e._id))a.unshift(i),i=i.parent;for(n=a.length,r=0;r<n;r++)t(a[r])}},t.prototype.rotate=function(t){return this.rotation(this.rotation()+t),this},t.prototype.moveToTop=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var t=this.index;return this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},t.prototype.moveUp=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveUp function is ignored."),!1;var t=this.index,e=this.parent.getChildren().length;return t<e-1&&(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveDown=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveDown function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0)},t.prototype.moveToBottom=function(){if(!this.parent)return r.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var t=this.index;return t>0&&(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)},t.prototype.setZIndex=function(t){if(!this.parent)return r.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&r.Util.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this},t.prototype.getAbsoluteOpacity=function(){return this._getCache(p,this._getAbsoluteOpacity)},t.prototype._getAbsoluteOpacity=function(){var t=this.opacity(),e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t},t.prototype.moveTo=function(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this},t.prototype.toObject=function(){var t,e,n,a,i,o={},s=this.getAttrs();for(t in o.attrs={},s)e=s[t],i=r.Util.isObject(e)&&!r.Util._isPlainObject(e)&&!r.Util._isArray(e),i||(n="function"===typeof this[t]&&this[t],delete s[t],a=n?n.call(this):null,s[t]=e,a!==e&&(o.attrs[t]=e));return o.className=this.getClassName(),r.Util._prepareToStringify(o)},t.prototype.toJSON=function(){return JSON.stringify(this.toObject())},t.prototype.getParent=function(){return this.parent},t.prototype.findAncestors=function(t,e,n){var r=[];e&&this._isMatch(t)&&r.push(this);var a=this.parent;while(a){if(a===n)return r;a._isMatch(t)&&r.push(a),a=a.parent}return r},t.prototype.isAncestorOf=function(t){return!1},t.prototype.findAncestor=function(t,e,n){return this.findAncestors(t,e,n)[0]},t.prototype._isMatch=function(t){if(!t)return!1;if("function"===typeof t)return t(this);var e,n,a=t.replace(/ /g,"").split(","),i=a.length;for(e=0;e<i;e++)if(n=a[e],r.Util.isValidSelector(n)||(r.Util.warn('Selector "'+n+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),r.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),r.Util.warn("Konva is awesome, right?")),"#"===n.charAt(0)){if(this.id()===n.slice(1))return!0}else if("."===n.charAt(0)){if(this.hasName(n.slice(1)))return!0}else if(this.className===n||this.nodeType===n)return!0;return!1},t.prototype.getLayer=function(){var t=this.getParent();return t?t.getLayer():null},t.prototype.getStage=function(){return this._getCache(I,this._getStage)},t.prototype._getStage=function(){var t=this.getParent();return t?t.getStage():void 0},t.prototype.fire=function(t,e,n){return void 0===e&&(e={}),e.target=e.target||this,n?this._fireAndBubble(t,e):this._fire(t,e),this},t.prototype.getAbsoluteTransform=function(t){return t?this._getAbsoluteTransform(t):this._getCache(m,this._getAbsoluteTransform)},t.prototype._getAbsoluteTransform=function(t){var e;if(t)return e=new r.Transform,this._eachAncestorReverse((function(t){var n=t.transformsEnabled();"all"===n?e.multiply(t.getTransform()):"position"===n&&e.translate(t.x()-t.offsetX(),t.y()-t.offsetY())}),t),e;e=this._cache.get(m)||new r.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();var n=this.transformsEnabled();if("all"===n)e.multiply(this.getTransform());else if("position"===n){var a=this.attrs.x||0,i=this.attrs.y||0,o=this.attrs.offsetX||0,s=this.attrs.offsetY||0;e.translate(a-o,i-s)}return e.dirty=!1,e},t.prototype.getAbsoluteScale=function(t){var e=this;while(e)e._isUnderCache&&(t=e),e=e.getParent();var n=this.getAbsoluteTransform(t),r=n.decompose();return{x:r.scaleX,y:r.scaleY}},t.prototype.getAbsoluteRotation=function(){return this.getAbsoluteTransform().decompose().rotation},t.prototype.getTransform=function(){return this._getCache(N,this._getTransform)},t.prototype._getTransform=function(){var t,e,n=this._cache.get(N)||new r.Transform;n.reset();var a=this.x(),i=this.y(),s=o.Konva.getAngle(this.rotation()),u=null!==(t=this.attrs.scaleX)&&void 0!==t?t:1,c=null!==(e=this.attrs.scaleY)&&void 0!==e?e:1,l=this.attrs.skewX||0,d=this.attrs.skewY||0,h=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return 0===a&&0===i||n.translate(a,i),0!==s&&n.rotate(s),0===l&&0===d||n.skew(l,d),1===u&&1===c||n.scale(u,c),0===h&&0===p||n.translate(-1*h,-1*p),n.dirty=!1,n},t.prototype.clone=function(t){var e,n,a,i,o,s=r.Util.cloneObject(this.attrs);for(e in t)s[e]=t[e];var u=new this.constructor(s);for(e in this.eventListeners)for(n=this.eventListeners[e],a=n.length,i=0;i<a;i++)o=n[i],o.name.indexOf(x)<0&&(u.eventListeners[e]||(u.eventListeners[e]=[]),u.eventListeners[e].push(o));return u},t.prototype._toKonvaCanvas=function(t){t=t||{};var e=this.getClientRect(),n=this.getStage(),r=void 0!==t.x?t.x:e.x,a=void 0!==t.y?t.y:e.y,o=t.pixelRatio||1,s=new i.SceneCanvas({width:t.width||e.width||(n?n.width():0),height:t.height||e.height||(n?n.height():0),pixelRatio:o}),u=s.getContext();return u.save(),(r||a)&&u.translate(-1*r,-1*a),this.drawScene(s),u.restore(),s},t.prototype.toCanvas=function(t){return this._toKonvaCanvas(t)._canvas},t.prototype.toDataURL=function(t){t=t||{};var e=t.mimeType||null,n=t.quality||null,r=this._toKonvaCanvas(t).toDataURL(e,n);return t.callback&&t.callback(r),r},t.prototype.toImage=function(t){if(!t||!t.callback)throw"callback required for toImage method config argument";var e=t.callback;delete t.callback,r.Util._urlToImage(this.toDataURL(t),(function(t){e(t)}))},t.prototype.setSize=function(t){return this.width(t.width),this.height(t.height),this},t.prototype.getSize=function(){return{width:this.width(),height:this.height()}},t.prototype.getClassName=function(){return this.className||this.nodeType},t.prototype.getType=function(){return this.nodeType},t.prototype.getDragDistance=function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():o.Konva.dragDistance},t.prototype._off=function(t,e,n){var r,a,i,o=this.eventListeners[t];for(r=0;r<o.length;r++)if(a=o[r].name,i=o[r].handler,("konva"!==a||"konva"===e)&&(!e||a===e)&&(!n||n===i)){if(o.splice(r,1),0===o.length){delete this.eventListeners[t];break}r--}},t.prototype._fireChangeEvent=function(t,e,n){this._fire(t+y,{oldVal:e,newVal:n})},t.prototype.setId=function(t){var n=this.id();return e._removeId(n,this),c(this,t),this._setAttr("id",t),this},t.prototype.setName=function(t){var n,r,a=(this.name()||"").split(/\s/g),i=(t||"").split(/\s/g);for(r=0;r<a.length;r++)n=a[r],-1===i.indexOf(n)&&n&&e._removeName(n,this._id);for(r=0;r<i.length;r++)n=i[r],-1===a.indexOf(n)&&n&&e._addName(this,n);return this._setAttr(O,t),this},t.prototype.addName=function(t){if(!this.hasName(t)){var e=this.name(),n=e?e+" "+t:t;this.setName(n)}return this},t.prototype.hasName=function(t){if(!t)return!1;var e=this.name();if(!e)return!1;var n=(e||"").split(/\s/g);return-1!==n.indexOf(t)},t.prototype.removeName=function(t){var e=(this.name()||"").split(/\s/g),n=e.indexOf(t);return-1!==n&&(e.splice(n,1),this.setName(e.join(" "))),this},t.prototype.setAttr=function(t,e){var n=this[_+r.Util._capitalize(t)];return r.Util._isFunction(n)?n.call(this,e):this._setAttr(t,e),this},t.prototype._setAttr=function(t,e,n){void 0===n&&(n=!1);var a=this.attrs[t];(a!==e||r.Util.isObject(e))&&(void 0===e||null===e?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,a,e))},t.prototype._setComponentAttr=function(t,e,n){var r;void 0!==n&&(r=this.attrs[t],r||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=n,this._fireChangeEvent(t,r,n))},t.prototype._fireAndBubble=function(t,e,n){e&&this.nodeType===C&&(e.target=this);var r=(t===k||t===S)&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||"Stage"===this.nodeType&&!n);if(!r){this._fire(t,e);var a=(t===k||t===S)&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!a&&(n&&n.parent?this._fireAndBubble.call(this.parent,t,e,n):this._fireAndBubble.call(this.parent,t,e))}},t.prototype._getProtoListeners=function(t){var e=this._cache.get(f);if(!e){e={};var n=Object.getPrototypeOf(this);while(n)if(n.eventListeners){for(var r in n.eventListeners){var a=n.eventListeners[r],i=e[r]||[];e[r]=a.concat(i)}n=Object.getPrototypeOf(n)}else n=Object.getPrototypeOf(n);this._cache.set(f,e)}return e[t]},t.prototype._fire=function(t,e){e=e||{},e.currentTarget=this,e.type=t;var n=this._getProtoListeners(t);if(n)for(var r=0;r<n.length;r++)n[r].handler.call(this,e);var a=this.eventListeners[t];if(a)for(r=0;r<a.length;r++)a[r].handler.call(this,e)},t.prototype.draw=function(){return this.drawScene(),this.drawHit(),this},t.prototype._createDragElement=function(t){var e=t?t.pointerId:void 0,n=this.getStage(),r=this.getAbsolutePosition(),a=n._getPointerById(e)||n._changedPointerPositions[0]||r;s.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-r.x,y:a.y-r.y},dragStatus:"ready",pointerId:e})},t.prototype.startDrag=function(t,e){void 0===e&&(e=!0),s.DD._dragElements.has(this._id)||this._createDragElement(t);var n=s.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)},t.prototype._setDragPosition=function(t,e){var n=this.getStage()._getPointerById(e.pointerId);if(n){var a={x:n.x-e.offset.x,y:n.y-e.offset.y},i=this.dragBoundFunc();if(void 0!==i){var o=i.call(this,a,t);o?a=o:r.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===a.x&&this._lastPos.y===a.y||(this.setAbsolutePosition(a),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=a}},t.prototype.stopDrag=function(t){var e=s.DD._dragElements.get(this._id);e&&(e.dragStatus="stopped"),s.DD._endDragBefore(t),s.DD._endDragAfter(t)},t.prototype.setDraggable=function(t){this._setAttr("draggable",t),this._dragChange()},t.prototype.isDragging=function(){var t=s.DD._dragElements.get(this._id);return!!t&&"dragging"===t.dragStatus},t.prototype._listenDrag=function(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",(function(t){var e=this,n=void 0!==t.evt["button"],r=!n||o.Konva.dragButtons.indexOf(t.evt["button"])>=0;if(r&&!this.isDragging()){var a=!1;s.DD._dragElements.forEach((function(t){e.isAncestorOf(t.node)&&(a=!0)})),a||this._createDragElement(t)}}))},t.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var t=this.getStage();if(!t)return;var e=s.DD._dragElements.get(this._id),n=e&&"dragging"===e.dragStatus,r=e&&"ready"===e.dragStatus;n?this.stopDrag():r&&s.DD._dragElements.delete(this._id)}},t.prototype._dragCleanup=function(){this.off("mousedown.konva"),this.off("touchstart.konva")},t.create=function(t,e){return r.Util._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)},t._createNode=function(e,n){var a,i,s,u=t.prototype.getClassName.call(e),c=e.children;n&&(e.attrs.container=n),o._NODES_REGISTRY[u]||(r.Util.warn('Can not find a node with class name "'+u+'". Fallback to "Shape".'),u="Shape");var l=o._NODES_REGISTRY[u];if(a=new l(e.attrs),c)for(i=c.length,s=0;s<i;s++)a.add(t._createNode(c[s]));return a},t}();e.Node=F,F.prototype.nodeType="Node",F.prototype._attrsAffectingSize=[],F.prototype.eventListeners={},F.prototype.on.call(F.prototype,R,(function(){this._batchingTransformChange?this._needClearTransformCache=!0:(this._clearCache(N),this._clearSelfAndDescendantCache(m))})),F.prototype.on.call(F.prototype,"visibleChange.konva",(function(){this._clearSelfAndDescendantCache(A)})),F.prototype.on.call(F.prototype,"listeningChange.konva",(function(){this._clearSelfAndDescendantCache(w)})),F.prototype.on.call(F.prototype,"opacityChange.konva",(function(){this._clearSelfAndDescendantCache(p)}));var M=a.Factory.addGetterSetter;M(F,"zIndex"),M(F,"absolutePosition"),M(F,"position"),M(F,"x",0,u.getNumberValidator()),M(F,"y",0,u.getNumberValidator()),M(F,"globalCompositeOperation","source-over",u.getStringValidator()),M(F,"opacity",1,u.getNumberValidator()),M(F,"name","",u.getStringValidator()),M(F,"id","",u.getStringValidator()),M(F,"rotation",0,u.getNumberValidator()),a.Factory.addComponentsGetterSetter(F,"scale",["x","y"]),M(F,"scaleX",1,u.getNumberValidator()),M(F,"scaleY",1,u.getNumberValidator()),a.Factory.addComponentsGetterSetter(F,"skew",["x","y"]),M(F,"skewX",0,u.getNumberValidator()),M(F,"skewY",0,u.getNumberValidator()),a.Factory.addComponentsGetterSetter(F,"offset",["x","y"]),M(F,"offsetX",0,u.getNumberValidator()),M(F,"offsetY",0,u.getNumberValidator()),M(F,"dragDistance",null,u.getNumberValidator()),M(F,"width",0,u.getNumberValidator()),M(F,"height",0,u.getNumberValidator()),M(F,"listening",!0,u.getBooleanValidator()),M(F,"preventDefault",!0,u.getBooleanValidator()),M(F,"filters",null,(function(t){return this._filterUpToDate=!1,t})),M(F,"visible",!0,u.getBooleanValidator()),M(F,"transformsEnabled","all",u.getStringValidator()),M(F,"size"),M(F,"dragBoundFunc"),M(F,"draggable",!1,u.getBooleanValidator()),a.Factory.backCompat(F,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),r.Collection.mapMethods(F)},"4971b":function(t,e,n){(function(e,r){t.exports=r(n("2b0e"))})("undefined"!==typeof self&&self,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"091b":function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,".vue-slider-dot{position:absolute;-webkit-transition:all 0s;transition:all 0s;z-index:5}.vue-slider-dot:focus{outline:none}.vue-slider-dot-tooltip{position:absolute;visibility:hidden}.vue-slider-dot-hover:hover .vue-slider-dot-tooltip,.vue-slider-dot-tooltip-show{visibility:visible}.vue-slider-dot-tooltip-top{top:-10px;left:50%;-webkit-transform:translate(-50%,-100%);transform:translate(-50%,-100%)}.vue-slider-dot-tooltip-bottom{bottom:-10px;left:50%;-webkit-transform:translate(-50%,100%);transform:translate(-50%,100%)}.vue-slider-dot-tooltip-left{left:-10px;top:50%;-webkit-transform:translate(-100%,-50%);transform:translate(-100%,-50%)}.vue-slider-dot-tooltip-right{right:-10px;top:50%;-webkit-transform:translate(100%,-50%);transform:translate(100%,-50%)}",""]),t.exports=e},"24fb":function(t,e,n){"use strict";function r(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"===typeof btoa){var i=a(r),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}function a(t){var e=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(e);return"/*# ".concat(n," */")}t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=r(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"===typeof t&&(t=[[null,t,""]]);var a={};if(r)for(var i=0;i<this.length;i++){var o=this[i][0];null!=o&&(a[o]=!0)}for(var s=0;s<t.length;s++){var u=[].concat(t[s]);r&&a[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),e.push(u))}},e}},2638:function(t,e,n){"use strict";function r(){return r=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var r in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},r.apply(this,arguments)}var a=["attrs","props","domProps"],i=["class","style","directives"],o=["on","nativeOn"],s=function(t){return t.reduce((function(t,e){for(var n in e)if(t[n])if(-1!==a.indexOf(n))t[n]=r({},t[n],e[n]);else if(-1!==i.indexOf(n)){var s=t[n]instanceof Array?t[n]:[t[n]],c=e[n]instanceof Array?e[n]:[e[n]];t[n]=s.concat(c)}else if(-1!==o.indexOf(n))for(var l in e[n])if(t[n][l]){var d=t[n][l]instanceof Array?t[n][l]:[t[n][l]],h=e[n][l]instanceof Array?e[n][l]:[e[n][l]];t[n][l]=d.concat(h)}else t[n][l]=e[n][l];else if("hook"==n)for(var p in e[n])t[n][p]=t[n][p]?u(t[n][p],e[n][p]):e[n][p];else t[n]=e[n];else t[n]=e[n];return t}),{})},u=function(t,e){return function(){t&&t.apply(this,arguments),e&&e.apply(this,arguments)}};t.exports=s},"499e":function(t,e,n){"use strict";function r(t,e){for(var n=[],r={},a=0;a<e.length;a++){var i=e[a],o=i[0],s=i[1],u=i[2],c=i[3],l={id:t+":"+a,css:s,media:u,sourceMap:c};r[o]?r[o].parts.push(l):n.push(r[o]={id:o,parts:[l]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var a="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,c=!1,l=function(){},d=null,h="data-vue-ssr-id",p="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,a){c=n,d=a||{};var o=r(t,e);return m(o),function(e){for(var n=[],a=0;a<o.length;a++){var s=o[a],u=i[s.id];u.refs--,n.push(u)}for(e?(o=r(t,e),m(o)):o=[],a=0;a<n.length;a++)if(u=n[a],0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete i[u.id]}}}function m(t){for(var e=0;e<t.length;e++){var n=t[e],r=i[n.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](n.parts[a]);for(;a<n.parts.length;a++)r.parts.push(b(n.parts[a]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var o=[];for(a=0;a<n.parts.length;a++)o.push(b(n.parts[a]));i[n.id]={id:n.id,refs:1,parts:o}}}}function g(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function b(t){var e,n,r=document.querySelector("style["+h+'~="'+t.id+'"]');if(r){if(c)return l;r.parentNode.removeChild(r)}if(p){var a=u++;r=s||(s=g()),e=v.bind(null,r,a,!1),n=v.bind(null,r,a,!0)}else r=g(),e=x.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function v(t,e,n,r){var a=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,a);else{var i=document.createTextNode(a),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function x(t,e){var n=e.css,r=e.media,a=e.sourceMap;if(r&&t.setAttribute("media",r),d.ssrId&&t.setAttribute(h,e.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},"4abb":function(t,e,n){var r=n("7a57");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("b2af7572",r,!0,{sourceMap:!1,shadowMode:!1})},"4ed8":function(t,e,n){var r=n("091b");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("2f6bee1a",r,!0,{sourceMap:!1,shadowMode:!1})},"556c":function(t,e,n){var r=n("eef2");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("1209fd47",r,!0,{sourceMap:!1,shadowMode:!1})},"65d9":function(t,e,n){"use strict";
/**
  * vue-class-component v7.0.1
  * (c) 2015-present Evan You
  * @license MIT
  */function r(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var a=r(n("8bbf")),i="undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys;function o(t,e){s(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){s(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){s(t,e,n)}))}function s(t,e,n){var r=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);r.forEach((function(r){var a=n?Reflect.getOwnMetadata(r,e,n):Reflect.getOwnMetadata(r,e);n?Reflect.defineMetadata(r,a,t,n):Reflect.defineMetadata(r,a,t)}))}var u={__proto__:[]},c=u instanceof Array;function l(t){return function(e,n,r){var a="function"===typeof e?e:e.constructor;a.__decorators__||(a.__decorators__=[]),"number"!==typeof r&&(r=void 0),a.__decorators__.push((function(e){return t(e,n,r)}))}}function d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return a.extend({mixins:t})}function h(t){var e=typeof t;return null==t||"object"!==e&&"function"!==e}function p(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var r in t.$options.props)t.hasOwnProperty(r)||n.push(r);n.forEach((function(n){"_"!==n.charAt(0)&&Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var r=new e;e.prototype._init=n;var a={};return Object.keys(r).forEach((function(t){void 0!==r[t]&&(a[t]=r[t])})),a}var f=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function m(t,e){void 0===e&&(e={}),e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(f.indexOf(t)>-1)e[t]=n[t];else{var r=Object.getOwnPropertyDescriptor(n,t);void 0!==r.value?"function"===typeof r.value?(e.methods||(e.methods={}))[t]=r.value:(e.mixins||(e.mixins=[])).push({data:function(){var e;return e={},e[t]=r.value,e}}):(r.get||r.set)&&((e.computed||(e.computed={}))[t]={get:r.get,set:r.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return p(this,t)}});var r=t.__decorators__;r&&(r.forEach((function(t){return t(e)})),delete t.__decorators__);var s=Object.getPrototypeOf(t.prototype),u=s instanceof a?s.constructor:a,c=u.extend(e);return g(c,t,u),i&&o(c,t),c}function g(t,e,n){Object.getOwnPropertyNames(e).forEach((function(r){if("prototype"!==r){var a=Object.getOwnPropertyDescriptor(t,r);if(!a||a.configurable){var i=Object.getOwnPropertyDescriptor(e,r);if(!c){if("cid"===r)return;var o=Object.getOwnPropertyDescriptor(n,r);if(!h(i.value)&&o&&o.value===i.value)return}Object.defineProperty(t,r,i)}}}))}function b(t){return"function"===typeof t?m(t):function(e){return m(e,t)}}b.registerHooks=function(t){f.push.apply(f,t)},e.default=b,e.createDecorator=l,e.mixins=d},"7a57":function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,".vue-slider{position:relative;-webkit-box-sizing:content-box;box-sizing:content-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.vue-slider-rail{position:relative;width:100%;height:100%;-webkit-transition-property:width,height,left,right,top,bottom;transition-property:width,height,left,right,top,bottom}.vue-slider-process{position:absolute;z-index:1}",""]),t.exports=e},8875:function(t,e,n){var r,a,i;(function(n,o){a=[],r=o,i="function"===typeof r?r.apply(e,a):r,void 0===i||(t.exports=i)})("undefined"!==typeof self&&self,(function(){function t(){var e=Object.getOwnPropertyDescriptor(document,"currentScript");if(!e&&"currentScript"in document&&document.currentScript)return document.currentScript;if(e&&e.get!==t&&document.currentScript)return document.currentScript;try{throw new Error}catch(p){var n,r,a,i=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,s=i.exec(p.stack)||o.exec(p.stack),u=s&&s[1]||!1,c=s&&s[2]||!1,l=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");u===l&&(n=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(c-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),a=n.replace(r,"$1").trim());for(var h=0;h<d.length;h++){if("interactive"===d[h].readyState)return d[h];if(d[h].src===u)return d[h];if(u===l&&d[h].innerHTML&&d[h].innerHTML.trim()===a)return d[h]}return null}}return t}))},"8bbf":function(e,n){e.exports=t},eef2:function(t,e,n){var r=n("24fb");e=r(!1),e.push([t.i,".vue-slider-marks{position:relative;width:100%;height:100%}.vue-slider-mark{position:absolute;z-index:1}.vue-slider-ltr .vue-slider-mark,.vue-slider-rtl .vue-slider-mark{width:0;height:100%;top:50%}.vue-slider-ltr .vue-slider-mark-step,.vue-slider-rtl .vue-slider-mark-step{top:0}.vue-slider-ltr .vue-slider-mark-label,.vue-slider-rtl .vue-slider-mark-label{top:100%;margin-top:10px}.vue-slider-ltr .vue-slider-mark{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.vue-slider-ltr .vue-slider-mark-step{left:0}.vue-slider-ltr .vue-slider-mark-label{left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.vue-slider-rtl .vue-slider-mark{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.vue-slider-rtl .vue-slider-mark-step{right:0}.vue-slider-rtl .vue-slider-mark-label{right:50%;-webkit-transform:translateX(50%);transform:translateX(50%)}.vue-slider-btt .vue-slider-mark,.vue-slider-ttb .vue-slider-mark{width:100%;height:0;left:50%}.vue-slider-btt .vue-slider-mark-step,.vue-slider-ttb .vue-slider-mark-step{left:0}.vue-slider-btt .vue-slider-mark-label,.vue-slider-ttb .vue-slider-mark-label{left:100%;margin-left:10px}.vue-slider-btt .vue-slider-mark{-webkit-transform:translate(-50%,50%);transform:translate(-50%,50%)}.vue-slider-btt .vue-slider-mark-step{top:0}.vue-slider-btt .vue-slider-mark-label{top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.vue-slider-ttb .vue-slider-mark{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.vue-slider-ttb .vue-slider-mark-step{bottom:0}.vue-slider-ttb .vue-slider-mark-label{bottom:50%;-webkit-transform:translateY(50%);transform:translateY(50%)}.vue-slider-mark-label,.vue-slider-mark-step{position:absolute}",""]),t.exports=e},fb15:function(t,e,n){"use strict";if(n.r(e),n.d(e,"ERROR_TYPE",(function(){return J})),n.d(e,"VueSliderMark",(function(){return W})),n.d(e,"VueSliderDot",(function(){return I})),"undefined"!==typeof window){var r=window.document.currentScript,a=n("8875");r=a(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:a});var i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var o=n("2638"),s=n.n(o);function u(t,e,n,r){var a,i=arguments.length,o=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(i<3?a(o):i>3?a(e,n,o):a(e,n))||o);return i>3&&o&&Object.defineProperty(e,n,o),o}var c=n("8bbf"),l=n.n(c),d=n("65d9"),h=n.n(d);function p(t,e){return void 0===e&&(e={}),Object(d["createDecorator"])((function(n,r){(n.props||(n.props={}))[r]=e,n.model={prop:r,event:t||r}}))}function f(t){return void 0===t&&(t={}),Object(d["createDecorator"])((function(e,n){(e.props||(e.props={}))[n]=t}))}function m(t,e){void 0===e&&(e={});var n=e.deep,r=void 0!==n&&n,a=e.immediate,i=void 0!==a&&a;return Object(d["createDecorator"])((function(e,n){"object"!==typeof e.watch&&(e.watch=Object.create(null));var a=e.watch;"object"!==typeof a[t]||Array.isArray(a[t])?"undefined"===typeof a[t]&&(a[t]=[]):a[t]=[a[t]],a[t].push({handler:n,deep:r,immediate:i})}))}function g(t){return g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t,e,n){return e&&y(t.prototype,e),n&&y(t,n),t}function x(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}function w(t,e){return w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},w(t,e)}function k(t){var e=_();return function(){var n,r=C(t);if(e){var a=C(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return S(this,n)}}function S(t,e){return!e||"object"!==g(e)&&"function"!==typeof e?O(t):e}function O(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function C(t){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},C(t)}n("4ed8");var T=function(){var t=function(t){x(n,t);var e=k(n);function n(){return b(this,n),e.apply(this,arguments)}return v(n,[{key:"dragStart",value:function(t){if(this.disabled)return!1;this.$emit("drag-start")}},{key:"render",value:function(){var t=arguments[0];return t("div",{ref:"dot",class:this.dotClasses,attrs:{"aria-valuetext":"number"===typeof this.tooltipValue?this.tooltipValue.toString():this.tooltipValue},on:{mousedown:this.dragStart,touchstart:this.dragStart}},[this.$slots.dot||t("div",{class:this.handleClasses,style:this.dotStyle}),"none"!==this.tooltip?t("div",{class:this.tooltipClasses},[this.$slots.tooltip||t("div",{class:this.tooltipInnerClasses,style:this.tooltipStyle},[t("span",{class:"vue-slider-dot-tooltip-text"},[this.tooltipValue])])]):null])}},{key:"dotClasses",get:function(){return["vue-slider-dot",{"vue-slider-dot-hover":"hover"===this.tooltip||"active"===this.tooltip,"vue-slider-dot-disabled":this.disabled,"vue-slider-dot-focus":this.focus}]}},{key:"handleClasses",get:function(){return["vue-slider-dot-handle",{"vue-slider-dot-handle-disabled":this.disabled,"vue-slider-dot-handle-focus":this.focus}]}},{key:"tooltipClasses",get:function(){return["vue-slider-dot-tooltip",["vue-slider-dot-tooltip-".concat(this.tooltipPlacement)],{"vue-slider-dot-tooltip-show":this.showTooltip}]}},{key:"tooltipInnerClasses",get:function(){return["vue-slider-dot-tooltip-inner",["vue-slider-dot-tooltip-inner-".concat(this.tooltipPlacement)],{"vue-slider-dot-tooltip-inner-disabled":this.disabled,"vue-slider-dot-tooltip-inner-focus":this.focus}]}},{key:"showTooltip",get:function(){switch(this.tooltip){case"always":return!0;case"none":return!1;case"focus":case"active":return!!this.focus;default:return!1}}},{key:"tooltipValue",get:function(){return this.tooltipFormatter?"string"===typeof this.tooltipFormatter?this.tooltipFormatter.replace(/\{value\}/,String(this.value)):this.tooltipFormatter(this.value):this.value}}]),n}(l.a);return u([f({default:0})],t.prototype,"value",void 0),u([f()],t.prototype,"tooltip",void 0),u([f()],t.prototype,"dotStyle",void 0),u([f()],t.prototype,"tooltipStyle",void 0),u([f({type:String,validator:function(t){return["top","right","bottom","left"].indexOf(t)>-1},required:!0})],t.prototype,"tooltipPlacement",void 0),u([f({type:[String,Function]})],t.prototype,"tooltipFormatter",void 0),u([f({type:Boolean,default:!1})],t.prototype,"focus",void 0),u([f({default:!1})],t.prototype,"disabled",void 0),t=u([h()({name:"VueSliderDot"})],t),t}(),I=T;function N(t){return N="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e,n){return e&&A(t.prototype,e),n&&A(t,n),t}function j(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&D(t,e)}function D(t,e){return D=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},D(t,e)}function F(t){var e=$();return function(){var n,r=L(t);if(e){var a=L(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return M(this,n)}}function M(t,e){return!e||"object"!==N(e)&&"function"!==typeof e?P(t):e}function P(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function $(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function L(t){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},L(t)}n("556c");var B,z=function(){var t=function(t){j(n,t);var e=F(n);function n(){return E(this,n),e.apply(this,arguments)}return R(n,[{key:"labelClickHandle",value:function(t){t.stopPropagation(),this.$emit("pressLabel",this.mark.pos)}},{key:"render",value:function(){var t=arguments[0],e=this.mark;return t("div",{class:this.marksClasses},[this.$slots.step||t("div",{class:this.stepClasses,style:[this.stepStyle||{},e.style||{},e.active&&this.stepActiveStyle||{},e.active&&e.activeStyle||{}]}),this.hideLabel?null:this.$slots.label||t("div",{class:this.labelClasses,style:[this.labelStyle||{},e.labelStyle||{},e.active&&this.labelActiveStyle||{},e.active&&e.labelActiveStyle||{}],on:{click:this.labelClickHandle}},[e.label])])}},{key:"marksClasses",get:function(){return["vue-slider-mark",{"vue-slider-mark-active":this.mark.active}]}},{key:"stepClasses",get:function(){return["vue-slider-mark-step",{"vue-slider-mark-step-active":this.mark.active}]}},{key:"labelClasses",get:function(){return["vue-slider-mark-label",{"vue-slider-mark-label-active":this.mark.active}]}}]),n}(l.a);return u([f({required:!0})],t.prototype,"mark",void 0),u([f(Boolean)],t.prototype,"hideLabel",void 0),u([f()],t.prototype,"stepStyle",void 0),u([f()],t.prototype,"stepActiveStyle",void 0),u([f()],t.prototype,"labelStyle",void 0),u([f()],t.prototype,"labelActiveStyle",void 0),t=u([h()({name:"VueSlideMark"})],t),t}(),W=z,V=function(t){return"number"===typeof t?"".concat(t,"px"):t},U=function(t){var e=document.documentElement,n=document.body,r=t.getBoundingClientRect(),a={y:r.top+(window.pageYOffset||e.scrollTop)-(e.clientTop||n.clientTop||0),x:r.left+(window.pageXOffset||e.scrollLeft)-(e.clientLeft||n.clientLeft||0)};return a},G=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a="targetTouches"in t?t.targetTouches[0]:t,i=U(e),o={x:a.pageX-i.x,y:a.pageY-i.y};return{x:n?e.offsetWidth*r-o.x:o.x,y:n?e.offsetHeight*r-o.y:o.y}};(function(t){t[t["PAGE_UP"]=33]="PAGE_UP",t[t["PAGE_DOWN"]=34]="PAGE_DOWN",t[t["END"]=35]="END",t[t["HOME"]=36]="HOME",t[t["LEFT"]=37]="LEFT",t[t["UP"]=38]="UP",t[t["RIGHT"]=39]="RIGHT",t[t["DOWN"]=40]="DOWN"})(B||(B={}));var H=function(t,e){if(e.hook){var n=e.hook(t);if("function"===typeof n)return n;if(!n)return null}switch(t.keyCode){case B.UP:return function(t){return"ttb"===e.direction?t-1:t+1};case B.RIGHT:return function(t){return"rtl"===e.direction?t-1:t+1};case B.DOWN:return function(t){return"ttb"===e.direction?t+1:t-1};case B.LEFT:return function(t){return"rtl"===e.direction?t+1:t-1};case B.END:return function(){return e.max};case B.HOME:return function(){return e.min};case B.PAGE_UP:return function(t){return t+10};case B.PAGE_DOWN:return function(t){return t-10};default:return null}};function q(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function X(t,e,n){return e&&K(t.prototype,e),n&&K(t,n),t}var Y,J,Z=function(){function t(e){q(this,t),this.num=e}return X(t,[{key:"decimal",value:function(t,e){var n=this.num,r=this.getDecimalLen(n),a=this.getDecimalLen(t),i=0;switch(e){case"+":i=this.getExponent(r,a),this.num=(this.safeRoundUp(n,i)+this.safeRoundUp(t,i))/i;break;case"-":i=this.getExponent(r,a),this.num=(this.safeRoundUp(n,i)-this.safeRoundUp(t,i))/i;break;case"*":this.num=this.safeRoundUp(this.safeRoundUp(n,this.getExponent(r)),this.safeRoundUp(t,this.getExponent(a)))/this.getExponent(r+a);break;case"/":i=this.getExponent(r,a),this.num=this.safeRoundUp(n,i)/this.safeRoundUp(t,i);break;case"%":i=this.getExponent(r,a),this.num=this.safeRoundUp(n,i)%this.safeRoundUp(t,i)/i;break}return this}},{key:"plus",value:function(t){return this.decimal(t,"+")}},{key:"minus",value:function(t){return this.decimal(t,"-")}},{key:"multiply",value:function(t){return this.decimal(t,"*")}},{key:"divide",value:function(t){return this.decimal(t,"/")}},{key:"remainder",value:function(t){return this.decimal(t,"%")}},{key:"toNumber",value:function(){return this.num}},{key:"getDecimalLen",value:function(t){var e="".concat(t).split("e");return("".concat(e[0]).split(".")[1]||"").length-(e[1]?+e[1]:0)}},{key:"getExponent",value:function(t,e){return Math.pow(10,void 0!==e?Math.max(t,e):t)}},{key:"safeRoundUp",value:function(t,e){return Math.round(t*e)}}]),t}();function Q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Q(Object(n),!0).forEach((function(e){ft(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function et(t,e){return at(t)||rt(t,e)||st(t,e)||nt()}function nt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function rt(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),e&&n.length===e)break}catch(u){a=!0,i=u}finally{try{r||null==s["return"]||s["return"]()}finally{if(a)throw i}}return n}}function at(t){if(Array.isArray(t))return t}function it(t){return ct(t)||ut(t)||st(t)||ot()}function ot(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function st(t,e){if(t){if("string"===typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(t,e):void 0}}function ut(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function ct(t){if(Array.isArray(t))return lt(t)}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function dt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ht(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pt(t,e,n){return e&&ht(t.prototype,e),n&&ht(t,n),t}function ft(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(function(t){t[t["VALUE"]=1]="VALUE",t[t["INTERVAL"]=2]="INTERVAL",t[t["MIN"]=3]="MIN",t[t["MAX"]=4]="MAX",t[t["ORDER"]=5]="ORDER"})(J||(J={}));var mt=(Y={},ft(Y,J.VALUE,'The type of the "value" is illegal'),ft(Y,J.INTERVAL,'The prop "interval" is invalid, "(max - min)" must be divisible by "interval"'),ft(Y,J.MIN,'The "value" must be greater than or equal to the "min".'),ft(Y,J.MAX,'The "value" must be less than or equal to the "max".'),ft(Y,J.ORDER,'When "order" is false, the parameters "minRange", "maxRange", "fixed", "enabled" are invalid.'),Y),gt=function(){function t(e){dt(this,t),this.dotsPos=[],this.dotsValue=[],this.cacheRangeDir={},this.data=e.data,this.max=e.max,this.min=e.min,this.interval=e.interval,this.order=e.order,this.marks=e.marks,this.included=e.included,this.process=e.process,this.adsorb=e.adsorb,this.dotOptions=e.dotOptions,this.onError=e.onError,this.order?(this.minRange=e.minRange||0,this.maxRange=e.maxRange||0,this.enableCross=e.enableCross,this.fixed=e.fixed):((e.minRange||e.maxRange||!e.enableCross||e.fixed)&&this.emitError(J.ORDER),this.minRange=0,this.maxRange=0,this.enableCross=!0,this.fixed=!1),this.setValue(e.value)}return pt(t,[{key:"setValue",value:function(t){var e=this;this.setDotsValue(Array.isArray(t)?this.order?it(t).sort((function(t,n){return e.getIndexByValue(t)-e.getIndexByValue(n)})):it(t):[t],!0)}},{key:"setDotsValue",value:function(t,e){this.dotsValue=t,e&&this.syncDotsPos()}},{key:"setDotsPos",value:function(t){var e=this,n=this.order?it(t).sort((function(t,e){return t-e})):t;this.dotsPos=n,this.setDotsValue(n.map((function(t){return e.getValueByPos(t)})),this.adsorb)}},{key:"getValueByPos",value:function(t){var e=this.parsePos(t);if(this.included){var n=100;this.markList.forEach((function(r){var a=Math.abs(r.pos-t);a<n&&(n=a,e=r.value)}))}return e}},{key:"syncDotsPos",value:function(){var t=this;this.dotsPos=this.dotsValue.map((function(e){return t.parseValue(e)}))}},{key:"getRecentDot",value:function(t){var e=this,n=this.dotsPos.filter((function(t,n){return!(e.getDotOption(n)&&e.getDotOption(n).disabled)})).map((function(e){return Math.abs(e-t)}));return n.indexOf(Math.min.apply(Math,it(n)))}},{key:"getIndexByValue",value:function(t){return this.data?this.data.indexOf(t):new Z(+t).minus(this.min).divide(this.interval).toNumber()}},{key:"getValueByIndex",value:function(t){return t<0?t=0:t>this.total&&(t=this.total),this.data?this.data[t]:new Z(t).multiply(this.interval).plus(this.min).toNumber()}},{key:"setDotPos",value:function(t,e){t=this.getValidPos(t,e).pos;var n=t-this.dotsPos[e];if(n){var r=new Array(this.dotsPos.length);this.fixed?r=this.getFixedChangePosArr(n,e):this.minRange||this.maxRange?r=this.getLimitRangeChangePosArr(t,n,e):r[e]=n,this.setDotsPos(this.dotsPos.map((function(t,e){return t+(r[e]||0)})))}}},{key:"getFixedChangePosArr",value:function(t,e){var n=this;return this.dotsPos.forEach((function(r,a){if(a!==e){var i=n.getValidPos(r+t,a),o=i.pos,s=i.inRange;s||(t=Math.min(Math.abs(o-r),Math.abs(t))*(t<0?-1:1))}})),this.dotsPos.map((function(e){return t}))}},{key:"getLimitRangeChangePosArr",value:function(t,e,n){var r=this,a=[{index:n,changePos:e}],i=e;return[this.minRange,this.maxRange].forEach((function(o,s){if(!o)return!1;var u=0===s,c=e>0,l=0;l=u?c?1:-1:c?-1:1;var d=function(t,e){var n=Math.abs(t-e);return u?n<r.minRangeDir:n>r.maxRangeDir},h=n+l,p=r.dotsPos[h],f=t;while(r.isPos(p)&&d(p,f)){var m=r.getValidPos(p+i,h),g=m.pos;a.push({index:h,changePos:g-p}),h+=l,f=g,p=r.dotsPos[h]}})),this.dotsPos.map((function(t,e){var n=a.filter((function(t){return t.index===e}));return n.length?n[0].changePos:0}))}},{key:"isPos",value:function(t){return"number"===typeof t}},{key:"getValidPos",value:function(t,e){var n=this.valuePosRange[e],r=!0;return t<n[0]?(t=n[0],r=!1):t>n[1]&&(t=n[1],r=!1),{pos:t,inRange:r}}},{key:"parseValue",value:function(t){if(this.data)t=this.data.indexOf(t);else if("number"===typeof t||"string"===typeof t){if(t=+t,t<this.min)return this.emitError(J.MIN),0;if(t>this.max)return this.emitError(J.MAX),0;if("number"!==typeof t||t!==t)return this.emitError(J.VALUE),0;t=new Z(t).minus(this.min).divide(this.interval).toNumber()}var e=new Z(t).multiply(this.gap).toNumber();return e<0?0:e>100?100:e}},{key:"parsePos",value:function(t){var e=Math.round(t/this.gap);return this.getValueByIndex(e)}},{key:"isActiveByPos",value:function(t){return this.processArray.some((function(e){var n=et(e,2),r=n[0],a=n[1];return t>=r&&t<=a}))}},{key:"getValues",value:function(){if(this.data)return this.data;for(var t=[],e=0;e<=this.total;e++)t.push(new Z(e).multiply(this.interval).plus(this.min).toNumber());return t}},{key:"getRangeDir",value:function(t){return t?new Z(t).divide(new Z(this.data?this.data.length-1:this.max).minus(this.data?0:this.min).toNumber()).multiply(100).toNumber():100}},{key:"emitError",value:function(t){this.onError&&this.onError(t,mt[t])}},{key:"getDotOption",value:function(t){return Array.isArray(this.dotOptions)?this.dotOptions[t]:this.dotOptions}},{key:"getDotRange",value:function(t,e,n){if(!this.dotOptions)return n;var r=this.getDotOption(t);return r&&void 0!==r[e]?this.parseValue(r[e]):n}},{key:"markList",get:function(){var t=this;if(!this.marks)return[];var e=function(e,n){var r=t.parseValue(e);return tt({pos:r,value:e,label:e,active:t.isActiveByPos(r)},n)};return!0===this.marks?this.getValues().map((function(t){return e(t)})):"[object Object]"===Object.prototype.toString.call(this.marks)?Object.keys(this.marks).sort((function(t,e){return+t-+e})).map((function(n){var r=t.marks[n];return e(n,"string"!==typeof r?r:{label:r})})):Array.isArray(this.marks)?this.marks.map((function(t){return e(t)})):"function"===typeof this.marks?this.getValues().map((function(e){return{value:e,result:t.marks(e)}})).filter((function(t){var e=t.result;return!!e})).map((function(t){var n=t.value,r=t.result;return e(n,r)})):[]}},{key:"processArray",get:function(){if(this.process){if("function"===typeof this.process)return this.process(this.dotsPos);if(1===this.dotsPos.length)return[[0,this.dotsPos[0]]];if(this.dotsPos.length>1)return[[Math.min.apply(Math,it(this.dotsPos)),Math.max.apply(Math,it(this.dotsPos))]]}return[]}},{key:"total",get:function(){var t=0;return t=this.data?this.data.length-1:new Z(this.max).minus(this.min).divide(this.interval).toNumber(),t-Math.floor(t)!==0?(this.emitError(J.INTERVAL),0):t}},{key:"gap",get:function(){return 100/this.total}},{key:"minRangeDir",get:function(){return this.cacheRangeDir[this.minRange]?this.cacheRangeDir[this.minRange]:this.cacheRangeDir[this.minRange]=this.getRangeDir(this.minRange)}},{key:"maxRangeDir",get:function(){return this.cacheRangeDir[this.maxRange]?this.cacheRangeDir[this.maxRange]:this.cacheRangeDir[this.maxRange]=this.getRangeDir(this.maxRange)}},{key:"valuePosRange",get:function(){var t=this,e=this.dotsPos,n=[];return e.forEach((function(r,a){n.push([Math.max(t.minRange?t.minRangeDir*a:0,t.enableCross?0:e[a-1]||0,t.getDotRange(a,"min",0)),Math.min(t.minRange?100-t.minRangeDir*(e.length-1-a):100,t.enableCross?100:e[a+1]||100,t.getDotRange(a,"max",100))])})),n}},{key:"dotsIndex",get:function(){var t=this;return this.dotsValue.map((function(e){return t.getIndexByValue(e)}))}}]),t}();function bt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vt(t,e,n){return e&&yt(t.prototype,e),n&&yt(t,n),t}var xt=function(){function t(e){bt(this,t),this.states=0,this.map=e}return vt(t,[{key:"add",value:function(t){this.states|=t}},{key:"delete",value:function(t){this.states&=~t}},{key:"toggle",value:function(t){this.has(t)?this.delete(t):this.add(t)}},{key:"has",value:function(t){return!!(this.states&t)}}]),t}();function wt(t,e){return Ot(t)||St(t,e)||Et(t,e)||kt()}function kt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function St(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),e&&n.length===e)break}catch(u){a=!0,i=u}finally{try{r||null==s["return"]||s["return"]()}finally{if(a)throw i}}return n}}function Ot(t){if(Array.isArray(t))return t}function _t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_t(Object(n),!0).forEach((function(e){Tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function It(t){return Rt(t)||At(t)||Et(t)||Nt()}function Nt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Et(t,e){if(t){if("string"===typeof t)return jt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jt(t,e):void 0}}function At(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function Rt(t){if(Array.isArray(t))return jt(t)}function jt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Dt(t){return Dt="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pt(t,e,n){return e&&Mt(t.prototype,e),n&&Mt(t,n),t}function $t(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Lt(t,e)}function Lt(t,e){return Lt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},Lt(t,e)}function Bt(t){var e=Vt();return function(){var n,r=Ut(t);if(e){var a=Ut(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return zt(this,n)}}function zt(t,e){return!e||"object"!==Dt(e)&&"function"!==typeof e?Wt(t):e}function Wt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vt(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Ut(t){return Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},Ut(t)}n("4abb");var Gt={None:0,Drag:2,Focus:4},Ht=4,qt=function(){var t=function(t){$t(n,t);var e=Bt(n);function n(){var t;return Ft(this,n),t=e.apply(this,arguments),t.states=new xt(Gt),t.scale=1,t.focusDotIndex=0,t}return Pt(n,[{key:"isObjectData",value:function(t){return!!t&&"[object Object]"===Object.prototype.toString.call(t)}},{key:"isObjectArrayData",value:function(t){return!!t&&Array.isArray(t)&&t.length>0&&"object"===Dt(t[0])}},{key:"onValueChanged",value:function(){this.control&&!this.states.has(Gt.Drag)&&this.isNotSync&&(this.control.setValue(this.value),this.syncValueByPos())}},{key:"created",value:function(){this.initControl()}},{key:"mounted",value:function(){this.bindEvent()}},{key:"beforeDestroy",value:function(){this.unbindEvent()}},{key:"bindEvent",value:function(){document.addEventListener("touchmove",this.dragMove,{passive:!1}),document.addEventListener("touchend",this.dragEnd,{passive:!1}),document.addEventListener("mousedown",this.blurHandle),document.addEventListener("mousemove",this.dragMove,{passive:!1}),document.addEventListener("mouseup",this.dragEnd),document.addEventListener("mouseleave",this.dragEnd),document.addEventListener("keydown",this.keydownHandle)}},{key:"unbindEvent",value:function(){document.removeEventListener("touchmove",this.dragMove),document.removeEventListener("touchend",this.dragEnd),document.removeEventListener("mousedown",this.blurHandle),document.removeEventListener("mousemove",this.dragMove),document.removeEventListener("mouseup",this.dragEnd),document.removeEventListener("mouseleave",this.dragEnd),document.removeEventListener("keydown",this.keydownHandle)}},{key:"setScale",value:function(){var t=new Z(Math.floor(this.isHorizontal?this.$refs.rail.offsetWidth:this.$refs.rail.offsetHeight));void 0!==this.zoom&&t.multiply(this.zoom),t.divide(100),this.scale=t.toNumber()}},{key:"initControl",value:function(){var t=this;this.control=new gt({value:this.value,data:this.sliderData,enableCross:this.enableCross,fixed:this.fixed,max:this.max,min:this.min,interval:this.interval,minRange:this.minRange,maxRange:this.maxRange,order:this.order,marks:this.sliderMarks,included:this.included,process:this.process,adsorb:this.adsorb,dotOptions:this.dotOptions,onError:this.emitError}),this.syncValueByPos(),["data","enableCross","fixed","max","min","interval","minRange","maxRange","order","marks","process","adsorb","included","dotOptions"].forEach((function(e){t.$watch(e,(function(n){if("data"===e&&Array.isArray(t.control.data)&&Array.isArray(n)&&t.control.data.length===n.length&&n.every((function(e,n){return e===t.control.data[n]})))return!1;switch(e){case"data":case"dataLabel":case"dataValue":t.control.data=t.sliderData;break;case"mark":t.control.marks=t.sliderMarks;break;default:t.control[e]=n}["data","max","min","interval"].indexOf(e)>-1&&t.control.syncDotsPos()}))}))}},{key:"syncValueByPos",value:function(){var t=this.control.dotsValue;this.isDiff(t,Array.isArray(this.value)?this.value:[this.value])&&this.$emit("change",1===t.length?t[0]:It(t),this.focusDotIndex)}},{key:"isDiff",value:function(t,e){return t.length!==e.length||t.some((function(t,n){return t!==e[n]}))}},{key:"emitError",value:function(t,e){this.silent||console.error("[VueSlider error]: ".concat(e)),this.$emit("error",t,e)}},{key:"dragStartOnProcess",value:function(t){if(this.dragOnClick){this.setScale();var e=this.getPosByEvent(t),n=this.control.getRecentDot(e);if(this.dots[n].disabled)return;this.dragStart(n),this.control.setDotPos(e,this.focusDotIndex),this.lazy||this.syncValueByPos()}}},{key:"dragStart",value:function(t){this.focusDotIndex=t,this.setScale(),this.states.add(Gt.Drag),this.states.add(Gt.Focus),this.$emit("drag-start",this.focusDotIndex)}},{key:"dragMove",value:function(t){if(!this.states.has(Gt.Drag))return!1;t.preventDefault();var e=this.getPosByEvent(t);this.isCrossDot(e),this.control.setDotPos(e,this.focusDotIndex),this.lazy||this.syncValueByPos();var n=this.control.dotsValue;this.$emit("dragging",1===n.length?n[0]:It(n),this.focusDotIndex)}},{key:"isCrossDot",value:function(t){if(this.canSort){var e=this.focusDotIndex,n=t;if(n>this.dragRange[1]?(n=this.dragRange[1],this.focusDotIndex++):n<this.dragRange[0]&&(n=this.dragRange[0],this.focusDotIndex--),e!==this.focusDotIndex){var r=this.$refs["dot-".concat(this.focusDotIndex)];r&&r.$el&&r.$el.focus(),this.control.setDotPos(n,e)}}}},{key:"dragEnd",value:function(t){var e=this;if(!this.states.has(Gt.Drag))return!1;setTimeout((function(){e.lazy&&e.syncValueByPos(),e.included&&e.isNotSync?e.control.setValue(e.value):e.control.syncDotsPos(),e.states.delete(Gt.Drag),e.useKeyboard&&!("targetTouches"in t)||e.states.delete(Gt.Focus),e.$emit("drag-end",e.focusDotIndex)}))}},{key:"blurHandle",value:function(t){if(!this.states.has(Gt.Focus)||!this.$refs.container||this.$refs.container.contains(t.target))return!1;this.states.delete(Gt.Focus)}},{key:"clickHandle",value:function(t){if(!this.clickable||this.disabled)return!1;if(!this.states.has(Gt.Drag)){this.setScale();var e=this.getPosByEvent(t);this.setValueByPos(e)}}},{key:"focus",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.states.add(Gt.Focus),this.focusDotIndex=t}},{key:"blur",value:function(){this.states.delete(Gt.Focus)}},{key:"getValue",value:function(){var t=this.control.dotsValue;return 1===t.length?t[0]:t}},{key:"getIndex",value:function(){var t=this.control.dotsIndex;return 1===t.length?t[0]:t}},{key:"setValue",value:function(t){this.control.setValue(Array.isArray(t)?It(t):[t]),this.syncValueByPos()}},{key:"setIndex",value:function(t){var e=this,n=Array.isArray(t)?t.map((function(t){return e.control.getValueByIndex(t)})):this.control.getValueByIndex(t);this.setValue(n)}},{key:"setValueByPos",value:function(t){var e=this,n=this.control.getRecentDot(t);if(this.disabled||this.dots[n].disabled)return!1;this.focusDotIndex=n,this.control.setDotPos(t,n),this.syncValueByPos(),this.useKeyboard&&this.states.add(Gt.Focus),setTimeout((function(){e.included&&e.isNotSync?e.control.setValue(e.value):e.control.syncDotsPos()}))}},{key:"keydownHandle",value:function(t){var e=this;if(!this.useKeyboard||!this.states.has(Gt.Focus))return!1;var n=this.included&&this.marks,r=H(t,{direction:this.direction,max:n?this.control.markList.length-1:this.control.total,min:0,hook:this.keydownHook});if(r){t.preventDefault();var a=-1,i=0;n?(this.control.markList.some((function(t,n){return t.value===e.control.dotsValue[e.focusDotIndex]&&(a=r(n),!0)})),a<0?a=0:a>this.control.markList.length-1&&(a=this.control.markList.length-1),i=this.control.markList[a].pos):(a=r(this.control.getIndexByValue(this.control.dotsValue[this.focusDotIndex])),i=this.control.parseValue(this.control.getValueByIndex(a))),this.isCrossDot(i),this.control.setDotPos(i,this.focusDotIndex),this.syncValueByPos()}}},{key:"getPosByEvent",value:function(t){return G(t,this.$refs.rail,this.isReverse,this.zoom)[this.isHorizontal?"x":"y"]/this.scale}},{key:"renderSlot",value:function(t,e,n,r){var a=this.$createElement,i=this.$scopedSlots[t];return i?r?i(e):a("template",{slot:t},[i(e)]):n}},{key:"render",value:function(){var t=this,e=arguments[0];return e("div",s()([{ref:"container",class:this.containerClasses,style:this.containerStyles,on:{click:this.clickHandle,touchstart:this.dragStartOnProcess,mousedown:this.dragStartOnProcess}},this.$attrs]),[e("div",{ref:"rail",class:"vue-slider-rail",style:this.railStyle},[this.processArray.map((function(n,r){return t.renderSlot("process",n,e("div",{class:"vue-slider-process",key:"process-".concat(r),style:n.style}),!0)})),this.sliderMarks?e("div",{class:"vue-slider-marks"},[this.control.markList.map((function(n,r){var a;return t.renderSlot("mark",n,e("vue-slider-mark",{key:"mark-".concat(r),attrs:{mark:n,hideLabel:t.hideLabel,stepStyle:t.stepStyle,stepActiveStyle:t.stepActiveStyle,labelStyle:t.labelStyle,labelActiveStyle:t.labelActiveStyle},style:(a={},Tt(a,t.isHorizontal?"height":"width","100%"),Tt(a,t.isHorizontal?"width":"height",t.tailSize),Tt(a,t.mainDirection,"".concat(n.pos,"%")),a),on:{pressLabel:function(e){return t.clickable&&t.setValueByPos(e)}}},[t.renderSlot("step",n,null),t.renderSlot("label",n,null)]),!0)}))]):null,this.dots.map((function(n,r){var a;return e("vue-slider-dot",{ref:"dot-".concat(r),key:"dot-".concat(r),attrs:Ct({value:n.value,disabled:n.disabled,focus:n.focus,"dot-style":[n.style,n.disabled?n.disabledStyle:null,n.focus?n.focusStyle:null],tooltip:n.tooltip||t.tooltip,"tooltip-style":[t.tooltipStyle,n.tooltipStyle,n.disabled?n.tooltipDisabledStyle:null,n.focus?n.tooltipFocusStyle:null],"tooltip-formatter":Array.isArray(t.sliderTooltipFormatter)?t.sliderTooltipFormatter[r]:t.sliderTooltipFormatter,"tooltip-placement":t.tooltipDirections[r],role:"slider","aria-valuenow":n.value,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-orientation":t.isHorizontal?"horizontal":"vertical",tabindex:"0"},t.dotAttrs),style:[t.dotBaseStyle,(a={},Tt(a,t.mainDirection,"".concat(n.pos,"%")),Tt(a,"transition","".concat(t.mainDirection," ").concat(t.animateTime,"s")),a)],on:{"drag-start":function(){return t.dragStart(r)}},nativeOn:{focus:function(){return!n.disabled&&t.focus(r)},blur:function(){return t.blur()}}},[t.renderSlot("dot",n,null),t.renderSlot("tooltip",n,null)])})),this.renderSlot("default",{value:this.getValue()},null,!0)])])}},{key:"tailSize",get:function(){return V((this.isHorizontal?this.height:this.width)||Ht)}},{key:"containerClasses",get:function(){return["vue-slider",["vue-slider-".concat(this.direction)],{"vue-slider-disabled":this.disabled}]}},{key:"containerStyles",get:function(){var t=Array.isArray(this.dotSize)?this.dotSize:[this.dotSize,this.dotSize],e=wt(t,2),n=e[0],r=e[1],a=this.width?V(this.width):this.isHorizontal?"auto":V(Ht),i=this.height?V(this.height):this.isHorizontal?V(Ht):"auto";return{padding:this.contained?"".concat(r/2,"px ").concat(n/2,"px"):this.isHorizontal?"".concat(r/2,"px 0"):"0 ".concat(n/2,"px"),width:a,height:i}}},{key:"processArray",get:function(){var t=this;return this.control.processArray.map((function(e,n){var r,a=wt(e,3),i=a[0],o=a[1],s=a[2];if(i>o){var u=[o,i];i=u[0],o=u[1]}var c=t.isHorizontal?"width":"height";return{start:i,end:o,index:n,style:Ct(Ct((r={},Tt(r,t.isHorizontal?"height":"width","100%"),Tt(r,t.isHorizontal?"top":"left",0),Tt(r,t.mainDirection,"".concat(i,"%")),Tt(r,c,"".concat(o-i,"%")),Tt(r,"transitionProperty","".concat(c,",").concat(t.mainDirection)),Tt(r,"transitionDuration","".concat(t.animateTime,"s")),r),t.processStyle),s)}}))}},{key:"dotBaseStyle",get:function(){var t,e=Array.isArray(this.dotSize)?this.dotSize:[this.dotSize,this.dotSize],n=wt(e,2),r=n[0],a=n[1];return t=this.isHorizontal?Tt({transform:"translate(".concat(this.isReverse?"50%":"-50%",", -50%)"),"-WebkitTransform":"translate(".concat(this.isReverse?"50%":"-50%",", -50%)"),top:"50%"},"ltr"===this.direction?"left":"right","0"):Tt({transform:"translate(-50%, ".concat(this.isReverse?"50%":"-50%",")"),"-WebkitTransform":"translate(-50%, ".concat(this.isReverse?"50%":"-50%",")"),left:"50%"},"btt"===this.direction?"bottom":"top","0"),Ct({width:"".concat(r,"px"),height:"".concat(a,"px")},t)}},{key:"mainDirection",get:function(){switch(this.direction){case"ltr":return"left";case"rtl":return"right";case"btt":return"bottom";case"ttb":return"top"}}},{key:"isHorizontal",get:function(){return"ltr"===this.direction||"rtl"===this.direction}},{key:"isReverse",get:function(){return"rtl"===this.direction||"btt"===this.direction}},{key:"tooltipDirections",get:function(){var t=this.tooltipPlacement||(this.isHorizontal?"top":"left");return Array.isArray(t)?t:this.dots.map((function(){return t}))}},{key:"dots",get:function(){var t=this;return this.control.dotsPos.map((function(e,n){return Ct({pos:e,index:n,value:t.control.dotsValue[n],focus:t.states.has(Gt.Focus)&&t.focusDotIndex===n,disabled:t.disabled,style:t.dotStyle},(Array.isArray(t.dotOptions)?t.dotOptions[n]:t.dotOptions)||{})}))}},{key:"animateTime",get:function(){return this.states.has(Gt.Drag)?0:this.duration}},{key:"canSort",get:function(){return this.order&&!this.minRange&&!this.maxRange&&!this.fixed&&this.enableCross}},{key:"sliderData",get:function(){var t=this;return this.isObjectArrayData(this.data)?this.data.map((function(e){return e[t.dataValue]})):this.isObjectData(this.data)?Object.keys(this.data):this.data}},{key:"sliderMarks",get:function(){var t=this;return this.marks?this.marks:this.isObjectArrayData(this.data)?function(e){var n={label:e};return t.data.some((function(r){return r[t.dataValue]===e&&(n.label=r[t.dataLabel],!0)})),n}:this.isObjectData(this.data)?this.data:void 0}},{key:"sliderTooltipFormatter",get:function(){var t=this;if(this.tooltipFormatter)return this.tooltipFormatter;if(this.isObjectArrayData(this.data))return function(e){var n=""+e;return t.data.some((function(r){return r[t.dataValue]===e&&(n=r[t.dataLabel],!0)})),n};if(this.isObjectData(this.data)){var e=this.data;return function(t){return e[t]}}}},{key:"isNotSync",get:function(){var t=this.control.dotsValue;return Array.isArray(this.value)?this.value.length!==t.length||this.value.some((function(e,n){return e!==t[n]})):this.value!==t[0]}},{key:"dragRange",get:function(){var t=this.dots[this.focusDotIndex-1],e=this.dots[this.focusDotIndex+1];return[t?t.pos:-1/0,e?e.pos:1/0]}}]),n}(l.a);return u([p("change",{default:0})],t.prototype,"value",void 0),u([f({type:Boolean,default:!1})],t.prototype,"silent",void 0),u([f({default:"ltr",validator:function(t){return["ltr","rtl","ttb","btt"].indexOf(t)>-1}})],t.prototype,"direction",void 0),u([f({type:[Number,String]})],t.prototype,"width",void 0),u([f({type:[Number,String]})],t.prototype,"height",void 0),u([f({default:14})],t.prototype,"dotSize",void 0),u([f({default:!1})],t.prototype,"contained",void 0),u([f({type:Number,default:0})],t.prototype,"min",void 0),u([f({type:Number,default:100})],t.prototype,"max",void 0),u([f({type:Number,default:1})],t.prototype,"interval",void 0),u([f({type:Boolean,default:!1})],t.prototype,"disabled",void 0),u([f({type:Boolean,default:!0})],t.prototype,"clickable",void 0),u([f({type:Boolean,default:!1})],t.prototype,"dragOnClick",void 0),u([f({type:Number,default:.5})],t.prototype,"duration",void 0),u([f({type:[Object,Array]})],t.prototype,"data",void 0),u([f({type:String,default:"value"})],t.prototype,"dataValue",void 0),u([f({type:String,default:"label"})],t.prototype,"dataLabel",void 0),u([f({type:Boolean,default:!1})],t.prototype,"lazy",void 0),u([f({type:String,validator:function(t){return["none","always","focus","hover","active"].indexOf(t)>-1},default:"active"})],t.prototype,"tooltip",void 0),u([f({type:[String,Array],validator:function(t){return(Array.isArray(t)?t:[t]).every((function(t){return["top","right","bottom","left"].indexOf(t)>-1}))}})],t.prototype,"tooltipPlacement",void 0),u([f({type:[String,Array,Function]})],t.prototype,"tooltipFormatter",void 0),u([f({type:Boolean,default:!0})],t.prototype,"useKeyboard",void 0),u([f(Function)],t.prototype,"keydownHook",void 0),u([f({type:Boolean,default:!0})],t.prototype,"enableCross",void 0),u([f({type:Boolean,default:!1})],t.prototype,"fixed",void 0),u([f({type:Boolean,default:!0})],t.prototype,"order",void 0),u([f(Number)],t.prototype,"minRange",void 0),u([f(Number)],t.prototype,"maxRange",void 0),u([f({type:[Boolean,Object,Array,Function],default:!1})],t.prototype,"marks",void 0),u([f({type:[Boolean,Function],default:!0})],t.prototype,"process",void 0),u([f({type:[Number]})],t.prototype,"zoom",void 0),u([f(Boolean)],t.prototype,"included",void 0),u([f(Boolean)],t.prototype,"adsorb",void 0),u([f(Boolean)],t.prototype,"hideLabel",void 0),u([f()],t.prototype,"dotOptions",void 0),u([f()],t.prototype,"dotAttrs",void 0),u([f()],t.prototype,"railStyle",void 0),u([f()],t.prototype,"processStyle",void 0),u([f()],t.prototype,"dotStyle",void 0),u([f()],t.prototype,"tooltipStyle",void 0),u([f()],t.prototype,"stepStyle",void 0),u([f()],t.prototype,"stepActiveStyle",void 0),u([f()],t.prototype,"labelStyle",void 0),u([f()],t.prototype,"labelActiveStyle",void 0),u([m("value")],t.prototype,"onValueChanged",null),t=u([h()({name:"VueSlider",data:function(){return{control:null}},components:{VueSliderDot:I,VueSliderMark:W}})],t),t}(),Kt=qt;Kt.VueSliderMark=W,Kt.VueSliderDot=I;var Xt=Kt;e["default"]=Xt}})["default"]}))},"49f4":function(t,e,n){var r=n("6044");function a(){this.__data__=r?r(null):{},this.size=0}t.exports=a},"4b17":function(t,e,n){var r=n("6428");function a(t){var e=r(t),n=e%1;return e===e?n?e-n:e:0}t.exports=a},"4b53":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("086c"),u=n("f947"),c=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function l(t,e,n,u,l="NHWC",d=[1,1],h){const p=Object(i["a"])(t,"x","conv2d","float32"),f=Object(i["a"])(e,"filter","conv2d","float32");let m=p,g=!1;3===p.rank&&(g=!0,m=Object(c["a"])(p,[1,p.shape[0],p.shape[1],p.shape[2]])),o["b"](4===m.rank,()=>`Error in conv2d: input must be rank 4, but got rank ${m.rank}.`),o["b"](4===f.rank,()=>"Error in conv2d: filter must be rank 4, but got rank "+f.rank+"."),s["a"]("conv2d",u,h);const b="NHWC"===l?m.shape[3]:m.shape[1];o["b"](b===f.shape[2],()=>`Error in conv2d: depth of input (${b}) must match input depth for filter ${f.shape[2]}.`),o["b"](s["i"](n,d),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${d}'`);const y={x:m,filter:f},v={strides:n,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h},x=r["a"].runKernel(a["D"],y,v);return g?Object(c["a"])(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const d=Object(u["b"])({conv2d_:l})},"4cef":function(t,e){var n=/\s/;function r(t){var e=t.length;while(e--&&n.test(t.charAt(e)));return e}t.exports=r},"4d7e":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n("2ca8");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function a(t,e){return i(t,e)}function i(t,e,n=new Map,r=new Set){if(null==t)return null;if("function"===typeof Blob&&t instanceof Blob)return t.slice();if(r.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(l(t)){const a=Array.isArray(t)?[]:{};r.add(t);for(const o in t){const s=t[o],u=i(s,e,n,r);a[o]=u}return r.delete(t),t.__proto__&&(a.__proto__=t.__proto__),a}throw new Error("Can't recurse into non-iterable type: "+t)}return n.set(t,a.value),a.value}function o(t,e=u){return s(t,e)}function s(t,e,n=new Set){const r=t[0];if(n.has(r))throw new Error("Circular references are not supported.");const a=e(t);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(l(r)){const a=Array.isArray(r)?[]:{};n.add(r);for(const i in r){const r=t.map(t=>t[i]),o=s(r,e,n);a[i]=o}return n.delete(r),a}throw new Error("Can't recurse into non-iterable type: "+r)}return a.value}function u(t){return null===t?null:l(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function c(t,e){const n=new Map;i(t,e,n);for(const i of Array.from(n.keys())){const t=n.get(i);if(r["util"].isPromise(t)){const e=await t;n.set(i,e)}}const a=i(t,e,n);return a}function l(t){let e=!1;if(r["env"]().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:r}=n(4);e=t instanceof r}return null!=t&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||"object"===typeof t&&!(t instanceof r["Tensor"])&&!(t instanceof Promise)&&!e)}function d(t){return null==t||h(t)||Array.isArray(t)||"object"===typeof t&&t instanceof r["Tensor"]||r["util"].isTypedArray(t)}function h(t){return null===t||"object"!==typeof t&&"function"!==typeof t}},"4d8c":function(t,e,n){var r=n("5c69");function a(t){var e=null==t?0:t.length;return e?r(t,1):[]}t.exports=a},"4db8":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","logicalNot","bool"),n={x:e};return r["a"].runKernel(a["Ib"],n)}const u=Object(o["b"])({logicalNot_:s})},"4e1f":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","clone","string_or_numeric"),n={x:e};return r["a"].runKernel(a["tb"],n)}const u=Object(o["b"])({clone_:s})},"4e56":function(t,e,n){"use strict";n.d(e,"b",(function(){return m})),n.d(e,"f",(function(){return v})),n.d(e,"e",(function(){return x})),n.d(e,"d",(function(){return w})),n.d(e,"a",(function(){return k})),n.d(e,"c",(function(){return O}));var r=n("4705"),a=n("df00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i=20,o=3,s=7;function u(t,e,n,r){const i=Object(a["j"])(e),o=c(t,e,n,i),s=e.length,u=h(t,e,n,i,o),l=["Tensor"];return r&&(l.push("  dtype: "+n),l.push("  rank: "+s),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(u.map(t=>"    "+t).join("\n")),l.join("\n")}function c(t,e,n,r){const i=Object(a["O"])(e),o=r[r.length-1],s=new Array(o).fill(0),u=e.length,c="complex64"===n?p(t):t;if(u>1)for(let a=0;a<i/o;a++){const t=a*o;for(let e=0;e<o;e++)s[e]=Math.max(s[e],l(c[t+e],0,n).length)}return s}function l(t,e,n){let r;return r=Array.isArray(t)?parseFloat(t[0].toFixed(s))+" + "+parseFloat(t[1].toFixed(s))+"j":Object(a["z"])(t)?`'${t}'`:"bool"===n?d(t):parseFloat(t.toFixed(s)).toString(),Object(a["L"])(r,e)}function d(t){return 0===t?"false":"true"}function h(t,e,n,r,a,s=!0){const u="complex64"===n?2:1,c=e[0],f=e.length;if(0===f){if("complex64"===n){const e=p(t);return[l(e[0],0,n)]}return"bool"===n?[d(t[0])]:[t[0].toString()]}if(1===f){if(c>i){const e=o*u;let r=Array.from(t.slice(0,e)),i=Array.from(t.slice((c-o)*u,c*u));return"complex64"===n&&(r=p(r),i=p(i)),["["+r.map((t,e)=>l(t,a[e],n)).join(", ")+", ..., "+i.map((t,e)=>l(t,a[c-o+e],n)).join(", ")+"]"]}const e="complex64"===n?p(t):Array.from(t);return["["+e.map((t,e)=>l(t,a[e],n)).join(", ")+"]"]}const m=e.slice(1),g=r.slice(1),b=r[0]*u,y=[];if(c>i){for(let e=0;e<o;e++){const r=e*b,i=r+b;y.push(...h(t.slice(r,i),m,n,g,a,!1))}y.push("...");for(let e=c-o;e<c;e++){const r=e*b,i=r+b;y.push(...h(t.slice(r,i),m,n,g,a,e===c-1))}}else for(let i=0;i<c;i++){const e=i*b,r=e+b;y.push(...h(t.slice(e,r),m,n,g,a,i===c-1))}const v=2===f?",":"";y[0]="["+y[0]+v;for(let i=1;i<y.length-1;i++)y[i]=" "+y[i]+v;let x=",\n";for(let i=2;i<f;i++)x+="\n";return y[y.length-1]=" "+y[y.length-1]+"]"+(s?"":x),y}function p(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}var f=n("bb7b");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m{constructor(t,e,n){if(this.dtype=e,this.shape=t.slice(),this.size=a["O"](t),null!=n){const t=n.length;a["b"](t===this.size,()=>`Length of values '${t}' does not match the size inferred by the shape '${this.size}'.`)}if("complex64"===e)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||a["n"](e,this.size),this.strides=Object(a["j"])(t)}set(t,...e){0===e.length&&(e=[0]),a["b"](e.length===this.rank,()=>`The number of provided coordinates (${e.length}) must match the rank (${this.rank})`);const n=this.locToIndex(e);this.values[n]=t}get(...t){0===t.length&&(t=[0]);let e=0;for(const r of t){if(r<0||r>=this.shape[e]){const e=`Requested out of range element at ${t}.   Buffer shape=`+this.shape;throw new Error(e)}e++}let n=t[t.length-1];for(let r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return this.values[n]}locToIndex(t){if(0===this.rank)return 0;if(1===this.rank)return t[0];let e=t[t.length-1];for(let n=0;n<t.length-1;++n)e+=this.strides[n]*t[n];return e}indexToLoc(t){if(0===this.rank)return[];if(1===this.rank)return[t];const e=new Array(this.shape.length);for(let n=0;n<e.length-1;++n)e[n]=Math.floor(t/this.strides[n]),t-=e[n]*this.strides[n];return e[e.length-1]=t,e}get rank(){return this.shape.length}toTensor(){return g().makeTensor(this.values,this.shape,this.dtype)}}let g=null,b=null,y=null;function v(t){g=t}function x(t){b=t}function w(t){y=t}class k{constructor(t,e,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=e||"float32",this.size=a["O"](t),this.strides=Object(a["j"])(t),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const t=await this.data();return b.buffer(this.shape,this.dtype,t)}bufferSync(){return b.buffer(this.shape,this.dtype,this.dataSync())}async array(){const t=await this.data();return Object(a["U"])(this.shape,t,"complex64"===this.dtype)}arraySync(){return Object(a["U"])(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const t=g().read(this.dataId);if("string"===this.dtype){const n=await t;try{return n.map(t=>f["decodeString"](t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return t}dataToGPU(t){return this.throwIfDisposed(),g().readToGPU(this.dataId,t)}dataSync(){this.throwIfDisposed();const t=g().readSync(this.dataId);if("string"===this.dtype)try{return t.map(t=>f["decodeString"](t))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t}async bytes(){this.throwIfDisposed();const t=await g().read(this.dataId);return"string"===this.dtype?t:new Uint8Array(t.buffer)}dispose(){this.isDisposed||(g().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(t=!1){return b.print(this,t)}clone(){return this.throwIfDisposed(),b.clone(this)}toString(t=!1){const e=this.dataSync();return u(e,this.shape,this.dtype,t)}cast(t){return this.throwIfDisposed(),b.cast(this,t)}variable(t=!0,e,n){return this.throwIfDisposed(),g().makeVariable(this,t,e,n)}}function S(){return Object(r["a"])("Tensor",()=>k)}Object.defineProperty(k,Symbol.hasInstance,{value:t=>!!t&&null!=t.data&&null!=t.dataSync&&null!=t.throwIfDisposed}),S();class O extends k{constructor(t,e,n,r){super(t.shape,t.dtype,t.dataId,r),this.trainable=e,this.name=n}assign(t){if(t.dtype!==this.dtype)throw new Error(`dtype of the new value (${t.dtype}) and previous value (${this.dtype}) must match`);if(!a["a"](t.shape,this.shape))throw new Error(`shape of the new value (${t.shape}) and previous value (${this.shape}) must match`);g().disposeTensor(this),this.dataId=t.dataId,g().incRef(this,null)}dispose(){g().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(O,Symbol.hasInstance,{value:t=>t instanceof k&&null!=t.assign&&t.assign instanceof Function})},"4f50":function(t,e,n){var r=n("b760"),a=n("e538"),i=n("c8fe"),o=n("4359"),s=n("fa21"),u=n("d370"),c=n("6747"),l=n("dcbe"),d=n("0d24"),h=n("9520"),p=n("1a8c"),f=n("60ed"),m=n("73ac"),g=n("8adb"),b=n("8de2");function y(t,e,n,y,v,x,w){var k=g(t,n),S=g(e,n),O=w.get(S);if(O)r(t,n,O);else{var _=x?x(k,S,n+"",t,e,w):void 0,C=void 0===_;if(C){var T=c(S),I=!T&&d(S),N=!T&&!I&&m(S);_=S,T||I||N?c(k)?_=k:l(k)?_=o(k):I?(C=!1,_=a(S,!0)):N?(C=!1,_=i(S,!0)):_=[]:f(S)||u(S)?(_=k,u(k)?_=b(k):p(k)&&!h(k)||(_=s(S))):C=!1}C&&(w.set(S,_),v(_,S,y,x,w),w["delete"](S)),r(t,n,_)}}t.exports=y},"4f8b":function(t,e){},"4fa9":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}]},"4ffe":function(t,e,n){"use strict";n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return h}));var r=n("219b"),a=n("32fe"),i=n("4e56"),o=n("df00"),s=n("bb7b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=t;if(Object(o["A"])(t))return"string"===e?[]:[t.length];if(!Array.isArray(t))return[];const r=[];while(Array.isArray(n)||Object(o["A"])(n)&&"string"!==e)r.push(n.length),n=n[0];return Array.isArray(t)&&Object(a["c"])().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(t,r,[]),r}function c(t,e,n){if(n=n||[],!Array.isArray(t)&&!Object(o["A"])(t))return void Object(o["b"])(0===e.length,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);Object(o["b"])(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),Object(o["b"])(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let a=0;a<t.length;++a)c(t[a],r,n.concat(a))}function l(t,e,n,r){if("string_or_numeric"!==t){if(null==t)throw new Error("Expected dtype cannot be null.");if("numeric"!==t&&t!==e||"numeric"===t&&"string"===e)throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function d(t,e,n,a="numeric"){if(t instanceof i["a"])return l(a,t.dtype,e,n),t;let c=Object(o["r"])(t);if("string"!==c&&["bool","int32","float32"].indexOf(a)>=0&&(c=a),l(a,c,e,n),null==t||!Object(o["A"])(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t){const r=null==t?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const d=u(t,c);Object(o["A"])(t)||Array.isArray(t)||(t=[t]);const h=!0,p="string"!==c?Object(s["toTypedArray"])(t,c):Object(o["m"])(t,[],h);return r["a"].makeTensor(p,d,c)}function h(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);const a=t;return a.map((t,a)=>d(t,`${e}[${a}]`,n,r))}},5046:function(t,e){},"505f":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("7ddb");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class a extends r["a"]{split(t){return new i(this,t)}}class i extends a{constructor(t,e){super(),this.upstream=t,this.impl=new o(t,e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class o extends r["b"]{constructor(t,e){super(),this.upstream=t,this.separator=e,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const t=await this.upstream.next();if(t.done)return""!==this.carryover&&(this.outputQueue.push(this.carryover),this.carryover="",!0);const e=t.value.split(this.separator);e[0]=this.carryover+e[0];for(const n of e.slice(0,-1))this.outputQueue.push(n);return this.carryover=e[e.length-1],!0}}},"509f":function(t,e,n){"use strict";n.r(e),n.d(e,"TEST_EPSILON_FLOAT16",(function(){return u})),n.d(e,"expectArraysClose",(function(){return c})),n.d(e,"testEpsilon",(function(){return l})),n.d(e,"expectPromiseToFail",(function(){return h})),n.d(e,"expectArraysEqual",(function(){return p})),n.d(e,"expectNumbersClose",(function(){return f})),n.d(e,"expectValuesInRange",(function(){return g})),n.d(e,"expectArrayBuffersEqual",(function(){return b})),n.d(e,"encodeStrings",(function(){return y})),n.d(e,"createVideoElement",(function(){return v})),n.d(e,"play",(function(){return x}));var r=n("219b"),a=n("4ffe"),i=n("df00"),o=n("bb7b");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const s=.001,u=.1;function c(t,e,n){return null==n&&(n=l()),d(t,e,(t,e)=>m(t,e,n))}function l(){return 32===r["a"].backend.floatPrecision()?s:u}function d(t,e,n){let r=!0;if((Object(i["A"])(t)||Object(i["A"])(e))&&(r=!1),Object(i["A"])(t)&&Object(i["A"])(e)&&(r=!0),r){const n=t.constructor.name,r=e.constructor.name;if(n!==r)throw new Error(`Arrays are of different type. Actual: ${n}. Expected: `+r)}if(Array.isArray(t)&&Array.isArray(e)){const n=Object(a["c"])(t),r=Object(a["c"])(e);if(!Object(i["a"])(n,r))throw new Error(`Arrays have different shapes. Actual: [${n}]. Expected: [${r}]`)}const o=Object(i["A"])(t)?t:Object(i["m"])(t),s=Object(i["A"])(e)?e:Object(i["m"])(e);if(o.length!==s.length)throw new Error(`Arrays have different lengths actual: ${o.length} vs expected: ${s.length}.\nActual:   ${o}.\nExpected: ${s}.`);for(let a=0;a<s.length;++a){const t=o[a],e=s[a];if(!n(t,e))throw new Error(`Arrays differ: actual[${a}] = ${t}, expected[${a}] = ${e}.\nActual:   ${o}.\nExpected: ${s}.`)}"undefined"!==typeof expect&&expect().nothing()}function h(t,e){t().then(()=>e.fail(),()=>e()),"undefined"!==typeof expect&&expect().nothing()}function p(t,e){const n="string"===typeof e||"number"===typeof e||"boolean"===typeof e?[e]:e;return Object(i["z"])(t)||Object(i["z"])(t[0])||Object(i["z"])(e)||Object(i["z"])(e[0])?d(t,n,(t,e)=>t==e):d(t,e,(t,e)=>m(t,e,0))}function f(t,e,n){if(null==n&&(n=l()),!m(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);"undefined"!==typeof expect&&expect().nothing()}function m(t,e,n){return!isFinite(t)&&!isFinite(e)||!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function g(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function b(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function y(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?y(n):t[e]=Object(o["encodeString"])(n)}return t}function v(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(t=>{e.addEventListener("loadeddata",n=>t(e)),e.load()})}async function x(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}},"50d8":function(t,e){function n(t,e){var n=-1,r=Array(t);while(++n<t)r[n]=e(n);return r}t.exports=n},5232:function(t,e){},5265:function(t,e,n){(function(e){const{Transform:r}=n("d485"),a=e.from([239,187,191]);class o extends r{constructor(t={}){super({writableObjectMode:!0,...t});const e={};let n;for(let r in t)e[l(r)]=t[r];if(n=this.normalize(e))throw n;switch(e.record_delimiter){case"auto":e.record_delimiter=null;break;case"unix":e.record_delimiter="\n";break;case"mac":e.record_delimiter="\r";break;case"windows":e.record_delimiter="\r\n";break;case"ascii":e.record_delimiter="";break;case"unicode":e.record_delimiter="\u2028";break}this.options=e,this.state={stop:!1},this.info={records:0}}normalize(t){if(void 0===t.bom||null===t.bom||!1===t.bom)t.bom=!1;else if(!0!==t.bom)return new u("CSV_OPTION_BOOLEAN_INVALID_TYPE",["option `bom` is optional and must be a boolean value,","got "+JSON.stringify(t.bom)]);if(void 0===t.delimiter||null===t.delimiter)t.delimiter=",";else if(e.isBuffer(t.delimiter))t.delimiter=t.delimiter.toString();else if("string"!==typeof t.delimiter)return new u("CSV_OPTION_DELIMITER_INVALID_TYPE",["option `delimiter` must be a buffer or a string,","got "+JSON.stringify(t.delimiter)]);if(void 0===t.quote||null===t.quote)t.quote='"';else if(!0===t.quote)t.quote='"';else if(!1===t.quote)t.quote="";else if(e.isBuffer(t.quote))t.quote=t.quote.toString();else if("string"!==typeof t.quote)return new u("CSV_OPTION_QUOTE_INVALID_TYPE",["option `quote` must be a boolean, a buffer or a string,","got "+JSON.stringify(t.quote)]);if(void 0!==t.quoted&&null!==t.quoted||(t.quoted=!1),void 0!==t.quoted_empty&&null!==t.quoted_empty||(t.quoted_empty=void 0),void 0===t.quoted_match||null===t.quoted_match||!1===t.quoted_match?t.quoted_match=null:Array.isArray(t.quoted_match)||(t.quoted_match=[t.quoted_match]),t.quoted_match)for(let e of t.quoted_match){const t="string"===typeof e,n=e instanceof RegExp;if(!t&&!n)return Error("Invalid Option: quoted_match must be a string or a regex, got "+JSON.stringify(e))}if(void 0!==t.quoted_string&&null!==t.quoted_string||(t.quoted_string=!1),void 0!==t.eof&&null!==t.eof||(t.eof=!0),void 0===t.escape||null===t.escape)t.escape='"';else if(e.isBuffer(t.escape))t.escape=t.escape.toString();else if("string"!==typeof t.escape)return Error("Invalid Option: escape must be a buffer or a string, got "+JSON.stringify(t.escape));if(t.escape.length>1)return Error(`Invalid Option: escape must be one character, got ${t.escape.length} characters`);if(void 0!==t.header&&null!==t.header||(t.header=!1),t.columns=this.normalize_columns(t.columns),void 0!==t.quoted&&null!==t.quoted||(t.quoted=!1),void 0!==t.cast&&null!==t.cast||(t.cast={}),void 0!==t.cast.bigint&&null!==t.cast.bigint||(t.cast.bigint=t=>""+t),void 0!==t.cast.boolean&&null!==t.cast.boolean||(t.cast.boolean=t=>t?"1":""),void 0!==t.cast.date&&null!==t.cast.date||(t.cast.date=t=>""+t.getTime()),void 0!==t.cast.number&&null!==t.cast.number||(t.cast.number=t=>""+t),void 0!==t.cast.object&&null!==t.cast.object||(t.cast.object=t=>JSON.stringify(t)),void 0!==t.cast.string&&null!==t.cast.string||(t.cast.string=function(t){return t}),void 0===t.record_delimiter||null===t.record_delimiter)t.record_delimiter="\n";else if(e.isBuffer(t.record_delimiter))t.record_delimiter=t.record_delimiter.toString();else if("string"!==typeof t.record_delimiter)return Error("Invalid Option: record_delimiter must be a buffer or a string, got "+JSON.stringify(t.record_delimiter))}_transform(t,e,n){if(!0===this.state.stop)return;if(!Array.isArray(t)&&"object"!==typeof t)return this.state.stop=!0,n(Error("Invalid Record: expect an array or an object, got "+JSON.stringify(t)));if(0===this.info.records)if(Array.isArray(t)){if(!0===this.options.header&&!this.options.columns)return this.state.stop=!0,n(Error("Undiscoverable Columns: header option requires column option or object records"))}else void 0!==this.options.columns&&null!==this.options.columns||(this.options.columns=this.normalize_columns(Object.keys(t)));0===this.info.records&&(this.bom(),this.headers());try{this.emit("record",t,this.info.records)}catch(a){return this.state.stop=!0,this.emit("error",a)}let r;if(this.options.eof){if(r=this.stringify(t),void 0===r)return;r+=this.options.record_delimiter}else{if(r=this.stringify(t),void 0===r)return;(this.options.header||this.info.records)&&(r=this.options.record_delimiter+r)}this.info.records++,this.push(r),n()}_flush(t){0===this.info.records&&(this.bom(),this.headers()),t()}stringify(t,e=!1){if("object"!==typeof t)return t;const{columns:n,header:r}=this.options,a=[];if(Array.isArray(t)){n&&t.splice(n.length);for(let n=0;n<t.length;n++){const r=t[n],[i,o]=this.__cast(r,{index:n,column:n,records:this.info.records,header:e});if(i)return void this.emit("error",i);a[n]=[o,r]}}else if(n)for(let i=0;i<n.length;i++){const r=k(t,n[i].key),[o,s]=this.__cast(r,{index:i,column:n[i].key,records:this.info.records,header:e});if(o)return void this.emit("error",o);a[i]=[s,r]}else for(let s of t){const r=t[s],[o,u]=this.__cast(r,{index:i,column:n[i].key,records:this.info.records,header:e});if(o)return void this.emit("error",o);a.push([u,r])}let o="";for(let i=0;i<a.length;i++){let t,e,[n,r]=a[i];if("string"===typeof n)t=this.options;else if(c(n)){if(t=n,n=t.value,delete t.value,"string"!==typeof n&&void 0!==n&&null!==n)return void this.emit("error",Error("Invalid Casting Value: returned value must return a string, null or undefined, got "+JSON.stringify(n)));if(t={...this.options,...t},e=this.normalize(t))return void this.emit("error",e)}else{if(void 0!==n&&null!==n)return void this.emit("error",Error("Invalid Casting Value: returned value must return a string, an object, null or undefined, got "+JSON.stringify(n)));t=this.options}const{delimiter:s,escape:u,quote:l,quoted:d,quoted_empty:h,quoted_string:p,quoted_match:f,record_delimiter:m}=t;if(n){if("string"!==typeof n)return this.emit("error",Error("Formatter must return a string, null or undefined, got "+JSON.stringify(n))),null;const t=s.length&&n.indexOf(s)>=0,e=""!==l&&n.indexOf(l)>=0,a=n.indexOf(u)>=0&&u!==l,i=n.indexOf(m)>=0,c=p&&"string"===typeof r;let h=f&&f.filter(t=>"string"===typeof t?-1!==n.indexOf(t):t.test(n));h=h&&h.length>0;const g=!0===e||t||i||d||c||h;if(!0===g&&!0===a){const t="\\"===u?new RegExp(u+u,"g"):new RegExp(u,"g");n=n.replace(t,u+u)}if(!0===e){const t=new RegExp(l,"g");n=n.replace(t,u+l)}!0===g&&(n=l+n+l),o+=n}else(!0===h||""===r&&!0===p&&!1!==h)&&(o+=l+l);i!==a.length-1&&(o+=s)}return o}bom(){!0===this.options.bom&&this.push(a)}headers(){if(!1===this.options.header)return;if(void 0===this.options.columns)return;let t=this.options.columns.map(t=>t.header);t=this.options.eof?this.stringify(t,!0)+this.options.record_delimiter:this.stringify(t),this.push(t)}__cast(t,e){const n=typeof t;try{return"string"===n?[void 0,this.options.cast.string(t,e)]:"bigint"===n?[void 0,this.options.cast.bigint(t,e)]:"number"===n?[void 0,this.options.cast.number(t,e)]:"boolean"===n?[void 0,this.options.cast.boolean(t,e)]:t instanceof Date?[void 0,this.options.cast.date(t,e)]:"object"===n&&null!==t?[void 0,this.options.cast.object(t,e)]:[void 0,t,t]}catch(r){return[r]}}normalize_columns(t){if(void 0!==t&&null!==t){if("object"!==typeof t)throw Error('Invalid option "columns": expect an array or an object');if(Array.isArray(t)){const e=[];for(let n of t)if("string"===typeof n)e.push({key:n,header:n});else{if("object"!==typeof n||void 0===n||Array.isArray(n))throw Error("Invalid column definition: expect a string or an object");if(!n.key)throw Error('Invalid column definition: property "key" is required');void 0===n.header&&(n.header=n.key),e.push(n)}t=e}else{const e=[];for(let n in t)e.push({key:n,header:t[n]});t=e}return t}}}const s=function(){let t,e,n;for(let a in arguments){const r=arguments[a],i=typeof r;if(void 0===t&&Array.isArray(r))t=r;else if(void 0===e&&c(r))e=r;else{if(void 0!==n||"function"!==i)throw new u("CSV_INVALID_ARGUMENT",["Invalid argument:",`got ${JSON.stringify(r)} at index ${a}`]);n=r}}const r=new o(e);if(n){const t=[];r.on("readable",(function(){let e;while(null!==(e=this.read()))t.push(e)})),r.on("error",(function(t){n(t)})),r.on("end",(function(){n(void 0,t.join(""))}))}if(void 0!==t)if("function"===typeof setImmediate)setImmediate((function(){for(let e of t)r.write(e);r.end()}));else{for(let e of t)r.write(e);r.end()}return r};class u extends Error{constructor(t,n,...r){Array.isArray(n)&&(n=n.join(" ")),super(n),void 0!==Error.captureStackTrace&&Error.captureStackTrace(this,u),this.code=t;for(const a of r)for(const t in a){const n=a[t];this[t]=e.isBuffer(n)?n.toString():null==n?n:JSON.parse(JSON.stringify(n))}}}s.Stringifier=o,s.CsvError=u,t.exports=s;const c=function(t){return"object"===typeof t&&null!==t&&!Array.isArray(t)},l=function(t){return t.replace(/([A-Z])/g,(function(t,e){return"_"+e.toLowerCase()}))},d=".".charCodeAt(0),h=/\\(\\)?/g,p=RegExp("[^.[\\]]+|\\[(?:([^\"'][^[]*)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))","g"),f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,m=/^\w*$/,g=function(t){return Object.prototype.toString.call(t)},b=function(t,e){if(Array.isArray(t))return!1;const n=typeof t;return!("number"!==n&&"symbol"!==n&&"boolean"!==n&&t&&!y(t))||(m.test(t)||!f.test(t)||null!=e&&t in Object(e))},y=function(t){const e=typeof t;return"symbol"===e||"object"===e&&t&&"[object Symbol]"===g(t)},v=function(t){const e=[];return t.charCodeAt(0)===d&&e.push(""),t.replace(p,(function(t,n,r,a){let i=t;r?i=a.replace(h,"$1"):n&&(i=n.trim()),e.push(i)})),e},x=function(t,e){return Array.isArray(t)?t:b(t,e)?[t]:v(t)},w=function(t){if("string"===typeof t||y(t))return t;const e=""+t;return"0"==e&&1/t==-INFINITY?"-0":e},k=function(t,e){e=x(e,t);let n=0;const r=e.length;while(null!=t&&n<r)t=t[w(e[n++])];return n&&n===r?t:void 0}}).call(this,n("b639").Buffer)},5414:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Text=e.stringToArray=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("d777"),u=n("4546"),c=n("d777");function l(t){return Array.from(t)}e.stringToArray=l;var d,h="auto",p="center",f="justify",m="Change.konva",g="2d",b="-",y="left",v="text",x="Text",w="top",k="bottom",S="middle",O="normal",_="px ",C=" ",T="right",I="word",N="char",E="none",A="…",R=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],j=R.length;function D(t){return t.split(",").map((function(t){t=t.trim();var e=t.indexOf(" ")>=0,n=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!n&&(t='"'+t+'"'),t})).join(", ")}function F(){return d||(d=a.Util.createCanvasElement().getContext(g),d)}function M(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function P(t){t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function $(t){return t=t||{},t.fillLinearGradientColorStops||t.fillRadialGradientColorStops||t.fillPatternImage||(t.fill=t.fill||"black"),t}var L=function(t){function e(e){var n=t.call(this,$(e))||this;n._partialTextX=0,n._partialTextY=0;for(var r=0;r<j;r++)n.on(R[r]+m,n._setTextData);return n._setTextData(),n}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.textArr,n=e.length;if(this.text()){var r,a=this.padding(),i=this.fontSize(),o=this.lineHeight()*i,s=this.verticalAlign(),u=0,c=this.align(),d=this.getWidth(),h=this.letterSpacing(),m=this.fill(),g=this.textDecoration(),b=-1!==g.indexOf("underline"),v=-1!==g.indexOf("line-through"),x=0,w=(x=o/2,0),O=0;for(t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",S),t.setAttr("textAlign",y),s===S?u=(this.getHeight()-n*o-2*a)/2:s===k&&(u=this.getHeight()-n*o-2*a),t.translate(a,u+a),r=0;r<n;r++){w=0,O=0;var _,C,I,N=e[r],E=N.text,A=N.width,R=r!==n-1;if(t.save(),c===T?w+=d-A-2*a:c===p&&(w+=(d-A-2*a)/2),b&&(t.save(),t.beginPath(),t.moveTo(w,x+O+Math.round(i/2)),_=E.split(" ").length-1,C=0===_,I=c===f&&R&&!C?d-2*a:A,t.lineTo(w+Math.round(I),x+O+Math.round(i/2)),t.lineWidth=i/15,t.strokeStyle=m,t.stroke(),t.restore()),v&&(t.save(),t.beginPath(),t.moveTo(w,x+O),_=E.split(" ").length-1,C=0===_,I=c===f&&R&&!C?d-2*a:A,t.lineTo(w+Math.round(I),x+O),t.lineWidth=i/15,t.strokeStyle=m,t.stroke(),t.restore()),0!==h||c===f){_=E.split(" ").length-1;for(var j=l(E),D=0;D<j.length;D++){var F=j[D];" "===F&&r!==n-1&&c===f&&(w+=(d-2*a-A)/_),this._partialTextX=w,this._partialTextY=x+O,this._partialText=F,t.fillStrokeShape(this),w+=this.measureSize(F).width+h}}else this._partialTextX=w,this._partialTextY=x+O,this._partialText=E,t.fillStrokeShape(this);t.restore(),n>1&&(x+=o)}}},e.prototype._hitFunc=function(t){var e=this.getWidth(),n=this.getHeight();t.beginPath(),t.rect(0,0,e,n),t.closePath(),t.fillStrokeShape(this)},e.prototype.setText=function(t){var e=a.Util._isString(t)?t:null===t||void 0===t?"":t+"";return this._setAttr(v,e),this},e.prototype.getWidth=function(){var t=this.attrs.width===h||void 0===this.attrs.width;return t?this.getTextWidth()+2*this.padding():this.attrs.width},e.prototype.getHeight=function(){var t=this.attrs.height===h||void 0===this.attrs.height;return t?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height},e.prototype.getTextWidth=function(){return this.textWidth},e.prototype.getTextHeight=function(){return a.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},e.prototype.measureSize=function(t){var e,n=F(),r=this.fontSize();return n.save(),n.font=this._getContextFont(),e=n.measureText(t),n.restore(),{width:e.width,height:r}},e.prototype._getContextFont=function(){return s.Konva.UA.isIE?this.fontStyle()+C+this.fontSize()+_+this.fontFamily():this.fontStyle()+C+this.fontVariant()+C+(this.fontSize()+_)+D(this.fontFamily())},e.prototype._addTextLine=function(t){this.align()===f&&(t=t.trim());var e=this._getTextWidth(t);return this.textArr.push({text:t,width:e})},e.prototype._getTextWidth=function(t){var e=this.letterSpacing(),n=t.length;return F().measureText(t).width+(n?e*(n-1):0)},e.prototype._setTextData=function(){var t=this.text().split("\n"),e=+this.fontSize(),n=0,r=this.lineHeight()*e,a=this.attrs.width,i=this.attrs.height,o=a!==h&&void 0!==a,s=i!==h&&void 0!==i,u=this.padding(),c=a-2*u,l=i-2*u,d=0,p=this.wrap(),f=p!==E,m=p!==N&&f,g=this.ellipsis();this.textArr=[],F().font=this._getContextFont();for(var y=g?this._getTextWidth(A):0,v=0,x=t.length;v<x;++v){var w=t[v],k=this._getTextWidth(w);if(o&&k>c)while(w.length>0){var S=0,O=w.length,_="",T=0;while(S<O){var I=S+O>>>1,R=w.slice(0,I+1),j=this._getTextWidth(R)+y;j<=c?(S=I+1,_=R,T=j):O=I}if(!_)break;if(m){var D,M=w[_.length],P=M===C||M===b;D=P&&T<=c?_.length:Math.max(_.lastIndexOf(C),_.lastIndexOf(b))+1,D>0&&(S=D,_=_.slice(0,S),T=this._getTextWidth(_))}if(_=_.trimRight(),this._addTextLine(_),n=Math.max(n,T),d+=r,!f||s&&d+r>l){var $=this.textArr[this.textArr.length-1];if($&&g){var L=this._getTextWidth($.text+A)<c;L||($.text=$.text.slice(0,$.text.length-3)),this.textArr.splice(this.textArr.length-1,1),this._addTextLine($.text+A)}break}if(w=w.slice(S),w=w.trimLeft(),w.length>0&&(k=this._getTextWidth(w),k<=c)){this._addTextLine(w),d+=r,n=Math.max(n,k);break}}else this._addTextLine(w),d+=r,n=Math.max(n,k);if(s&&d+r>l)break}this.textHeight=e,this.textWidth=n},e.prototype.getStrokeScaleEnabled=function(){return!0},e}(o.Shape);e.Text=L,L.prototype._fillFunc=M,L.prototype._strokeFunc=P,L.prototype.className=x,L.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],c._registerNode(L),i.Factory.overWriteSetter(L,"width",u.getNumberOrAutoValidator()),i.Factory.overWriteSetter(L,"height",u.getNumberOrAutoValidator()),i.Factory.addGetterSetter(L,"fontFamily","Arial"),i.Factory.addGetterSetter(L,"fontSize",12,u.getNumberValidator()),i.Factory.addGetterSetter(L,"fontStyle",O),i.Factory.addGetterSetter(L,"fontVariant",O),i.Factory.addGetterSetter(L,"padding",0,u.getNumberValidator()),i.Factory.addGetterSetter(L,"align",y),i.Factory.addGetterSetter(L,"verticalAlign",w),i.Factory.addGetterSetter(L,"lineHeight",1,u.getNumberValidator()),i.Factory.addGetterSetter(L,"wrap",I),i.Factory.addGetterSetter(L,"ellipsis",!1,u.getBooleanValidator()),i.Factory.addGetterSetter(L,"letterSpacing",0,u.getNumberValidator()),i.Factory.addGetterSetter(L,"text","",u.getStringValidator()),i.Factory.addGetterSetter(L,"textDecoration",""),a.Collection.mapMethods(L)},5470:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","log","float32"),n={x:e};return r["a"].runKernel(a["Eb"],n)}const u=Object(o["b"])({log_:s})},5479:function(t,e,n){},"54eb":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","exp"),n={x:e};return r["a"].runKernel(a["cb"],n)}const u=Object(o["b"])({exp_:s})},5517:function(t,e){},"55a3":function(t,e){function n(t){return this.__data__.has(t)}t.exports=n},"565f":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){const n=Object(i["a"])(t,"x","tile","string_or_numeric");o["b"](n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},u={reps:e};return r["a"].runKernel(a["id"],s,u)}const c=Object(s["b"])({tile_:u})},5727:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e,n=!1,s=!1){let u=Object(o["a"])(t,"a","matMul"),c=Object(o["a"])(e,"b","matMul");[u,c]=Object(i["makeTypesMatch"])(u,c);const l={a:u,b:c},d={transposeA:n,transposeB:s};return r["a"].runKernel(a["s"],l,d)}const c=Object(s["b"])({matMul_:u})},"57a5":function(t,e,n){var r=n("91e9"),a=r(Object.keys,Object);t.exports=a},"57a7":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>Math.max(t,e)),s=Object(i["a"])(r["Maximum"],o),u={kernelName:r["Maximum"],backendName:"cpu",kernelFunc:s}},5825:function(t,e){},"585a":function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n("c8ba"))},"58b9":function(t,e,n){"use strict";n.d(e,"a",(function(){return y})),n.d(e,"b",(function(){return w}));n("df3a");var r=n("32fe"),a=n("df00"),i=n("ad8e"),o=n("6a9b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const s="/",u="tensorflowjs_models",c="info",l="model_topology",d="weight_specs",h="weight_data",p="model_metadata";function f(t){return{info:[u,t,c].join(s),topology:[u,t,l].join(s),weightSpecs:[u,t,d].join(s),weightData:[u,t,h].join(s),modelMetadata:[u,t,p].join(s)}}function m(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function g(t){const e=t.split(s);if(e.length<3)throw new Error("Invalid key format: "+t);return e.slice(1,e.length-1).join(s)}function b(t){return t.startsWith(y.URL_SCHEME)?t.slice(y.URL_SCHEME.length):t}class y{constructor(t){if(!Object(r["c"])().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=f(this.modelPath)}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Object(i["i"])(t);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(i["a"])(t.weightData));const e={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,signature:null!=t.signature?t.signature:void 0,userDefinedMetadata:null!=t.userDefinedMetadata?t.userDefinedMetadata:void 0,modelInitializer:null!=t.modelInitializer?t.modelInitializer:void 0,trainingConfig:null!=t.trainingConfig?t.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(e)),{modelArtifactsInfo:a}}catch(e){throw m(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const t=JSON.parse(this.LS.getItem(this.keys.info));if(null==t)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==t.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const e={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);e.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);e.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(null!=a){const t=JSON.parse(a);e.format=t.format,e.generatedBy=t.generatedBy,e.convertedBy=t.convertedBy,null!=t.signature&&(e.signature=t.signature),null!=t.userDefinedMetadata&&(e.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(e.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(e.trainingConfig=t.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return e.weightData=Object(i["b"])(o),e}}y.URL_SCHEME="localstorage://";const v=t=>Object(r["c"])().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(y.URL_SCHEME)?x(t.slice(y.URL_SCHEME.length)):null;function x(t){return new y(t)}o["a"].registerSaveRouter(v),o["a"].registerLoadRouter(v);class w{constructor(){Object(a["b"])(Object(r["c"])().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Object(a["b"])("undefined"===typeof window||"undefined"!==typeof window.localStorage,()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const t={},e=u+s,n=s+c;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(e)&&a.endsWith(n)){const e=g(a);t[e]=JSON.parse(this.LS.getItem(a))}}return t}async removeModel(t){t=b(t);const e=f(t);if(null==this.LS.getItem(e.info))throw new Error(`Cannot find model at path '${t}'`);const n=JSON.parse(this.LS.getItem(e.info));return m(e),n}}},5905:function(t,e,n){"use strict";n("d58a")},"5af0":function(t,e){},"5ba1":function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("2ca8"),a=n("8f1f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,n="float32"){if("complex64"===n){const n=i(t,e,"float32"),r=i(t,e,"float32");return Object(a["a"])({inputs:{real:n,imag:r},backend:t})}const o=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(e),n);return t.makeTensorInfo(e,n,o)}},"5c5c":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>{const n=t-e;return n*n}),s=Object(i["a"])(r["SquaredDifference"],o),u={kernelName:r["SquaredDifference"],backendName:"cpu",kernelFunc:s}},"5c5c0":function(t,e){},"5c69":function(t,e,n){var r=n("087d"),a=n("0621");function i(t,e,n,o,s){var u=-1,c=t.length;n||(n=a),s||(s=[]);while(++u<c){var l=t[u];e>0&&n(l)?e>1?i(l,e-1,n,o,s):r(s,l):o||(s[s.length]=l)}return s}t.exports=i},"5d5a":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Rect=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("d777"),u=n("4546"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.cornerRadius(),n=this.width(),r=this.height();if(t.beginPath(),e){var a=0,i=0,o=0,s=0;"number"===typeof e?a=i=o=s=Math.min(e,n/2,r/2):(a=Math.min(e[0]||0,n/2,r/2),i=Math.min(e[1]||0,n/2,r/2),s=Math.min(e[2]||0,n/2,r/2),o=Math.min(e[3]||0,n/2,r/2)),t.moveTo(a,0),t.lineTo(n-i,0),t.arc(n-i,i,i,3*Math.PI/2,0,!1),t.lineTo(n,r-s),t.arc(n-s,r-s,s,0,Math.PI/2,!1),t.lineTo(o,r),t.arc(o,r-o,o,Math.PI/2,Math.PI,!1),t.lineTo(0,a),t.arc(a,a,a,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,n,r);t.closePath(),t.fillStrokeShape(this)},e}(o.Shape);e.Rect=c,c.prototype.className="Rect",s._registerNode(c),i.Factory.addGetterSetter(c,"cornerRadius",0,u.getNumberOrArrayOfNumbersValidator(4)),a.Collection.mapMethods(c)},"5d75":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i,i=(0,r.regex)("email",a);e.default=i},"5db3":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"minLength",min:t},(function(e){return!(0,r.req)(e)||(0,r.len)(e)>=t}))};e.default=a},"5dbe":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("ae86"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){const n=Object(i["a"])(t,"a","logicalAnd","bool"),s=Object(i["a"])(e,"b","logicalAnd","bool");Object(o["assertAndGetBroadcastShape"])(n.shape,s.shape);const u={a:n,b:s};return r["a"].runKernel(a["Hb"],u)}const c=Object(s["b"])({logicalAnd_:u})},"5e1a":function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=n("8707").Buffer,i=n(12);function o(t,e,n){t.copy(e,n)}t.exports=function(){function t(){r(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";var e=this.head,n=""+e.data;while(e=e.next)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return a.alloc(0);var e=a.allocUnsafe(t>>>0),n=this.head,r=0;while(n)o(n.data,e,r),r+=n.data.length,n=n.next;return e},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},"5e2e":function(t,e,n){var r=n("28c9"),a=n("69d5"),i=n("b4c0"),o=n("fba5"),s=n("67ca");function u(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype["delete"]=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,t.exports=u},"5e33":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=Object(o["a"])(t,"base","pow"),s=Object(o["a"])(e,"exp","pow");[n,s]=Object(i["makeTypesMatch"])(n,s);const u={a:n,b:s};return r["a"].runKernel(a["kc"],u)}const c=Object(s["b"])({pow_:u})},"5ec0":function(t,e){},"5edf":function(t,e){function n(t,e,n){var r=-1,a=null==t?0:t.length;while(++r<a)if(n(e,t[r]))return!0;return!1}t.exports=n},"5f27":function(t,e,n){},"5f89":function(t,e){},6044:function(t,e,n){var r=n("0b07"),a=r(Object,"create");t.exports=a},"609e":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("df00"),o=n("086c"),s=n("f947"),u=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e,n,s,c,l="NHWC",d){i["b"](t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let h=t,p=e,f=!1;3===e.rank&&(f=!0,p=Object(u["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2]]),h=[1,t[0],t[1],t[2]]),i["b"](4===h.length,()=>"Error in conv2dDerInput: inShape must be length 4, but got length "+h.length+"."),i["b"](4===p.rank,()=>"Error in conv2dDerInput: dy must be rank 4, but got rank "+p.rank),i["b"](4===n.rank,()=>"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank);const m="NHWC"===l?h[3]:h[1],g="NHWC"===l?p.shape[3]:p.shape[1];i["b"](m===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${m}) must match input depth for filter ${n.shape[2]}.`),i["b"](g===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${g}) must match output depth for filter ${n.shape[3]}.`),o["a"]("conv2dDerInput",c,d);const b={dy:p,filter:n},y={strides:s,pad:c,dataFormat:l,dimRoundingMode:d,inputShape:h},v=r["a"].runKernel(a["F"],b,y);return f?Object(u["a"])(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const l=Object(s["b"])({conv2DBackpropInput_:c})},"60ed":function(t,e,n){var r=n("3729"),a=n("2dcb"),i=n("1310"),o="[object Object]",s=Function.prototype,u=Object.prototype,c=s.toString,l=u.hasOwnProperty,d=c.call(Object);function h(t){if(!i(t)||r(t)!=o)return!1;var e=a(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==d}t.exports=h},"60ee":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e){Array.isArray(t)||(t=[t]),t.forEach(t=>{null!=t&&r["util"].assert("complex64"!==t.dtype,()=>e+" does not support complex64 tensors in the CPU backend.")})}},6125:function(t,e,n){var r=n("1212"),a=n("b838"),i=n("a49e"),o=n("cae0"),s=n("7aec"),u=n("89ed"),c=n("a49d");c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,t.exports=c},61256:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n){const a=Object(r["buffer"])(n,t.dtype);for(let r=0;r<a.size;++r){const n=a.indexToLoc(r),i=n.slice(),o=i[0],s=i[2],u=e.locToIndex([o,s]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(a.values[r]=t.values[c])}return a}},6128:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("4e56"),a=n("df00");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e="float32",n){return e=e||"float32",a["c"](t),new r["b"](t,e,n)}},"614d":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e){const n=r["util"].getArrayFromDType("int32",t.length);for(let a=0;a<t.length;++a)n[a]=r["util"].fingerPrint64(t[a]).modulo(e).getLowBitsUnsigned();return n}},6235:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.regex)("alpha",/^[a-zA-Z]*$/);e.default=a},"627d":function(t,e){},"62e4":function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},"63a0":function(t,e,n){"use strict";n("e844")},6417:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"not"},(function(e,n){return!(0,r.req)(e)||!t.call(this,e,n)}))};e.default=a},"641f":function(t,e,n){"use strict";n.d(e,"c",(function(){return f})),n.d(e,"b",(function(){return m})),n.d(e,"a",(function(){return g})),n.d(e,"d",(function(){return b}));var r=n("ae86"),a=n("85d9"),i=n("fbe2"),o=n("0db7"),s=n("d76f"),u=n("0ae3"),c=n("b0f1"),l=n("3a0f"),d=n("8ab3"),h=n("aeae"),p=n("6c52");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function f(t,e,n){if(null==n||"linear"===n)return t;if("relu"===n)return Object(o["a"])(t,Object(h["a"])(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function m(t,e){let n=e;const a=r["getReductionAxes"](t.shape,e.shape);return a.length>0&&(n=Object(p["a"])(n,a)),Object(l["a"])(n,t.shape)}function g(t,e,n,r){if("linear"===e)return t;if("relu"===e)return Object(u["a"])(t);if("elu"===e)return Object(a["a"])(t);if("relu6"===e)return Object(c["a"])(t);if("prelu"===e)return Object(s["a"])(t,n);if("leakyrelu"===e)return Object(i["a"])(t,r);if("sigmoid"===e)return Object(d["a"])(t);throw new Error(`Unknown fused activation ${e}.`)}const b=(t,e)=>{const n=t>0;return!n||"linear"===e}},6428:function(t,e,n){var r=n("b4b0"),a=1/0,i=17976931348623157e292;function o(t){if(!t)return 0===t?t:0;if(t=r(t),t===a||t===-a){var e=t<0?-1:1;return e*i}return t===t?t:0}t.exports=o},"642a":function(t,e,n){var r=n("966f"),a=n("3bb4"),i=n("20ec");function o(t){var e=a(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}t.exports=o},"64db":function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var r;n.d(e,"a",(function(){return r})),function(t){t[t["NONE"]=0]="NONE",t[t["MEAN"]=1]="MEAN",t[t["SUM"]=2]="SUM",t[t["SUM_BY_NONZERO_WEIGHTS"]=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},"64fe":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}]},"656b":function(t,e,n){var r=n("e2e4"),a=n("f4d6");function i(t,e){e=r(e,t);var n=0,i=e.length;while(null!=t&&n<i)t=t[a(e[n++])];return n&&n==i?t:void 0}t.exports=i},"656e":function(t,e){},6645:function(t,e,n){"use strict";n.r(e),n.d(e,"array",(function(){return c})),n.d(e,"Dataset",(function(){return s})),n.d(e,"zip",(function(){return l})),n.d(e,"CSVDataset",(function(){return x})),n.d(e,"TextLineDataset",(function(){return p})),n.d(e,"csv",(function(){return A})),n.d(e,"func",(function(){return R})),n.d(e,"generator",(function(){return j})),n.d(e,"microphone",(function(){return F})),n.d(e,"webcam",(function(){return D})),n.d(e,"FileDataSource",(function(){return N})),n.d(e,"URLDataSource",(function(){return E})),n.d(e,"version_data",(function(){return M}));var r=n("2ca8"),a=n("6125"),i=n("7ddb"),o=n("4d7e");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class s{constructor(){this.size=null}batch(t,e=!0){const n=this;let a;return r["util"].assert(t>0,()=>"batchSize needs to be positive, but it is\n      "+t),a=this.size===1/0||null==this.size?this.size:e?Math.ceil(this.size/t):Math.floor(this.size/t),u(async()=>(await n.iterator()).columnMajorBatch(t,e,d),a)}concatenate(t){const e=this;let n;return n=this.size===1/0||t.size===1/0?1/0:null!=this.size&&null!=t.size?this.size+t.size:null,u(async()=>(await e.iterator()).concatenate(await t.iterator()),n)}filter(t){const e=this;let n;return n=this.size===1/0?1/0:null,u(async()=>(await e.iterator()).filter(e=>r["tidy"](()=>t(e))),n)}async forEachAsync(t){return(await this.iterator()).forEachAsync(t)}map(t){const e=this;return u(async()=>(await e.iterator()).map(e=>r["tidy"](()=>t(e))),this.size)}mapAsync(t){const e=this;return u(async()=>(await e.iterator()).mapAsync(t),this.size)}prefetch(t){if(null==t)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const e=this;return u(async()=>(await e.iterator()).prefetch(t),this.size)}repeat(t){const e=this;let n;return n=null!=this.size&&t>0?this.size*t:0===t?0:null!=this.size&&(void 0===t||t<0)?1/0:null,u(async()=>{const n=Object(i["e"])(async()=>({value:await e.iterator(),done:!1}));return Object(i["d"])(n.take(t))},n)}skip(t){const e=this;let n;return n=null!=this.size&&t>=0&&this.size>=t?this.size-t:null!=this.size&&(this.size<t||void 0===t||t<0)?0:null,u(async()=>(await e.iterator()).skip(t),n)}shuffle(t,e,n=!0){if(null==t||t<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const i=this,o=a["alea"](e||r["util"].now().toString());return u(async()=>{let e=o.int32();return n&&(e+=o.int32()),(await i.iterator()).shuffle(t,e.toString())},this.size)}take(t){const e=this;let n;return n=null!=this.size&&this.size>t?t:null!=this.size&&this.size<=t?this.size:null,u(async()=>(await e.iterator()).take(t),n)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}function u(t,e=null){return new class extends s{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function c(t){return u(async()=>Object(i["f"])(t),t.length)}function l(t){if(!Object(o["e"])(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=null==e?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=null==e?t[n].size:Math.min(e,t[n].size);return u(async()=>{const e=await Object(o["c"])(t,t=>{if(t instanceof s)return{value:t.iterator(),recurse:!1};if(Object(o["e"])(t))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return Object(i["g"])(e,i["c"].SHORTEST)},e)}function d(t){if(null===t)return null;const e=t[0];if(Object(o["a"])(e)){const e=h(t);return{value:e,recurse:!1}}return{value:null,recurse:!0}}function h(t){if(0===t.length)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof r["Tensor"]?r["stack"](t):r["tensor"](t)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */s.MAX_BUFFER_SIZE=1e4;class p extends s{constructor(t){super(),this.input=t}async iterator(){const t=await this.input.iterator(),e=t.decodeUTF8(),n=e.split("\n").map(t=>(t.endsWith("\r")&&(t=t.slice(0,-1)),t));return n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const f='"',m=Symbol("out"),g=Symbol("field"),b=Symbol("quote"),y=Symbol("quoteafterquote"),v=Symbol("quoteinquote");class x extends s{constructor(t,e){super(),this.input=t,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new p(t),e||(e={}),this.hasHeader=!1!==e.hasHeader,this.fullColumnNames=e.columnNames,this.columnConfigs=e.columnConfigs,this.configuredColumnsOnly=e.configuredColumnsOnly,e.delimWhitespace?(r["util"].assert(null==e.delimiter,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=e.delimiter?e.delimiter:","}async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const t=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!t)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&t&&r["util"].assert(t.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+t.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=t);const e=this.fullColumnNames.reduce((t,e)=>(t[e]=t[e]+1||1,t),{}),n=Object.keys(e).filter(t=>e[t]>1);if(r["util"].assert(0===n.length,()=>"Duplicate column names found: "+n.toString()),this.columnConfigs)for(const r of Object.keys(this.columnConfigs)){const t=this.fullColumnNames.indexOf(r);if(-1===t)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const t=await this.base.iterator(),e=await t.next();if(e.done)throw new Error("No data was found for CSV parsing.");const n=e.value,r=this.parseRow(n,!1);return r}return null}async iterator(){this.columnNamesValidated||await this.setColumnNames();let t=await this.base.iterator();return this.hasHeader&&(t=t.skip(1)),t.map(t=>this.makeDataElement(t))}makeDataElement(t){const e=this.parseRow(t),n={},r={};for(let a=0;a<this.fullColumnNames.length;a++){const i=this.fullColumnNames[a],o=this.columnConfigs?this.columnConfigs[i]:null;if(!this.configuredColumnsOnly||o){const s=e[a];let u=null;if(""===s)if(o&&void 0!==o.default)u=o.default;else{if(o&&(o.required||o.isLabel))throw new Error(`Required column ${i} is empty in this line: ${t}`);u=void 0}else{const t=Number(s);if(isNaN(t))u=o&&"bool"===o.dtype?this.getBoolean(s):s;else if(o&&o.dtype)switch(o.dtype){case"float32":u=t;break;case"int32":u=Math.floor(t);break;case"bool":u=this.getBoolean(s);break;default:u=t}else u=t}o&&o.isLabel?r[i]=u:n[i]=u}}return 0===Object.keys(r).length?n:{xs:n,ys:r}}getBoolean(t){return"1"===t||"true"===t.toLowerCase()?1:0}parseRow(t,e=!0){const n=[];let r=0;const a=t.length;let i=m;for(let o=0;o<a;o++)switch(i){case m:switch(t.charAt(o)){case f:r=o+1,i=b;break;case this.delimiter:if(r=o+1," "===this.delimiter&&this.delimWhitespace)break;n.push(""),i=m;break;default:i=g,r=o;break}break;case g:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o)),i=m,r=o+1;break;default:}break;case b:switch(t.charAt(o)){case f:i=y;break;default:}break;case y:switch(t.charAt(o)){case this.delimiter:n.push(t.substring(r,o-1)),i=m,r=o+1;break;case f:i=b;break;default:i=v;break}break;case v:switch(t.charAt(o)){case f:i=b;break;default:}break;default:}if(i===y?n.push(t.substring(r,a-1)):n.push(t.substring(r)),e&&n.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${n}`);return n}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class w extends i["a"]{constructor(t){super(),this.microphoneConfig=t,this.isClosed=!1,this.fftSize=t.fftSize||1024;const e=Math.log2(this.fftSize);if(this.fftSize<0||e<4||e>14||!Number.isInteger(e))throw new Error("Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got "+this.fftSize);if(this.numFrames=t.numFramesPerSpectrogram||43,this.sampleRateHz=t.sampleRateHz,this.columnTruncateLength=t.columnTruncateLength||this.fftSize,this.audioTrackConstraints=t.audioTrackConstraints,this.smoothingTimeConstant=t.smoothingTimeConstant||0,this.includeSpectrogram=!1!==t.includeSpectrogram,this.includeWaveform=!0===t.includeWaveform,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(t={}){if(!Object(r["env"])().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const e=new w(t);return await e.start(),e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:null==this.audioTrackConstraints||this.audioTrackConstraints,video:!1})}catch(n){throw new Error("Error thrown while initializing video stream: "+n.message)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const t=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new t,this.sampleRateHz){if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: `+this.audioContext.sampleRate)}else this.sampleRateHz=this.audioContext.sampleRate;const e=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=2*this.fftSize,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,e.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let t,e;const n=await this.getAudioData();if(this.includeSpectrogram){const e=this.flattenQueue(n.freqDataQueue);t=this.getTensorFromAudioDataArray(e,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const t=this.flattenQueue(n.timeDataQueue);e=this.getTensorFromAudioDataArray(t,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:t,waveform:e},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const t=[],e=[];let n=0;return new Promise(r=>{const a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:t,timeDataQueue:e}),t.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),e.push(this.timeData.slice())),++n===this.numFrames&&(clearInterval(a),r({freqDataQueue:t,timeDataQueue:e}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),null!=this.stream&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(t){const e=t[0].length,n=new Float32Array(t.length*e);return t.forEach((t,r)=>n.set(t,r*e)),n}getTensorFromAudioDataArray(t,e){const n=new Float32Array(r["util"].sizeFromShape(e));return n.set(t,n.length-t.length),Object(r["tensor"])(n,e)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class k extends i["a"]{constructor(t,e){if(super(),this.webcamVideoElement=t,this.webcamConfig=e,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Object(r["tensor1d"])([0],"int32"),this.webcamConfig.centerCrop){const t=1*this.webcamConfig.resizeWidth/this.webcamVideoElement.width,e=1*this.webcamConfig.resizeHeight/this.webcamVideoElement.height,n=(1-t)/2,a=(1-e)/2,i=n+t,o=e+a;this.cropBox=Object(r["tensor2d"])([a,n,o,i],[1,4])}else this.cropBox=Object(r["tensor2d"])([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(t,e={}){if(!Object(r["env"])().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!t){if(t=document.createElement("video"),!e.resizeWidth||!e.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");t.width=e.resizeWidth,t.height=e.resizeHeight}const n=new k(t,e);return await n.start(),n}async start(){this.webcamConfig.facingMode&&r["util"].assert("user"===this.webcamConfig.facingMode||"environment"===this.webcamConfig.facingMode,()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(t){throw t.message="Error thrown while initializing video stream: "+t.message,t}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(t=>{this.webcamVideoElement.onloadedmetadata=()=>{t()}})}async next(){if(this.isClosed)return{value:null,done:!0};let t;try{t=r["browser"].fromPixels(this.webcamVideoElement)}catch(e){throw new Error("Error thrown converting video to pixels: "+JSON.stringify(e))}if(!this.resize)return{value:t,done:!1};try{return{value:this.cropAndResizeFrame(t),done:!1}}catch(e){throw new Error("Error thrown cropping the video: "+e.message)}finally{t.dispose()}}needToResize(){return!(!this.webcamConfig.resizeWidth||!this.webcamConfig.resizeHeight||this.webcamVideoElement.width===this.webcamConfig.resizeWidth&&this.webcamVideoElement.height===this.webcamConfig.resizeHeight)}cropAndResizeFrame(t){return Object(r["tidy"])(()=>{const e=Object(r["expandDims"])(Object(r["cast"])(t,"float32"),0);let n;n=r["image"].cropAndResize(e,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const a=n.shape;return Object(r["reshape"])(n,a.slice(1))})}async capture(){return(await this.next()).value}stop(){const t=this.stream.getTracks();t.forEach(t=>t.stop());try{this.webcamVideoElement.srcObject=null}catch(e){console.log(e),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class S{}var O=n("7492");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class _ extends O["a"]{constructor(t,e={}){super(),this.file=t,this.options=e,r["util"].assert(t instanceof Uint8Array||!!Object(r["env"])().get("IS_BROWSER")&&(t instanceof File||t instanceof Blob),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=e.offset||0,this.chunkSize=e.chunkSize||1048576}summary(){return"FileChunks "+this.file}async next(){if(this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size))return{value:null,done:!0};const t=new Promise((t,e)=>{const n=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)t(new Uint8Array(this.file.slice(this.offset,n)));else{const r=new FileReader;r.onload=n=>{let a=r.result;if(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),!(a instanceof Uint8Array))return e(new TypeError("FileReader returned unknown type."));t(a)},r.onabort=t=>e(new Error("Aborted")),r.onerror=t=>e(new Error(t.type));const a=this.file.slice(this.offset,n);r.readAsArrayBuffer(a)}this.offset=n});return{value:await t,done:!1}}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function C(t,e={},n){let a,i;"string"===typeof t?a=t:(a=t.url,i=T(t));const o=await(n||r["util"].fetch)(a,i);if(o.ok){const t=new Uint8Array(await o.arrayBuffer());return new _(t,e)}throw new Error(o.statusText)}const T=t=>{const e={method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity};return e};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function I(t){return"string"===typeof t&&"file://"===t.slice(0,7)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class N extends S{constructor(t,e={}){super(),this.input=t,this.options=e}async iterator(){if(I(this.input)&&Object(r["env"])().get("IS_NODE")){const t=n(6);this.input=t.readFileSync(this.input.slice(7))}return new _(this.input,this.options)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class E extends S{constructor(t,e={}){super(),this.url=t,this.fileOptions=e}async iterator(){return I(this.url)?new N(this.url,this.fileOptions).iterator():C(this.url,this.fileOptions)}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function A(t,e={}){return new x(new E(t),e)}function R(t){const e=Object(i["e"])(t);return u(async()=>e)}function j(t){return u(async()=>{const e=await t();return Object(i["e"])(()=>e.next())})}async function D(t,e){return k.create(t,e)}async function F(t){return w.create(t)}
/** @license See the LICENSE file. */const M="3.21.0";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},6656:function(t,e,n){"use strict";n("70ed")},"66f3":function(t,e){},6732:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("60ee"),i=n("82b3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n,a){const[i,o]=r["backend_util"].computeOutAndReduceShapes(t,a),s=Object(r["upcastType"])(e,"int32"),u=r["util"].makeZerosTypedArray(r["util"].sizeFromShape(i),s),c=r["util"].sizeFromShape(o);for(let r=0;r<u.length;++r){const t=r*c;let e=1;for(let r=0;r<c;++r)e*=n[t+r];u[r]=e}return{outVals:u,outShape:i,outDtype:s}}function s(t){const{inputs:e,backend:n,attrs:s}=t,{x:u}=e,{axis:c,keepDims:l}=s;Object(a["a"])(u,"prod");const d=u.shape.length,h=r["util"].parseAxisParam(c,u.shape),p=r["backend_util"].getAxesPermutation(h,d);let f=h,m=u;const g=[];null!=p&&(m=Object(i["a"])({inputs:{x:u},backend:n,attrs:{perm:p}}),g.push(m),f=r["backend_util"].getInnerMostAxes(f.length,d));const b=n.data.get(m.dataId).values,{outVals:y,outShape:v,outDtype:x}=o(m.shape,m.dtype,b,f);let w=v;return l&&(w=r["backend_util"].expandShapeToKeepDim(v,h)),g.forEach(t=>n.disposeIntermediateTensorInfo(t)),n.makeTensorInfo(w,x,y)}const u={kernelName:r["Prod"],backendName:"cpu",kernelFunc:s}},6747:function(t,e){var n=Array.isArray;t.exports=n},"676b":function(t,e){},"67ca":function(t,e,n){var r=n("cb5a");function a(t,e){var n=this.__data__,a=r(n,t);return a<0?(++this.size,n.push([t,e])):n[a][1]=e,this}t.exports=a},"686b":function(t,e){},6877:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i){const o=r["util"].sizeFromShape(a),s=r["util"].makeZerosTypedArray(i,n);for(let r=0;r<t.length;r++){const n=t[r];if(n<0)throw new Error("Input x must be non-negative!");n>=i||(s[n]+=o>0?e[r]:1)}return s}function i(t,e,n,a=!1){const i=t.shape[0],o=t.shape[1],s=Object(r["buffer"])([i,n],e.dtype);for(let r=0;r<i;r++)for(let i=0;i<o;i++){const o=t.get(r,i);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(a?s.set(1,r,o):e.size>0?s.set(s.get(r,o)+e.get(r,i),r,o):s.set(s.get(r,o)+1,r,o))}return s}},6936:function(t,e,n){"use strict";n("3079")},"69d5":function(t,e,n){var r=n("cb5a"),a=Array.prototype,i=a.splice;function o(t){var e=this.__data__,n=r(e,t);if(n<0)return!1;var a=e.length-1;return n==a?e.pop():i.call(e,n,1),--this.size,!0}t.exports=o},"6a9b":function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s}));
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class r{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==r.instance&&(r.instance=new r),r.instance}static registerSaveRouter(t){r.getInstance().saveRouters.push(t)}static registerLoadRouter(t){r.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return r.getHandlers(t,"save")}static getLoadHandlers(t,e){return r.getHandlers(t,"load",e)}static getHandlers(t,e,n){const a=[],i="load"===e?r.getInstance().loadRouters:r.getInstance().saveRouters;return i.forEach(e=>{const r=e(t,n);null!==r&&a.push(r)}),a}}const a=t=>r.registerSaveRouter(t),i=t=>r.registerLoadRouter(t),o=t=>r.getSaveHandlers(t),s=(t,e)=>r.getLoadHandlers(t,e)},"6b7e":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Brighten=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n=255*this.brightness(),r=t.data,a=r.length;for(e=0;e<a;e+=4)r[e]+=n,r[e+1]+=n,r[e+2]+=n};e.Brighten=o,r.Factory.addGetterSetter(a.Node,"brightness",0,i.getNumberValidator(),r.Factory.afterSetFilter)},"6b80":function(t,e){},"6bfe":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return c}));var r=n("df00"),a=n("6a9b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i="://";class o{constructor(){this.managers={}}static getInstance(){return null==o.instance&&(o.instance=new o),o.instance}static registerManager(t,e){Object(r["b"])(null!=t,()=>"scheme must not be undefined or null."),t.endsWith(i)&&(t=t.slice(0,t.indexOf(i))),Object(r["b"])(t.length>0,()=>"scheme must not be an empty string.");const n=o.getInstance();Object(r["b"])(null==n.managers[t],()=>`A model store manager is already registered for scheme '${t}'.`),n.managers[t]=e}static getManager(t){const e=o.getInstance().managers[t];if(null==e)throw new Error(`Cannot find model manager for scheme '${t}'`);return e}static getSchemes(){return Object.keys(o.getInstance().managers)}}function s(t){if(-1===t.indexOf(i))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+o.getSchemes().join(","));return{scheme:t.split(i)[0],path:t.split(i)[1]}}async function u(t,e,n=!1){Object(r["b"])(t!==e,()=>`Old path and new path are the same: '${t}'`);const i=a["a"].getLoadHandlers(t);Object(r["b"])(i.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Object(r["b"])(i.length<2,()=>`Copying failed because more than one (${i.length}) load handlers for source URL ${t}.`);const u=i[0],c=a["a"].getSaveHandlers(e);Object(r["b"])(c.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Object(r["b"])(c.length<2,()=>`Copying failed because more than one (${i.length}) save handlers for destination URL ${e}.`);const l=c[0],d=s(t).scheme,h=s(t).path,p=d===s(t).scheme,f=await u.load();n&&p&&await o.getManager(d).removeModel(h);const m=await l.save(f);return n&&!p&&await o.getManager(d).removeModel(h),m.modelArtifactsInfo}async function c(){const t=o.getSchemes(),e={};for(const n of t){const t=await o.getManager(n).listModels();for(const r in t){const a=n+i+r;e[a]=t[r]}}return e}async function l(t){const e=s(t),n=o.getManager(e.scheme);return n.removeModel(e.path)}async function d(t,e){const n=!1;return u(t,e,n)}async function h(t,e){const n=!0;return u(t,e,n)}},"6c52":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("7b50"),s=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e=null,n=!1){let s=Object(i["a"])(t,"x","sum");"bool"===s.dtype&&(s=Object(o["a"])(s,"int32"));const u={x:s},c={axis:e,keepDims:n};return r["a"].runKernel(a["fd"],u,c)}const c=Object(s["b"])({sum_:u})},"6cb7":function(t,e,n){"use strict";n("fbe0")},"6cff":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n("219b"),a=n("fd3e"),i=n("388c"),o=n("4ffe"),s=n("df00"),u=n("d579"),c=n("2337"),l=n("ea03"),d=n("f947"),h=n("f4ee");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function p(t,e,n){const d=Object(o["a"])(t,"x","transpose");if(null==e&&(e=d.shape.map((t,e)=>e).reverse()),s["b"](d.rank===e.length,()=>`Error in transpose: rank of input ${d.rank} must match length of perm ${e}.`),e.forEach(t=>{s["b"](t>=0&&t<d.rank,()=>"All entries in 'perm' must be between 0 and "+(d.rank-1)+" but got "+e)}),d.rank<=1)return d.clone();const p={x:d},f={perm:e};return"complex64"===d.dtype?Object(a["t"])(()=>{let t=Object(h["a"])(d),e=Object(c["a"])(d);return t=r["a"].runKernel(i["ld"],{x:t},f),e=r["a"].runKernel(i["ld"],{x:e},f),n&&(e=Object(l["a"])(e)),Object(u["a"])(t,e)}):r["a"].runKernel(i["ld"],p,f)}const f=Object(d["b"])({transpose_:p})},"6d0f":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a){const i=r["util"].getTypedArrayFromDType(a,r["util"].sizeFromShape(n));for(let r=0;r<i.length;++r){const n=r*e;let a=t[n];for(let r=0;r<e;++r){const e=t[n+r];(Number.isNaN(e)||e>a)&&(a=e)}i[r]=a}return i}},"6fcd":function(t,e,n){var r=n("50d8"),a=n("d370"),i=n("6747"),o=n("0d24"),s=n("c098"),u=n("73ac"),c=Object.prototype,l=c.hasOwnProperty;function d(t,e){var n=i(t),c=!n&&a(t),d=!n&&!c&&o(t),h=!n&&!c&&!d&&u(t),p=n||c||d||h,f=p?r(t.length,String):[],m=f.length;for(var g in t)!e&&!l.call(t,g)||p&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,m))||f.push(g);return f}t.exports=d},7037:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t){return(e,n,a)=>{const i=r["util"].getTypedArrayFromDType(n,e.length);for(let r=0;r<e.length;++r)i[r]=t(e[r],a);return i}}},"70be":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e,n){const s=Object(i["a"])(t,"x","batchToSpaceND"),u=e.reduce((t,e)=>t*e);o["b"](s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),o["b"](n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),o["b"](s.shape[0]%u===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${u}`);const c={x:s},l={blockShape:e,crops:n};return r["a"].runKernel(a["t"],c,l)}const c=Object(s["b"])({batchToSpaceND_:u})},"70ed":function(t,e,n){},"72af":function(t,e,n){var r=n("99cd"),a=r();t.exports=a},"72f0":function(t,e){function n(t){return function(){return t}}t.exports=n},"734e":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t*e),s=Object(i["b"])((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),u=Object(i["a"])(r["Multiply"],o,s),c={kernelName:r["Multiply"],backendName:"cpu",kernelFunc:u}},"73ac":function(t,e,n){var r=n("743f"),a=n("b047"),i=n("99d3"),o=i&&i.isTypedArray,s=o?a(o):r;t.exports=s},"743f":function(t,e,n){var r=n("3729"),a=n("b218"),i=n("1310"),o="[object Arguments]",s="[object Array]",u="[object Boolean]",c="[object Date]",l="[object Error]",d="[object Function]",h="[object Map]",p="[object Number]",f="[object Object]",m="[object RegExp]",g="[object Set]",b="[object String]",y="[object WeakMap]",v="[object ArrayBuffer]",x="[object DataView]",w="[object Float32Array]",k="[object Float64Array]",S="[object Int8Array]",O="[object Int16Array]",_="[object Int32Array]",C="[object Uint8Array]",T="[object Uint8ClampedArray]",I="[object Uint16Array]",N="[object Uint32Array]",E={};function A(t){return i(t)&&a(t.length)&&!!E[r(t)]}E[w]=E[k]=E[S]=E[O]=E[_]=E[C]=E[T]=E[I]=E[N]=!0,E[o]=E[s]=E[v]=E[u]=E[x]=E[c]=E[l]=E[d]=E[h]=E[p]=E[f]=E[m]=E[g]=E[b]=E[y]=!1,t.exports=A},"744c":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","greater","string_or_numeric"),u=Object(o["a"])(e,"b","greater","string_or_numeric");[n,u]=Object(i["makeTypesMatch"])(n,u),Object(s["assertAndGetBroadcastShape"])(n.shape,u.shape);const c={a:n,b:u};return r["a"].runKernel(a["qb"],c)}const l=Object(u["b"])({greater_:c})},"748d":function(t,e){},7492:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var r=n("2ca8"),a=n("7ddb"),i=n("505f");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
class o extends a["a"]{decodeUTF8(){return new s(this)}}class s extends i["a"]{constructor(t){super(),this.upstream=t,this.impl=new u(t)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class u extends a["b"]{constructor(t){if(super(),this.upstream=t,Object(r["env"])().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:t}=n(5);this.decoder=new t("utf8")}}summary(){return this.upstream.summary()+" -> Utf8"}async pump(){const e=await this.upstream.next();let n,a;return!e.done&&(n=e.value,a=Object(r["env"])().get("IS_BROWSER")?this.decoder.decode(n,{stream:!0}):this.decoder.write(t.from(n.buffer)),this.outputQueue.push(a),!0)}}}).call(this,n("b639").Buffer)},7518:function(t,e){},7530:function(t,e,n){var r=n("1a8c"),a=Object.create,i=function(){function t(){}return function(e){if(!r(e))return{};if(a)return a(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=i},7591:function(t,e,n){
/*!
 * vue-konva v2.1.7 - https://github.com/konvajs/vue-konva#readme
 * MIT Licensed
 */
(function(e,r){t.exports=r(n("2b0e"),n("362d"))})(0,(function(t,e){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(e,n){e.exports=t},function(t,e,n){t.exports=n(3)},function(t,n){t.exports=e},function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r);function i(t){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}var o={key:!0,style:!0,elm:!0,isRootInsert:!0},s=".vue-konva-event";function u(t,e,n,r){void 0===e&&(e={}),void 0===n&&(n={});var a=t._konvaNode,u={},c=!1;for(var l in n)if(!o[l]){var d="on"===l.slice(0,2),h=n[l]!==e[l];if(d&&h){var p=l.substr(2).toLowerCase();"content"===p.substr(0,7)&&(p="content"+p.substr(7,1).toUpperCase()+p.substr(8)),a.off(p+s,n[l])}var f=!e.hasOwnProperty(l);f&&a.setAttr(l,void 0)}for(var m in e)if(!o[m]){var g="on"===m.slice(0,2),b=n[m]!==e[m];if(g&&b){var y=m.substr(2).toLowerCase();"content"===y.substr(0,7)&&(y="content"+y.substr(7,1).toUpperCase()+y.substr(8)),e[m]&&(a.off(y+s),a.on(y+s,e[m]))}!g&&(e[m]!==n[m]||r&&e[m]!==a.getAttr(m))&&(c=!0,u[m]=e[m])}c&&(a.setAttrs(u),i(a))}var c="v",l="_konvaNode";function d(t){var e={};return Object.keys(t).forEach((function(n){e["on"+n]=t[n]})),e}function h(t){function e(t){return t._konvaNode?t:t.$parent?e(t.$parent):{}}return e(t.$parent)}function p(t){return t?t.$options[l]?t.getNode():0===t.$children.length?null:p(t.$children[0]):null}function f(t,e){var n=!1,r=t.componentOptions.children||[],a=[];r.forEach((function(t){var e=p(t.componentInstance);e&&a.push(e);var n=t.elm,r=t.componentInstance;if(n&&n.tagName&&r&&!e){var i=n&&n.tagName.toLowerCase();console.error('vue-konva error: You are trying to render "'+i+'" inside your component tree. Looks like it is not a Konva node. You can render only Konva components inside the Stage.')}})),a.forEach((function(t,e){t.getZIndex()!==e&&(t.setZIndex(e),n=!0)})),n&&i(e)}function m(){return m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},m.apply(this,arguments)}var g=a.a.component("v-stage",{render:function(t){return t("div",this.$slots.default)},watch:{config:{handler:function(t){this.uploadKonva()},deep:!0}},props:{config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},created:function(){this._konvaNode=new window.Konva.Stage({width:this.config.width,height:this.config.height,container:document.createElement("div")})},mounted:function(){this.$el.innerHTML="",this._konvaNode.container(this.$el),this.uploadKonva(),this.validateChildren()},updated:function(){this.uploadKonva(),this.uploadKonva(),f(this.$vnode,this._konvaNode)},beforeDestroy:function(){this._konvaNode.destroy()},methods:{getNode:function(){return this._konvaNode},getStage:function(){return this._konvaNode},uploadKonva:function(){var t=this.oldProps||{},e=m({},this.$attrs,this.config,d(this.$listeners));u(this,e,t,this.__useStrictMode),this.oldProps=e},validateChildren:function(){}}});function b(){return b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b.apply(this,arguments)}var y=".vue-konva-event",v={Group:!0,Layer:!0,FastLayer:!0,Label:!0},x=function(t){var e;return e={},e[l]=!0,e.render=function(e){var n=v[t];return n?e("template",this.$slots.default):null},e.watch={config:{handler:function(t){this.uploadKonva()},deep:!0}},e.props={config:{type:Object,default:function(){return{}}},__useStrictMode:{type:Boolean}},e.created=function(){this.initKonva()},e.mounted=function(){var t=h(this),e=t._konvaNode;e.add(this._konvaNode),i(this._konvaNode)},e.updated=function(){this.uploadKonva(),f(this.$vnode,this._konvaNode)},e.destroyed=function(){i(this._konvaNode),this._konvaNode.destroy(),this._konvaNode.off(y)},e.methods={getNode:function(){return this._konvaNode},getStage:function(){return this._konvaNode},initKonva:function(){var e=window.Konva[t];e?(this._konvaNode=new e,this._konvaNode.VueComponent=this,this.uploadKonva()):console.error("vue-konva error: Can not find node "+t)},uploadKonva:function(){var t=this.oldProps||{},e=b({},this.$attrs,this.config,d(this.$listeners));u(this,e,t,this.__useStrictMode),this.oldProps=e}},e};"undefined"===typeof window||window.Konva||n(2);var w=["Layer","FastLayer","Group","Label","Rect","Circle","Ellipse","Wedge","Line","Sprite","Image","Text","TextPath","Star","Ring","Arc","Tag","Path","RegularPolygon","Arrow","Shape","Transformer"],k=[{name:"Stage",component:g}].concat(w.map((function(t){return{name:t,component:x(t)}}))),S={install:function(t,e){var n=c;e&&e.prefix&&(n=e.prefix),k.forEach((function(e){t.component(""+n+e.name,e.component)}))}};e["default"]=S;"undefined"!==typeof window&&window.Vue&&window.Vue.use(S)}])["default"]}))},"75d3":function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n("2ca8"),a=n("60ee"),i=n("d28e"),o=n("8f1f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n,s){return null==n?({inputs:n,backend:i})=>{const{a:o,b:u}=n,c=i;Object(a["a"])([o,u],t);const l=c.data.get(o.dataId).values,d=c.data.get(u.dataId).values,h="string"===o.dtype?r["backend_util"].fromUint8ToStringArray(l):l,p="string"===o.dtype?r["backend_util"].fromUint8ToStringArray(d):d,f=s||o.dtype,[m,g]=e(o.shape,u.shape,h,p,f);return c.makeTensorInfo(g,f,m)}:({inputs:t,backend:r})=>{const{a:a,b:u}=t,c=r;if("complex64"===a.dtype||"complex64"===u.dtype){const t=Object(i["a"])({inputs:{x:a},backend:c,attrs:{dtype:"complex64"}}),e=c.data.get(t.dataId),r=e.complexTensorInfos.real,s=e.complexTensorInfos.imag,l=c.data.get(r.dataId).values,d=c.data.get(s.dataId).values,h=Object(i["a"])({inputs:{x:u},backend:c,attrs:{dtype:"complex64"}}),p=c.data.get(h.dataId),f=p.complexTensorInfos.real,m=p.complexTensorInfos.imag,g=c.data.get(f.dataId).values,b=c.data.get(m.dataId).values,[y,v,x]=n(a.shape,u.shape,l,d,g,b),w=c.makeTensorInfo(x,"float32",y),k=c.makeTensorInfo(x,"float32",v),S=Object(o["a"])({inputs:{real:w,imag:k},backend:c});return c.disposeIntermediateTensorInfo(t),c.disposeIntermediateTensorInfo(h),c.disposeIntermediateTensorInfo(w),c.disposeIntermediateTensorInfo(k),S}{const t=c.data.get(a.dataId).values,n=c.data.get(u.dataId).values,r=s||a.dtype,[i,o]=e(a.shape,u.shape,t,n,r);return c.makeTensorInfo(o,r,i)}}}function u(t){return(e,n,a,i,o,s)=>{const u=r["backend_util"].assertAndGetBroadcastShape(e,n),c=r["util"].sizeFromShape(u),l=u.length,d=r["util"].computeStrides(u),h=r["util"].getTypedArrayFromDType("float32",c),p=r["util"].getTypedArrayFromDType("float32",c),f=r["backend_util"].getBroadcastDims(e,u),m=r["backend_util"].getBroadcastDims(n,u),g=r["backend_util"].mergeRealAndImagArrays(a,i),b=r["backend_util"].mergeRealAndImagArrays(o,s),y=e.length,v=r["util"].computeStrides(e),x=n.length,w=r["util"].computeStrides(n);if(f.length+m.length===0)for(let r=0;r<h.length;r++){const e=r%g.length,n=r%b.length,a=t(g[2*e],g[2*e+1],b[2*n],b[2*n+1]);h[r]=a.real,p[r]=a.imag}else for(let k=0;k<h.length;k++){const e=r["util"].indexToLoc(k,l,d),n=e.slice(-y);f.forEach(t=>n[t]=0);const a=r["util"].locToIndex(n,y,v),i=e.slice(-x);m.forEach(t=>i[t]=0);const o=r["util"].locToIndex(i,x,w),s=t(g[2*a],g[2*a+1],b[2*o],b[2*o+1]);h[k]=s.real,p[k]=s.imag}return[h,p,u]}}},"75d3e":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.sqrt(t)),s=Object(i["a"])(r["Sqrt"],t=>Math.sqrt(t)),u={kernelName:r["Sqrt"],backendName:"cpu",kernelFunc:s}},"769d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sepia=void 0;var r=function(t){var e,n,r,a,i=t.data,o=i.length;for(e=0;e<o;e+=4)n=i[e+0],r=i[e+1],a=i[e+2],i[e+0]=Math.min(255,.393*n+.769*r+.189*a),i[e+1]=Math.min(255,.349*n+.686*r+.168*a),i[e+2]=Math.min(255,.272*n+.534*r+.131*a)};e.Sepia=r},"76dd":function(t,e,n){var r=n("ce86");function a(t){return null==t?"":r(t)}t.exports=a},"772d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i,i=(0,r.regex)("url",a);e.default=i},7731:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return c}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t+e),s=Object(i["b"])((t,e,n,r)=>({real:t+n,imag:e+r})),u=Object(i["a"])(r["Add"],o,s),c={kernelName:r["Add"],backendName:"cpu",kernelFunc:u}},"775d":function(t,e){},"780f":function(t,e,n){"use strict";t.exports=i;var r=n("27bf"),a=Object.create(n("3a7c"));function i(t){if(!(this instanceof i))return new i(t);r.call(this,t)}a.inherits=n("3fb5"),a.inherits(i,r),i.prototype._transform=function(t,e,n){n(null,t)}},"78ef":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.req=e.regex=e.ref=e.len=void 0,Object.defineProperty(e,"withParams",{enumerable:!0,get:function(){return r.default}});var r=a(n("8750"));function a(t){return t&&t.__esModule?t:{default:t}}function i(t){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}var o=function(t){if(Array.isArray(t))return!!t.length;if(void 0===t||null===t)return!1;if(!1===t)return!0;if(t instanceof Date)return!isNaN(t.getTime());if("object"===i(t)){for(var e in t)return!0;return!1}return!!String(t).length};e.req=o;var s=function(t){return Array.isArray(t)?t.length:"object"===i(t)?Object.keys(t).length:String(t).length};e.len=s;var u=function(t,e,n){return"function"===typeof t?t.call(e,n):n[t]};e.ref=u;var c=function(t,e){return(0,r.default)({type:t},(function(t){return!o(t)||e.test(t)}))};e.regex=c},7948:function(t,e){function n(t,e){var n=-1,r=null==t?0:t.length,a=Array(r);while(++n<r)a[n]=e(t[n],n,t);return a}t.exports=n},7991:function(t,e){},"79bc":function(t,e,n){var r=n("0b07"),a=n("2b3e"),i=r(a,"Map");t.exports=i},"79ec":function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var r,a,i,o,s;n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),function(t){t["R0"]="R0",t["R1"]="R1",t["R2"]="R2",t["R3"]="R3",t["R4"]="R4",t["R5"]="R5",t["R6"]="R6"}(r||(r={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="int32",t["complex64"]="complex64"}(a||(a={})),function(t){t["float32"]="float32",t["int32"]="int32",t["bool"]="bool",t["complex64"]="complex64"}(i||(i={})),function(t){t["float32"]="float32",t["int32"]="float32",t["bool"]="float32",t["complex64"]="complex64"}(o||(o={})),function(t){t["float32"]="complex64",t["int32"]="complex64",t["bool"]="complex64",t["complex64"]="complex64"}(s||(s={}));const u={float32:o,int32:a,bool:i,complex64:s};function c(t,e){if("string"===t||"string"===e){if("string"===t&&"string"===e)return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return u[t][e]}function l(t){return c(t,"int32")}},"7a48":function(t,e,n){var r=n("6044"),a=Object.prototype,i=a.hasOwnProperty;function o(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}t.exports=o},"7aec":function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this;function n(t,e){var n,r,a,i,o,s=[],u=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,u=Math.max(u,e.length)),a=0,i=-32;i<u;++i)e&&(r^=e.charCodeAt((i+32)%e.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,n=s[127&i]^=r+o,a=0==n?a+1:0);for(a>=128&&(s[127&(e&&e.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;t.w=o,t.X=s,t.i=a}e.next=function(){var t,n,r=e.w,a=e.X,i=e.i;return e.w=r=r+1640531527|0,n=a[i+34&127],t=a[i=i+1&127],n^=n<<13,t^=t<<17,n^=n>>>15,t^=t>>>12,n=a[i]=n^t,e.i=i,n+(r^r>>>16)|0},n(e,t)}function s(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.xor4096=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},"7aed":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("f947"),o=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n,i,s,u=[1,1],c){let l=e,d=!1;3===e.rank&&(d=!0,l=Object(o["a"])(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const h={dy:l,filter:n},p={strides:i,pad:s,dimRoundingMode:c,dilations:u,inputShape:t},f=r["a"].runKernel(a["S"],h,p);return d?Object(o["a"])(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const u=Object(i["b"])({depthwiseConv2dNativeBackpropInput_:s})},"7b50":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){const n=Object(i["a"])(t,"x","cast");if(!o["B"](e))throw new Error("Failed to cast to unknown dtype "+e);if("string"===e&&"string"!==n.dtype||"string"!==e&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const s={x:n},u={dtype:e};return r["a"].runKernel(a["x"],s,u)}const c=Object(s["b"])({cast_:u})},"7b83":function(t,e,n){var r=n("7c64"),a=n("93ed"),i=n("2478"),o=n("a524"),s=n("1fc8");function u(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype["delete"]=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,t.exports=u},"7b97":function(t,e,n){var r=n("7e64"),a=n("a2be"),i=n("1c3c"),o=n("b1e5"),s=n("42a2"),u=n("6747"),c=n("0d24"),l=n("73ac"),d=1,h="[object Arguments]",p="[object Array]",f="[object Object]",m=Object.prototype,g=m.hasOwnProperty;function b(t,e,n,m,b,y){var v=u(t),x=u(e),w=v?p:s(t),k=x?p:s(e);w=w==h?f:w,k=k==h?f:k;var S=w==f,O=k==f,_=w==k;if(_&&c(t)){if(!c(e))return!1;v=!0,S=!1}if(_&&!S)return y||(y=new r),v||l(t)?a(t,e,n,m,b,y):i(t,e,w,n,m,b,y);if(!(n&d)){var C=S&&g.call(t,"__wrapped__"),T=O&&g.call(e,"__wrapped__");if(C||T){var I=C?t.value():t,N=T?e.value():e;return y||(y=new r),b(I,N,n,m,y)}}return!!_&&(y||(y=new r),o(t,e,n,m,b,y))}t.exports=b},"7c64":function(t,e,n){var r=n("e24b"),a=n("5e2e"),i=n("79bc");function o(){this.size=0,this.__data__={hash:new r,map:new(i||a),string:new r}}t.exports=o},"7cc1":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Solarize=void 0;var r=function(t){var e=t.data,n=t.width,r=t.height,a=4*n,i=r;do{var o=(i-1)*a,s=n;do{var u=o+4*(s-1),c=e[u],l=e[u+1],d=e[u+2];c>127&&(c=255-c),l>127&&(l=255-l),d>127&&(d=255-d),e[u]=c,e[u+1]=l,e[u+2]=d}while(--s)}while(--i)};e.Solarize=r},"7d1d":function(t,e,n){},"7d1f":function(t,e,n){var r=n("087d"),a=n("6747");function i(t,e,n){var i=e(t);return a(t)?i:r(i,n(t))}t.exports=i},"7d2a":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.releaseCapture=e.setPointerCapture=e.hasPointerCapture=e.createEvent=e.getCapturedShape=void 0;var r=n("d777"),a=new Map,i=void 0!==r.Konva._global["PointerEvent"];function o(t){return a.get(t)}function s(t){return{evt:t,pointerId:t.pointerId}}function u(t,e){return a.get(t)===e}function c(t,e){l(t);var n=e.getStage();n&&(a.set(t,e),i&&e._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function l(t,e){var n=a.get(t);if(n){var r=n.getStage();r&&r.content,a.delete(t),i&&n._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}}e.getCapturedShape=o,e.createEvent=s,e.hasPointerCapture=u,e.setPointerCapture=c,e.releaseCapture=l},"7d72":function(t,e,n){"use strict";var r=n("8707").Buffer,a=r.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(t){if(!t)return"utf8";var e;while(1)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function o(t){var e=i(t);if("string"!==typeof e&&(r.isEncoding===a||!a(t)))throw new Error("Unknown encoding: "+t);return e||t}function s(t){var e;switch(this.encoding=o(t),this.encoding){case"utf16le":this.text=f,this.end=m,e=4;break;case"utf8":this.fillLast=d,e=4;break;case"base64":this.text=g,this.end=b,e=3;break;default:return this.write=y,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function u(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function c(t,e,n){var r=e.length-1;if(r<n)return 0;var a=u(e[r]);return a>=0?(a>0&&(t.lastNeed=a-1),a):--r<n||-2===a?0:(a=u(e[r]),a>=0?(a>0&&(t.lastNeed=a-2),a):--r<n||-2===a?0:(a=u(e[r]),a>=0?(a>0&&(2===a?a=0:t.lastNeed=a-3),a):0))}function l(t,e,n){if(128!==(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!==(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!==(192&e[2]))return t.lastNeed=2,"�"}}function d(t){var e=this.lastTotal-this.lastNeed,n=l(this,t,e);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function h(t,e){var n=c(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)}function p(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function f(t,e){if((t.length-e)%2===0){var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function m(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function g(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function b(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function y(t){return t.toString(this.encoding)}function v(t){return t&&t.length?this.write(t):""}e.StringDecoder=s,s.prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},s.prototype.end=p,s.prototype.text=h,s.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},"7ddb":function(t,e,n){"use strict";n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"g",(function(){return f})),n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return C})),n.d(e,"c",(function(){return r}));var r,a=n("2ca8"),i=n("6125"),o=n("4d7e");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function s(t){return Object(o["b"])(t,u)}function u(t){return t instanceof a["Tensor"]?{value:t.clone(),recurse:!1}:Object(o["e"])(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class c{constructor(t){if(this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}wrap(t){while(t<0)t+=this.doubledCapacity;return t%this.doubledCapacity}get(t){if(t<0)throw new RangeError("Can't get item at a negative index.");return this.data[t%this.capacity]}set(t,e){if(t<0)throw new RangeError("Can't set item at a negative index.");this.data[t%this.capacity]=e}length(){let t=this.end-this.begin;return t<0&&(t=this.doubledCapacity+t),t}isFull(){return this.length()===this.capacity}isEmpty(){return 0===this.length()}push(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,t),this.end=this.wrap(this.end+1)}pushAll(t){for(const e of t)this.push(e)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const t=this.get(this.end);return this.set(this.end,void 0),t}unshift(t){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,t)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const t=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),t}shuffleExcise(t){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.wrap(this.begin+t),n=this.get(e);return this.set(e,this.pop()),n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class l extends c{constructor(){super(l.INITIAL_CAPACITY)}isFull(){return!1}push(t){super.isFull()&&this.expand(),super.push(t)}unshift(t){super.isFull()&&this.expand(),super.unshift(t)}expand(){const t=2*this.capacity,e=new Array(t),n=this.length();for(let r=0;r<n;r++)e[r]=this.get(this.wrap(this.begin+r));this.data=e,this.capacity=t,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
function d(t){return new g(t)}function h(t){return new b(t)}function p(t,e){return new I(t,e)}function f(t,e=r.FAIL){return new N(t,e)}l.INITIAL_CAPACITY=32;class m{async toArray(){const t=[];let e=await this.next();while(!e.done)t.push(e.value),e=await this.next();return t}async toArrayForTest(){const t=this.prefetch(100),e=[];let n=await t.next();while(!n.done)e.push(n.value),n=await t.next();return e}async resolveFully(){let t=await this.next();while(!t.done)t=await this.next()}async resolveWhile(t){let e=await this.next(),n=t(e.value);while(!e.done&&n)e=await this.next(),n=t(e.value)}handleErrors(t){return new O(this,t)}filter(t){return new k(this,t)}map(t){return new S(this,t)}mapAsync(t){return new _(this,t)}serialMapAsync(t){return new _(this,t).serial()}flatmap(t){return new T(this,t)}async forEachAsync(t){return this.map(t).resolveFully()}async serialForEach(t){return this.serialMapAsync(t).resolveWhile(t=>!0===t)}rowMajorBatch(t,e=!0){return new w(this,t,e)}columnMajorBatch(t,e=!0,n=o["f"]){const r=this.rowMajorBatch(t,e);return r.map(t=>Object(o["d"])(t,n))}concatenate(t,e){return new I(d([this,t]),e)}take(t){return t<0||null==t?this:new x(this,t)}skip(t){return t<0||null==t?this:new v(this,t)}prefetch(t){return new E(this,t)}shuffle(t,e){return new A(this,t,e)}serial(){return new y(this)}}class g extends m{constructor(t){super(),this.items=t,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const t=this.items[this.trav];return this.trav++,{value:s(t),done:!1}}}class b extends m{constructor(t){super(),this.nextFn=t}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(t){throw t.message="Error thrown while iterating through a dataset: "+t.message,t}}}class y extends m{constructor(t){super(),this.upstream=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Serial"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class v extends m{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Skip"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){while(this.count++<this.maxCount){const t=await this.upstream.next();if(t.done)return t;a["dispose"](t.value)}return this.upstream.next()}}class x extends m{constructor(t,e){super(),this.upstream=t,this.maxCount=e,this.count=0}summary(){return this.upstream.summary()+" -> Take"}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class w extends m{constructor(t,e,n=!0){super(),this.upstream=t,this.batchSize=e,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> RowMajorBatch"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const t=[];while(t.length<this.batchSize){const e=await this.upstream.next();if(e.done)return this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0};t.push(e.value)}return{value:t,done:!1}}}class k extends m{constructor(t,e){super(),this.upstream=t,this.predicate=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> Filter"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){while(1){const t=await this.upstream.next();if(t.done||this.predicate(t.value))return t;a["dispose"](t.value)}}}class S extends m{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Map"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=a["tensor_util"].getTensorsInContainer(t.value),n=this.transform(t.value),r=a["tensor_util"].getTensorsInContainer(n);for(const i of e)a["tensor_util"].isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class O extends m{constructor(t,e){super(),this.upstream=t,this.handler=e,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return this.upstream.summary()+" -> handleErrors"}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){while(1)try{return await this.upstream.next()}catch(t){if(!this.handler(t))return{value:null,done:!0}}}}class _ extends m{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> AsyncMap"}async next(){const t=await this.upstream.next();if(t.done)return{value:null,done:!0};const e=a["tensor_util"].getTensorsInContainer(t.value),n=await this.transform(t.value),r=a["tensor_util"].getTensorsInContainer(n);for(const i of e)a["tensor_util"].isTensorInList(i,r)||i.dispose();return{value:n,done:!1}}}class C extends m{constructor(){super(),this.outputQueue=new l,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){while(0===this.outputQueue.length())if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class T extends C{constructor(t,e){super(),this.upstream=t,this.transform=e}summary(){return this.upstream.summary()+" -> Flatmap"}async pump(){const t=await this.upstream.next();if(t.done)return!1;const e=a["tensor_util"].getTensorsInContainer(t.value),n=this.transform(t.value),r=a["tensor_util"].getTensorsInContainer(n);this.outputQueue.pushAll(n);for(const i of e)a["tensor_util"].isTensorInList(i,r)||i.dispose();return!0}}class I extends m{constructor(t,e){super(),this.baseErrorHandler=e,this.lastRead=null,this.iterator=null,this.moreIterators=t}summary(){const t="TODO: fill in upstream of chained summaries";return t+" -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(t){if(await t,null==this.iterator){const t=await this.moreIterators.next();if(t.done)return{value:null,done:!0};this.iterator=t.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const e=await this.iterator.next();return e.done?(this.iterator=null,this.readFromChain(t)):e}}(function(t){t[t["FAIL"]=0]="FAIL",t[t["SHORTEST"]=1]="SHORTEST",t[t["LONGEST"]=2]="LONGEST"})(r||(r={}));class N extends m{constructor(t,e=r.FAIL){super(),this.iterators=t,this.mismatchMode=e,this.count=0,this.currentPromise=null}summary(){const t="TODO: fill in upstream of zip summaries";return`{${t}} -> Zip`}async nextState(t){await t;let e=0,n=0;function a(t){if(t instanceof m){const r=t.next();return{value:r.then(t=>(e++,t.done&&n++,t.value)),recurse:!1}}return{value:null,recurse:!0}}const i=await Object(o["c"])(this.iterators,a);if(e===n)return{value:null,done:!0};if(n>0)switch(this.mismatchMode){case r.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case r.SHORTEST:return{value:null,done:!0};case r.LONGEST:default:}return this.count++,{value:i,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class E extends m{constructor(t,e){super(),this.upstream=t,this.bufferSize=e,this.buffer=new c(e)}summary(){return this.upstream.summary()+" -> Prefetch"}refill(){while(!this.buffer.isFull()){const t=this.upstream.next();this.buffer.push(t)}}next(){return this.refill(),this.buffer.shift()}}class A extends E{constructor(t,e,n){super(t,e),this.upstream=t,this.windowSize=e,this.upstreamExhausted=!1,this.random=i["alea"](n||a["util"].now().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(t){return Math.floor(this.random()*t)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){this.upstreamExhausted||this.refill();while(!this.buffer.isEmpty()){const t=this.chooseIndex(),e=await this.buffer.shuffleExcise(t);if(!e.done)return this.refill(),e;this.upstreamExhausted=!0}return{value:null,done:!0}}}},"7df4":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t>=e?1:0),s=Object(i["a"])(r["GreaterEqual"],o,null,"bool"),u={kernelName:r["GreaterEqual"],backendName:"cpu",kernelFunc:s}},"7e64":function(t,e,n){var r=n("5e2e"),a=n("efb6"),i=n("2fcc"),o=n("802a"),s=n("55a3"),u=n("d02c");function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=a,c.prototype["delete"]=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=u,t.exports=c},"7ed2":function(t,e){var n="__lodash_hash_undefined__";function r(t){return this.__data__.set(t,n),this}t.exports=r},"7eec":function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e=0){const n=Object(i["a"])(t,"x","unstack","string_or_numeric");o["b"](e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},u={axis:e};return r["a"].runKernel(a["nd"],s,u)}const c=Object(s["b"])({unstack_:u})},"802a":function(t,e){function n(t){return this.__data__.get(t)}t.exports=n},8284:function(t,e){},"82b3":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s}));var r=n("2ca8"),a=n("60ee"),i=n("e9cd");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t){const{inputs:e,attrs:n,backend:r}=t,{x:o}=e,{perm:s}=n;Object(a["a"])(o,"transpose");const u=o.shape.length,c=new Array(u);for(let a=0;a<c.length;a++)c[a]=o.shape[s[a]];const l=r.data.get(o.dataId).values,d=Object(i["a"])(l,o.shape,o.dtype,s,c),h=r.write(d,c,o.dtype);return{dataId:h,shape:c,dtype:o.dtype}}const s={kernelName:r["Transpose"],backendName:"cpu",kernelFunc:o}},8453:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n=0){const o=Object(i["a"])(t,"x","split"),s={x:o},u={numOrSizeSplits:e,axis:n};return r["a"].runKernel(a["Vc"],s,u)}const u=Object(o["b"])({split_:s})},"858d":function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("219b"),a=n("df00"),i=n("d579"),o=n("c879");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e="float32"){if("complex64"===e){const e=s(t,"float32"),n=Object(o["a"])(t,"float32");return Object(i["a"])(e,n)}const n=Object(a["D"])(Object(a["O"])(t),e);return r["a"].makeTensor(n,t,e)}},"85be":function(t,e){},"85d9":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","elu","float32"),n={x:e};return r["a"].runKernel(a["Y"],n)}const u=Object(o["b"])({elu_:s})},"85e3":function(t,e){function n(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}t.exports=n},8603:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Arc=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("d777"),u=n("4546"),c=n("d777"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=s.Konva.getAngle(this.angle()),n=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,n),t.arc(0,0,this.innerRadius(),e,0,!n),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(o.Shape);e.Arc=l,l.prototype._centroid=!0,l.prototype.className="Arc",l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],c._registerNode(l),i.Factory.addGetterSetter(l,"innerRadius",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"outerRadius",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"angle",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"clockwise",!1,u.getBooleanValidator()),a.Collection.mapMethods(l)},8604:function(t,e,n){var r=n("26e8"),a=n("e2c0");function i(t,e){return null!=t&&a(t,e,r)}t.exports=i},"86ab":function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(){return"undefined"!==typeof navigator&&null!=navigator}let a;function i(t){a=t}function o(t){if(void 0!==a)return a;if(t||r()){if(t||(t=navigator),"ReactNative"===t.product)return!0;const e=t.userAgent||t.vendor||("undefined"!==typeof window?window.opera:"");if(!e){const e=t;return e.userAgentData&&e.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function s(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(e),n.d(e,"mockIsMobile",(function(){return i})),n.d(e,"isMobile",(function(){return o})),n.d(e,"isBrowser",(function(){return s}))},8707:function(t,e,n){var r=n("b639"),a=r.Buffer;function i(t,e){for(var n in t)e[n]=t[n]}function o(t,e,n){return a(t,e,n)}a.from&&a.alloc&&a.allocUnsafe&&a.allocUnsafeSlow?t.exports=r:(i(r,e),e.Buffer=o),i(a,o),o.from=function(t,e,n){if("number"===typeof t)throw new TypeError("Argument must not be a number");return a(t,e,n)},o.alloc=function(t,e,n){if("number"!==typeof t)throw new TypeError("Argument must be a number");var r=a(t);return void 0!==e?"string"===typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},o.allocUnsafe=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return a(t)},o.allocUnsafeSlow=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},"872a":function(t,e,n){var r=n("3b4a");function a(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}t.exports=a},8750:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r="web"===Object({NODE_ENV:"production",BASE_URL:"/Re-Veil-CN/multilingual_motr/zh-test/"}).BUILD?n("cb69").withParams:n("0234").withParams,a=r;e.default=a},8820:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","sin","float32"),n={x:e};return r["a"].runKernel(a["Kc"],n)}const u=Object(o["b"])({sin_:s})},"88c8":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}]},"89c1":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Invert=void 0;var r=function(t){var e,n=t.data,r=n.length;for(e=0;e<r;e+=4)n[e]=255-n[e],n[e+1]=255-n[e+1],n[e+2]=255-n[e+2]};e.Invert=r},"89ed":function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this,n="";e.next=function(){var t=e.b,n=e.c,r=e.d,a=e.a;return t=t<<25^t>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-t|0,e.b=t=t<<20^t>>>12^n,e.c=n=n-r|0,e.d=r<<16^n>>>16^a,e.a=a-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):n+=t;for(var r=0;r<n.length+20;r++)e.b^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.tychei=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},"8a85":function(t,e,n){},"8ab3":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","sigmoid","float32"),n={x:e};return r["a"].runKernel(a["Ic"],n)}const u=Object(o["b"])({sigmoid_:s})},"8adb":function(t,e){function n(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}t.exports=n},"8b16":function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n("2ca8");
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n){t.forEach((t,a)=>{if(t<0||t>=n){const i=r["util"].indexToLoc(a,e.length,r["util"].computeStrides(e)).join(",");throw new Error(`indices[${i}] = ${t} is not in [0, ${n})`)}})}function i(t,e){for(let n=0;n<t.length;++n){const r=t[n],a=n===t.length-1?e:t[n+1].length;if(0===r.length)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let t=1;t<r.length;++t)if(r[t-1]>r[t])throw new Error("Ragged splits must be sorted in ascending order")}}function o(t,e,n,r){const a=[];let o=0;const s=e.length-1+n.length,u=new Array(s).fill(null).map(()=>[0]);i(n,r);let c=1;for(let i=0;i<e.length-1;++i){c*=e[i];const t=e[i+1];for(let e=1;e<c+1;++e)u[i].push(e*t)}for(let i=0;i<t.length;++i){let r=t[i],s=t[i]+1;for(let t=0;t<n.length;++t){const a=n[t],i=t+e.length-1;if(i>=0){const t=u[i],e=t[t.length-1]-a[r];for(let n=r;n<s;++n)u[i].push(a[n+1]+e)}r=a[r],s=a[s]}s!==r&&(a.push([r,s]),o+=s-r)}return{outSplits:u,valueSlices:a,numValues:o}}function s(t){const e=[];for(let n=0;n<t.length;++n){const a=t[n].length,i=r["util"].getArrayFromDType("int32",a);e.push(i),t[n].forEach((t,e)=>i[e]=t)}return e}function u(t,e){const n=t.slice(0,e);while(n.length<e)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function c(t,e,n,r,a,i){const o=u(e,2)[1],s=u(i,2)[1];let c=0;for(const u of n)for(let e=u[0];e<u[1];++e){for(let n=0;n<r;++n)a[c*s+n]=t[e*o+n];++c}}function l(t,e,n,a,i){const o=e.slice();o[0]=i;const s=r["util"].getArrayFromDType(n,r["util"].sizeFromShape(o)),u=t.length,l=0===u?0:u/e[0];return c(t,e,a,l,s,o),[s,o]}function d(t,e,n,r,i,u,c,d){if(0===t.length)throw new Error("paramsNestedSplits must be non empty");if(0===e[0].length)throw new Error("Split tensors must not be scalars");const h=e[0][0]-1;if(a(u,c,h),0===r.length)throw new Error("params.rank must be nonzero");const p=r[0],{outSplits:f,valueSlices:m,numValues:g}=o(u,c,t,p),b=s(f),y=l(n,r,i,m,g);return[b,y[0],y[1]]}},"8b74":function(t,e){},"8b87":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t>e?1:0),s=Object(i["a"])(r["Greater"],o,null,"bool"),u={kernelName:r["Greater"],backendName:"cpu",kernelFunc:s}},"8bc1":function(t){t.exports=JSON.parse('["aardvark","aardwolf","albatross","alligator","alpaca","anaconda","angelfish","ant","anteater","antelope","antlion","ape","aphid","arctic fox","arctic wolf","armadillo","baboon","badger","bald eagle","bandicoot","barnacle","basilisk","bass","bat","bear","beaver","bee","beetle","bird","bison","blackbird","blue bird","blue jay","blue whale","boa","boar","bobcat","bobolink","bonobo","buffalo","butterfly","camel","canary","capybara","cardinal","caribou","carp","cat","caterpillar","catfish","catshark","cattle","centipede","cephalopod","chameleon","cheetah","chickadee","chicken","chimpanzee","chinchilla","chipmunk","clam","clownfish","cod","condor","cougar","cow","coyote","crab","crane","crawdad","crayfish","cricket","crocodile","crow","cuckoo","deer","dingo","dinosaur","dog","dolphin","donkey","dove","dragon","dragonfly","duck","eagle","earthworm","echidna","eel","egret","elephant seal","elephant","elk","emu","ermine","falcon","ferret","finch","firefly","fish","flamingo","fly","flyingfish","fox","frog","fruit bat","gazelle","gecko","gerbil","gibbon","giraffe","goat","goldfish","goose","gopher","gorilla","grasshopper","great blue heron","guinea pig","guineafowl","gull","guppy","halibut","hamster","hare","hawk","hedgehog","hermit crab","heron","herring","hippopotamus","horse","hummingbird","humpback whale","hyena","iguana","impala","jackal","jaguar","jay","jellyfish","junglefowl","kangaroo mouse","kangaroo rat","kangaroo","kingfisher","kiwi","koala","komodo dragon","ladybug","lark","lemming","lemur","leopard","lion","lizard","llama","lobster","loon","lungfish","lynx","macaw","mackerel","magpie","mammal","manatee","mandrill","manta ray","marlin","marmoset","marmot","mastodon","meadowlark","meerkat","mink","minnow","mockingbird","mole","mollusk","mongoose","monitor lizard","monkey","moose","mosquito","moth","mountain goat","mouse","mule","muskox","narwhal","newt","nightingale","ocelot","octopus","opossum","orangutan","orca","ostrich","otter","owl","ox","panda","panther","parakeet","parrot","parrotfish","partridge","peacock","pelican","penguin","perch","peregrine falcon","pheasant","pig","pigeon","pike","pilot whale","platypus","polar bear","pony","porcupine","porpoise","possum","prairie dog","ptarmigan","puffin","puma","python","quail","rabbit","raccoon","rainbow trout","rattlesnake","raven","red panda","reindeer","reptile","rhinoceros","ringneck dove","roadrunner","robin","rodent","rooster","saber-toothed cat","sailfish","salamander","salmon","sawfish","scallop","scorpion","seahorse","sheep","shrew","shrimp","silkmoth","silkworm","silver fox","silverfish","skink","skunk","sloth","slug","snail","snake","snow leopard","sockeye salmon","sparrow","sperm whale","spider monkey","spider","spoonbill","squid","squirrel","star-nosed mole","starfish","steelhead trout","stingray","stoat","stork","sturgeon","sugar glider","swallow","swan","swift","swordfish","swordtail","tapir","tarantula","tern","thrush","tiger shark","tiger","toad","tortoise","toucan","tree frog","trout","tuna","turkey","turtle","tyrannosaurus","wallaby","walrus","warbler","water boa","water buffalo","weasel","whale","whitefish","whooping crane","wildcat","wildebeest","wolf","wolverine","wombat","woodpecker","worm","wren","x-ray fish","yak","yellow perch","zebra finch","zebra"]')},"8c15":function(t,e,n){},"8c18":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("d777"),u=function(t){function e(n){var r=t.call(this,n)||this;r.dataArray=[],r.pathLength=0,r.dataArray=e.parsePathData(r.data()),r.pathLength=0;for(var a=0;a<r.dataArray.length;++a)r.pathLength+=r.dataArray[a].pathLength;return r.on("dataChange.konva",(function(){this.dataArray=e.parsePathData(this.data()),this.pathLength=0;for(var t=0;t<this.dataArray.length;++t)this.pathLength+=this.dataArray[t].pathLength})),r}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.dataArray;t.beginPath();for(var n=!1,r=0;r<e.length;r++){var a=e[r].command,i=e[r].points;switch(a){case"L":t.lineTo(i[0],i[1]);break;case"M":t.moveTo(i[0],i[1]);break;case"C":t.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":t.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":var o=i[0],s=i[1],u=i[2],c=i[3],l=i[4],d=i[5],h=i[6],p=i[7],f=u>c?u:c,m=u>c?1:u/c,g=u>c?c/u:1;t.translate(o,s),t.rotate(h),t.scale(m,g),t.arc(0,0,f,l,l+d,1-p),t.scale(1/m,1/g),t.rotate(-h),t.translate(-o,-s);break;case"z":n=!0,t.closePath();break}}n||this.hasFill()?t.fillStrokeShape(this):t.strokeShape(this)},e.prototype.getSelfRect=function(){var t=[];this.dataArray.forEach((function(n){if("A"===n.command){var r=n.points[4],a=n.points[5],i=n.points[4]+a,o=Math.PI/180;if(Math.abs(r-i)<o&&(o=Math.abs(r-i)),a<0)for(var s=r-o;s>i;s-=o){var u=e.getPointOnEllipticalArc(n.points[0],n.points[1],n.points[2],n.points[3],s,0);t.push(u.x,u.y)}else for(s=r+o;s<i;s+=o){u=e.getPointOnEllipticalArc(n.points[0],n.points[1],n.points[2],n.points[3],s,0);t.push(u.x,u.y)}}else if("C"===n.command)for(s=0;s<=1;s+=.01){u=e.getPointOnCubicBezier(s,n.start.x,n.start.y,n.points[0],n.points[1],n.points[2],n.points[3],n.points[4],n.points[5]);t.push(u.x,u.y)}else t=t.concat(n.points)}));for(var n,r,a=t[0],i=t[0],o=t[1],s=t[1],u=0;u<t.length/2;u++)n=t[2*u],r=t[2*u+1],isNaN(n)||(a=Math.min(a,n),i=Math.max(i,n)),isNaN(r)||(o=Math.min(o,r),s=Math.max(s,r));return{x:Math.round(a),y:Math.round(o),width:Math.round(i-a),height:Math.round(s-o)}},e.prototype.getLength=function(){return this.pathLength},e.prototype.getPointAtLength=function(t){var n,r=0,a=this.dataArray.length;if(!a)return null;while(r<a&&t>this.dataArray[r].pathLength)t-=this.dataArray[r].pathLength,++r;if(r===a)return n=this.dataArray[r-1].points.slice(-2),{x:n[0],y:n[1]};if(t<.01)return n=this.dataArray[r].points.slice(0,2),{x:n[0],y:n[1]};var i=this.dataArray[r],o=i.points;switch(i.command){case"L":return e.getPointOnLine(t,i.start.x,i.start.y,o[0],o[1]);case"C":return e.getPointOnCubicBezier(t/i.pathLength,i.start.x,i.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return e.getPointOnQuadraticBezier(t/i.pathLength,i.start.x,i.start.y,o[0],o[1],o[2],o[3]);case"A":var s=o[0],u=o[1],c=o[2],l=o[3],d=o[4],h=o[5],p=o[6];return d+=h*t/i.pathLength,e.getPointOnEllipticalArc(s,u,c,l,d,p)}return null},e.getLineLength=function(t,e,n,r){return Math.sqrt((n-t)*(n-t)+(r-e)*(r-e))},e.getPointOnLine=function(t,e,n,r,a,i,o){void 0===i&&(i=e),void 0===o&&(o=n);var s=(a-n)/(r-e+1e-8),u=Math.sqrt(t*t/(1+s*s));r<e&&(u*=-1);var c,l=s*u;if(r===e)c={x:i,y:o+l};else if((o-n)/(i-e+1e-8)===s)c={x:i+u,y:o+l};else{var d,h,p=this.getLineLength(e,n,r,a),f=(i-e)*(r-e)+(o-n)*(a-n);f/=p*p,d=e+f*(r-e),h=n+f*(a-n);var m=this.getLineLength(i,o,d,h),g=Math.sqrt(t*t-m*m);u=Math.sqrt(g*g/(1+s*s)),r<e&&(u*=-1),l=s*u,c={x:d+u,y:h+l}}return c},e.getPointOnCubicBezier=function(t,e,n,r,a,i,o,s,u){function c(t){return t*t*t}function l(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function h(t){return(1-t)*(1-t)*(1-t)}var p=s*c(t)+i*l(t)+r*d(t)+e*h(t),f=u*c(t)+o*l(t)+a*d(t)+n*h(t);return{x:p,y:f}},e.getPointOnQuadraticBezier=function(t,e,n,r,a,i,o){function s(t){return t*t}function u(t){return 2*t*(1-t)}function c(t){return(1-t)*(1-t)}var l=i*s(t)+r*u(t)+e*c(t),d=o*s(t)+a*u(t)+n*c(t);return{x:l,y:d}},e.getPointOnEllipticalArc=function(t,e,n,r,a,i){var o=Math.cos(i),s=Math.sin(i),u={x:n*Math.cos(a),y:r*Math.sin(a)};return{x:t+(u.x*o-u.y*s),y:e+(u.x*s+u.y*o)}},e.parsePathData=function(t){if(!t)return[];var e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(var r=0;r<n.length;r++)e=e.replace(new RegExp(n[r],"g"),"|"+n[r]);var a,i=e.split("|"),o=[],s=[],u=0,c=0,l=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(r=1;r<i.length;r++){var d=i[r],h=d.charAt(0);d=d.slice(1),s.length=0;while(a=l.exec(d))s.push(a[0]);for(var p=[],f=0,m=s.length;f<m;f++){var g=parseFloat(s[f]);isNaN(g)?p.push(0):p.push(g)}while(p.length>0){if(isNaN(p[0]))break;var b,y,v,x,w,k,S,O,_,C,T=null,I=[],N=u,E=c;switch(h){case"l":u+=p.shift(),c+=p.shift(),T="L",I.push(u,c);break;case"L":u=p.shift(),c=p.shift(),I.push(u,c);break;case"m":var A=p.shift(),R=p.shift();if(u+=A,c+=R,T="M",o.length>2&&"z"===o[o.length-1].command)for(var j=o.length-2;j>=0;j--)if("M"===o[j].command){u=o[j].points[0]+A,c=o[j].points[1]+R;break}I.push(u,c),h="l";break;case"M":u=p.shift(),c=p.shift(),T="M",I.push(u,c),h="L";break;case"h":u+=p.shift(),T="L",I.push(u,c);break;case"H":u=p.shift(),T="L",I.push(u,c);break;case"v":c+=p.shift(),T="L",I.push(u,c);break;case"V":c=p.shift(),T="L",I.push(u,c);break;case"C":I.push(p.shift(),p.shift(),p.shift(),p.shift()),u=p.shift(),c=p.shift(),I.push(u,c);break;case"c":I.push(u+p.shift(),c+p.shift(),u+p.shift(),c+p.shift()),u+=p.shift(),c+=p.shift(),T="C",I.push(u,c);break;case"S":y=u,v=c,b=o[o.length-1],"C"===b.command&&(y=u+(u-b.points[2]),v=c+(c-b.points[3])),I.push(y,v,p.shift(),p.shift()),u=p.shift(),c=p.shift(),T="C",I.push(u,c);break;case"s":y=u,v=c,b=o[o.length-1],"C"===b.command&&(y=u+(u-b.points[2]),v=c+(c-b.points[3])),I.push(y,v,u+p.shift(),c+p.shift()),u+=p.shift(),c+=p.shift(),T="C",I.push(u,c);break;case"Q":I.push(p.shift(),p.shift()),u=p.shift(),c=p.shift(),I.push(u,c);break;case"q":I.push(u+p.shift(),c+p.shift()),u+=p.shift(),c+=p.shift(),T="Q",I.push(u,c);break;case"T":y=u,v=c,b=o[o.length-1],"Q"===b.command&&(y=u+(u-b.points[0]),v=c+(c-b.points[1])),u=p.shift(),c=p.shift(),T="Q",I.push(y,v,u,c);break;case"t":y=u,v=c,b=o[o.length-1],"Q"===b.command&&(y=u+(u-b.points[0]),v=c+(c-b.points[1])),u+=p.shift(),c+=p.shift(),T="Q",I.push(y,v,u,c);break;case"A":x=p.shift(),w=p.shift(),k=p.shift(),S=p.shift(),O=p.shift(),_=u,C=c,u=p.shift(),c=p.shift(),T="A",I=this.convertEndpointToCenterParameterization(_,C,u,c,S,O,x,w,k);break;case"a":x=p.shift(),w=p.shift(),k=p.shift(),S=p.shift(),O=p.shift(),_=u,C=c,u+=p.shift(),c+=p.shift(),T="A",I=this.convertEndpointToCenterParameterization(_,C,u,c,S,O,x,w,k);break}o.push({command:T||h,points:I,start:{x:N,y:E},pathLength:this.calcLength(N,E,T||h,I)})}"z"!==h&&"Z"!==h||o.push({command:"z",points:[],start:void 0,pathLength:0})}return o},e.calcLength=function(t,n,r,a){var i,o,s,u,c=e;switch(r){case"L":return c.getLineLength(t,n,a[0],a[1]);case"C":for(i=0,o=c.getPointOnCubicBezier(0,t,n,a[0],a[1],a[2],a[3],a[4],a[5]),u=.01;u<=1;u+=.01)s=c.getPointOnCubicBezier(u,t,n,a[0],a[1],a[2],a[3],a[4],a[5]),i+=c.getLineLength(o.x,o.y,s.x,s.y),o=s;return i;case"Q":for(i=0,o=c.getPointOnQuadraticBezier(0,t,n,a[0],a[1],a[2],a[3]),u=.01;u<=1;u+=.01)s=c.getPointOnQuadraticBezier(u,t,n,a[0],a[1],a[2],a[3]),i+=c.getLineLength(o.x,o.y,s.x,s.y),o=s;return i;case"A":i=0;var l=a[4],d=a[5],h=a[4]+d,p=Math.PI/180;if(Math.abs(l-h)<p&&(p=Math.abs(l-h)),o=c.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),d<0)for(u=l-p;u>h;u-=p)s=c.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],u,0),i+=c.getLineLength(o.x,o.y,s.x,s.y),o=s;else for(u=l+p;u<h;u+=p)s=c.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],u,0),i+=c.getLineLength(o.x,o.y,s.x,s.y),o=s;return s=c.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],h,0),i+=c.getLineLength(o.x,o.y,s.x,s.y),i}return 0},e.convertEndpointToCenterParameterization=function(t,e,n,r,a,i,o,s,u){var c=u*(Math.PI/180),l=Math.cos(c)*(t-n)/2+Math.sin(c)*(e-r)/2,d=-1*Math.sin(c)*(t-n)/2+Math.cos(c)*(e-r)/2,h=l*l/(o*o)+d*d/(s*s);h>1&&(o*=Math.sqrt(h),s*=Math.sqrt(h));var p=Math.sqrt((o*o*(s*s)-o*o*(d*d)-s*s*(l*l))/(o*o*(d*d)+s*s*(l*l)));a===i&&(p*=-1),isNaN(p)&&(p=0);var f=p*o*d/s,m=p*-s*l/o,g=(t+n)/2+Math.cos(c)*f-Math.sin(c)*m,b=(e+r)/2+Math.sin(c)*f+Math.cos(c)*m,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},v=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},x=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(v(t,e))},w=x([1,0],[(l-f)/o,(d-m)/s]),k=[(l-f)/o,(d-m)/s],S=[(-1*l-f)/o,(-1*d-m)/s],O=x(k,S);return v(k,S)<=-1&&(O=Math.PI),v(k,S)>=1&&(O=0),0===i&&O>0&&(O-=2*Math.PI),1===i&&O<0&&(O+=2*Math.PI),[g,b,o,s,w,O,c,i]},e}(o.Shape);e.Path=u,u.prototype.className="Path",u.prototype._attrsAffectingSize=["data"],s._registerNode(u),i.Factory.addGetterSetter(u,"data"),a.Collection.mapMethods(u)},"8d74":function(t,e,n){var r=n("4cef"),a=/^\s+/;function i(t){return t?t.slice(0,r(t)+1).replace(a,""):t}t.exports=i},"8db3":function(t,e,n){var r=n("47f5");function a(t,e){var n=null==t?0:t.length;return!!n&&r(t,e,0)>-1}t.exports=a},"8de2":function(t,e,n){var r=n("8eeb"),a=n("9934");function i(t){return r(t,a(t))}t.exports=i},"8df9":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","cos","float32"),n={x:e};return r["a"].runKernel(a["J"],n)}const u=Object(o["b"])({cos_:s})},"8e84":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RGB=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n,r=t.data,a=r.length,i=this.red(),o=this.green(),s=this.blue();for(e=0;e<a;e+=4)n=(.34*r[e]+.5*r[e+1]+.16*r[e+2])/255,r[e]=n*i,r[e+1]=n*o,r[e+2]=n*s,r[e+3]=r[e+3]};e.RGB=o,r.Factory.addGetterSetter(a.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),r.Factory.addGetterSetter(a.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),r.Factory.addGetterSetter(a.Node,"blue",0,i.RGBComponent,r.Factory.afterSetFilter)},"8eeb":function(t,e,n){var r=n("32b3"),a=n("872a");function i(t,e,n,i){var o=!n;n||(n={});var s=-1,u=e.length;while(++s<u){var c=e[s],l=i?i(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),o?a(n,c,l):r(n,c,l)}return n}t.exports=i},"8f1f":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64"),u=n.data.get(s.dataId);return u.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const i={kernelName:r["Complex"],backendName:"cpu",kernelFunc:a}},9140:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return i})),n.d(e,"f",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return d}));var r=n("2ca8");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,o){const s=e.inputParams[t];if(s&&void 0!==s.inputIndexStart){const t=s.inputIndexStart,u=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?t+1:s.inputIndexEnd;if("tensor"===s.type)return i(e.inputNames[s.inputIndexStart],n,a,o);if("tensors"===s.type){const r=e.inputNames.slice(t,u);return r.map(t=>i(t,n,a,o))}const c=i(e.inputNames.slice(t)[0],n,a,o),l=c.dataSync();return"number"===s.type?l[0]:r["util"].toNestedArray(c.shape,l)}const u=e.attrParams[t];return u&&u.value}function i(t,e,n,r){const[a,i]=c(t);if(null!=r){const t=r.getHashTableHandleByName(a);if(null!=t)return t}const o=n.currentContextIds.find(t=>!!e[u(a,t)]);return void 0!==o?e[u(a,o)][i]:void 0}function o(t,e,n){return e[u(t,n.currentContextId)]}function s(t,e){const[n,r,a]=c(t);return[u(n,e&&e.currentContextId),r,a]}function u(t,e){return e?`${t}-${e}`:t}function c(t){const e=t.split(":");if(1===e.length)return[t,0,void 0];const n=e[0],r=3===e.length?e[1]:void 0,a=Number(e[e.length-1]);return[n,a,r]}function l(t,e,n){let r=a("pad",t,e,n);if("explicit"===r){r=a("explicitPaddings",t,e,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let t=0;t<4;t++)i[t][0]=r[2*t],i[t][1]=r[2*t+1];return i}return r}function d(t){return t.kept?t:Object(r["clone"])(t)}},9152:function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,n,r,a){var i,o,s=8*a-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?a-1:0,h=n?-1:1,p=t[e+d];for(d+=h,i=p&(1<<-l)-1,p>>=-l,l+=s;l>0;i=256*i+t[e+d],d+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+t[e+d],d+=h,l-=8);if(0===i)i=1-c;else{if(i===u)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),i-=c}return(p?-1:1)*o*Math.pow(2,i-r)},e.write=function(t,e,n,r,a,i){var o,s,u,c=8*i-a-1,l=(1<<c)-1,d=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),e+=o+d>=1?h/u:h*Math.pow(2,1-d),e*u>=2&&(o++,u/=2),o+d>=l?(s=0,o=l):o+d>=1?(s=(e*u-1)*Math.pow(2,a),o+=d):(s=e*Math.pow(2,d-1)*Math.pow(2,a),o=0));a>=8;t[n+p]=255&s,p+=f,s/=256,a-=8);for(o=o<<a|s,c+=a;c>0;t[n+p]=255&o,p+=f,o/=256,c-=8);t[n+p-f]|=128*m}},9183:function(t,e,n){},"91d3":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:":";return(0,r.withParams)({type:"macAddress"},(function(e){if(!(0,r.req)(e))return!0;if("string"!==typeof e)return!1;var n="string"===typeof t&&""!==t?e.split(t):12===e.length||16===e.length?e.match(/.{2}/g):null;return null!==n&&(6===n.length||8===n.length)&&n.every(i)}))};e.default=a;var i=function(t){return t.toLowerCase().match(/^[0-9a-f]{2}$/)}},"91e9":function(t,e){function n(t,e){return function(n){return t(e(n))}}t.exports=n},9239:function(t,e,n){},"926b":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HSL=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546");r.Factory.addGetterSetter(a.Node,"hue",0,i.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"saturation",0,i.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"luminance",0,i.getNumberValidator(),r.Factory.afterSetFilter);var o=function(t){var e,n,r,a,i,o=t.data,s=o.length,u=1,c=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,d=127*this.luminance(),h=u*c*Math.cos(l*Math.PI/180),p=u*c*Math.sin(l*Math.PI/180),f=.299*u+.701*h+.167*p,m=.587*u-.587*h+.33*p,g=.114*u-.114*h-.497*p,b=.299*u-.299*h-.328*p,y=.587*u+.413*h+.035*p,v=.114*u-.114*h+.293*p,x=.299*u-.3*h+1.25*p,w=.587*u-.586*h-1.05*p,k=.114*u+.886*h-.2*p;for(e=0;e<s;e+=4)n=o[e+0],r=o[e+1],a=o[e+2],i=o[e+3],o[e+0]=f*n+m*r+g*a+d,o[e+1]=b*n+y*r+v*a+d,o[e+2]=x*n+w*r+k*a+d,o[e+3]=i};e.HSL=o},9315:function(t,e){},"93ed":function(t,e,n){var r=n("4245");function a(t){var e=r(this,t)["delete"](t);return this.size-=e?1:0,e}t.exports=a},9470:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mask=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546");function o(t,e,n){var r=4*(n*t.width+e),a=[];return a.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),a}function s(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function u(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function c(t,e){var n=o(t,0,0),r=o(t,t.width-1,0),a=o(t,0,t.height-1),i=o(t,t.width-1,t.height-1),c=e||10;if(s(n,r)<c&&s(r,i)<c&&s(i,a)<c&&s(a,n)<c){for(var l=u([r,n,i,a]),d=[],h=0;h<t.width*t.height;h++){var p=s(l,[t.data[4*h],t.data[4*h+1],t.data[4*h+2]]);d[h]=p<c?0:255}return d}}function l(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function d(t,e,n){for(var r=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var u=0;u<e;u++){for(var c=s*e+u,l=0,d=0;d<a;d++)for(var h=0;h<a;h++){var p=s+d-i,f=u+h-i;if(p>=0&&p<n&&f>=0&&f<e){var m=p*e+f,g=r[d*a+h];l+=t[m]*g}}o[c]=2040===l?255:0}return o}function h(t,e,n){for(var r=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var u=0;u<e;u++){for(var c=s*e+u,l=0,d=0;d<a;d++)for(var h=0;h<a;h++){var p=s+d-i,f=u+h-i;if(p>=0&&p<n&&f>=0&&f<e){var m=p*e+f,g=r[d*a+h];l+=t[m]*g}}o[c]=l>=1020?255:0}return o}function p(t,e,n){for(var r=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var u=0;u<e;u++){for(var c=s*e+u,l=0,d=0;d<a;d++)for(var h=0;h<a;h++){var p=s+d-i,f=u+h-i;if(p>=0&&p<n&&f>=0&&f<e){var m=p*e+f,g=r[d*a+h];l+=t[m]*g}}o[c]=l}return o}var f=function(t){var e=this.threshold(),n=c(t,e);return n&&(n=d(n,t.width,t.height),n=h(n,t.width,t.height),n=p(n,t.width,t.height),l(t,n)),t};e.Mask=f,r.Factory.addGetterSetter(a.Node,"threshold",0,i.getNumberValidator(),r.Factory.afterSetFilter)},9489:function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return o}));
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r={};function a(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};r[t]=n}function i(t){return r[t]}function o(t){delete r[t]}},"950a":function(t,e,n){var r=n("30c9");function a(t,e){return function(n,a){if(null==n)return n;if(!r(n))return t(n,a);var i=n.length,o=e?i:-1,s=Object(n);while(e?o--:++o<i)if(!1===a(s[o],o,s))break;return n}}t.exports=a},9520:function(t,e,n){var r=n("3729"),a=n("1a8c"),i="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",u="[object Proxy]";function c(t){if(!a(t))return!1;var e=r(t);return e==o||e==s||e==i||e==u}t.exports=c},"959e":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.expm1(t)),s=Object(i["b"])(r["Expm1"],o),u={kernelName:r["Expm1"],backendName:"cpu",kernelFunc:s}},9638:function(t,e){function n(t,e){return t===e||t!==t&&e!==e}t.exports=n},"966d":function(t,e,n){"use strict";(function(e){function n(t,n,r,a){if("function"!==typeof t)throw new TypeError('"callback" argument must be a function');var i,o,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick((function(){t.call(null,n)}));case 3:return e.nextTick((function(){t.call(null,n,r)}));case 4:return e.nextTick((function(){t.call(null,n,r,a)}));default:i=new Array(s-1),o=0;while(o<i.length)i[o++]=arguments[o];return e.nextTick((function(){t.apply(null,i)}))}}"undefined"===typeof e||!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:n}:t.exports=e}).call(this,n("4362"))},"966f":function(t,e,n){var r=n("7e64"),a=n("c05f"),i=1,o=2;function s(t,e,n,s){var u=n.length,c=u,l=!s;if(null==t)return!c;t=Object(t);while(u--){var d=n[u];if(l&&d[2]?d[1]!==t[d[0]]:!(d[0]in t))return!1}while(++u<c){d=n[u];var h=d[0],p=t[h],f=d[1];if(l&&d[2]){if(void 0===p&&!(h in t))return!1}else{var m=new r;if(s)var g=s(p,f,h,t,e,m);if(!(void 0===g?a(f,p,i|o,s,m):g))return!1}}return!0}t.exports=s},"969e":function(t,e){},"96d8":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","zerosLike"),n={x:e};return r["a"].runKernel(a["qd"],n)}const u=Object(o["b"])({zerosLike_:s})},"96ee":function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Wedge=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("d777"),u=n("4546"),c=n("d777"),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.radius(),0,s.Konva.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.radius()},e.prototype.getHeight=function(){return 2*this.radius()},e.prototype.setWidth=function(t){this.radius(t/2)},e.prototype.setHeight=function(t){this.radius(t/2)},e}(o.Shape);e.Wedge=l,l.prototype.className="Wedge",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["radius"],c._registerNode(l),i.Factory.addGetterSetter(l,"radius",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"angle",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"clockwise",!1),i.Factory.backCompat(l,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),a.Collection.mapMethods(l)},"97b1":function(t,e,n){"use strict";n.r(e),n.d(e,"validateUpdateShape",(function(){return a})),n.d(e,"validateInput",(function(){return i})),n.d(e,"calculateShapes",(function(){return o}));var r=n("df00");function a(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+`, indices.shape: ${e.shape}, shape: ${t}`+`, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(t.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+t.length-r)throw new Error(i+" update.rank != "+(a+t.length-r));for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${t[o+a]})`)}function i(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if("int32"!==e.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+e.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===e.size)throw new Error("Indices specified for empty output. indices shape: "+e.shape);if(0===t.size)throw new Error("Updates specified for empty output. updates shape: "+t.shape)}a(n,e,t)}function o(t,e,n){const a=e.shape.length,i=a>1?e.shape[a-1]:1,o=n.length;let s=1;for(let r=i;r<o;++r)s*=n[r];const u=i<1?1:i,c=Object(r["O"])(e.shape)/u,l=[...Object(r["j"])(n.slice(0,i)),1],d=Object(r["O"])(n);return{sliceRank:i,numUpdates:c,sliceSize:s,strides:l,outputSize:d}}},"97ca":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return d}));var r=n("df00");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function i(t,e,n){const r=t.length+e.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)-1===n.indexOf(s)?a.push(t[i++]):a.push(e[o++]);return a}function o(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)-1===e.indexOf(i)&&n.push(t[i]);const a=e.map(e=>t[e]);return[n,a]}function s(t,e){const n=e.map(t=>1);return i(t,n,e)}function u(t,e,n){r["b"](a(e,n),()=>t+" supports only inner-most axes for now. "+`Got axes ${e} and rank-${n} input.`)}function c(t,e){if(a(t,e))return null;const n=[];for(let r=0;r<e;++r)-1===t.indexOf(r)&&n.push(r);return t.forEach(t=>n.push(t)),n}function l(t){return t.map((t,e)=>[e,t]).sort((t,e)=>t[1]-e[1]).map(t=>t[0])}function d(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}},"97d3":function(t,e,n){var r=n("48a0"),a=n("30c9");function i(t,e){var n=-1,i=a(t)?Array(t.length):[];return r(t,(function(t,r,a){i[++n]=e(t,r,a)})),i}t.exports=i},9934:function(t,e,n){var r=n("6fcd"),a=n("41c3"),i=n("30c9");function o(t){return i(t)?r(t,!0):a(t)}t.exports=o},"99cd":function(t,e){function n(t){return function(e,n,r){var a=-1,i=Object(e),o=r(e),s=o.length;while(s--){var u=o[t?s:++a];if(!1===n(i[u],u,i))break}return e}}t.exports=n},"99d3":function(t,e,n){(function(t){var r=n("585a"),a=e&&!e.nodeType&&e,i=a&&"object"==typeof t&&t&&!t.nodeType&&t,o=i&&i.exports===a,s=o&&r.process,u=function(){try{var t=i&&i.require&&i.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(e){}}();t.exports=u}).call(this,n("62e4")(t))},"9a90":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},"9ad2":function(t,e,n){"use strict";n("17a9")},"9aff":function(t,e,n){var r=n("9638"),a=n("30c9"),i=n("c098"),o=n("1a8c");function s(t,e,n){if(!o(n))return!1;var s=typeof e;return!!("number"==s?a(n)&&i(e,n.length):"string"==s&&e in n)&&r(n[e],t)}t.exports=s},"9b02":function(t,e,n){var r=n("656b");function a(t,e,n){var a=null==t?void 0:r(t,e);return void 0===a?n:a}t.exports=a},"9b7a":function(t,e,n){"use strict";n.r(e),n.d(e,"assertParamsValid",(function(){return o})),n.d(e,"maskToAxes",(function(){return s})),n.d(e,"computeOutShape",(function(){return u})),n.d(e,"stridesWithElidedDims",(function(){return c})),n.d(e,"getNormalizedAxes",(function(){return h})),n.d(e,"startIndicesWithElidedDims",(function(){return p})),n.d(e,"stopIndicesWithElidedDims",(function(){return f})),n.d(e,"stridesForAxis",(function(){return m})),n.d(e,"startForAxis",(function(){return g})),n.d(e,"stopForAxis",(function(){return b})),n.d(e,"isSliceContinous",(function(){return y})),n.d(e,"computeFlatOffset",(function(){return v})),n.d(e,"parseSliceParams",(function(){return x})),n.d(e,"sliceInfo",(function(){return w}));var r=n("df00");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a=-2,i=-1;function o(t,e,n){const a=t.shape.length;r["b"](a===e.length,()=>`Error in slice${a}D: Length of begin ${e} must match the rank of the array (${a}).`),r["b"](a===n.length,()=>`Error in slice${a}D: Length of size ${n} must match the rank of the array (${a}).`);for(let i=0;i<a;++i)r["b"](e[i]+n[i]<=t.shape[i],()=>`Error in slice${a}D: begin[${i}] + size[${i}] (${e[i]+n[i]}) would overflow input.shape[${i}] (${t.shape[i]})`)}function s(t){const e=[];let n=0;while(t>0)1&t&&e.push(n),t/=2,n++;return e}function u(t,e,n){const r=[];for(let a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function c(t,e,n,r){const a=[...t];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)0===i?a[e]=1:(a.splice(e,0,1),a.pop());return a}function l(t,e,n){return n<=t?n:n-(e-1)}function d(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function h(t,e,n,r,a,i,o,s,u){const l=t.length;let d=new Array(l),h=new Array(l),y=new Array(l);if(e.length&&n>0){const u=e[0],l=n+1;d=p(o,u,l,r,t),h=f(s,u,l,a,t),y=c(i,u,l,t)}else for(let c=0;c<l;c++)d[c]=g(o,r,i,t,c,u),h[c]=b(s,a,i,t,c,u),y[c]=m(i,c,u);return{begin:d,end:h,strides:y}}function p(t,e,n,r,a){const i=[...a],o=d(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const a=l(e,n,s);let o=r[a];t&1<<a&&(o=0),i[s]=o}return i}function f(t,e,n,a,i){const o=[...i],s=d(n,e);for(let r=0;r<o.length;r++)if(s.indexOf(r)>-1)o[r]=Number.MAX_SAFE_INTEGER;else{const i=l(e,n,r);let s=a[i];t&1<<i&&(s=Number.MAX_SAFE_INTEGER),o[r]=s}for(let u=0;u<o.length;u++){const t=i[u];o[u]<0&&(o[u]+=t),o[u]=r["i"](0,o[u],i[u])}return o}function m(t,e,n){let r=t[e];return(n&1<<e||null==r)&&(r=1),r}function g(t,e,n,a,i,o){let s=e[i];const u=n[i]||1;(t&1<<i||o&1<<i||null==s)&&(s=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=a[i];return s<0&&(s+=c),s=r["i"](0,s,c-1),s}function b(t,e,n,a,i,o){let s=e[i];const u=n[i]||1;(t&1<<i||o&1<<i||null==s)&&(s=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=a[i];return s<0&&(s+=c),s=u>0?r["i"](0,s,c):r["i"](-1,s,c-1),s}function y(t,e,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function v(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function x(t,e,n){let a;const i=t.shape.length;let o;return a="number"===typeof e?[e,...new Array(i-1).fill(0)]:e.length<i?e.concat(new Array(i-e.length).fill(0)):e.slice(),a.forEach(t=>{r["b"](-1!==t,()=>"slice() does not support negative begin indexing.")}),o=null==n?new Array(i).fill(-1):"number"===typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,o=o.map((e,n)=>e>=0?e:(r["b"](-1===e,()=>`Negative size values should be exactly -1 but got ${e} for the slice() size at index ${n}.`),t.shape[n]-a[n])),[a,o]}function w(t,e,n,r,i,o,s,u,c){let l;if(null==r?(l=new Array(e.length),l.fill(1)):l=r,null!=s&&0!==(s&s-1))throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const h={dims:l.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:l.slice(),beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:u,shrinkAxisMask:c};for(let a=0;a<h.dims;a++)d&&0!==(1<<a&u)&&h.numAddAxisAfterEllipsis++,1<<a&s&&(d=!0);d||(h.ellipsisMask|=1<<h.dims,h.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};k(h,p);let f=!0,m=!0,g=!0;const b=[],y=[];for(let a=0;a<t.length;++a){if(0===p.strides[a])throw Error(`strides[${a}] must be non-zero`);const e=!!(p.shrinkAxisMask&1<<a),n=t[a];if(-1===n){b.push(e?1:-1);continue}const r=[p.beginMask&1<<a,p.endMask&1<<a],i=[p.strides[a]>0?0:-1,p.strides[a]>0?n:n-1];if(e&&p.strides[a]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&1===p.strides[a];const o=!!(p.beginMask&1<<a&&p.endMask&1<<a);if(p.beginValid&&p.endValid){if(e){const t=p.begin[a]<0?n+p.begin[a]:p.begin[a];if(p.begin[a]=t,p.end[a]=p.begin[a]+1,t<0||t>=n)throw Error(`slice index ${p.begin[a]} of dimension ${a} out of bounds.`)}else p.begin[a]=S(p.begin[a],0,p.strides[a],n,r,i),p.end[a]=S(p.end[a],1,p.strides[a],n,r,i);const t=1===p.strides[a]&&0===p.begin[a]&&p.end[a]===n;f=f&&t,m=m&&(0===a&&1===p.strides[a]||t)}else f=f&&1===p.strides[a]&&o,m=m&&(0===a&&1===p.strides[a]||o);let s,u=!1;if(p.beginValid&&p.endValid?(s=p.end[a]-p.begin[a],u=!0):e?(s=1,u=!0):o&&n>=0&&(s=p.strides[a]<0?-n:n,u=!0),u){let t;t=0===s||s<0!==p.strides[a]<0?0:Math.trunc(s/p.strides[a])+(s%p.strides[a]!==0?1:0),b.push(t)}else b.push(-1)}for(let x=0;x<p.finalShapeGatherIndices.length;++x){const t=p.finalShapeGatherIndices[x];t>=0?y.push(b[t]):t===a&&y.push(1)}const v=y.filter((t,e)=>p.finalShapeGatherIndices[e]!==a);return{finalShapeSparse:v,finalShape:y,isIdentity:f,sliceDim0:m,isSimpleSlice:g,begin:p.begin,end:p.end,strides:p.strides}}function k(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=null!=t.begin,e.endValid=null!=t.end,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(a),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);null!=t.begin&&(e.begin[n]=t.begin[r]),null!=t.end&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(i),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function S(t,e,n,r,a,i){if(a[e])return n>0?i[e]:i[e+1&1];{const e=t<0?r+t:t;return e<i[0]?i[0]:e>i[1]?i[1]:e}}},"9c14":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.log(t)),s=Object(i["b"])(r["Log"],o),u={kernelName:r["Log"],backendName:"cpu",kernelFunc:s}},"9cb8":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=e.Collection=void 0;var r=n("d777"),a=function(){function t(){}return t.toCollection=function(e){var n,r=new t,a=e.length;for(n=0;n<a;n++)r.push(e[n]);return r},t._mapMethod=function(e){t.prototype[e]=function(){var t,n=this.length,r=[].slice.call(arguments);for(t=0;t<n;t++)this[t][e].apply(this[t],r);return this}},t.mapMethods=function(e){var n=e.prototype;for(var r in n)t._mapMethod(r)},t}();e.Collection=a,a.prototype=[],a.prototype.each=function(t){for(var e=0;e<this.length;e++)t(this[e],e)},a.prototype.toArray=function(){var t,e=[],n=this.length;for(t=0;t<n;t++)e.push(this[t]);return e};var i=function(){function t(t){void 0===t&&(t=[1,0,0,1,0,0]),this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}return t.prototype.reset=function(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0},t.prototype.copy=function(){return new t(this.m)},t.prototype.copyInto=function(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]},t.prototype.point=function(t){var e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}},t.prototype.translate=function(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this},t.prototype.scale=function(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),r=this.m[0]*e+this.m[2]*n,a=this.m[1]*e+this.m[3]*n,i=this.m[0]*-n+this.m[2]*e,o=this.m[1]*-n+this.m[3]*e;return this.m[0]=r,this.m[1]=a,this.m[2]=i,this.m[3]=o,this},t.prototype.getTranslation=function(){return{x:this.m[4],y:this.m[5]}},t.prototype.skew=function(t,e){var n=this.m[0]+this.m[2]*e,r=this.m[1]+this.m[3]*e,a=this.m[2]+this.m[0]*t,i=this.m[3]+this.m[1]*t;return this.m[0]=n,this.m[1]=r,this.m[2]=a,this.m[3]=i,this},t.prototype.multiply=function(t){var e=this.m[0]*t.m[0]+this.m[2]*t.m[1],n=this.m[1]*t.m[0]+this.m[3]*t.m[1],r=this.m[0]*t.m[2]+this.m[2]*t.m[3],a=this.m[1]*t.m[2]+this.m[3]*t.m[3],i=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],o=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=n,this.m[2]=r,this.m[3]=a,this.m[4]=i,this.m[5]=o,this},t.prototype.invert=function(){var t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,n=-this.m[1]*t,r=-this.m[2]*t,a=this.m[0]*t,i=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=n,this.m[2]=r,this.m[3]=a,this.m[4]=i,this.m[5]=o,this},t.prototype.getMatrix=function(){return this.m},t.prototype.setAbsolutePosition=function(t,e){var n=this.m[0],r=this.m[1],a=this.m[2],i=this.m[3],o=this.m[4],s=this.m[5],u=(n*(e-s)-r*(t-o))/(n*i-r*a),c=(t-o-a*u)/n;return this.translate(c,u)},t.prototype.decompose=function(){var t=this.m[0],n=this.m[1],r=this.m[2],a=this.m[3],i=this.m[4],o=this.m[5],s=t*a-n*r,u={x:i,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=t||0!=n){var c=Math.sqrt(t*t+n*n);u.rotation=n>0?Math.acos(t/c):-Math.acos(t/c),u.scaleX=c,u.scaleY=s/c,u.skewX=(t*r+n*a)/s,u.skewY=0}else if(0!=r||0!=a){var l=Math.sqrt(r*r+a*a);u.rotation=Math.PI/2-(a>0?Math.acos(-r/l):-Math.acos(r/l)),u.scaleX=s/l,u.scaleY=l,u.skewX=0,u.skewY=(t*r+n*a)/s}return u.rotation=e.Util._getRotation(u.rotation),u},t}();e.Transform=i;var o="[object Array]",s="[object Number]",u="[object String]",c="[object Boolean]",l=Math.PI/180,d=180/Math.PI,h="#",p="",f="0",m="Konva warning: ",g="Konva error: ",b="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},v=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,x=[];e.Util={_isElement:function(t){return!(!t||1!=t.nodeType)},_isFunction:function(t){return!!(t&&t.constructor&&t.call&&t.apply)},_isPlainObject:function(t){return!!t&&t.constructor===Object},_isArray:function(t){return Object.prototype.toString.call(t)===o},_isNumber:function(t){return Object.prototype.toString.call(t)===s&&!isNaN(t)&&isFinite(t)},_isString:function(t){return Object.prototype.toString.call(t)===u},_isBoolean:function(t){return Object.prototype.toString.call(t)===c},isObject:function(t){return t instanceof Object},isValidSelector:function(t){if("string"!==typeof t)return!1;var e=t[0];return"#"===e||"."===e||e===e.toUpperCase()},_sign:function(t){return 0===t||t>0?1:-1},requestAnimFrame:function(t){x.push(t),1===x.length&&requestAnimationFrame((function(){var t=x;x=[],t.forEach((function(t){t()}))}))},createCanvasElement:function(){var t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){}return t},createImageElement:function(){return document.createElement("img")},_isInDocument:function(t){while(t=t.parentNode)if(t==document)return!0;return!1},_simplifyArray:function(t){var n,r,a=[],i=t.length,o=e.Util;for(n=0;n<i;n++)r=t[n],o._isNumber(r)?r=Math.round(1e3*r)/1e3:o._isString(r)||(r=r.toString()),a.push(r);return a},_urlToImage:function(t,e){var n=new r.glob.Image;n.onload=function(){e(n)},n.src=t},_rgbToHex:function(t,e,n){return((1<<24)+(t<<16)+(e<<8)+n).toString(16).slice(1)},_hexToRgb:function(t){t=t.replace(h,p);var e=parseInt(t,16);return{r:e>>16&255,g:e>>8&255,b:255&e}},getRandomColor:function(){var t=(16777215*Math.random()<<0).toString(16);while(t.length<6)t=f+t;return h+t},get:function(t,e){return void 0===t?e:t},getRGB:function(t){var e;return t in y?(e=y[t],{r:e[0],g:e[1],b:e[2]}):t[0]===h?this._hexToRgb(t.substring(1)):t.substr(0,4)===b?(e=v.exec(t.replace(/ /g,"")),{r:parseInt(e[1],10),g:parseInt(e[2],10),b:parseInt(e[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(t){return t=t||"black",e.Util._namedColorToRBA(t)||e.Util._hex3ColorToRGBA(t)||e.Util._hex6ColorToRGBA(t)||e.Util._rgbColorToRGBA(t)||e.Util._rgbaColorToRGBA(t)||e.Util._hslColorToRGBA(t)},_namedColorToRBA:function(t){var e=y[t.toLowerCase()];return e?{r:e[0],g:e[1],b:e[2],a:1}:null},_rgbColorToRGBA:function(t){if(0===t.indexOf("rgb(")){t=t.match(/rgb\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:1}}},_rgbaColorToRGBA:function(t){if(0===t.indexOf("rgba(")){t=t.match(/rgba\(([^)]+)\)/)[1];var e=t.split(/ *, */).map(Number);return{r:e[0],g:e[1],b:e[2],a:e[3]}}},_hex6ColorToRGBA:function(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:1}},_hex3ColorToRGBA:function(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:1}},_hslColorToRGBA:function(t){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(t)){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t),n=(e[0],e.slice(1)),r=Number(n[0])/360,a=Number(n[1])/100,i=Number(n[2])/100,o=void 0,s=void 0,u=void 0;if(0===a)return u=255*i,{r:Math.round(u),g:Math.round(u),b:Math.round(u),a:1};o=i<.5?i*(1+a):i+a-i*a;for(var c=2*i-o,l=[0,0,0],d=0;d<3;d++)s=r+1/3*-(d-1),s<0&&s++,s>1&&s--,u=6*s<1?c+6*(o-c)*s:2*s<1?o:3*s<2?c+(o-c)*(2/3-s)*6:c,l[d]=255*u;return{r:Math.round(l[0]),g:Math.round(l[1]),b:Math.round(l[2]),a:1}}},haveIntersection:function(t,e){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},cloneObject:function(t){var e={};for(var n in t)this._isPlainObject(t[n])?e[n]=this.cloneObject(t[n]):this._isArray(t[n])?e[n]=this.cloneArray(t[n]):e[n]=t[n];return e},cloneArray:function(t){return t.slice(0)},_degToRad:function(t){return t*l},_radToDeg:function(t){return t*d},_getRotation:function(t){return r.Konva.angleDeg?e.Util._radToDeg(t):t},_capitalize:function(t){return t.charAt(0).toUpperCase()+t.slice(1)},throw:function(t){throw new Error(g+t)},error:function(t){console.error(g+t)},warn:function(t){r.Konva.showWarnings&&console.warn(m+t)},extend:function(t,e){function n(){this.constructor=t}n.prototype=e.prototype;var r=t.prototype;for(var a in t.prototype=new n,r)r.hasOwnProperty(a)&&(t.prototype[a]=r[a]);t.__super__=e.prototype,t.super=e},_getControlPoints:function(t,e,n,r,a,i,o){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),u=Math.sqrt(Math.pow(a-n,2)+Math.pow(i-r,2)),c=o*s/(s+u),l=o*u/(s+u),d=n-c*(a-t),h=r-c*(i-e),p=n+l*(a-t),f=r+l*(i-e);return[d,h,p,f]},_expandPoints:function(t,n){var r,a,i=t.length,o=[];for(r=2;r<i-2;r+=2)a=e.Util._getControlPoints(t[r-2],t[r-1],t[r],t[r+1],t[r+2],t[r+3],n),isNaN(a[0])||(o.push(a[0]),o.push(a[1]),o.push(t[r]),o.push(t[r+1]),o.push(a[2]),o.push(a[3]));return o},each:function(t,e){for(var n in t)e(n,t[n])},_inRange:function(t,e,n){return e<=t&&t<n},_getProjectionToSegment:function(t,e,n,r,a,i){var o,s,u,c=(t-n)*(t-n)+(e-r)*(e-r);if(0==c)o=t,s=e,u=(a-n)*(a-n)+(i-r)*(i-r);else{var l=((a-t)*(n-t)+(i-e)*(r-e))/c;l<0?(o=t,s=e,u=(t-a)*(t-a)+(e-i)*(e-i)):l>1?(o=n,s=r,u=(n-a)*(n-a)+(r-i)*(r-i)):(o=t+l*(n-t),s=e+l*(r-e),u=(o-a)*(o-a)+(s-i)*(s-i))}return[o,s,u]},_getProjectionToLine:function(t,n,r){var a=e.Util.cloneObject(t),i=Number.MAX_VALUE;return n.forEach((function(o,s){if(r||s!==n.length-1){var u=n[(s+1)%n.length],c=e.Util._getProjectionToSegment(o.x,o.y,u.x,u.y,t.x,t.y),l=c[0],d=c[1],h=c[2];h<i&&(a.x=l,a.y=d,i=h)}})),a},_prepareArrayForTween:function(t,n,r){var a,i=[],o=[];if(t.length>n.length){var s=n;n=t,t=s}for(a=0;a<t.length;a+=2)i.push({x:t[a],y:t[a+1]});for(a=0;a<n.length;a+=2)o.push({x:n[a],y:n[a+1]});var u=[];return o.forEach((function(t){var n=e.Util._getProjectionToLine(t,i,r);u.push(n.x),u.push(n.y)})),u},_prepareToStringify:function(t){var n;for(var r in t.visitedByCircularReferenceRemoval=!0,t)if(t.hasOwnProperty(r)&&t[r]&&"object"==typeof t[r])if(n=Object.getOwnPropertyDescriptor(t,r),t[r].visitedByCircularReferenceRemoval||e.Util._isElement(t[r])){if(!n.configurable)return null;delete t[r]}else if(null===e.Util._prepareToStringify(t[r])){if(!n.configurable)return null;delete t[r]}return delete t.visitedByCircularReferenceRemoval,t},_assign:function(t,e){for(var n in e)t[n]=e[n];return t},_getFirstPointerId:function(t){return t.touches?t.changedTouches[0].identifier:999}}},"9cd3":function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},"9cff":function(t,e){},"9d1e":function(t,e,n){"use strict";n("9183")},"9e07":function(t){t.exports=JSON.parse('{"screens":{"AwaitIteratedResultScreen":{"description":"此画面等待本实验前一次迭代的结果。"},"ConnectInteractiveScreen":{"description":"此画面为交互实验建立 socket 连接，并等待其他参与者加入，以满足开始交互实验所需的参与者人数。"},"EyetrackingCalibrationScreen":{"start":"请稍候，正在设置眼动追踪。","instruction":"请跟随并点击红点。","error":"出现了问题。请刷新页面。"},"EyetrackingValidationScreen":{"instruction":"请注视中心的蓝点。","error":"出现了问题。请刷新页面。"},"PostTestScreen":{"instruction":"以下问题为可选，但您的回答将帮助我们分析结果。","age":"年龄","gender":"性别","male":"男","female":"女","otherGender":"其他","education":"教育程度","educationBelowHighschool":"未完成高中学业","educationHighschool":"高中毕业","educationCollege":"大学毕业","educationHigher":"更高学历","nativeLanguages":"母语","nativeLanguagesExplanation":"您小时候在家中使用的语言","comments":"其他意见","belowHighschool":"screens.PostTestScreen.belowHighschool"},"SubmitResultsScreen":{"waiting":"正在提交您的数据,请稍候......","done":"全部完成。谢谢！页面将自动跳转至Prolific(若一分钟内无跳转可关闭本页面)......","error":"在线提交结果时出现了问题。","contact":"为了不浪费您宝贵的时间和数据，请点击如下按钮下载您的数据，然后将它作为附件通过电子邮件发送至本研究的作者：","download":"下载数据"}},"general":{"nextButton":"下一页","start":"开始","go":"继续","send":"发送"},"interactive":{"Chat":{"messageLabel":"在此输入您要发送给另一位参与者的消息。","statusYouJoined":"您已加入","statusYouLeft":"您已离开","statusParticipantJoined":"{user} 已加入","statusParticipantLeft":"{user} 已离开"},"general":{"aborted":"实验无法继续，因为有协作参与者已离开会话。请继续提交结果。"}}}')},"9e69":function(t,e,n){var r=n("2b3e"),a=r.Symbol;t.exports=a},a002:function(t,e,n){(function(e){var n;
/*!
    localForage -- Offline Storage, Improved
    Version 1.7.3
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
(function(e){t.exports=e()})((function(){return function t(e,r,a){function i(s,u){if(!r[s]){if(!e[s]){var c="function"==typeof n&&n;if(!u&&c)return n(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=r[s]={exports:{}};e[s][0].call(d.exports,(function(t){var n=e[s][1][t];return i(n||t)}),d,d.exports,t,e,r,a)}return r[s].exports}for(var o="function"==typeof n&&n,s=0;s<a.length;s++)i(a[s]);return i}({1:[function(t,n,r){(function(t){"use strict";var e,r,a=t.MutationObserver||t.WebKitMutationObserver;if(a){var i=0,o=new a(l),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),e=function(){s.data=i=++i%2}}else if(t.setImmediate||"undefined"===typeof t.MessageChannel)e="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){l(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(l,0)};else{var u=new t.MessageChannel;u.port1.onmessage=l,e=function(){u.port2.postMessage(0)}}var c=[];function l(){var t,e;r=!0;var n=c.length;while(n){e=c,c=[],t=-1;while(++t<n)e[t]();n=c.length}r=!1}function d(t){1!==c.push(t)||r||e()}n.exports=d}).call(this,"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],2:[function(t,e,n){"use strict";var r=t(1);function a(){}var i={},o=["REJECTED"],s=["FULFILLED"],u=["PENDING"];function c(t){if("function"!==typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==a&&p(this,t)}function l(t,e,n){this.promise=t,"function"===typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"===typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(t,e,n){r((function(){var r;try{r=e(n)}catch(a){return i.reject(t,a)}r===t?i.reject(t,new TypeError("Cannot resolve promise with itself")):i.resolve(t,r)}))}function h(t){var e=t&&t.then;if(t&&("object"===typeof t||"function"===typeof t)&&"function"===typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function r(e){n||(n=!0,i.reject(t,e))}function a(e){n||(n=!0,i.resolve(t,e))}function o(){e(a,r)}var s=f(o);"error"===s.status&&r(s.value)}function f(t,e){var n={};try{n.value=t(e),n.status="success"}catch(r){n.status="error",n.value=r}return n}function m(t){return t instanceof this?t:i.resolve(new this(a),t)}function g(t){var e=new this(a);return i.reject(e,t)}function b(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=new Array(n),s=0,u=-1,c=new this(a);while(++u<n)l(t[u],u);return c;function l(t,a){function u(t){o[a]=t,++s!==n||r||(r=!0,i.resolve(c,o))}e.resolve(t).then(u,(function(t){r||(r=!0,i.reject(c,t))}))}}function y(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,r=!1;if(!n)return this.resolve([]);var o=-1,s=new this(a);while(++o<n)u(t[o]);return s;function u(t){e.resolve(t).then((function(t){r||(r=!0,i.resolve(s,t))}),(function(t){r||(r=!0,i.reject(s,t))}))}}e.exports=c,c.prototype["catch"]=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!==typeof t&&this.state===s||"function"!==typeof e&&this.state===o)return this;var n=new this.constructor(a);if(this.state!==u){var r=this.state===s?t:e;d(n,r,this.outcome)}else this.queue.push(new l(n,t,e));return n},l.prototype.callFulfilled=function(t){i.resolve(this.promise,t)},l.prototype.otherCallFulfilled=function(t){d(this.promise,this.onFulfilled,t)},l.prototype.callRejected=function(t){i.reject(this.promise,t)},l.prototype.otherCallRejected=function(t){d(this.promise,this.onRejected,t)},i.resolve=function(t,e){var n=f(h,e);if("error"===n.status)return i.reject(t,n.value);var r=n.value;if(r)p(t,r);else{t.state=s,t.outcome=e;var a=-1,o=t.queue.length;while(++a<o)t.queue[a].callFulfilled(e)}return t},i.reject=function(t,e){t.state=o,t.outcome=e;var n=-1,r=t.queue.length;while(++n<r)t.queue[n].callRejected(e);return t},c.resolve=m,c.reject=g,c.all=b,c.race=y},{1:1}],3:[function(t,n,r){(function(e){"use strict";"function"!==typeof e.Promise&&(e.Promise=t(2))}).call(this,"undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{2:2}],4:[function(t,e,n){"use strict";var r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(){try{if("undefined"!==typeof indexedDB)return indexedDB;if("undefined"!==typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!==typeof mozIndexedDB)return mozIndexedDB;if("undefined"!==typeof OIndexedDB)return OIndexedDB;if("undefined"!==typeof msIndexedDB)return msIndexedDB}catch(t){return}}var o=i();function s(){try{if(!o)return!1;var t="undefined"!==typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"===typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||e)&&"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange}catch(n){return!1}}function u(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n="undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,a=0;a<t.length;a+=1)r.append(t[a]);return r.getBlob(e.type)}}"undefined"===typeof Promise&&t(3);var c=Promise;function l(t,e){e&&t.then((function(t){e(null,t)}),(function(t){e(t)}))}function d(t,e,n){"function"===typeof e&&t.then(e),"function"===typeof n&&t["catch"](n)}function h(t){return"string"!==typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function p(){if(arguments.length&&"function"===typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",m=void 0,g={},b=Object.prototype.toString,y="readonly",v="readwrite";function x(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),a=0;a<e;a++)r[a]=t.charCodeAt(a);return n}function w(t){return new c((function(e){var n=t.transaction(f,v),r=u([""]);n.objectStore(f).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}))["catch"]((function(){return!1}))}function k(t){return"boolean"===typeof m?c.resolve(m):w(t).then((function(t){return m=t,m}))}function S(t){var e=g[t.name],n={};n.promise=new c((function(t,e){n.resolve=t,n.reject=e})),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then((function(){return n.promise})):e.dbReady=n.promise}function O(t){var e=g[t.name],n=e.deferredOperations.pop();if(n)return n.resolve(),n.promise}function _(t,e){var n=g[t.name],r=n.deferredOperations.pop();if(r)return r.reject(e),r.promise}function C(t,e){return new c((function(n,r){if(g[t.name]=g[t.name]||M(),t.db){if(!e)return n(t.db);S(t),t.db.close()}var a=[t.name];e&&a.push(t.version);var i=o.open.apply(o,a);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(f)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(t){t.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),O(t)}}))}function T(t){return C(t,!1)}function I(t){return C(t,!0)}function N(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,a=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),a||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function E(t){return new c((function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)}))}function A(t){var e=x(atob(t.data));return u([e],{type:t.type})}function R(t){return t&&t.__local_forage_encoded_blob}function j(t){var e=this,n=e._initReady().then((function(){var t=g[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady}));return d(n,t,t),n}function D(t){S(t);for(var e=g[t.name],n=e.forages,r=0;r<n.length;r++){var a=n[r];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return t.db=null,T(t).then((function(e){return t.db=e,N(t)?I(t):e})).then((function(r){t.db=e.db=r;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=r}))["catch"]((function(e){throw _(t,e),e}))}function F(t,e,n,r){void 0===r&&(r=1);try{var a=t.db.transaction(t.storeName,e);n(null,a)}catch(i){if(r>0&&(!t.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return c.resolve().then((function(){if(!t.db||"NotFoundError"===i.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),I(t)})).then((function(){return D(t).then((function(){F(t,e,n,r-1)}))}))["catch"](n);n(i)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function P(t){var e=this,n={db:null};if(t)for(var r in t)n[r]=t[r];var a=g[n.name];a||(a=M(),g[n.name]=a),a.forages.push(e),e._initReady||(e._initReady=e.ready,e.ready=j);var i=[];function o(){return c.resolve()}for(var s=0;s<a.forages.length;s++){var u=a.forages[s];u!==e&&i.push(u._initReady()["catch"](o))}var l=a.forages.slice(0);return c.all(i).then((function(){return n.db=a.db,T(n)})).then((function(t){return n.db=t,N(n,e._defaultConfig.version)?I(n):t})).then((function(t){n.db=a.db=t,e._dbInfo=n;for(var r=0;r<l.length;r++){var i=l[r];i!==e&&(i._dbInfo.db=n.db,i._dbInfo.version=n.version)}}))}function $(t,e){var n=this;t=h(t);var r=new c((function(e,r){n.ready().then((function(){F(n._dbInfo,y,(function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName),s=o.get(t);s.onsuccess=function(){var t=s.result;void 0===t&&(t=null),R(t)&&(t=A(t)),e(t)},s.onerror=function(){r(s.error)}}catch(u){r(u)}}))}))["catch"](r)}));return l(r,e),r}function L(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){F(n._dbInfo,y,(function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName),s=o.openCursor(),u=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;R(r)&&(r=A(r));var a=t(r,n.key,u++);void 0!==a?e(a):n["continue"]()}else e()},s.onerror=function(){r(s.error)}}catch(c){r(c)}}))}))["catch"](r)}));return l(r,e),r}function B(t,e,n){var r=this;t=h(t);var a=new c((function(n,a){var i;r.ready().then((function(){return i=r._dbInfo,"[object Blob]"===b.call(e)?k(i.db).then((function(t){return t?e:E(e)})):e})).then((function(e){F(r._dbInfo,v,(function(i,o){if(i)return a(i);try{var s=o.objectStore(r._dbInfo.storeName);null===e&&(e=void 0);var u=s.put(e,t);o.oncomplete=function(){void 0===e&&(e=null),n(e)},o.onabort=o.onerror=function(){var t=u.error?u.error:u.transaction.error;a(t)}}catch(c){a(c)}}))}))["catch"](a)}));return l(a,n),a}function z(t,e){var n=this;t=h(t);var r=new c((function(e,r){n.ready().then((function(){F(n._dbInfo,v,(function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName),s=o["delete"](t);i.oncomplete=function(){e()},i.onerror=function(){r(s.error)},i.onabort=function(){var t=s.error?s.error:s.transaction.error;r(t)}}catch(u){r(u)}}))}))["catch"](r)}));return l(r,e),r}function W(t){var e=this,n=new c((function(t,n){e.ready().then((function(){F(e._dbInfo,v,(function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName),o=i.clear();a.oncomplete=function(){t()},a.onabort=a.onerror=function(){var t=o.error?o.error:o.transaction.error;n(t)}}catch(s){n(s)}}))}))["catch"](n)}));return l(n,t),n}function V(t){var e=this,n=new c((function(t,n){e.ready().then((function(){F(e._dbInfo,y,(function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName),o=i.count();o.onsuccess=function(){t(o.result)},o.onerror=function(){n(o.error)}}catch(s){n(s)}}))}))["catch"](n)}));return l(n,t),n}function U(t,e){var n=this,r=new c((function(e,r){t<0?e(null):n.ready().then((function(){F(n._dbInfo,y,(function(a,i){if(a)return r(a);try{var o=i.objectStore(n._dbInfo.storeName),s=!1,u=o.openCursor();u.onsuccess=function(){var n=u.result;n?0===t||s?e(n.key):(s=!0,n.advance(t)):e(null)},u.onerror=function(){r(u.error)}}catch(c){r(c)}}))}))["catch"](r)}));return l(r,e),r}function G(t){var e=this,n=new c((function(t,n){e.ready().then((function(){F(e._dbInfo,y,(function(r,a){if(r)return n(r);try{var i=a.objectStore(e._dbInfo.storeName),o=i.openCursor(),s=[];o.onsuccess=function(){var e=o.result;e?(s.push(e.key),e["continue"]()):t(s)},o.onerror=function(){n(o.error)}}catch(u){n(u)}}))}))["catch"](n)}));return l(n,t),n}function H(t,e){e=p.apply(this,arguments);var n=this.config();t="function"!==typeof t&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,a=this;if(t.name){var i=t.name===n.name&&a._dbInfo.db,s=i?c.resolve(a._dbInfo.db):T(t).then((function(e){var n=g[t.name],r=n.forages;n.db=e;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=e;return e}));r=t.storeName?s.then((function(e){if(e.objectStoreNames.contains(t.storeName)){var n=e.version+1;S(t);var r=g[t.name],a=r.forages;e.close();for(var i=0;i<a.length;i++){var s=a[i];s._dbInfo.db=null,s._dbInfo.version=n}var u=new c((function(e,r){var a=o.open(t.name,n);a.onerror=function(t){var e=a.result;e.close(),r(t)},a.onupgradeneeded=function(){var e=a.result;e.deleteObjectStore(t.storeName)},a.onsuccess=function(){var t=a.result;t.close(),e(t)}}));return u.then((function(t){r.db=t;for(var e=0;e<a.length;e++){var n=a[e];n._dbInfo.db=t,O(n._dbInfo)}}))["catch"]((function(e){throw(_(t,e)||c.resolve())["catch"]((function(){})),e}))}})):s.then((function(e){S(t);var n=g[t.name],r=n.forages;e.close();for(var a=0;a<r.length;a++){var i=r[a];i._dbInfo.db=null}var s=new c((function(e,n){var r=o.deleteDatabase(t.name);r.onerror=r.onblocked=function(t){var e=r.result;e&&e.close(),n(t)},r.onsuccess=function(){var t=r.result;t&&t.close(),e(t)}}));return s.then((function(t){n.db=t;for(var e=0;e<r.length;e++){var a=r[e];O(a._dbInfo)}}))["catch"]((function(e){throw(_(t,e)||c.resolve())["catch"]((function(){})),e}))}))}else r=c.reject("Invalid arguments");return l(r,e),r}var q={_driver:"asyncStorage",_initStorage:P,_support:s(),iterate:L,getItem:$,setItem:B,removeItem:z,clear:W,length:V,key:U,keys:G,dropInstance:H};function K(){return"function"===typeof openDatabase}var X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Y="~~local_forage_type~",J=/^~~local_forage_type~([^~]+)~/,Z="__lfsc__:",Q=Z.length,tt="arbf",et="blob",nt="si08",rt="ui08",at="uic8",it="si16",ot="si32",st="ur16",ut="ui32",ct="fl32",lt="fl64",dt=Q+tt.length,ht=Object.prototype.toString;function pt(t){var e,n,r,a,i,o=.75*t.length,s=t.length,u=0;"="===t[t.length-1]&&(o--,"="===t[t.length-2]&&o--);var c=new ArrayBuffer(o),l=new Uint8Array(c);for(e=0;e<s;e+=4)n=X.indexOf(t[e]),r=X.indexOf(t[e+1]),a=X.indexOf(t[e+2]),i=X.indexOf(t[e+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|a>>2,l[u++]=(3&a)<<6|63&i;return c}function ft(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=X[n[e]>>2],r+=X[(3&n[e])<<4|n[e+1]>>4],r+=X[(15&n[e+1])<<2|n[e+2]>>6],r+=X[63&n[e+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function mt(t,e){var n="";if(t&&(n=ht.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===ht.call(t.buffer))){var r,a=Z;t instanceof ArrayBuffer?(r=t,a+=tt):(r=t.buffer,"[object Int8Array]"===n?a+=nt:"[object Uint8Array]"===n?a+=rt:"[object Uint8ClampedArray]"===n?a+=at:"[object Int16Array]"===n?a+=it:"[object Uint16Array]"===n?a+=st:"[object Int32Array]"===n?a+=ot:"[object Uint32Array]"===n?a+=ut:"[object Float32Array]"===n?a+=ct:"[object Float64Array]"===n?a+=lt:e(new Error("Failed to get type for BinaryArray"))),e(a+ft(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=Y+t.type+"~"+ft(this.result);e(Z+et+n)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(o){console.error("Couldn't convert value into a JSON string: ",t),e(null,o)}}function gt(t){if(t.substring(0,Q)!==Z)return JSON.parse(t);var e,n=t.substring(dt),r=t.substring(Q,dt);if(r===et&&J.test(n)){var a=n.match(J);e=a[1],n=n.substring(a[0].length)}var i=pt(n);switch(r){case tt:return i;case et:return u([i],{type:e});case nt:return new Int8Array(i);case rt:return new Uint8Array(i);case at:return new Uint8ClampedArray(i);case it:return new Int16Array(i);case st:return new Uint16Array(i);case ot:return new Int32Array(i);case ut:return new Uint32Array(i);case ct:return new Float32Array(i);case lt:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}var bt={serialize:mt,deserialize:gt,stringToBuffer:pt,bufferToString:ft};function yt(t,e,n,r){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function vt(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!==typeof t[r]?t[r].toString():t[r];var a=new c((function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(a){return r(a)}n.db.transaction((function(a){yt(a,n,(function(){e._dbInfo=n,t()}),(function(t,e){r(e)}))}),r)}));return n.serializer=bt,a}function xt(t,e,n,r,a,i){t.executeSql(n,r,a,(function(t,o){o.code===o.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[e.storeName],(function(t,s){s.rows.length?i(t,o):yt(t,e,(function(){t.executeSql(n,r,a,i)}),i)}),i):i(t,o)}),i)}function wt(t,e){var n=this;t=h(t);var r=new c((function(e,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xt(n,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=a.serializer.deserialize(r)),e(r)}),(function(t,e){r(e)}))}))}))["catch"](r)}));return l(r,e),r}function kt(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xt(n,a,"SELECT * FROM "+a.storeName,[],(function(n,r){for(var i=r.rows,o=i.length,s=0;s<o;s++){var u=i.item(s),c=u.value;if(c&&(c=a.serializer.deserialize(c)),c=t(c,u.key,s+1),void 0!==c)return void e(c)}e()}),(function(t,e){r(e)}))}))}))["catch"](r)}));return l(r,e),r}function St(t,e,n,r){var a=this;t=h(t);var i=new c((function(i,o){a.ready().then((function(){void 0===e&&(e=null);var s=e,u=a._dbInfo;u.serializer.serialize(e,(function(e,c){c?o(c):u.db.transaction((function(n){xt(n,u,"INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],(function(){i(s)}),(function(t,e){o(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void i(St.apply(a,[t,s,n,r-1]));o(e)}}))}))}))["catch"](o)}));return l(i,n),i}function Ot(t,e,n){return St.apply(this,[t,e,n,1])}function _t(t,e){var n=this;t=h(t);var r=new c((function(e,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xt(n,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){r(e)}))}))}))["catch"](r)}));return l(r,e),r}function Ct(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){xt(e,r,"DELETE FROM "+r.storeName,[],(function(){t()}),(function(t,e){n(e)}))}))}))["catch"](n)}));return l(n,t),n}function Tt(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){xt(e,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],(function(e,n){var r=n.rows.item(0).c;t(r)}),(function(t,e){n(e)}))}))}))["catch"](n)}));return l(n,t),n}function It(t,e){var n=this,r=new c((function(e,r){n.ready().then((function(){var a=n._dbInfo;a.db.transaction((function(n){xt(n,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)}),(function(t,e){r(e)}))}))}))["catch"](r)}));return l(r,e),r}function Nt(t){var e=this,n=new c((function(t,n){e.ready().then((function(){var r=e._dbInfo;r.db.transaction((function(e){xt(e,r,"SELECT key FROM "+r.storeName,[],(function(e,n){for(var r=[],a=0;a<n.rows.length;a++)r.push(n.rows.item(a).key);t(r)}),(function(t,e){n(e)}))}))}))["catch"](n)}));return l(n,t),n}function Et(t){return new c((function(e,n){t.transaction((function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(n,r){for(var a=[],i=0;i<r.rows.length;i++)a.push(r.rows.item(i).name);e({db:t,storeNames:a})}),(function(t,e){n(e)}))}),(function(t){n(t)}))}))}function At(t,e){e=p.apply(this,arguments);var n=this.config();t="function"!==typeof t&&t||{},t.name||(t.name=t.name||n.name,t.storeName=t.storeName||n.storeName);var r,a=this;return r=t.name?new c((function(e){var r;r=t.name===n.name?a._dbInfo.db:openDatabase(t.name,"","",0),t.storeName?e({db:r,storeNames:[t.storeName]}):e(Et(r))})).then((function(t){return new c((function(e,n){t.db.transaction((function(r){function a(t){return new c((function(e,n){r.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){n(e)}))}))}for(var i=[],o=0,s=t.storeNames.length;o<s;o++)i.push(a(t.storeNames[o]));c.all(i).then((function(){e()}))["catch"]((function(t){n(t)}))}),(function(t){n(t)}))}))})):c.reject("Invalid arguments"),l(r,e),r}var Rt={_driver:"webSQLStorage",_initStorage:vt,_support:K(),iterate:kt,getItem:wt,setItem:Ot,removeItem:_t,clear:Ct,length:Tt,key:It,keys:Nt,dropInstance:At};function jt(){try{return"undefined"!==typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}function Dt(t,e){var n=t.name+"/";return t.storeName!==e.storeName&&(n+=t.storeName+"/"),n}function Ft(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(e){return!0}}function Mt(){return!Ft()||localStorage.length>0}function Pt(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=Dt(t,e._defaultConfig),Mt()?(e._dbInfo=n,n.serializer=bt,c.resolve()):c.reject()}function $t(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}}));return l(n,t),n}function Lt(t,e){var n=this;t=h(t);var r=n.ready().then((function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r}));return l(r,e),r}function Bt(t,e){var n=this,r=n.ready().then((function(){for(var e=n._dbInfo,r=e.keyPrefix,a=r.length,i=localStorage.length,o=1,s=0;s<i;s++){var u=localStorage.key(s);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),c=t(c,u.substring(a),o++),void 0!==c)return c}}}));return l(r,e),r}function zt(t,e){var n=this,r=n.ready().then((function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(a){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e}));return l(r,e),r}function Wt(t){var e=this,n=e.ready().then((function(){for(var t=e._dbInfo,n=localStorage.length,r=[],a=0;a<n;a++){var i=localStorage.key(a);0===i.indexOf(t.keyPrefix)&&r.push(i.substring(t.keyPrefix.length))}return r}));return l(n,t),n}function Vt(t){var e=this,n=e.keys().then((function(t){return t.length}));return l(n,t),n}function Ut(t,e){var n=this;t=h(t);var r=n.ready().then((function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));return l(r,e),r}function Gt(t,e,n){var r=this;t=h(t);var a=r.ready().then((function(){void 0===e&&(e=null);var n=e;return new c((function(a,i){var o=r._dbInfo;o.serializer.serialize(e,(function(e,r){if(r)i(r);else try{localStorage.setItem(o.keyPrefix+t,e),a(n)}catch(s){"QuotaExceededError"!==s.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==s.name||i(s),i(s)}}))}))}));return l(a,n),a}function Ht(t,e){if(e=p.apply(this,arguments),t="function"!==typeof t&&t||{},!t.name){var n=this.config();t.name=t.name||n.name,t.storeName=t.storeName||n.storeName}var r,a=this;return r=t.name?new c((function(e){t.storeName?e(Dt(t,a._defaultConfig)):e(t.name+"/")})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var n=localStorage.key(e);0===n.indexOf(t)&&localStorage.removeItem(n)}})):c.reject("Invalid arguments"),l(r,e),r}var qt={_driver:"localStorageWrapper",_initStorage:Pt,_support:jt(),iterate:Bt,getItem:Lt,setItem:Gt,removeItem:Ut,clear:$t,length:Vt,key:zt,keys:Wt,dropInstance:Ht},Kt=function(t,e){return t===e||"number"===typeof t&&"number"===typeof e&&isNaN(t)&&isNaN(e)},Xt=function(t,e){var n=t.length,r=0;while(r<n){if(Kt(t[r],e))return!0;r++}return!1},Yt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Jt={},Zt={},Qt={INDEXEDDB:q,WEBSQL:Rt,LOCALSTORAGE:qt},te=[Qt.INDEXEDDB._driver,Qt.WEBSQL._driver,Qt.LOCALSTORAGE._driver],ee=["dropInstance"],ne=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee),re={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ae(t,e){t[e]=function(){var n=arguments;return t.ready().then((function(){return t[e].apply(t,n)}))}}function ie(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Yt(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}var oe=function(){function t(e){for(var n in a(this,t),Qt)if(Qt.hasOwnProperty(n)){var r=Qt[n],i=r._driver;this[n]=i,Jt[i]||this.defineDriver(r)}this._defaultConfig=ie({},re),this._config=ie({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)["catch"]((function(){}))}return t.prototype.config=function(t){if("object"===("undefined"===typeof t?"undefined":r(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!==typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"===typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new c((function(e,n){try{var r=t._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void n(a);for(var i=ne.concat("_initStorage"),o=0,s=i.length;o<s;o++){var u=i[o],d=!Xt(ee,u);if((d||t[u])&&"function"!==typeof t[u])return void n(a)}var h=function(){for(var e=function(t){return function(){var e=new Error("Method "+t+" is not implemented by the current driver"),n=c.reject(e);return l(n,arguments[arguments.length-1]),n}},n=0,r=ee.length;n<r;n++){var a=ee[n];t[a]||(t[a]=e(a))}};h();var p=function(n){Jt[r]&&console.info("Redefining LocalForage driver: "+r),Jt[r]=t,Zt[r]=n,e()};"_support"in t?t._support&&"function"===typeof t._support?t._support().then(p,n):p(!!t._support):p(!0)}catch(f){n(f)}}));return d(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=Jt[t]?c.resolve(Jt[t]):c.reject(new Error("Driver not found."));return d(r,e,n),r},t.prototype.getSerializer=function(t){var e=c.resolve(bt);return d(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then((function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready}));return d(n,t,t),n},t.prototype.setDriver=function(t,e,n){var r=this;Yt(t)||(t=[t]);var a=this._getSupportedDrivers(t);function i(){r._config.driver=r.driver()}function o(t){return r._extend(t),i(),r._ready=r._initStorage(r._config),r._ready}function s(t){return function(){var e=0;function n(){while(e<t.length){var a=t[e];return e++,r._dbInfo=null,r._ready=null,r.getDriver(a).then(o)["catch"](n)}i();var s=new Error("No available storage method found.");return r._driverSet=c.reject(s),r._driverSet}return n()}}var u=null!==this._driverSet?this._driverSet["catch"]((function(){return c.resolve()})):c.resolve();return this._driverSet=u.then((function(){var t=a[0];return r._dbInfo=null,r._ready=null,r.getDriver(t).then((function(t){r._driver=t._driver,i(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(a)}))}))["catch"]((function(){i();var t=new Error("No available storage method found.");return r._driverSet=c.reject(t),r._driverSet})),d(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!Zt[t]},t.prototype._extend=function(t){ie(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var a=t[n];this.supports(a)&&e.push(a)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,e=ne.length;t<e;t++)ae(this,ne[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),se=new oe;e.exports=se},{3:3}]},{},[4])(4)}))}).call(this,n("c8ba"))},a02a:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","rsqrt","float32"),n={x:e};return r["a"].runKernel(a["Dc"],n)}const u=Object(o["b"])({rsqrt_:s})},a08f:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){let n=Object(o["a"])(t,"a","add"),s=Object(o["a"])(e,"b","add");[n,s]=Object(i["makeTypesMatch"])(n,s);const u={a:n,b:s};return r["a"].runKernel(a["d"],u)}const c=Object(s["b"])({add_:u})},a1df:function(t,e,n){"use strict";n("4587")},a2be:function(t,e,n){var r=n("d612"),a=n("4284"),i=n("c584"),o=1,s=2;function u(t,e,n,u,c,l){var d=n&o,h=t.length,p=e.length;if(h!=p&&!(d&&p>h))return!1;var f=l.get(t),m=l.get(e);if(f&&m)return f==e&&m==t;var g=-1,b=!0,y=n&s?new r:void 0;l.set(t,e),l.set(e,t);while(++g<h){var v=t[g],x=e[g];if(u)var w=d?u(x,v,g,e,t,l):u(v,x,g,t,e,l);if(void 0!==w){if(w)continue;b=!1;break}if(y){if(!a(e,(function(t,e){if(!i(y,e)&&(v===t||c(v,t,n,u,l)))return y.push(e)}))){b=!1;break}}else if(v!==x&&!c(v,x,n,u,l)){b=!1;break}}return l["delete"](t),l["delete"](e),b}t.exports=u},a34e:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("ed3d"),u=n("4546"),c=n("d777"),l=function(t){function e(e){var n=t.call(this,e)||this;return n._updated=!0,n.anim=new s.Animation((function(){var t=n._updated;return n._updated=!1,t})),n.on("animationChange.konva",(function(){this.frameIndex(0)})),n.on("frameIndexChange.konva",(function(){this._updated=!0})),n.on("frameRateChange.konva",(function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})),n}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.animation(),n=this.frameIndex(),r=4*n,a=this.animations()[e],i=this.frameOffsets(),o=a[r+0],s=a[r+1],u=a[r+2],c=a[r+3],l=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,u,c),t.closePath(),t.fillStrokeShape(this)),l)if(i){var d=i[e],h=2*n;t.drawImage(l,o,s,u,c,d[h+0],d[h+1],u,c)}else t.drawImage(l,o,s,u,c,0,0,u,c)},e.prototype._hitFunc=function(t){var e=this.animation(),n=this.frameIndex(),r=4*n,a=this.animations()[e],i=this.frameOffsets(),o=a[r+2],s=a[r+3];if(t.beginPath(),i){var u=i[e],c=2*n;t.rect(u[c+0],u[c+1],o,s)}else t.rect(0,0,o,s);t.closePath(),t.fillShape(this)},e.prototype._useBufferCanvas=function(){return t.prototype._useBufferCanvas.call(this,!0)},e.prototype._setInterval=function(){var t=this;this.interval=setInterval((function(){t._updateIndex()}),1e3/this.frameRate())},e.prototype.start=function(){if(!this.isRunning()){var t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}},e.prototype.stop=function(){this.anim.stop(),clearInterval(this.interval)},e.prototype.isRunning=function(){return this.anim.isRunning()},e.prototype._updateIndex=function(){var t=this.frameIndex(),e=this.animation(),n=this.animations(),r=n[e],a=r.length/4;t<a-1?this.frameIndex(t+1):this.frameIndex(0)},e}(o.Shape);e.Sprite=l,l.prototype.className="Sprite",c._registerNode(l),i.Factory.addGetterSetter(l,"animation"),i.Factory.addGetterSetter(l,"animations"),i.Factory.addGetterSetter(l,"frameOffsets"),i.Factory.addGetterSetter(l,"image"),i.Factory.addGetterSetter(l,"frameIndex",0,u.getNumberValidator()),i.Factory.addGetterSetter(l,"frameRate",17,u.getNumberValidator()),i.Factory.backCompat(l,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),a.Collection.mapMethods(l)},a454:function(t,e,n){var r=n("72f0"),a=n("3b4a"),i=n("cd9d"),o=a?function(t,e){return a(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:i;t.exports=o},a49d:function(t,e,n){var r;(function(a,i,o){var s,u=256,c=6,l=52,d="random",h=o.pow(u,c),p=o.pow(2,l),f=2*p,m=u-1;function g(t,e,n){var r=[];e=1==e?{entropy:!0}:e||{};var a=x(v(e.entropy?[t,k(i)]:null==t?w():t,3),r),s=new b(r),l=function(){var t=s.g(c),e=h,n=0;while(t<p)t=(t+n)*u,e*=u,n=s.g(1);while(t>=f)t/=2,e/=2,n>>>=1;return(t+n)/e};return l.int32=function(){return 0|s.g(4)},l.quick=function(){return s.g(4)/4294967296},l.double=l,x(k(s.S),i),(e.pass||n||function(t,e,n,r){return r&&(r.S&&y(r,s),t.state=function(){return y(s,{})}),n?(o[d]=t,e):t})(l,a,"global"in e?e.global:this==o,e.state)}function b(t){var e,n=t.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];n||(t=[n++]);while(a<u)o[a]=a++;for(a=0;a<u;a++)o[a]=o[i=m&i+t[a%n]+(e=o[a])],o[i]=e;(r.g=function(t){var e,n=0,a=r.i,i=r.j,o=r.S;while(t--)e=o[a=m&a+1],n=n*u+o[m&(o[a]=o[i=m&i+e])+(o[i]=e)];return r.i=a,r.j=i,n})(u)}function y(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function v(t,e){var n,r=[],a=typeof t;if(e&&"object"==a)for(n in t)try{r.push(v(t[n],e-1))}catch(i){}return r.length?r:"string"==a?t:t+"\0"}function x(t,e){var n,r=t+"",a=0;while(a<r.length)e[m&a]=m&(n^=19*e[m&a])+r.charCodeAt(a++);return k(e)}function w(){try{var t;return s&&(t=s.randomBytes)?t=t(u):(t=new Uint8Array(u),(a.crypto||a.msCrypto).getRandomValues(t)),k(t)}catch(r){var e=a.navigator,n=e&&e.plugins;return[+new Date,a,n,a.screen,k(i)]}}function k(t){return String.fromCharCode.apply(0,t)}if(x(o.random(),i),t.exports){t.exports=g;try{s=n(3)}catch(S){}}else r=function(){return g}.call(e,n,e,t),void 0===r||(t.exports=r)})("undefined"!==typeof self?self:this,[],Math)},a49e:function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this,n="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),r==n.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.xorwow=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},a524:function(t,e,n){var r=n("4245");function a(t){return r(this,t).has(t)}t.exports=a},a695:function(t,e,n){},a6a7:function(t,e,n){"use strict";n.r(e),n.d(e,"makeTypesMatch",(function(){return o})),n.d(e,"assertTypesMatch",(function(){return s})),n.d(e,"isTensorInList",(function(){return u})),n.d(e,"getTensorsInContainer",(function(){return c}));var r=n("4e56"),a=n("79ec"),i=n("df00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e){if(t.dtype===e.dtype)return[t,e];const n=Object(a["c"])(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function s(t,e){Object(i["b"])(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function u(t,e){return e.some(e=>e.id===t.id)}function c(t){const e=[],n=new Set;return l(t,e,n),e}function l(t,e,n){if(null==t)return;if(t instanceof r["a"])return void e.push(t);if(!d(t))return;const a=t;for(const r in a){const t=a[r];n.has(t)||(n.add(t),l(t,e,n))}}function d(t){return Array.isArray(t)||"object"===typeof t}},a6eb:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return C})),n.d(e,"i",(function(){return N})),n.d(e,"c",(function(){return E})),n.d(e,"f",(function(){return A})),n.d(e,"e",(function(){return D})),n.d(e,"d",(function(){return F})),n.d(e,"k",(function(){return P})),n.d(e,"g",(function(){return $})),n.d(e,"h",(function(){return L})),n.d(e,"j",(function(){return B})),n.d(e,"b",(function(){return z}));var r=n("2ca8"),a=n("a921"),i=n("9489"),o=n("9140"),s=n("483a"),u=n("35bf"),c=n("e9fa"),l=n("1304"),d=n("9cd3"),h=n("1a28"),p=n("9a90"),f=n("bcd9"),m=n("0e2f"),g=n("b744"),b=n("00f6"),y=n("64fe"),v=n("2254"),x=n("ebd5"),w=n("aadd"),k=n("d2e3"),S=n("dc7c"),O=n("88c8"),_=n("4fa9");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class C{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const t=[s,u,c,l,d,h,p,f,m,g,b,y,v,x,w,k,S,O,_],e=[].concat(...t.map(t=>t.json));this.opMappers=e.reduce((t,e)=>(t[e.tfOpName]=e,t),{})}transformGraph(t,e={}){const n=t.node,r=[],a=[],i=[],s=n.reduce((t,e)=>(t[e.name]=this.mapNode(e),e.op.startsWith("Placeholder")?r.push(t[e.name]):"Const"===e.op?a.push(t[e.name]):null!=e.input&&0!==e.input.length||i.push(t[e.name]),t),{});let u=[];const c=[];let l={},d={};null!=e&&(l=this.mapSignatureEntries(e.inputs),d=this.mapSignatureEntries(e.outputs));const h=Object.keys(s);h.forEach(t=>{const e=s[t];e.inputNames.forEach((t,n)=>{const[r,,a]=Object(o["b"])(t),i=s[r];if(null!=i.outputs){const t=i.outputs.indexOf(a);if(-1!==t){const a=`${r}:${t}`;e.inputNames[n]=a}}e.inputs.push(i),i.children.push(e)})}),0===Object.keys(d).length?h.forEach(t=>{const e=s[t];0===e.children.length&&c.push(e)}):Object.keys(d).forEach(t=>{const[e]=Object(o["b"])(t),n=s[e];null!=n&&(n.signatureKey=d[t],c.push(n))}),Object.keys(l).length>0?Object.keys(l).forEach(t=>{const[e]=Object(o["b"])(t),n=s[e];n&&(n.signatureKey=l[t],u.push(n))}):u=r;let p={};null!=t.library&&null!=t.library.function&&(p=t.library.function.reduce((t,e)=>(t[e.signature.name]=this.mapFunction(e),t),{}));const f={nodes:s,inputs:u,outputs:c,weights:a,placeholders:r,signature:e,functions:p};return i.length>0&&(f.initNodes=i),f}mapSignatureEntries(t){return Object.keys(t||{}).reduce((e,n)=>(e[t[n].name]=n,e),{})}mapNode(t){const e=Object(i["b"])(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});const n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map(t=>t.startsWith("^")?t.slice(1):t),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr,outputs:e.outputs};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((t,e)=>(t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((e,n)=>{const r=n.type;let a=void 0;switch(n.type){case"string":a=N(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=N(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":a=L(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=L(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":a=A(t.attr,n.tfName,n.defaultValue||0),void 0===a&&n.tfDeprecatedName&&(a=A(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":a=$(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=$(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":a=E(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=E(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":a=z(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=z(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":a=P(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=P(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":a=B(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=B(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":a=D(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=D(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":a=F(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=F(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":a=j(t.attr,n.tfName,n.defaultValue),void 0===a&&n.tfDeprecatedName&&(a=j(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${t.op}`)}return e[n.name]={value:a,type:r},e},{})),n}mapFunction(t){const e=t.nodeDef,n=[],r=[];let a={};null!=e&&(a=e.reduce((t,e)=>(t[e.name]=this.mapNode(e),"Const"===e.op&&r.push(t[e.name]),t),{}));const i=[],s=[];t.signature.inputArg.forEach(t=>{const[e]=Object(o["b"])(t.name),n={name:e,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:R(t.type),type:"dtype"}},children:[]};n.signatureKey=t.name,i.push(n),a[e]=n});const u=Object.keys(a);u.forEach(t=>{const e=a[t];e.inputNames.forEach((t,n)=>{const[r,,i]=Object(o["b"])(t),s=a[r];if(null!=s.outputs){const t=s.outputs.indexOf(i);if(-1!==t){const a=`${r}:${t}`;e.inputNames[n]=a}}e.inputs.push(s),s.children.push(e)})});const c=t.ret;t.signature.outputArg.forEach(t=>{const[e,n]=Object(o["b"])(c[t.name]),r=a[e];null!=r&&(r.defaultOutput=n,s.push(r))});const l=this.mapArgsToSignature(t);return{nodes:a,inputs:i,outputs:s,weights:r,placeholders:n,signature:l}}mapArgsToSignature(t){return{methodName:t.signature.name,inputs:t.signature.inputArg.reduce((t,e)=>(t[e.name]=this.mapArgToTensorInfo(e),t),{}),outputs:t.signature.outputArg.reduce((e,n)=>(e[n.name]=this.mapArgToTensorInfo(n,t.ret),e),{})}}mapArgToTensorInfo(t,e){let n=t.name;return null!=e&&(n=e[n]),{name:n,dtype:t.type}}}function T(e){const n=Object(r["env"])().global;if("undefined"!==typeof n.atob)return n.atob(e);if("undefined"!==typeof t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function I(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):T(t);return e?n:n.toLowerCase()}function N(t,e,n,r=!1){const a=t[e];return null!=a?I(a.s,r):n}function E(t,e,n){const r=t[e];return r?r.b:n}function A(t,e,n){const r=t[e]||{},a=null!=r["i"]?r["i"]:null!=r["f"]?r["f"]:n;return"number"===typeof a?a:parseInt(a,10)}function R(t){switch("string"===typeof t&&(t=a["a"][t]),t){case a["a"].DT_FLOAT:case a["a"].DT_HALF:return"float32";case a["a"].DT_INT32:case a["a"].DT_INT64:case a["a"].DT_INT8:case a["a"].DT_UINT8:return"int32";case a["a"].DT_BOOL:return"bool";case a["a"].DT_DOUBLE:return"float32";case a["a"].DT_STRING:return"string";default:return null}}function j(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function D(t,e,n){const r=t[e];return r&&r.type?R(r.type):n}function F(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(t=>R(t)):n}function M(t){if(!t.unknownRank)return null!=t.dim?t.dim.map(t=>"number"===typeof t.size?t.size:parseInt(t.size,10)):[]}function P(t,e,n){const r=t[e];return r&&r.shape?M(r.shape):n}function $(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(t=>"number"===typeof t?t:parseInt(t,10)):n}function L(t,e,n,r=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(t=>I(t,r)):n}function B(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(t=>M(t)):n}function z(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n("b639").Buffer)},a777:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MESH_ANNOTATIONS={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]}},a921:function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */
var r,a;n.d(e,"a",(function(){return r})),function(t){t[t["DT_INVALID"]=0]="DT_INVALID",t[t["DT_FLOAT"]=1]="DT_FLOAT",t[t["DT_DOUBLE"]=2]="DT_DOUBLE",t[t["DT_INT32"]=3]="DT_INT32",t[t["DT_UINT8"]=4]="DT_UINT8",t[t["DT_INT16"]=5]="DT_INT16",t[t["DT_INT8"]=6]="DT_INT8",t[t["DT_STRING"]=7]="DT_STRING",t[t["DT_COMPLEX64"]=8]="DT_COMPLEX64",t[t["DT_INT64"]=9]="DT_INT64",t[t["DT_BOOL"]=10]="DT_BOOL",t[t["DT_QINT8"]=11]="DT_QINT8",t[t["DT_QUINT8"]=12]="DT_QUINT8",t[t["DT_QINT32"]=13]="DT_QINT32",t[t["DT_BFLOAT16"]=14]="DT_BFLOAT16",t[t["DT_QINT16"]=15]="DT_QINT16",t[t["DT_QUINT16"]=16]="DT_QUINT16",t[t["DT_UINT16"]=17]="DT_UINT16",t[t["DT_COMPLEX128"]=18]="DT_COMPLEX128",t[t["DT_HALF"]=19]="DT_HALF",t[t["DT_RESOURCE"]=20]="DT_RESOURCE",t[t["DT_VARIANT"]=21]="DT_VARIANT",t[t["DT_UINT32"]=22]="DT_UINT32",t[t["DT_UINT64"]=23]="DT_UINT64",t[t["DT_FLOAT_REF"]=101]="DT_FLOAT_REF",t[t["DT_DOUBLE_REF"]=102]="DT_DOUBLE_REF",t[t["DT_INT32_REF"]=103]="DT_INT32_REF",t[t["DT_UINT8_REF"]=104]="DT_UINT8_REF",t[t["DT_INT16_REF"]=105]="DT_INT16_REF",t[t["DT_INT8_REF"]=106]="DT_INT8_REF",t[t["DT_STRING_REF"]=107]="DT_STRING_REF",t[t["DT_COMPLEX64_REF"]=108]="DT_COMPLEX64_REF",t[t["DT_INT64_REF"]=109]="DT_INT64_REF",t[t["DT_BOOL_REF"]=110]="DT_BOOL_REF",t[t["DT_QINT8_REF"]=111]="DT_QINT8_REF",t[t["DT_QUINT8_REF"]=112]="DT_QUINT8_REF",t[t["DT_QINT32_REF"]=113]="DT_QINT32_REF",t[t["DT_BFLOAT16_REF"]=114]="DT_BFLOAT16_REF",t[t["DT_QINT16_REF"]=115]="DT_QINT16_REF",t[t["DT_QUINT16_REF"]=116]="DT_QUINT16_REF",t[t["DT_UINT16_REF"]=117]="DT_UINT16_REF",t[t["DT_COMPLEX128_REF"]=118]="DT_COMPLEX128_REF",t[t["DT_HALF_REF"]=119]="DT_HALF_REF",t[t["DT_RESOURCE_REF"]=120]="DT_RESOURCE_REF",t[t["DT_VARIANT_REF"]=121]="DT_VARIANT_REF",t[t["DT_UINT32_REF"]=122]="DT_UINT32_REF",t[t["DT_UINT64_REF"]=123]="DT_UINT64_REF"}(r||(r={})),function(t){let e;(function(t){t[t["LEGACY"]=0]="LEGACY",t[t["V1"]=1]="V1",t[t["V2"]=2]="V2"})(e=t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(a||(a={}))},a994:function(t,e,n){var r=n("7d1f"),a=n("32f4"),i=n("ec69");function o(t){return r(t,i,a)}t.exports=o},a9d7:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","abs");if("complex64"===e.dtype){const t={x:e};return r["a"].runKernel(a["B"],t)}{const t={x:e};return r["a"].runKernel(a["a"],t)}}const u=Object(o["b"])({abs_:s})},aa47:function(t,e,n){"use strict";
/**!
 * Sortable 1.10.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */
function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(){return i=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i.apply(this,arguments)}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){a(t,e,n[e])}))}return t}function s(t,e){if(null==t)return{};var n,r,a={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(a[n]=t[n]);return a}function u(t,e){if(null==t)return{};var n,r,a=s(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(a[n]=t[n])}return a}function c(t){return l(t)||d(t)||h()}function l(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function d(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance")}n.r(e),n.d(e,"MultiDrag",(function(){return $e})),n.d(e,"Sortable",(function(){return Zt})),n.d(e,"Swap",(function(){return Ce}));var p="1.10.2";function f(t){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var m=f(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),g=f(/Edge/i),b=f(/firefox/i),y=f(/safari/i)&&!f(/chrome/i)&&!f(/android/i),v=f(/iP(ad|od|hone)/i),x=f(/chrome/i)&&f(/android/i),w={capture:!1,passive:!1};function k(t,e,n){t.addEventListener(e,n,!m&&w)}function S(t,e,n){t.removeEventListener(e,n,!m&&w)}function O(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(n){return!1}return!1}}function _(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function C(t,e,n,r){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&O(t,e):O(t,e))||r&&t===n)return t;if(t===n)break}while(t=_(t))}return null}var T,I=/\s+/g;function N(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(I," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(I," ")}}function E(t,e,n){var r=t&&t.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in r||-1!==e.indexOf("webkit")||(e="-webkit-"+e),r[e]=n+("string"===typeof n?"":"px")}}function A(t,e){var n="";if("string"===typeof t)n=t;else do{var r=E(t,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!e&&(t=t.parentNode));var a=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return a&&new a(n)}function R(t,e,n){if(t){var r=t.getElementsByTagName(e),a=0,i=r.length;if(n)for(;a<i;a++)n(r[a],a);return r}return[]}function j(){var t=document.scrollingElement;return t||document.documentElement}function D(t,e,n,r,a){if(t.getBoundingClientRect||t===window){var i,o,s,u,c,l,d;if(t!==window&&t!==j()?(i=t.getBoundingClientRect(),o=i.top,s=i.left,u=i.bottom,c=i.right,l=i.height,d=i.width):(o=0,s=0,u=window.innerHeight,c=window.innerWidth,l=window.innerHeight,d=window.innerWidth),(e||n)&&t!==window&&(a=a||t.parentNode,!m))do{if(a&&a.getBoundingClientRect&&("none"!==E(a,"transform")||n&&"static"!==E(a,"position"))){var h=a.getBoundingClientRect();o-=h.top+parseInt(E(a,"border-top-width")),s-=h.left+parseInt(E(a,"border-left-width")),u=o+i.height,c=s+i.width;break}}while(a=a.parentNode);if(r&&t!==window){var p=A(a||t),f=p&&p.a,g=p&&p.d;p&&(o/=g,s/=f,d/=f,l/=g,u=o+l,c=s+d)}return{top:o,left:s,bottom:u,right:c,width:d,height:l}}}function F(t,e,n){var r=z(t,!0),a=D(t)[e];while(r){var i=D(r)[n],o=void 0;if(o="top"===n||"left"===n?a>=i:a<=i,!o)return r;if(r===j())break;r=z(r,!1)}return!1}function M(t,e,n){var r=0,a=0,i=t.children;while(a<i.length){if("none"!==i[a].style.display&&i[a]!==Zt.ghost&&i[a]!==Zt.dragged&&C(i[a],n.draggable,t,!1)){if(r===e)return i[a];r++}a++}return null}function P(t,e){var n=t.lastElementChild;while(n&&(n===Zt.ghost||"none"===E(n,"display")||e&&!O(n,e)))n=n.previousElementSibling;return n||null}function $(t,e){var n=0;if(!t||!t.parentNode)return-1;while(t=t.previousElementSibling)"TEMPLATE"===t.nodeName.toUpperCase()||t===Zt.clone||e&&!O(t,e)||n++;return n}function L(t){var e=0,n=0,r=j();if(t)do{var a=A(t),i=a.a,o=a.d;e+=t.scrollLeft*i,n+=t.scrollTop*o}while(t!==r&&(t=t.parentNode));return[e,n]}function B(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t[n][r])return Number(n);return-1}function z(t,e){if(!t||!t.getBoundingClientRect)return j();var n=t,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var a=E(n);if(n.clientWidth<n.scrollWidth&&("auto"==a.overflowX||"scroll"==a.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==a.overflowY||"scroll"==a.overflowY)){if(!n.getBoundingClientRect||n===document.body)return j();if(r||e)return n;r=!0}}}while(n=n.parentNode);return j()}function W(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function V(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function U(t,e){return function(){if(!T){var n=arguments,r=this;1===n.length?t.call(r,n[0]):t.apply(r,n),T=setTimeout((function(){T=void 0}),e)}}}function G(){clearTimeout(T),T=void 0}function H(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function q(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function K(t,e){E(t,"position","absolute"),E(t,"top",e.top),E(t,"left",e.left),E(t,"width",e.width),E(t,"height",e.height)}function X(t){E(t,"position",""),E(t,"top",""),E(t,"left",""),E(t,"width",""),E(t,"height","")}var Y="Sortable"+(new Date).getTime();function J(){var t,e=[];return{captureAnimationState:function(){if(e=[],this.options.animation){var t=[].slice.call(this.el.children);t.forEach((function(t){if("none"!==E(t,"display")&&t!==Zt.ghost){e.push({target:t,rect:D(t)});var n=o({},e[e.length-1].rect);if(t.thisAnimationDuration){var r=A(t,!0);r&&(n.top-=r.f,n.left-=r.e)}t.fromRect=n}}))}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(B(e,{target:t}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(t),void("function"===typeof n&&n());var a=!1,i=0;e.forEach((function(t){var e=0,n=t.target,o=n.fromRect,s=D(n),u=n.prevFromRect,c=n.prevToRect,l=t.rect,d=A(n,!0);d&&(s.top-=d.f,s.left-=d.e),n.toRect=s,n.thisAnimationDuration&&V(u,s)&&!V(o,s)&&(l.top-s.top)/(l.left-s.left)===(o.top-s.top)/(o.left-s.left)&&(e=Q(l,u,c,r.options)),V(s,o)||(n.prevFromRect=o,n.prevToRect=s,e||(e=r.options.animation),r.animate(n,l,s,e)),e&&(a=!0,i=Math.max(i,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),a?t=setTimeout((function(){"function"===typeof n&&n()}),i):"function"===typeof n&&n(),e=[]},animate:function(t,e,n,r){if(r){E(t,"transition",""),E(t,"transform","");var a=A(this.el),i=a&&a.a,o=a&&a.d,s=(e.left-n.left)/(i||1),u=(e.top-n.top)/(o||1);t.animatingX=!!s,t.animatingY=!!u,E(t,"transform","translate3d("+s+"px,"+u+"px,0)"),Z(t),E(t,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),E(t,"transform","translate3d(0,0,0)"),"number"===typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){E(t,"transition",""),E(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),r)}}}}function Z(t){return t.offsetWidth}function Q(t,e,n,r){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*r.animation}var tt=[],et={initializeByDefault:!0},nt={mount:function(t){for(var e in et)et.hasOwnProperty(e)&&!(e in t)&&(t[e]=et[e]);tt.push(t)},pluginEvent:function(t,e,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var a=t+"Global";tt.forEach((function(r){e[r.pluginName]&&(e[r.pluginName][a]&&e[r.pluginName][a](o({sortable:e},n)),e.options[r.pluginName]&&e[r.pluginName][t]&&e[r.pluginName][t](o({sortable:e},n)))}))},initializePlugins:function(t,e,n,r){for(var a in tt.forEach((function(r){var a=r.pluginName;if(t.options[a]||r.initializeByDefault){var o=new r(t,e,t.options);o.sortable=t,o.options=t.options,t[a]=o,i(n,o.defaults)}})),t.options)if(t.options.hasOwnProperty(a)){var o=this.modifyOption(t,a,t.options[a]);"undefined"!==typeof o&&(t.options[a]=o)}},getEventProperties:function(t,e){var n={};return tt.forEach((function(r){"function"===typeof r.eventProperties&&i(n,r.eventProperties.call(e[r.pluginName],t))})),n},modifyOption:function(t,e,n){var r;return tt.forEach((function(a){t[a.pluginName]&&a.optionListeners&&"function"===typeof a.optionListeners[e]&&(r=a.optionListeners[e].call(t[a.pluginName],n))})),r}};function rt(t){var e=t.sortable,n=t.rootEl,r=t.name,a=t.targetEl,i=t.cloneEl,s=t.toEl,u=t.fromEl,c=t.oldIndex,l=t.newIndex,d=t.oldDraggableIndex,h=t.newDraggableIndex,p=t.originalEvent,f=t.putSortable,b=t.extraEventProperties;if(e=e||n&&n[Y],e){var y,v=e.options,x="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||m||g?(y=document.createEvent("Event"),y.initEvent(r,!0,!0)):y=new CustomEvent(r,{bubbles:!0,cancelable:!0}),y.to=s||n,y.from=u||n,y.item=a||n,y.clone=i,y.oldIndex=c,y.newIndex=l,y.oldDraggableIndex=d,y.newDraggableIndex=h,y.originalEvent=p,y.pullMode=f?f.lastPutMode:void 0;var w=o({},b,nt.getEventProperties(r,e));for(var k in w)y[k]=w[k];n&&n.dispatchEvent(y),v[x]&&v[x].call(e,y)}}var at=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,a=u(n,["evt"]);nt.pluginEvent.bind(Zt)(t,e,o({dragEl:ot,parentEl:st,ghostEl:ut,rootEl:ct,nextEl:lt,lastDownEl:dt,cloneEl:ht,cloneHidden:pt,dragStarted:Ct,putSortable:vt,activeSortable:Zt.active,originalEvent:r,oldIndex:ft,oldDraggableIndex:gt,newIndex:mt,newDraggableIndex:bt,hideGhostForTarget:Kt,unhideGhostForTarget:Xt,cloneNowHidden:function(){pt=!0},cloneNowShown:function(){pt=!1},dispatchSortableEvent:function(t){it({sortable:e,name:t,originalEvent:r})}},a))};function it(t){rt(o({putSortable:vt,cloneEl:ht,targetEl:ot,rootEl:ct,oldIndex:ft,oldDraggableIndex:gt,newIndex:mt,newDraggableIndex:bt},t))}var ot,st,ut,ct,lt,dt,ht,pt,ft,mt,gt,bt,yt,vt,xt,wt,kt,St,Ot,_t,Ct,Tt,It,Nt,Et,At=!1,Rt=!1,jt=[],Dt=!1,Ft=!1,Mt=[],Pt=!1,$t=[],Lt="undefined"!==typeof document,Bt=v,zt=g||m?"cssFloat":"float",Wt=Lt&&!x&&!v&&"draggable"in document.createElement("div"),Vt=function(){if(Lt){if(m)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),Ut=function(t,e){var n=E(t),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),a=M(t,0,e),i=M(t,1,e),o=a&&E(a),s=i&&E(i),u=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+D(a).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+D(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&o["float"]&&"none"!==o["float"]){var l="left"===o["float"]?"left":"right";return!i||"both"!==s.clear&&s.clear!==l?"horizontal":"vertical"}return a&&("block"===o.display||"flex"===o.display||"table"===o.display||"grid"===o.display||u>=r&&"none"===n[zt]||i&&"none"===n[zt]&&u+c>r)?"vertical":"horizontal"},Gt=function(t,e,n){var r=n?t.left:t.top,a=n?t.right:t.bottom,i=n?t.width:t.height,o=n?e.left:e.top,s=n?e.right:e.bottom,u=n?e.width:e.height;return r===o||a===s||r+i/2===o+u/2},Ht=function(t,e){var n;return jt.some((function(r){if(!P(r)){var a=D(r),i=r[Y].options.emptyInsertThreshold,o=t>=a.left-i&&t<=a.right+i,s=e>=a.top-i&&e<=a.bottom+i;return i&&o&&s?n=r:void 0}})),n},qt=function(t){function e(t,n){return function(r,a,i,o){var s=r.options.group.name&&a.options.group.name&&r.options.group.name===a.options.group.name;if(null==t&&(n||s))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"===typeof t)return e(t(r,a,i,o),n)(r,a,i,o);var u=(n?r:a).options.group.name;return!0===t||"string"===typeof t&&t===u||t.join&&t.indexOf(u)>-1}}var n={},a=t.group;a&&"object"==r(a)||(a={name:a}),n.name=a.name,n.checkPull=e(a.pull,!0),n.checkPut=e(a.put),n.revertClone=a.revertClone,t.group=n},Kt=function(){!Vt&&ut&&E(ut,"display","none")},Xt=function(){!Vt&&ut&&E(ut,"display","")};Lt&&document.addEventListener("click",(function(t){if(Rt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Rt=!1,!1}),!0);var Yt=function(t){if(ot){t=t.touches?t.touches[0]:t;var e=Ht(t.clientX,t.clientY);if(e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[Y]._onDragOver(n)}}},Jt=function(t){ot&&ot.parentNode[Y]._isOutsideThisEl(t.target)};function Zt(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=i({},e),t[Y]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ut(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Zt.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var r in nt.initializePlugins(this,t,n),n)!(r in e)&&(e[r]=n[r]);for(var a in qt(e),this)"_"===a.charAt(0)&&"function"===typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!e.forceFallback&&Wt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?k(t,"pointerdown",this._onTapStart):(k(t,"mousedown",this._onTapStart),k(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(k(t,"dragover",this),k(t,"dragenter",this)),jt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),i(this,J())}function Qt(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function te(t,e,n,r,a,i,o,s){var u,c,l=t[Y],d=l.options.onMove;return!window.CustomEvent||m||g?(u=document.createEvent("Event"),u.initEvent("move",!0,!0)):u=new CustomEvent("move",{bubbles:!0,cancelable:!0}),u.to=e,u.from=t,u.dragged=n,u.draggedRect=r,u.related=a||e,u.relatedRect=i||D(e),u.willInsertAfter=s,u.originalEvent=o,t.dispatchEvent(u),d&&(c=d.call(l,u,o)),c}function ee(t){t.draggable=!1}function ne(){Pt=!1}function re(t,e,n){var r=D(P(n.el,n.options.draggable)),a=10;return e?t.clientX>r.right+a||t.clientX<=r.right&&t.clientY>r.bottom&&t.clientX>=r.left:t.clientX>r.right&&t.clientY>r.top||t.clientX<=r.right&&t.clientY>r.bottom+a}function ae(t,e,n,r,a,i,o,s){var u=r?t.clientY:t.clientX,c=r?n.height:n.width,l=r?n.top:n.left,d=r?n.bottom:n.right,h=!1;if(!o)if(s&&Nt<c*a){if(!Dt&&(1===It?u>l+c*i/2:u<d-c*i/2)&&(Dt=!0),Dt)h=!0;else if(1===It?u<l+Nt:u>d-Nt)return-It}else if(u>l+c*(1-a)/2&&u<d-c*(1-a)/2)return ie(e);return h=h||o,h&&(u<l+c*i/2||u>d-c*i/2)?u>l+c/2?1:-1:0}function ie(t){return $(ot)<$(t)?1:-1}function oe(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;while(n--)r+=e.charCodeAt(n);return r.toString(36)}function se(t){$t.length=0;var e=t.getElementsByTagName("input"),n=e.length;while(n--){var r=e[n];r.checked&&$t.push(r)}}function ue(t){return setTimeout(t,0)}function ce(t){return clearTimeout(t)}Zt.prototype={constructor:Zt,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(Tt=null)},_getDirection:function(t,e){return"function"===typeof this.options.direction?this.options.direction.call(this,t,e,ot):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,r=this.options,a=r.preventOnFilter,i=t.type,o=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(o||t).target,u=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,c=r.filter;if(se(n),!ot&&!(/mousedown|pointerdown/.test(i)&&0!==t.button||r.disabled)&&!u.isContentEditable&&(s=C(s,r.draggable,n,!1),(!s||!s.animated)&&dt!==s)){if(ft=$(s),gt=$(s,r.draggable),"function"===typeof c){if(c.call(this,t,s,this))return it({sortable:e,rootEl:u,name:"filter",targetEl:s,toEl:n,fromEl:n}),at("filter",e,{evt:t}),void(a&&t.cancelable&&t.preventDefault())}else if(c&&(c=c.split(",").some((function(r){if(r=C(u,r.trim(),n,!1),r)return it({sortable:e,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),at("filter",e,{evt:t}),!0})),c))return void(a&&t.cancelable&&t.preventDefault());r.handle&&!C(u,r.handle,n,!1)||this._prepareDragStart(t,o,s)}}},_prepareDragStart:function(t,e,n){var r,a=this,i=a.el,o=a.options,s=i.ownerDocument;if(n&&!ot&&n.parentNode===i){var u=D(n);if(ct=i,ot=n,st=ot.parentNode,lt=ot.nextSibling,dt=n,yt=o.group,Zt.dragged=ot,xt={target:ot,clientX:(e||t).clientX,clientY:(e||t).clientY},Ot=xt.clientX-u.left,_t=xt.clientY-u.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,ot.style["will-change"]="all",r=function(){at("delayEnded",a,{evt:t}),Zt.eventCanceled?a._onDrop():(a._disableDelayedDragEvents(),!b&&a.nativeDraggable&&(ot.draggable=!0),a._triggerDragStart(t,e),it({sortable:a,name:"choose",originalEvent:t}),N(ot,o.chosenClass,!0))},o.ignore.split(",").forEach((function(t){R(ot,t.trim(),ee)})),k(s,"dragover",Yt),k(s,"mousemove",Yt),k(s,"touchmove",Yt),k(s,"mouseup",a._onDrop),k(s,"touchend",a._onDrop),k(s,"touchcancel",a._onDrop),b&&this.nativeDraggable&&(this.options.touchStartThreshold=4,ot.draggable=!0),at("delayStart",this,{evt:t}),!o.delay||o.delayOnTouchOnly&&!e||this.nativeDraggable&&(g||m))r();else{if(Zt.eventCanceled)return void this._onDrop();k(s,"mouseup",a._disableDelayedDrag),k(s,"touchend",a._disableDelayedDrag),k(s,"touchcancel",a._disableDelayedDrag),k(s,"mousemove",a._delayedDragTouchMoveHandler),k(s,"touchmove",a._delayedDragTouchMoveHandler),o.supportPointer&&k(s,"pointermove",a._delayedDragTouchMoveHandler),a._dragStartTimer=setTimeout(r,o.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){ot&&ee(ot),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;S(t,"mouseup",this._disableDelayedDrag),S(t,"touchend",this._disableDelayedDrag),S(t,"touchcancel",this._disableDelayedDrag),S(t,"mousemove",this._delayedDragTouchMoveHandler),S(t,"touchmove",this._delayedDragTouchMoveHandler),S(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?k(document,"pointermove",this._onTouchMove):k(document,e?"touchmove":"mousemove",this._onTouchMove):(k(ot,"dragend",this),k(ct,"dragstart",this._onDragStart));try{document.selection?ue((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(t,e){if(At=!1,ct&&ot){at("dragStarted",this,{evt:e}),this.nativeDraggable&&k(document,"dragover",Jt);var n=this.options;!t&&N(ot,n.dragClass,!1),N(ot,n.ghostClass,!0),Zt.active=this,t&&this._appendGhost(),it({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(wt){this._lastX=wt.clientX,this._lastY=wt.clientY,Kt();var t=document.elementFromPoint(wt.clientX,wt.clientY),e=t;while(t&&t.shadowRoot){if(t=t.shadowRoot.elementFromPoint(wt.clientX,wt.clientY),t===e)break;e=t}if(ot.parentNode[Y]._isOutsideThisEl(t),e)do{if(e[Y]){var n=void 0;if(n=e[Y]._onDragOver({clientX:wt.clientX,clientY:wt.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);Xt()}},_onTouchMove:function(t){if(xt){var e=this.options,n=e.fallbackTolerance,r=e.fallbackOffset,a=t.touches?t.touches[0]:t,i=ut&&A(ut,!0),o=ut&&i&&i.a,s=ut&&i&&i.d,u=Bt&&Et&&L(Et),c=(a.clientX-xt.clientX+r.x)/(o||1)+(u?u[0]-Mt[0]:0)/(o||1),l=(a.clientY-xt.clientY+r.y)/(s||1)+(u?u[1]-Mt[1]:0)/(s||1);if(!Zt.active&&!At){if(n&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(ut){i?(i.e+=c-(kt||0),i.f+=l-(St||0)):i={a:1,b:0,c:0,d:1,e:c,f:l};var d="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");E(ut,"webkitTransform",d),E(ut,"mozTransform",d),E(ut,"msTransform",d),E(ut,"transform",d),kt=c,St=l,wt=a}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!ut){var t=this.options.fallbackOnBody?document.body:ct,e=D(ot,!0,Bt,!0,t),n=this.options;if(Bt){Et=t;while("static"===E(Et,"position")&&"none"===E(Et,"transform")&&Et!==document)Et=Et.parentNode;Et!==document.body&&Et!==document.documentElement?(Et===document&&(Et=j()),e.top+=Et.scrollTop,e.left+=Et.scrollLeft):Et=j(),Mt=L(Et)}ut=ot.cloneNode(!0),N(ut,n.ghostClass,!1),N(ut,n.fallbackClass,!0),N(ut,n.dragClass,!0),E(ut,"transition",""),E(ut,"transform",""),E(ut,"box-sizing","border-box"),E(ut,"margin",0),E(ut,"top",e.top),E(ut,"left",e.left),E(ut,"width",e.width),E(ut,"height",e.height),E(ut,"opacity","0.8"),E(ut,"position",Bt?"absolute":"fixed"),E(ut,"zIndex","100000"),E(ut,"pointerEvents","none"),Zt.ghost=ut,t.appendChild(ut),E(ut,"transform-origin",Ot/parseInt(ut.style.width)*100+"% "+_t/parseInt(ut.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,r=t.dataTransfer,a=n.options;at("dragStart",this,{evt:t}),Zt.eventCanceled?this._onDrop():(at("setupClone",this),Zt.eventCanceled||(ht=q(ot),ht.draggable=!1,ht.style["will-change"]="",this._hideClone(),N(ht,this.options.chosenClass,!1),Zt.clone=ht),n.cloneId=ue((function(){at("clone",n),Zt.eventCanceled||(n.options.removeCloneOnHide||ct.insertBefore(ht,ot),n._hideClone(),it({sortable:n,name:"clone"}))})),!e&&N(ot,a.dragClass,!0),e?(Rt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(S(document,"mouseup",n._onDrop),S(document,"touchend",n._onDrop),S(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",a.setData&&a.setData.call(n,r,ot)),k(document,"drop",n),E(ot,"transform","translateZ(0)")),At=!0,n._dragStartId=ue(n._dragStarted.bind(n,e,t)),k(document,"selectstart",n),Ct=!0,y&&E(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,r,a,i=this.el,s=t.target,u=this.options,c=u.group,l=Zt.active,d=yt===c,h=u.sort,p=vt||l,f=this,m=!1;if(!Pt){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),s=C(s,u.draggable,i,!0),R("dragOver"),Zt.eventCanceled)return m;if(ot.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||f._ignoreWhileAnimating===s)return M(!1);if(Rt=!1,l&&!u.disabled&&(d?h||(r=!ct.contains(ot)):vt===this||(this.lastPutMode=yt.checkPull(this,l,ot,t))&&c.checkPut(this,l,ot,t))){if(a="vertical"===this._getDirection(t,s),e=D(ot),R("dragOverValid"),Zt.eventCanceled)return m;if(r)return st=ct,j(),this._hideClone(),R("revert"),Zt.eventCanceled||(lt?ct.insertBefore(ot,lt):ct.appendChild(ot)),M(!0);var g=P(i,u.draggable);if(!g||re(t,a,this)&&!g.animated){if(g===ot)return M(!1);if(g&&i===t.target&&(s=g),s&&(n=D(s)),!1!==te(ct,i,ot,e,s,n,t,!!s))return j(),i.appendChild(ot),st=i,L(),M(!0)}else if(s.parentNode===i){n=D(s);var b,y,v=0,x=ot.parentNode!==i,w=!Gt(ot.animated&&ot.toRect||e,s.animated&&s.toRect||n,a),k=a?"top":"left",S=F(s,"top","top")||F(ot,"top","top"),O=S?S.scrollTop:void 0;if(Tt!==s&&(b=n[k],Dt=!1,Ft=!w&&u.invertSwap||x),v=ae(t,s,n,a,w?1:u.swapThreshold,null==u.invertedSwapThreshold?u.swapThreshold:u.invertedSwapThreshold,Ft,Tt===s),0!==v){var _=$(ot);do{_-=v,y=st.children[_]}while(y&&("none"===E(y,"display")||y===ut))}if(0===v||y===s)return M(!1);Tt=s,It=v;var T=s.nextElementSibling,I=!1;I=1===v;var A=te(ct,i,ot,e,s,n,t,I);if(!1!==A)return 1!==A&&-1!==A||(I=1===A),Pt=!0,setTimeout(ne,30),j(),I&&!T?i.appendChild(ot):s.parentNode.insertBefore(ot,I?T:s),S&&H(S,0,O-S.scrollTop),st=ot.parentNode,void 0===b||Ft||(Nt=Math.abs(b-D(s)[k])),L(),M(!0)}if(i.contains(ot))return M(!1)}return!1}function R(u,c){at(u,f,o({evt:t,isOwner:d,axis:a?"vertical":"horizontal",revert:r,dragRect:e,targetRect:n,canSort:h,fromSortable:p,target:s,completed:M,onMove:function(n,r){return te(ct,i,ot,e,n,D(n),t,r)},changed:L},c))}function j(){R("dragOverAnimationCapture"),f.captureAnimationState(),f!==p&&p.captureAnimationState()}function M(e){return R("dragOverCompleted",{insertion:e}),e&&(d?l._hideClone():l._showClone(f),f!==p&&(N(ot,vt?vt.options.ghostClass:l.options.ghostClass,!1),N(ot,u.ghostClass,!0)),vt!==f&&f!==Zt.active?vt=f:f===Zt.active&&vt&&(vt=null),p===f&&(f._ignoreWhileAnimating=s),f.animateAll((function(){R("dragOverAnimationComplete"),f._ignoreWhileAnimating=null})),f!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===ot&&!ot.animated||s===i&&!s.animated)&&(Tt=null),u.dragoverBubble||t.rootEl||s===document||(ot.parentNode[Y]._isOutsideThisEl(t.target),!e&&Yt(t)),!u.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),m=!0}function L(){mt=$(ot),bt=$(ot,u.draggable),it({sortable:f,name:"change",toEl:i,newIndex:mt,newDraggableIndex:bt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){S(document,"mousemove",this._onTouchMove),S(document,"touchmove",this._onTouchMove),S(document,"pointermove",this._onTouchMove),S(document,"dragover",Yt),S(document,"mousemove",Yt),S(document,"touchmove",Yt)},_offUpEvents:function(){var t=this.el.ownerDocument;S(t,"mouseup",this._onDrop),S(t,"touchend",this._onDrop),S(t,"pointerup",this._onDrop),S(t,"touchcancel",this._onDrop),S(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;mt=$(ot),bt=$(ot,n.draggable),at("drop",this,{evt:t}),st=ot&&ot.parentNode,mt=$(ot),bt=$(ot,n.draggable),Zt.eventCanceled||(At=!1,Ft=!1,Dt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),ce(this.cloneId),ce(this._dragStartId),this.nativeDraggable&&(S(document,"drop",this),S(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),y&&E(document.body,"user-select",""),E(ot,"transform",""),t&&(Ct&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),ut&&ut.parentNode&&ut.parentNode.removeChild(ut),(ct===st||vt&&"clone"!==vt.lastPutMode)&&ht&&ht.parentNode&&ht.parentNode.removeChild(ht),ot&&(this.nativeDraggable&&S(ot,"dragend",this),ee(ot),ot.style["will-change"]="",Ct&&!At&&N(ot,vt?vt.options.ghostClass:this.options.ghostClass,!1),N(ot,this.options.chosenClass,!1),it({sortable:this,name:"unchoose",toEl:st,newIndex:null,newDraggableIndex:null,originalEvent:t}),ct!==st?(mt>=0&&(it({rootEl:st,name:"add",toEl:st,fromEl:ct,originalEvent:t}),it({sortable:this,name:"remove",toEl:st,originalEvent:t}),it({rootEl:st,name:"sort",toEl:st,fromEl:ct,originalEvent:t}),it({sortable:this,name:"sort",toEl:st,originalEvent:t})),vt&&vt.save()):mt!==ft&&mt>=0&&(it({sortable:this,name:"update",toEl:st,originalEvent:t}),it({sortable:this,name:"sort",toEl:st,originalEvent:t})),Zt.active&&(null!=mt&&-1!==mt||(mt=ft,bt=gt),it({sortable:this,name:"end",toEl:st,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){at("nulling",this),ct=ot=st=ut=lt=ht=dt=pt=xt=wt=Ct=mt=bt=ft=gt=Tt=It=vt=yt=Zt.dragged=Zt.ghost=Zt.clone=Zt.active=null,$t.forEach((function(t){t.checked=!0})),$t.length=kt=St=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":ot&&(this._onDragOver(t),Qt(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t,e=[],n=this.el.children,r=0,a=n.length,i=this.options;r<a;r++)t=n[r],C(t,i.draggable,this.el,!1)&&e.push(t.getAttribute(i.dataIdAttr)||oe(t));return e},sort:function(t){var e={},n=this.el;this.toArray().forEach((function(t,r){var a=n.children[r];C(a,this.options.draggable,n,!1)&&(e[t]=a)}),this),t.forEach((function(t){e[t]&&(n.removeChild(e[t]),n.appendChild(e[t]))}))},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return C(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var r=nt.modifyOption(this,t,e);n[t]="undefined"!==typeof r?r:e,"group"===t&&qt(n)},destroy:function(){at("destroy",this);var t=this.el;t[Y]=null,S(t,"mousedown",this._onTapStart),S(t,"touchstart",this._onTapStart),S(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(S(t,"dragover",this),S(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),jt.splice(jt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!pt){if(at("hideClone",this),Zt.eventCanceled)return;E(ht,"display","none"),this.options.removeCloneOnHide&&ht.parentNode&&ht.parentNode.removeChild(ht),pt=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(pt){if(at("showClone",this),Zt.eventCanceled)return;ct.contains(ot)&&!this.options.group.revertClone?ct.insertBefore(ht,ot):lt?ct.insertBefore(ht,lt):ct.appendChild(ht),this.options.group.revertClone&&this.animate(ot,ht),E(ht,"display",""),pt=!1}}else this._hideClone()}},Lt&&k(document,"touchmove",(function(t){(Zt.active||At)&&t.cancelable&&t.preventDefault()})),Zt.utils={on:k,off:S,css:E,find:R,is:function(t,e){return!!C(t,e,t,!1)},extend:W,throttle:U,closest:C,toggleClass:N,clone:q,index:$,nextTick:ue,cancelNextTick:ce,detectDirection:Ut,getChild:M},Zt.get=function(t){return t[Y]},Zt.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&(Zt.utils=o({},Zt.utils,t.utils)),nt.mount(t)}))},Zt.create=function(t,e){return new Zt(t,e)},Zt.version=p;var le,de,he,pe,fe,me,ge=[],be=!1;function ye(){function t(){for(var t in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?k(document,"dragover",this._handleAutoScroll):this.options.supportPointer?k(document,"pointermove",this._handleFallbackAutoScroll):e.touches?k(document,"touchmove",this._handleFallbackAutoScroll):k(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?S(document,"dragover",this._handleAutoScroll):(S(document,"pointermove",this._handleFallbackAutoScroll),S(document,"touchmove",this._handleFallbackAutoScroll),S(document,"mousemove",this._handleFallbackAutoScroll)),xe(),ve(),G()},nulling:function(){fe=de=le=be=me=he=pe=null,ge.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,r=(t.touches?t.touches[0]:t).clientX,a=(t.touches?t.touches[0]:t).clientY,i=document.elementFromPoint(r,a);if(fe=t,e||g||m||y){ke(t,this.options,i,e);var o=z(i,!0);!be||me&&r===he&&a===pe||(me&&xe(),me=setInterval((function(){var i=z(document.elementFromPoint(r,a),!0);i!==o&&(o=i,ve()),ke(t,n.options,i,e)}),10),he=r,pe=a)}else{if(!this.options.bubbleScroll||z(i,!0)===j())return void ve();ke(t,this.options,z(i,!1),!1)}}},i(t,{pluginName:"scroll",initializeByDefault:!0})}function ve(){ge.forEach((function(t){clearInterval(t.pid)})),ge=[]}function xe(){clearInterval(me)}var we,ke=U((function(t,e,n,r){if(e.scroll){var a,i=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,u=e.scrollSpeed,c=j(),l=!1;de!==n&&(de=n,ve(),le=e.scroll,a=e.scrollFn,!0===le&&(le=z(n,!0)));var d=0,h=le;do{var p=h,f=D(p),m=f.top,g=f.bottom,b=f.left,y=f.right,v=f.width,x=f.height,w=void 0,k=void 0,S=p.scrollWidth,O=p.scrollHeight,_=E(p),C=p.scrollLeft,T=p.scrollTop;p===c?(w=v<S&&("auto"===_.overflowX||"scroll"===_.overflowX||"visible"===_.overflowX),k=x<O&&("auto"===_.overflowY||"scroll"===_.overflowY||"visible"===_.overflowY)):(w=v<S&&("auto"===_.overflowX||"scroll"===_.overflowX),k=x<O&&("auto"===_.overflowY||"scroll"===_.overflowY));var I=w&&(Math.abs(y-i)<=s&&C+v<S)-(Math.abs(b-i)<=s&&!!C),N=k&&(Math.abs(g-o)<=s&&T+x<O)-(Math.abs(m-o)<=s&&!!T);if(!ge[d])for(var A=0;A<=d;A++)ge[A]||(ge[A]={});ge[d].vx==I&&ge[d].vy==N&&ge[d].el===p||(ge[d].el=p,ge[d].vx=I,ge[d].vy=N,clearInterval(ge[d].pid),0==I&&0==N||(l=!0,ge[d].pid=setInterval(function(){r&&0===this.layer&&Zt.active._onTouchMove(fe);var e=ge[this.layer].vy?ge[this.layer].vy*u:0,n=ge[this.layer].vx?ge[this.layer].vx*u:0;"function"===typeof a&&"continue"!==a.call(Zt.dragged.parentNode[Y],n,e,t,fe,ge[this.layer].el)||H(ge[this.layer].el,n,e)}.bind({layer:d}),24))),d++}while(e.bubbleScroll&&h!==c&&(h=z(h,!1)));be=l}}),30),Se=function(t){var e=t.originalEvent,n=t.putSortable,r=t.dragEl,a=t.activeSortable,i=t.dispatchSortableEvent,o=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(e){var u=n||a;o();var c=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,l=document.elementFromPoint(c.clientX,c.clientY);s(),u&&!u.el.contains(l)&&(i("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function Oe(){}function _e(){}function Ce(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(t){var e=t.dragEl;we=e},dragOverValid:function(t){var e=t.completed,n=t.target,r=t.onMove,a=t.activeSortable,i=t.changed,o=t.cancel;if(a.options.swap){var s=this.sortable.el,u=this.options;if(n&&n!==s){var c=we;!1!==r(n)?(N(n,u.swapClass,!0),we=n):we=null,c&&c!==we&&N(c,u.swapClass,!1)}i(),e(!0),o()}},drop:function(t){var e=t.activeSortable,n=t.putSortable,r=t.dragEl,a=n||this.sortable,i=this.options;we&&N(we,i.swapClass,!1),we&&(i.swap||n&&n.options.swap)&&r!==we&&(a.captureAnimationState(),a!==e&&e.captureAnimationState(),Te(r,we),a.animateAll(),a!==e&&e.animateAll())},nulling:function(){we=null}},i(t,{pluginName:"swap",eventProperties:function(){return{swapItem:we}}})}function Te(t,e){var n,r,a=t.parentNode,i=e.parentNode;a&&i&&!a.isEqualNode(e)&&!i.isEqualNode(t)&&(n=$(t),r=$(e),a.isEqualNode(i)&&n<r&&r++,a.insertBefore(e,a.children[n]),i.insertBefore(t,i.children[r]))}Oe.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=M(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(e,r):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:Se},i(Oe,{pluginName:"revertOnSpill"}),_e.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,r=n||this.sortable;r.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),r.animateAll()},drop:Se},i(_e,{pluginName:"removeOnSpill"});var Ie,Ne,Ee,Ae,Re,je=[],De=[],Fe=!1,Me=!1,Pe=!1;function $e(){function t(t){for(var e in this)"_"===e.charAt(0)&&"function"===typeof this[e]&&(this[e]=this[e].bind(this));t.options.supportPointer?k(document,"pointerup",this._deselectMultiDrag):(k(document,"mouseup",this._deselectMultiDrag),k(document,"touchend",this._deselectMultiDrag)),k(document,"keydown",this._checkKeyDown),k(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(e,n){var r="";je.length&&Ne===t?je.forEach((function(t,e){r+=(e?", ":"")+t.textContent})):r=n.textContent,e.setData("Text",r)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(t){var e=t.dragEl;Ee=e},delayEnded:function(){this.isMultiDrag=~je.indexOf(Ee)},setupClone:function(t){var e=t.sortable,n=t.cancel;if(this.isMultiDrag){for(var r=0;r<je.length;r++)De.push(q(je[r])),De[r].sortableIndex=je[r].sortableIndex,De[r].draggable=!1,De[r].style["will-change"]="",N(De[r],this.options.selectedClass,!1),je[r]===Ee&&N(De[r],this.options.chosenClass,!1);e._hideClone(),n()}},clone:function(t){var e=t.sortable,n=t.rootEl,r=t.dispatchSortableEvent,a=t.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||je.length&&Ne===e&&(Be(!0,n),r("clone"),a()))},showClone:function(t){var e=t.cloneNowShown,n=t.rootEl,r=t.cancel;this.isMultiDrag&&(Be(!1,n),De.forEach((function(t){E(t,"display","")})),e(),Re=!1,r())},hideClone:function(t){var e=this,n=(t.sortable,t.cloneNowHidden),r=t.cancel;this.isMultiDrag&&(De.forEach((function(t){E(t,"display","none"),e.options.removeCloneOnHide&&t.parentNode&&t.parentNode.removeChild(t)})),n(),Re=!0,r())},dragStartGlobal:function(t){t.sortable;!this.isMultiDrag&&Ne&&Ne.multiDrag._deselectMultiDrag(),je.forEach((function(t){t.sortableIndex=$(t)})),je=je.sort((function(t,e){return t.sortableIndex-e.sortableIndex})),Pe=!0},dragStarted:function(t){var e=this,n=t.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){je.forEach((function(t){t!==Ee&&E(t,"position","absolute")}));var r=D(Ee,!1,!0,!0);je.forEach((function(t){t!==Ee&&K(t,r)})),Me=!0,Fe=!0}n.animateAll((function(){Me=!1,Fe=!1,e.options.animation&&je.forEach((function(t){X(t)})),e.options.sort&&ze()}))}},dragOver:function(t){var e=t.target,n=t.completed,r=t.cancel;Me&&~je.indexOf(e)&&(n(!1),r())},revert:function(t){var e=t.fromSortable,n=t.rootEl,r=t.sortable,a=t.dragRect;je.length>1&&(je.forEach((function(t){r.addAnimationState({target:t,rect:Me?D(t):a}),X(t),t.fromRect=a,e.removeAnimationState(t)})),Me=!1,Le(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(t){var e=t.sortable,n=t.isOwner,r=t.insertion,a=t.activeSortable,i=t.parentEl,o=t.putSortable,s=this.options;if(r){if(n&&a._hideClone(),Fe=!1,s.animation&&je.length>1&&(Me||!n&&!a.options.sort&&!o)){var u=D(Ee,!1,!0,!0);je.forEach((function(t){t!==Ee&&(K(t,u),i.appendChild(t))})),Me=!0}if(!n)if(Me||ze(),je.length>1){var c=Re;a._showClone(e),a.options.animation&&!Re&&c&&De.forEach((function(t){a.addAnimationState({target:t,rect:Ae}),t.fromRect=Ae,t.thisAnimationDuration=null}))}else a._showClone(e)}},dragOverAnimationCapture:function(t){var e=t.dragRect,n=t.isOwner,r=t.activeSortable;if(je.forEach((function(t){t.thisAnimationDuration=null})),r.options.animation&&!n&&r.multiDrag.isMultiDrag){Ae=i({},e);var a=A(Ee,!0);Ae.top-=a.f,Ae.left-=a.e}},dragOverAnimationComplete:function(){Me&&(Me=!1,ze())},drop:function(t){var e=t.originalEvent,n=t.rootEl,r=t.parentEl,a=t.sortable,i=t.dispatchSortableEvent,o=t.oldIndex,s=t.putSortable,u=s||this.sortable;if(e){var c=this.options,l=r.children;if(!Pe)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),N(Ee,c.selectedClass,!~je.indexOf(Ee)),~je.indexOf(Ee))je.splice(je.indexOf(Ee),1),Ie=null,rt({sortable:a,rootEl:n,name:"deselect",targetEl:Ee,originalEvt:e});else{if(je.push(Ee),rt({sortable:a,rootEl:n,name:"select",targetEl:Ee,originalEvt:e}),e.shiftKey&&Ie&&a.el.contains(Ie)){var d,h,p=$(Ie),f=$(Ee);if(~p&&~f&&p!==f)for(f>p?(h=p,d=f):(h=f,d=p+1);h<d;h++)~je.indexOf(l[h])||(N(l[h],c.selectedClass,!0),je.push(l[h]),rt({sortable:a,rootEl:n,name:"select",targetEl:l[h],originalEvt:e}))}else Ie=Ee;Ne=u}if(Pe&&this.isMultiDrag){if((r[Y].options.sort||r!==n)&&je.length>1){var m=D(Ee),g=$(Ee,":not(."+this.options.selectedClass+")");if(!Fe&&c.animation&&(Ee.thisAnimationDuration=null),u.captureAnimationState(),!Fe&&(c.animation&&(Ee.fromRect=m,je.forEach((function(t){if(t.thisAnimationDuration=null,t!==Ee){var e=Me?D(t):m;t.fromRect=e,u.addAnimationState({target:t,rect:e})}}))),ze(),je.forEach((function(t){l[g]?r.insertBefore(t,l[g]):r.appendChild(t),g++})),o===$(Ee))){var b=!1;je.forEach((function(t){t.sortableIndex===$(t)||(b=!0)})),b&&i("update")}je.forEach((function(t){X(t)})),u.animateAll()}Ne=u}(n===r||s&&"clone"!==s.lastPutMode)&&De.forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}))}},nullingGlobal:function(){this.isMultiDrag=Pe=!1,De.length=0},destroyGlobal:function(){this._deselectMultiDrag(),S(document,"pointerup",this._deselectMultiDrag),S(document,"mouseup",this._deselectMultiDrag),S(document,"touchend",this._deselectMultiDrag),S(document,"keydown",this._checkKeyDown),S(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(t){if(("undefined"===typeof Pe||!Pe)&&Ne===this.sortable&&(!t||!C(t.target,this.options.draggable,this.sortable.el,!1))&&(!t||0===t.button))while(je.length){var e=je[0];N(e,this.options.selectedClass,!1),je.shift(),rt({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:e,originalEvt:t})}},_checkKeyDown:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(t){t.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},i(t,{pluginName:"multiDrag",utils:{select:function(t){var e=t.parentNode[Y];e&&e.options.multiDrag&&!~je.indexOf(t)&&(Ne&&Ne!==e&&(Ne.multiDrag._deselectMultiDrag(),Ne=e),N(t,e.options.selectedClass,!0),je.push(t))},deselect:function(t){var e=t.parentNode[Y],n=je.indexOf(t);e&&e.options.multiDrag&&~n&&(N(t,e.options.selectedClass,!1),je.splice(n,1))}},eventProperties:function(){var t=this,e=[],n=[];return je.forEach((function(r){var a;e.push({multiDragElement:r,index:r.sortableIndex}),a=Me&&r!==Ee?-1:Me?$(r,":not(."+t.options.selectedClass+")"):$(r),n.push({multiDragElement:r,index:a})})),{items:c(je),clones:[].concat(De),oldIndicies:e,newIndicies:n}},optionListeners:{multiDragKey:function(t){return t=t.toLowerCase(),"ctrl"===t?t="Control":t.length>1&&(t=t.charAt(0).toUpperCase()+t.substr(1)),t}}})}function Le(t,e){je.forEach((function(n,r){var a=e.children[n.sortableIndex+(t?Number(r):0)];a?e.insertBefore(n,a):e.appendChild(n)}))}function Be(t,e){De.forEach((function(n,r){var a=e.children[n.sortableIndex+(t?Number(r):0)];a?e.insertBefore(n,a):e.appendChild(n)}))}function ze(){je.forEach((function(t){t!==Ee&&t.parentNode&&t.parentNode.removeChild(t)}))}Zt.mount(new ye),Zt.mount(_e,Oe),e["default"]=Zt},aa82:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"requiredIf",prop:t},(function(e,n){return!(0,r.ref)(t,this,n)||(0,r.req)(e)}))};e.default=a},aadd:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},ab01:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n("2ca8"),a=n("60ee");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,n){return({inputs:i,attrs:o,backend:s})=>{const{x:u}=i;if(Object(a["a"])(u,t),"string"===u.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const c=s,l=c.data.get(u.dataId).values,d=r["util"].sizeFromShape(u.shape),h=n||u.dtype,p=r["util"].getArrayFromDType(h,d);for(let t=0;t<d;++t)p[t]=e(l[t],o);return c.makeTensorInfo(u.shape,h,p)}}function o(t,e,n){return({inputs:r,attrs:i,backend:o})=>{const{x:s}=r;if(Object(a["a"])(s,t),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const u=o,c=u.data.get(s.dataId).values,l=n||s.dtype,d=e(c,l,i);return u.makeTensorInfo(s.shape,l,d)}}},abee:function(t,e,n){},ac41:function(t,e){function n(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}t.exports=n},acaf:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t===e?1:0),s=Object(i["a"])(r["Equal"],o,null,"bool"),u={kernelName:r["Equal"],backendName:"cpu",kernelFunc:s}},acf4:function(t,e){},ad52:function(t,e,n){},ad71:function(t,e,n){"use strict";(function(e,r){var a=n("966d");t.exports=k;var i,o=n("e3db");k.ReadableState=w;n("faa1").EventEmitter;var s=function(t,e){return t.listeners(e).length},u=n("429b"),c=n("8707").Buffer,l=("undefined"!==typeof e?e:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};function d(t){return c.from(t)}function h(t){return c.isBuffer(t)||t instanceof l}var p=Object.create(n("3a7c"));p.inherits=n("3fb5");var f=n(11),m=void 0;m=f&&f.debuglog?f.debuglog("stream"):function(){};var g,b=n("5e1a"),y=n("4681");p.inherits(k,u);var v=["error","close","destroy","pause","resume"];function x(t,e,n){if("function"===typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?o(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}function w(t,e){i=i||n("b19a"),t=t||{};var r=e instanceof i;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var a=t.highWaterMark,o=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:r&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new b,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(g||(g=n("7d72").StringDecoder),this.decoder=new g(t.encoding),this.encoding=t.encoding)}function k(t){if(i=i||n("b19a"),!(this instanceof k))return new k(t);this._readableState=new w(t,this),this.readable=!0,t&&("function"===typeof t.read&&(this._read=t.read),"function"===typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function S(t,e,n,r,a){var i,o=t._readableState;null===e?(o.reading=!1,E(t,o)):(a||(i=_(o,e)),i?t.emit("error",i):o.objectMode||e&&e.length>0?("string"===typeof e||o.objectMode||Object.getPrototypeOf(e)===c.prototype||(e=d(e)),r?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):O(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(e=o.decoder.write(e),o.objectMode||0!==e.length?O(t,o,e,!1):j(t,o)):O(t,o,e,!1))):r||(o.reading=!1));return C(o)}function O(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&A(t)),j(t,e)}function _(t,e){var n;return h(e)||"string"===typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}function C(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}Object.defineProperty(k.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),k.prototype.destroy=y.destroy,k.prototype._undestroy=y.undestroy,k.prototype._destroy=function(t,e){this.push(null),e(t)},k.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"===typeof t&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=c.from(t,e),e=""),n=!0),S(this,t,e,!1,n)},k.prototype.unshift=function(t){return S(this,t,null,!0,!1)},k.prototype.isPaused=function(){return!1===this._readableState.flowing},k.prototype.setEncoding=function(t){return g||(g=n("7d72").StringDecoder),this._readableState.decoder=new g(t),this._readableState.encoding=t,this};var T=8388608;function I(t){return t>=T?t=T:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function N(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=I(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function E(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,A(t)}}function A(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(m("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?a.nextTick(R,t):R(t))}function R(t){m("emit readable"),t.emit("readable"),L(t)}function j(t,e){e.readingMore||(e.readingMore=!0,a.nextTick(D,t,e))}function D(t,e){var n=e.length;while(!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark){if(m("maybeReadMore read 0"),t.read(0),n===e.length)break;n=e.length}e.readingMore=!1}function F(t){return function(){var e=t._readableState;m("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&s(t,"data")&&(e.flowing=!0,L(t))}}function M(t){m("readable nexttick read 0"),t.read(0)}function P(t,e){e.resumeScheduled||(e.resumeScheduled=!0,a.nextTick($,t,e))}function $(t,e){e.reading||(m("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),L(t),e.flowing&&!e.reading&&t.read(0)}function L(t){var e=t._readableState;m("flow",e.flowing);while(e.flowing&&null!==t.read());}function B(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=z(t,e.buffer,e.decoder),n);var n}function z(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?W(t,e):V(t,e),r}function W(t,e){var n=e.head,r=1,a=n.data;t-=a.length;while(n=n.next){var i=n.data,o=t>i.length?i.length:t;if(o===i.length?a+=i:a+=i.slice(0,t),t-=o,0===t){o===i.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=i.slice(o));break}++r}return e.length-=r,a}function V(t,e){var n=c.allocUnsafe(t),r=e.head,a=1;r.data.copy(n),t-=r.data.length;while(r=r.next){var i=r.data,o=t>i.length?i.length:t;if(i.copy(n,n.length-t,0,o),t-=o,0===t){o===i.length?(++a,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=i.slice(o));break}++a}return e.length-=a,n}function U(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,a.nextTick(G,e,t))}function G(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function H(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}k.prototype.read=function(t){m("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return m("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?U(this):A(this),null;if(t=N(t,e),0===t&&e.ended)return 0===e.length&&U(this),null;var r,a=e.needReadable;return m("need readable",a),(0===e.length||e.length-t<e.highWaterMark)&&(a=!0,m("length less than watermark",a)),e.ended||e.reading?(a=!1,m("reading or ended",a)):a&&(m("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=N(n,e))),r=t>0?B(t,e):null,null===r?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&U(this)),null!==r&&this.emit("data",r),r},k.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},k.prototype.pipe=function(t,e){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,m("pipe count=%d opts=%j",i.pipesCount,e);var o=(!e||!1!==e.end)&&t!==r.stdout&&t!==r.stderr,u=o?l:w;function c(t,e){m("onunpipe"),t===n&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,p())}function l(){m("onend"),t.end()}i.endEmitted?a.nextTick(u):n.once("end",u),t.on("unpipe",c);var d=F(n);t.on("drain",d);var h=!1;function p(){m("cleanup"),t.removeListener("close",y),t.removeListener("finish",v),t.removeListener("drain",d),t.removeListener("error",b),t.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",w),n.removeListener("data",g),h=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||d()}var f=!1;function g(e){m("ondata"),f=!1;var r=t.write(e);!1!==r||f||((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==H(i.pipes,t))&&!h&&(m("false write response, pause",i.awaitDrain),i.awaitDrain++,f=!0),n.pause())}function b(e){m("onerror",e),w(),t.removeListener("error",b),0===s(t,"error")&&t.emit("error",e)}function y(){t.removeListener("finish",v),w()}function v(){m("onfinish"),t.removeListener("close",y),w()}function w(){m("unpipe"),n.unpipe(t)}return n.on("data",g),x(t,"error",b),t.once("close",y),t.once("finish",v),t.emit("pipe",n),i.flowing||(m("pipe resume"),n.resume()),t},k.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,a=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;i<a;i++)r[i].emit("unpipe",this,{hasUnpiped:!1});return this}var o=H(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},k.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&A(this):a.nextTick(M,this))}return n},k.prototype.addListener=k.prototype.on,k.prototype.resume=function(){var t=this._readableState;return t.flowing||(m("resume"),t.flowing=!0,P(this,t)),this},k.prototype.pause=function(){return m("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(m("pause"),this._readableState.flowing=!1,this.emit("pause")),this},k.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var a in t.on("end",(function(){if(m("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(a){if(m("wrapped data"),n.decoder&&(a=n.decoder.write(a)),(!n.objectMode||null!==a&&void 0!==a)&&(n.objectMode||a&&a.length)){var i=e.push(a);i||(r=!0,t.pause())}})),t)void 0===this[a]&&"function"===typeof t[a]&&(this[a]=function(e){return function(){return t[e].apply(t,arguments)}}(a));for(var i=0;i<v.length;i++)t.on(v[i],this.emit.bind(this,v[i]));return this._read=function(e){m("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),k._fromList=B}).call(this,n("c8ba"),n("4362"))},ad8e:function(t,e,n){"use strict";(function(t){n.d(e,"f",(function(){return u})),n.d(e,"e",(function(){return c})),n.d(e,"a",(function(){return p})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return m})),n.d(e,"c",(function(){return g})),n.d(e,"j",(function(){return b})),n.d(e,"h",(function(){return y})),n.d(e,"g",(function(){return v})),n.d(e,"i",(function(){return x})),n.d(e,"k",(function(){return w}));var r=n("d579"),a=n("bd82"),i=n("df00"),o=n("20aa");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const s=4;async function u(t,e){const n=[],r=[],a=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);for(let o=0;o<a.length;++o){const i=a[o],u=Array.isArray(t)?t[o].tensor:t[i];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype&&"complex64"!==u.dtype)throw new Error(`Unsupported dtype in weight '${i}': ${u.dtype}`);const c={name:i,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){const t=new Promise(async t=>{const e=await u.bytes(),n=e.reduce((t,e)=>t+e.length,0)+s*e.length,r=new Uint8Array(n);let a=0;for(let i=0;i<e.length;i++){const t=e[i],n=new Uint8Array(new Uint32Array([t.length]).buffer);r.set(n,a),a+=s,r.set(t,a),a+=t.length}t(r)});r.push(t)}else r.push(u.data());null!=e&&(c.group=e),n.push(c)}const i=await Promise.all(r);return{data:l(i),specs:n}}function c(t,e){const n={};let u,c=0;for(const l of e){const e=l.name,d=l.dtype,h=l.shape,p=Object(i["O"])(h);let f;if("quantization"in l){const n=l.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${l.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${l.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==d)throw new Error(`Weight ${l.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${d}.`)}const r=o["a"][n.dtype],a=t.slice(c,c+p*r),i="uint8"===n.dtype?new Uint8Array(a):new Uint16Array(a);if("float32"===d)if("uint8"===n.dtype||"uint16"===n.dtype){f=new Float32Array(i.length);for(let t=0;t<i.length;t++){const e=i[t];f[t]=e*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===u&&(u=_()),f=u(i)}else{if("int32"!==d)throw new Error(`Unsupported dtype in weight '${e}': ${d}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);f=new Int32Array(i.length);for(let t=0;t<i.length;t++){const e=i[t];f[t]=Math.round(e*n.scale+n.min)}}c+=p*r}else if("string"===d){const e=Object(i["O"])(l.shape);f=[];for(let n=0;n<e;n++){const e=new Uint32Array(t.slice(c,c+s))[0];c+=s;const n=new Uint8Array(t.slice(c,c+e));f.push(n),c+=e}}else{const i=o["a"][d],s=t.slice(c,c+p*i);if("float32"===d)f=new Float32Array(s);else if("int32"===d)f=new Int32Array(s);else if("bool"===d)f=new Uint8Array(s);else{if("complex64"!==d)throw new Error(`Unsupported dtype in weight '${e}': ${d}`);{f=new Float32Array(s);const t=new Float32Array(f.length/2),i=new Float32Array(f.length/2);for(let e=0;e<t.length;e++)t[e]=f[2*e],i[e]=f[2*e+1];const o=Object(a["a"])(t,h,"float32"),u=Object(a["a"])(i,h,"float32");n[e]=Object(r["a"])(o,u),o.dispose(),u.dispose()}}c+=p*i}"complex64"!==d&&(n[e]=Object(a["a"])(f,h,d))}return n}function l(t){if(null===t)throw new Error("Invalid input value: "+JSON.stringify(t));let e=0;const n=[];t.forEach(t=>{if(e+=t.byteLength,n.push(t.byteLength===t.buffer.byteLength?t:new t.constructor(t)),!(t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+t.constructor.name)});const r=new Uint8Array(e);let a=0;return n.forEach(t=>{r.set(new Uint8Array(t.buffer),a),a+=t.byteLength}),r.buffer}const d="undefined"!==typeof t&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function h(e){return d?t.byteLength(e):new Blob([e]).size}function p(e){if(d)return t.from(e).toString("base64");const n=new Uint8Array(e);let r="";for(let t=0,a=n.length;t<a;t++)r+=String.fromCharCode(n[t]);return btoa(r)}function f(e){if(d){const n=t.from(e,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}const n=atob(e),r=new Uint8Array(n.length);for(let t=0;t<n.length;++t)r.set([n.charCodeAt(t)],t);return r.buffer}function m(t){if(1===t.length)return t[0];let e=0;t.forEach(t=>{e+=t.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(t=>{n.set(new Uint8Array(t),r),r+=t.byteLength}),n.buffer}function g(t){const e="/";t=t.trim();while(t.endsWith(e))t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function b(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return null!=t.signature&&(n.signature=t.signature),null!=t.userDefinedMetadata&&(n.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(n.modelInitializer=t.modelInitializer),null!=t.trainingConfig&&(n.trainingConfig=t.trainingConfig),n}function y(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(null!=t.trainingConfig&&(r.trainingConfig=t.trainingConfig),null!=t.weightsManifest){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return null!=t.signature&&(r.signature=t.signature),null!=t.userDefinedMetadata&&(r.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(r.modelInitializer=t.modelInitializer),r}async function v(t,e){let n,r;return null!=t.weightsManifest&&([n,r]=await e(t.weightsManifest)),y(t,n,r)}function x(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==t.modelTopology?0:h(JSON.stringify(t.modelTopology)),weightSpecsBytes:null==t.weightSpecs?0:h(JSON.stringify(t.weightSpecs)),weightDataBytes:null==t.weightData?0:t.weightData.byteLength}}function w(t){const e=[];for(const n of t)e.push(...n.weights);return e}function k(){const t=t=>{let e=t<<13,n=0;while(0===(8388608&e))n-=8388608,e<<=1;return e&=-8388609,n+=947912704,e|n},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function S(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function O(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function _(){const t=k(),e=S(),n=O();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let o=0;o<r.length;o++){const a=r[o],s=t[n[a>>10]+(1023&a)]+e[a>>10];i[o]=s}return new Float32Array(a)}}}).call(this,n("b639").Buffer)},ae6f:function(t,e){},ae84:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>Math.exp(t)),s=Object(i["b"])(r["Exp"],o,"float32"),u={kernelName:r["Exp"],backendName:"cpu",kernelFunc:s}},ae86:function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e){const n=t.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=t[i]||1,s=e[e.length-1-a]||1;s>1&&1===o&&r.unshift(i)}return r}function a(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],i=e.length-r-1,o=e[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(t,e){const n=[],r=Math.max(t.length,e.length);for(let a=0;a<r;a++){let r=t[t.length-a-1];null==r&&(r=1);let i=e[e.length-a-1];if(null==i&&(i=1),1===r)n.unshift(i);else if(1===i)n.unshift(r);else{if(r!==i){const n=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(n)}n.unshift(r)}}return n}n.r(e),n.d(e,"getBroadcastDims",(function(){return r})),n.d(e,"getReductionAxes",(function(){return a})),n.d(e,"assertAndGetBroadcastShape",(function(){return i}))},aeae:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e=0){const n=Object(i["a"])(t,"x","step"),o={x:n},s={alpha:e};return r["a"].runKernel(a["Zc"],o,s)}const u=Object(o["b"])({step_:s})},af58:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>1/(1+Math.exp(-t))),s=Object(i["a"])(r["Sigmoid"],t=>1/(1+Math.exp(-t))),u={kernelName:r["Sigmoid"],backendName:"cpu",kernelFunc:s}},afd2:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("6128");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e){const n=[];for(let r=0;r<e.length;r++)e[r]&&n.push(r);const a=Object(r["a"])(t,"int32"),i=Object(r["a"])([n.length,t.length],"int32");for(let r=0;r<n.length;r++){const e=a.indexToLoc(n[r]),o=r*t.length;i.values.set(e,o)}return i.toTensor()}},b047:function(t,e){function n(t){return function(e){return t(e)}}t.exports=n},b0f1:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","relu6"),n={x:e};return r["a"].runKernel(a["uc"],n)}const u=Object(o["b"])({relu6_:s})},b181:function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"f",(function(){return d})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return u}));var r=n("219b"),a=n("4e56"),i=n("4ffe"),o=n("df00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){return o["b"](o["u"](t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const a=Object(i["a"])(e,"x","tf.grad","string_or_numeric"),s=null!=n?Object(i["a"])(n,"dy","tf.grad"):null;return r["a"].tidy(()=>{const{value:e,grads:n}=r["a"].gradients(()=>t(a),[a],s);return null!=s&&o["e"](e.shape,s.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),p(n),n[0]})}}function u(t){return o["b"](o["u"](t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{o["b"](Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const a=Object(i["b"])(e,"args","tf.grads","string_or_numeric"),s=null!=n?Object(i["a"])(n,"dy","tf.grads"):null;return r["a"].tidy(()=>{const{value:e,grads:n}=r["a"].gradients(()=>t(...a),a,s);return null!=s&&o["e"](e.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(n),n})}}function c(t){return o["b"](o["u"](t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{o["b"](e instanceof a["a"],()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),o["b"](null==n||n instanceof a["a"],()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:i,value:s}=r["a"].gradients(()=>t(e),[e],n);return p(i),{grad:i[0],value:s}}}function l(t){return o["b"](o["u"](t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{o["b"](Array.isArray(e)&&e.every(t=>t instanceof a["a"]),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),o["b"](null==n||n instanceof a["a"],()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const i=r["a"].gradients(()=>t(...e),e,n);return null!=n&&o["e"](i.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),p(i.grads),i}}function d(t,e){o["b"](o["u"](t),()=>"The f passed in variableGrads(f) must be a function"),o["b"](null==e||Array.isArray(e)&&e.every(t=>t instanceof a["c"]),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=null!=e;if(!n){e=[];for(const t in r["a"].registeredVariables)e.push(r["a"].registeredVariables[t])}const i=n?e.filter(t=>!t.trainable):null,s=e.length;e=e.filter(t=>t.trainable),o["b"](e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const u=!0,{value:c,grads:l}=r["a"].gradients(t,e,null,u);o["b"](l.some(t=>null!=t),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),o["b"](0===c.rank,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${c.rank} tensor`);const d={};return e.forEach((t,e)=>{null!=l[e]&&(d[t.name]=l[e])}),null!=i&&i.forEach(t=>d[t.name]=null),{value:c,grads:d}}function h(t){return r["a"].customGrad(t)}function p(t){const e=t.filter(t=>null==t).length;if(e>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}},b19a:function(t,e,n){"use strict";var r=n("966d"),a=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=d;var i=Object.create(n("3a7c"));i.inherits=n("3fb5");var o=n("ad71"),s=n("dc14");i.inherits(d,o);for(var u=a(s.prototype),c=0;c<u.length;c++){var l=u[c];d.prototype[l]||(d.prototype[l]=s.prototype[l])}function d(t){if(!(this instanceof d))return new d(t);o.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),d.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},b1e5:function(t,e,n){var r=n("a994"),a=1,i=Object.prototype,o=i.hasOwnProperty;function s(t,e,n,i,s,u){var c=n&a,l=r(t),d=l.length,h=r(e),p=h.length;if(d!=p&&!c)return!1;var f=d;while(f--){var m=l[f];if(!(c?m in e:o.call(e,m)))return!1}var g=u.get(t),b=u.get(e);if(g&&b)return g==e&&b==t;var y=!0;u.set(t,e),u.set(e,t);var v=c;while(++f<d){m=l[f];var x=t[m],w=e[m];if(i)var k=c?i(w,x,m,e,t,u):i(x,w,m,t,e,u);if(!(void 0===k?x===w||s(x,w,n,i,u):k)){y=!1;break}v||(v="constructor"==m)}if(y&&!v){var S=t.constructor,O=e.constructor;S==O||!("constructor"in t)||!("constructor"in e)||"function"==typeof S&&S instanceof S&&"function"==typeof O&&O instanceof O||(y=!1)}return u["delete"](t),u["delete"](e),y}t.exports=s},b218:function(t,e){var n=9007199254740991;function r(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}t.exports=r},b33b:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RGBA=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n,r=t.data,a=r.length,i=this.red(),o=this.green(),s=this.blue(),u=this.alpha();for(e=0;e<a;e+=4)n=1-u,r[e]=i*u+r[e]*n,r[e+1]=o*u+r[e+1]*n,r[e+2]=s*u+r[e+2]*n};e.RGBA=o,r.Factory.addGetterSetter(a.Node,"red",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),r.Factory.addGetterSetter(a.Node,"green",0,(function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)})),r.Factory.addGetterSetter(a.Node,"blue",0,i.RGBComponent,r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"alpha",1,(function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t}))},b37e:function(t,e,n){"use strict";(function(t){var e=n("32fe");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r={importFetch:()=>n(1)};let a;class i{constructor(){this.util=n(2),this.textEncoder=new this.util.TextEncoder}fetch(t,n){return null!=Object(e["c"])().global.fetch?Object(e["c"])().global.fetch(t,n):(null==a&&(a=r.importFetch()),a(t,n))}now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}encode(t,e){if("utf-8"!==e&&"utf8"!==e)throw new Error("Node built-in encoder only supports utf-8, but got "+e);return this.textEncoder.encode(t)}decode(t,e){return 0===t.length?"":new this.util.TextDecoder(e).decode(t)}}Object(e["c"])().get("IS_NODE")&&!Object(e["c"])().get("IS_BROWSER")&&Object(e["c"])().setPlatform("node",new i)}).call(this,n("4362"))},b4b0:function(t,e,n){var r=n("8d74"),a=n("1a8c"),i=n("ffd6"),o=NaN,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;function d(t){if("number"==typeof t)return t;if(i(t))return o;if(a(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=a(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var n=u.test(t);return n||c.test(t)?l(t.slice(2),n?2:8):s.test(t)?o:+t}t.exports=d},b4c0:function(t,e,n){var r=n("cb5a");function a(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}t.exports=a},b547:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return s}));var r=n("2ca8"),a=n("60ee");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const o=t=>{const{x:e}=t.inputs,n=t.backend;Object(a["a"])(e,"abs");let o=new Float32Array(r["util"].sizeFromShape(e.shape));const s=n.data.get(e.dataId).values;return o=i(s),n.makeOutput(o,e.shape,e.dtype)},s={kernelName:r["Abs"],backendName:"cpu",kernelFunc:o}},b5a7:function(t,e,n){var r=n("0b07"),a=n("2b3e"),i=r(a,"DataView");t.exports=i},b5ae:function(t,e,n){"use strict";function r(t){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"alpha",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"alphaNum",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"and",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(e,"between",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"decimal",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(e,"email",{enumerable:!0,get:function(){return u.default}}),e.helpers=void 0,Object.defineProperty(e,"integer",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(e,"ipAddress",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"macAddress",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(e,"maxLength",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(e,"maxValue",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(e,"minLength",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"minValue",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(e,"not",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(e,"numeric",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"or",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(e,"required",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(e,"requiredIf",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(e,"requiredUnless",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(e,"sameAs",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(e,"url",{enumerable:!0,get:function(){return b.default}});var a=I(n("6235")),i=I(n("3a54")),o=I(n("45b8")),s=I(n("ec11")),u=I(n("5d75")),c=I(n("c99d")),l=I(n("91d3")),d=I(n("2a12")),h=I(n("5db3")),p=I(n("d4f4")),f=I(n("aa82")),m=I(n("e652")),g=I(n("b6cb")),b=I(n("772d")),y=I(n("d294")),v=I(n("3360")),x=I(n("6417")),w=I(n("eb66")),k=I(n("46bc")),S=I(n("1331")),O=I(n("c301")),_=T(n("78ef"));function C(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(C=function(t){return t?n:e})(t)}function T(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==r(t)&&"function"!==typeof t)return{default:t};var n=C(e);if(n&&n.has(t))return n.get(t);var a={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if("default"!==o&&Object.prototype.hasOwnProperty.call(t,o)){var s=i?Object.getOwnPropertyDescriptor(t,o):null;s&&(s.get||s.set)?Object.defineProperty(a,o,s):a[o]=t[o]}return a.default=t,n&&n.set(t,a),a}function I(t){return t&&t.__esModule?t:{default:t}}e.helpers=_},b605:function(t,e,n){"use strict";n.r(e),function(t){n.d(e,"GraphModel",(function(){return Ut})),n.d(e,"loadGraphModel",(function(){return Gt})),n.d(e,"deregisterOp",(function(){return h})),n.d(e,"registerOp",(function(){return l})),n.d(e,"version_converter",(function(){return Ht}));var r,a,i=n("45ef"),o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t}).apply(this,arguments)};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s(t,e,n,r){return new(n||(n=Promise))((function(a,i){function o(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?a(t.value):new n((function(e){e(t.value)})).then(o,s)}u((r=r.apply(t,e||[])).next())}))}function u(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=e.call(t,o)}catch(t){i=[6,t],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(t){!function(t){t[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))}(a||(a={}));var c={};function l(t,e){var n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};c[t]=n}function d(t){return c[t]}function h(t){delete c[t]}function p(t,e,n,r){var a=e.inputParams[t];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return f(e.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return e.inputNames.slice(i,o).map((function(t){return f(t,n,r)}));var s=Array.prototype.slice.call(f(e.inputNames.slice(i)[0],n,r).dataSync());return"number"===a.type?s[0]:s}var u=e.attrParams[t];return u&&u.value}function f(t,e,n){var r=y(t),a=r[0],i=r[1],o=n.currentContextIds.find((function(t){return!!e[b(a,t)]}));return void 0!==o?e[b(a,o)][i]:void 0}function m(t,e,n){return e[b(t,n.currentContextId)]}function g(t,e){var n=y(t),r=n[0],a=n[1];return[b(r,e&&e.currentContextId),a]}function b(t,e){return e?t+"-"+e:t}function y(t){var e=t.lastIndexOf(":");return-1===e?[t,0]:[t.substring(0,e),Number(t.substring(e+1))]}function v(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}var x=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],w=Object.freeze({json:x}),k=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],S=Object.freeze({json:k}),O=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}],_=Object.freeze({json:O}),C=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],T=Object.freeze({json:C}),I=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],N=Object.freeze({json:I}),E=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],A=Object.freeze({json:E}),R=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],j=Object.freeze({json:R}),D=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],F=Object.freeze({json:D}),M=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],P=Object.freeze({json:M}),$=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],L=Object.freeze({json:$}),B=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],z=Object.freeze({json:B}),W=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],V=Object.freeze({json:W}),U=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}],G=Object.freeze({json:U}),H=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],q=Object.freeze({json:H}),K=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],X=Object.freeze({json:K}),Y=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}],J=Object.freeze({json:Y}),Z=function(){function t(){var t=[w,S,_,T,N,A,j,L,P,F,z,V,G,q,X,J],e=[].concat.apply([],t.map((function(t){return t.json})));this.opMappers=e.reduce((function(t,e){return t[e.tfOpName]=e,t}),{})}return Object.defineProperty(t,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),t.prototype.transformGraph=function(t,e){var n=this;void 0===e&&(e={});var r=[],a=[],i=t.node.reduce((function(t,e){return t[e.name]=n.mapNode(e),e.op.startsWith("Placeholder")&&r.push(t[e.name]),"Const"===e.op&&a.push(t[e.name]),t}),{}),o=[],s=[],u={},c={};null!=e&&(u=this.mapSignatureEntries(e.inputs),c=this.mapSignatureEntries(e.outputs));var l=Object.keys(i);return l.forEach((function(t){var e=i[t];e.inputNames.forEach((function(t){var n=g(t)[0];e.inputs.push(i[n]),i[n].children.push(e)}))})),0===Object.keys(c).length?l.forEach((function(t){var e=i[t];0===e.children.length&&s.push(e)})):Object.keys(c).forEach((function(t){var e=g(t)[0],n=i[e];null!=n&&(n.signatureKey=c[t],s.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((function(t){var e=g(t)[0],n=i[e];n&&(n.signatureKey=u[t],o.push(n))})):o=r,{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:e}},t.prototype.mapSignatureEntries=function(t){return Object.keys(t||{}).reduce((function(e,n){return e[t[n].name]=n,e}),{})},t.prototype.mapNode=function(t){var e=d(t.op)||this.opMappers[t.op]||{};null==t.attr&&(t.attr={});var n={name:t.name,op:t.op,category:e.category,inputNames:(t.input||[]).map((function(t){return t.startsWith("^")?t.substr(1):t})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:t.attr};return null!=e.inputs&&(n.inputParams=e.inputs.reduce((function(t,e){return t[e.name]={type:e.type,inputIndexStart:e.start,inputIndexEnd:e.end},t}),{})),null!=e.attrs&&(n.attrParams=e.attrs.reduce((function(e,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=et(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=et(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=lt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=lt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=rt(t.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=rt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=ct(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ct(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=nt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=nt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=ht(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ht(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=ut(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ut(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=dt(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=dt(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=it(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=it(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=ot(t.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=ot(t.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+t.op)}return e[n.name]={value:a,type:r},e}),{})),n},t}();function Q(e){var n=Object(i["env"])().global;if(void 0!==n.atob)return n.atob(e);if("undefined"!=typeof t)return new t(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function tt(t,e){var n=Array.isArray(t)?String.fromCharCode.apply(null,t):Q(t);return e?n:n.toLowerCase()}function et(t,e,n,r){void 0===r&&(r=!1);var a=t[e];return null!=a?tt(a.s,r):n}function nt(t,e,n){var r=t[e];return r?r.b:n}function rt(t,e,n){var r=t[e]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function at(t){switch("string"==typeof t&&(t=r[t]),t){case r.DT_FLOAT:return"float32";case r.DT_INT32:case r.DT_INT64:case r.DT_INT8:case r.DT_UINT8:return"int32";case r.DT_BOOL:return"bool";case r.DT_DOUBLE:return"float32";case r.DT_STRING:return"string";default:return null}}function it(t,e,n){var r=t[e];return r&&r.type?at(r.type):n}function ot(t,e,n){var r=t[e];return r&&r.list&&r.list.type?r.list.type.map((function(t){return at(t)})):n}function st(t){if(!t.unknownRank)return null!=t.dim?t.dim.map((function(t){return"number"==typeof t.size?t.size:parseInt(t.size,10)})):[]}function ut(t,e,n){var r=t[e];return r&&r.shape?st(r.shape):n}function ct(t,e,n){var r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(t){return"number"==typeof t?t:parseInt(t,10)})):n}function lt(t,e,n,r){void 0===r&&(r=!1);var a=t[e];return a&&a.list&&a.list.s?a.list.s.map((function(t){return tt(t,r)})):n}function dt(t,e,n){var r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map((function(t){return st(t)})):n}function ht(t,e,n){var r=t[e];return r&&r.list&&r.list.b?r.list.b:n}var pt=function(){function t(t,e,n){var r=this;this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(t){return r.getInput(t)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(t,e){return t[e]=r.getAttr(e),t}),{}))}return t.prototype.getInput=function(t){return f(t,this.tensorMap,this.context)},t.prototype.getAttr=function(t,e){var n=this.node.rawAttrs[t];if(null!=n.tensor)return f(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return rt(this.node.rawAttrs,t,e);if(null!=n.s)return et(this.node.rawAttrs,t,e);if(null!=n.b)return nt(this.node.rawAttrs,t,e);if(null!=n.shape)return ut(this.node.rawAttrs,t,e);if(null!=n.type)return it(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return ct(this.node.rawAttrs,t,e);if(null!=n.list.s)return lt(this.node.rawAttrs,t,e);if(null!=n.list.shape)return dt(this.node.rawAttrs,t,e);if(null!=n.list.b)return ht(this.node.rawAttrs,t,e);if(null!=n.list.type)return ot(this.node.rawAttrs,t,e)}return e},t}(),ft=function(t,e,n){switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[Object(i["add"])(p("a",t,e,n),p("b",t,e,n))];case"AddN":return[Object(i["addN"])(p("tensors",t,e,n))];case"FloorMod":case"Mod":return[Object(i["mod"])(p("a",t,e,n),p("b",t,e,n))];case"Mul":return[Object(i["mul"])(p("a",t,e,n),p("b",t,e,n))];case"RealDiv":case"Div":return[Object(i["div"])(p("a",t,e,n),p("b",t,e,n))];case"DivNoNan":return[Object(i["divNoNan"])(p("a",t,e,n),p("b",t,e,n))];case"FloorDiv":return[Object(i["floorDiv"])(p("a",t,e,n),p("b",t,e,n))];case"Sub":return[Object(i["sub"])(p("a",t,e,n),p("b",t,e,n))];case"Minimum":return[Object(i["minimum"])(p("a",t,e,n),p("b",t,e,n))];case"Maximum":return[Object(i["maximum"])(p("a",t,e,n),p("b",t,e,n))];case"Pow":return[Object(i["pow"])(p("a",t,e,n),p("b",t,e,n))];case"SquaredDifference":return[Object(i["squaredDifference"])(p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},mt=function(t,e,n){switch(t.op){case"Abs":case"ComplexAbs":return[Object(i["abs"])(p("x",t,e,n))];case"Acos":return[Object(i["acos"])(p("x",t,e,n))];case"Acosh":return[Object(i["acosh"])(p("x",t,e,n))];case"Asin":return[Object(i["asin"])(p("x",t,e,n))];case"Asinh":return[Object(i["asinh"])(p("x",t,e,n))];case"Atan":return[Object(i["atan"])(p("x",t,e,n))];case"Atan2":return[Object(i["atan2"])(p("x",t,e,n),p("y",t,e,n))];case"Atanh":return[Object(i["atanh"])(p("x",t,e,n))];case"Ceil":return[Object(i["ceil"])(p("x",t,e,n))];case"Complex":return[Object(i["complex"])(p("real",t,e,n),p("imag",t,e,n))];case"Cos":return[Object(i["cos"])(p("x",t,e,n))];case"Cosh":return[Object(i["cosh"])(p("x",t,e,n))];case"Elu":return[Object(i["elu"])(p("x",t,e,n))];case"Erf":return[Object(i["erf"])(p("x",t,e,n))];case"Exp":return[Object(i["exp"])(p("x",t,e,n))];case"Expm1":return[Object(i["expm1"])(p("x",t,e,n))];case"Floor":return[Object(i["floor"])(p("x",t,e,n))];case"Log":return[Object(i["log"])(p("x",t,e,n))];case"Log1p":return[Object(i["log1p"])(p("x",t,e,n))];case"Imag":return[Object(i["imag"])(p("x",t,e,n))];case"Neg":return[Object(i["neg"])(p("x",t,e,n))];case"Reciprocal":return[Object(i["reciprocal"])(p("x",t,e,n))];case"Real":return[Object(i["real"])(p("x",t,e,n))];case"Relu":return[Object(i["relu"])(p("x",t,e,n))];case"Round":return[Object(i["round"])(p("x",t,e,n))];case"Selu":return[Object(i["selu"])(p("x",t,e,n))];case"Sigmoid":return[Object(i["sigmoid"])(p("x",t,e,n))];case"Sin":return[Object(i["sin"])(p("x",t,e,n))];case"Sign":return[Object(i["sign"])(p("x",t,e,n))];case"Sinh":return[Object(i["sinh"])(p("x",t,e,n))];case"Softplus":return[Object(i["softplus"])(p("x",t,e,n))];case"Sqrt":return[Object(i["sqrt"])(p("x",t,e,n))];case"Square":return[Object(i["square"])(p("x",t,e,n))];case"Tanh":return[Object(i["tanh"])(p("x",t,e,n))];case"Tan":return[Object(i["tan"])(p("x",t,e,n))];case"Relu6":case"ClipByValue":return[Object(i["clipByValue"])(p("x",t,e,n),p("clipValueMin",t,e,n),p("clipValueMax",t,e,n))];case"Rsqrt":return[Object(i["rsqrt"])(f(t.inputNames[0],e,n))];case"Prod":return[Object(i["prod"])(p("x",t,e,n),p("axes",t,e,n))];case"LeakyRelu":return[Object(i["leakyRelu"])(p("x",t,e,n),p("alpha",t,e,n))];case"Prelu":return[Object(i["prelu"])(p("x",t,e,n),p("alpha",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},gt=function(){function t(e,n,r,a,i,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=t.nextId++}return Object.defineProperty(t.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),t.prototype.clearAndClose=function(){this.tensors.forEach((function(t){return t.tensor.dispose()})),this.tensors=[],this.closed_=!0},t.prototype.size=function(){return this.tensors.length},t.prototype.read=function(t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||t>=this.tensors.length)throw new Error("Tried to read from index "+t+", but array size is: "+this.tensors.length);var e=this.tensors[t];if(e.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+t+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor},t.prototype.readMany=function(t){var e=this;return t.map((function(t){return e.read(t)}))},t.prototype.write=function(t,e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error("Tried to write to index "+t+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+",\n          because the value dtype is "+e.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,e.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+t+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+t+", because it has already been written.");n.tensor=e,n.written=!0,this.tensors[t]=n},t.prototype.writeMany=function(t,e){var n=this;if(t.length!==e.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+t.length+" is not the same as tensors size: "+e.length+".");t.forEach((function(t,r){return n.write(t,e[r])}))},t.prototype.gather=function(t,e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+e);if(!t){t=[];for(var n=0;n<this.size();n++)t.push(n)}if(0===t.length)return Object(i["tensor"])([],[0].concat(this.elementShape));var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Object(i["stack"])(r,0)},t.prototype.concat=function(t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+t);if(0===this.size())return Object(i["tensor"])([],[0].concat(this.elementShape));for(var e=[],n=0;n<this.size();n++)e.push(n);var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),Object(i["concat"])(r,0)},t.prototype.scatter=function(t,e){if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+t.length+" vs. "+e.shape[0]);var n=Math.max.apply(Math,t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(t,Object(i["unstack"])(e,0))},t.prototype.split=function(t,e){var n=this;if(e.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+e.dtype);var r=0,a=t.map((function(t){return r+=t}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+e.shape);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+t.length+"), and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:e.size/r,s=[];Object(i["tidy"])((function(){e=e.reshape([1,r,o]);for(var u=0;u<t.length;++u){var c=[0,0===u?0:a[u-1],0],l=[1,t[u],o];s[u]=Object(i["slice"])(e,c,l).reshape(n.elementShape)}return s}));for(var u=[],c=0;c<t.length;c++)u[c]=c;this.writeMany(u,s)},t.prototype.assertShapesMatchAllowUndefinedSize=function(t,e,n){void 0===n&&(n=""),i["util"].assert(this.shapesEqualAllowUndefinedSize(t,e),(function(){return n+" Shapes "+t+" and "+e+" must match"}))},t.prototype.shapesEqualAllowUndefinedSize=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(-1!==t[n]&&-1!==e[n]&&t[n]!==e[n])return!1;return!0},t.nextId=0,t}(),bt=void 0,yt=function(t,e,n){return s(bt,void 0,void 0,(function(){var r,a,o,s,c,l,d,h,m,g,b,y,v,x,w,k,S,O,_,C,T,I,N,E,A,R,j,D,F,M,P,$,L,B,z;return u(this,(function(u){switch(u.label){case 0:switch(t.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[p("pred",t,e,n).clone()]];case 2:return r=p("pred",t,e,n),a=p("data",t,e,n),[4,r.data()];case 3:return[2,u.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(o=t.inputNames.find((function(t){return void 0!==f(t,e,n)})))?[f(o,e,n).clone()]:void 0];case 5:return s=p("frameName",t,e,n),c=p("tensor",t,e,n),n.enterFrame(s),[2,[c.clone()]];case 6:return l=p("tensor",t,e,n),n.exitFrame(),[2,[l.clone()]];case 7:return d=p("tensor",t,e,n),n.nextIteration(),[2,[d.clone()]];case 8:return h=p("size",t,e,n),m=p("dtype",t,e,n),g=p("elementShape",t,e,n),b=p("dynamicSize",t,e,n),y=p("clearAfterRead",t,e,n),v=p("identicalElementShapes",t,e,n),x=p("name",t,e,n),w=new gt(x,m,h,g,v,b,y),n.addTensorArray(w),[2,[Object(i["scalar"])(w.id),Object(i["scalar"])(1)]];case 9:return k=p("tensorArrayId",t,e,n),S=p("index",t,e,n),O=p("tensor",t,e,n),n.getTensorArray(k).write(S,O),[2,[Object(i["scalar"])(1)]];case 10:return _=p("tensorArrayId",t,e,n),C=p("index",t,e,n),[2,[n.getTensorArray(_).read(C)]];case 11:return T=p("tensorArrayId",t,e,n),I=p("indices",t,e,n),N=p("dtype",t,e,n),[2,[n.getTensorArray(T).gather(I,N)]];case 12:return E=p("tensorArrayId",t,e,n),A=p("indices",t,e,n),R=p("tensor",t,e,n),n.getTensorArray(E).scatter(A,R),[2,[Object(i["scalar"])(1)]];case 13:return j=p("tensorArrayId",t,e,n),D=n.getTensorArray(j),F=p("dtype",t,e,n),[2,[D.concat(F)]];case 14:return M=p("tensorArrayId",t,e,n),P=p("tensor",t,e,n),$=p("lengths",t,e,n),n.getTensorArray(M).split($,P),[2,[Object(i["scalar"])(1)]];case 15:return L=p("tensorArrayId",t,e,n),B=n.getTensorArray(L),[2,[Object(i["scalar"])(B.size(),"int32")]];case 16:return z=p("tensorArrayId",t,e,n),n.getTensorArray(z).clearAndClose(),[2,[Object(i["scalar"])(0)]];case 17:throw TypeError("Node type "+t.op+" is not implemented")}}))}))},vt=function(t,e,n){switch(t.op){case"Conv1D":var r=p("stride",t,e,n),a=p("pad",t,e,n),o=p("dataFormat",t,e,n).toUpperCase(),s=p("dilation",t,e,n);return[Object(i["conv1d"])(p("x",t,e,n),p("filter",t,e,n),r,a,o,s)];case"Conv2D":r=p("strides",t,e,n),a=p("pad",t,e,n),o=p("dataFormat",t,e,n).toUpperCase();var u=p("dilations",t,e,n);return[Object(i["conv2d"])(p("x",t,e,n),p("filter",t,e,n),[r[1],r[2]],a,o,[u[1],u[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var c=p("fusedOps",t,e,n),l=c[0],d=c[1],h="biasadd"===l,f="prelu"===d,m="fusedbatchnorm"===l,g=p("numArgs",t,e,n);if(h){if(f&&2!==g)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!f&&1!==g)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(m)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=p("strides",t,e,n),a=p("pad",t,e,n),o=p("dataFormat",t,e,n).toUpperCase(),u=p("dilations",t,e,n);var b=p("args",t,e,n),y=b[0],v=b[1];return[("_FusedConv2D"===t.op?i["fused"].conv2d:i["fused"].depthwiseConv2d)({x:p("x",t,e,n),filter:p("filter",t,e,n),strides:[r[1],r[2]],pad:a,dataFormat:o,dilations:[u[1],u[2]],bias:y,activation:d,preluActivationWeights:v})];case"Conv2DBackpropInput":case"Conv2dTranspose":var x=p("outputShape",t,e,n);return r=p("strides",t,e,n),a=p("pad",t,e,n),[Object(i["conv2dTranspose"])(p("x",t,e,n),p("filter",t,e,n),x,[r[1],r[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=p("strides",t,e,n),a=p("pad",t,e,n),u=p("dilations",t,e,n),o=p("dataFormat",t,e,n).toUpperCase(),[Object(i["depthwiseConv2d"])(p("input",t,e,n),p("filter",t,e,n),[r[1],r[2]],a,o,[u[1],u[2]])];case"Conv3D":return r=p("strides",t,e,n),a=p("pad",t,e,n),o=p("dataFormat",t,e,n).toUpperCase(),u=p("dilations",t,e,n),[Object(i["conv3d"])(p("x",t,e,n),p("filter",t,e,n),[r[1],r[2],r[3]],a,o,[u[1],u[2],u[3]])];case"AvgPool":r=p("strides",t,e,n),a=p("pad",t,e,n);var w=p("kernelSize",t,e,n);return[Object(i["avgPool"])(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],a)];case"MaxPool":return r=p("strides",t,e,n),a=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(i["maxPool"])(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],a)];case"MaxPoolWithArgmax":r=p("strides",t,e,n),a=p("pad",t,e,n),w=p("kernelSize",t,e,n);var k=p("includeBatchInIndex",t,e,n),S=Object(i["maxPoolWithArgmax"])(p("x",t,e,n),[w[1],w[2]],[r[1],r[2]],a,k);return[S.result,S.indexes];case"AvgPool3D":return r=p("strides",t,e,n),a=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(i["avgPool3d"])(p("x",t,e,n),[w[1],w[2],w[3]],[r[1],r[2],r[3]],a)];case"MaxPool3D":return r=p("strides",t,e,n),a=p("pad",t,e,n),w=p("kernelSize",t,e,n),[Object(i["maxPool3d"])(p("x",t,e,n),[w[1],w[2],w[3]],[r[1],r[2],r[3]],a)];default:throw TypeError("Node type "+t.op+" is not implemented")}},xt=function(t,e,n){switch(t.op){case"Fill":var r=p("shape",t,e,n),a=p("dtype",t,e,n),o=p("value",t,e,n);return[Object(i["fill"])(r,o,a)];case"LinSpace":var s=p("start",t,e,n),u=p("stop",t,e,n),c=p("num",t,e,n);return[Object(i["linspace"])(s,u,c)];case"Multinomial":var l=p("logits",t,e,n),d=p("numSamples",t,e,n),h=p("seed",t,e,n);return[Object(i["multinomial"])(l,d,h)];case"OneHot":var f=p("indices",t,e,n),m=p("depth",t,e,n),g=p("onValue",t,e,n),b=p("offValue",t,e,n);return[Object(i["oneHot"])(f,m,g,b)];case"Ones":return[Object(i["ones"])(p("shape",t,e,n),p("dtype",t,e,n))];case"OnesLike":return[Object(i["onesLike"])(p("x",t,e,n))];case"RandomUniform":return[Object(i["randomUniform"])(p("shape",t,e,n),p("minval",t,e,n),p("maxval",t,e,n),p("dtype",t,e,n))];case"Range":s=p("start",t,e,n);var y=p("stop",t,e,n),v=p("step",t,e,n);return[Object(i["range"])(s,y,v,p("dtype",t,e,n))];case"TruncatedNormal":r=p("shape",t,e,n);var x=p("mean",t,e,n),w=p("stdDev",t,e,n);return h=p("seed",t,e,n),[Object(i["truncatedNormal"])(r,x,w,p("dtype",t,e,n),h)];case"Zeros":return[Object(i["zeros"])(p("shape",t,e,n),p("dtype",t,e,n))];case"ZerosLike":return[Object(i["zerosLike"])(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},wt=void 0,kt=function(t,e,n){return s(wt,void 0,void 0,(function(){var r,a,o,s,c,l,d,h;return u(this,(function(u){switch(u.label){case 0:switch(t.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=p("boxes",t,e,n),a=p("scores",t,e,n),o=p("maxOutputSize",t,e,n),s=p("iouThreshold",t,e,n),c=p("scoreThreshold",t,e,n),"NonMaxSuppressionV5"!==t.op?[3,3]:(l=p("softNmsSigma",t,e,n),[4,i["image"].nonMaxSuppressionWithScoreAsync(r,a,o,s,c,l)]);case 2:return[2,[(h=u.sent()).selectedIndices,h.selectedScores]];case 3:return[4,i["image"].nonMaxSuppressionAsync(r,a,o,s,c)];case 4:return[2,[u.sent()]];case 5:return d=p("condition",t,e,n).asType("bool"),[4,Object(i["whereAsync"])(d)];case 6:return h=[u.sent()],d.dispose(),[2,h];case 7:return[2,Object(i["setdiff1dAsync"])(p("x",t,e,n),p("y",t,e,n))];case 8:throw TypeError("Node type "+t.op+" is not implemented")}}))}))},St=function(t,e,n){switch(t.op){case"TopKV2":var r=p("x",t,e,n),a=p("k",t,e,n),o=p("sorted",t,e,n),s=Object(i["topk"])(r,a,o);return[s.values,s.indices];default:throw TypeError("Node type "+t.op+" is not implemented")}},Ot=function(t,e,n){switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":var r=p("default",t,e,n);return[f(t.name,e,n)||r];case"Placeholder":return[f(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[p("x",t,e,n).clone()];case"IdentityN":return p("x",t,e,n).map((function(t){return t.clone()}));case"Snapshot":return[p("x",t,e,n).clone()];case"Shape":return[Object(i["tensor1d"])(p("x",t,e,n).shape,"int32")];case"ShapeN":return p("x",t,e,n).map((function(t){return Object(i["tensor1d"])(t.shape)}));case"Size":return[Object(i["scalar"])(p("x",t,e,n).size,"int32")];case"Rank":return[Object(i["scalar"])(p("x",t,e,n).rank,"int32")];case"NoOp":return[Object(i["scalar"])(1)];case"Print":var a=p("x",t,e,n),o=p("data",t,e,n),s=p("message",t,e,n),u=p("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(var c=0;c<o.length;c++)console.log(Array.prototype.slice.call(o[c].dataSync()).slice(0,u));return[a];default:throw TypeError("Node type "+t.op+" is not implemented")}},_t=function(t,e,n){switch(t.op){case"ResizeBilinear":var r=p("images",t,e,n),a=p("size",t,e,n),o=p("alignCorners",t,e,n);return[i["image"].resizeBilinear(r,[a[0],a[1]],o)];case"ResizeNearestNeighbor":return r=p("images",t,e,n),a=p("size",t,e,n),o=p("alignCorners",t,e,n),[i["image"].resizeNearestNeighbor(r,[a[0],a[1]],o)];case"CropAndResize":var s=p("image",t,e,n),u=p("boxes",t,e,n),c=p("boxInd",t,e,n),l=p("cropSize",t,e,n),d=p("method",t,e,n),h=p("extrapolationValue",t,e,n);return[i["image"].cropAndResize(s,u,c,l,d,h)];default:throw TypeError("Node type "+t.op+" is not implemented")}},Ct=function(t,e,n){switch(t.op){case"Equal":return[Object(i["equal"])(p("a",t,e,n),p("b",t,e,n))];case"NotEqual":return[Object(i["notEqual"])(p("a",t,e,n),p("b",t,e,n))];case"Greater":return[Object(i["greater"])(p("a",t,e,n),p("b",t,e,n))];case"GreaterEqual":return[Object(i["greaterEqual"])(p("a",t,e,n),p("b",t,e,n))];case"Less":return[Object(i["less"])(p("a",t,e,n),p("b",t,e,n))];case"LessEqual":return[Object(i["lessEqual"])(p("a",t,e,n),p("b",t,e,n))];case"LogicalAnd":return[Object(i["logicalAnd"])(p("a",t,e,n),p("b",t,e,n))];case"LogicalNot":return[Object(i["logicalNot"])(p("a",t,e,n))];case"LogicalOr":return[Object(i["logicalOr"])(p("a",t,e,n),p("b",t,e,n))];case"Select":case"SelectV2":return[Object(i["where"])(p("condition",t,e,n),p("a",t,e,n),p("b",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},Tt=function(t,e,n){switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[Object(i["matMul"])(p("a",t,e,n),p("b",t,e,n),p("transposeA",t,e,n),p("transposeB",t,e,n))];case"Transpose":return[Object(i["transpose"])(p("x",t,e,n),p("perm",t,e,n))];case"_FusedMatMul":var r=p("fusedOps",t,e,n),a=r[0],o=r[1],s="biasadd"===a,u="prelu"===o,c=p("numArgs",t,e,n);if(s){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var l=p("args",t,e,n),d=l[0],h=l[1];return[i["fused"].matMul({a:p("a",t,e,n),b:p("b",t,e,n),transposeA:p("transposeA",t,e,n),transposeB:p("transposeB",t,e,n),bias:d,activation:o,preluActivationWeights:h})];default:throw TypeError("Node type "+t.op+" is not implemented")}},It=function(t,e,n){switch(t.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[Object(i["batchNorm"])(p("x",t,e,n),p("mean",t,e,n),p("variance",t,e,n),p("offset",t,e,n),p("scale",t,e,n),p("epsilon",t,e,n))];case"LRN":return[Object(i["localResponseNormalization"])(p("x",t,e,n),p("radius",t,e,n),p("bias",t,e,n),p("alpha",t,e,n),p("beta",t,e,n))];case"Softmax":return[Object(i["softmax"])(p("x",t,e,n))];case"LogSoftmax":return[Object(i["logSoftmax"])(p("x",t,e,n))];case"SparseToDense":return[Object(i["sparseToDense"])(p("sparseIndices",t,e,n),p("outputShape",t,e,n),p("sparseValues",t,e,n),p("defaultValue",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},Nt=function(t,e,n){switch(t.op){case"Max":var r=p("axis",t,e,n),a=p("keepDims",t,e,n);return[Object(i["max"])(p("x",t,e,n),r,a)];case"Mean":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["mean"])(p("x",t,e,n),r,a)];case"Min":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["min"])(p("x",t,e,n),r,a)];case"Sum":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["sum"])(p("x",t,e,n),r,a)];case"All":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["all"])(p("x",t,e,n),r,a)];case"Any":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["any"])(p("x",t,e,n),r,a)];case"ArgMax":return r=p("axis",t,e,n),[Object(i["argMax"])(p("x",t,e,n),r)];case"ArgMin":return r=p("axis",t,e,n),[Object(i["argMin"])(p("x",t,e,n),r)];case"Prod":return r=p("axis",t,e,n),a=p("keepDims",t,e,n),[Object(i["prod"])(p("x",t,e,n),r,a)];default:throw TypeError("Node type "+t.op+" is not implemented")}},Et=function(t,e,n){switch(t.op){case"ConcatV2":case"Concat":var r=p("n",t,e,n),a=p("axis",t,e,n),o=p("tensors",t,e,n);return o=o.slice(0,r),[Object(i["concat"])(o,a)];case"GatherV2":case"Gather":a=p("axis",t,e,n);var s=p("x",t,e,n),u=p("indices",t,e,n);return[Object(i["gather"])(s,u.asType("int32"),a)];case"ReverseV2":case"Reverse":return a=p("axis",t,e,n),s=p("x",t,e,n),[Object(i["reverse"])(s,a)];case"Slice":var c=p("begin",t,e,n),l=p("size",t,e,n);return[Object(i["slice"])(p("x",t,e,n),c,l)];case"StridedSlice":c=p("begin",t,e,n);var d=p("end",t,e,n),h=p("strides",t,e,n),f=p("beginMask",t,e,n),m=p("endMask",t,e,n),g=p("ellipsisMask",t,e,n),b=p("newAxisMask",t,e,n),y=p("shrinkAxisMask",t,e,n),v=p("x",t,e,n);if(1===c.length&&v.shape.length>1)for(var x=1;x<v.shape.length;x++)c.push(0),d.push(v.shape[x]),h.push(h[0]);return[Object(i["stridedSlice"])(v,c,d,h,f,m,g,b,y)];case"Pack":return Object(i["tidy"])((function(){var r=p("axis",t,e,n),a=p("tensors",t,e,n),o=a[0].shape,s=a[0].squeeze().shape,u=a.map((function(t){var e=i["util"].arraysEqual(t.shape,o);if(!e&&!i["util"].arraysEqual(t.squeeze().shape,s))throw new Error("the input tensors shape does not match");return e?t:t.reshape(o)}));return[Object(i["stack"])(u,r)]}));case"Unpack":return Object(i["tidy"])((function(){var r=p("axis",t,e,n),a=p("tensor",t,e,n);return Object(i["unstack"])(a,r)}));case"Tile":var w=p("reps",t,e,n);return[Object(i["tile"])(p("x",t,e,n),w)];case"Split":case"SplitV":a=p("axis",t,e,n);var k=p("numOrSizeSplits",t,e,n);return Object(i["split"])(p("x",t,e,n),k,a);case"ScatterNd":u=p("indices",t,e,n);var S=p("values",t,e,n),O=p("shape",t,e,n);return[Object(i["scatterND"])(u,S,O)];case"GatherNd":var _=p("x",t,e,n);return u=p("indices",t,e,n),[Object(i["gatherND"])(_,u)];case"SparseToDense":u=p("sparseIndices",t,e,n),O=p("outputShape",t,e,n);var C=p("sparseValues",t,e,n),T=p("defaultValue",t,e,n);return[Object(i["sparseToDense"])(u,C,O,C.dtype===T.dtype?T:T.asType(C.dtype))];default:throw TypeError("Node type "+t.op+" is not implemented")}},At=function(t,e,n){switch(t.op){case"FFT":return[Object(i["fft"])(p("x",t,e,n))];case"IFFT":return[Object(i["ifft"])(p("x",t,e,n))];case"RFFT":return[Object(i["rfft"])(p("x",t,e,n))];case"IRFFT":return[Object(i["irfft"])(p("x",t,e,n))];default:throw TypeError("Node type "+t.op+" is not implemented")}},Rt=function(t,e,n){switch(t.op){case"Cast":return[Object(i["cast"])(p("x",t,e,n),p("dtype",t,e,n))];case"ExpandDims":var r=p("axis",t,e,n);return[Object(i["expandDims"])(p("x",t,e,n),r)];case"Squeeze":return r=p("axis",t,e,n),[Object(i["squeeze"])(p("x",t,e,n),r)];case"Reshape":return[Object(i["reshape"])(p("x",t,e,n),p("shape",t,e,n))];case"PadV2":case"Pad":return[Object(i["pad"])(p("x",t,e,n),v(p("padding",t,e,n),2),p("constantValue",t,e,n))];case"SpaceToBatchND":var a=p("blockShape",t,e,n),o=v(p("paddings",t,e,n),2);return[Object(i["spaceToBatchND"])(p("x",t,e,n),a,o)];case"BatchToSpaceND":a=p("blockShape",t,e,n);var s=v(p("crops",t,e,n),2);return[Object(i["batchToSpaceND"])(p("x",t,e,n),a,s)];case"DepthToSpace":var u=p("blockSize",t,e,n),c=p("dataFormat",t,e,n).toUpperCase();return[Object(i["depthToSpace"])(p("x",t,e,n),u,c)];default:throw TypeError("Node type "+t.op+" is not implemented")}};function jt(t,e,n){var r=function(t,e,n){switch(t.category){case"arithmetic":return Object(i["tidy"])((function(){return ft(t,e,n)}));case"basic_math":return Object(i["tidy"])((function(){return mt(t,e,n)}));case"control":return yt(t,e,n);case"convolution":return Object(i["tidy"])((function(){return vt(t,e,n)}));case"creation":return Object(i["tidy"])((function(){return xt(t,e,n)}));case"dynamic":return kt(t,e,n);case"evaluation":return Object(i["tidy"])((function(){return St(t,e,n)}));case"image":return Object(i["tidy"])((function(){return _t(t,e,n)}));case"graph":return Object(i["tidy"])((function(){return Ot(t,e,n)}));case"logical":return Object(i["tidy"])((function(){return Ct(t,e,n)}));case"matrices":return Object(i["tidy"])((function(){return Tt(t,e,n)}));case"normalization":return Object(i["tidy"])((function(){return It(t,e,n)}));case"reduction":return Object(i["tidy"])((function(){return Nt(t,e,n)}));case"slice_join":return Object(i["tidy"])((function(){return Et(t,e,n)}));case"spectral":return Object(i["tidy"])((function(){return At(t,e,n)}));case"transformation":return Object(i["tidy"])((function(){return Rt(t,e,n)}));case"custom":var r=d(t.op);if(r&&r.customExecutor)return r.customExecutor(new pt(t,e,n));throw TypeError("Custom op "+t.op+" is not registered.");default:throw TypeError("Unknown op '"+t.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(t,e,n);return r instanceof Promise?r.then((function(t){return[].concat(t)})):[].concat(r)}var Dt=function(){function t(t,e){this.weightMap=t,this.tensorArrayMap=e,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return t.prototype.newFrame=function(t,e){return{id:t,frameName:e,iterationId:0}},Object.defineProperty(t.prototype,"currentContext",{get:function(){return this.contexts},set:function(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),t.prototype.generateCurrentContextIds=function(){for(var t=[],e=0;e<this.contexts.length-1;e++){var n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t},t.prototype.contextIdforContexts=function(t){return t?t.map((function(t){return 0===t.id&&0===t.iterationId?"":t.frameName+"-"+t.iterationId})).join("/"):""},t.prototype.enterFrame=function(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},t.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},t.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},t.prototype.getWeight=function(t){return this.weightMap[t]},t.prototype.addTensorArray=function(t){this.tensorArrayMap[t.id]=t},t.prototype.getTensorArray=function(t){return this.tensorArrayMap[t]},t}();function Ft(t,e,n){for(var r=new Set,a=[],i=null,o=null,s=new Set,u=Object.keys(t).map((function(t){return y(t)[0]})),c=e.slice();c.length>0;){var l=c.pop();(Lt(l)||Bt(l))&&null==i&&(o=(i=l).children.map((function(t){return t.name})).filter((function(t){return r.has(t)}))),r.add(l.name),null==n[l.name]&&-1===u.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(t){s.has(t.name)||(s.add(t.name),c.push(t))})):a.push(l.name))}return{inputs:t,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}function Mt(t,e,n){var r=n.usedNodes,a=n.inputs,i=[];Object.keys(a).map((function(t){return y(t)[0]})).map((function(e){return t.nodes[e]})).forEach((function(t){r.has(t.name)&&i.push(t)})),t.weights.forEach((function(t){r.has(t.name)&&i.push(t)}));for(var o=new Set,s=[];i.length>0;){var u=i.pop();o.add(u.name),e[u.name]||s.push(u),u.children.forEach((function(t){!o.has(t.name)&&r.has(t.name)&&t.inputs.every((function(t){return o.has(t.name)}))&&i.push(t)}))}return s}var Pt=["Switch","Merge","Enter","Exit","NextIteration"],$t=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Lt(t){return Pt.indexOf(t.op)>=0}function Bt(t){return $t.indexOf(t.op)>=0}var zt=function(){function t(t){this.graph=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature}return Object.defineProperty(t.prototype,"weightMap",{get:function(){return this._weightMap},set:function(t){var e=Object.keys(t).map((function(e){return t[e].map((function(t){return t.id}))}));this.weightIds=[].concat.apply([],e),this._weightMap=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this._inputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this._outputs.map((function(t){return{name:t.name,shape:t.attrParams.shape?t.attrParams.shape.value:void 0,dtype:t.attrParams.dtype?t.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this._inputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this._outputs.map((function(t){return t.signatureKey||t.name}))},enumerable:!0,configurable:!0}),t.prototype.getCompilationKey=function(t,e){var n=t.map((function(t){return t.name})).sort(),r=e.map((function(t){return t.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},t.prototype.compile=function(t,e){var n=Ft(t,e,this.weightMap),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+i+"]");if(r.length>0){var o=e.map((function(t){return t.name})),s=Object.keys(t);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return Mt(this.graph,this.weightMap,n)},t.prototype.execute=function(t,e){var n=this;t=this.mapInputs(t);var r=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);var a=r.map((function(t){return n.graph.nodes[y(t)[0]]})),s=e.map((function(t){return n.graph.nodes[y(t)[0]]})),u=this.getCompilationKey(a,s),c=this.compiledMap.get(u);null==c&&(c=this.compile(t,s),this.compiledMap.set(u,c));var l={};return Object(i["tidy"])((function(){var r=new Dt(n._weightMap,l),a=o({},n.weightMap);Object.keys(t).forEach((function(e){var n=y(e),r=n[0],i=[];i[n[1]]=t[e],a[r]=i}));for(var i=n.getFrozenTensorIds(a),s={},u=0;u<c.length;u++){var d=c[u];if(!a[d.name]){var h=jt(d,a,r);if(h instanceof Promise)throw new Error("The execution of the op '"+d.op+"' returned a promise. Please use model.executeAsync() instead.");a[d.name]=h,n.checkTensorForDisposal(d.name,d,a,r,i,e,s)}}return e.map((function(t){return f(t,a,r)}))}))},t.prototype.getFrozenTensorIds=function(t){var e=[].concat.apply([],Object.keys(t).map((function(e){return t[e]})).map((function(t){return t.map((function(t){return t.id}))})));return new Set(e)},t.prototype.checkTensorForDisposal=function(t,e,n,r,a,i,o){"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach((function(t){null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)})),e.inputs.forEach((function(t){if("control"!==t.category){var e=m(t.name,n,r);null!=e&&e.forEach((function(t){if(t&&!a.has(t.id)){var e=o[t.id];1===e?(t.dispose(),delete o[t.id]):null!=e&&o[t.id]--}}))}})))},t.prototype.executeAsync=function(t,e){return s(this,void 0,void 0,(function(){var n,r,a,i,o,s,c=this;return u(this,(function(u){switch(u.label){case 0:return t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e),n={},r=new Dt(this._weightMap,n),[4,this.executeWithControlFlow(t,r,e)];case 1:return a=u.sent(),i=e.map((function(t){return f(t,a,r)})),o=new Set(i.map((function(t){return t.id}))),s=new Set(Object.keys(t).map((function(e){return t[e].id}))),Object.keys(a).forEach((function(t){a[t].forEach((function(t){!t||t.isDisposed||o.has(t.id)||s.has(t.id)||-1!==c.weightIds.indexOf(t.id)||t.dispose()}))})),[2,i]}}))}))},t.prototype.executeWithControlFlow=function(t,e,n){return s(this,void 0,void 0,(function(){var r,a,i,s,c,l,d,h,p,m,g,b,v,x,w,k,S=this;return u(this,(function(u){switch(u.label){case 0:r=Object.keys(t),a=r.map((function(t){return S.graph.nodes[y(t)[0]]})),i=n.map((function(t){return S.graph.nodes[y(t)[0]]})),s=Ft(t,i,this.weightMap),c=s.usedNodes,l=s.missingInputs,d=s.dynamicNode,h=s.syncInputs,p=a.concat(this.graph.weights).map((function(t){return{node:t,contexts:e.currentContext}})),m=o({},this.weightMap),Object.keys(t).forEach((function(e){var n=y(e),r=n[0],a=[];a[n[1]]=t[e],m[r]=a})),g={},b=this.getFrozenTensorIds(m),v={},u.label=1;case 1:return p.length>0?(x=this.processStack(a,p,e,m,v,b,n,g,c),[4,Promise.all(x)]):[3,3];case 2:return u.sent(),[3,1];case 3:if(null==d&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(w=i.filter((function(t){return!Lt(t)&&!f(t.name,m,e)})).map((function(t){return t.name}))).length>0)throw k="",null!=d&&(k="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+h+"]"),new Error("Cannot compute the outputs ["+w+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+l+"]. "+k);return[2,m]}}))}))},t.prototype.processStack=function(t,e,n,r,a,i,o,s,u){for(var c=this,l=[],d=function(){var d=e.pop();n.currentContext=d.contexts;var f="";if("Enter"===d.node.op&&p("isConstant",d.node,r,n)&&(f=g(d.node.name,n)[0]),-1===t.indexOf(d.node)){var m=jt(d.node,r,n);f||(f=g(d.node.name,n)[0]);var b=n.currentContext;m instanceof Promise?l.push(m.then((function(t){return r[f]=t,n.currentContext=b,c.checkTensorForDisposal(f,d.node,r,n,i,o,s),c.processChildNodes(d.node,e,n,r,a,u),t}))):(r[f]=m,h.checkTensorForDisposal(f,d.node,r,n,i,o,s),h.processChildNodes(d.node,e,n,r,a,u))}else h.processChildNodes(d.node,e,n,r,a,u)},h=this;e.length>0;)d();return l},t.prototype.processChildNodes=function(t,e,n,r,a,i){t.children.forEach((function(t){var o=g(t.name,n)[0];!a[o]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some((function(t){return!!f(t,r,n)}))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every((function(t){return!!f(t,r,n)}))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})))}))},t.prototype.dispose=function(){var t=this;Object.keys(this.weightMap).forEach((function(e){return t.weightMap[e].forEach((function(t){return t.dispose()}))}))},t.prototype.checkInputShapeAndType=function(t){var e=this;Object.keys(t).forEach((function(n){var r=t[n],a=y(n)[0],o=e.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===r.shape.length&&r.shape.every((function(t,e){return-1===s[e]||s[e]===t}));i["util"].assert(u,(function(){return"The shape of dict['"+o.name+"'] provided in model.execute(dict) must be ["+s+"], but was ["+r.shape+"]"}))}o.attrParams.dtype&&o.attrParams.dtype.value&&i["util"].assert(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['"+o.name+"'] provided in model.execute(dict) must be "+o.attrParams.dtype.value+", but was "+r.dtype}))}))},t.prototype.mapInputs=function(t){var e={};for(var n in t)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?e[this._signature.inputs[n].name]=t[n]:e[n]=t[n];return e},t.prototype.checkInputs=function(t){var e=this,n=Object.keys(t).filter((function(t){var n=y(t)[0];return null==e.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},t.prototype.mapOutputs=function(t){var e=this;return t.map((function(t){return null!=e._signature&&null!=e._signature.outputs&&null!=e._signature.outputs[t]?e._signature.outputs[t].name:t}),{})},t.prototype.checkOutputs=function(t){var e=this;t.forEach((function(t){var n=y(t)[0];if(!e.graph.nodes[n])throw new Error("The output '"+t+"' is not found in the graph")}))},t}(),Wt="?tfjs-format=file",Vt="model.json",Ut=function(){function t(t,e){void 0===e&&(e={}),this.modelUrl=t,this.loadOptions=e,this.version="n/a",null==e&&(this.loadOptions={})}return Object.defineProperty(t.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),t.prototype.findIOHandler=function(){var t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=i["io"].browserHTTPRequest(t,this.loadOptions);else{var e=i["io"].getLoadHandlers(t,this.loadOptions.onProgress);if(0===e.length)e.push(i["io"].browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error("Found more than one ("+e.length+") load handlers for URL '"+[t]+"'");this.handler=e[0]}},t.prototype.load=function(){return s(this,void 0,void 0,(function(){var t,e,n,r;return u(this,(function(a){switch(a.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return t=this,[4,this.handler.load()];case 1:return t.artifacts=a.sent(),e=this.artifacts.modelTopology,n={},null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=e.versions.producer+"."+e.versions.minConsumer,r=i["io"].decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new zt(Z.Instance.transformGraph(e,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},t.prototype.save=function(t,e){return s(this,void 0,void 0,(function(){var e;return u(this,(function(n){if("string"==typeof t){if(0===(e=i["io"].getSaveHandlers(t)).length)throw new Error("Cannot find any save handlers for URL '"+t+"'");if(e.length>1)throw new Error("Found more than one ("+e.length+") save handlers for URL '"+t+"'");t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,t.save(this.artifacts)]}))}))},t.prototype.predict=function(t,e){return this.execute(t,this.outputNodes)},t.prototype.normalizeInputs=function(t){if(!(t instanceof i["Tensor"]||Array.isArray(t)))return t;if((t=Array.isArray(t)?t:[t]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+t.length+" input tensors.");return this.inputNodes.reduce((function(e,n,r){return e[n]=t[r],e}),{})},t.prototype.normalizeOutputs=function(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]},t.prototype.execute=function(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);var n=this.executor.execute(t,e);return n.length>1?n:n[0]},t.prototype.executeAsync=function(t,e){return s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:return t=this.normalizeInputs(t),e=this.normalizeOutputs(e),[4,this.executor.executeAsync(t,e)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},t.prototype.convertTensorMapToTensorsMap=function(t){return Object.keys(t).reduce((function(e,n){return e[n]=[t[n]],e}),{})},t.prototype.dispose=function(){this.executor.dispose()},t}();function Gt(t,e){return void 0===e&&(e={}),s(this,void 0,void 0,(function(){var n;return u(this,(function(r){switch(r.label){case 0:if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==e&&(e={}),e.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t=""+t+Vt+Wt),[4,(n=new Ut(t,e)).load()];case 1:return r.sent(),[2,n]}}))}))}var Ht="1.7.4"}.call(this,n("b639").Buffer)},b639:function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n("1fb5"),a=n("9152"),i=n("e3db");function o(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"===typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(e){return!1}}function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=c.prototype):(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(t,e,n);if("number"===typeof t){if("string"===typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"===typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer?g(t,e,n,r):"string"===typeof e?f(t,e,n):b(t,e)}function d(t){if("number"!==typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e,n,r){return d(e),e<=0?u(t,e):void 0!==n?"string"===typeof r?u(t,e).fill(n,r):u(t,e).fill(n):u(t,e)}function p(t,e){if(d(e),t=u(t,e<0?0:0|y(e)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function f(t,e,n){if("string"===typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|x(e,n);t=u(t,r);var a=t.write(e,n);return a!==r&&(t=t.slice(0,a)),t}function m(t,e){var n=e.length<0?0:0|y(e.length);t=u(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function g(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),c.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=c.prototype):t=m(t,e),t}function b(t,e){if(c.isBuffer(e)){var n=0|y(e.length);return t=u(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!==typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!==typeof e.length||et(e.length)?u(t,0):m(t,e);if("Buffer"===e.type&&i(e.data))return m(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function y(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function v(t){return+t!=t&&(t=0),c.alloc(+t)}function x(t,e){if(c.isBuffer(t))return t.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!==typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Q(t).length;default:if(r)return Y(t).length;e=(""+e).toLowerCase(),r=!0}}function w(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return P(this,e,n);case"utf8":case"utf-8":return R(this,e,n);case"ascii":return F(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function k(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function S(t,e,n,r,a){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(a)return-1;n=t.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof e&&(e=c.from(e,r)),c.isBuffer(e))return 0===e.length?-1:O(t,e,n,r,a);if("number"===typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):O(t,[e],n,r,a);throw new TypeError("val must be string, number or Buffer")}function O(t,e,n,r,a){var i,o=1,s=t.length,u=e.length;if(void 0!==r&&(r=String(r).toLowerCase(),"ucs2"===r||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(a){var l=-1;for(i=n;i<s;i++)if(c(t,i)===c(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===u)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+u>s&&(n=s-u),i=n;i>=0;i--){for(var d=!0,h=0;h<u;h++)if(c(t,i+h)!==c(e,h)){d=!1;break}if(d)return i}return-1}function _(t,e,n,r){n=Number(n)||0;var a=t.length-n;r?(r=Number(r),r>a&&(r=a)):r=a;var i=e.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function C(t,e,n,r){return tt(Y(e,t.length-n),t,n,r)}function T(t,e,n,r){return tt(J(e),t,n,r)}function I(t,e,n,r){return T(t,e,n,r)}function N(t,e,n,r){return tt(Q(e),t,n,r)}function E(t,e,n,r){return tt(Z(e,t.length-n),t,n,r)}function A(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function R(t,e,n){n=Math.min(t.length,n);var r=[],a=e;while(a<n){var i,o,s,u,c=t[a],l=null,d=c>239?4:c>223?3:c>191?2:1;if(a+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:i=t[a+1],128===(192&i)&&(u=(31&c)<<6|63&i,u>127&&(l=u));break;case 3:i=t[a+1],o=t[a+2],128===(192&i)&&128===(192&o)&&(u=(15&c)<<12|(63&i)<<6|63&o,u>2047&&(u<55296||u>57343)&&(l=u));break;case 4:i=t[a+1],o=t[a+2],s=t[a+3],128===(192&i)&&128===(192&o)&&128===(192&s)&&(u=(15&c)<<18|(63&i)<<12|(63&o)<<6|63&s,u>65535&&u<1114112&&(l=u))}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=d}return D(r)}e.Buffer=c,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:o(),e.kMaxLength=s(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,n){return l(null,t,e,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,n){return h(null,t,e,n)},c.allocUnsafe=function(t){return p(null,t)},c.allocUnsafeSlow=function(t){return p(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,a=0,i=Math.min(n,r);a<i;++a)if(t[a]!==e[a]){n=t[a],r=e[a];break}return n<r?-1:r<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!i(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=c.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){var o=t[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},c.byteLength=x,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)k(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)k(this,e,e+3),k(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)k(this,e,e+7),k(this,e+1,e+6),k(this,e+2,e+5),k(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):w.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,n,r,a){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),e<0||n>t.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&e>=n)return 0;if(r>=a)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,a>>>=0,this===t)return 0;for(var i=a-r,o=n-e,s=Math.min(i,o),u=this.slice(r,a),l=t.slice(e,n),d=0;d<s;++d)if(u[d]!==l[d]){i=u[d],o=l[d];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return S(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return S(this,t,e,n,!1)},c.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-e;if((void 0===n||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return C(this,t,e,n);case"ascii":return T(this,t,e,n);case"latin1":case"binary":return I(this,t,e,n);case"base64":return N(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var j=4096;function D(t){var e=t.length;if(e<=j)return String.fromCharCode.apply(String,t);var n="",r=0;while(r<e)n+=String.fromCharCode.apply(String,t.slice(r,r+=j));return n}function F(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(127&t[a]);return r}function M(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(t[a]);return r}function P(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=e;i<n;++i)a+=X(t[i]);return a}function $(t,e,n){for(var r=t.slice(e,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function L(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,a,i){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function z(t,e,n,r){e<0&&(e=65535+e+1);for(var a=0,i=Math.min(t.length-n,2);a<i;++a)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function W(t,e,n,r){e<0&&(e=4294967295+e+1);for(var a=0,i=Math.min(t.length-n,4);a<i;++a)t[n+a]=e>>>8*(r?a:3-a)&255}function V(t,e,n,r,a,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(t,e,n,r,i){return i||V(t,e,n,4,34028234663852886e22,-34028234663852886e22),a.write(t,e,n,r,23,4),n+4}function G(t,e,n,r,i){return i||V(t,e,n,8,17976931348623157e292,-17976931348623157e292),a.write(t,e,n,r,52,8),n+8}c.prototype.slice=function(t,e){var n,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)n=this.subarray(t,e),n.__proto__=c.prototype;else{var a=e-t;n=new c(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+t]}return n},c.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);var r=this[t],a=1,i=0;while(++i<e&&(a*=256))r+=this[t+i]*a;return r},c.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);var r=this[t+--e],a=1;while(e>0&&(a*=256))r+=this[t+--e]*a;return r},c.prototype.readUInt8=function(t,e){return e||L(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||L(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||L(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||L(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||L(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);var r=this[t],a=1,i=0;while(++i<e&&(a*=256))r+=this[t+i]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*e)),r},c.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||L(t,e,this.length);var r=e,a=1,i=this[t+--r];while(r>0&&(a*=256))i+=this[t+--r]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*e)),i},c.prototype.readInt8=function(t,e){return e||L(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||L(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){e||L(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return e||L(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||L(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||L(t,4,this.length),a.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||L(t,4,this.length),a.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||L(t,8,this.length),a.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||L(t,8,this.length),a.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;B(this,t,e,n,a,0)}var i=1,o=0;this[e]=255&t;while(++o<n&&(i*=256))this[e+o]=t/i&255;return e+n},c.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){var a=Math.pow(2,8*n)-1;B(this,t,e,n,a,0)}var i=n-1,o=1;this[e+i]=255&t;while(--i>=0&&(o*=256))this[e+i]=t/o&255;return e+n},c.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):z(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):z(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):W(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);B(this,t,e,n,a-1,-a)}var i=0,o=1,s=0;this[e]=255&t;while(++i<n&&(o*=256))t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);B(this,t,e,n,a-1,-a)}var i=n-1,o=1,s=0;this[e+i]=255&t;while(--i>=0&&(o*=256))t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):z(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):z(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):W(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):W(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,n){return U(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return U(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return G(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return G(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var a,i=r-n;if(this===t&&n<e&&e<r)for(a=i-1;a>=0;--a)t[a+e]=this[a+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},c.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(i=e;i<n;++i)this[i]=t;else{var o=c.isBuffer(t)?t:Y(new c(t,r).toString()),s=o.length;for(i=0;i<n-e;++i)this[i+e]=o[i%s]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function q(t){if(t=K(t).replace(H,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function K(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function X(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,e){var n;e=e||1/0;for(var r=t.length,a=null,i=[],o=0;o<r;++o){if(n=t.charCodeAt(o),n>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(e-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function J(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Z(t,e){for(var n,r,a,i=[],o=0;o<t.length;++o){if((e-=2)<0)break;n=t.charCodeAt(o),r=n>>8,a=n%256,i.push(a),i.push(r)}return i}function Q(t){return r.toByteArray(q(t))}function tt(t,e,n,r){for(var a=0;a<r;++a){if(a+n>=e.length||a>=t.length)break;e[a+n]=t[a]}return a}function et(t){return t!==t}}).call(this,n("c8ba"))},b6c5:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i){const o=r["util"].sizeFromShape(a),s=e[0],u=i.length,c=[];let l=1,d=-1;for(let b=0;b<u;++b){const t=i[b];if(-1===t){if(-1!==d)throw new Error(r["backend_util"].getSparseReshapeMultipleNegativeOneOutputDimErrorMessage(d,b));d=b,c.push(1)}else{if(t<0)throw new Error(r["backend_util"].getSparseReshapeNegativeOutputDimErrorMessage(b,t));l*=t,c.push(t)}}if(-1!==d){if(l<=0)throw new Error(r["backend_util"].getSparseReshapeEmptyTensorZeroOutputDimErrorMessage());const t=Math.trunc(o/l);if(l*t!==o)throw new Error(r["backend_util"].getSparseReshapeInputOutputMultipleErrorMessage(a,c));c[d]=t}const h=r["util"].sizeFromShape(c);if(h!==o)throw new Error(r["backend_util"].getSparseReshapeInputOutputMismatchErrorMessage(a,c));const p=a.length,f=[];if(p>0){f[p-1]=1;for(let t=p-2;t>=0;--t)f[t]=f[t+1]*a[t+1]}const m=[];if(u>0){m[u-1]=1;for(let t=u-2;t>=0;--t)m[t]=m[t+1]*c[t+1]}const g=r["util"].getArrayFromDType(n,s*u);for(let r=0;r<s;++r){let e=0;for(let n=0;n<p;++n)e+=t[r*p+n]*f[n];for(let t=0;t<u;++t)g[r*u+t]=Math.trunc(e/m[t]),e%=m[t]}return[g,[s,u],c]}},b6cb:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"sameAs",eq:t},(function(e,n){return e===(0,r.ref)(t,this,n)}))};e.default=a},b744:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}]},b760:function(t,e,n){var r=n("872a"),a=n("9638");function i(t,e,n){(void 0!==n&&!a(t[e],n)||void 0===n&&!(e in t))&&r(t,e,n)}t.exports=i},b76a:function(t,e,n){(function(e,r){t.exports=r(n("aa47"))})("undefined"!==typeof self&&self,(function(t){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"01f9":function(t,e,n){"use strict";var r=n("2d00"),a=n("5ca1"),i=n("2aba"),o=n("32e9"),s=n("84f2"),u=n("41a0"),c=n("7f20"),l=n("38fd"),d=n("2b4c")("iterator"),h=!([].keys&&"next"in[].keys()),p="@@iterator",f="keys",m="values",g=function(){return this};t.exports=function(t,e,n,b,y,v,x){u(n,e,b);var w,k,S,O=function(t){if(!h&&t in I)return I[t];switch(t){case f:return function(){return new n(this,t)};case m:return function(){return new n(this,t)}}return function(){return new n(this,t)}},_=e+" Iterator",C=y==m,T=!1,I=t.prototype,N=I[d]||I[p]||y&&I[y],E=N||O(y),A=y?C?O("entries"):E:void 0,R="Array"==e&&I.entries||N;if(R&&(S=l(R.call(new t)),S!==Object.prototype&&S.next&&(c(S,_,!0),r||"function"==typeof S[d]||o(S,d,g))),C&&N&&N.name!==m&&(T=!0,E=function(){return N.call(this)}),r&&!x||!h&&!T&&I[d]||o(I,d,E),s[e]=E,s[_]=g,y)if(w={values:C?E:O(m),keys:v?E:O(f),entries:A},x)for(k in w)k in I||i(I,k,w[k]);else a(a.P+a.F*(h||T),e,w);return w}},"02f4":function(t,e,n){var r=n("4588"),a=n("be13");t.exports=function(t){return function(e,n){var i,o,s=String(a(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(i=s.charCodeAt(u),i<55296||i>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):i:t?s.slice(u,u+2):o-56320+(i-55296<<10)+65536)}}},"0390":function(t,e,n){"use strict";var r=n("02f4")(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"0bfb":function(t,e,n){"use strict";var r=n("cb7c");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"0d58":function(t,e,n){var r=n("ce10"),a=n("e11e");t.exports=Object.keys||function(t){return r(t,a)}},1495:function(t,e,n){var r=n("86cc"),a=n("cb7c"),i=n("0d58");t.exports=n("9e1e")?Object.defineProperties:function(t,e){a(t);var n,o=i(e),s=o.length,u=0;while(s>u)r.f(t,n=o[u++],e[n]);return t}},"214f":function(t,e,n){"use strict";n("b0c5");var r=n("2aba"),a=n("32e9"),i=n("79e5"),o=n("be13"),s=n("2b4c"),u=n("520a"),c=s("species"),l=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var h=s(t),p=!i((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),f=p?!i((function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[h](""),!e})):void 0;if(!p||!f||"replace"===t&&!l||"split"===t&&!d){var m=/./[h],g=n(o,h,""[t],(function(t,e,n,r,a){return e.exec===u?p&&!a?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),b=g[0],y=g[1];r(String.prototype,t,b),a(RegExp.prototype,h,2==e?function(t,e){return y.call(t,this,e)}:function(t){return y.call(t,this)})}}},"230e":function(t,e,n){var r=n("d3f4"),a=n("7726").document,i=r(a)&&r(a.createElement);t.exports=function(t){return i?a.createElement(t):{}}},"23c6":function(t,e,n){var r=n("2d95"),a=n("2b4c")("toStringTag"),i="Arguments"==r(function(){return arguments}()),o=function(t,e){try{return t[e]}catch(n){}};t.exports=function(t){var e,n,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=o(e=Object(t),a))?n:i?r(e):"Object"==(s=r(e))&&"function"==typeof e.callee?"Arguments":s}},2621:function(t,e){e.f=Object.getOwnPropertySymbols},"2aba":function(t,e,n){var r=n("7726"),a=n("32e9"),i=n("69a8"),o=n("ca5a")("src"),s=n("fa5b"),u="toString",c=(""+s).split(u);n("8378").inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(i(n,"name")||a(n,"name",e)),t[e]!==n&&(u&&(i(n,o)||a(n,o,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:a(t,e,n):(delete t[e],a(t,e,n)))})(Function.prototype,u,(function(){return"function"==typeof this&&this[o]||s.call(this)}))},"2aeb":function(t,e,n){var r=n("cb7c"),a=n("1495"),i=n("e11e"),o=n("613b")("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n("230e")("iframe"),r=i.length,a="<",o=">";e.style.display="none",n("fab2").appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(a+"script"+o+"document.F=Object"+a+"/script"+o),t.close(),c=t.F;while(r--)delete c[u][i[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[o]=t):n=c(),void 0===e?n:a(n,e)}},"2b4c":function(t,e,n){var r=n("5537")("wks"),a=n("ca5a"),i=n("7726").Symbol,o="function"==typeof i,s=t.exports=function(t){return r[t]||(r[t]=o&&i[t]||(o?i:a)("Symbol."+t))};s.store=r},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},"2fdb":function(t,e,n){"use strict";var r=n("5ca1"),a=n("d2c8"),i="includes";r(r.P+r.F*n("5147")(i),"String",{includes:function(t){return!!~a(this,t,i).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(t,e,n){var r=n("86cc"),a=n("4630");t.exports=n("9e1e")?function(t,e,n){return r.f(t,e,a(1,n))}:function(t,e,n){return t[e]=n,t}},"38fd":function(t,e,n){var r=n("69a8"),a=n("4bf8"),i=n("613b")("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=a(t),r(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},"41a0":function(t,e,n){"use strict";var r=n("2aeb"),a=n("4630"),i=n("7f20"),o={};n("32e9")(o,n("2b4c")("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=r(o,{next:a(1,n)}),i(t,e+" Iterator")}},"456d":function(t,e,n){var r=n("4bf8"),a=n("0d58");n("5eda")("keys",(function(){return function(t){return a(r(t))}}))},4588:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"4bf8":function(t,e,n){var r=n("be13");t.exports=function(t){return Object(r(t))}},5147:function(t,e,n){var r=n("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(a){}}return!0}},"520a":function(t,e,n){"use strict";var r=n("0bfb"),a=RegExp.prototype.exec,i=String.prototype.replace,o=a,s="lastIndex",u=function(){var t=/a/,e=/b*/g;return a.call(t,"a"),a.call(e,"a"),0!==t[s]||0!==e[s]}(),c=void 0!==/()??/.exec("")[1],l=u||c;l&&(o=function(t){var e,n,o,l,d=this;return c&&(n=new RegExp("^"+d.source+"$(?!\\s)",r.call(d))),u&&(e=d[s]),o=a.call(d,t),u&&o&&(d[s]=d.global?o.index+o[0].length:e),c&&o&&o.length>1&&i.call(o[0],n,(function(){for(l=1;l<arguments.length-2;l++)void 0===arguments[l]&&(o[l]=void 0)})),o}),t.exports=o},"52a7":function(t,e){e.f={}.propertyIsEnumerable},5537:function(t,e,n){var r=n("8378"),a=n("7726"),i="__core-js_shared__",o=a[i]||(a[i]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(t,e,n){var r=n("7726"),a=n("8378"),i=n("32e9"),o=n("2aba"),s=n("9b43"),u="prototype",c=function(t,e,n){var l,d,h,p,f=t&c.F,m=t&c.G,g=t&c.S,b=t&c.P,y=t&c.B,v=m?r:g?r[e]||(r[e]={}):(r[e]||{})[u],x=m?a:a[e]||(a[e]={}),w=x[u]||(x[u]={});for(l in m&&(n=e),n)d=!f&&v&&void 0!==v[l],h=(d?v:n)[l],p=y&&d?s(h,r):b&&"function"==typeof h?s(Function.call,h):h,v&&o(v,l,h,t&c.U),x[l]!=h&&i(x,l,p),b&&w[l]!=h&&(w[l]=h)};r.core=a,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},"5eda":function(t,e,n){var r=n("5ca1"),a=n("8378"),i=n("79e5");t.exports=function(t,e){var n=(a.Object||{})[t]||Object[t],o={};o[t]=e(n),r(r.S+r.F*i((function(){n(1)})),"Object",o)}},"5f1b":function(t,e,n){"use strict";var r=n("23c6"),a=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var i=n.call(t,e);if("object"!==typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw new TypeError("RegExp#exec called on incompatible receiver");return a.call(t,e)}},"613b":function(t,e,n){var r=n("5537")("keys"),a=n("ca5a");t.exports=function(t){return r[t]||(r[t]=a(t))}},"626a":function(t,e,n){var r=n("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},6762:function(t,e,n){"use strict";var r=n("5ca1"),a=n("c366")(!0);r(r.P,"Array",{includes:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},6821:function(t,e,n){var r=n("626a"),a=n("be13");t.exports=function(t){return r(a(t))}},"69a8":function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},"6a99":function(t,e,n){var r=n("d3f4");t.exports=function(t,e){if(!r(t))return t;var n,a;if(e&&"function"==typeof(n=t.toString)&&!r(a=n.call(t)))return a;if("function"==typeof(n=t.valueOf)&&!r(a=n.call(t)))return a;if(!e&&"function"==typeof(n=t.toString)&&!r(a=n.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},7333:function(t,e,n){"use strict";var r=n("0d58"),a=n("2621"),i=n("52a7"),o=n("4bf8"),s=n("626a"),u=Object.assign;t.exports=!u||n("79e5")((function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach((function(t){e[t]=t})),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r}))?function(t,e){var n=o(t),u=arguments.length,c=1,l=a.f,d=i.f;while(u>c){var h,p=s(arguments[c++]),f=l?r(p).concat(l(p)):r(p),m=f.length,g=0;while(m>g)d.call(p,h=f[g++])&&(n[h]=p[h])}return n}:u},7726:function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(t,e,n){var r=n("4588"),a=Math.max,i=Math.min;t.exports=function(t,e){return t=r(t),t<0?a(t+e,0):i(t,e)}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},"7f20":function(t,e,n){var r=n("86cc").f,a=n("69a8"),i=n("2b4c")("toStringTag");t.exports=function(t,e,n){t&&!a(t=n?t:t.prototype,i)&&r(t,i,{configurable:!0,value:e})}},8378:function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"84f2":function(t,e){t.exports={}},"86cc":function(t,e,n){var r=n("cb7c"),a=n("c69a"),i=n("6a99"),o=Object.defineProperty;e.f=n("9e1e")?Object.defineProperty:function(t,e,n){if(r(t),e=i(e,!0),r(n),a)try{return o(t,e,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},"9b43":function(t,e,n){var r=n("d8e8");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,a){return t.call(e,n,r,a)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,n){var r=n("2b4c")("unscopables"),a=Array.prototype;void 0==a[r]&&n("32e9")(a,r,{}),t.exports=function(t){a[r][t]=!0}},"9def":function(t,e,n){var r=n("4588"),a=Math.min;t.exports=function(t){return t>0?a(r(t),9007199254740991):0}},"9e1e":function(t,e,n){t.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a352:function(e,n){e.exports=t},a481:function(t,e,n){"use strict";var r=n("cb7c"),a=n("4bf8"),i=n("9def"),o=n("4588"),s=n("0390"),u=n("5f1b"),c=Math.max,l=Math.min,d=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};n("214f")("replace",2,(function(t,e,n,m){return[function(r,a){var i=t(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,i,a):n.call(String(i),r,a)},function(t,e){var a=m(n,t,this,e);if(a.done)return a.value;var d=r(t),h=String(this),p="function"===typeof e;p||(e=String(e));var b=d.global;if(b){var y=d.unicode;d.lastIndex=0}var v=[];while(1){var x=u(d,h);if(null===x)break;if(v.push(x),!b)break;var w=String(x[0]);""===w&&(d.lastIndex=s(h,i(d.lastIndex),y))}for(var k="",S=0,O=0;O<v.length;O++){x=v[O];for(var _=String(x[0]),C=c(l(o(x.index),h.length),0),T=[],I=1;I<x.length;I++)T.push(f(x[I]));var N=x.groups;if(p){var E=[_].concat(T,C,h);void 0!==N&&E.push(N);var A=String(e.apply(void 0,E))}else A=g(_,h,C,T,N,e);C>=S&&(k+=h.slice(S,C)+A,S=C+_.length)}return k+h.slice(S)}];function g(t,e,r,i,o,s){var u=r+t.length,c=i.length,l=p;return void 0!==o&&(o=a(o),l=h),n.call(s,l,(function(n,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=o[a.slice(1,-1)];break;default:var l=+a;if(0===l)return n;if(l>c){var h=d(l/10);return 0===h?n:h<=c?void 0===i[h-1]?a.charAt(1):i[h-1]+a.charAt(1):n}s=i[l-1]}return void 0===s?"":s}))}}))},aae3:function(t,e,n){var r=n("d3f4"),a=n("2d95"),i=n("2b4c")("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==a(t))}},ac6a:function(t,e,n){for(var r=n("cadf"),a=n("0d58"),i=n("2aba"),o=n("7726"),s=n("32e9"),u=n("84f2"),c=n("2b4c"),l=c("iterator"),d=c("toStringTag"),h=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=a(p),m=0;m<f.length;m++){var g,b=f[m],y=p[b],v=o[b],x=v&&v.prototype;if(x&&(x[l]||s(x,l,h),x[d]||s(x,d,b),u[b]=h,y))for(g in r)x[g]||i(x,g,r[g],!0)}},b0c5:function(t,e,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c366:function(t,e,n){var r=n("6821"),a=n("9def"),i=n("77f1");t.exports=function(t){return function(e,n,o){var s,u=r(e),c=a(u.length),l=i(o,c);if(t&&n!=n){while(c>l)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},c649:function(t,e,n){"use strict";(function(t){n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return u}));n("a481");function r(){return"undefined"!==typeof window?window.console:t.console}var a=r();function i(t){var e=Object.create(null);return function(n){var r=e[n];return r||(e[n]=t(n))}}var o=/-(\w)/g,s=i((function(t){return t.replace(o,(function(t,e){return e?e.toUpperCase():""}))}));function u(t){null!==t.parentElement&&t.parentElement.removeChild(t)}function c(t,e,n){var r=0===n?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,r)}}).call(this,n("c8ba"))},c69a:function(t,e,n){t.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},ca5a:function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},cadf:function(t,e,n){"use strict";var r=n("9c6c"),a=n("d53b"),i=n("84f2"),o=n("6821");t.exports=n("01f9")(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,a(1)):a(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},cb7c:function(t,e,n){var r=n("d3f4");t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},ce10:function(t,e,n){var r=n("69a8"),a=n("6821"),i=n("c366")(!1),o=n("613b")("IE_PROTO");t.exports=function(t,e){var n,s=a(t),u=0,c=[];for(n in s)n!=o&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~i(c,n)||c.push(n));return c}},d2c8:function(t,e,n){var r=n("aae3"),a=n("be13");t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(a(t))}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d53b:function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},e11e:function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(t,e,n){"use strict";var r=n("5ca1"),a=n("9def"),i=n("d2c8"),o="startsWith",s=""[o];r(r.P+r.F*n("5147")(o),"String",{startsWith:function(t){var e=i(this,t,o),n=a(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},f6fd:function(t,e){(function(t){var e="currentScript",n=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(r){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(r.stack)||[!1])[1];for(t in n)if(n[t].src==e||"interactive"==n[t].readyState)return n[t];return null}}})})(document)},f751:function(t,e,n){var r=n("5ca1");r(r.S+r.F,"Object",{assign:n("7333")})},fa5b:function(t,e,n){t.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(t,e,n){var r=n("7726").document;t.exports=r&&r.documentElement},fb15:function(t,e,n){"use strict";var r;(n.r(e),"undefined"!==typeof window)&&(n("f6fd"),(r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=r[1]));n("f751"),n("f559"),n("ac6a"),n("cadf"),n("456d");function a(t){if(Array.isArray(t))return t}function i(t,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),e&&n.length===e)break}catch(u){a=!0,i=u}finally{try{r||null==s["return"]||s["return"]()}finally{if(a)throw i}}return n}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(t){if("string"===typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function u(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){return a(t)||i(t,e)||s(t,e)||u()}n("6762"),n("2fdb");function l(t){if(Array.isArray(t))return o(t)}function d(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function h(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t){return l(t)||d(t)||s(t)||h()}var f=n("a352"),m=n.n(f),g=n("c649");function b(t,e,n){return void 0===n||(t=t||{},t[e]=n),t}function y(t,e){return t.map((function(t){return t.elm})).indexOf(e)}function v(t,e,n,r){if(!t)return[];var a=t.map((function(t){return t.elm})),i=e.length-r,o=p(e).map((function(t,e){return e>=i?a.length:a.indexOf(t)}));return n?o.filter((function(t){return-1!==t})):o}function x(t,e){var n=this;this.$nextTick((function(){return n.$emit(t.toLowerCase(),e)}))}function w(t){var e=this;return function(n){null!==e.realList&&e["onDrag"+t](n),x.call(e,t,n)}}function k(t){return["transition-group","TransitionGroup"].includes(t)}function S(t){if(!t||1!==t.length)return!1;var e=c(t,1),n=e[0].componentOptions;return!!n&&k(n.tag)}function O(t,e,n){return t[n]||(e[n]?e[n]():void 0)}function _(t,e,n){var r=0,a=0,i=O(e,n,"header");i&&(r=i.length,t=t?[].concat(p(i),p(t)):p(i));var o=O(e,n,"footer");return o&&(a=o.length,t=t?[].concat(p(t),p(o)):p(o)),{children:t,headerOffset:r,footerOffset:a}}function C(t,e){var n=null,r=function(t,e){n=b(n,t,e)},a=Object.keys(t).filter((function(t){return"id"===t||t.startsWith("data-")})).reduce((function(e,n){return e[n]=t[n],e}),{});if(r("attrs",a),!e)return n;var i=e.on,o=e.props,s=e.attrs;return r("on",i),r("props",o),Object.assign(n.attrs,s),n}var T=["Start","Add","Remove","Update","End"],I=["Choose","Unchoose","Sort","Filter","Clone"],N=["Move"].concat(T,I).map((function(t){return"on"+t})),E=null,A={options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(t){return t}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},R={name:"draggable",inheritAttrs:!1,props:A,data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(t){var e=this.$slots.default;this.transitionMode=S(e);var n=_(e,this.$slots,this.$scopedSlots),r=n.children,a=n.headerOffset,i=n.footerOffset;this.headerOffset=a,this.footerOffset=i;var o=C(this.$attrs,this.componentData);return t(this.getTag(),o,r)},created:function(){null!==this.list&&null!==this.value&&g["b"].error("Value and list props are mutually exclusive! Please set one or another."),"div"!==this.element&&g["b"].warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),void 0!==this.options&&g["b"].warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var t=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var e={};T.forEach((function(n){e["on"+n]=w.call(t,n)})),I.forEach((function(n){e["on"+n]=x.bind(t,n)}));var n=Object.keys(this.$attrs).reduce((function(e,n){return e[Object(g["a"])(n)]=t.$attrs[n],e}),{}),r=Object.assign({},this.options,n,e,{onMove:function(e,n){return t.onDragMove(e,n)}});!("draggable"in r)&&(r.draggable=">*"),this._sortable=new m.a(this.rootContainer,r),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(t){this.updateOptions(t)},deep:!0},$attrs:{handler:function(t){this.updateOptions(t)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var t=this._vnode.fnOptions;return t&&t.functional},getTag:function(){return this.tag||this.element},updateOptions:function(t){for(var e in t){var n=Object(g["a"])(e);-1===N.indexOf(n)&&this._sortable.option(n,t[e])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var t=this.$slots.default;return this.transitionMode?t[0].child.$slots.default:t},computeIndexes:function(){var t=this;this.$nextTick((function(){t.visibleIndexes=v(t.getChildrenNodes(),t.rootContainer.children,t.transitionMode,t.footerOffset)}))},getUnderlyingVm:function(t){var e=y(this.getChildrenNodes()||[],t);if(-1===e)return null;var n=this.realList[e];return{index:e,element:n}},getUnderlyingPotencialDraggableComponent:function(t){var e=t.__vue__;return e&&e.$options&&k(e.$options._componentTag)?e.$parent:!("realList"in e)&&1===e.$children.length&&"realList"in e.$children[0]?e.$children[0]:e},emitChanges:function(t){var e=this;this.$nextTick((function(){e.$emit("change",t)}))},alterList:function(t){if(this.list)t(this.list);else{var e=p(this.value);t(e),this.$emit("input",e)}},spliceList:function(){var t=arguments,e=function(e){return e.splice.apply(e,p(t))};this.alterList(e)},updatePosition:function(t,e){var n=function(n){return n.splice(e,0,n.splice(t,1)[0])};this.alterList(n)},getRelatedContextFromMoveEvent:function(t){var e=t.to,n=t.related,r=this.getUnderlyingPotencialDraggableComponent(e);if(!r)return{component:r};var a=r.realList,i={list:a,component:r};if(e!==n&&a&&r.getUnderlyingVm){var o=r.getUnderlyingVm(n);if(o)return Object.assign(o,i)}return i},getVmIndex:function(t){var e=this.visibleIndexes,n=e.length;return t>n-1?n:e[t]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(t){if(this.noTransitionOnDrag&&this.transitionMode){var e=this.getChildrenNodes();e[t].data=null;var n=this.getComponent();n.children=[],n.kept=void 0}},onDragStart:function(t){this.context=this.getUnderlyingVm(t.item),t.item._underlying_vm_=this.clone(this.context.element),E=t.item},onDragAdd:function(t){var e=t.item._underlying_vm_;if(void 0!==e){Object(g["d"])(t.item);var n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();var r={element:e,newIndex:n};this.emitChanges({added:r})}},onDragRemove:function(t){if(Object(g["c"])(this.rootContainer,t.item,t.oldIndex),"clone"!==t.pullMode){var e=this.context.index;this.spliceList(e,1);var n={element:this.context.element,oldIndex:e};this.resetTransitionData(e),this.emitChanges({removed:n})}else Object(g["d"])(t.clone)},onDragUpdate:function(t){Object(g["d"])(t.item),Object(g["c"])(t.from,t.item,t.oldIndex);var e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);var r={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:r})},updateProperty:function(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},computeFutureIndex:function(t,e){if(!t.element)return 0;var n=p(e.to.children).filter((function(t){return"none"!==t.style["display"]})),r=n.indexOf(e.related),a=t.component.getVmIndex(r),i=-1!==n.indexOf(E);return i||!e.willInsertAfter?a:a+1},onDragMove:function(t,e){var n=this.move;if(!n||!this.realList)return!0;var r=this.getRelatedContextFromMoveEvent(t),a=this.context,i=this.computeFutureIndex(r,t);Object.assign(a,{futureIndex:i});var o=Object.assign({},t,{relatedContext:r,draggedContext:a});return n(o,e)},onDragEnd:function(){this.computeIndexes(),E=null}}};"undefined"!==typeof window&&"Vue"in window&&window.Vue.component("draggable",R);var j=R;e["default"]=j}})["default"]}))},b76e:function(t,e,n){},b7d1:function(t,e,n){(function(e){function n(t,e){if(r("noDeprecation"))return t;var n=!1;function a(){if(!n){if(r("throwDeprecation"))throw new Error(e);r("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return a}function r(t){try{if(!e.localStorage)return!1}catch(r){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=n}).call(this,n("c8ba"))},b838:function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this,n="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:n+=t;for(var r=0;r<n.length+64;r++)e.x^=0|n.charCodeAt(r),e.next()}function s(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.xor128=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},b8cd:function(t,e){},b8d8:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i,o,s){const u=e[0],c=o[0],l=new Array(c),d=new Array(u),h=e[1];if(0===c){if(0!==u)throw new Error(r["backend_util"].getSparseFillEmptyRowsIndicesDenseShapeMismatch(u));const t=r["util"].getArrayFromDType(n,0),e=r["util"].getArrayFromDType(i,0);return[t,[0,h],e,l,d]}let p=!0,f=0;const m=new Array(c).fill(0);for(let b=0;b<u;++b){const e=t[b*h];if(e<0)throw new Error(r["backend_util"].getSparseFillEmptyRowsNegativeIndexErrorMessage(b,e));if(e>=c)throw new Error(r["backend_util"].getSparseFillEmptyRowsOutOfRangeIndexErrorMessage(b,e,c));++m[e],p=p&&e>=f,f=e}let g=!0;for(let r=0;r<c;++r){const t=0===m[r];l[r]=t,g=g&&!t,m[r]=Math.max(m[r],1),r>0&&(m[r]+=m[r-1])}if(g&&p){const e=t,n=a;for(let t=0;t<u;++t)d[t]=t;return[e,[u,h],n,l,d]}{const e=m[c-1],o=r["util"].getArrayFromDType(n,e*h),p=r["util"].getArrayFromDType(i,e),f=new Array(c).fill(0);for(let n=0;n<u;++n){const e=t[n*h],r=f[e],i=(0===e?0:m[e-1])+r;f[e]++;for(let a=0;a<h;++a)o[i*h+a]=t[n*h+a];p[i]=a[n],d[n]=i}for(let t=0;t<c;++t){const e=f[t];if(0===e){const e=0===t?0:m[t-1];o[e*h+0]=t;for(let t=1;t<h;++t)o[e*h+t]=0;p[e]=s}}return[o,[e,h],p,l,d]}}},b96e:function(t,e){},b970:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","greaterEqual","string_or_numeric"),u=Object(o["a"])(e,"b","greaterEqual","string_or_numeric");[n,u]=Object(i["makeTypesMatch"])(n,u),Object(s["assertAndGetBroadcastShape"])(n.shape,u.shape);const c={a:n,b:u};return r["a"].runKernel(a["rb"],c)}const l=Object(u["b"])({greaterEqual_:c})},baba:function(t,e){},badf:function(t,e,n){var r=n("642a"),a=n("1838"),i=n("cd9d"),o=n("6747"),s=n("f9ce");function u(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?o(t)?a(t[0],t[1]):r(t):s(t)}t.exports=u},bb2d:function(t,e){},bb7b:function(t,e,n){"use strict";n.r(e),n.d(e,"shuffle",(function(){return a["M"]})),n.d(e,"shuffleCombo",(function(){return a["N"]})),n.d(e,"clamp",(function(){return a["i"]})),n.d(e,"nearestLargerEven",(function(){return a["H"]})),n.d(e,"swap",(function(){return a["S"]})),n.d(e,"sum",(function(){return a["R"]})),n.d(e,"randUniform",(function(){return a["J"]})),n.d(e,"distSquared",(function(){return a["l"]})),n.d(e,"assert",(function(){return a["b"]})),n.d(e,"assertShapesMatch",(function(){return a["e"]})),n.d(e,"assertNonNull",(function(){return a["d"]})),n.d(e,"flatten",(function(){return a["m"]})),n.d(e,"sizeFromShape",(function(){return a["O"]})),n.d(e,"isScalarShape",(function(){return a["y"]})),n.d(e,"arraysEqual",(function(){return a["a"]})),n.d(e,"isInt",(function(){return a["v"]})),n.d(e,"tanh",(function(){return a["T"]})),n.d(e,"sizeToSquarishShape",(function(){return a["P"]})),n.d(e,"createShuffledIndices",(function(){return a["k"]})),n.d(e,"rightPad",(function(){return a["L"]})),n.d(e,"repeatedTry",(function(){return a["K"]})),n.d(e,"inferFromImplicitShape",(function(){return a["s"]})),n.d(e,"parseAxisParam",(function(){return a["I"]})),n.d(e,"squeezeShape",(function(){return a["Q"]})),n.d(e,"getTypedArrayFromDType",(function(){return a["o"]})),n.d(e,"getArrayFromDType",(function(){return a["n"]})),n.d(e,"checkConversionForErrors",(function(){return a["h"]})),n.d(e,"isValidDtype",(function(){return a["B"]})),n.d(e,"hasEncodingLoss",(function(){return a["p"]})),n.d(e,"isTypedArray",(function(){return a["A"]})),n.d(e,"bytesPerElement",(function(){return a["g"]})),n.d(e,"bytesFromStringArray",(function(){return a["f"]})),n.d(e,"isString",(function(){return a["z"]})),n.d(e,"isBoolean",(function(){return a["t"]})),n.d(e,"isNumber",(function(){return a["w"]})),n.d(e,"inferDtype",(function(){return a["r"]})),n.d(e,"isFunction",(function(){return a["u"]})),n.d(e,"nearestDivisor",(function(){return a["G"]})),n.d(e,"computeStrides",(function(){return a["j"]})),n.d(e,"toNestedArray",(function(){return a["U"]})),n.d(e,"makeOnesTypedArray",(function(){return a["D"]})),n.d(e,"makeZerosTypedArray",(function(){return a["F"]})),n.d(e,"makeZerosNestedTypedArray",(function(){return a["E"]})),n.d(e,"assertNonNegativeIntegerDimensions",(function(){return a["c"]})),n.d(e,"locToIndex",(function(){return a["C"]})),n.d(e,"indexToLoc",(function(){return a["q"]})),n.d(e,"isPromise",(function(){return a["x"]})),n.d(e,"hexToLong",(function(){return u})),n.d(e,"fingerPrint64",(function(){return S})),n.d(e,"createScalarValue",(function(){return O})),n.d(e,"toTypedArray",(function(){return C})),n.d(e,"now",(function(){return T})),n.d(e,"fetch",(function(){return I})),n.d(e,"encodeString",(function(){return N})),n.d(e,"decodeString",(function(){return E}));var r=n("32fe"),a=n("df00"),i=n("da5a"),o=n.n(i);
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const s=o.a||i;function u(t){return s.fromString(t,!0,16)}const c=u("c3a5c85c97cb3127"),l=u("b492b66fbe98f273"),d=u("9ae16a3b2f90404f");function h(t){return t.xor(t.shru(47))}function p(t,e,n){const r=t.slice(e,e+n);return s.fromBytes(Array.from(r),!0,!0)}function f(t,e){return p(t,e,8)}function m(t,e){return p(t,e,4)}function g(t,e){return 0===e?t:t.shru(e).or(t.shl(64-e))}function b(t,e,n=u("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let a=e.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function y(t,e,n,r,a,i){a=a.add(t),i=g(i.add(a).add(r),21);const o=a;return a=a.add(e),a=a.add(n),i=i.add(g(a,44)),[a.add(r),i.add(o)]}function v(t,e,n,r){return y(f(t,e),f(t,e+8),f(t,e+16),f(t,e+24),n,r)}function x(t,e=t.length){if(e>=8){const n=d.add(2*e),r=f(t,0).add(d),a=f(t,e-8),i=g(a,37).mul(n).add(r),o=g(r,25).add(a).mul(n);return b(i,o,n)}if(e>=4){const n=d.add(2*e),r=m(t,0);return b(r.shl(3).add(e),m(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],a=t[e-1],i=n+(r<<8),o=e+(a<<2);return h(d.mul(i).xor(c.mul(o))).mul(d)}return d}function w(t,e=t.length){const n=d.add(2*e),r=f(t,0).mul(l),a=f(t,8),i=f(t,e-8).mul(n),o=f(t,e-16).mul(d);return b(g(r.add(a),43).add(g(i,30)).add(o),r.add(g(a.add(d),18)).add(i),n)}function k(t,e=t.length){const n=d.add(2*e),r=f(t,0).mul(d),a=f(t,8),i=f(t,e-8).mul(n),o=f(t,e-16).mul(d),s=g(r.add(a),43).add(g(i,30)).add(o),u=b(s,r.add(g(a.add(d),18)).add(i),n),c=f(t,16).mul(n),l=f(t,24),h=s.add(f(t,e-32)).mul(n),p=u.add(f(t,e-24)).mul(n);return b(g(c.add(l),43).add(g(h,30)).add(p),c.add(g(l.add(r),18)).add(h),n)}function S(t,e=t.length){const n=s.fromNumber(81,!0);if(e<=32)return e<=16?x(t,e):w(t,e);if(e<=64)return k(t,e);let r=n,a=n.mul(l).add(113),i=h(a.mul(d).add(113)).mul(d),o=[s.UZERO,s.UZERO],u=[s.UZERO,s.UZERO];r=r.mul(d).add(f(t,0));let p=0;const m=64*(e-1>>6),y=m+(e-1&63)-63;do{r=g(r.add(a).add(o[0]).add(f(t,p+8)),37).mul(l),a=g(a.add(o[1]).add(f(t,p+48)),42).mul(l),r=r.xor(u[1]),a=a.add(o[0]).add(f(t,p+40)),i=g(i.add(u[0]),33).mul(l),o=v(t,p,o[1].mul(l),r.add(u[0])),u=v(t,p+32,i.add(u[1]),a.add(f(t,p+16))),[i,r]=[r,i],p+=64}while(p!==m);const S=l.add(i.and(255).shl(1));return p=y,u[0]=u[0].add(e-1&63),o[0]=o[0].add(u[0]),u[0]=u[0].add(o[0]),r=g(r.add(a).add(o[0]).add(f(t,p+8)),37).mul(S),a=g(a.add(o[1]).add(f(t,p+48)),42).mul(S),r=r.xor(u[1].mul(9)),a=a.add(o[0].mul(9).add(f(t,p+40))),i=g(i.add(u[0]),33).mul(S),o=v(t,p,o[1].mul(S),r.add(u[0])),u=v(t,p+32,i.add(u[1]),a.add(f(t,p+16))),[i,r]=[r,i],b(b(o[0],u[0],S).add(h(a).mul(c)).add(i),b(o[1],u[1],S).add(r),S)}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O(t,e){return"string"===e?N(t):C([t],e)}function _(t,e){return t instanceof Float32Array&&"float32"===e||t instanceof Int32Array&&"int32"===e||t instanceof Uint8Array&&"bool"===e}function C(t,e){if("string"===e)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=a["m"](t)),Object(r["c"])().getBool("DEBUG")&&a["h"](t,e),_(t,e))return t;if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e){const e=new Uint8Array(t.length);for(let n=0;n<e.length;++n)0!==Math.round(t[n])&&(e[n]=1);return e}throw new Error("Unknown data type "+e)}function T(){return Object(r["c"])().platform.now()}function I(t,e){return Object(r["c"])().platform.fetch(t,e)}function N(t,e="utf-8"){return e=e||"utf-8",Object(r["c"])().platform.encode(t,e)}function E(t,e="utf-8"){return e=e||"utf-8",Object(r["c"])().platform.decode(t,e)}},bbc0:function(t,e,n){var r=n("6044"),a="__lodash_hash_undefined__",i=Object.prototype,o=i.hasOwnProperty;function s(t){var e=this.__data__;if(r){var n=e[t];return n===a?void 0:n}return o.call(e,t)?e[t]:void 0}t.exports=s},bbce:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Noise=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n=255*this.noise(),r=t.data,a=r.length,i=n/2;for(e=0;e<a;e+=4)r[e+0]+=i-2*i*Math.random(),r[e+1]+=i-2*i*Math.random(),r[e+2]+=i-2*i*Math.random()};e.Noise=o,r.Factory.addGetterSetter(a.Node,"noise",.2,i.getNumberValidator(),r.Factory.afterSetFilter)},bc0d:function(t,e){},bc57:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const i={kernelName:r["Real"],backendName:"cpu",kernelFunc:a}},bcab:function(t){t.exports=JSON.parse('{"name":"magpie-base","version":"3.4.0","description":"Provides base components for magpie frontend projects","author":"magpie project","scripts":{"test:unit":"vue-cli-service test:unit","lint":"eslint --ext .js,.vue src","docs":"jsdoc2md src/Magpie.js src/Socket.js src/Mousetracking.js src/Eyetracking.js > src/API.md; vue-cli-service styleguidist","docs:build":"jsdoc2md src/Magpie.js src/Socket.js src/Mousetracking.js src/Eyetracking.js > src/API.md; vue-cli-service styleguidist:build","jsdoc":"jsdoc2md src/Magpie.js src/Socket.js src/Mousetracking.js > src/API.md","lint:fix":"eslint --ext .js,.vue src --fix","stylelint":"stylelint src","stylelint:fix":"stylelint src --fix"},"main":"src/index.js","dependencies":{"chalk":"^4.1.1","commander":"^9.0.0","csv-stringify":"^5.6.2","cute-animals":"^0.2.3","fs-extra":"^10.0.0","k-progress":"^1.5.0","lodash":"^4.17.20","phoenix":"^1.5.9","slash":"^3.0.0","validate-npm-package-name":"^3.0.0","vue":"^2.6.11","vue-i18n":"^8.27.0","vue-slider-component":"^3.2.14","vuedraggable":"^2.24.3","vuelidate":"^0.7.6"},"peerDependencies":{"@vue/cli-service":"~4.5.0","babel-eslint":"^10.1.0","csv-loader":"^3.0.3","konva":"^7.2.5","lodash":"^4.17.20","tone":"^14.7.77","vue":"^2.6.11","vue-konva":"^2.1.7","vue-template-compiler":"^2.6.14"},"devDependencies":{"@types/node-fetch":"^2.5.12","@vue/cli-plugin-unit-jest":"~4.5.0","@vue/cli-service":"^4.5.13","@vue/test-utils":"^1.2.2","babel-eslint":"^10.1.0","css-loader":"^5","eslint":"^6.8.0","eslint-config-prettier":"^6.15.0","eslint-plugin-prettier":"^3.4.0","eslint-plugin-vue":"^8.4.1","form-data":"^4.0.0","get-random-values":"^1.2.2","jsdoc-to-markdown":"^7.0.1","konva":"^7.2.5","node-fetch":"^2.6.7","prettier":"^2.3.2","react":"^17.0.2","react-dom":"^17.0.2","stylelint":"^14.3.0","stylelint-config-recommended-vue":"^1.1.0","tone":"^14.7.77","vue-cli-plugin-styleguidist":"~4.44.15","vue-konva":"^2.1.7","vue-styleguidist":"^4.40.0","vue-template-compiler":"^2.6.14","websocket":"^1.0.34"},"bin":{"magpie":"bin/magpie.js"},"bugs":{"url":"https://github.com/magpie-ea/magpie-base/issues"},"contributors":[{"name":"Xiang Ji","email":"hi@xiangji.me","url":"https://xiangji.me"},{"name":"Marcel Klehr","email":"mklehr@gmx.net","url":"http://marcelklehr.de/"},{"name":"Michael Franke","email":"mchfranke@gmail.com","url":"http://www.home.uni-osnabrueck.de/michfranke/index.html"}],"homepage":"https://github.com/magpie-ea/magpie-base#readme","keywords":["magpie","vue","web-based experiment"],"license":"MIT","repository":{"type":"git","url":"git+https://github.com/magpie-ea/magpie-base.git"},"engines":{"node":">=14.0.0","npm":">=7.0.0"}}')},bcb1:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Enhance=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546");function o(t,e,n,r,a){var i,o=n-e,s=a-r;return 0===o?r+s/2:0===s?r:(i=(t-e)/o,i=s*i+r,i)}var s=function(t){var e,n,r,a,i=t.data,s=i.length,u=i[0],c=u,l=i[1],d=l,h=i[2],p=h,f=this.enhance();if(0!==f){for(a=0;a<s;a+=4)e=i[a+0],e<u?u=e:e>c&&(c=e),n=i[a+1],n<l?l=n:n>d&&(d=n),r=i[a+2],r<h?h=r:r>p&&(p=r);var m,g,b,y,v,x,w,k,S;for(c===u&&(c=255,u=0),d===l&&(d=255,l=0),p===h&&(p=255,h=0),f>0?(g=c+f*(255-c),b=u-f*(u-0),v=d+f*(255-d),x=l-f*(l-0),k=p+f*(255-p),S=h-f*(h-0)):(m=.5*(c+u),g=c+f*(c-m),b=u+f*(u-m),y=.5*(d+l),v=d+f*(d-y),x=l+f*(l-y),w=.5*(p+h),k=p+f*(p-w),S=h+f*(h-w)),a=0;a<s;a+=4)i[a+0]=o(i[a+0],u,c,b,g),i[a+1]=o(i[a+1],l,d,x,v),i[a+2]=o(i[a+2],h,p,S,k)}};e.Enhance=s,r.Factory.addGetterSetter(a.Node,"enhance",0,i.getNumberValidator(),r.Factory.afterSetFilter)},bcd9:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},bd11:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","less","string_or_numeric"),u=Object(o["a"])(e,"b","less","string_or_numeric");[n,u]=Object(i["makeTypesMatch"])(n,u),Object(s["assertAndGetBroadcastShape"])(n.shape,u.shape);const c={a:n,b:u};return r["a"].runKernel(a["Bb"],c)}const l=Object(u["b"])({less_:c})},bd82:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("4ffe"),a=n("e136");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function i(t,e,n){const i=Object(r["c"])(t,n);return Object(a["a"])(t,e,i,n)}},bdee:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Blur=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546");function o(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],u=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function c(t,e){var n,r,a,i,c,l,d,h,p,f,m,g,b,y,v,x,w,k,S,O,_,C,T,I,N=t.data,E=t.width,A=t.height,R=e+e+1,j=E-1,D=A-1,F=e+1,M=F*(F+1)/2,P=new o,$=null,L=P,B=null,z=null,W=s[e],V=u[e];for(a=1;a<R;a++)L=L.next=new o,a===F&&($=L);for(L.next=P,d=l=0,r=0;r<A;r++){for(x=w=k=S=h=p=f=m=0,g=F*(O=N[l]),b=F*(_=N[l+1]),y=F*(C=N[l+2]),v=F*(T=N[l+3]),h+=M*O,p+=M*_,f+=M*C,m+=M*T,L=P,a=0;a<F;a++)L.r=O,L.g=_,L.b=C,L.a=T,L=L.next;for(a=1;a<F;a++)i=l+((j<a?j:a)<<2),h+=(L.r=O=N[i])*(I=F-a),p+=(L.g=_=N[i+1])*I,f+=(L.b=C=N[i+2])*I,m+=(L.a=T=N[i+3])*I,x+=O,w+=_,k+=C,S+=T,L=L.next;for(B=P,z=$,n=0;n<E;n++)N[l+3]=T=m*W>>V,0!==T?(T=255/T,N[l]=(h*W>>V)*T,N[l+1]=(p*W>>V)*T,N[l+2]=(f*W>>V)*T):N[l]=N[l+1]=N[l+2]=0,h-=g,p-=b,f-=y,m-=v,g-=B.r,b-=B.g,y-=B.b,v-=B.a,i=d+((i=n+e+1)<j?i:j)<<2,x+=B.r=N[i],w+=B.g=N[i+1],k+=B.b=N[i+2],S+=B.a=N[i+3],h+=x,p+=w,f+=k,m+=S,B=B.next,g+=O=z.r,b+=_=z.g,y+=C=z.b,v+=T=z.a,x-=O,w-=_,k-=C,S-=T,z=z.next,l+=4;d+=E}for(n=0;n<E;n++){for(w=k=S=x=p=f=m=h=0,l=n<<2,g=F*(O=N[l]),b=F*(_=N[l+1]),y=F*(C=N[l+2]),v=F*(T=N[l+3]),h+=M*O,p+=M*_,f+=M*C,m+=M*T,L=P,a=0;a<F;a++)L.r=O,L.g=_,L.b=C,L.a=T,L=L.next;for(c=E,a=1;a<=e;a++)l=c+n<<2,h+=(L.r=O=N[l])*(I=F-a),p+=(L.g=_=N[l+1])*I,f+=(L.b=C=N[l+2])*I,m+=(L.a=T=N[l+3])*I,x+=O,w+=_,k+=C,S+=T,L=L.next,a<D&&(c+=E);for(l=n,B=P,z=$,r=0;r<A;r++)i=l<<2,N[i+3]=T=m*W>>V,T>0?(T=255/T,N[i]=(h*W>>V)*T,N[i+1]=(p*W>>V)*T,N[i+2]=(f*W>>V)*T):N[i]=N[i+1]=N[i+2]=0,h-=g,p-=b,f-=y,m-=v,g-=B.r,b-=B.g,y-=B.b,v-=B.a,i=n+((i=r+F)<D?i:D)*E<<2,h+=x+=B.r=N[i],p+=w+=B.g=N[i+1],f+=k+=B.b=N[i+2],m+=S+=B.a=N[i+3],B=B.next,g+=O=z.r,b+=_=z.g,y+=C=z.b,v+=T=z.a,x-=O,w-=_,k-=C,S-=T,z=z.next,l+=E}}var l=function(t){var e=Math.round(this.blurRadius());e>0&&c(t,e)};e.Blur=l,r.Factory.addGetterSetter(a.Node,"blurRadius",0,i.getNumberValidator(),r.Factory.afterSetFilter)},be56:function(t,e){var n=Math.floor,r=Math.random;function a(t,e){return t+n(r()*(e-t+1))}t.exports=a},bf11:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Ring=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=2*Math.PI,l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,c,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),c,0,!0),t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(o.Shape);e.Ring=l,l.prototype.className="Ring",l.prototype._centroid=!0,l.prototype._attrsAffectingSize=["innerRadius","outerRadius"],u._registerNode(l),i.Factory.addGetterSetter(l,"innerRadius",0,s.getNumberValidator()),i.Factory.addGetterSetter(l,"outerRadius",0,s.getNumberValidator()),a.Collection.mapMethods(l)},bfff:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","equal","string_or_numeric"),u=Object(o["a"])(e,"b","equal","string_or_numeric");[n,u]=Object(i["makeTypesMatch"])(n,u),Object(s["assertAndGetBroadcastShape"])(n.shape,u.shape);const c={a:n,b:u};return r["a"].runKernel(a["ab"],c)}const l=Object(u["b"])({equal_:c})},c05f:function(t,e,n){var r=n("7b97"),a=n("1310");function i(t,e,n,o,s){return t===e||(null==t||null==e||!a(t)&&!a(e)?t!==t&&e!==e:r(t,e,n,o,i,s))}t.exports=i},c098:function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;function a(t,e){var a=typeof t;return e=null==e?n:e,!!e&&("number"==a||"symbol"!=a&&r.test(t))&&t>-1&&t%1==0&&t<e}t.exports=a},c0e4:function(t,e){},c0f2:function(t,e){},c1c9:function(t,e,n){var r=n("a454"),a=n("f3c1"),i=a(r);t.exports=i},c2a1:function(t){t.exports=JSON.parse('{"screens":{"AwaitIteratedResultScreen":{"description":"This screen waits for the results of the previous iteration of this experiment."},"ConnectInteractiveScreen":{"description":"This screen sets up the socket connection for the interactive experiment and waits for other participants to join so that the number of required participants to start an interactive experiment is met."},"EyetrackingCalibrationScreen":{"start":"Please wait while eye tracking is set up.","instruction":"Please follow and click on the red dot.","error":"Something went wrong. Please reload the page."},"EyetrackingValidationScreen":{"instruction":"Please stare at the blue dot in the center.","error":"Something went wrong. Please reload the page."},"PostTestScreen":{"instruction":"Answering the following questions is optional, but your answers will help us analyze our results.","age":"Age","gender":"Gender","male":"male","female":"female","otherGender":"other","education":"Level of Education","educationBelowHighschool":"Did not graduate High-school","educationHighschool":"Graduated High-school","educationCollege":"Graduated College","educationHigher":"Higher degree","nativeLanguages":"Native languages","nativeLanguagesExplanation":"the language(s) spoken at home when you were a child","comments":"Further comments","belowHighschool":"screens.PostTestScreen.belowHighschool"},"SubmitResultsScreen":{"waiting":"Submitting your data, please wait...","done":"All done. Thank you! The page will automatically redirect to Prolific (if it doesn\'t redirect within a minute, you may close this page)...","error":"There was a problem submitting the results online.","contact":"In order not to waste your valuable time and data, please click the button below to download your data, then send it as an email attachment to the author of this study:","download":"Download Data"}},"general":{"nextButton":"Next","start":"Start","go":"Go","send":"Send"},"interactive":{"Chat":{"messageLabel":"Type your message to the other participant here.","statusYouJoined":"You joined","statusYouLeft":"You left","statusParticipantJoined":"{user} joined","statusParticipantLeft":"{user} left"},"general":{"aborted":"The experiment cannot be continued, because a collaborator has left the session. Please proceed to result submission."}}}')},c2ae:function(t,e,n){t.exports=n("e372").PassThrough},c301:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.regex)("decimal",/^[-]?\d*(\.\d+)?$/);e.default=a},c527:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HitContext=e.SceneContext=e.Context=void 0;var a=n("9cb8"),i=n("d777"),o=",",s="(",u=")",c="([",l="])",d=";",h="()",p="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],m=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],g=100,b=function(){function t(t){this.canvas=t,this._context=t._canvas.getContext("2d"),i.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}return t.prototype.fillShape=function(t){t.fillEnabled()&&this._fill(t)},t.prototype._fill=function(t){},t.prototype.strokeShape=function(t){t.hasStroke()&&this._stroke(t)},t.prototype._stroke=function(t){},t.prototype.fillStrokeShape=function(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))},t.prototype.getTrace=function(t){var e,n,r,i,f=this.traceArr,m=f.length,g="";for(e=0;e<m;e++)n=f[e],r=n.method,r?(i=n.args,g+=r,t?g+=h:a.Util._isArray(i[0])?g+=c+i.join(o)+l:g+=s+i.join(o)+u):(g+=n.property,t||(g+=p+n.val)),g+=d;return g},t.prototype.clearTrace=function(){this.traceArr=[]},t.prototype._trace=function(t){var e,n=this.traceArr;n.push(t),e=n.length,e>=g&&n.shift()},t.prototype.reset=function(){var t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.clear=function(t){var e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)},t.prototype._applyLineCap=function(t){var e=t.getLineCap();e&&this.setAttr("lineCap",e)},t.prototype._applyOpacity=function(t){var e=t.getAbsoluteOpacity();1!==e&&this.setAttr("globalAlpha",e)},t.prototype._applyLineJoin=function(t){var e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)},t.prototype.setAttr=function(t,e){this._context[t]=e},t.prototype.arc=function(t,e,n,r,a,i){this._context.arc(t,e,n,r,a,i)},t.prototype.arcTo=function(t,e,n,r,a){this._context.arcTo(t,e,n,r,a)},t.prototype.beginPath=function(){this._context.beginPath()},t.prototype.bezierCurveTo=function(t,e,n,r,a,i){this._context.bezierCurveTo(t,e,n,r,a,i)},t.prototype.clearRect=function(t,e,n,r){this._context.clearRect(t,e,n,r)},t.prototype.clip=function(){this._context.clip()},t.prototype.closePath=function(){this._context.closePath()},t.prototype.createImageData=function(t,e){var n=arguments;return 2===n.length?this._context.createImageData(t,e):1===n.length?this._context.createImageData(t):void 0},t.prototype.createLinearGradient=function(t,e,n,r){return this._context.createLinearGradient(t,e,n,r)},t.prototype.createPattern=function(t,e){return this._context.createPattern(t,e)},t.prototype.createRadialGradient=function(t,e,n,r,a,i){return this._context.createRadialGradient(t,e,n,r,a,i)},t.prototype.drawImage=function(t,e,n,r,a,i,o,s,u){var c=arguments,l=this._context;3===c.length?l.drawImage(t,e,n):5===c.length?l.drawImage(t,e,n,r,a):9===c.length&&l.drawImage(t,e,n,r,a,i,o,s,u)},t.prototype.ellipse=function(t,e,n,r,a,i,o,s){this._context.ellipse(t,e,n,r,a,i,o,s)},t.prototype.isPointInPath=function(t,e){return this._context.isPointInPath(t,e)},t.prototype.fill=function(){this._context.fill()},t.prototype.fillRect=function(t,e,n,r){this._context.fillRect(t,e,n,r)},t.prototype.strokeRect=function(t,e,n,r){this._context.strokeRect(t,e,n,r)},t.prototype.fillText=function(t,e,n){this._context.fillText(t,e,n)},t.prototype.measureText=function(t){return this._context.measureText(t)},t.prototype.getImageData=function(t,e,n,r){return this._context.getImageData(t,e,n,r)},t.prototype.lineTo=function(t,e){this._context.lineTo(t,e)},t.prototype.moveTo=function(t,e){this._context.moveTo(t,e)},t.prototype.rect=function(t,e,n,r){this._context.rect(t,e,n,r)},t.prototype.putImageData=function(t,e,n){this._context.putImageData(t,e,n)},t.prototype.quadraticCurveTo=function(t,e,n,r){this._context.quadraticCurveTo(t,e,n,r)},t.prototype.restore=function(){this._context.restore()},t.prototype.rotate=function(t){this._context.rotate(t)},t.prototype.save=function(){this._context.save()},t.prototype.scale=function(t,e){this._context.scale(t,e)},t.prototype.setLineDash=function(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context["mozDash"]=t:"webkitLineDash"in this._context&&(this._context["webkitLineDash"]=t)},t.prototype.getLineDash=function(){return this._context.getLineDash()},t.prototype.setTransform=function(t,e,n,r,a,i){this._context.setTransform(t,e,n,r,a,i)},t.prototype.stroke=function(){this._context.stroke()},t.prototype.strokeText=function(t,e,n,r){this._context.strokeText(t,e,n,r)},t.prototype.transform=function(t,e,n,r,a,i){this._context.transform(t,e,n,r,a,i)},t.prototype.translate=function(t,e){this._context.translate(t,e)},t.prototype._enableTrace=function(){var t,e,n=this,r=f.length,i=a.Util._simplifyArray,o=this.setAttr,s=function(t){var r,a=n[t];n[t]=function(){return e=i(Array.prototype.slice.call(arguments,0)),r=a.apply(n,arguments),n._trace({method:t,args:e}),r}};for(t=0;t<r;t++)s(f[t]);n.setAttr=function(){o.apply(n,arguments);var t=arguments[0],e=arguments[1];"shadowOffsetX"!==t&&"shadowOffsetY"!==t&&"shadowBlur"!==t||(e/=this.canvas.getPixelRatio()),n._trace({property:t,val:e})}},t.prototype._applyGlobalCompositeOperation=function(t){var e=t.getGlobalCompositeOperation();"source-over"!==e&&this.setAttr("globalCompositeOperation",e)},t}();e.Context=b,m.forEach((function(t){Object.defineProperty(b.prototype,t,{get:function(){return this._context[t]},set:function(e){this._context[t]=e}})}));var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._fillColor=function(t){var e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)},e.prototype._fillPattern=function(t){var e=t.getFillPatternX(),n=t.getFillPatternY(),r=i.Konva.getAngle(t.getFillPatternRotation()),a=t.getFillPatternOffsetX(),o=t.getFillPatternOffsetY();t.getFillPatternScaleX(),t.getFillPatternScaleY();(e||n)&&this.translate(e||0,n||0),r&&this.rotate(r),(a||o)&&this.translate(-1*a,-1*o),this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)},e.prototype._fillLinearGradient=function(t){var e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},e.prototype._fillRadialGradient=function(t){var e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))},e.prototype._fill=function(t){var e=t.fill(),n=t.getFillPriority();if(e&&"color"===n)this._fillColor(t);else{var r=t.getFillPatternImage();if(r&&"pattern"===n)this._fillPattern(t);else{var a=t.getFillLinearGradientColorStops();if(a&&"linear-gradient"===n)this._fillLinearGradient(t);else{var i=t.getFillRadialGradientColorStops();i&&"radial-gradient"===n?this._fillRadialGradient(t):e?this._fillColor(t):r?this._fillPattern(t):a?this._fillLinearGradient(t):i&&this._fillRadialGradient(t)}}}},e.prototype._strokeLinearGradient=function(t){var e=t.getStrokeLinearGradientStartPoint(),n=t.getStrokeLinearGradientEndPoint(),r=t.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(e.x,e.y,n.x,n.y);if(r){for(var i=0;i<r.length;i+=2)a.addColorStop(r[i],r[i+1]);this.setAttr("strokeStyle",a)}},e.prototype._stroke=function(t){var e=t.dash(),n=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!n){this.save();var r=this.getCanvas().getPixelRatio();this.setTransform(r,0,0,r,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var a=t.getStrokeLinearGradientColorStops();a?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),n||this.restore()}},e.prototype._applyShadow=function(t){var e=a.Util,n=e.get(t.getShadowRGBA(),"black"),r=e.get(t.getShadowBlur(),5),i=e.get(t.getShadowOffset(),{x:0,y:0}),o=t.getAbsoluteScale(),s=this.canvas.getPixelRatio(),u=o.x*s,c=o.y*s;this.setAttr("shadowColor",n),this.setAttr("shadowBlur",r*Math.min(Math.abs(u),Math.abs(c))),this.setAttr("shadowOffsetX",i.x*u),this.setAttr("shadowOffsetY",i.y*c)},e}(b);e.SceneContext=y;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._fill=function(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()},e.prototype.strokeShape=function(t){t.hasHitStroke()&&this._stroke(t)},e.prototype._stroke=function(t){if(t.hasHitStroke()){var e=t.getStrokeScaleEnabled();if(!e){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(t);var r=t.hitStrokeWidth(),a="auto"===r?t.strokeWidth():r;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}},e}(b);e.HitContext=v},c584:function(t,e){function n(t,e){return t.has(e)}t.exports=n},c5c9:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t){return(e,n,a,i,o)=>{const s=r["backend_util"].assertAndGetBroadcastShape(e,n),u=s.length,c=r["util"].computeStrides(s),l=r["util"].sizeFromShape(s),d=r["util"].getTypedArrayFromDType(o,l),h=e.length,p=n.length,f=r["util"].computeStrides(e),m=r["util"].computeStrides(n),g=r["backend_util"].getBroadcastDims(e,s),b=r["backend_util"].getBroadcastDims(n,s);if(g.length+b.length===0)for(let r=0;r<d.length;++r)d[r]=t(a[r%a.length],i[r%i.length]);else for(let y=0;y<d.length;++y){const e=r["util"].indexToLoc(y,u,c),n=e.slice(-h);g.forEach(t=>n[t]=0);const o=r["util"].locToIndex(n,h,f),s=e.slice(-p);b.forEach(t=>s[t]=0);const l=r["util"].locToIndex(s,p,m);d[y]=t(a[o],i[l])}return[d,s]}}},c701:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i,o,s,u,c){const l=Object(r["buffer"])([a,o],n);for(let r=0;r<a;r++){const n=[];let a=0;for(let e=0;e<i;e++){const o=t[r*i+e];a+=o*s[e],n.push(o)}if(a<0||a>=c/o)throw new Error(`Invalid indices: ${n} does not index into ${u}`);for(let t=0;t<o;t++)l.values[r*o+t]=e.get(...e.indexToLoc(a*o+t))}return l}},c742:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Contrast=void 0;var r=n("f0b4"),a=n("4971"),i=n("4546"),o=function(t){var e,n=Math.pow((this.contrast()+100)/100,2),r=t.data,a=r.length,i=150,o=150,s=150;for(e=0;e<a;e+=4)i=r[e],o=r[e+1],s=r[e+2],i/=255,i-=.5,i*=n,i+=.5,i*=255,o/=255,o-=.5,o*=n,o+=.5,o*=255,s/=255,s-=.5,s*=n,s+=.5,s*=255,i=i<0?0:i>255?255:i,o=o<0?0:o>255?255:o,s=s<0?0:s>255?255:s,r[e]=i,r[e+1]=o,r[e+2]=s};e.Contrast=o,r.Factory.addGetterSetter(a.Node,"contrast",0,i.getNumberValidator(),r.Factory.afterSetFilter)},c76e:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e=0,n=!1,o=!1){const s=Object(i["a"])(t,"x","cumprod"),u={x:s},c={axis:e,exclusive:n,reverse:o};return r["a"].runKernel(a["M"],u,c)}const u=Object(o["b"])({cumprod_:s})},c779:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","floor","float32"),n={x:e};return r["a"].runKernel(a["ib"],n)}const u=Object(o["b"])({floor_:s})},c794:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n("219b"),a=n("4ffe"),i=n("f947");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t){const e=Object(a["a"])(t,"x","square"),n={};return r["a"].runKernel("Square",{x:e},n)}const s=Object(i["b"])({square_:o})},c869:function(t,e,n){var r=n("0b07"),a=n("2b3e"),i=r(a,"Set");t.exports=i},c879:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("219b"),a=n("df00"),i=n("d579");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e="float32"){if("complex64"===e){const e=o(t,"float32"),n=o(t,"float32");return Object(i["a"])(e,n)}const n=Object(a["F"])(Object(a["O"])(t),e);return r["a"].makeTensor(n,t,e)}},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},c8fe:function(t,e,n){var r=n("f8af");function a(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}t.exports=a},c99d:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.withParams)({type:"ipAddress"},(function(t){if(!(0,r.req)(t))return!0;if("string"!==typeof t)return!1;var e=t.split(".");return 4===e.length&&e.every(i)}));e.default=a;var i=function(t){if(t.length>3||0===t.length)return!1;if("0"===t[0]&&"0"!==t)return!1;if(!t.match(/^\d+$/))return!1;var e=0|+t;return e>=0&&e<=255}},ca58:function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t,e=!1){console.log(t.toString(e))}n.d(e,"a",(function(){return r}))},cae0:function(t,e,n){(function(t){var r;(function(t,a,i){function o(t){var e=this;function n(t,e){var n,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,n=0;n<e.length;++n)r[7&n]=r[7&n]<<15^e.charCodeAt(n)+r[n+1&7]<<13;while(r.length<8)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],t.x=r,t.i=0,n=256;n>0;--n)t.next()}e.next=function(){var t,n,r=e.x,a=e.i;return t=r[a],t^=t>>>7,n=t^t<<24,t=r[a+1&7],n^=t^t>>>10,t=r[a+3&7],n^=t^t>>>3,t=r[a+4&7],n^=t^t<<7,t=r[a+7&7],t^=t<<13,n^=t^t<<9,r[a]=n,e.i=a+1&7,n},n(e,t)}function s(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var n=new o(t),r=e&&e.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var t=n.next()>>>11,e=(n.next()>>>0)/4294967296,r=(t+e)/(1<<21)}while(0===r);return r},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("07d6")&&n("3c35")?(r=function(){return u}.call(e,n,e,a),void 0===r||(a.exports=r)):this.xorshift7=u})(0,t,n("07d6"))}).call(this,n("62e4")(t))},cb27:function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;"undefined"!==typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var n,r,a,i;"undefined"===typeof e&&(e=15),a=.5,n=new Date;while(1){for(a*=2,i=a;i>3;i-=4)t(),t(),t(),t();while(i>0)t(),i--;if(r=new Date,r-n>e)break}for(i=a;i>3;i-=4)t(),t(),t(),t();while(i>0)t(),i--;return r=new Date,1e3*(3*a-1)/(r-n)},numeric._myIndexOf=function(t){var e,n=this.length;for(e=0;e<n;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var n=Math.floor(Math.log(t)/Math.log(10)),r=t/Math.pow(10,n),a=r.toPrecision(numeric.precision);return 10===parseFloat(a)&&(n++,r=1,a=r.toPrecision(numeric.precision)),parseFloat(a).toString()+"e"+n.toString()}return"Infinity"}var n=[];function r(t){var a;if("undefined"===typeof t)return n.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof t)return n.push('"'+t+'"'),!1;if("boolean"===typeof t)return n.push(t.toString()),!1;if("number"===typeof t){var i=e(t),o=t.toPrecision(numeric.precision),s=parseFloat(t.toString()).toString(),u=[i,o,s,parseFloat(o).toString(),parseFloat(s).toString()];for(a=1;a<u.length;a++)u[a].length<i.length&&(i=u[a]);return n.push(Array(numeric.precision+8-i.length).join(" ")+i),!1}if(null===t)return n.push("null"),!1;if("function"===typeof t){n.push(t.toString());var c=!1;for(a in t)t.hasOwnProperty(a)&&(c?n.push(",\n"):n.push("\n{"),c=!0,n.push(a),n.push(": \n"),r(t[a]));return c&&n.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return n.push("...Large Array..."),!0;c=!1;for(n.push("["),a=0;a<t.length;a++)a>0&&(n.push(","),c&&n.push("\n ")),c=r(t[a]);return n.push("]"),!0}n.push("{");c=!1;for(a in t)t.hasOwnProperty(a)&&(c&&n.push(",\n"),c=!0,n.push(a),n.push(": \n"),r(t[a]));return n.push("}"),!0}return r(t),n.join("")},numeric.parseDate=function(t){function e(t){if("string"===typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}return e(t)},numeric.parseFloat=function(t){function e(t){if("string"===typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var n,r=[];for(n=0;n<t.length;n++)r[n]=e(t[n]);return r}return e(t)},numeric.parseCSV=function(t){var e,n,r=t.split("\n"),a=[],i=/(([^'",]*)|('[^']*')|("[^"]*")),/g,o=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,s=function(t){return t.substr(0,t.length-1)},u=0;for(n=0;n<r.length;n++){var c,l=(r[n]+",").match(i);if(l.length>0){for(a[u]=[],e=0;e<l.length;e++)c=s(l[e]),o.test(c)?a[u][e]=parseFloat(c):a[u][e]=c;u++}}return a},numeric.toCSV=function(t){var e,n,r,a,i,o=numeric.dim(t);for(r=o[0],o[1],i=[],e=0;e<r;e++){for(a=[],n=0;n<r;n++)a[n]=t[e][n].toString();i[e]=a.join(", ")}return i.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t){var e,n,r,a,i,o,s,u,c=t.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="";for(e=0;e<c;e+=3)n=t[e],r=t[e+1],a=t[e+2],i=n>>2,o=((3&n)<<4)+(r>>4),s=((15&r)<<2)+(a>>6),u=63&a,e+1>=c?s=u=64:e+2>=c&&(u=64),d+=l.charAt(i)+l.charAt(o)+l.charAt(s)+l.charAt(u);return d}function n(t,e,n){"undefined"===typeof e&&(e=0),"undefined"===typeof n&&(n=t.length);var r,a=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,o=0;t.length;for(r=e;r<n;r++)o=255&(i^t[r]),i=i>>>8^a[o];return-1^i}var r,a,i,o,s,u,c,l,d,h,p=t[0].length,f=t[0][0].length,m=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(h=n(m,12,29),m[29]=h>>24&255,m[30]=h>>16&255,m[31]=h>>8&255,m[32]=255&h,r=1,a=0,c=0;c<p;c++){for(c<p-1?m.push(0):m.push(1),s=3*f+1+(0===c)&255,u=3*f+1+(0===c)>>8&255,m.push(s),m.push(u),m.push(255&~s),m.push(255&~u),0===c&&m.push(0),l=0;l<f;l++)for(i=0;i<3;i++)s=t[i][c][l],s=s>255?255:s<0?0:Math.round(s),r=(r+s)%65521,a=(a+r)%65521,m.push(s);m.push(0)}return d=(a<<16)+r,m.push(d>>24&255),m.push(d>>16&255),m.push(d>>8&255),m.push(255&d),o=m.length-41,m[33]=o>>24&255,m[34]=o>>16&255,m[35]=o>>8&255,m[36]=255&o,h=n(m,37),m.push(h>>24&255),m.push(h>>16&255),m.push(h>>8&255),m.push(255&h),m.push(0),m.push(0),m.push(0),m.push(0),m.push(73),m.push(69),m.push(78),m.push(68),m.push(174),m.push(66),m.push(96),m.push(130),"data:image/png;base64,"+e(m)},numeric._dim=function(t){var e=[];while("object"===typeof t)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e,n;return"object"===typeof t?(e=t[0],"object"===typeof e?(n=e[0],"object"===typeof n?numeric._dim(t):[t.length,e.length]):[t.length]):[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,n){var r,a;if(!(e instanceof Array)||!(n instanceof Array))return!1;if(a=e.length,a!==n.length)return!1;for(r=0;r<a;r++)if(e[r]!==n[r]){if("object"!==typeof e[r])return!1;if(!t(e[r],n[r]))return!1}return!0},numeric.rep=function(t,e,n){"undefined"===typeof n&&(n=0);var r,a=t[n],i=Array(a);if(n===t.length-1){for(r=a-2;r>=0;r-=2)i[r+1]=e,i[r]=e;return-1===r&&(i[0]=e),i}for(r=a-1;r>=0;r--)i[r]=numeric.rep(t,e,n+1);return i},numeric.dotMMsmall=function(t,e){var n,r,a,i,o,s,u,c,l,d,h;for(i=t.length,o=e.length,s=e[0].length,u=Array(i),n=i-1;n>=0;n--){for(c=Array(s),l=t[n],a=s-1;a>=0;a--){for(d=l[o-1]*e[o-1][a],r=o-2;r>=1;r-=2)h=r-1,d+=l[r]*e[r][a]+l[h]*e[h][a];0===r&&(d+=l[0]*e[0][a]),c[a]=d}u[n]=c}return u},numeric._getCol=function(t,e,n){var r,a=t.length;for(r=a-1;r>0;--r)n[r]=t[r][e],--r,n[r]=t[r][e];0===r&&(n[0]=t[0][e])},numeric.dotMMbig=function(t,e){var n,r,a,i=numeric._getCol,o=e.length,s=Array(o),u=t.length,c=e[0].length,l=new Array(u),d=numeric.dotVV;for(--o,--u,r=u;-1!==r;--r)l[r]=Array(c);for(--c,r=c;-1!==r;--r)for(i(e,r,s),a=u;-1!==a;--a)0,n=t[a],l[a][r]=d(n,s);return l},numeric.dotMV=function(t,e){var n,r=t.length,a=(e.length,Array(r)),i=numeric.dotVV;for(n=r-1;n>=0;n--)a[n]=i(t[n],e);return a},numeric.dotVM=function(t,e){var n,r,a,i,o,s,u;for(a=t.length,i=e[0].length,o=Array(i),r=i-1;r>=0;r--){for(s=t[a-1]*e[a-1][r],n=a-2;n>=1;n-=2)u=n-1,s+=t[n]*e[n][r]+t[u]*e[u][r];0===n&&(s+=t[0]*e[0][r]),o[r]=s}return o},numeric.dotVV=function(t,e){var n,r,a=t.length,i=t[a-1]*e[a-1];for(n=a-2;n>=1;n-=2)r=n-1,i+=t[n]*e[n]+t[r]*e[r];return 0===n&&(i+=t[0]*e[0]),i},numeric.dot=function(t,e){var n=numeric.dim;switch(1e3*n(t).length+n(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,n,r,a,i=t.length,o=Array(i);for(e=i-1;e>=0;e--){for(a=Array(i),n=e+2,r=i-1;r>=n;r-=2)a[r]=0,a[r-1]=0;for(r>e&&(a[r]=0),a[e]=t[e],r=e-1;r>=1;r-=2)a[r]=0,a[r-1]=0;0===r&&(a[0]=0),o[e]=a}return o},numeric.getDiag=function(t){var e,n=Math.min(t.length,t[0].length),r=Array(n);for(e=n-1;e>=1;--e)r[e]=t[e][e],--e,r[e]=t[e][e];return 0===e&&(r[0]=t[0][0]),r},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,n){"undefined"===typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)o.test(t[r])?(a=t[r].substring(0,t[r].length-3),s=a):a=t[r],"ret"===a&&(u=!0),i.push(a);return i[t.length]="_s",i[t.length+1]="_k",i[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+s+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric.pointwise2=function(t,e,n){"undefined"===typeof n&&(n="");var r,a,i=[],o=/\[i\]$/,s="",u=!1;for(r=0;r<t.length;r++)o.test(t[r])?(a=t[r].substring(0,t[r].length-3),s=a):a=t[r],"ret"===a&&(u=!0),i.push(a);return i[t.length]="var _n = "+s+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+n+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,i)},numeric._biforeach=function t(e,n,r,a,i){if(a!==r.length-1){var o,s=r[a];for(o=s-1;o>=0;o--)t("object"===typeof e?e[o]:e,"object"===typeof n?n[o]:n,r,a+1,i)}else i(e,n)},numeric._biforeach2=function t(e,n,r,a,i){if(a===r.length-1)return i(e,n);var o,s=r[a],u=Array(s);for(o=s-1;o>=0;--o)u[o]=t("object"===typeof e?e[o]:e,"object"===typeof n?n[o]:n,r,a+1,i);return u},numeric._foreach=function t(e,n,r,a){if(r!==n.length-1){var i,o=n[r];for(i=o-1;i>=0;i--)t(e[i],n,r+1,a)}else a(e)},numeric._foreach2=function t(e,n,r,a){if(r===n.length-1)return a(e);var i,o=n[r],s=Array(o);for(i=o-1;i>=0;i--)s[i]=t(e[i],n,r+1,a);return s},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var n,r,a="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(a="var "+e+" = Math."+e+";\n",n=function(t,n,r){return t+" = "+e+"("+n+","+r+")"},r=function(t,n){return t+" = "+e+"("+t+","+n+")"}):(n=function(t,n,r){return t+" = "+n+" "+e+" "+r},r=numeric.opseq.hasOwnProperty(t+"eq")?function(t,n){return t+" "+e+"= "+n}:function(t,n){return t+" = "+t+" "+e+" "+n}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],n("ret[i]","x[i]","y[i]"),a),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],n("ret[i]","x","y[i]"),a),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],n("ret[i]","x[i]","y"),a),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+r("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],r("ret[i]","x[i]"),a),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],r("ret[i]","x"),a),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(a="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(a="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",a),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",a),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"===typeof t?"object"===typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"===typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,n,r,a,i,o,s,u=numeric.dim(t),c=Math.abs,l=u[0],d=u[1],h=numeric.clone(t),p=numeric.identity(l);for(o=0;o<d;++o){var f=-1,m=-1;for(i=o;i!==l;++i)s=c(h[i][o]),s>m&&(f=i,m=s);for(n=h[f],h[f]=h[o],h[o]=n,a=p[f],p[f]=p[o],p[o]=a,t=n[o],s=o;s!==d;++s)n[s]/=t;for(s=d-1;-1!==s;--s)a[s]/=t;for(i=l-1;-1!==i;--i)if(i!==o){for(e=h[i],r=p[i],t=e[o],s=o+1;s!==d;++s)e[s]-=n[s]*t;for(s=d-1;s>0;--s)r[s]-=a[s]*t,--s,r[s]-=a[s]*t;0===s&&(r[0]-=a[0]*t)}}return p},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var n,r,a,i,o,s,u,c,l=e[0],d=1,h=numeric.clone(t);for(r=0;r<l-1;r++){for(a=r,n=r+1;n<l;n++)Math.abs(h[n][r])>Math.abs(h[a][r])&&(a=n);for(a!==r&&(u=h[a],h[a]=h[r],h[r]=u,d*=-1),i=h[r],n=r+1;n<l;n++){for(o=h[n],s=o[r]/i[r],a=r+1;a<l-1;a+=2)c=a+1,o[a]-=i[a]*s,o[c]-=i[c]*s;a!==l&&(o[a]-=i[a]*s)}if(0===i[r])return 0;d*=i[r]}return d*h[r][r]},numeric.transpose=function(t){var e,n,r,a,i,o=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(o);for(e=o-1;e>=1;e-=2){for(a=t[e],r=t[e-1],n=s-1;n>=1;--n)i=u[n],i[e]=a[n],i[e-1]=r[n],--n,i=u[n],i[e]=a[n],i[e-1]=r[n];0===n&&(i=u[0],i[e]=a[0],i[e-1]=r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=r[n],--n,u[n][0]=r[n];0===n&&(u[0][0]=r[0])}return u},numeric.negtranspose=function(t){var e,n,r,a,i,o=t.length,s=t[0].length,u=Array(s);for(n=0;n<s;n++)u[n]=Array(o);for(e=o-1;e>=1;e-=2){for(a=t[e],r=t[e-1],n=s-1;n>=1;--n)i=u[n],i[e]=-a[n],i[e-1]=-r[n],--n,i=u[n],i[e]=-a[n],i[e-1]=-r[n];0===n&&(i=u[0],i[e]=-a[0],i[e-1]=-r[0])}if(0===e){for(r=t[0],n=s-1;n>=1;--n)u[n][0]=-r[n],--n,u[n][0]=-r[n];0===n&&(u[0][0]=-r[0])}return u},numeric._random=function t(e,n){var r,a,i=e[n],o=Array(i);if(n===e.length-1){for(a=Math.random,r=i-1;r>=1;r-=2)o[r]=a(),o[r-1]=a();return 0===r&&(o[0]=a()),o}for(r=i-1;r>=0;r--)o[r]=t(e,n+1);return o},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,n){if("undefined"===typeof n&&(n=Math.max(Math.round(e-t)+1,1)),n<2)return 1===n?[t]:[];var r,a=Array(n);for(n--,r=n;r>=0;r--)a[r]=(r*e+(n-r)*t)/n;return a},numeric.getBlock=function(t,e,n){var r=numeric.dim(t);function a(t,i){var o,s=e[i],u=n[i]-s,c=Array(u);if(i===r.length-1){for(o=u;o>=0;o--)c[o]=t[o+s];return c}for(o=u;o>=0;o--)c[o]=a(t[o+s],i+1);return c}return a(t,0)},numeric.setBlock=function(t,e,n,r){var a=numeric.dim(t);function i(t,r,o){var s,u=e[o],c=n[o]-u;if(o===a.length-1)for(s=c;s>=0;s--)t[s+u]=r[s];for(s=c;s>=0;s--)i(t[s+u],r[s],o+1)}return i(t,r,0),t},numeric.getRange=function(t,e,n){var r,a,i,o,s=e.length,u=n.length,c=Array(s);for(r=s-1;-1!==r;--r)for(c[r]=Array(u),i=c[r],o=t[e[r]],a=u-1;-1!==a;--a)i[a]=o[n[a]];return c},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var n,r,a,i,o,s=e[0],u=e[1];for(n=0,r=0,a=0;a<s;++a)n+=t[a][0].length;for(i=0;i<u;++i)r+=t[0][i][0].length;var c=Array(n);for(a=0;a<n;++a)c[a]=Array(r);var l,d,h,p,f,m=0;for(a=0;a<s;++a){for(l=r,i=u-1;-1!==i;--i)for(o=t[a][i],l-=o[0].length,h=o.length-1;-1!==h;--h)for(f=o[h],d=c[m+h],p=f.length-1;-1!==p;--p)d[l+p]=f[p];m+=t[a][0].length}return c},numeric.tensor=function(t,e){if("number"===typeof t||"number"===typeof e)return numeric.mul(t,e);var n=numeric.dim(t),r=numeric.dim(e);if(1!==n.length||1!==r.length)throw new Error("numeric: tensor product is only defined for vectors");var a,i,o,s,u=n[0],c=r[0],l=Array(u);for(i=u-1;i>=0;i--){for(a=Array(c),s=t[i],o=c-1;o>=3;--o)a[o]=s*e[o],--o,a[o]=s*e[o],--o,a[o]=s*e[o],--o,a[o]=s*e[o];while(o>=0)a[o]=s*e[o],--o;l[i]=a}return l},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,n,r,a){var i;numeric.indexOf;if("string"!==typeof a)for(i in a="",numeric)numeric.hasOwnProperty(i)&&(t.indexOf(i)>=0||e.indexOf(i)>=0||n.indexOf(i)>=0||r.indexOf(i)>=0)&&i.length>1&&(a+="var "+i+" = numeric."+i+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+a+"\nif(x.y) {  if(y.y) {    return new numeric.T("+r+");\n  }\n  return new numeric.T("+n+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var n=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,n),e(numeric.neg(this.y),n))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),t(n)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,n=this.y;return n?new numeric.T(t(e),numeric.negtranspose(n)):new numeric.T(t(e))},numeric.Tunop=function(t,e,n){return"string"!==typeof n&&(n=""),Function("var x = this;\n"+n+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if("undefined"===typeof t.y)return new numeric.T(numeric.inv(t.x));var e,n,r,a,i,o,s,u,c,l,d,h,p,f,m,g,b,y,v=t.x.length,x=numeric.identity(v),w=numeric.rep([v,v],0),k=numeric.clone(t.x),S=numeric.clone(t.y);for(c=0;c<v;c++){for(f=k[c][c],m=S[c][c],h=f*f+m*m,d=c,l=c+1;l<v;l++)f=k[l][c],m=S[l][c],p=f*f+m*m,p>h&&(d=l,h=p);for(d!==c&&(y=k[c],k[c]=k[d],k[d]=y,y=S[c],S[c]=S[d],S[d]=y,y=x[c],x[c]=x[d],x[d]=y,y=w[c],w[c]=w[d],w[d]=y),e=k[c],n=S[c],i=x[c],o=w[c],f=e[c],m=n[c],l=c+1;l<v;l++)g=e[l],b=n[l],e[l]=(g*f+b*m)/h,n[l]=(b*f-g*m)/h;for(l=0;l<v;l++)g=i[l],b=o[l],i[l]=(g*f+b*m)/h,o[l]=(b*f-g*m)/h;for(l=c+1;l<v;l++){for(r=k[l],a=S[l],s=x[l],u=w[l],f=r[c],m=a[c],d=c+1;d<v;d++)g=e[d],b=n[d],r[d]-=g*f-b*m,a[d]-=b*f+g*m;for(d=0;d<v;d++)g=i[d],b=o[d],s[d]-=g*f-b*m,u[d]-=b*f+g*m}}for(c=v-1;c>0;c--)for(i=x[c],o=w[c],l=c-1;l>=0;l--)for(s=x[l],u=w[l],f=k[l][c],m=S[l][c],d=v-1;d>=0;d--)g=i[d],b=o[d],s[d]-=f*g-m*b,u[d]-=f*b+m*g;return new numeric.T(x,w)},numeric.T.prototype.get=function(t){var e,n=this.x,r=this.y,a=0,i=t.length;if(r){while(a<i)e=t[a],n=n[e],r=r[e],a++;return new numeric.T(n,r)}while(a<i)e=t[a],n=n[e],a++;return new numeric.T(n)},numeric.T.prototype.set=function(t,e){var n,r=this.x,a=this.y,i=0,o=t.length,s=e.x,u=e.y;if(0===o)return u?this.y=u:a&&(this.y=void 0),this.x=r,this;if(u){a||(a=numeric.rep(numeric.dim(r),0),this.y=a);while(i<o-1)n=t[i],r=r[n],a=a[n],i++;return n=t[i],r[n]=s,a[n]=u,this}if(a){while(i<o-1)n=t[i],r=r[n],a=a[n],i++;return n=t[i],r[n]=s,a[n]=s instanceof Array?numeric.rep(numeric.dim(s),0):0,this}while(i<o-1)n=t[i],r=r[n],i++;return n=t[i],r[n]=s,this},numeric.T.prototype.getRows=function(t,e){var n,r,a=e-t+1,i=Array(a),o=this.x,s=this.y;for(n=t;n<=e;n++)i[n-t]=o[n];if(s){for(r=Array(a),n=t;n<=e;n++)r[n-t]=s[n];return new numeric.T(i,r)}return new numeric.T(i)},numeric.T.prototype.setRows=function(t,e,n){var r,a=this.x,i=this.y,o=n.x,s=n.y;for(r=t;r<=e;r++)a[r]=o[r-t];if(s)for(i||(i=numeric.rep(numeric.dim(a),0),this.y=i),r=t;r<=e;r++)i[r]=s[r-t];else if(i)for(r=t;r<=e;r++)i[r]=numeric.rep([o[r-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,n=this.y;return n?new numeric.T(e[t],n[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var n=this.x,r=this.y,a=e.x,i=e.y;return n[t]=a,i?(r||(r=numeric.rep(numeric.dim(n),0),this.y=r),r[t]=i):r&&(r=numeric.rep([a.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var n=this.x,r=this.y,a=numeric.getBlock;return r?new numeric.T(a(n,t,e),a(r,t,e)):new numeric.T(a(n,t,e))},numeric.T.prototype.setBlock=function(t,e,n){n instanceof numeric.T||(n=new numeric.T(n));var r=this.x,a=this.y,i=numeric.setBlock,o=n.x,s=n.y;if(s)return a||(this.y=numeric.rep(numeric.dim(this),0),a=this.y),i(r,t,e,o),i(a,t,e,s),this;i(r,t,e,o),a&&i(a,t,e,numeric.rep(numeric.dim(o),0))},numeric.T.rep=function(t,e){var n=numeric.T;e instanceof n||(e=new n(e));var r=e.x,a=e.y,i=numeric.rep;return a?new n(i(t,r),i(t,a)):new n(i(t,r))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,n=t.y,r=numeric.diag;return n?new numeric.T(r(e),r(n)):new numeric.T(r(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,n=this.y;return n?new t.T(t.getDiag(e),t.getDiag(n)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),n=t[0]>=0?1:-1,r=n*numeric.norm2(t);e[0]+=r;var a=numeric.norm2(e);if(0===a)throw new Error("eig: internal error");return numeric.div(e,a)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var n,r,a,i,o,s,u,c,l,d,h=e[0],p=numeric.clone(t),f=numeric.identity(h);for(r=0;r<h-2;r++){for(i=Array(h-r-1),n=r+1;n<h;n++)i[n-r-1]=p[n][r];if(numeric.norm2(i)>0){for(o=numeric.house(i),s=numeric.getBlock(p,[r+1,r],[h-1,h-1]),u=numeric.tensor(o,numeric.dot(o,s)),n=r+1;n<h;n++)for(c=p[n],l=u[n-r-1],a=r;a<h;a++)c[a]-=2*l[a-r];for(s=numeric.getBlock(p,[0,r+1],[h-1,h-1]),u=numeric.tensor(numeric.dot(s,o),o),n=0;n<h;n++)for(c=p[n],l=u[n],a=r+1;a<h;a++)c[a]-=2*l[a-r-1];for(s=Array(h-r-1),n=r+1;n<h;n++)s[n-r-1]=f[n];for(u=numeric.tensor(o,numeric.dot(o,s)),n=r+1;n<h;n++)for(d=f[n],l=u[n-r-1],a=0;a<h;a++)d[a]-=2*l[a]}}return{H:p,Q:f}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){"undefined"===typeof e&&(e=1e4),t=numeric.clone(t);numeric.clone(t);var n,r,a,i,o,s,u,c,l,d,h,p,f,m,g,b,y,v,x=numeric.dim(t),w=x[0],k=numeric.identity(w);if(w<3)return{Q:k,B:[[0,w-1]]};var S=numeric.epsilon;for(v=0;v<e;v++){for(b=0;b<w-1;b++)if(Math.abs(t[b+1][b])<S*(Math.abs(t[b][b])+Math.abs(t[b+1][b+1]))){var O=numeric.QRFrancis(numeric.getBlock(t,[0,0],[b,b]),e),_=numeric.QRFrancis(numeric.getBlock(t,[b+1,b+1],[w-1,w-1]),e);for(p=Array(b+1),g=0;g<=b;g++)p[g]=k[g];for(f=numeric.dot(O.Q,p),g=0;g<=b;g++)k[g]=f[g];for(p=Array(w-b-1),g=b+1;g<w;g++)p[g-b-1]=k[g];for(f=numeric.dot(_.Q,p),g=b+1;g<w;g++)k[g]=f[g-b-1];return{Q:k,B:O.B.concat(numeric.add(_.B,b+1))}}var C,T,I;if(a=t[w-2][w-2],i=t[w-2][w-1],o=t[w-1][w-2],s=t[w-1][w-1],c=a+s,u=a*s-i*o,l=numeric.getBlock(t,[0,0],[2,2]),c*c>=4*u)C=.5*(c+Math.sqrt(c*c-4*u)),T=.5*(c-Math.sqrt(c*c-4*u)),l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,C+T)),numeric.diag(numeric.rep([3],C*T)));else l=numeric.add(numeric.sub(numeric.dot(l,l),numeric.mul(l,c)),numeric.diag(numeric.rep([3],u)));for(n=[l[0][0],l[1][0],l[2][0]],r=numeric.house(n),p=[t[0],t[1],t[2]],f=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(h=t[g],m=f[g],y=0;y<w;y++)h[y]-=2*m[y];for(p=numeric.getBlock(t,[0,0],[w-1,2]),f=numeric.tensor(numeric.dot(p,r),r),g=0;g<w;g++)for(h=t[g],m=f[g],y=0;y<3;y++)h[y]-=2*m[y];for(p=[k[0],k[1],k[2]],f=numeric.tensor(r,numeric.dot(r,p)),g=0;g<3;g++)for(d=k[g],m=f[g],y=0;y<w;y++)d[y]-=2*m[y];for(b=0;b<w-2;b++){for(y=b;y<=b+1;y++)if(Math.abs(t[y+1][y])<S*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){O=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),_=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[w-1,w-1]),e);for(p=Array(y+1),g=0;g<=y;g++)p[g]=k[g];for(f=numeric.dot(O.Q,p),g=0;g<=y;g++)k[g]=f[g];for(p=Array(w-y-1),g=y+1;g<w;g++)p[g-y-1]=k[g];for(f=numeric.dot(_.Q,p),g=y+1;g<w;g++)k[g]=f[g-y-1];return{Q:k,B:O.B.concat(numeric.add(_.B,y+1))}}for(I=Math.min(w-1,b+3),n=Array(I-b),g=b+1;g<=I;g++)n[g-b-1]=t[g][b];for(r=numeric.house(n),p=numeric.getBlock(t,[b+1,b],[I,w-1]),f=numeric.tensor(r,numeric.dot(r,p)),g=b+1;g<=I;g++)for(h=t[g],m=f[g-b-1],y=b;y<w;y++)h[y]-=2*m[y-b];for(p=numeric.getBlock(t,[0,b+1],[w-1,I]),f=numeric.tensor(numeric.dot(p,r),r),g=0;g<w;g++)for(h=t[g],m=f[g],y=b+1;y<=I;y++)h[y]-=2*m[y-b-1];for(p=Array(I-b),g=b+1;g<=I;g++)p[g-b-1]=k[g];for(f=numeric.tensor(r,numeric.dot(r,p)),g=b+1;g<=I;g++)for(d=k[g],m=f[g-b-1],y=0;y<w;y++)d[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var n,r,a,i,o,s,u,c,l,d,h,p,f,m,g,b,y,v=numeric.toUpperHessenberg(t),x=numeric.QRFrancis(v.H,e),w=numeric.T,k=t.length,S=x.B,O=numeric.dot(x.Q,numeric.dot(v.H,numeric.transpose(x.Q))),_=new w(numeric.dot(x.Q,v.Q)),C=S.length,T=Math.sqrt;for(r=0;r<C;r++)if(n=S[r][0],n===S[r][1]);else{if(i=n+1,o=O[n][n],s=O[n][i],u=O[i][n],c=O[i][i],0===s&&0===u)continue;l=-o-c,d=o*c-s*u,h=l*l-4*d,h>=0?(p=l<0?-.5*(l-T(h)):-.5*(l+T(h)),b=(o-p)*(o-p)+s*s,y=u*u+(c-p)*(c-p),b>y?(b=T(b),m=(o-p)/b,g=s/b):(y=T(y),m=u/y,g=(c-p)/y),a=new w([[g,-m],[m,g]]),_.setRows(n,i,a.dot(_.getRows(n,i)))):(p=-.5*l,f=.5*T(-h),b=(o-p)*(o-p)+s*s,y=u*u+(c-p)*(c-p),b>y?(b=T(b+f*f),m=(o-p)/b,g=s/b,p=0,f/=b):(y=T(y+f*f),m=u/y,g=(c-p)/y,p=f/y,f=0),a=new w([[g,-m],[m,g]],[[p,f],[f,-p]]),_.setRows(n,i,a.dot(_.getRows(n,i))))}var I=_.dot(t).dot(_.transjugate()),N=(k=t.length,numeric.T.identity(k));for(i=0;i<k;i++)if(i>0)for(r=i-1;r>=0;r--){var E=I.get([r,r]),A=I.get([i,i]);numeric.neq(E.x,A.x)||numeric.neq(E.y,A.y)?(p=I.getRow(r).getBlock([r],[i-1]),f=N.getRow(i).getBlock([r],[i-1]),N.set([i,r],I.get([r,i]).neg().sub(p.dot(f)).div(E.sub(A)))):N.setRow(i,N.getRow(r))}for(i=0;i<k;i++)p=N.getRow(i),N.setRow(i,p.div(p.norm2()));return N=N.transpose(),N=_.transjugate().dot(N),{lambda:I.getDiag(),E:N}},numeric.ccsSparse=function(t){var e,n,r,a=t.length,i=[];for(n=a-1;-1!==n;--n)for(r in e=t[n],e){r=parseInt(r);while(r>=i.length)i[i.length]=0;0!==e[r]&&i[r]++}var o=i.length,s=Array(o+1);for(s[0]=0,n=0;n<o;++n)s[n+1]=s[n]+i[n];var u=Array(s[o]),c=Array(s[o]);for(n=a-1;-1!==n;--n)for(r in e=t[n],e)0!==e[r]&&(i[r]--,u[s[r]+i[r]]=n,c[s[r]+i[r]]=e[r]);return[s,u,c]},numeric.ccsFull=function(t){var e,n,r,a,i=t[0],o=t[1],s=t[2],u=numeric.ccsDim(t),c=u[0],l=u[1],d=numeric.rep([c,l],0);for(e=0;e<l;e++)for(r=i[e],a=i[e+1],n=r;n<a;++n)d[o[n]][e]=s[n];return d},numeric.ccsTSolve=function(t,e,n,r,a){var i,o,s,u,c,l,d,h=t[0],p=t[1],f=t[2],m=h.length-1,g=Math.max,b=0;function y(t){var e;if(0===n[t]){for(n[t]=1,e=h[t];e<h[t+1];++e)y(p[e]);a[b]=t,++b}}for("undefined"===typeof r&&(n=numeric.rep([m],0)),"undefined"===typeof r&&(r=numeric.linspace(0,n.length-1)),"undefined"===typeof a&&(a=[]),i=r.length-1;-1!==i;--i)y(r[i]);for(a.length=b,i=a.length-1;-1!==i;--i)n[a[i]]=0;for(i=r.length-1;-1!==i;--i)o=r[i],n[o]=e[o];for(i=a.length-1;-1!==i;--i){for(o=a[i],s=h[o],u=g(h[o+1],s),c=s;c!==u;++c)if(p[c]===o){n[o]/=f[c];break}for(d=n[o],c=s;c!==u;++c)l=p[c],l!==o&&(n[l]-=d*f[c])}return n},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,n,r,a,i){var o,s,u,c=0,l=a.length,d=this.k,h=this.k1,p=this.j;if(0===r[t]){r[t]=1,p[0]=t,d[0]=s=e[t],h[0]=u=e[t+1];while(1)if(s>=u){if(a[l]=p[c],0===c)return;++l,--c,s=d[c],u=h[c]}else o=i[n[s]],0===r[o]?(r[o]=1,d[c]=s,++c,p[c]=o,s=e[o],h[c]=u=e[o+1]):++s}},numeric.ccsLPSolve=function(t,e,n,r,a,i,o){var s,u,c,l,d,h,p,f,m,g=t[0],b=t[1],y=t[2],v=(g.length,e[0]),x=e[1],w=e[2];for(u=v[a],c=v[a+1],r.length=0,s=u;s<c;++s)o.dfs(i[x[s]],g,b,n,r,i);for(s=r.length-1;-1!==s;--s)n[r[s]]=0;for(s=u;s!==c;++s)l=i[x[s]],n[l]=w[s];for(s=r.length-1;-1!==s;--s){for(l=r[s],d=g[l],h=g[l+1],p=d;p<h;++p)if(i[b[p]]===l){n[l]/=y[p];break}for(m=n[l],p=d;p<h;++p)f=i[b[p]],f!==l&&(n[f]-=m*y[p])}return n},numeric.ccsLUP1=function(t,e){var n,r,a,i,o,s,u,c=t[0].length-1,l=[numeric.rep([c+1],0),[],[]],d=[numeric.rep([c+1],0),[],[]],h=l[0],p=l[1],f=l[2],m=d[0],g=d[1],b=d[2],y=numeric.rep([c],0),v=numeric.rep([c],0),x=numeric.ccsLPSolve,w=(Math.max,Math.abs),k=numeric.linspace(0,c-1),S=numeric.linspace(0,c-1),O=new numeric.ccsDFS(c);for("undefined"===typeof e&&(e=1),n=0;n<c;++n){for(x(l,t,y,v,n,S,O),i=-1,o=-1,r=v.length-1;-1!==r;--r)a=v[r],a<=n||(s=w(y[a]),s>i&&(o=a,i=s));for(w(y[n])<e*i&&(r=k[n],i=k[o],k[n]=i,S[i]=n,k[o]=r,S[r]=o,i=y[n],y[n]=y[o],y[o]=i),i=h[n],o=m[n],u=y[n],p[i]=k[n],f[i]=1,++i,r=v.length-1;-1!==r;--r)a=v[r],s=y[a],v[r]=0,y[a]=0,a<=n?(g[o]=a,b[o]=s,++o):(p[i]=k[a],f[i]=s/u,++i);h[n+1]=i,m[n+1]=o}for(r=p.length-1;-1!==r;--r)p[r]=S[p[r]];return{L:l,U:d,P:k,Pinv:S}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,n,r,a,i,o){var s,u,c,l=0,d=a.length,h=this.k,p=this.k1,f=this.j;if(0===r[t]){r[t]=1,f[0]=t,h[0]=u=e[i[t]],p[0]=c=e[i[t]+1];while(1){if(isNaN(u))throw new Error("Ow!");if(u>=c){if(a[d]=i[f[l]],0===l)return;++d,--l,u=h[l],c=p[l]}else s=n[u],0===r[s]?(r[s]=1,h[l]=u,++l,f[l]=s,s=i[s],u=e[s],p[l]=c=e[s+1]):++u}}},numeric.ccsLPSolve0=function(t,e,n,r,a,i,o,s){var u,c,l,d,h,p,f,m,g,b=t[0],y=t[1],v=t[2],x=(b.length,e[0]),w=e[1],k=e[2];for(c=x[a],l=x[a+1],r.length=0,u=c;u<l;++u)s.dfs(w[u],b,y,n,r,i,o);for(u=r.length-1;-1!==u;--u)d=r[u],n[o[d]]=0;for(u=c;u!==l;++u)d=w[u],n[d]=k[u];for(u=r.length-1;-1!==u;--u){for(d=r[u],m=o[d],h=b[d],p=b[d+1],f=h;f<p;++f)if(y[f]===m){n[m]/=v[f];break}for(g=n[m],f=h;f<p;++f)n[y[f]]-=g*v[f];n[m]=g}},numeric.ccsLUP0=function(t,e){var n,r,a,i,o,s,u,c=t[0].length-1,l=[numeric.rep([c+1],0),[],[]],d=[numeric.rep([c+1],0),[],[]],h=l[0],p=l[1],f=l[2],m=d[0],g=d[1],b=d[2],y=numeric.rep([c],0),v=numeric.rep([c],0),x=numeric.ccsLPSolve0,w=(Math.max,Math.abs),k=numeric.linspace(0,c-1),S=numeric.linspace(0,c-1),O=new numeric.ccsDFS0(c);for("undefined"===typeof e&&(e=1),n=0;n<c;++n){for(x(l,t,y,v,n,S,k,O),i=-1,o=-1,r=v.length-1;-1!==r;--r)a=v[r],a<=n||(s=w(y[k[a]]),s>i&&(o=a,i=s));for(w(y[k[n]])<e*i&&(r=k[n],i=k[o],k[n]=i,S[i]=n,k[o]=r,S[r]=o),i=h[n],o=m[n],u=y[k[n]],p[i]=k[n],f[i]=1,++i,r=v.length-1;-1!==r;--r)a=v[r],s=y[k[a]],v[r]=0,y[k[a]]=0,a<=n?(g[o]=a,b[o]=s,++o):(p[i]=k[a],f[i]=s/u,++i);h[n+1]=i,m[n+1]=o}for(r=p.length-1;-1!==r;--r)p[r]=S[p[r]];return{L:l,U:d,P:k,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,n){var r=numeric.ccsDim(t),a=r[0],i=r[1];"undefined"===typeof e?e=numeric.linspace(0,a-1):"number"===typeof e&&(e=[e]),"undefined"===typeof n?n=numeric.linspace(0,i-1):"number"===typeof n&&(n=[n]);var o,s,u,c,l,d=e.length,h=n.length,p=numeric.rep([i],0),f=[],m=[],g=[p,f,m],b=t[0],y=t[1],v=t[2],x=numeric.rep([a],0),w=0,k=numeric.rep([a],0);for(s=0;s<h;++s){c=n[s];var S=b[c],O=b[c+1];for(o=S;o<O;++o)u=y[o],k[u]=1,x[u]=v[o];for(o=0;o<d;++o)l=e[o],k[l]&&(f[w]=o,m[w]=x[e[o]],++w);for(o=S;o<O;++o)u=y[o],k[u]=0;p[s+1]=w}return g},numeric.ccsDot=function(t,e){var n,r,a,i,o,s,u,c,l,d,h,p=t[0],f=t[1],m=t[2],g=e[0],b=e[1],y=e[2],v=numeric.ccsDim(t),x=numeric.ccsDim(e),w=v[0],k=(v[1],x[1]),S=numeric.rep([w],0),O=numeric.rep([w],0),_=Array(w),C=numeric.rep([k],0),T=[],I=[],N=[C,T,I];for(a=0;a!==k;++a){for(i=g[a],o=g[a+1],l=0,r=i;r<o;++r)for(d=b[r],h=y[r],s=p[d],u=p[d+1],n=s;n<u;++n)c=f[n],0===O[c]&&(_[l]=c,O[c]=1,l+=1),S[c]=S[c]+m[n]*h;for(i=C[a],o=i+l,C[a+1]=o,r=l-1;-1!==r;--r)h=i+r,n=_[r],T[h]=n,I[h]=S[n],O[n]=0,S[n]=0;C[a+1]=C[a]+l}return N},numeric.ccsLUPSolve=function(t,e){var n=t.L,r=t.U,a=(t.P,e[0]),i=!1;"object"!==typeof a&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],a=e[0],i=!0);var o,s,u,c,l,d,h=e[1],p=e[2],f=n[0].length-1,m=a.length-1,g=numeric.rep([f],0),b=Array(f),y=numeric.rep([f],0),v=Array(f),x=numeric.rep([m+1],0),w=[],k=[],S=numeric.ccsTSolve,O=0;for(o=0;o<m;++o){for(l=0,u=a[o],c=a[o+1],s=u;s<c;++s)d=t.Pinv[h[s]],v[l]=d,y[d]=p[s],++l;for(v.length=l,S(n,y,g,v,b),s=v.length-1;-1!==s;--s)y[v[s]]=0;if(S(r,g,y,b,v),i)return y;for(s=b.length-1;-1!==s;--s)g[b[s]]=0;for(s=v.length-1;-1!==s;--s)d=v[s],w[O]=d,k[O]=y[d],y[d]=0,++O;x[o+1]=O}return[x,w,k]},numeric.ccsbinop=function(t,e){return"undefined"===typeof e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,n=t[0],r=t[1],a=t[2],i=numeric.sup(r)+1,o=n.length,s=numeric.rep([i],0),u=Array(o),c=Array(o),l=numeric.rep([i],0);for(e=0;e<o;++e)l[r[e]]++;for(e=0;e<i;++e)s[e+1]=s[e]+l[e];var d,h,p=s.slice(0);for(e=0;e<o;++e)h=r[e],d=p[h],u[d]=n[e],c[d]=a[e],p[h]=p[h]+1;return[s,u,c]},numeric.ccsGather=function(t){var e,n,r,a,i,o=t[0],s=t[1],u=t[2],c=o.length-1,l=s.length,d=Array(l),h=Array(l),p=Array(l);for(i=0,e=0;e<c;++e)for(r=o[e],a=o[e+1],n=r;n!==a;++n)h[i]=e,d[i]=s[n],p[i]=u[n],++i;return[d,h,p]},numeric.sdim=function t(e,n,r){if("undefined"===typeof n&&(n=[]),"object"!==typeof e)return n;var a;for(a in"undefined"===typeof r&&(r=0),r in n||(n[r]=0),e.length>n[r]&&(n[r]=e.length),e)e.hasOwnProperty(a)&&t(e[a],n,r+1);return n},numeric.sclone=function t(e,n,r){"undefined"===typeof n&&(n=0),"undefined"===typeof r&&(r=numeric.sdim(e).length);var a,i=Array(e.length);if(n===r-1){for(a in e)e.hasOwnProperty(a)&&(i[a]=e[a]);return i}for(a in e)e.hasOwnProperty(a)&&(i[a]=t(e[a],n+1,r));return i},numeric.sdiag=function(t){var e,n,r=t.length,a=Array(r);for(e=r-1;e>=1;e-=2)n=e-1,a[e]=[],a[e][e]=t[e],a[n]=[],a[n][n]=t[n];return 0===e&&(a[0]=[],a[0][0]=t[e]),a},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,n,r,a=[];t.length;for(e in t)if(t.hasOwnProperty(e))for(n in r=t[e],r)r.hasOwnProperty(n)&&("object"!==typeof a[n]&&(a[n]=[]),a[n][e]=r[n]);return a},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var n,r,a,i,o,s,u,c=t.length,l=(e.length,numeric.stranspose(e)),d=l.length,h=Array(c);for(a=c-1;a>=0;a--){for(u=[],n=t[a],o=d-1;o>=0;o--){for(i in s=0,r=l[o],n)n.hasOwnProperty(i)&&i in r&&(s+=n[i]*r[i]);s&&(u[o]=s)}h[a]=u}return h},numeric.sdotMV=function(t,e){var n,r,a,i,o=t.length,s=Array(o);for(r=o-1;r>=0;r--){for(a in n=t[r],i=0,n)n.hasOwnProperty(a)&&e[a]&&(i+=n[a]*e[a]);i&&(s[r]=i)}return s},numeric.sdotVM=function(t,e){var n,r,a,i,o=[];for(n in t)if(t.hasOwnProperty(n))for(r in a=e[n],i=t[n],a)a.hasOwnProperty(r)&&(o[r]||(o[r]=0),o[r]+=i*a[r]);return o},numeric.sdotVV=function(t,e){var n,r=0;for(n in t)t[n]&&e[n]&&(r+=t[n]*e[n]);return r},numeric.sdot=function(t,e){var n=numeric.sdim(t).length,r=numeric.sdim(e).length,a=1e3*n+r;switch(a){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+n+" and "+r)}},numeric.sscatter=function(t){var e,n,r,a,i=t[0].length,o=t.length,s=[];for(n=i-1;n>=0;--n)if(t[o-1][n]){for(a=s,r=0;r<o-2;r++)e=t[r][n],a[e]||(a[e]=[]),a=a[e];a[t[r][n]]=t[r+1][n]}return s},numeric.sgather=function t(e,n,r){var a,i,o;for(i in"undefined"===typeof n&&(n=[]),"undefined"===typeof r&&(r=[]),a=r.length,e)if(e.hasOwnProperty(i))if(r[a]=parseInt(i),o=e[i],"number"===typeof o){if(o){if(0===n.length)for(i=a+1;i>=0;--i)n[i]=[];for(i=a;i>=0;--i)n[i].push(r[i]);n[a+1].push(o)}}else t(o,n,r);return r.length>a&&r.pop(),n},numeric.cLU=function(t){var e,n,r,a,i,o,s=t[0],u=t[1],c=t[2],l=s.length,d=0;for(e=0;e<l;e++)s[e]>d&&(d=s[e]);d++;var h,p=Array(d),f=Array(d),m=numeric.rep([d],1/0),g=numeric.rep([d],-1/0);for(r=0;r<l;r++)e=s[r],n=u[r],n<m[e]&&(m[e]=n),n>g[e]&&(g[e]=n);for(e=0;e<d-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=d-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<d;e++)f[e]=numeric.rep([g[e]-m[e]+1],0),p[e]=numeric.rep([e-m[e]],0),e-m[e]+1,g[e]-e+1;for(r=0;r<l;r++)e=s[r],f[e][u[r]-m[e]]=c[r];for(e=0;e<d-1;e++)for(a=e-m[e],v=f[e],n=e+1;m[n]<=e&&n<d;n++)if(i=e-m[n],o=g[e]-e,x=f[n],h=x[i]/v[a],h){for(r=1;r<=o;r++)x[r+i]-=h*v[r+a];p[n][e-m[n]]=h}var b,y,v=[],x=[],w=[],k=[],S=[],O=[];for(l=0,b=0,e=0;e<d;e++){for(a=m[e],i=g[e],y=f[e],n=e;n<=i;n++)y[n-a]&&(v[l]=e,x[l]=n,w[l]=y[n-a],l++);for(y=p[e],n=a;n<e;n++)y[n-a]&&(k[b]=e,S[b]=n,O[b]=y[n-a],b++);k[b]=e,S[b]=e,O[b]=1,b++}return{U:[v,x,w],L:[k,S,O]}},numeric.cLUsolve=function(t,e){var n,r,a=t.L,i=t.U,o=numeric.clone(e),s=a[0],u=a[1],c=a[2],l=i[0],d=i[1],h=i[2],p=l.length,f=(s.length,o.length);for(r=0,n=0;n<f;n++){while(u[r]<n)o[n]-=c[r]*o[u[r]],r++;r++}for(r=p-1,n=f-1;n>=0;n--){while(d[r]>n)o[n]-=h[r]*o[d[r]],r--;o[n]/=h[r],r--}return o},numeric.cgrid=function(t,e){"number"===typeof t&&(t=[t,t]);var n,r,a,i=numeric.rep(t,-1);if("function"!==typeof e)switch(e){case"L":e=function(e,n){return e>=t[0]/2||n<t[1]/2};break;default:e=function(t,e){return!0};break}for(a=0,n=1;n<t[0]-1;n++)for(r=1;r<t[1]-1;r++)e(n,r)&&(i[n][r]=a,a++);return i},numeric.cdelsq=function(t){var e,n,r,a,i,o=[[-1,0],[0,-1],[0,1],[1,0]],s=numeric.dim(t),u=s[0],c=s[1],l=[],d=[],h=[];for(e=1;e<u-1;e++)for(n=1;n<c-1;n++)if(!(t[e][n]<0)){for(r=0;r<4;r++)a=e+o[r][0],i=n+o[r][1],t[a][i]<0||(l.push(t[e][n]),d.push(t[a][i]),h.push(-1));l.push(t[e][n]),d.push(t[e][n]),h.push(4)}return[l,d,h]},numeric.cdotMV=function(t,e){var n,r,a,i=t[0],o=t[1],s=t[2],u=i.length;for(a=0,r=0;r<u;r++)i[r]>a&&(a=i[r]);for(a++,n=numeric.rep([a],0),r=0;r<u;r++)n[i[r]]+=s[r]*e[o[r]];return n},numeric.Spline=function(t,e,n,r,a){this.x=t,this.yl=e,this.yr=n,this.kl=r,this.kr=a},numeric.Spline.prototype._at=function(t,e){var n,r,a,i=this.x,o=this.yl,s=this.yr,u=this.kl,c=this.kr,l=numeric.add,d=numeric.sub,h=numeric.mul;n=d(h(u[e],i[e+1]-i[e]),d(s[e+1],o[e])),r=l(h(c[e+1],i[e]-i[e+1]),d(s[e+1],o[e])),a=(t-i[e])/(i[e+1]-i[e]);var p=a*(1-a);return l(l(l(h(1-a,o[e]),h(a,s[e+1])),h(n,p*(1-a))),h(r,p*a))},numeric.Spline.prototype.at=function(t){if("number"===typeof t){var e,n,r,a=this.x,i=a.length,o=Math.floor;e=0,n=i-1;while(n-e>1)r=o((e+n)/2),a[r]<=t?e=r:n=r;return this._at(t,e)}i=t.length;var s,u=Array(i);for(s=i-1;-1!==s;--s)u[s]=this.at(t[s]);return u},numeric.Spline.prototype.diff=function(){var t,e,n,r=this.x,a=this.yl,i=this.yr,o=this.kl,s=this.kr,u=a.length,c=o,l=s,d=Array(u),h=Array(u),p=numeric.add,f=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=r[t+1]-r[t],n=g(i[t+1],a[t]),d[t]=m(p(f(n,6),f(o[t],-4*e),f(s[t+1],-2*e)),e*e),h[t+1]=m(p(f(n,-6),f(o[t],2*e),f(s[t+1],4*e)),e*e);return new numeric.Spline(r,c,l,d,h)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],n=this.x,r=this.yl,a=this.yr,i=this.kl,o=this.kr;"number"===typeof r[0]&&(r=[r],a=[a],i=[i],o=[o]);var s,u,c,l,d,h,p,f,m,g,b,y,v,x,w,k,S,O,_,C,T,I,N,E=r.length,A=n.length-1,R=(e=Array(E),Math.sqrt);for(s=0;s!==E;++s){for(l=r[s],d=a[s],h=i[s],p=o[s],f=[],u=0;u!==A;u++){for(u>0&&d[u]*l[u]<0&&f.push(n[u]),k=n[u+1]-n[u],n[u],b=l[u],y=d[u+1],m=h[u]/k,g=p[u+1]/k,w=t(m-g+3*(b-y))+12*g*b,v=g+3*b+2*m-3*y,x=3*(g+m+2*(b-y)),w<=0?(O=v/x,S=O>n[u]&&O<n[u+1]?[n[u],O,n[u+1]]:[n[u],n[u+1]]):(O=(v-R(w))/x,_=(v+R(w))/x,S=[n[u]],O>n[u]&&O<n[u+1]&&S.push(O),_>n[u]&&_<n[u+1]&&S.push(_),S.push(n[u+1])),T=S[0],O=this._at(T,u),c=0;c<S.length-1;c++)if(I=S[c+1],_=this._at(I,u),0!==O)if(0===_||O*_>0)T=I,O=_;else{var j=0;while(1){if(N=(O*I-_*T)/(O-_),N<=T||N>=I)break;if(C=this._at(N,u),C*_>0)I=N,_=C,-1===j&&(O*=.5),j=-1;else{if(!(C*O>0))break;T=N,O=C,1===j&&(_*=.5),j=1}}f.push(N),T=S[c+1],O=this._at(T,u)}else f.push(T),T=I,O=_;0===_&&f.push(I)}e[s]=f}return"number"===typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,n,r){var a,i=t.length,o=[],s=[],u=[],c=numeric.sub,l=numeric.mul,d=numeric.add;for(a=i-2;a>=0;a--)s[a]=t[a+1]-t[a],u[a]=c(e[a+1],e[a]);"string"!==typeof n&&"string"!==typeof r||(n=r="periodic");var h=[[],[],[]];switch(typeof n){case"undefined":o[0]=l(3/(s[0]*s[0]),u[0]),h[0].push(0,0),h[1].push(0,1),h[2].push(2/s[0],1/s[0]);break;case"string":o[0]=d(l(3/(s[i-2]*s[i-2]),u[i-2]),l(3/(s[0]*s[0]),u[0])),h[0].push(0,0,0),h[1].push(i-2,0,1),h[2].push(1/s[i-2],2/s[i-2]+2/s[0],1/s[0]);break;default:o[0]=n,h[0].push(0),h[1].push(0),h[2].push(1);break}for(a=1;a<i-1;a++)o[a]=d(l(3/(s[a-1]*s[a-1]),u[a-1]),l(3/(s[a]*s[a]),u[a])),h[0].push(a,a,a),h[1].push(a-1,a,a+1),h[2].push(1/s[a-1],2/s[a-1]+2/s[a],1/s[a]);switch(typeof r){case"undefined":o[i-1]=l(3/(s[i-2]*s[i-2]),u[i-2]),h[0].push(i-1,i-1),h[1].push(i-2,i-1),h[2].push(1/s[i-2],2/s[i-2]);break;case"string":h[1][h[1].length-1]=0;break;default:o[i-1]=r,h[0].push(i-1),h[1].push(i-1),h[2].push(1);break}o="number"!==typeof o[0]?numeric.transpose(o):[o];var p=Array(o.length);if("string"===typeof n)for(a=p.length-1;-1!==a;--a)p[a]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(h)),o[a]),p[a][i-1]=p[a][0];else for(a=p.length-1;-1!==a;--a)p[a]=numeric.cLUsolve(numeric.cLU(h),o[a]);return p="number"===typeof e[0]?p[0]:numeric.transpose(p),new numeric.Spline(t,e,e,p,p)},numeric.fftpow2=function t(e,n){var r=e.length;if(1!==r){var a,i,o=Math.cos,s=Math.sin,u=Array(r/2),c=Array(r/2),l=Array(r/2),d=Array(r/2);for(i=r/2,a=r-1;-1!==a;--a)--i,l[i]=e[a],d[i]=n[a],--a,u[i]=e[a],c[i]=n[a];t(u,c),t(l,d),i=r/2;var h,p,f,m=-6.283185307179586/r;for(a=r-1;-1!==a;--a)--i,-1===i&&(i=r/2-1),h=m*a,p=o(h),f=s(h),e[a]=u[i]+p*l[i]-f*d[i],n[a]=c[i]+p*d[i]+f*l[i]}},numeric._ifftpow2=function t(e,n){var r=e.length;if(1!==r){var a,i,o=Math.cos,s=Math.sin,u=Array(r/2),c=Array(r/2),l=Array(r/2),d=Array(r/2);for(i=r/2,a=r-1;-1!==a;--a)--i,l[i]=e[a],d[i]=n[a],--a,u[i]=e[a],c[i]=n[a];t(u,c),t(l,d),i=r/2;var h,p,f,m=6.283185307179586/r;for(a=r-1;-1!==a;--a)--i,-1===i&&(i=r/2-1),h=m*a,p=o(h),f=s(h),e[a]=u[i]+p*l[i]-f*d[i],n[a]=c[i]+p*d[i]+f*l[i]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,n,r){numeric.fftpow2(t,e),numeric.fftpow2(n,r);var a,i,o,s,u,c=t.length;for(a=c-1;-1!==a;--a)i=t[a],s=e[a],o=n[a],u=r[a],t[a]=i*o-s*u,e[a]=i*u+s*o;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),d=Math.cos,h=Math.sin,p=-3.141592653589793/a,f=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(a/2);for(t=0;t<a;t++)f[t]=n[t];if("undefined"!==typeof r)for(t=0;t<a;t++)m[t]=r[t];for(c[0]=1,t=1;t<=u/2;t++)e=p*t*t,c[t]=d(e),l[t]=h(e),c[u-t]=d(e),l[u-t]=h(e);var g=new numeric.T(f,m),b=new numeric.T(c,l);return g=g.mul(b),numeric.convpow2(g.x,g.y,numeric.clone(b.x),numeric.neg(b.y)),g=g.mul(b),g.x.length=a,g.y.length=a,g},numeric.T.prototype.ifft=function(){var t,e,n=this.x,r=this.y,a=n.length,i=Math.log,o=i(2),s=Math.ceil(i(2*a-1)/o),u=Math.pow(2,s),c=numeric.rep([u],0),l=numeric.rep([u],0),d=Math.cos,h=Math.sin,p=3.141592653589793/a,f=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(a/2);for(t=0;t<a;t++)f[t]=n[t];if("undefined"!==typeof r)for(t=0;t<a;t++)m[t]=r[t];for(c[0]=1,t=1;t<=u/2;t++)e=p*t*t,c[t]=d(e),l[t]=h(e),c[u-t]=d(e),l[u-t]=h(e);var g=new numeric.T(f,m),b=new numeric.T(c,l);return g=g.mul(b),numeric.convpow2(g.x,g.y,numeric.clone(b.x),numeric.neg(b.y)),g=g.mul(b),g.x.length=a,g.y.length=a,g.div(a)},numeric.gradient=function(t,e){var n=e.length,r=t(e);if(isNaN(r))throw new Error("gradient: f(x) is a NaN!");var a,i,o,s,u,c,l,d,h,p,f=Math.max,m=numeric.clone(e),g=Array(n),b=(numeric.div,numeric.sub,f=Math.max,.001),y=Math.abs,v=Math.min,x=0;for(a=0;a<n;a++){var w=f(1e-6*r,1e-8);while(1){if(++x,x>20)throw new Error("Numerical gradient fails");if(m[a]=e[a]+w,i=t(m),m[a]=e[a]-w,o=t(m),m[a]=e[a],isNaN(i)||isNaN(o))w/=16;else{if(g[a]=(i-o)/(2*w),u=e[a]-w,c=e[a],l=e[a]+w,d=(i-r)/w,h=(r-o)/w,p=f(y(g[a]),y(r),y(i),y(o),y(u),y(c),y(l),1e-8),s=v(f(y(d-g[a]),y(h-g[a]),y(d-h))/p,w/p),!(s>b))break;w/=16}}}return g},numeric.uncmin=function(t,e,n,r,a,i,o){var s=numeric.gradient;"undefined"===typeof o&&(o={}),"undefined"===typeof n&&(n=1e-8),"undefined"===typeof r&&(r=function(e){return s(t,e)}),"undefined"===typeof a&&(a=1e3),e=numeric.clone(e);var u,c,l=e.length,d=t(e);if(isNaN(d))throw new Error("uncmin: f(x0) is a NaN!");var h=Math.max,p=numeric.norm2;n=h(n,numeric.epsilon);var f,m,g,b,y,v,x,w,k,S,O=o.Hinv||numeric.identity(l),_=numeric.dot,C=(numeric.inv,numeric.sub),T=numeric.add,I=numeric.tensor,N=numeric.div,E=numeric.mul,A=numeric.all,R=numeric.isFinite,j=numeric.neg,D=0,F="";m=r(e);while(D<a){if("function"===typeof i&&i(D,e,d,m,O)){F="Callback returned true";break}if(!A(R(m))){F="Gradient has Infinity or NaN";break}if(f=j(_(O,m)),!A(R(f))){F="Search direction has Infinity or NaN";break}if(S=p(f),S<n){F="Newton step smaller than tol";break}k=1,c=_(m,f),y=e;while(D<a){if(k*S<n)break;if(b=E(f,k),y=T(e,b),u=t(y),!(u-d>=.1*k*c||isNaN(u)))break;k*=.5,++D}if(k*S<n){F="Line search step size smaller than tol";break}if(D===a){F="maxit reached during line search";break}g=r(y),v=C(g,m),w=_(v,b),x=_(O,v),O=C(T(O,E((w+_(v,x))/(w*w),I(b,b))),N(T(I(x,b),I(b,x)),w)),e=y,d=u,m=g,++D}return{solution:e,f:d,gradient:m,invHessian:O,iterations:D,message:F}},numeric.Dopri=function(t,e,n,r,a,i,o){this.x=t,this.y=e,this.f=n,this.ymid=r,this.iterations=a,this.events=o,this.message=i},numeric.Dopri.prototype._at=function(t,e){function n(t){return t*t}var r,a,i,o,s,u,c,l,d,h,p=this,f=p.x,m=p.y,g=p.f,b=p.ymid,y=(f.length,Math.floor,.5),v=numeric.add,x=numeric.mul,w=numeric.sub;return r=f[e],a=f[e+1],o=m[e],s=m[e+1],c=a-r,i=r+y*c,u=b[e],l=w(g[e],x(o,1/(r-i)+2/(r-a))),d=w(g[e+1],x(s,1/(a-i)+2/(a-r))),h=[n(t-a)*(t-i)/n(r-a)/(r-i),n(t-r)*n(t-a)/n(r-i)/n(a-i),n(t-r)*(t-i)/n(a-r)/(a-i),(t-r)*n(t-a)*(t-i)/n(r-a)/(r-i),(t-a)*n(t-r)*(t-i)/n(r-a)/(a-i)],v(v(v(v(x(o,h[0]),x(u,h[1])),x(s,h[2])),x(l,h[3])),x(d,h[4]))},numeric.Dopri.prototype.at=function(t){var e,n,r,a=Math.floor;if("number"!==typeof t){var i=t.length,o=Array(i);for(e=i-1;-1!==e;--e)o[e]=this.at(t[e]);return o}var s=this.x;e=0,n=s.length-1;while(n-e>1)r=a(.5*(e+n)),s[r]<=t?e=r:n=r;return this._at(t,e)},numeric.dopri=function(t,e,n,r,a,i,o){"undefined"===typeof a&&(a=1e-6),"undefined"===typeof i&&(i=1e3);var s,u,c,l,d,h,p,f,m,g,b,y,v,x=[t],w=[n],k=[r(t,n)],S=[],O=.2,_=[3/40,9/40],C=[44/45,-56/15,32/9],T=[19372/6561,-25360/2187,64448/6561,-212/729],I=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],N=[35/384,0,500/1113,125/192,-2187/6784,11/84],E=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],A=[.2,.3,.8,8/9,1,1],R=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],j=0,D=(e-t)/10,F=0,M=numeric.add,P=numeric.mul,$=(Math.max,Math.min),L=Math.abs,B=numeric.norminf,z=Math.pow,W=numeric.any,V=numeric.lt,U=numeric.and,G=(numeric.sub,new numeric.Dopri(x,w,k,S,-1,""));"function"===typeof o&&(b=o(t,n));while(t<e&&F<i)if(++F,t+D>e&&(D=e-t),s=r(t+A[0]*D,M(n,P(O*D,k[j]))),u=r(t+A[1]*D,M(M(n,P(_[0]*D,k[j])),P(_[1]*D,s))),c=r(t+A[2]*D,M(M(M(n,P(C[0]*D,k[j])),P(C[1]*D,s)),P(C[2]*D,u))),l=r(t+A[3]*D,M(M(M(M(n,P(T[0]*D,k[j])),P(T[1]*D,s)),P(T[2]*D,u)),P(T[3]*D,c))),d=r(t+A[4]*D,M(M(M(M(M(n,P(I[0]*D,k[j])),P(I[1]*D,s)),P(I[2]*D,u)),P(I[3]*D,c)),P(I[4]*D,l))),m=M(M(M(M(M(n,P(k[j],D*N[0])),P(u,D*N[2])),P(c,D*N[3])),P(l,D*N[4])),P(d,D*N[5])),h=r(t+D,m),p=M(M(M(M(M(P(k[j],D*R[0]),P(u,D*R[2])),P(c,D*R[3])),P(l,D*R[4])),P(d,D*R[5])),P(h,D*R[6])),g="number"===typeof p?L(p):B(p),g>a){if(D=.2*D*z(a/g,.25),t+D===t){G.msg="Step size became too small";break}}else{if(S[j]=M(M(M(M(M(M(n,P(k[j],D*E[0])),P(u,D*E[2])),P(c,D*E[3])),P(l,D*E[4])),P(d,D*E[5])),P(h,D*E[6])),++j,x[j]=t+D,w[j]=m,k[j]=h,"function"===typeof o){var H,q,K=t,X=t+.5*D;if(y=o(X,S[j-1]),v=U(V(b,0),V(0,y)),W(v)||(K=X,X=t+D,b=y,y=o(X,m),v=U(V(b,0),V(0,y))),W(v)){var Y,J,Z=0,Q=1,tt=1;while(1){if("number"===typeof b)q=(tt*y*K-Q*b*X)/(tt*y-Q*b);else for(q=X,f=b.length-1;-1!==f;--f)b[f]<0&&y[f]>0&&(q=$(q,(tt*y[f]*K-Q*b[f]*X)/(tt*y[f]-Q*b[f])));if(q<=K||q>=X)break;H=G._at(q,j-1),J=o(q,H),Y=U(V(b,0),V(0,J)),W(Y)?(X=q,y=J,v=Y,tt=1,-1===Z?Q*=.5:Q=1,Z=-1):(K=q,b=J,Q=1,1===Z?tt*=.5:tt=1,Z=1)}return m=G._at(.5*(t+q),j-1),G.f[j]=r(q,H),G.x[j]=q,G.y[j]=H,G.ymid[j-1]=m,G.events=v,G.iterations=F,G}}t+=D,n=m,b=y,D=$(.8*D*z(a/g,.25),4*D)}return G.iterations=F,G},numeric.LU=function(t,e){e=e||!1;var n,r,a,i,o,s,u,c,l,d=Math.abs,h=t.length,p=h-1,f=new Array(h);for(e||(t=numeric.clone(t)),a=0;a<h;++a){for(u=a,s=t[a],l=d(s[a]),r=a+1;r<h;++r)i=d(t[r][a]),l<i&&(l=i,u=r);for(f[a]=u,u!=a&&(t[a]=t[u],t[u]=s,s=t[a]),o=s[a],n=a+1;n<h;++n)t[n][a]/=o;for(n=a+1;n<h;++n){for(c=t[n],r=a+1;r<p;++r)c[r]-=c[a]*s[r],++r,c[r]-=c[a]*s[r];r===p&&(c[r]-=c[a]*s[r])}}return{LU:t,P:f}},numeric.LUsolve=function(t,e){var n,r,a,i,o,s=t.LU,u=s.length,c=numeric.clone(e),l=t.P;for(n=u-1;-1!==n;--n)c[n]=e[n];for(n=0;n<u;++n)for(a=l[n],l[n]!==n&&(o=c[n],c[n]=c[a],c[a]=o),i=s[n],r=0;r<n;++r)c[n]-=c[r]*i[r];for(n=u-1;n>=0;--n){for(i=s[n],r=n+1;r<u;++r)c[n]-=c[r]*i[r];c[n]/=i[n]}return c},numeric.solve=function(t,e,n){return numeric.LUsolve(numeric.LU(t,n),e)},numeric.echelonize=function(t){var e,n,r,a,i,o,s,u,c=numeric.dim(t),l=c[0],d=c[1],h=numeric.identity(l),p=Array(l),f=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<l;++e){for(r=0,i=t[e],o=h[e],n=1;n<d;++n)f(i[r])<f(i[n])&&(r=n);for(p[e]=r,m(o,i[r]),m(i,i[r]),n=0;n<l;++n)if(n!==e){for(s=t[n],u=s[r],a=d-1;-1!==a;--a)s[a]-=i[a]*u;for(s=h[n],a=l-1;-1!==a;--a)s[a]-=o[a]*u}}return{I:h,A:t,P:p}},numeric.__solveLP=function(t,e,n,r,a,i,o){var s,u,c,l,d=numeric.sum,h=(numeric.log,numeric.mul),p=numeric.sub,f=numeric.dot,m=numeric.div,g=numeric.add,b=t.length,y=n.length,v=!1,x=0,w=1,k=(numeric.transpose(e),numeric.svd,numeric.transpose),S=(numeric.leq,Math.sqrt),O=Math.abs,_=(numeric.muleq,numeric.norminf,numeric.any,Math.min),C=numeric.all,T=numeric.gt,I=Array(b),N=Array(y),E=(numeric.rep([y],1),numeric.solve),A=p(n,f(e,i)),R=f(t,t);for(c=x;c<a;++c){var j,D;for(j=y-1;-1!==j;--j)N[j]=m(e[j],A[j]);var F=k(N);for(j=b-1;-1!==j;--j)I[j]=d(F[j]);w=.25*O(R/f(t,I));var M=100*S(R/f(I,I));for((!isFinite(w)||w>M)&&(w=M),l=g(t,h(w,I)),u=f(F,N),j=b-1;-1!==j;--j)u[j][j]+=1;D=E(u,m(l,w),!0);var P=m(A,f(e,D)),$=1;for(j=y-1;-1!==j;--j)P[j]<0&&($=_($,-.999*P[j]));if(s=p(i,h(D,$)),A=p(n,f(e,s)),!C(T(A,0)))return{solution:i,message:"",iterations:c};if(i=s,w<r)return{solution:s,message:"",iterations:c};if(o){var L=f(t,l),B=f(e,l);for(v=!0,j=y-1;-1!==j;--j)if(L*B[j]<0){v=!1;break}}else v=!(i[b-1]>=0);if(v)return{solution:s,message:"Unbounded",iterations:c}}return{solution:i,message:"maximum iteration count exceeded",iterations:c}},numeric._solveLP=function(t,e,n,r,a){var i=t.length,o=n.length,s=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,c=(numeric.div,numeric.add,numeric.rep([i],0).concat([1])),l=numeric.rep([o,1],-1),d=numeric.blockMatrix([[e,l]]),h=n,p=numeric.rep([i],0).concat(Math.max(0,numeric.sup(numeric.neg(n)))+1),f=numeric.__solveLP(c,d,h,r,a,p,!1),m=numeric.clone(f.solution);m.length=i;var g=numeric.inf(s(n,u(e,m)));if(g<0)return{solution:NaN,message:"Infeasible",iterations:f.iterations};var b=numeric.__solveLP(t,e,n,r,a-f.iterations,m,!0);return b.iterations+=f.iterations,b},numeric.solveLP=function(t,e,n,r,a,i,o){if("undefined"===typeof o&&(o=1e3),"undefined"===typeof i&&(i=numeric.epsilon),"undefined"===typeof r)return numeric._solveLP(t,e,n,i,o);var s,u=r.length,c=r[0].length,l=e.length,d=numeric.echelonize(r),h=numeric.rep([c],0),p=d.P,f=[];for(s=p.length-1;-1!==s;--s)h[p[s]]=1;for(s=c-1;-1!==s;--s)0===h[s]&&f.push(s);var m=numeric.getRange,g=numeric.linspace(0,u-1),b=numeric.linspace(0,l-1),y=m(r,g,f),v=m(e,b,p),x=m(e,b,f),w=numeric.dot,k=numeric.sub,S=w(v,d.I),O=k(x,w(S,y)),_=k(n,w(S,a)),C=Array(p.length),T=Array(f.length);for(s=p.length-1;-1!==s;--s)C[s]=t[p[s]];for(s=f.length-1;-1!==s;--s)T[s]=t[f[s]];var I=k(T,w(C,w(d.I,y))),N=numeric._solveLP(I,O,_,i,o),E=N.solution;if(E!==E)return N;var A=w(d.I,k(a,w(y,E))),R=Array(t.length);for(s=p.length-1;-1!==s;--s)R[p[s]]=A[s];for(s=f.length-1;-1!==s;--s)R[f[s]]=E[s];return{solution:R,message:N.message,iterations:N.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,n,r,a,i=0,o=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],s=t.length,u=0,c={},l=[],d=0,h={},p=0,f=[],m=[],g=[];function b(n){throw new Error("MPStoLP: "+n+"\nLine "+e+": "+t[e]+"\nCurrent state: "+o[i]+"\n")}for(e=0;e<s;++e){r=t[e];var y=r.match(/\S*/g),v=[];for(n=0;n<y.length;++n)""!==y[n]&&v.push(y[n]);if(0!==v.length){for(n=0;n<o.length;++n)if(r.substr(0,o[n].length)===o[n])break;if(n<o.length){if(i=n,1===n&&(a=v[1]),6===n)return{name:a,c:f,A:numeric.transpose(m),b:g,rows:c,vars:h}}else switch(i){case 0:case 1:b("Unexpected line");case 2:switch(v[0]){case"N":0===u?u=v[1]:b("Two or more N rows");break;case"L":c[v[1]]=d,l[d]=1,g[d]=0,++d;break;case"G":c[v[1]]=d,l[d]=-1,g[d]=0,++d;break;case"E":c[v[1]]=d,l[d]=0,g[d]=0,++d;break;default:b("Parse error "+numeric.prettyPrint(v))}break;case 3:h.hasOwnProperty(v[0])||(h[v[0]]=p,f[p]=0,m[p]=numeric.rep([d],0),++p);var x=h[v[0]];for(n=1;n<v.length;n+=2)if(v[n]!==u){var w=c[v[n]];m[x][w]=(l[w]<0?-1:1)*parseFloat(v[n+1])}else f[x]=parseFloat(v[n+1]);break;case 4:for(n=1;n<v.length;n+=2)g[c[v[n]]]=(l[c[v[n]]]<0?-1:1)*parseFloat(v[n+1]);break;case 5:break;case 6:b("Internal error")}}}b("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,n,r,a,i,o){function s(t){var e,r,a=this,i=t.length,o=0,s=a.i=a.j=a.m=0;a.S=[],a.c=[],i||(t=[i++]);while(o<n)a.S[o]=o++;for(o=0;o<n;o++)e=a.S[o],s=l(s+e+t[o%i]),r=a.S[s],a.S[o]=r,a.S[s]=e;a.g=function(t){var e=a.S,r=l(a.i+1),i=e[r],o=l(a.j+i),s=e[o];e[r]=s,e[o]=i;var u=e[l(i+s)];while(--t)r=l(r+1),i=e[r],o=l(o+i),s=e[o],e[r]=s,e[o]=i,u=u*n+e[l(i+s)];return a.i=r,a.j=o,u},a.g(n)}function u(t,e,n,r,a){if(n=[],a=typeof t,e&&"object"==a)for(r in t)if(r.indexOf("S")<5)try{n.push(u(t[r],e-1))}catch(i){}return n.length?n:t+("string"!=a?"\0":"")}function c(t,e,n,r){for(t+="",n=0,r=0;r<t.length;r++)e[l(r)]=l((n^=19*e[l(r)])+t.charCodeAt(r));for(r in t="",e)t+=String.fromCharCode(e[r]);return t}function l(t){return t&n-1}e["seedrandom"]=function(l,d){var h,p=[];return l=c(u(d?[l,t]:arguments.length?l:[(new Date).getTime(),t,window],3),p),h=new s(p),c(h.S,t),e["random"]=function(){var t=h.g(r),e=o,s=0;while(t<a)t=(t+s)*n,e*=n,s=h.g(1);while(t>=i)t/=2,e/=2,s>>>=1;return(t+s)/e},l},o=e.pow(n,r),a=e.pow(2,a),i=2*a,c(e.random(),t)}([],numeric.seedrandom,256,6,52),function(t){function e(t){if("object"!==typeof t)return t;var n,r=[],a=t.length;for(n=0;n<a;n++)r[n+1]=e(t[n]);return r}function n(t){if("object"!==typeof t)return t;var e,r=[],a=t.length;for(e=1;e<a;e++)r[e-1]=n(t[e]);return r}function r(t,e,n){var r,a,i,o,s;for(i=1;i<=n;i+=1){for(t[i][i]=1/t[i][i],s=-t[i][i],r=1;r<i;r+=1)t[r][i]=s*t[r][i];if(o=i+1,n<o)break;for(a=o;a<=n;a+=1)for(s=t[i][a],t[i][a]=0,r=1;r<=i;r+=1)t[r][a]=t[r][a]+s*t[r][i]}}function a(t,e,n,r){var a,i,o,s;for(i=1;i<=n;i+=1){for(s=0,a=1;a<i;a+=1)s+=t[a][i]*r[a];r[i]=(r[i]-s)/t[i][i]}for(o=1;o<=n;o+=1)for(i=n+1-o,r[i]=r[i]/t[i][i],s=-r[i],a=1;a<i;a+=1)r[a]=r[a]+s*t[a][i]}function i(t,e,n,r){var a,i,o,s,u,c;for(i=1;i<=n;i+=1){if(r[1]=i,c=0,o=i-1,o<1){if(c=t[i][i]-c,c<=0)break;t[i][i]=Math.sqrt(c)}else{for(s=1;s<=o;s+=1){for(u=t[s][i],a=1;a<s;a+=1)u-=t[a][i]*t[a][s];u/=t[s][s],t[s][i]=u,c+=u*u}if(c=t[i][i]-c,c<=0)break;t[i][i]=Math.sqrt(c)}r[1]=0}}function o(t,e,n,o,s,u,c,l,d,h,p,f,m,g,b,y){var v,x,w,k,S,O,_,C,T,I,N,E,A,R,j,D,F,M,P,$,L,B,z,W,V,U,G;A=Math.min(o,h),w=2*o+A*(A+5)/2+2*h+1,W=1e-60;do{W+=W,V=1+.1*W,U=1+.2*W}while(V<=1||U<=1);for(v=1;v<=o;v+=1)b[v]=e[v];for(v=o+1;v<=w;v+=1)b[v]=0;for(v=1;v<=h;v+=1)f[v]=0;if(S=[],0===y[1]){if(i(t,n,o,S),0!==S[1])return void(y[1]=2);a(t,n,o,e),r(t,n,o)}else{for(x=1;x<=o;x+=1)for(s[x]=0,v=1;v<=x;v+=1)s[x]=s[x]+t[v][x]*e[v];for(x=1;x<=o;x+=1)for(e[x]=0,v=x;v<=o;v+=1)e[x]=e[x]+t[x][v]*s[v]}for(u[1]=0,x=1;x<=o;x+=1)for(s[x]=e[x],u[1]=u[1]+b[x]*s[x],b[x]=0,v=x+1;v<=o;v+=1)t[v][x]=0;for(u[1]=-u[1]/2,y[1]=0,_=o,C=_+o,N=C+A,T=N+A+1,I=T+A*(A+1)/2,R=I+h,v=1;v<=h;v+=1){for(D=0,x=1;x<=o;x+=1)D+=c[x][v]*c[x][v];b[R+v]=Math.sqrt(D)}function H(){for(g[1]=g[1]+1,w=I,v=1;v<=h;v+=1){for(w+=1,D=-l[v],x=1;x<=o;x+=1)D+=c[x][v]*s[x];if(Math.abs(D)<W&&(D=0),v>p)b[w]=D;else if(b[w]=-Math.abs(D),D>0){for(x=1;x<=o;x+=1)c[x][v]=-c[x][v];l[v]=-l[v]}}for(v=1;v<=m;v+=1)b[I+f[v]]=0;for(E=0,j=0,v=1;v<=h;v+=1)b[I+v]<j*b[R+v]&&(E=v,j=b[I+v]/b[R+v]);return 0===E?999:0}function q(){for(v=1;v<=o;v+=1){for(D=0,x=1;x<=o;x+=1)D+=t[x][v]*c[x][E];b[v]=D}for(k=_,v=1;v<=o;v+=1)b[k+v]=0;for(x=m+1;x<=o;x+=1)for(v=1;v<=o;v+=1)b[k+v]=b[k+v]+t[v][x]*b[x];for(B=!0,v=m;v>=1;v-=1){for(D=b[v],w=T+v*(v+3)/2,k=w-v,x=v+1;x<=m;x+=1)D-=b[w]*b[C+x],w+=x;if(D/=b[k],b[C+v]=D,f[v]<p)break;if(D<0)break;B=!1,O=v}if(!B)for(F=b[N+O]/b[C+O],v=1;v<=m;v+=1){if(f[v]<p)break;if(b[C+v]<0)break;j=b[N+v]/b[C+v],j<F&&(F=j,O=v)}for(D=0,v=_+1;v<=_+o;v+=1)D+=b[v]*b[v];if(Math.abs(D)<=W){if(B)return y[1]=1,999;for(v=1;v<=m;v+=1)b[N+v]=b[N+v]-F*b[C+v];return b[N+m+1]=b[N+m+1]+F,700}for(D=0,v=1;v<=o;v+=1)D+=b[_+v]*c[v][E];for(M=-b[I+E]/D,z=!0,B||F<M&&(M=F,z=!1),v=1;v<=o;v+=1)s[v]=s[v]+M*b[_+v],Math.abs(s[v])<W&&(s[v]=0);for(u[1]=u[1]+M*D*(M/2+b[N+m+1]),v=1;v<=m;v+=1)b[N+v]=b[N+v]-M*b[C+v];if(b[N+m+1]=b[N+m+1]+M,!z){for(D=-l[E],x=1;x<=o;x+=1)D+=s[x]*c[x][E];if(E>p)b[I+E]=D;else if(b[I+E]=-Math.abs(D),D>0){for(x=1;x<=o;x+=1)c[x][E]=-c[x][E];l[E]=-l[E]}return 700}for(m+=1,f[m]=E,w=T+(m-1)*m/2+1,v=1;v<=m-1;v+=1)b[w]=b[v],w+=1;if(m===o)b[w]=b[o];else{for(v=o;v>=m+1;v-=1){if(0===b[v])break;if(P=Math.max(Math.abs(b[v-1]),Math.abs(b[v])),$=Math.min(Math.abs(b[v-1]),Math.abs(b[v])),j=b[v-1]>=0?Math.abs(P*Math.sqrt(1+$*$/(P*P))):-Math.abs(P*Math.sqrt(1+$*$/(P*P))),P=b[v-1]/j,$=b[v]/j,1===P)break;if(0===P)for(b[v-1]=$*j,x=1;x<=o;x+=1)j=t[x][v-1],t[x][v-1]=t[x][v],t[x][v]=j;else for(b[v-1]=j,L=$/(1+P),x=1;x<=o;x+=1)j=P*t[x][v-1]+$*t[x][v],t[x][v]=L*(t[x][v-1]+j)-t[x][v],t[x][v-1]=j}b[w]=b[m]}return 0}function K(){if(w=T+O*(O+1)/2+1,k=w+O,0===b[k])return 798;if(P=Math.max(Math.abs(b[k-1]),Math.abs(b[k])),$=Math.min(Math.abs(b[k-1]),Math.abs(b[k])),j=b[k-1]>=0?Math.abs(P*Math.sqrt(1+$*$/(P*P))):-Math.abs(P*Math.sqrt(1+$*$/(P*P))),P=b[k-1]/j,$=b[k]/j,1===P)return 798;if(0===P){for(v=O+1;v<=m;v+=1)j=b[k-1],b[k-1]=b[k],b[k]=j,k+=v;for(v=1;v<=o;v+=1)j=t[v][O],t[v][O]=t[v][O+1],t[v][O+1]=j}else{for(L=$/(1+P),v=O+1;v<=m;v+=1)j=P*b[k-1]+$*b[k],b[k]=L*(b[k-1]+j)-b[k],b[k-1]=j,k+=v;for(v=1;v<=o;v+=1)j=P*t[v][O]+$*t[v][O+1],t[v][O+1]=L*(t[v][O]+j)-t[v][O+1],t[v][O]=j}return 0}function X(){for(k=w-O,v=1;v<=O;v+=1)b[k]=b[w],w+=1,k+=1;return b[N+O]=b[N+O+1],f[O]=f[O+1],O+=1,O<m?797:0}function Y(){return b[N+m]=b[N+m+1],b[N+m+1]=0,f[m]=0,m-=1,g[2]=g[2]+1,0}m=0,g[1]=0,g[2]=0,G=0;while(1){if(G=H(),999===G)return;while(1){if(G=q(),0===G)break;if(999===G)return;if(700===G)if(O===m)Y();else{while(1)if(K(),G=X(),797!==G)break;Y()}}}}function s(t,r,a,i,s,u){t=e(t),r=e(r),a=e(a);var c,l,d,h,p,f,m=[],g=[],b=[],y=[],v=[];if(s=s||0,u=u?e(u):[void 0,0],i=i?e(i):[],l=t.length-1,d=a[1].length-1,!i)for(c=1;c<=d;c+=1)i[c]=0;for(c=1;c<=d;c+=1)g[c]=0;for(h=0,p=Math.min(l,d),c=1;c<=l;c+=1)b[c]=0;for(m[1]=0,c=1;c<=2*l+p*(p+5)/2+2*d+1;c+=1)y[c]=0;for(c=1;c<=2;c+=1)v[c]=0;return o(t,r,l,l,b,m,a,i,l,d,s,g,h,v,y,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:n(b),value:n(m),unconstrained_solution:n(r),iterations:n(v),iact:n(g),message:f}}t.solveQP=s}(numeric),numeric.svd=function(t){var e,n=numeric.epsilon,r=1e-64/n,a=50,i=0,o=0,s=0,u=0,c=0,l=numeric.clone(t),d=l.length,h=l[0].length;if(d<h)throw"Need more rows than columns";var p=new Array(h),f=new Array(h);for(o=0;o<h;o++)p[o]=f[o]=0;var m=numeric.rep([h,h],0);function g(t,e){return t=Math.abs(t),e=Math.abs(e),t>e?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var b=0,y=0,v=0,x=0,w=0,k=0,S=0;for(o=0;o<h;o++){for(p[o]=y,S=0,c=o+1,s=o;s<d;s++)S+=l[s][o]*l[s][o];if(S<=r)y=0;else for(b=l[o][o],y=Math.sqrt(S),b>=0&&(y=-y),v=b*y-S,l[o][o]=b-y,s=c;s<h;s++){for(S=0,u=o;u<d;u++)S+=l[u][o]*l[u][s];for(b=S/v,u=o;u<d;u++)l[u][s]+=b*l[u][o]}for(f[o]=y,S=0,s=c;s<h;s++)S+=l[o][s]*l[o][s];if(S<=r)y=0;else{for(b=l[o][o+1],y=Math.sqrt(S),b>=0&&(y=-y),v=b*y-S,l[o][o+1]=b-y,s=c;s<h;s++)p[s]=l[o][s]/v;for(s=c;s<d;s++){for(S=0,u=c;u<h;u++)S+=l[s][u]*l[o][u];for(u=c;u<h;u++)l[s][u]+=S*p[u]}}w=Math.abs(f[o])+Math.abs(p[o]),w>x&&(x=w)}for(o=h-1;-1!=o;o+=-1){if(0!=y){for(v=y*l[o][o+1],s=c;s<h;s++)m[s][o]=l[o][s]/v;for(s=c;s<h;s++){for(S=0,u=c;u<h;u++)S+=l[o][u]*m[u][s];for(u=c;u<h;u++)m[u][s]+=S*m[u][o]}}for(s=c;s<h;s++)m[o][s]=0,m[s][o]=0;m[o][o]=1,y=p[o],c=o}for(o=h-1;-1!=o;o+=-1){for(c=o+1,y=f[o],s=c;s<h;s++)l[o][s]=0;if(0!=y){for(v=l[o][o]*y,s=c;s<h;s++){for(S=0,u=c;u<d;u++)S+=l[u][o]*l[u][s];for(b=S/v,u=o;u<d;u++)l[u][s]+=b*l[u][o]}for(s=o;s<d;s++)l[s][o]=l[s][o]/y}else for(s=o;s<d;s++)l[s][o]=0;l[o][o]+=1}for(n*=x,u=h-1;-1!=u;u+=-1)for(var O=0;O<a;O++){var _=!1;for(c=u;-1!=c;c+=-1){if(Math.abs(p[c])<=n){_=!0;break}if(Math.abs(f[c-1])<=n)break}if(!_){i=0,S=1;var C=c-1;for(o=c;o<u+1;o++){if(b=S*p[o],p[o]=i*p[o],Math.abs(b)<=n)break;for(y=f[o],v=g(b,y),f[o]=v,i=y/v,S=-b/v,s=0;s<d;s++)w=l[s][C],k=l[s][o],l[s][C]=w*i+k*S,l[s][o]=-w*S+k*i}}if(k=f[u],c==u){if(k<0)for(f[u]=-k,s=0;s<h;s++)m[s][u]=-m[s][u];break}if(O>=a-1)throw"Error: no convergence.";for(x=f[c],w=f[u-1],y=p[u-1],v=p[u],b=((w-k)*(w+k)+(y-v)*(y+v))/(2*v*w),y=g(b,1),b=b<0?((x-k)*(x+k)+v*(w/(b-y)-v))/x:((x-k)*(x+k)+v*(w/(b+y)-v))/x,i=1,S=1,o=c+1;o<u+1;o++){for(y=p[o],w=f[o],v=S*y,y*=i,k=g(b,v),p[o-1]=k,i=b/k,S=v/k,b=x*i+y*S,y=-x*S+y*i,v=w*S,w*=i,s=0;s<h;s++)x=m[s][o-1],k=m[s][o],m[s][o-1]=x*i+k*S,m[s][o]=-x*S+k*i;for(k=g(b,v),f[o-1]=k,i=b/k,S=v/k,b=i*y+S*w,x=-S*y+i*w,s=0;s<d;s++)w=l[s][o-1],k=l[s][o],l[s][o-1]=w*i+k*S,l[s][o]=-w*S+k*i}p[c]=0,p[u]=b,f[u]=x}for(o=0;o<f.length;o++)f[o]<n&&(f[o]=0);for(o=0;o<h;o++)for(s=o-1;s>=0;s--)if(f[s]<f[o]){for(i=f[s],f[s]=f[o],f[o]=i,u=0;u<l.length;u++)e=l[u][o],l[u][o]=l[u][s],l[u][s]=e;for(u=0;u<m.length;u++)e=m[u][o],m[u][o]=m[u][s],m[u][s]=e;o=s}return{U:l,S:f,V:m}}}).call(this,__webpack_require__("c8ba"))},cb5a:function(t,e,n){var r=n("9638");function a(t,e){var n=t.length;while(n--)if(r(t[n][0],e))return n;return-1}t.exports=a},cb69:function(t,e,n){"use strict";(function(t){function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.withParams=void 0;var r="undefined"!==typeof window?window:"undefined"!==typeof t?t:{},a=function(t,e){return"object"===n(t)&&void 0!==e?e:t((function(){}))},i=r.vuelidate?r.vuelidate.withParams:a;e.withParams=i}).call(this,n("c8ba"))},cbb7:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=r["backend_util"].RowPartitionType;
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i{constructor(t,e,n,a,i,o,s,u,c,l){this.shape=t,this.shapeShape=e,this.values=n,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=r["backend_util"].getRowPartitionTypesHelper(l),this.raggedRank=r["backend_util"].getRaggedRank(this.rowPartitionTypes)}getRowPartitionTypeByDimension(t){return this.rowPartitionTypes[0]===a.FIRST_DIM_SIZE?this.rowPartitionTypes[t+1]:this.rowPartitionTypes[t]}getRowPartitionTensor(t){return this.rowPartitionTypes[0]===a.FIRST_DIM_SIZE?this.rowPartitionValues[t+1]:this.rowPartitionValues[t]}getMaxWidth(t){const e=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case a.VALUE_ROWIDS:return i.getMaxWidthValueRowID(e);case a.ROW_SPLITS:return i.getMaxWidthRowSplit(e);default:throw new Error("Cannot handle partition type "+a[this.getRowPartitionTypeByDimension(t-1)])}}static getMaxWidthRowSplit(t){const e=t.length;if(0===e||1===e)return 0;let n=0;for(let r=0;r<e-1;++r){const e=t[r+1]-t[r];e>n&&(n=e)}return n}static getMaxWidthValueRowID(t){const e=t.length;if(0===e)return 0;let n=0,r=t[0],a=0;for(let i=1;i<e;++i){const e=t[i];e!==r&&(r=e,a=Math.max(i-n,a),n=i)}return Math.max(e-n,a)}tensorShapeFromTensor(t,e,n=!0){if(0===e.length){if(-1===t[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return s(t,n)}calculateOutputSize(t){const e=this.valuesShape,n=this.defaultValueShape;r["backend_util"].validateDefaultValueShape(n,e);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=r["backend_util"].combineRaggedTensorToTensorShapes(this.raggedRank,a,e),o=i;o[0]<0&&(o[0]=t);for(let r=1;r<=this.raggedRank;++r)o[r]<0&&(o[r]=this.getMaxWidth(r));return o}calculateFirstParentOutputIndex(t,e,n){const a=Math.min(t,n),i=[];let o=0;for(let r=0;r<a;++r,o+=e)i.push(o);for(let r=a;r<t;++r)i.push(-1);return r["util"].assert(i.length===t,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(t,e,n,r){const a=t.length,i=[];for(let o=0;o<a-1;++o){const a=t[o+1]-t[o];let s=Math.min(r,a),u=e[o];-1===u&&(s=0);for(let t=0;t<s;++t)i.push(u),u+=n;for(let t=0;t<a-s;++t)i.push(-1)}if(a>0&&i.length!==t[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(t,e,n,r){const a=t.length,i=[];if(0===a)return[];let o=0,s=t[0];if(s>=e.length)throw new Error(`Got currentValueRowId=${s}, which is not less than ${e.length}`);let u=e[s];i.push(u);for(let c=1;c<a;++c){const a=t[c];if(a===s)u>=0&&(++o,o<r?u+=n:u=-1);else{if(o=0,s=a,a>=e.length)throw new Error(`Got nextValueRowId=${a} which is not less than ${e.length}`);u=e[a]}i.push(u)}if(i.length!==t.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(t,e,n,r){const i=this.getRowPartitionTensor(t),o=this.getRowPartitionTypeByDimension(t);switch(o){case a.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,e,n,r);case a.ROW_SPLITS:if(i.length-1>e.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${e.length}`);return this.calculateOutputIndexRowSplit(i,e,n,r);default:throw new Error("Unsupported partition type: "+a[o])}}getFirstDimensionSize(){const t=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const e=this.rowPartitionTypes[0];switch(e){case a.FIRST_DIM_SIZE:return t[0];case a.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case a.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error("Cannot handle type "+a[e])}}compute(){const t=this.rowPartitionValues[0];if(t.length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),n=this.calculateOutputSize(e),a=new Array(this.raggedRank+1);a[a.length-1]=1;for(let r=a.length-2;r>=0;--r)a[r]=a[r+1]*n[r+1];const i=s(n,!1),o=r["util"].getArrayFromDType(this.valuesDType,r["util"].sizeFromShape(i)),u=a[0]*n[0];if(u>0){let t=this.calculateFirstParentOutputIndex(e,a[0],n[0]);for(let e=1;e<=this.raggedRank;++e){const r=this.calculateOutputIndex(e-1,t,a[e],n[e]);t=r}this.setOutput(this.raggedRank,t,o,i)}return[i,o]}setOutput(t,e,n,a){if(0===n.length)return;const i=this.values,s=n;let u=a.slice();u=u.slice(t+1);const c=r["util"].sizeFromShape(u),l=e.length;let d=this.defaultValue;if(d.length!==c&&1!==d.length){const t=this.defaultValueShape;Object(r["tidy"])(()=>{const e=Object(r["reshape"])(d,t),n=Object(r["broadcastTo"])(e,u);d=n.dataSync()})}let h=0,p=0,f=0;for(let r=0;r<=l;++r){let t=r<l?e[r]:-1;if(t!==f){if(p<f){const t=i.subarray(h*c),e=s.subarray(p*c),n=(f-p)*c;o(e,t,n)}if(r>=l){const e=n.length;t=Math.floor(e/c)}if(t>f)if(1===this.defaultValue.length)s.subarray(f*c,t*c).fill(this.defaultValue[0]),f=t;else while(t>f){const t=s.slice(f*c);o(t,d,c),++f}t<0?(h=r+1,p=f):(h=r,p=f,f=p+1)}else++f}}}function o(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function s(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function u(t,e,n,r,a,o,s,u,c,l){return new i(t,e,n,r,a,o,s,u,c,l).compute()}},cc16:function(t,e){},cd00:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e,n){const s=Object(i["a"])(t,"x","spaceToBatchND");o["b"](s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),o["b"](n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),o["b"](s.shape.reduce((t,r,a)=>a>0&&a<=e.length?t&&(r+n[a-1][0]+n[a-1][1])%e[a-1]===0:t,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const u={x:s},c={blockShape:e,paddings:n};return r["a"].runKernel(a["Pc"],u,c)}const c=Object(s["b"])({spaceToBatchND_:u})},cd9d:function(t,e){function n(t){return t}t.exports=n},ce86:function(t,e,n){var r=n("9e69"),a=n("7948"),i=n("6747"),o=n("ffd6"),s=1/0,u=r?r.prototype:void 0,c=u?u.toString:void 0;function l(t){if("string"==typeof t)return t;if(i(t))return a(t,l)+"";if(o(t))return c?c.call(t):"";var e=t+"";return"0"==e&&1/t==-s?"-0":e}t.exports=l},ceac:function(t,e,n){var r=n("2eaa"),a=n("5c69"),i=n("100e"),o=n("dcbe"),s=i((function(t,e){return o(t)?r(t,a(e,1,o,!0)):[]}));t.exports=s},cf29:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Grayscale=void 0;var r=function(t){var e,n,r=t.data,a=r.length;for(e=0;e<a;e+=4)n=.34*r[e]+.5*r[e+1]+.16*r[e+2],r[e]=n,r[e+1]=n,r[e+2]=n};e.Grayscale=r},cfe5:function(t,e){},d02c:function(t,e,n){var r=n("5e2e"),a=n("79bc"),i=n("7b83"),o=200;function s(t,e){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!a||s.length<o-1)return s.push([t,e]),this.size=++n.size,this;n=this.__data__=new i(s)}return n.set(t,e),this.size=n.size,this}t.exports=s},d032:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a){const i=t===e,o=t<e&&n<0,s=e<t&&n>1;if(i||o||s)return r["util"].makeZerosTypedArray(0,a);const u=Math.abs(Math.ceil((e-t)/n)),c=r["util"].makeZerosTypedArray(u,a);e<t&&1===n&&(n=-1),c[0]=t;for(let r=1;r<c.length;r++)c[r]=c[r-1]+n;return c}},d17b:function(t,e,n){t.exports=n("e372").Transform},d266:function(t){t.exports=JSON.parse('{"screens":{"AwaitIteratedResultScreen":{"description":"Warte auf die Resultate der vorherigen iteration dieses Experiments."},"ConnectInteractiveScreen":{"description":"Die Verbindung mit dem Echtzeit-Server wird aufgebaut und auf andere Teilnehmer für dieses interaktive Experiment wird gewartet."},"EyetrackingCalibrationScreen":{"start":"Augentracking wird geladen.","instruction":"Bitte folgen Sie dem roten Punkt.","error":"Etwas ist schief gelaufen. Bitte laden Sie die Seite neu."},"EyetrackingValidationScreen":{"instruction":"Bitte schauen Sie auf den blauen Punkt in der Mitte des Bildschirms","error":"Etwas ist schief gelaufen. Bitte laden Sie die Seite neu."},"PostTestScreen":{"instruction":"Das Beantworten der folgenden fragen ist optional, aber Ihre Antworten helfen uns die Ergebnisse auszuwerten.","age":"Alter","gender":"Geschlecht","male":"männlich","female":"weiblich","otherGender":"divers","education":"Bildungsgrad","educationBelowHighschool":"kein Abitur","educationHighschool":"Abitur","educationCollege":"Bachelor","educationHigher":"Höherer Abschluss","nativeLanguages":"Muttersprachen","nativeLanguagesExplanation":"die Sprache(n) die bei Ihnen als Kind zu Hause gesprochen wurde(n)","comments":"Sonstige Kommentare"},"SubmitResultsScreen":{"waiting":"Bitte kurz warten, während die Daten hochgeladen werden.","done":"Alles fertig. Vielen Dank!","error":"Oh nein. Es gab ein Problem beim Hochladen Ihrer Ergebnisse.","contact":"Bitte informieren Sie die Autor:innen dieses Experiments via E-Mail:"}},"general":{"nextButton":"Weiter","start":"Start","go":"Los","send":"Senden"},"interactive":{"Chat":{"messageLabel":"Schreiben Sie Ihre Nachricht an die anderen Teilnehmenden hier.","statusYouJoined":"Sie sind dem Chat beigetreten","statusYouLeft":"Sie haben den Chat verlassen","statusParticipantJoined":"{user} ist dem Chat beigetreten","statusParticipantLeft":"{user} hat den Chat verlassen"},"general":{"aborted":"Das Experiment kann leider nicht zu Ende geführt werden, weil eine*r der Teilnehmenden die Sitzung verlassen hat. Sie springen nun zum Ende des Experiments."}}}')},d286:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a=(t,e)=>{const n=e.value-t.value;return 0===n?t.index-e.index:n};function i(t,e,n=0,o=t.length-1){while(o>n){if(o-n>600){const r=o-n+1,a=e-n+1,s=Math.log(r),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(r-u)/r)*Math.sign(a-r/2),l=Math.max(n,Math.floor(e-a*u/r+c)),d=Math.min(o,Math.floor(e+(r-a)*u/r+c));i(t,e,l,d)}const s=t[e];let u=n,c=o;r["util"].swap(t,n,e),a(t[o],s)>0&&r["util"].swap(t,n,o);while(u<c){r["util"].swap(t,u,c),u++,c--;while(a(t[u],s)<0)u+=1;while(a(t[c],s)>0)c-=1}0===a(t[n],s)?r["util"].swap(t,n,c):(c+=1,r["util"].swap(t,c,o)),c<=e&&(n=c+1),e<=c&&(o=c-1)}}function o(t,e,n,o,s){const u=e[e.length-1],[c,l]=[t.length/u,u],d=r["util"].getTypedArrayFromDType(n,c*o),h=r["util"].getTypedArrayFromDType("int32",c*o);for(let r=0;r<c;r++){const e=r*l,n=t.subarray(e,e+l);let u=new Array(n.length);n.forEach((t,e)=>u[e]={value:t,index:e}),o<u.length&&(i(u,o),u=u.slice(0,o)),s&&u.sort(a);const c=r*o,p=d.subarray(c,c+o),f=h.subarray(c,c+o);for(let t=0;t<o;t++)p[t]=u[t].value,f[t]=u[t].index}const p=e.slice();return p[p.length-1]=o,[Object(r["buffer"])(p,n,d),Object(r["buffer"])(p,"int32",h)]}},d28e:function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return d}));var r=n("2ca8"),a=n("c5c9"),i=n("5ba1"),o=n("8f1f"),s=n("3a38"),u=n("bc57");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e,n,i){if("int32"===i){const n=Int32Array.from(t);return[e,"int32",n]}if("bool"===i){const i=r["util"].toTypedArray([0],n),[o,s]=Object(a["a"])((t,e)=>t!==e?1:0)(e,[],t,i,"bool");return[s,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${i}`)}function l(t){const{inputs:e,backend:n,attrs:a}=t,{x:d}=e,{dtype:h}=a;if("complex64"===h){if("complex64"===d.dtype)return Object(s["a"])({inputs:{x:d},backend:n});const t=Object(i["a"])(n,d.shape,d.dtype),e=l({inputs:{x:d},backend:n,attrs:{dtype:"float32"}}),r=Object(o["a"])({inputs:{real:e,imag:t},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(e),r}if("complex64"===d.dtype){const t=Object(u["a"])({inputs:{input:d},backend:n}),e=l({inputs:{x:t},backend:n,attrs:{dtype:h}});return n.disposeIntermediateTensorInfo(t),e}if(!r["util"].hasEncodingLoss(d.dtype,h)){const t=Object(s["a"])({inputs:{x:d},backend:n});return{dataId:t.dataId,shape:t.shape,dtype:h}}const p=n.data.get(d.dataId).values,[f,m,g]=c(p,d.shape,d.dtype,h);return n.makeTensorInfo(f,m,g)}const d={kernelName:r["Cast"],backendName:"cpu",kernelFunc:l}},d294:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return(0,r.withParams)({type:"or"},(function(){for(var t=this,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.length>0&&e.reduce((function(e,n){return e||n.apply(t,r)}),!1)}))};e.default=a},d2e3:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}]},d327:function(t,e){function n(){return[]}t.exports=n},d370:function(t,e,n){var r=n("253c"),a=n("1310"),i=Object.prototype,o=i.hasOwnProperty,s=i.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return a(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},d3e0:function(t,e){},d425:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("7037"),i=n("ab01");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])(t=>1/Math.sqrt(t)),s=Object(i["b"])(r["Rsqrt"],o),u={kernelName:r["Rsqrt"],backendName:"cpu",kernelFunc:s}},d460:function(t,e,n){var r=n("be56");function a(t,e){var n=-1,a=t.length,i=a-1;e=void 0===e?a:e;while(++n<e){var o=r(n,i),s=t[o];t[o]=t[n],t[n]=s}return t.length=e,t}t.exports=a},d485:function(t,e,n){t.exports=i;var r=n("faa1").EventEmitter,a=n("3fb5");function i(){r.call(this)}a(i,r),i.Readable=n("e372"),i.Writable=n("2c63"),i.Duplex=n("0960"),i.Transform=n("d17b"),i.PassThrough=n("c2ae"),i.Stream=i,i.prototype.pipe=function(t,e){var n=this;function a(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function i(){n.readable&&n.resume&&n.resume()}n.on("data",a),t.on("drain",i),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",u));var o=!1;function s(){o||(o=!0,t.end())}function u(){o||(o=!0,"function"===typeof t.destroy&&t.destroy())}function c(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",a),t.removeListener("drain",i),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l)}return n.on("error",c),t.on("error",c),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t}},d488:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__assign||function(){return a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},a.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Transformer=void 0;var i=n("9cb8"),o=n("f0b4"),s=n("4971"),u=n("fce6"),c=n("5d5a"),l=n("f35c"),d=n("d777"),h=n("4546"),p=n("d777"),f="tr-konva",m=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map((function(t){return t+"."+f})).join(" "),g="nodesRect",b=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map((function(t){return t+"."+f})).join(" "),y={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in d.Konva._global;function x(t,e){if("rotater"===t)return"crosshair";e+=i.Util._degToRad(y[t]||0);var n=(i.Util._radToDeg(e)%360+360)%360;return i.Util._inRange(n,337.5,360)||i.Util._inRange(n,0,22.5)?"ns-resize":i.Util._inRange(n,22.5,67.5)?"nesw-resize":i.Util._inRange(n,67.5,112.5)?"ew-resize":i.Util._inRange(n,112.5,157.5)?"nwse-resize":i.Util._inRange(n,157.5,202.5)?"ns-resize":i.Util._inRange(n,202.5,247.5)?"nesw-resize":i.Util._inRange(n,247.5,292.5)?"ew-resize":i.Util._inRange(n,292.5,337.5)?"nwse-resize":(i.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}var w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],k=1e8;function S(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function O(t,e,n){var r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),i=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return a(a({},t),{rotation:t.rotation+e,x:r,y:i})}function _(t,e){var n=S(t);return O(t,e,n)}function C(t,e,n){for(var r=e,a=0;a<t.length;a++){var i=d.Konva.getAngle(t[a]),o=Math.abs(i-e)%(2*Math.PI),s=Math.min(o,2*Math.PI-o);s<n&&(r=i)}return r}var T=function(t){function e(e){var n=t.call(this,e)||this;return n._transforming=!1,n._createElements(),n._handleMouseMove=n._handleMouseMove.bind(n),n._handleMouseUp=n._handleMouseUp.bind(n),n.update=n.update.bind(n),n.on(m,n.update),n.getNode()&&n.update(),n}return r(e,t),e.prototype.attachTo=function(t){return this.setNode(t),this},e.prototype.setNode=function(t){return i.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])},e.prototype.getNode=function(){return this._nodes&&this._nodes[0]},e.prototype.setNodes=function(t){var e=this;void 0===t&&(t=[]),this._nodes&&this._nodes.length&&this.detach(),this._nodes=t,1===t.length?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach((function(t){var n=t._attrsAffectingSize.map((function(t){return t+"Change."+f})).join(" "),r=function(){1===e.nodes().length&&e.rotation(e.nodes()[0].getAbsoluteRotation()),e._resetTransformCache(),e._transforming||e.isDragging()||e.update()};t.on(n,r),t.on(b,r),t.on("_clearTransformCache."+f,r),t.on("xChange."+f+" yChange."+f,r),e._proxyDrag(t)})),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this},e.prototype._proxyDrag=function(t){var e,n=this;t.on("dragstart."+f,(function(r){e=t.getAbsolutePosition(),n.isDragging()||t===n.findOne(".back")||n.startDrag(r,!1)})),t.on("dragmove."+f,(function(r){if(e){var a=t.getAbsolutePosition(),i=a.x-e.x,o=a.y-e.y;n.nodes().forEach((function(e){if(e!==t&&!e.isDragging()){var n=e.getAbsolutePosition();e.setAbsolutePosition({x:n.x+i,y:n.y+o}),e.startDrag(r)}})),e=null}}))},e.prototype.getNodes=function(){return this._nodes||[]},e.prototype.getActiveAnchor=function(){return this._movingAnchorName},e.prototype.detach=function(){this._nodes&&this._nodes.forEach((function(t){t.off("."+f)})),this._nodes=[],this._resetTransformCache()},e.prototype._resetTransformCache=function(){this._clearCache(g),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")},e.prototype._getNodeRect=function(){return this._getCache(g,this.__getNodeRect)},e.prototype.__getNodeShape=function(t,e,n){void 0===e&&(e=this.rotation());var r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),i=t.getAbsolutePosition(n),o=r.x*a.x-t.offsetX()*a.x,s=r.y*a.y-t.offsetY()*a.y,u=(d.Konva.getAngle(t.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI),c={x:i.x+o*Math.cos(u)+s*Math.sin(-u),y:i.y+s*Math.cos(u)+o*Math.sin(u),width:r.width*a.x,height:r.height*a.y,rotation:u};return O(c,-d.Konva.getAngle(e),{x:0,y:0})},e.prototype.__getNodeRect=function(){var t=this,e=this.getNode();if(!e)return{x:-k,y:-k,width:0,height:0,rotation:0};var n=[];this.nodes().map((function(e){var r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:t.ignoreStroke()}),a=[{x:r.x,y:r.y},{x:r.x+r.width,y:r.y},{x:r.x+r.width,y:r.y+r.height},{x:r.x,y:r.y+r.height}],i=e.getAbsoluteTransform();a.forEach((function(t){var e=i.point(t);n.push(e)}))}));var r,a,o,s,u=new i.Transform;u.rotate(-d.Konva.getAngle(this.rotation())),n.forEach((function(t){var e=u.point(t);void 0===r&&(r=o=e.x,a=s=e.y),r=Math.min(r,e.x),a=Math.min(a,e.y),o=Math.max(o,e.x),s=Math.max(s,e.y)})),u.invert();var c=u.point({x:r,y:a});return{x:c.x,y:c.y,width:o-r,height:s-a,rotation:d.Konva.getAngle(this.rotation())}},e.prototype.getX=function(){return this._getNodeRect().x},e.prototype.getY=function(){return this._getNodeRect().y},e.prototype.getWidth=function(){return this._getNodeRect().width},e.prototype.getHeight=function(){return this._getNodeRect().height},e.prototype._createElements=function(){this._createBack(),w.forEach(function(t){this._createAnchor(t)}.bind(this)),this._createAnchor("rotater")},e.prototype._createAnchor=function(t){var e=this,n=new c.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),r=this;n.on("mousedown touchstart",(function(t){r._handleMouseDown(t)})),n.on("dragstart",(function(t){n.stopDrag(),t.cancelBubble=!0})),n.on("dragend",(function(t){t.cancelBubble=!0})),n.on("mouseenter",(function(){var r=d.Konva.getAngle(e.rotation()),a=x(t,r);n.getStage().content.style.cursor=a,e._cursorChange=!0})),n.on("mouseout",(function(){n.getStage().content.style.cursor="",e._cursorChange=!1})),this.add(n)},e.prototype._createBack=function(){var t=this,e=new u.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc:function(t){var e=this.getParent(),n=e.padding();t.beginPath(),t.rect(-n,-n,this.width()+2*n,this.height()+2*n),t.moveTo(this.width()/2,-n),e.rotateEnabled()&&t.lineTo(this.width()/2,-e.rotateAnchorOffset()*i.Util._sign(this.height())-n),t.fillStrokeShape(this)},hitFunc:function(e,n){if(t.shouldOverdrawWholeArea()){var r=t.padding();e.beginPath(),e.rect(-r,-r,n.width()+2*r,n.height()+2*r),e.fillStrokeShape(n)}}});this.add(e),this._proxyDrag(e),e.on("dragstart",(function(t){t.cancelBubble=!0})),e.on("dragmove",(function(t){t.cancelBubble=!0})),e.on("dragend",(function(t){t.cancelBubble=!0}))},e.prototype._handleMouseDown=function(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),n=e.width,r=e.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/a),this.cos=Math.abs(n/a),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0),this._transforming=!0;var i=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},this._fire("transformstart",{evt:t,target:this.getNode()}),this._nodes.forEach((function(e){e._fire("transformstart",{evt:t,target:e})}))},e.prototype._handleMouseMove=function(t){var e,n,r,a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(t);var o=i.getPointerPosition(),s={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y},u=a.getAbsolutePosition();a.setAbsolutePosition(s);var c=a.getAbsolutePosition();if(u.x!==c.x||u.y!==c.y)if("rotater"!==this._movingAnchorName){var l=this.keepRatio()||t.shiftKey,h=this.centeredScaling()||t.altKey;if("top-left"===this._movingAnchorName){if(l){var p=h?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(p.y-a.y(),2));var f=this.findOne(".top-left").x()>p.x?-1:1,m=this.findOne(".top-left").y()>p.y?-1:1;e=r*this.cos*f,n=r*this.sin*m,this.findOne(".top-left").x(p.x-e),this.findOne(".top-left").y(p.y-n)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(a.y());else if("top-right"===this._movingAnchorName){if(l){p=h?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(p.y-a.y(),2));f=this.findOne(".top-right").x()<p.x?-1:1,m=this.findOne(".top-right").y()>p.y?-1:1;e=r*this.cos*f,n=r*this.sin*m,this.findOne(".top-right").x(p.x+e),this.findOne(".top-right").y(p.y-n)}var g=a.position();this.findOne(".top-left").y(g.y),this.findOne(".bottom-right").x(g.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(a.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(a.x());else if("bottom-left"===this._movingAnchorName){if(l){p=h?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(p.x-a.x(),2)+Math.pow(a.y()-p.y,2));f=p.x<a.x()?-1:1,m=a.y()<p.y?-1:1;e=r*this.cos*f,n=r*this.sin*m,a.x(p.x-e),a.y(p.y+n)}g=a.position(),this.findOne(".top-left").x(g.x),this.findOne(".bottom-right").y(g.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(a.y());else if("bottom-right"===this._movingAnchorName){if(l){p=h?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(a.x()-p.x,2)+Math.pow(a.y()-p.y,2));f=this.findOne(".bottom-right").x()<p.x?-1:1,m=this.findOne(".bottom-right").y()<p.y?-1:1;e=r*this.cos*f,n=r*this.sin*m,this.findOne(".bottom-right").x(p.x+e),this.findOne(".bottom-right").y(p.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));h=this.centeredScaling()||t.altKey;if(h){var b=this.findOne(".top-left"),y=this.findOne(".bottom-right"),v=b.x(),x=b.y(),w=this.getWidth()-y.x(),k=this.getHeight()-y.y();y.move({x:-v,y:-x}),b.move({x:w,y:k})}var S=this.findOne(".top-left").getAbsolutePosition();e=S.x,n=S.y;var O=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),T=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:O,height:T,rotation:d.Konva.getAngle(this.rotation())},t)}else{var I=this._getNodeRect();e=a.x()-I.width/2,n=-a.y()+I.height/2;var N=Math.atan2(-n,e)+Math.PI/2;I.height<0&&(N-=Math.PI);var E=d.Konva.getAngle(this.rotation()),A=E+N,R=d.Konva.getAngle(this.rotationSnapTolerance()),j=C(this.rotationSnaps(),A,R),D=j-I.rotation,F=_(I,D);this._fitNodesInto(F,t)}},e.prototype._handleMouseUp=function(t){this._removeEvents(t)},e.prototype.getAbsoluteTransform=function(){return this.getTransform()},e.prototype._removeEvents=function(t){if(this._transforming){this._transforming=!1,window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0);var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach((function(e){e._fire("transformend",{evt:t,target:e})})),this._movingAnchorName=null}},e.prototype._fitNodesInto=function(t,e){var n=this,r=this._getNodeRect(),a=1;if(i.Util._inRange(t.width,2*-this.padding()-a,a))this.update();else if(i.Util._inRange(t.height,2*-this.padding()-a,a))this.update();else{var o=!0,s=new i.Transform;if(s.rotate(d.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){var u=s.point({x:2*-this.padding(),y:0});if(t.x+=u.x,t.y+=u.y,t.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,!o)return void this.update()}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){u=s.point({x:2*this.padding(),y:0});if(this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,t.width+=2*this.padding(),!o)return void this.update()}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){u=s.point({x:0,y:2*-this.padding()});if(t.x+=u.x,t.y+=u.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,t.height+=2*this.padding(),!o)return void this.update()}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){u=s.point({x:0,y:2*this.padding()});if(this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=u.x,this._anchorDragOffset.y-=u.y,t.height+=2*this.padding(),!o)return void this.update()}if(this.boundBoxFunc()){var c=this.boundBoxFunc()(r,t);c?t=c:i.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}var l=1e7,h=new i.Transform;h.translate(r.x,r.y),h.rotate(r.rotation),h.scale(r.width/l,r.height/l);var p=new i.Transform;p.translate(t.x,t.y),p.rotate(t.rotation),p.scale(t.width/l,t.height/l);var f=p.multiply(h.invert());this._nodes.forEach((function(t){var r,a=t.getParent().getAbsoluteTransform(),o=t.getTransform().copy();o.translate(t.offsetX(),t.offsetY());var s=new i.Transform;s.multiply(a.copy().invert()).multiply(f).multiply(a).multiply(o);var u=s.decompose();t.setAttrs(u),n._fire("transform",{evt:e,target:t}),t._fire("transform",{evt:e,target:t}),null===(r=t.getLayer())||void 0===r||r.batchDraw()})),this.rotation(i.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}},e.prototype.forceUpdate=function(){this._resetTransformCache(),this.update()},e.prototype._batchChangeChild=function(t,e){var n=this.findOne(t);n.setAttrs(e)},e.prototype.update=function(){var t,e=this,n=this._getNodeRect();this.rotation(i.Util._getRotation(n.rotation));var r=n.width,a=n.height,o=this.enabledAnchors(),s=this.resizeEnabled(),u=this.padding(),c=this.anchorSize();this.find("._anchor").each((function(t){t.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:e.anchorStroke(),strokeWidth:e.anchorStrokeWidth(),fill:e.anchorFill(),cornerRadius:e.anchorCornerRadius()})})),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:c/2+u,offsetY:c/2+u,visible:s&&o.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:r/2,y:0,offsetY:c/2+u,visible:s&&o.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:r,y:0,offsetX:c/2-u,offsetY:c/2+u,visible:s&&o.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:a/2,offsetX:c/2+u,visible:s&&o.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:r,y:a/2,offsetX:c/2-u,visible:s&&o.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:a,offsetX:c/2+u,offsetY:c/2-u,visible:s&&o.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:r/2,y:a,offsetY:c/2-u,visible:s&&o.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:r,y:a,offsetX:c/2-u,offsetY:c/2-u,visible:s&&o.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:r/2,y:-this.rotateAnchorOffset()*i.Util._sign(a)-u,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:r,height:a,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0}),null===(t=this.getLayer())||void 0===t||t.batchDraw()},e.prototype.isTransforming=function(){return this._transforming},e.prototype.stopTransform=function(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}},e.prototype.destroy=function(){return this.getStage()&&this._cursorChange&&(this.getStage().content.style.cursor=""),l.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this},e.prototype.toObject=function(){return s.Node.prototype.toObject.call(this)},e}(l.Group);function I(t){return t instanceof Array||i.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach((function(t){-1===w.indexOf(t)&&i.Util.warn("Unknown anchor name: "+t+". Available names are: "+w.join(", "))})),t||[]}e.Transformer=T,T.prototype.className="Transformer",p._registerNode(T),o.Factory.addGetterSetter(T,"enabledAnchors",w,I),o.Factory.addGetterSetter(T,"resizeEnabled",!0),o.Factory.addGetterSetter(T,"anchorSize",10,h.getNumberValidator()),o.Factory.addGetterSetter(T,"rotateEnabled",!0),o.Factory.addGetterSetter(T,"rotationSnaps",[]),o.Factory.addGetterSetter(T,"rotateAnchorOffset",50,h.getNumberValidator()),o.Factory.addGetterSetter(T,"rotationSnapTolerance",5,h.getNumberValidator()),o.Factory.addGetterSetter(T,"borderEnabled",!0),o.Factory.addGetterSetter(T,"anchorStroke","rgb(0, 161, 255)"),o.Factory.addGetterSetter(T,"anchorStrokeWidth",1,h.getNumberValidator()),o.Factory.addGetterSetter(T,"anchorFill","white"),o.Factory.addGetterSetter(T,"anchorCornerRadius",0,h.getNumberValidator()),o.Factory.addGetterSetter(T,"borderStroke","rgb(0, 161, 255)"),o.Factory.addGetterSetter(T,"borderStrokeWidth",1,h.getNumberValidator()),o.Factory.addGetterSetter(T,"borderDash"),o.Factory.addGetterSetter(T,"keepRatio",!0),o.Factory.addGetterSetter(T,"centeredScaling",!1),o.Factory.addGetterSetter(T,"ignoreStroke",!1),o.Factory.addGetterSetter(T,"padding",0,h.getNumberValidator()),o.Factory.addGetterSetter(T,"node"),o.Factory.addGetterSetter(T,"nodes"),o.Factory.addGetterSetter(T,"boundBoxFunc"),o.Factory.addGetterSetter(T,"shouldOverdrawWholeArea",!1),o.Factory.backCompat(T,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),i.Collection.mapMethods(T)},d4f4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=(0,r.withParams)({type:"required"},(function(t){return"string"===typeof t?(0,r.req)(t.trim()):(0,r.req)(t)}));e.default=a},d521:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n){const a=(e-t)/(n-1),i=r["util"].makeZerosTypedArray(n,"float32");i[0]=t;for(let r=1;r<i.length;r++)i[r]=i[r-1]+a;return i}},d579:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e){const n=Object(i["a"])(t,"real","complex"),s=Object(i["a"])(e,"imag","complex");o["e"](n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const u={real:n,imag:s};return r["a"].runKernel(a["A"],u)}const c=Object(s["b"])({complex_:u})},d58a:function(t,e,n){},d598:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a){const i=r["util"].getArrayFromDType(n,r["util"].sizeFromShape(e));if(a&&"string"!==n){let e=0;t.forEach(t=>{const n=r["util"].sizeFromShape(t.shape);i.set(t.vals,e),e+=n})}else{let a=0;t.forEach(t=>{const o="string"===n?r["backend_util"].fromUint8ToStringArray(t.vals):t.vals;let s=0;for(let n=0;n<t.shape[0];++n){const r=n*e[1]+a;for(let e=0;e<t.shape[1];++e)i[r+e]=o[s++]}a+=t.shape[1]})}return i}},d5f8:function(t,e,n){"use strict";n("ad52")},d612:function(t,e,n){var r=n("7b83"),a=n("7ed2"),i=n("dc0f");function o(t){var e=-1,n=null==t?0:t.length;this.__data__=new r;while(++e<n)this.add(t[e])}o.prototype.add=o.prototype.push=a,o.prototype.has=i,t.exports=o},d76f:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e){const n=Object(i["a"])(t,"x","prelu"),o=Object(i["a"])(e,"alpha","prelu"),s={x:n,alpha:o};return r["a"].runKernel(a["lc"],s)}const u=Object(o["b"])({prelu_:s})},d777:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e._NODES_REGISTRY=e.Konva=e.glob=e._parseUA=void 0;var n=Math.PI/180;function r(){return"undefined"!==typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window))}var a=function(t){var e=t.indexOf("msie ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);var n=t.indexOf("trident/");if(n>0){var r=t.indexOf("rv:");return parseInt(t.substring(r+3,t.indexOf(".",r)),10)}var a=t.indexOf("edge/");return a>0&&parseInt(t.substring(a+5,t.indexOf(".",a)),10)},i=function(t){var e=t.toLowerCase(),n=/(chrome)[ /]([\w.]+)/.exec(e)||/(webkit)[ /]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[],r=!!t.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),i=!!t.match(/IEMobile/i);return{browser:n[1]||"",version:n[2]||"0",isIE:a(e),mobile:r,ieMobile:i}};e._parseUA=i,e.glob="undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof WorkerGlobalScope?self:{},e.Konva={_global:e.glob,version:"7.2.5",isBrowser:r(),isUnminified:/param/.test(function(t){}.toString()),dblClickWindow:400,getAngle:function(t){return e.Konva.angleDeg?t*n:t},enableTrace:!1,_pointerEventsEnabled:!1,hitOnDragEnabled:!1,captureTouchEventsEnabled:!1,listenClickTap:!1,inDblClickWindow:!1,pixelRatio:void 0,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:function(){return e.Konva["DD"].isDragging},isDragReady:function(){return!!e.Konva["DD"].node},UA:e._parseUA(e.glob.navigator&&e.glob.navigator.userAgent||""),document:e.glob.document,_injectGlobal:function(t){e.glob.Konva=t},_parseUA:e._parseUA},e._NODES_REGISTRY={};var o=function(t){e._NODES_REGISTRY[t.prototype.getClassName()]=t,e.Konva[t.prototype.getClassName()]=t};e._registerNode=o}).call(this,n("c8ba"))},d7b7:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","sinh"),n={x:e};return r["a"].runKernel(a["Lc"],n)}const u=Object(o["b"])({sinh_:s})},d9a8:function(t,e){function n(t){return t!==t}t.exports=n},d9f3:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t<e?1:0),s=Object(i["a"])(r["Less"],o,null,"bool"),u={kernelName:r["Less"],backendName:"cpu",kernelFunc:s}},d9fd:function(t,e,n){"use strict";n("8c15")},da03:function(t,e,n){var r=n("2b3e"),a=r["__core-js_shared__"];t.exports=a},da04:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=e.Label=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("f35c"),u=n("4546"),c=n("d777"),l=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height"],d="Change.konva",h="none",p="up",f="right",m="down",g="left",b=l.length,y=function(t){function e(e){var n=t.call(this,e)||this;return n.on("add.konva",(function(t){this._addListeners(t.child),this._sync()})),n}return r(e,t),e.prototype.getText=function(){return this.find("Text")[0]},e.prototype.getTag=function(){return this.find("Tag")[0]},e.prototype._addListeners=function(t){var e,n=this,r=function(){n._sync()};for(e=0;e<b;e++)t.on(l[e]+d,r)},e.prototype.getWidth=function(){return this.getText().width()},e.prototype.getHeight=function(){return this.getText().height()},e.prototype._sync=function(){var t,e,n,r,a,i,o,s=this.getText(),u=this.getTag();if(s&&u){switch(t=s.width(),e=s.height(),n=u.pointerDirection(),r=u.pointerWidth(),o=u.pointerHeight(),a=0,i=0,n){case p:a=t/2,i=-1*o;break;case f:a=t+r,i=e/2;break;case m:a=t/2,i=e+o;break;case g:a=-1*r,i=e/2;break}u.setAttrs({x:-1*a,y:-1*i,width:t,height:e}),s.setAttrs({x:-1*a,y:-1*i})}},e}(s.Group);e.Label=y,y.prototype.className="Label",c._registerNode(y),a.Collection.mapMethods(y);var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.width(),n=this.height(),r=this.pointerDirection(),a=this.pointerWidth(),i=this.pointerHeight(),o=this.cornerRadius(),s=0,u=0,c=0,l=0;"number"===typeof o?s=u=c=l=Math.min(o,e/2,n/2):(s=Math.min(o[0]||0,e/2,n/2),u=Math.min(o[1]||0,e/2,n/2),l=Math.min(o[2]||0,e/2,n/2),c=Math.min(o[3]||0,e/2,n/2)),t.beginPath(),t.moveTo(s,0),r===p&&(t.lineTo((e-a)/2,0),t.lineTo(e/2,-1*i),t.lineTo((e+a)/2,0)),t.lineTo(e-u,0),t.arc(e-u,u,u,3*Math.PI/2,0,!1),r===f&&(t.lineTo(e,(n-i)/2),t.lineTo(e+a,n/2),t.lineTo(e,(n+i)/2)),t.lineTo(e,n-l),t.arc(e-l,n-l,l,0,Math.PI/2,!1),r===m&&(t.lineTo((e+a)/2,n),t.lineTo(e/2,n+i),t.lineTo((e-a)/2,n)),t.lineTo(c,n),t.arc(c,n-c,c,Math.PI/2,Math.PI,!1),r===g&&(t.lineTo(0,(n+i)/2),t.lineTo(-1*a,n/2),t.lineTo(0,(n-i)/2)),t.lineTo(0,s),t.arc(s,s,s,Math.PI,3*Math.PI/2,!1),t.closePath(),t.fillStrokeShape(this)},e.prototype.getSelfRect=function(){var t=0,e=0,n=this.pointerWidth(),r=this.pointerHeight(),a=this.pointerDirection(),i=this.width(),o=this.height();return a===p?(e-=r,o+=r):a===m?o+=r:a===g?(t-=1.5*n,i+=n):a===f&&(i+=1.5*n),{x:t,y:e,width:i,height:o}},e}(o.Shape);e.Tag=v,v.prototype.className="Tag",c._registerNode(v),i.Factory.addGetterSetter(v,"pointerDirection",h),i.Factory.addGetterSetter(v,"pointerWidth",0,u.getNumberValidator()),i.Factory.addGetterSetter(v,"pointerHeight",0,u.getNumberValidator()),i.Factory.addGetterSetter(v,"cornerRadius",0,u.getNumberOrArrayOfNumbersValidator(4)),a.Collection.mapMethods(v)},da1c:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i,o,s,u,c,l){const d=[a/i,i],h=t.values,p=e.values;if(0===a)return Object(r["buffer"])(n,e.dtype);const f=Object(r["buffer"])(d,e.dtype);"string"===typeof c||"number"===typeof c?f.values.fill(c):"boolean"===typeof c&&f.values.fill(+c);for(let r=0;r<o;r++){const t=[];let o=0;for(let e=0;e<s;e++){const n=h[r*s+e];t.push(n),o+=n*u[e]}if(o<0||o>=a/i)throw new Error(`Invalid indices: ${t} does not index into ${n}`);for(let n=0;n<i;n++)l?f.values[o*i+n]+=p[r*i+n]:f.values[o*i+n]=0===e.rank?p[0]:p[r*i+n]}return f}},da5a:function(t,e){t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(I){}function r(t,e,n){this.low=0|t,this.high=0|e,this.unsigned=!!n}function a(t){return!0===(t&&t["__isLong__"])}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=a;var i={},o={};function s(t,e){var n,r,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(r=o[t],r)?r:(n=c(t,(0|t)<0?-1:0,!0),a&&(o[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(r=i[t],r)?r:(n=c(t,t<0?-1:0,!1),a&&(i[t]=n),n))}function u(t,e){if(isNaN(t))return e?x:v;if(e){if(t<0)return x;if(t>=g)return _}else{if(t<=-b)return C;if(t+1>=b)return O}return t<0?u(-t,e).neg():c(t%m|0,t/m|0,e)}function c(t,e,n){return new r(t,e,n)}r.fromInt=s,r.fromNumber=u,r.fromBits=c;var l=Math.pow;function d(t,e,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v;if("number"===typeof e?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return d(t.substring(1),e,n).neg();for(var a=u(l(n,8)),i=v,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),c=parseInt(t.substring(o,o+s),n);if(s<8){var h=u(l(n,s));i=i.mul(h).add(u(c))}else i=i.mul(a),i=i.add(u(c))}return i.unsigned=e,i}function h(t,e){return"number"===typeof t?u(t,e):"string"===typeof t?d(t,e):c(t.low,t.high,"boolean"===typeof e?e:t.unsigned)}r.fromString=d,r.fromValue=h;var p=65536,f=1<<24,m=p*p,g=m*m,b=g/2,y=s(f),v=s(0);r.ZERO=v;var x=s(0,!0);r.UZERO=x;var w=s(1);r.ONE=w;var k=s(1,!0);r.UONE=k;var S=s(-1);r.NEG_ONE=S;var O=c(-1,2147483647,!1);r.MAX_VALUE=O;var _=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var C=c(0,-2147483648,!1);r.MIN_VALUE=C;var T=r.prototype;T.toInt=function(){return this.unsigned?this.low>>>0:this.low},T.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},T.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(C)){var e=u(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}return"-"+this.neg().toString(t)}var a=u(l(t,6),this.unsigned),i=this,o="";while(1){var s=i.div(a),c=i.sub(s.mul(a)).toInt()>>>0,d=c.toString(t);if(i=s,i.isZero())return d+o;while(d.length<6)d="0"+d;o=""+d+o}},T.getHighBits=function(){return this.high},T.getHighBitsUnsigned=function(){return this.high>>>0},T.getLowBits=function(){return this.low},T.getLowBitsUnsigned=function(){return this.low>>>0},T.getNumBitsAbs=function(){if(this.isNegative())return this.eq(C)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0;e--)if(0!=(t&1<<e))break;return 0!=this.high?e+33:e+1},T.isZero=function(){return 0===this.high&&0===this.low},T.eqz=T.isZero,T.isNegative=function(){return!this.unsigned&&this.high<0},T.isPositive=function(){return this.unsigned||this.high>=0},T.isOdd=function(){return 1===(1&this.low)},T.isEven=function(){return 0===(1&this.low)},T.equals=function(t){return a(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!==1||t.high>>>31!==1)&&(this.high===t.high&&this.low===t.low)},T.eq=T.equals,T.notEquals=function(t){return!this.eq(t)},T.neq=T.notEquals,T.ne=T.notEquals,T.lessThan=function(t){return this.comp(t)<0},T.lt=T.lessThan,T.lessThanOrEqual=function(t){return this.comp(t)<=0},T.lte=T.lessThanOrEqual,T.le=T.lessThanOrEqual,T.greaterThan=function(t){return this.comp(t)>0},T.gt=T.greaterThan,T.greaterThanOrEqual=function(t){return this.comp(t)>=0},T.gte=T.greaterThanOrEqual,T.ge=T.greaterThanOrEqual,T.compare=function(t){if(a(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},T.comp=T.compare,T.negate=function(){return!this.unsigned&&this.eq(C)?C:this.not().add(w)},T.neg=T.negate,T.add=function(t){a(t)||(t=h(t));var e=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=t.high>>>16,s=65535&t.high,u=t.low>>>16,l=65535&t.low,d=0,p=0,f=0,m=0;return m+=i+l,f+=m>>>16,m&=65535,f+=r+u,p+=f>>>16,f&=65535,p+=n+s,d+=p>>>16,p&=65535,d+=e+o,d&=65535,c(f<<16|m,d<<16|p,this.unsigned)},T.subtract=function(t){return a(t)||(t=h(t)),this.add(t.neg())},T.sub=T.subtract,T.multiply=function(t){if(this.isZero())return v;if(a(t)||(t=h(t)),n){var e=n.mul(this.low,this.high,t.low,t.high);return c(e,n.get_high(),this.unsigned)}if(t.isZero())return v;if(this.eq(C))return t.isOdd()?C:v;if(t.eq(C))return this.isOdd()?C:v;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(y)&&t.lt(y))return u(this.toNumber()*t.toNumber(),this.unsigned);var r=this.high>>>16,i=65535&this.high,o=this.low>>>16,s=65535&this.low,l=t.high>>>16,d=65535&t.high,p=t.low>>>16,f=65535&t.low,m=0,g=0,b=0,x=0;return x+=s*f,b+=x>>>16,x&=65535,b+=o*f,g+=b>>>16,b&=65535,b+=s*p,g+=b>>>16,b&=65535,g+=i*f,m+=g>>>16,g&=65535,g+=o*p,m+=g>>>16,g&=65535,g+=s*d,m+=g>>>16,g&=65535,m+=r*f+i*p+o*d+s*l,m&=65535,c(b<<16|x,m<<16|g,this.unsigned)},T.mul=T.multiply,T.divide=function(t){if(a(t)||(t=h(t)),t.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&-2147483648===this.high&&-1===t.low&&-1===t.high)return this;var e=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,t.low,t.high);return c(e,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?x:v;var r,i,o;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return x;if(t.gt(this.shru(1)))return k;o=x}else{if(this.eq(C)){if(t.eq(w)||t.eq(S))return C;if(t.eq(C))return w;var s=this.shr(1);return r=s.div(t).shl(1),r.eq(v)?t.isNegative()?w:S:(i=this.sub(t.mul(r)),o=r.add(i.div(t)),o)}if(t.eq(C))return this.unsigned?x:v;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=v}i=this;while(i.gte(t)){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));var d=Math.ceil(Math.log(r)/Math.LN2),p=d<=48?1:l(2,d-48),f=u(r),m=f.mul(t);while(m.isNegative()||m.gt(i))r-=p,f=u(r,this.unsigned),m=f.mul(t);f.isZero()&&(f=w),o=o.add(f),i=i.sub(m)}return o},T.div=T.divide,T.modulo=function(t){if(a(t)||(t=h(t)),n){var e=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,t.low,t.high);return c(e,n.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},T.mod=T.modulo,T.rem=T.modulo,T.not=function(){return c(~this.low,~this.high,this.unsigned)},T.and=function(t){return a(t)||(t=h(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},T.or=function(t){return a(t)||(t=h(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},T.xor=function(t){return a(t)||(t=h(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},T.shiftLeft=function(t){return a(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},T.shl=T.shiftLeft,T.shiftRight=function(t){return a(t)&&(t=t.toInt()),0===(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},T.shr=T.shiftRight,T.shiftRightUnsigned=function(t){if(a(t)&&(t=t.toInt()),t&=63,0===t)return this;var e=this.high;if(t<32){var n=this.low;return c(n>>>t|e<<32-t,e>>>t,this.unsigned)}return c(32===t?e:e>>>t-32,0,this.unsigned)},T.shru=T.shiftRightUnsigned,T.shr_u=T.shiftRightUnsigned,T.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},T.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},T.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},T.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},T.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},r.fromBytes=function(t,e,n){return n?r.fromBytesLE(t,e):r.fromBytesBE(t,e)},r.fromBytesLE=function(t,e){return new r(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},r.fromBytesBE=function(t,e){return new r(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},db1a:function(t,e,n){var r=n("50d8"),a=n("13040"),i=n("4b17"),o=9007199254740991,s=4294967295,u=Math.min;function c(t,e){if(t=i(t),t<1||t>o)return[];var n=s,c=u(t,s);e=a(e),t-=s;var l=r(c,e);while(++n<t)e(n);return l}t.exports=c},dbbe:function(t,e,n){},dc0f:function(t,e){function n(t){return this.__data__.has(t)}t.exports=n},dc14:function(t,e,n){"use strict";(function(e,r){var a=n("966d");function i(t){var e=this;this.next=null,this.entry=null,this.finish=function(){M(e,t)}}t.exports=v;var o,s=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?setImmediate:a.nextTick;v.WritableState=y;var u=Object.create(n("3a7c"));u.inherits=n("3fb5");var c={deprecate:n("b7d1")},l=n("429b"),d=n("8707").Buffer,h=("undefined"!==typeof r?r:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};function p(t){return d.from(t)}function f(t){return d.isBuffer(t)||t instanceof h}var m,g=n("4681");function b(){}function y(t,e){o=o||n("b19a"),t=t||{};var r=e instanceof o;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var a=t.highWaterMark,s=t.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=a||0===a?a:r&&(s||0===s)?s:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var c=!1===t.decodeStrings;this.decodeStrings=!c,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){T(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function v(t){if(o=o||n("b19a"),!m.call(v,this)&&!(this instanceof o))return new v(t);this._writableState=new y(t,this),this.writable=!0,t&&("function"===typeof t.write&&(this._write=t.write),"function"===typeof t.writev&&(this._writev=t.writev),"function"===typeof t.destroy&&(this._destroy=t.destroy),"function"===typeof t.final&&(this._final=t.final)),l.call(this)}function x(t,e){var n=new Error("write after end");t.emit("error",n),a.nextTick(e,n)}function w(t,e,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"===typeof n||void 0===n||e.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),a.nextTick(r,o),i=!1),i}function k(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!==typeof e||(e=d.from(e,n)),e}function S(t,e,n,r,a,i){if(!n){var o=k(e,r,a);r!==o&&(n=!0,a="buffer",r=o)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:a,isBuf:n,callback:i,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else O(t,e,!1,s,r,a,i);return u}function O(t,e,n,r,a,i,o){e.writelen=r,e.writecb=o,e.writing=!0,e.sync=!0,n?t._writev(a,e.onwrite):t._write(a,i,e.onwrite),e.sync=!1}function _(t,e,n,r,i){--e.pendingcb,n?(a.nextTick(i,r),a.nextTick(D,t,e),t._writableState.errorEmitted=!0,t.emit("error",r)):(i(r),t._writableState.errorEmitted=!0,t.emit("error",r),D(t,e))}function C(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function T(t,e){var n=t._writableState,r=n.sync,a=n.writecb;if(C(n),e)_(t,n,r,e,a);else{var i=A(n);i||n.corked||n.bufferProcessing||!n.bufferedRequest||E(t,n),r?s(I,t,n,i,a):I(t,n,i,a)}}function I(t,e,n,r){n||N(t,e),e.pendingcb--,r(),D(t,e)}function N(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function E(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,a=new Array(r),o=e.corkedRequestsFree;o.entry=n;var s=0,u=!0;while(n)a[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;a.allBuffers=u,O(t,e,!0,e.length,a,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new i(e),e.bufferedRequestCount=0}else{while(n){var c=n.chunk,l=n.encoding,d=n.callback,h=e.objectMode?1:c.length;if(O(t,e,!1,h,c,l,d),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function A(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function R(t,e){t._final((function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),D(t,e)}))}function j(t,e){e.prefinished||e.finalCalled||("function"===typeof t._final?(e.pendingcb++,e.finalCalled=!0,a.nextTick(R,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function D(t,e){var n=A(e);return n&&(j(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),n}function F(t,e,n){e.ending=!0,D(t,e),n&&(e.finished?a.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}function M(t,e,n){var r=t.entry;t.entry=null;while(r){var a=r.callback;e.pendingcb--,a(n),r=r.next}e.corkedRequestsFree.next=t}u.inherits(v,l),y.prototype.getBuffer=function(){var t=this.bufferedRequest,e=[];while(t)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(y.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(m=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(t){return!!m.call(this,t)||this===v&&(t&&t._writableState instanceof y)}})):m=function(t){return t instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(t,e,n){var r=this._writableState,a=!1,i=!r.objectMode&&f(t);return i&&!d.isBuffer(t)&&(t=p(t)),"function"===typeof e&&(n=e,e=null),i?e="buffer":e||(e=r.defaultEncoding),"function"!==typeof n&&(n=b),r.ended?x(this,n):(i||w(this,r,t,n))&&(r.pendingcb++,a=S(this,r,i,t,e,n)),a},v.prototype.cork=function(){var t=this._writableState;t.corked++},v.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||E(this,t))},v.prototype.setDefaultEncoding=function(t){if("string"===typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(t,e,n){var r=this._writableState;"function"===typeof t?(n=t,t=null,e=null):"function"===typeof e&&(n=e,e=null),null!==t&&void 0!==t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||F(this,r,n)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),v.prototype.destroy=g.destroy,v.prototype._undestroy=g.undestroy,v.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n("4362"),n("c8ba"))},dc57:function(t,e){var n=Function.prototype,r=n.toString;function a(t){if(null!=t){try{return r.call(t)}catch(e){}try{return t+""}catch(e){}}return""}t.exports=a},dc7c:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},dcbe:function(t,e,n){var r=n("30c9"),a=n("1310");function i(t){return a(t)&&r(t)}t.exports=i},dd61:function(t,e,n){var r=n("7948"),a=n("badf"),i=n("97d3"),o=n("6747");function s(t,e){var n=o(t)?r:i;return n(t,a(e,3))}t.exports=s},ddf3:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const a=Object(r["buffer"])(n,t.dtype);for(let r=0;r<a.values.length;++r){const e=a.indexToLoc(r),n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=e[r]%t.shape[r];const i=t.locToIndex(n);a.values[r]=t.values[i]}return a}},de19:function(t,e,n){},df00:function(t,e,n){"use strict";
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function r(t){let e=t.length,n=0;while(e>0)n=Math.random()*e|0,e--,s(t,e,n)}function a(t,e){if(t.length!==e.length)throw new Error("Array sizes must match to be shuffled together First array length was "+t.length+"Second array length was "+e.length);let n=t.length,r=0;while(n>0)r=Math.random()*n|0,n--,s(t,n,r),s(e,n,r)}function i(t,e,n){return Math.max(t,Math.min(e,n))}function o(t){return t%2===0?t:t+1}function s(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function u(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function c(t,e){const n=Math.random();return e*n+(1-n)*t}function l(t,e){let n=0;for(let r=0;r<t.length;r++){const a=Number(t[r])-Number(e[r]);n+=a*a}return n}function d(t,e){if(!t)throw new Error("string"===typeof e?e:e())}function h(t,e,n=""){d(b(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function p(t){d(null!=t,()=>"The input to the tensor constructor must be a non-null value.")}function f(t,e=[],n=!1){if(null==e&&(e=[]),Array.isArray(t)||R(t)&&!n)for(let r=0;r<t.length;++r)f(t[r],e,n);else e.push(t);return e}function m(t){if(0===t.length)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function g(t){return 0===t.length}function b(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function y(t){return t%1===0}function v(t){if(null!=Math.tanh)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function x(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function w(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return r(e),e}function k(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function S(t,e=(t=>0),n,r=setTimeout){return new Promise((a,i)=>{let o=0;const s=()=>{if(t())return void a();o++;const u=e(o);null!=n&&o>=n?i():r(s,u)};s()})}function O(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(-1===t[i]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(-1===r){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(0===n)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[r]=e/n,a}function _(t,e){const n=e.length;return t=null==t?e.map((t,e)=>e):[].concat(t),d(t.every(t=>t>=-n&&t<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis `+t),d(t.every(t=>y(t)),()=>"All values in axis param must be integers but got axis "+t),t.map(t=>t<0?n+t:t)}function C(t,e){const n=[],r=[],a=null!=e&&Array.isArray(e)&&0===e.length,i=null==e||a?null:_(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(null!=i){if(i[o]===s&&1!==t[s])throw new Error(`Can't squeeze axis ${s} since its dim '${t[s]}' is not 1`);(null==i[o]||i[o]>s)&&1===t[s]&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}1!==t[s]&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function T(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else{if("bool"!==t)throw new Error("Unknown data type "+t);n=new Uint8Array(e)}return n}function I(t,e){let n=null;if(null==t||"float32"===t)n=new Float32Array(e);else if("int32"===t)n=new Int32Array(e);else if("bool"===t)n=new Uint8Array(e);else{if("string"!==t)throw new Error("Unknown data type "+t);n=new Array(e)}return n}function N(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function E(t){return"bool"===t||"complex64"===t||"float32"===t||"int32"===t||"string"===t}function A(t,e){return"complex64"!==e&&(("float32"!==e||"complex64"===t)&&(("int32"!==e||"float32"===t||"complex64"===t)&&("bool"!==e||"bool"!==t)))}function R(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function j(t){if("float32"===t||"int32"===t)return 4;if("complex64"===t)return 8;if("bool"===t)return 1;throw new Error("Unknown dtype "+t)}function D(t){if(null==t)return 0;let e=0;return t.forEach(t=>e+=t.length),e}function F(t){return"string"===typeof t||t instanceof String}function M(t){return"boolean"===typeof t}function P(t){return"number"===typeof t}function $(t){return Array.isArray(t)?$(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":P(t)?"float32":F(t)?"string":M(t)?"bool":"float32"}function L(t){return!!(t&&t.constructor&&t.call&&t.apply)}function B(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function z(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function W(t,e,n,r=!1){const a=new Array;if(1===e.length){const i=e[0]*(r?2:1);for(let e=0;e<i;e++)a[e]=n[t+e]}else{const i=e[0],o=e.slice(1),s=o.reduce((t,e)=>t*e)*(r?2:1);for(let e=0;e<i;e++)a[e]=W(t+e*s,o,n,r)}return a}function V(t,e,n=!1){if(0===t.length)return e[0];const r=t.reduce((t,e)=>t*e)*(n?2:1);if(0===r)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return W(0,t,e,n)}function U(t,e){const n=G(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function G(t,e){if(null==e||"float32"===e||"complex64"===e)return new Float32Array(t);if("int32"===e)return new Int32Array(t);if("bool"===e)return new Uint8Array(t);throw new Error("Unknown data type "+e)}function H(t,e){const n=t.reduce((t,e)=>t*e,1);if(null==e||"float32"===e)return V(t,new Float32Array(n));if("int32"===e)return V(t,new Int32Array(n));if("bool"===e)return V(t,new Uint8Array(n));throw new Error("Unknown data type "+e)}function q(t){t.forEach(e=>{d(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function K(t,e,n){if(0===e)return 0;if(1===e)return t[0];let r=t[t.length-1];for(let a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function X(t,e,n){if(0===e)return[];if(1===e)return[t];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function Y(t){return t&&t.then&&"function"===typeof t.then}n.d(e,"M",(function(){return r})),n.d(e,"N",(function(){return a})),n.d(e,"i",(function(){return i})),n.d(e,"H",(function(){return o})),n.d(e,"S",(function(){return s})),n.d(e,"R",(function(){return u})),n.d(e,"J",(function(){return c})),n.d(e,"l",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return p})),n.d(e,"m",(function(){return f})),n.d(e,"O",(function(){return m})),n.d(e,"y",(function(){return g})),n.d(e,"a",(function(){return b})),n.d(e,"v",(function(){return y})),n.d(e,"T",(function(){return v})),n.d(e,"P",(function(){return x})),n.d(e,"k",(function(){return w})),n.d(e,"L",(function(){return k})),n.d(e,"K",(function(){return S})),n.d(e,"s",(function(){return O})),n.d(e,"I",(function(){return _})),n.d(e,"Q",(function(){return C})),n.d(e,"o",(function(){return T})),n.d(e,"n",(function(){return I})),n.d(e,"h",(function(){return N})),n.d(e,"B",(function(){return E})),n.d(e,"p",(function(){return A})),n.d(e,"A",(function(){return R})),n.d(e,"g",(function(){return j})),n.d(e,"f",(function(){return D})),n.d(e,"z",(function(){return F})),n.d(e,"t",(function(){return M})),n.d(e,"w",(function(){return P})),n.d(e,"r",(function(){return $})),n.d(e,"u",(function(){return L})),n.d(e,"G",(function(){return B})),n.d(e,"j",(function(){return z})),n.d(e,"U",(function(){return V})),n.d(e,"D",(function(){return U})),n.d(e,"F",(function(){return G})),n.d(e,"E",(function(){return H})),n.d(e,"c",(function(){return q})),n.d(e,"C",(function(){return K})),n.d(e,"q",(function(){return X})),n.d(e,"x",(function(){return Y}))},df3a:function(t,e,n){"use strict";(function(t){n("219b");var e=n("86ab"),r=n("32fe");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const a=Object(r["c"])();a.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),a.registerFlag("IS_BROWSER",()=>e["isBrowser"]()),a.registerFlag("IS_NODE",()=>"undefined"!==typeof t&&"undefined"!==typeof t.versions&&"undefined"!==typeof t.versions.node),a.registerFlag("IS_CHROME",()=>"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),a.registerFlag("PROD",()=>!1),a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>a.getBool("DEBUG")),a.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),a.registerFlag("IS_TEST",()=>!1),a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),a.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),a.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),a.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),a.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1)}).call(this,n("4362"))},df47:function(t,e,n){"use strict";n("dbbe")},df7c:function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var a=t[r];"."===a?t.splice(r,1):".."===a?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t){"string"!==typeof t&&(t+="");var e,n=0,r=-1,a=!0;for(e=t.length-1;e>=0;--e)if(47===t.charCodeAt(e)){if(!a){n=e+1;break}}else-1===r&&(a=!1,r=e+1);return-1===r?"":t.slice(n,r)}function a(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var o=i>=0?arguments[i]:t.cwd();if("string"!==typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(e=o+"/"+e,r="/"===o.charAt(0))}return e=n(a(e.split("/"),(function(t){return!!t})),!r).join("/"),(r?"/":"")+e||"."},e.normalize=function(t){var r=e.isAbsolute(t),o="/"===i(t,-1);return t=n(a(t.split("/"),(function(t){return!!t})),!r).join("/"),t||r||(t="."),t&&o&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(a(t,(function(t,e){if("string"!==typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length;e++)if(""!==t[e])break;for(var n=t.length-1;n>=0;n--)if(""!==t[n])break;return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var a=r(t.split("/")),i=r(n.split("/")),o=Math.min(a.length,i.length),s=o,u=0;u<o;u++)if(a[u]!==i[u]){s=u;break}var c=[];for(u=s;u<a.length;u++)c.push("..");return c=c.concat(i.slice(s)),c.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){if("string"!==typeof t&&(t+=""),0===t.length)return".";for(var e=t.charCodeAt(0),n=47===e,r=-1,a=!0,i=t.length-1;i>=1;--i)if(e=t.charCodeAt(i),47===e){if(!a){r=i;break}}else a=!1;return-1===r?n?"/":".":n&&1===r?"/":t.slice(0,r)},e.basename=function(t,e){var n=r(t);return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){"string"!==typeof t&&(t+="");for(var e=-1,n=0,r=-1,a=!0,i=0,o=t.length-1;o>=0;--o){var s=t.charCodeAt(o);if(47!==s)-1===r&&(a=!1,r=o+1),46===s?-1===e?e=o:1!==i&&(i=1):-1!==e&&(i=-1);else if(!a){n=o+1;break}}return-1===e||-1===r||0===i||1===i&&e===r-1&&e===n+1?"":t.slice(e,r)};var i="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n("4362"))},df8d:function(t,e,n){"use strict";n("de19")},df93:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;var r=n("d777"),a=n("9cb8");e.DD={get isDragging(){var t=!1;return e.DD._dragElements.forEach((function(e){"dragging"===e.dragStatus&&(t=!0)})),t},justDragged:!1,get node(){var t;return e.DD._dragElements.forEach((function(e){t=e.node})),t},_dragElements:new Map,_drag:function(t){var n=[];e.DD._dragElements.forEach((function(e,r){var i=e.node,o=i.getStage();o.setPointersPositions(t),void 0===e.pointerId&&(e.pointerId=a.Util._getFirstPointerId(t));var s=o._changedPointerPositions.find((function(t){return t.id===e.pointerId}));if(s){if("dragging"!==e.dragStatus){var u=i.dragDistance(),c=Math.max(Math.abs(s.x-e.startPointerPos.x),Math.abs(s.y-e.startPointerPos.y));if(c<u)return;if(i.startDrag({evt:t}),!i.isDragging())return}i._setDragPosition(t,e),n.push(i)}})),n.forEach((function(e){e.fire("dragmove",{type:"dragmove",target:e,evt:t},!0)}))},_endDragBefore:function(t){e.DD._dragElements.forEach((function(n,a){var i=n.node,o=i.getStage();t&&o.setPointersPositions(t);var s=o._changedPointerPositions.find((function(t){return t.id===n.pointerId}));if(s){"dragging"!==n.dragStatus&&"stopped"!==n.dragStatus||(e.DD.justDragged=!0,r.Konva.listenClickTap=!1,n.dragStatus="stopped");var u=n.node.getLayer()||n.node instanceof r.Konva["Stage"]&&n.node;u&&u.batchDraw()}}))},_endDragAfter:function(t){e.DD._dragElements.forEach((function(n,r){"stopped"===n.dragStatus&&n.node.fire("dragend",{type:"dragend",target:n.node,evt:t},!0),"dragging"!==n.dragStatus&&e.DD._dragElements.delete(r)}))}},r.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1))},e09c:function(t,e){},e136:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("219b"),a=n("df00"),i=n("bb7b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function o(t,e,n,o){if(null==o&&(o=Object(a["r"])(t)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a["A"])(t)&&!Array.isArray(t)&&"number"!==typeof t&&"boolean"!==typeof t&&"string"!==typeof t)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=e){Object(a["c"])(e);const t=Object(a["O"])(e),r=Object(a["O"])(n);Object(a["b"])(t===r,()=>`Based on the provided shape, [${e}], the tensor should have ${t} values but has ${r}`);for(let i=0;i<n.length;++i){const t=n[i],r=i!==n.length-1||t!==Object(a["O"])(e.slice(i));Object(a["b"])(n[i]===e[i]||!r,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return Object(a["A"])(t)||Array.isArray(t)||(t=[t]),e=e||n,t="string"!==o?Object(i["toTypedArray"])(t,o):Object(a["m"])(t,[],!0),r["a"].makeTensor(t,e,o)}},e22c:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a){const i=Object(r["buffer"])(t,e.dtype);for(let r=0;r<i.size;r++){const t=i.indexToLoc(r),o=new Array(t.length);for(let e=0;e<o.length;e++)o[e]=t[e]*n[e]+a[e];i.set(e.get(...o),...t)}return i}},e24b:function(t,e,n){var r=n("49f4"),a=n("1efc"),i=n("bbc0"),o=n("7a48"),s=n("2524");function u(t){var e=-1,n=null==t?0:t.length;this.clear();while(++e<n){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype["delete"]=a,u.prototype.get=i,u.prototype.has=o,u.prototype.set=s,t.exports=u},e2c0:function(t,e,n){var r=n("e2e4"),a=n("d370"),i=n("6747"),o=n("c098"),s=n("b218"),u=n("f4d6");function c(t,e,n){e=r(e,t);var c=-1,l=e.length,d=!1;while(++c<l){var h=u(e[c]);if(!(d=null!=t&&n(t,h)))break;t=t[h]}return d||++c!=l?d:(l=null==t?0:t.length,!!l&&s(l)&&o(h,l)&&(i(t)||a(t)))}t.exports=c},e2e4:function(t,e,n){var r=n("6747"),a=n("f608"),i=n("18d8"),o=n("76dd");function s(t,e){return r(t)?t:a(t,e)?[t]:i(o(t))}t.exports=s},e372:function(t,e,n){e=t.exports=n("ad71"),e.Stream=e,e.Readable=e,e.Writable=n("dc14"),e.Duplex=n("b19a"),e.Transform=n("27bf"),e.PassThrough=n("780f")},e380:function(t,e,n){var r=n("7b83"),a="Expected a function";function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(a);var n=function(){var r=arguments,a=e?e.apply(this,r):r[0],i=n.cache;if(i.has(a))return i.get(a);var o=t.apply(this,r);return n.cache=i.set(a,o)||i,o};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},e3af:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Star=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("fce6"),s=n("4546"),u=n("d777"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._sceneFunc=function(t){var e=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();t.beginPath(),t.moveTo(0,0-n);for(var a=1;a<2*r;a++){var i=a%2===0?n:e,o=i*Math.sin(a*Math.PI/r),s=-1*i*Math.cos(a*Math.PI/r);t.lineTo(o,s)}t.closePath(),t.fillStrokeShape(this)},e.prototype.getWidth=function(){return 2*this.outerRadius()},e.prototype.getHeight=function(){return 2*this.outerRadius()},e.prototype.setWidth=function(t){this.outerRadius(t/2)},e.prototype.setHeight=function(t){this.outerRadius(t/2)},e}(o.Shape);e.Star=c,c.prototype.className="Star",c.prototype._centroid=!0,c.prototype._attrsAffectingSize=["innerRadius","outerRadius"],u._registerNode(c),i.Factory.addGetterSetter(c,"numPoints",5,s.getNumberValidator()),i.Factory.addGetterSetter(c,"innerRadius",0,s.getNumberValidator()),i.Factory.addGetterSetter(c,"outerRadius",0,s.getNumberValidator()),a.Collection.mapMethods(c)},e3db:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},e3df:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return u}));var r=n("2ca8"),a=n("c5c9"),i=n("75d3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const o=Object(a["a"])((t,e)=>t<=e?1:0),s=Object(i["a"])(r["LessEqual"],o,null,"bool"),u={kernelName:r["LessEqual"],backendName:"cpu",kernelFunc:s}},e3f8:function(t,e,n){var r=n("656b");function a(t){return function(e){return r(e,t)}}t.exports=a},e4b0:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Emboss=void 0;var r=n("f0b4"),a=n("4971"),i=n("9cb8"),o=n("4546"),s=function(t){var e=10*this.embossStrength(),n=255*this.embossWhiteLevel(),r=this.embossDirection(),a=this.embossBlend(),o=0,s=0,u=t.data,c=t.width,l=t.height,d=4*c,h=l;switch(r){case"top-left":o=-1,s=-1;break;case"top":o=-1,s=0;break;case"top-right":o=-1,s=1;break;case"right":o=0,s=1;break;case"bottom-right":o=1,s=1;break;case"bottom":o=1,s=0;break;case"bottom-left":o=1,s=-1;break;case"left":o=0,s=-1;break;default:i.Util.error("Unknown emboss direction: "+r)}do{var p=(h-1)*d,f=o;h+f<1&&(f=0),h+f>l&&(f=0);var m=(h-1+f)*c*4,g=c;do{var b=p+4*(g-1),y=s;g+y<1&&(y=0),g+y>c&&(y=0);var v=m+4*(g-1+y),x=u[b]-u[v],w=u[b+1]-u[v+1],k=u[b+2]-u[v+2],S=x,O=S>0?S:-S,_=w>0?w:-w,C=k>0?k:-k;if(_>O&&(S=w),C>O&&(S=k),S*=e,a){var T=u[b]+S,I=u[b+1]+S,N=u[b+2]+S;u[b]=T>255?255:T<0?0:T,u[b+1]=I>255?255:I<0?0:I,u[b+2]=N>255?255:N<0?0:N}else{var E=n-S;E<0?E=0:E>255&&(E=255),u[b]=u[b+1]=u[b+2]=E}}while(--g)}while(--h)};e.Emboss=s,r.Factory.addGetterSetter(a.Node,"embossStrength",.5,o.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"embossWhiteLevel",.5,o.getNumberValidator(),r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"embossDirection","top-left",null,r.Factory.afterSetFilter),r.Factory.addGetterSetter(a.Node,"embossBlend",!1,null,r.Factory.afterSetFilter)},e51a:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,r){if(!t.length)return;if(0===e.length){for(let e=0;e<t.length;++e)r.push(t.subarray(e,e+1));return}if(1===e.length){const a=e[0];let i=t.indexOf(a);while(-1!==i){const e=t.subarray(0,i);n&&0===e.length||r.push(e),t=t.subarray(i+1),i=t.indexOf(a)}return void(n&&0===t.length||r.push(t))}let a=0;for(let i=0;i<t.length+1;i++)if(i===t.length||-1!==e.indexOf(t[i])){const e=t.subarray(a,i);n&&0===e.length||r.push(e),a=i+1}}function i(t,e,n){const i=t.length,o=[];let s=0,u=0;const c=new Array(i);for(let r=0;r<i;++r){const i=o.length;a(t[r],e,n,o);const l=o.length-i;c[r]=l,s+=l,u=Math.max(u,l)}const l=r["util"].getArrayFromDType("int32",2*s),d=new Array(s),h=[i,u];let p=0;for(let r=0;r<i;++r)for(let t=0;t<c[r];++t)l[2*p]=r,l[2*p+1]=t,d[p]=o[p],++p;return[l,d,h]}},e538:function(t,e,n){(function(t){var r=n("2b3e"),a=e&&!e.nodeType&&e,i=a&&"object"==typeof t&&t&&!t.nodeType&&t,o=i&&i.exports===a,s=o?r.Buffer:void 0,u=s?s.allocUnsafe:void 0;function c(t,e){if(e)return t.slice();var n=t.length,r=u?u(n):new t.constructor(n);return t.copy(r),r}t.exports=c}).call(this,n("62e4")(t))},e652:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"requiredUnless",prop:t},(function(e,n){return!!(0,r.ref)(t,this,n)||(0,r.req)(e)}))};e.default=a},e65a:function(t,e,n){var r,a,i;(function(n,o){a=[t],r=o,i="function"===typeof r?r.apply(e,a):r,void 0===i||(t.exports=i)})(0,(function(t){"use strict";function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var a={order:2,precision:2,period:null};function i(t,e){var n=[],r=[];t.forEach((function(t,a){null!==t[1]&&(r.push(t),n.push(e[a]))}));var a=r.reduce((function(t,e){return t+e[1]}),0),i=a/r.length,o=r.reduce((function(t,e){var n=e[1]-i;return t+n*n}),0),s=r.reduce((function(t,e,r){var a=n[r],i=e[1]-a[1];return t+i*i}),0);return 1-s/o}function o(t,e){for(var n=t,r=t.length-1,a=[e],i=0;i<r;i++){for(var o=i,s=i+1;s<r;s++)Math.abs(n[i][s])>Math.abs(n[i][o])&&(o=s);for(var u=i;u<r+1;u++){var c=n[u][i];n[u][i]=n[u][o],n[u][o]=c}for(var l=i+1;l<r;l++)for(var d=r;d>=i;d--)n[d][l]-=n[d][i]*n[i][l]/n[i][i]}for(var h=r-1;h>=0;h--){for(var p=0,f=h+1;f<r;f++)p+=n[f][h]*a[f];a[h]=(n[r][h]-p)/n[h][h]}return a}function s(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}var u={linear:function(t,e){for(var n=[0,0,0,0,0],r=0,a=0;a<t.length;a++)null!==t[a][1]&&(r++,n[0]+=t[a][0],n[1]+=t[a][1],n[2]+=t[a][0]*t[a][0],n[3]+=t[a][0]*t[a][1],n[4]+=t[a][1]*t[a][1]);var o=r*n[2]-n[0]*n[0],u=r*n[3]-n[0]*n[1],c=0===o?0:s(u/o,e.precision),l=s(n[1]/r-c*n[0]/r,e.precision),d=function(t){return[s(t,e.precision),s(c*t+l,e.precision)]},h=t.map((function(t){return d(t[0])}));return{points:h,predict:d,equation:[c,l],r2:s(i(t,h),e.precision),string:0===l?"y = "+c+"x":"y = "+c+"x + "+l}},exponential:function(t,e){for(var n=[0,0,0,0,0,0],r=0;r<t.length;r++)null!==t[r][1]&&(n[0]+=t[r][0],n[1]+=t[r][1],n[2]+=t[r][0]*t[r][0]*t[r][1],n[3]+=t[r][1]*Math.log(t[r][1]),n[4]+=t[r][0]*t[r][1]*Math.log(t[r][1]),n[5]+=t[r][0]*t[r][1]);var a=n[1]*n[2]-n[5]*n[5],o=Math.exp((n[2]*n[3]-n[5]*n[4])/a),u=(n[1]*n[4]-n[5]*n[3])/a,c=s(o,e.precision),l=s(u,e.precision),d=function(t){return[s(t,e.precision),s(c*Math.exp(l*t),e.precision)]},h=t.map((function(t){return d(t[0])}));return{points:h,predict:d,equation:[c,l],string:"y = "+c+"e^("+l+"x)",r2:s(i(t,h),e.precision)}},logarithmic:function(t,e){for(var n=[0,0,0,0],r=t.length,a=0;a<r;a++)null!==t[a][1]&&(n[0]+=Math.log(t[a][0]),n[1]+=t[a][1]*Math.log(t[a][0]),n[2]+=t[a][1],n[3]+=Math.pow(Math.log(t[a][0]),2));var o=(r*n[1]-n[2]*n[0])/(r*n[3]-n[0]*n[0]),u=s(o,e.precision),c=s((n[2]-u*n[0])/r,e.precision),l=function(t){return[s(t,e.precision),s(s(c+u*Math.log(t),e.precision),e.precision)]},d=t.map((function(t){return l(t[0])}));return{points:d,predict:l,equation:[c,u],string:"y = "+c+" + "+u+" ln(x)",r2:s(i(t,d),e.precision)}},power:function(t,e){for(var n=[0,0,0,0,0],r=t.length,a=0;a<r;a++)null!==t[a][1]&&(n[0]+=Math.log(t[a][0]),n[1]+=Math.log(t[a][1])*Math.log(t[a][0]),n[2]+=Math.log(t[a][1]),n[3]+=Math.pow(Math.log(t[a][0]),2));var o=(r*n[1]-n[0]*n[2])/(r*n[3]-Math.pow(n[0],2)),u=(n[2]-o*n[0])/r,c=s(Math.exp(u),e.precision),l=s(o,e.precision),d=function(t){return[s(t,e.precision),s(s(c*Math.pow(t,l),e.precision),e.precision)]},h=t.map((function(t){return d(t[0])}));return{points:h,predict:d,equation:[c,l],string:"y = "+c+"x^"+l,r2:s(i(t,h),e.precision)}},polynomial:function(t,e){for(var n=[],a=[],u=0,c=0,l=t.length,d=e.order+1,h=0;h<d;h++){for(var p=0;p<l;p++)null!==t[p][1]&&(u+=Math.pow(t[p][0],h)*t[p][1]);n.push(u),u=0;for(var f=[],m=0;m<d;m++){for(var g=0;g<l;g++)null!==t[g][1]&&(c+=Math.pow(t[g][0],h+m));f.push(c),c=0}a.push(f)}a.push(n);for(var b=o(a,d).map((function(t){return s(t,e.precision)})),y=function(t){return[s(t,e.precision),s(b.reduce((function(e,n,r){return e+n*Math.pow(t,r)}),0),e.precision)]},v=t.map((function(t){return y(t[0])})),x="y = ",w=b.length-1;w>=0;w--)x+=w>1?b[w]+"x^"+w+" + ":1===w?b[w]+"x + ":b[w];return{string:x,points:v,predict:y,equation:[].concat(r(b)).reverse(),r2:s(i(t,v),e.precision)}}};function c(){var t=function(t,r){return n({_round:s},t,e({},r,(function(t,e){return u[r](t,n({},a,e))})))};return Object.keys(u).reduce(t,{})}t.exports=c()}))},e844:function(t,e,n){},e8a2:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i,o=!1,s=0){const u=a.length,c=[e[0],t.length/e[0]],l=c[1],d=u>0?i[u-1]+1:0,h=d;if(h<0)throw new Error(r["backend_util"].getSparseSegmentReductionNegativeSegmentIdsErrorMessage());const p=e.slice();p[0]=h;const f=p.reduce((t,e)=>t*e,1),m=r["util"].getArrayFromDType(n,f);if(0===u)return h>0&&m.fill(s),[m,p];if(h<=0)throw new Error(r["backend_util"].getSparseSegmentReductionNegativeSegmentIdsErrorMessage());let g=0,b=1,y=0,v=i[g];while(1){let e=0;if(b<u){if(e=i[b],v===e){++b;continue}if(v>=e)throw new Error(r["backend_util"].getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage())}if(v<0||v>=h)throw new Error(r["backend_util"].getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage(v,h));v>y&&m.fill(s,y*l,v*l);for(let n=g;n<b;++n){const e=a[n];if(e<0||e>=c[0])throw new Error(r["backend_util"].getSparseSegmentReductionIndicesOutOfRangeErrorMessage(n,a[n],c[0]));for(let n=0;n<l;n++)m[v*l+n]+=t[e*l+n]}if(o)for(let t=0;t<l;t++)m[v*l+t]/=b-g;if(g=b,++b,y=v+1,v=e,b>u)break}return y<h&&m.fill(s,y*l,h*l),[m,p]}},e929:function(t,e,n){"use strict";n.r(e),n.d(e,"GraphModel",(function(){return at})),n.d(e,"loadGraphModel",(function(){return it})),n.d(e,"loadGraphModelSync",(function(){return ot})),n.d(e,"deregisterOp",(function(){return c["a"]})),n.d(e,"registerOp",(function(){return c["c"]})),n.d(e,"version_converter",(function(){return ut}));var r={};n.r(r),n.d(r,"abs",(function(){return l["b"]})),n.d(r,"acos",(function(){return l["c"]})),n.d(r,"acosh",(function(){return l["d"]})),n.d(r,"add",(function(){return l["e"]})),n.d(r,"addN",(function(){return l["f"]})),n.d(r,"all",(function(){return l["g"]})),n.d(r,"any",(function(){return l["h"]})),n.d(r,"argMax",(function(){return l["i"]})),n.d(r,"argMin",(function(){return l["j"]})),n.d(r,"asin",(function(){return l["k"]})),n.d(r,"asinh",(function(){return l["l"]})),n.d(r,"atan",(function(){return l["m"]})),n.d(r,"atan2",(function(){return l["n"]})),n.d(r,"atanh",(function(){return l["o"]})),n.d(r,"avgPool",(function(){return l["p"]})),n.d(r,"avgPool3d",(function(){return l["q"]})),n.d(r,"basicLSTMCell",(function(){return l["r"]})),n.d(r,"batchToSpaceND",(function(){return l["w"]})),n.d(r,"batchNorm",(function(){return l["s"]})),n.d(r,"batchNorm2d",(function(){return l["t"]})),n.d(r,"batchNorm3d",(function(){return l["u"]})),n.d(r,"batchNorm4d",(function(){return l["v"]})),n.d(r,"bincount",(function(){return l["x"]})),n.d(r,"broadcastArgs",(function(){return l["z"]})),n.d(r,"broadcastTo",(function(){return l["A"]})),n.d(r,"buffer",(function(){return l["B"]})),n.d(r,"cast",(function(){return l["C"]})),n.d(r,"ceil",(function(){return l["D"]})),n.d(r,"clipByValue",(function(){return l["E"]})),n.d(r,"clone",(function(){return l["F"]})),n.d(r,"complex",(function(){return l["G"]})),n.d(r,"concat",(function(){return l["H"]})),n.d(r,"concat1d",(function(){return l["I"]})),n.d(r,"concat2d",(function(){return l["J"]})),n.d(r,"concat3d",(function(){return l["K"]})),n.d(r,"concat4d",(function(){return l["L"]})),n.d(r,"conv1d",(function(){return l["M"]})),n.d(r,"conv2d",(function(){return l["N"]})),n.d(r,"conv2dTranspose",(function(){return l["O"]})),n.d(r,"conv3d",(function(){return l["P"]})),n.d(r,"conv3dTranspose",(function(){return l["Q"]})),n.d(r,"cos",(function(){return l["R"]})),n.d(r,"cosh",(function(){return l["S"]})),n.d(r,"cumprod",(function(){return l["U"]})),n.d(r,"cumsum",(function(){return l["V"]})),n.d(r,"denseBincount",(function(){return l["W"]})),n.d(r,"depthToSpace",(function(){return l["X"]})),n.d(r,"depthwiseConv2d",(function(){return l["Y"]})),n.d(r,"diag",(function(){return l["Z"]})),n.d(r,"dilation2d",(function(){return l["ab"]})),n.d(r,"div",(function(){return l["bb"]})),n.d(r,"divNoNan",(function(){return l["cb"]})),n.d(r,"dot",(function(){return l["db"]})),n.d(r,"einsum",(function(){return l["fb"]})),n.d(r,"elu",(function(){return l["gb"]})),n.d(r,"equal",(function(){return l["ib"]})),n.d(r,"erf",(function(){return l["jb"]})),n.d(r,"euclideanNorm",(function(){return l["kb"]})),n.d(r,"exp",(function(){return l["lb"]})),n.d(r,"expandDims",(function(){return l["mb"]})),n.d(r,"expm1",(function(){return l["nb"]})),n.d(r,"eye",(function(){return l["ob"]})),n.d(r,"fill",(function(){return l["qb"]})),n.d(r,"floor",(function(){return l["rb"]})),n.d(r,"floorDiv",(function(){return l["sb"]})),n.d(r,"gather",(function(){return l["ub"]})),n.d(r,"greater",(function(){return l["wb"]})),n.d(r,"greaterEqual",(function(){return l["xb"]})),n.d(r,"imag",(function(){return l["zb"]})),n.d(r,"isFinite",(function(){return l["Db"]})),n.d(r,"isInf",(function(){return l["Eb"]})),n.d(r,"isNaN",(function(){return l["Fb"]})),n.d(r,"leakyRelu",(function(){return l["Gb"]})),n.d(r,"less",(function(){return l["Hb"]})),n.d(r,"lessEqual",(function(){return l["Ib"]})),n.d(r,"linspace",(function(){return l["Kb"]})),n.d(r,"localResponseNormalization",(function(){return l["Lb"]})),n.d(r,"log",(function(){return l["Mb"]})),n.d(r,"log1p",(function(){return l["Nb"]})),n.d(r,"logSigmoid",(function(){return l["Ob"]})),n.d(r,"logSoftmax",(function(){return l["Pb"]})),n.d(r,"logSumExp",(function(){return l["Qb"]})),n.d(r,"logicalAnd",(function(){return l["Rb"]})),n.d(r,"logicalNot",(function(){return l["Sb"]})),n.d(r,"logicalOr",(function(){return l["Tb"]})),n.d(r,"logicalXor",(function(){return l["Ub"]})),n.d(r,"lowerBound",(function(){return l["Wb"]})),n.d(r,"matMul",(function(){return l["Xb"]})),n.d(r,"max",(function(){return l["Yb"]})),n.d(r,"maxPool",(function(){return l["Zb"]})),n.d(r,"maxPool3d",(function(){return l["ac"]})),n.d(r,"maxPoolWithArgmax",(function(){return l["bc"]})),n.d(r,"maximum",(function(){return l["cc"]})),n.d(r,"mean",(function(){return l["dc"]})),n.d(r,"meshgrid",(function(){return l["ec"]})),n.d(r,"min",(function(){return l["fc"]})),n.d(r,"minimum",(function(){return l["gc"]})),n.d(r,"mirrorPad",(function(){return l["hc"]})),n.d(r,"mod",(function(){return l["ic"]})),n.d(r,"moments",(function(){return l["jc"]})),n.d(r,"mul",(function(){return l["lc"]})),n.d(r,"multiRNNCell",(function(){return l["mc"]})),n.d(r,"multinomial",(function(){return l["nc"]})),n.d(r,"neg",(function(){return l["oc"]})),n.d(r,"notEqual",(function(){return l["qc"]})),n.d(r,"oneHot",(function(){return l["rc"]})),n.d(r,"ones",(function(){return l["sc"]})),n.d(r,"onesLike",(function(){return l["tc"]})),n.d(r,"outerProduct",(function(){return l["vc"]})),n.d(r,"pad",(function(){return l["wc"]})),n.d(r,"pad1d",(function(){return l["xc"]})),n.d(r,"pad2d",(function(){return l["yc"]})),n.d(r,"pad3d",(function(){return l["zc"]})),n.d(r,"pad4d",(function(){return l["Ac"]})),n.d(r,"pool",(function(){return l["Bc"]})),n.d(r,"pow",(function(){return l["Cc"]})),n.d(r,"prelu",(function(){return l["Dc"]})),n.d(r,"print",(function(){return l["Ec"]})),n.d(r,"prod",(function(){return l["Fc"]})),n.d(r,"raggedGather",(function(){return l["Gc"]})),n.d(r,"raggedTensorToTensor",(function(){return l["Hc"]})),n.d(r,"rand",(function(){return l["Ic"]})),n.d(r,"randomGamma",(function(){return l["Jc"]})),n.d(r,"randomNormal",(function(){return l["Kc"]})),n.d(r,"randomStandardNormal",(function(){return l["Lc"]})),n.d(r,"randomUniform",(function(){return l["Mc"]})),n.d(r,"range",(function(){return l["Nc"]})),n.d(r,"real",(function(){return l["Oc"]})),n.d(r,"reciprocal",(function(){return l["Pc"]})),n.d(r,"relu",(function(){return l["Qc"]})),n.d(r,"relu6",(function(){return l["Rc"]})),n.d(r,"reshape",(function(){return l["Sc"]})),n.d(r,"reverse",(function(){return l["Tc"]})),n.d(r,"reverse1d",(function(){return l["Uc"]})),n.d(r,"reverse2d",(function(){return l["Vc"]})),n.d(r,"reverse3d",(function(){return l["Wc"]})),n.d(r,"reverse4d",(function(){return l["Xc"]})),n.d(r,"round",(function(){return l["Zc"]})),n.d(r,"rsqrt",(function(){return l["ad"]})),n.d(r,"scalar",(function(){return l["bd"]})),n.d(r,"selu",(function(){return l["ed"]})),n.d(r,"separableConv2d",(function(){return l["fd"]})),n.d(r,"setdiff1dAsync",(function(){return l["gd"]})),n.d(r,"sigmoid",(function(){return l["hd"]})),n.d(r,"sign",(function(){return l["id"]})),n.d(r,"sin",(function(){return l["kd"]})),n.d(r,"sinh",(function(){return l["ld"]})),n.d(r,"slice",(function(){return l["md"]})),n.d(r,"slice1d",(function(){return l["nd"]})),n.d(r,"slice2d",(function(){return l["od"]})),n.d(r,"slice3d",(function(){return l["pd"]})),n.d(r,"slice4d",(function(){return l["qd"]})),n.d(r,"softmax",(function(){return l["rd"]})),n.d(r,"softplus",(function(){return l["sd"]})),n.d(r,"spaceToBatchND",(function(){return l["td"]})),n.d(r,"fft",(function(){return l["pb"]})),n.d(r,"ifft",(function(){return l["yb"]})),n.d(r,"irfft",(function(){return l["Cb"]})),n.d(r,"rfft",(function(){return l["Yc"]})),n.d(r,"split",(function(){return l["xd"]})),n.d(r,"sqrt",(function(){return l["yd"]})),n.d(r,"square",(function(){return l["zd"]})),n.d(r,"squaredDifference",(function(){return l["Ad"]})),n.d(r,"squeeze",(function(){return l["Bd"]})),n.d(r,"stack",(function(){return l["Cd"]})),n.d(r,"step",(function(){return l["Dd"]})),n.d(r,"stridedSlice",(function(){return l["Ed"]})),n.d(r,"sub",(function(){return l["Gd"]})),n.d(r,"sum",(function(){return l["Hd"]})),n.d(r,"tan",(function(){return l["Id"]})),n.d(r,"tanh",(function(){return l["Jd"]})),n.d(r,"tensor",(function(){return l["Kd"]})),n.d(r,"tensor1d",(function(){return l["Ld"]})),n.d(r,"tensor2d",(function(){return l["Md"]})),n.d(r,"tensor3d",(function(){return l["Nd"]})),n.d(r,"tensor4d",(function(){return l["Od"]})),n.d(r,"tensor5d",(function(){return l["Pd"]})),n.d(r,"tensor6d",(function(){return l["Qd"]})),n.d(r,"tile",(function(){return l["Rd"]})),n.d(r,"topk",(function(){return l["Sd"]})),n.d(r,"truncatedNormal",(function(){return l["Ud"]})),n.d(r,"unique",(function(){return l["Vd"]})),n.d(r,"unsortedSegmentSum",(function(){return l["Wd"]})),n.d(r,"unstack",(function(){return l["Xd"]})),n.d(r,"upperBound",(function(){return l["Yd"]})),n.d(r,"variable",(function(){return l["Zd"]})),n.d(r,"where",(function(){return l["ae"]})),n.d(r,"whereAsync",(function(){return l["be"]})),n.d(r,"zeros",(function(){return l["ce"]})),n.d(r,"zerosLike",(function(){return l["de"]})),n.d(r,"booleanMaskAsync",(function(){return l["y"]})),n.d(r,"transpose",(function(){return l["Td"]})),n.d(r,"norm",(function(){return l["pc"]})),n.d(r,"movingAverage",(function(){return l["kc"]})),n.d(r,"scatterND",(function(){return l["cd"]})),n.d(r,"searchSorted",(function(){return l["dd"]})),n.d(r,"sparseToDense",(function(){return l["vd"]})),n.d(r,"gatherND",(function(){return l["vb"]})),n.d(r,"dropout",(function(){return l["eb"]})),n.d(r,"enclosingPowerOfTwo",(function(){return l["hb"]})),n.d(r,"cosineWindow",(function(){return l["T"]})),n.d(r,"inTopKAsync",(function(){return l["Bb"]})),n.d(r,"op",(function(){return l["uc"]})),n.d(r,"OP_SCOPE_SUFFIX",(function(){return l["a"]})),n.d(r,"image",(function(){return l["Ab"]})),n.d(r,"linalg",(function(){return l["Jb"]})),n.d(r,"losses",(function(){return l["Vb"]})),n.d(r,"spectral",(function(){return l["wd"]})),n.d(r,"fused",(function(){return l["tb"]})),n.d(r,"signal",(function(){return l["jd"]})),n.d(r,"sparse",(function(){return l["ud"]})),n.d(r,"string",(function(){return l["Fd"]}));var a=n("2ca8");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i=Object(a["env"])();i.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});var o=n("a6eb"),s=n("9140");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class u{constructor(t,e,n){this.node=t,this.tensorMap=e,this.context=n,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map(t=>this.getInput(t)),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((t,e)=>(t[e]=this.getAttr(e),t),{}))}getInput(t){return Object(s["e"])(t,this.tensorMap,this.context)}getAttr(t,e){const n=this.node.rawAttrs[t];if(null!=n.tensor)return Object(s["e"])(t,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(o["f"])(this.node.rawAttrs,t,e);if(null!=n.s)return Object(o["i"])(this.node.rawAttrs,t,e);if(null!=n.b)return Object(o["c"])(this.node.rawAttrs,t,e);if(null!=n.shape)return Object(o["k"])(this.node.rawAttrs,t,e);if(null!=n.type)return Object(o["e"])(this.node.rawAttrs,t,e);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(o["g"])(this.node.rawAttrs,t,e);if(null!=n.list.s)return Object(o["h"])(this.node.rawAttrs,t,e);if(null!=n.list.shape)return Object(o["j"])(this.node.rawAttrs,t,e);if(null!=n.list.b)return Object(o["b"])(this.node.rawAttrs,t,e);if(null!=n.list.type)return Object(o["d"])(this.node.rawAttrs,t,e)}return e}}var c=n("9489"),l=n("f562");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const d=(t,e,n,a=r)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[a.add(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"AddN":return[a.addN(Object(s["d"])("tensors",t,e,n))];case"FloorMod":case"Mod":return[a.mod(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Mul":return[a.mul(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"RealDiv":case"Div":return[a.div(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"DivNoNan":return[a.divNoNan(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"FloorDiv":return[a.floorDiv(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Sub":return[a.sub(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Minimum":return[a.minimum(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Maximum":return[a.maximum(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Pow":return[a.pow(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"SquaredDifference":return[a.squaredDifference(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}},h=(t,e,n,a=r)=>{switch(t.op){case"Abs":case"ComplexAbs":return[a.abs(Object(s["d"])("x",t,e,n))];case"Acos":return[a.acos(Object(s["d"])("x",t,e,n))];case"Acosh":return[a.acosh(Object(s["d"])("x",t,e,n))];case"Asin":return[a.asin(Object(s["d"])("x",t,e,n))];case"Asinh":return[a.asinh(Object(s["d"])("x",t,e,n))];case"Atan":return[a.atan(Object(s["d"])("x",t,e,n))];case"Atan2":return[a.atan2(Object(s["d"])("x",t,e,n),Object(s["d"])("y",t,e,n))];case"Atanh":return[a.atanh(Object(s["d"])("x",t,e,n))];case"Ceil":return[a.ceil(Object(s["d"])("x",t,e,n))];case"Complex":return[a.complex(Object(s["d"])("real",t,e,n),Object(s["d"])("imag",t,e,n))];case"Cos":return[a.cos(Object(s["d"])("x",t,e,n))];case"Cosh":return[a.cosh(Object(s["d"])("x",t,e,n))];case"Elu":return[a.elu(Object(s["d"])("x",t,e,n))];case"Erf":return[a.erf(Object(s["d"])("x",t,e,n))];case"Exp":return[a.exp(Object(s["d"])("x",t,e,n))];case"Expm1":return[a.expm1(Object(s["d"])("x",t,e,n))];case"Floor":return[a.floor(Object(s["d"])("x",t,e,n))];case"Log":return[a.log(Object(s["d"])("x",t,e,n))];case"Log1p":return[a.log1p(Object(s["d"])("x",t,e,n))];case"Imag":return[a.imag(Object(s["d"])("x",t,e,n))];case"Neg":return[a.neg(Object(s["d"])("x",t,e,n))];case"Reciprocal":return[a.reciprocal(Object(s["d"])("x",t,e,n))];case"Real":return[a.real(Object(s["d"])("x",t,e,n))];case"Relu":return[a.relu(Object(s["d"])("x",t,e,n))];case"Round":return[a.round(Object(s["d"])("x",t,e,n))];case"Selu":return[a.selu(Object(s["d"])("x",t,e,n))];case"Sigmoid":return[a.sigmoid(Object(s["d"])("x",t,e,n))];case"Sin":return[a.sin(Object(s["d"])("x",t,e,n))];case"Sign":return[a.sign(Object(s["d"])("x",t,e,n))];case"Sinh":return[a.sinh(Object(s["d"])("x",t,e,n))];case"Softplus":return[a.softplus(Object(s["d"])("x",t,e,n))];case"Sqrt":return[a.sqrt(Object(s["d"])("x",t,e,n))];case"Square":return[a.square(Object(s["d"])("x",t,e,n))];case"Tanh":return[a.tanh(Object(s["d"])("x",t,e,n))];case"Tan":return[a.tan(Object(s["d"])("x",t,e,n))];case"ClipByValue":return[a.clipByValue(Object(s["d"])("x",t,e,n),Object(s["d"])("clipValueMin",t,e,n),Object(s["d"])("clipValueMax",t,e,n))];case"Relu6":return[a.relu6(Object(s["d"])("x",t,e,n))];case"Rsqrt":return[a.rsqrt(Object(s["e"])(t.inputNames[0],e,n))];case"Prod":return[a.prod(Object(s["d"])("x",t,e,n),Object(s["d"])("axes",t,e,n))];case"LeakyRelu":return[a.leakyRelu(Object(s["d"])("x",t,e,n),Object(s["d"])("alpha",t,e,n))];case"Prelu":return[a.prelu(Object(s["d"])("x",t,e,n),Object(s["d"])("alpha",t,e,n))];case"IsNan":return[a.isNaN(Object(s["e"])(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function p(t,e,n=""){if("number"!==typeof t&&"number"!==typeof e){a["util"].assert(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const i=t[r],o=e[r];a["util"].assert(i<0||o<0||i===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function f(t){return"number"!==typeof t&&!t.some(t=>t<0)}function m(t,e,n){let r=g(t,n);const a=!f(r);if(a&&0===e.length)throw new Error("Tried to calculate elements of an empty list with non-fully-defined elementShape: "+r);if(a&&e.forEach(t=>{r=g(t.shape,r)}),!f(r))throw new Error("Non-fully-defined elementShape: "+r);return r}function g(t,e){if("number"===typeof t)return e;if("number"===typeof e)return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const a=t[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=a>=0?a:i}return n}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b{constructor(t,e,n,r,i,o,s){this.name=t,this.dtype=e,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=Object(a["scalar"])(0),Object(a["keep"])(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.tensor.id)||e.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||t>=this.size())throw new Error(`Tried to read from index ${t}, but array size is: ${this.size()}`);const e=this.tensors[t];if(e.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${t} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(e.cleared=!0),e.read=!0,e.tensor}readMany(t){return t.map(t=>this.read(t))}write(t,e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(t<0||!this.dynamicSize&&t>=this.maxSize)throw new Error(`Tried to write to index ${t}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[t]||{};if(e.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t},\n          because the value dtype is ${e.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=e.shape),p(this.elementShape,e.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${t}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${t}, because it has already been written.`);n.tensor=e,Object(a["keep"])(e),n.written=!0,this.tensors[t]=n}writeMany(t,e){if(t.length!==e.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${t.length} is not the same as tensors size: ${e.length}.`);t.forEach((t,n)=>this.write(t,e[n]))}gather(t,e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${e}`);if(t)t=t.slice(0,this.size());else{t=[];for(let e=0;e<this.size();e++)t.push(e)}if(0===t.length)return Object(a["tensor"])([],[0].concat(this.elementShape));const n=this.readMany(t);return p(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Object(a["stack"])(n,0)}concat(t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${t}`);if(0===this.size())return Object(a["tensor"])([],[0].concat(this.elementShape));const e=[];for(let r=0;r<this.size();r++)e.push(r);const n=this.readMany(e);return p(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),Object(a["concat"])(n,0)}scatter(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const n=Math.max(...t);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(t,Object(a["unstack"])(e,0))}split(t,e){if(e.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${e.dtype}`);let n=0;const r=t.map(t=>(n+=t,n));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);if(!this.dynamicSize&&t.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${t.length}), and the TensorArray is not marked as dynamically resizeable`);const i=0===n?0:e.size/n,o=[];Object(a["tidy"])(()=>{e=Object(a["reshape"])(e,[1,n,i]);for(let n=0;n<t.length;++n){const s=0===n?0:r[n-1],u=[0,s,0],c=[1,t[n],i];o[n]=Object(a["reshape"])(Object(a["slice"])(e,u,c),this.elementShape)}return o});const s=[];for(let a=0;a<t.length;a++)s[a]=a;this.writeMany(s,o)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class y{constructor(t,e,n,r=-1){this.tensors=t,this.elementShape=e,this.elementDtype=n,null!=t&&t.forEach(t=>{if(n!==t.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${t.dtype}`);p(e,t.shape,"TensorList shape mismatch: "),Object(a["keep"])(t)}),this.idTensor=Object(a["scalar"])(0),this.maxNumElements=r,Object(a["keep"])(this.idTensor)}get id(){return this.idTensor.id}copy(){return new y([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(t){this.tensors.forEach(e=>{null!=t&&t.has(e.id)||e.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(t,e,n=-1){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);p(t,this.elementShape,"TensorList shape mismatch: ");const r=m(this.elementShape,this.tensors,t);return Object(a["tidy"])(()=>{const t=this.tensors.map(t=>Object(a["reshape"])(t,r));return Object(a["stack"])(t,0)})}popBack(t,e){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=m(this.elementShape,this.tensors,t),r=this.tensors.pop();return r.kept=!1,p(r.shape,t,"TensorList shape mismatch: "),Object(a["reshape"])(r,n)}pushBack(t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(p(t.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(a["keep"])(t),this.tensors.push(t)}resize(t){if(t<0)throw new Error("TensorListResize expects size to be non-negative. Got: "+t);if(-1!==this.maxNumElements&&t>this.maxNumElements)throw new Error(`TensorListResize input size ${t} is greater maxNumElement ${this.maxNumElements}.`);const e=new y([],this.elementShape,this.elementDtype,this.maxNumElements);e.tensors.length=t;for(let n=0;n<Math.min(this.tensors.length,t);++n)e.tensors[n]=this.tensors[n];return e}getItem(t,e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(t<0||t>this.tensors.length)throw new Error(`Trying to access element ${t} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[t])throw new Error(`element at index ${t} is null.`);p(this.tensors[t].shape,e,"TensorList shape mismatch: ");const r=m(this.elementShape,this.tensors,e);return Object(a["reshape"])(this.tensors[t],r)}setItem(t,e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(t<0||-1!==this.maxNumElements&&t>=this.maxNumElements)throw new Error(`Trying to set element ${t} in a list with max ${this.maxNumElements} elements.`);p(this.elementShape,e.shape,"TensorList shape mismatch: "),Object(a["keep"])(e),null!=this.tensors[t]&&(this.tensors[t].kept=!1),this.tensors[t]=e}gather(t,e,n){if(e!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e}, but list elements ${this.elementDtype}`);p(this.elementShape,n,"TensorList shape mismatch: "),t=t.slice(0,this.size());const r=m(this.elementShape,this.tensors,n);return 0===t.length?Object(a["tensor"])([],[0].concat(r)):Object(a["tidy"])(()=>{const e=t.map(t=>Object(a["reshape"])(this.tensors[t],r));return Object(a["stack"])(e,0)})}concat(t,e){if(t&&t!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${t}`);p(this.elementShape,e,"TensorList shape mismatch: ");const n=m(this.elementShape,this.tensors,e);return 0===this.size()?Object(a["tensor"])([],[0].concat(n)):Object(a["tidy"])(()=>{const t=this.tensors.map(t=>Object(a["reshape"])(t,n));return Object(a["concat"])(t,0)})}}function v(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: "+t.shape);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const i=t.shape.slice(1);p(i,e,"TensorList shape mismatch: ");const o=Object(a["unstack"])(t);return new y(o,e,r)}function x(t,e,n,r){return new y([],t,e,r)}function w(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const i=Math.max(...e);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const o=new y([],n,t.dtype,r),s=Object(a["unstack"])(t,0);return e.forEach((t,e)=>{o.setItem(t,s[e])}),o}function k(t,e,n){let r=0;const i=e.map(t=>(r+=t,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),s=g(o,n),u=0===r?0:t.size/r,c=Object(a["tidy"])(()=>{const n=[];t=Object(a["reshape"])(t,[1,r,u]);for(let r=0;r<e.length;++r){const o=0===r?0:i[r-1],c=[0,o,0],l=[1,e[r],u];n[r]=Object(a["reshape"])(Object(a["slice"])(t,c,l),s)}return t.dispose(),n}),l=new y([],n,t.dtype,e.length);for(let a=0;a<c.length;a++)l.setItem(a,c[a]);return l}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=Object(s["d"])("thenBranch",t,e,n),a=Object(s["d"])("elseBranch",t,e,n),i=Object(s["d"])("cond",t,e,n),o=Object(s["d"])("args",t,e,n),u=await i.data();return u[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=Object(s["d"])("body",t,e,n),a=Object(s["d"])("cond",t,e,n),i=Object(s["d"])("args",t,e,n),o=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),u=i.map(t=>t.id);let c=await o[0].data();o.forEach(t=>{t.kept||-1!==u.indexOf(t.id)||t.dispose()});let l=i;while(c[0]){const t=l;l=await n.functionMap[r].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);const e=l.map(t=>t.id);t.forEach(t=>{t.kept||-1!==u.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()});const i=await n.functionMap[a].executeFunctionAsync(l,n.tensorArrayMap,n.tensorListMap);c=await i[0].data(),i.forEach(t=>{t.kept||-1!==u.indexOf(t.id)||-1!==e.indexOf(t.id)||t.dispose()})}return l}case"LoopCond":{const r=Object(s["d"])("pred",t,e,n);return[Object(s["a"])(r)]}case"Switch":{const r=Object(s["d"])("pred",t,e,n);let a=Object(s["d"])("data",t,e,n);return a.kept||(a=Object(s["a"])(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=t.inputNames.find(t=>void 0!==Object(s["e"])(t,e,n));if(r){const t=Object(s["e"])(r,e,n);return[Object(s["a"])(t)]}return}case"Enter":{const r=Object(s["d"])("frameName",t,e,n),a=Object(s["d"])("tensor",t,e,n);return n.enterFrame(r),[Object(s["a"])(a)]}case"Exit":{const r=Object(s["d"])("tensor",t,e,n);return n.exitFrame(),[Object(s["a"])(r)]}case"NextIteration":{const r=Object(s["d"])("tensor",t,e,n);return n.nextIteration(),[Object(s["a"])(r)]}case"TensorArrayV3":{const r=Object(s["d"])("size",t,e,n),i=Object(s["d"])("dtype",t,e,n),o=Object(s["d"])("elementShape",t,e,n),u=Object(s["d"])("dynamicSize",t,e,n),c=Object(s["d"])("clearAfterRead",t,e,n),l=Object(s["d"])("identicalElementShapes",t,e,n),d=Object(s["d"])("name",t,e,n),h=new b(d,i,r,o,l,u,c);return n.addTensorArray(h),[h.idTensor,Object(a["scalar"])(1)]}case"TensorArrayWriteV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=Object(s["d"])("index",t,e,n),i=Object(s["d"])("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(a,i),[o.idTensor]}case"TensorArrayReadV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=Object(s["d"])("index",t,e,n),i=n.getTensorArray(r.id);return[i.read(a)]}case"TensorArrayGatherV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=Object(s["d"])("indices",t,e,n),i=Object(s["d"])("dtype",t,e,n),o=n.getTensorArray(r.id);return[o.gather(a,i)]}case"TensorArrayScatterV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=Object(s["d"])("indices",t,e,n),i=Object(s["d"])("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(a,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=n.getTensorArray(r.id),i=Object(s["d"])("dtype",t,e,n);return[a.concat(i)]}case"TensorArraySplitV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=Object(s["d"])("tensor",t,e,n),i=Object(s["d"])("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,a),[o.idTensor]}case"TensorArraySizeV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return[Object(a["scalar"])(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=Object(s["d"])("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("index",t,e,n),i=Object(s["d"])("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(a,i),[o.idTensor]}case"TensorListGetItem":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("index",t,e,n),i=Object(s["d"])("elementShape",t,e,n),o=Object(s["d"])("elementDType",t,e,n),u=n.getTensorList(r.id);return[u.getItem(a,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=Object(s["d"])("indices",t,e,n),a=Object(s["d"])("tensor",t,e,n),i=Object(s["d"])("elementShape",t,e,n),o=Object(s["d"])("numElements",t,e,n),u=w(a,r,i,o);return n.addTensorList(u),[u.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=Object(s["d"])("elementShape",t,e,n),a=Object(s["d"])("elementDType",t,e,n);let i;i="TensorListReserve"===t.op?"numElements":"maxNumElements";const o=Object(s["d"])(i,t,e,n),u="TensorListReserve"===t.op?-1:o,c=x(r,a,o,u);return n.addTensorList(c),[c.idTensor]}case"TensorListGather":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("indices",t,e,n),i=Object(s["d"])("elementShape",t,e,n),o=Object(s["d"])("elementDType",t,e,n),u=n.getTensorList(r.id);return[u.gather(a,o,i)]}case"TensorListStack":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("elementShape",t,e,n),i=Object(s["d"])("elementDType",t,e,n),o=Object(s["d"])("numElements",t,e,n),u=n.getTensorList(r.id);return[u.stack(a,i,o)]}case"TensorListFromTensor":{const r=Object(s["d"])("tensor",t,e,n),a=Object(s["d"])("elementShape",t,e,n),i=Object(s["d"])("elementDType",t,e,n),o=v(r,a,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=Object(s["d"])("tensorListId",t,e,n),a=n.getTensorList(r.id),i=Object(s["d"])("dtype",t,e,n),o=Object(s["d"])("elementShape",t,e,n);return[a.concat(i,o)]}case"TensorListPushBack":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("elementShape",t,e,n),i=Object(s["d"])("elementDType",t,e,n),o=n.getTensorList(r.id);return[o.popBack(a,i)]}case"TensorListSplit":{const r=Object(s["d"])("tensor",t,e,n),a=Object(s["d"])("elementShape",t,e,n),i=Object(s["d"])("lengths",t,e,n),o=k(r,i,a);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=Object(s["d"])("tensorListId",t,e,n),i=n.getTensorList(r.id);return[Object(a["scalar"])(i.size(),"int32")]}case"TensorListResize":{const r=Object(s["d"])("tensorListId",t,e,n),a=Object(s["d"])("size",t,e,n),i=n.getTensorList(r.id),o=i.resize(a);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function O(t,e,n){const[r,a]=Object(s["d"])("fusedOps",t,e,n),i="biasadd"===r,o=!i,u="prelu"===a,c="fusedbatchnorm"===r,l=Object(s["d"])("numArgs",t,e,n);if(i){if(u&&2!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&i&&1!==l)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const d=Object(s["d"])("strides",t,e,n),h=Object(s["c"])(t,e,n),p=Object(s["d"])("dataFormat",t,e,n).toUpperCase(),f=Object(s["d"])("dilations",t,e,n);let[m,g]=Object(s["d"])("args",t,e,n);o&&(g=m,m=void 0);const b=Object(s["d"])("leakyreluAlpha",t,e,n);return{stride:d,pad:h,dataFormat:p,dilations:f,biasArg:m,preluArg:g,activationFunc:a,leakyreluAlpha:b}}const _=(t,e,n,a=r)=>{switch(t.op){case"Conv1D":{const r=Object(s["d"])("stride",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("dataFormat",t,e,n).toUpperCase(),u=Object(s["d"])("dilation",t,e,n);return[a.conv1d(Object(s["d"])("x",t,e,n),Object(s["d"])("filter",t,e,n),r,i,o,u)]}case"Conv2D":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["c"])(t,e,n),o=Object(s["d"])("dataFormat",t,e,n).toUpperCase(),u=Object(s["d"])("dilations",t,e,n);return[a.conv2d(Object(s["d"])("x",t,e,n),Object(s["d"])("filter",t,e,n),[r[1],r[2]],i,o,[u[1],u[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:u,biasArg:c,preluArg:l,activationFunc:d,leakyreluAlpha:h}=O(t,e,n);return[a.fused.conv2d({x:Object(s["d"])("x",t,e,n),filter:Object(s["d"])("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[u[1],u[2]],bias:c,activation:d,preluActivationWeights:l,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:u,biasArg:c,preluArg:l,activationFunc:d,leakyreluAlpha:h}=O(t,e,n);return[a.fused.depthwiseConv2d({x:Object(s["d"])("x",t,e,n),filter:Object(s["d"])("filter",t,e,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[u[1],u[2]],bias:c,activation:d,preluActivationWeights:l,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=Object(s["d"])("outputShape",t,e,n),i=Object(s["d"])("strides",t,e,n),o=Object(s["c"])(t,e,n);return[a.conv2dTranspose(Object(s["d"])("x",t,e,n),Object(s["d"])("filter",t,e,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["c"])(t,e,n),o=Object(s["d"])("dilations",t,e,n),u=Object(s["d"])("dataFormat",t,e,n).toUpperCase();return[a.depthwiseConv2d(Object(s["d"])("input",t,e,n),Object(s["d"])("filter",t,e,n),[r[1],r[2]],i,u,[o[1],o[2]])]}case"Conv3D":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("dataFormat",t,e,n).toUpperCase(),u=Object(s["d"])("dilations",t,e,n);return[a.conv3d(Object(s["d"])("x",t,e,n),Object(s["d"])("filter",t,e,n),[r[1],r[2],r[3]],i,o,[u[1],u[2],u[3]])]}case"AvgPool":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("kernelSize",t,e,n);return[a.avgPool(Object(s["d"])("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("kernelSize",t,e,n);return[a.maxPool(Object(s["d"])("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("kernelSize",t,e,n),u=Object(s["d"])("includeBatchInIndex",t,e,n),{result:c,indexes:l}=a.maxPoolWithArgmax(Object(s["d"])("x",t,e,n),[o[1],o[2]],[r[1],r[2]],i,u);return[c,l]}case"AvgPool3D":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("kernelSize",t,e,n);return[a.avgPool3d(Object(s["d"])("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("kernelSize",t,e,n);return[a.maxPool3d(Object(s["d"])("x",t,e,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=Object(s["d"])("strides",t,e,n),i=Object(s["d"])("pad",t,e,n),o=Object(s["d"])("dilations",t,e,n),u=r[1],c=r[2],l=o[1],d=o[2];return[a.dilation2d(Object(s["d"])("x",t,e,n),Object(s["d"])("filter",t,e,n),[u,c],i,[l,d],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},C=(t,e,n,a=r)=>{switch(t.op){case"Fill":{const r=Object(s["d"])("shape",t,e,n),i=Object(s["d"])("dtype",t,e,n),o=Object(s["d"])("value",t,e,n);return[a.fill(r,o,i)]}case"LinSpace":{const r=Object(s["d"])("start",t,e,n),i=Object(s["d"])("stop",t,e,n),o=Object(s["d"])("num",t,e,n);return[a.linspace(r,i,o)]}case"Multinomial":{const r=Object(s["d"])("logits",t,e,n),i=Object(s["d"])("numSamples",t,e,n),o=Object(s["d"])("seed",t,e,n);return[a.multinomial(r,i,o)]}case"OneHot":{const r=Object(s["d"])("indices",t,e,n),i=Object(s["d"])("depth",t,e,n),o=Object(s["d"])("onValue",t,e,n),u=Object(s["d"])("offValue",t,e,n),c=Object(s["d"])("dtype",t,e,n);return[a.oneHot(r,i,o,u,c)]}case"Ones":return[a.ones(Object(s["d"])("shape",t,e,n),Object(s["d"])("dtype",t,e,n))];case"OnesLike":return[a.onesLike(Object(s["d"])("x",t,e,n))];case"RandomStandardNormal":return[a.randomStandardNormal(Object(s["d"])("shape",t,e,n),Object(s["d"])("dtype",t,e,n),Object(s["d"])("seed",t,e,n))];case"RandomUniform":return[a.randomUniform(Object(s["d"])("shape",t,e,n),Object(s["d"])("minval",t,e,n),Object(s["d"])("maxval",t,e,n),Object(s["d"])("dtype",t,e,n))];case"Range":{const r=Object(s["d"])("start",t,e,n),i=Object(s["d"])("stop",t,e,n),o=Object(s["d"])("step",t,e,n);return[a.range(r,i,o,Object(s["d"])("dtype",t,e,n))]}case"TruncatedNormal":{const r=Object(s["d"])("shape",t,e,n),i=Object(s["d"])("mean",t,e,n),o=Object(s["d"])("stdDev",t,e,n),u=Object(s["d"])("seed",t,e,n);return[a.truncatedNormal(r,i,o,Object(s["d"])("dtype",t,e,n),u)]}case"Zeros":return[a.zeros(Object(s["d"])("shape",t,e,n),Object(s["d"])("dtype",t,e,n))];case"ZerosLike":return[a.zerosLike(Object(s["d"])("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function T(t,e,n){const r=Object(s["d"])("boxes",t,e,n),a=Object(s["d"])("scores",t,e,n),i=Object(s["d"])("maxOutputSize",t,e,n),o=Object(s["d"])("iouThreshold",t,e,n),u=Object(s["d"])("scoreThreshold",t,e,n),c=Object(s["d"])("softNmsSigma",t,e,n);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:u,softNmsSigma:c}}const I=async(t,e,n,a,i=r)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:a,maxOutputSize:o,iouThreshold:s,scoreThreshold:u,softNmsSigma:c}=T(t,e,n),l=await i.image.nonMaxSuppressionWithScoreAsync(r,a,o,s,u,c);return[l.selectedIndices,l.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:a,maxOutputSize:o,iouThreshold:u,scoreThreshold:c}=T(t,e,n),l=Object(s["d"])("padToMaxOutputSize",t,e,n),d=await i.image.nonMaxSuppressionPaddedAsync(r,a,o,u,c,l);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:a,maxOutputSize:o,iouThreshold:s,scoreThreshold:u}=T(t,e,n);return[await i.image.nonMaxSuppressionAsync(r,a,o,s,u)]}case"Where":{const r=i.cast(Object(s["d"])("condition",t,e,n),"bool"),a=[await i.whereAsync(r)];return r.dispose(),a}case"ListDiff":return i.setdiff1dAsync(Object(s["d"])("x",t,e,n),Object(s["d"])("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}},N=(t,e,n,a=r)=>{switch(t.op){case"LowerBound":{const r=Object(s["d"])("sortedSequence",t,e,n),i=Object(s["d"])("values",t,e,n);return[a.lowerBound(r,i)]}case"TopKV2":{const r=Object(s["d"])("x",t,e,n),i=Object(s["d"])("k",t,e,n),o=Object(s["d"])("sorted",t,e,n),u=a.topk(r,i,o);return[u.values,u.indices]}case"UpperBound":{const r=Object(s["d"])("sortedSequence",t,e,n),i=Object(s["d"])("values",t,e,n);return[a.upperBound(r,i)]}case"Unique":{const r=Object(s["d"])("x",t,e,n),i=a.unique(r);return[i.values,i.indices]}case"UniqueV2":{const r=Object(s["d"])("x",t,e,n),i=Object(s["d"])("axis",t,e,n),o=a.unique(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},E=(t,e,n,a=r)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=Object(s["d"])("default",t,e,n);return[Object(s["e"])(t.name,e,n)||r];case"Placeholder":return[Object(s["e"])(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const r=Object(s["d"])("x",t,e,n);return[Object(s["a"])(r)]}case"IdentityN":return Object(s["d"])("x",t,e,n).map(t=>Object(s["a"])(t));case"Snapshot":const i=Object(s["d"])("x",t,e,n);return[Object(s["a"])(i)];case"Shape":return[a.tensor1d(Object(s["d"])("x",t,e,n).shape,"int32")];case"ShapeN":return Object(s["d"])("x",t,e,n).map(t=>a.tensor1d(t.shape));case"Size":return[a.scalar(Object(s["d"])("x",t,e,n).size,"int32")];case"Rank":return[a.scalar(Object(s["d"])("x",t,e,n).rank,"int32")];case"NoOp":return[a.scalar(1)];case"Print":const o=Object(s["d"])("x",t,e,n),u=Object(s["d"])("data",t,e,n),c=Object(s["d"])("message",t,e,n),l=Object(s["d"])("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let t=0;t<u.length;t++)console.log(Array.prototype.slice.call(u[t].dataSync()).slice(0,l));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};var A=n("1ba2");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R{constructor(t,e){this.keyDType=t,this.valueDType=e,this.handle=Object(a["scalar"])(0),this.tensorMap=new Map,Object(a["keep"])(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return A["a"](this.size(),"int32")}async import(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return this.tensorMap.forEach(t=>t.dispose()),this.tensorMap.clear(),Object(a["tidy"])(()=>{const t=Object(a["unstack"])(e),r=n.length,i=t.length;a["util"].assert(r===i,()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`);for(let e=0;e<r;e++){const r=n[e],i=t[e];Object(a["keep"])(i),this.tensorMap.set(r,i)}return this.handle})}async find(t,e){this.checkKeyAndValueTensor(t,e);const n=await t.data();return Object(a["tidy"])(()=>{const t=[];for(let r=0;r<n.length;r++){const a=n[r],i=this.findWithDefault(a,e);t.push(i)}return Object(a["stack"])(t)})}findWithDefault(t,e){const n=this.tensorMap.get(t);return null!=n?n:e}checkKeyAndValueTensor(t,e){if(t.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got `+t.dtype);if(e.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got `+e.dtype)}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=Object(s["d"])("keyDType",t,e,n),i=Object(s["d"])("valueDType",t,e,n),o=new R(a,i);return r.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const a=Object(s["d"])("tableHandle",t,e,n,r),i=Object(s["d"])("keys",t,e,n),o=Object(s["d"])("values",t,e,n),u=r.getHashTableById(a.id);return[await u.import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=Object(s["d"])("tableHandle",t,e,n,r),i=Object(s["d"])("keys",t,e,n),o=Object(s["d"])("defaultValue",t,e,n),u=r.getHashTableById(a.id);return[await u.find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=Object(s["d"])("tableHandle",t,e,n,r),i=r.getHashTableById(a.id);return[i.tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},D=(t,e,n,a=r)=>{switch(t.op){case"ResizeBilinear":{const r=Object(s["d"])("images",t,e,n),i=Object(s["d"])("size",t,e,n),o=Object(s["d"])("alignCorners",t,e,n),u=Object(s["d"])("halfPixelCenters",t,e,n);return[a.image.resizeBilinear(r,[i[0],i[1]],o,u)]}case"ResizeNearestNeighbor":{const r=Object(s["d"])("images",t,e,n),i=Object(s["d"])("size",t,e,n),o=Object(s["d"])("alignCorners",t,e,n),u=Object(s["d"])("halfPixelCenters",t,e,n);return[a.image.resizeNearestNeighbor(r,[i[0],i[1]],o,u)]}case"CropAndResize":{const r=Object(s["d"])("image",t,e,n),i=Object(s["d"])("boxes",t,e,n),o=Object(s["d"])("boxInd",t,e,n),u=Object(s["d"])("cropSize",t,e,n),c=Object(s["d"])("method",t,e,n),l=Object(s["d"])("extrapolationValue",t,e,n);return[a.image.cropAndResize(r,i,o,u,c,l)]}case"ImageProjectiveTransformV3":{const r=Object(s["d"])("images",t,e,n),i=Object(s["d"])("transforms",t,e,n),o=Object(s["d"])("outputShape",t,e,n),u=Object(s["d"])("fillValue",t,e,n),c=Object(s["d"])("interpolation",t,e,n),l=Object(s["d"])("fillMode",t,e,n);return[a.image.transform(r,i,c.toLowerCase(),l.toLowerCase(),u,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},F=(t,e,n,a=r)=>{switch(t.op){case"Equal":return[a.equal(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"NotEqual":return[a.notEqual(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Greater":return[a.greater(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"GreaterEqual":return[a.greaterEqual(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Less":return[a.less(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"LessEqual":return[a.lessEqual(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"LogicalAnd":return[a.logicalAnd(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"LogicalNot":return[a.logicalNot(Object(s["d"])("a",t,e,n))];case"LogicalOr":return[a.logicalOr(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];case"Select":case"SelectV2":return[a.where(Object(s["d"])("condition",t,e,n),Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}},M=(t,e,n,a=r)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[a.matMul(Object(s["d"])("a",t,e,n),Object(s["d"])("b",t,e,n),Object(s["d"])("transposeA",t,e,n),Object(s["d"])("transposeB",t,e,n))];case"Einsum":return[a.einsum(Object(s["d"])("equation",t,e,n),...Object(s["d"])("tensors",t,e,n))];case"Transpose":return[a.transpose(Object(s["d"])("x",t,e,n),Object(s["d"])("perm",t,e,n))];case"_FusedMatMul":const[r,i]=Object(s["d"])("fusedOps",t,e,n),o="biasadd"===r,u="prelu"===i,c=Object(s["d"])("numArgs",t,e,n),l=Object(s["d"])("leakyreluAlpha",t,e,n);if(o){if(u&&2!==c)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[d,h]=Object(s["d"])("args",t,e,n);return[a.fused.matMul({a:Object(s["d"])("a",t,e,n),b:Object(s["d"])("b",t,e,n),transposeA:Object(s["d"])("transposeA",t,e,n),transposeB:Object(s["d"])("transposeB",t,e,n),bias:d,activation:i,preluActivationWeights:h,leakyreluAlpha:l})];default:throw TypeError(`Node type ${t.op} is not implemented`)}},P=(t,e,n,a=r)=>{switch(t.op){case"EuclideanNorm":return[a.euclideanNorm(Object(s["d"])("x",t,e,n),Object(s["d"])("axis",t,e,n),Object(s["d"])("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[a.batchNorm(Object(s["d"])("x",t,e,n),Object(s["d"])("mean",t,e,n),Object(s["d"])("variance",t,e,n),Object(s["d"])("offset",t,e,n),Object(s["d"])("scale",t,e,n),Object(s["d"])("epsilon",t,e,n))];case"FusedBatchNormV3":return[a.batchNorm(Object(s["d"])("x",t,e,n),Object(s["d"])("mean",t,e,n),Object(s["d"])("variance",t,e,n),Object(s["d"])("offset",t,e,n),Object(s["d"])("scale",t,e,n),Object(s["d"])("epsilon",t,e,n))];case"LRN":return[a.localResponseNormalization(Object(s["d"])("x",t,e,n),Object(s["d"])("radius",t,e,n),Object(s["d"])("bias",t,e,n),Object(s["d"])("alpha",t,e,n),Object(s["d"])("beta",t,e,n))];case"Softmax":return[a.softmax(Object(s["d"])("x",t,e,n))];case"LogSoftmax":return[a.logSoftmax(Object(s["d"])("x",t,e,n))];case"SparseToDense":return[a.sparseToDense(Object(s["d"])("sparseIndices",t,e,n),Object(s["d"])("outputShape",t,e,n),Object(s["d"])("sparseValues",t,e,n),Object(s["d"])("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}},$=(t,e,n,a=r)=>{switch(t.op){case"Max":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.max(Object(s["d"])("x",t,e,n),r,i)]}case"Mean":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.mean(Object(s["d"])("x",t,e,n),r,i)]}case"Min":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.min(Object(s["d"])("x",t,e,n),r,i)]}case"Sum":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.sum(Object(s["d"])("x",t,e,n),r,i)]}case"All":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.all(Object(s["d"])("x",t,e,n),r,i)]}case"Any":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.any(Object(s["d"])("x",t,e,n),r,i)]}case"ArgMax":{const r=Object(s["d"])("axis",t,e,n);return[a.argMax(Object(s["d"])("x",t,e,n),r)]}case"ArgMin":{const r=Object(s["d"])("axis",t,e,n);return[a.argMin(Object(s["d"])("x",t,e,n),r)]}case"Prod":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("keepDims",t,e,n);return[a.prod(Object(s["d"])("x",t,e,n),r,i)]}case"Cumprod":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("exclusive",t,e,n),o=Object(s["d"])("reverse",t,e,n);return[a.cumprod(Object(s["d"])("x",t,e,n),r,i,o)]}case"Cumsum":{const r=Object(s["d"])("axis",t,e,n),i=Object(s["d"])("exclusive",t,e,n),o=Object(s["d"])("reverse",t,e,n);return[a.cumsum(Object(s["d"])("x",t,e,n),r,i,o)]}case"Bincount":const r=Object(s["d"])("x",t,e,n),i=Object(s["d"])("weights",t,e,n),o=Object(s["d"])("size",t,e,n);return[a.bincount(r,i,o)];case"DenseBincount":{const r=Object(s["d"])("x",t,e,n),i=Object(s["d"])("weights",t,e,n),o=Object(s["d"])("size",t,e,n),u=Object(s["d"])("binaryOutput",t,e,n);return[a.denseBincount(r,i,o,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},L=(t,e,n,i=r)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=Object(s["d"])("n",t,e,n),a=Object(s["d"])("axis",t,e,n);let o=Object(s["d"])("tensors",t,e,n);return o=o.slice(0,r),[i.concat(o,a)]}case"Gather":{const r=Object(s["d"])("x",t,e,n),a=Object(s["d"])("indices",t,e,n);return[i.gather(r,i.cast(a,"int32"),0)]}case"GatherV2":{const r=Object(s["d"])("axis",t,e,n),a=Object(s["d"])("batchDims",t,e,n),o=Object(s["d"])("x",t,e,n),u=Object(s["d"])("indices",t,e,n);return[i.gather(o,i.cast(u,"int32"),r,a)]}case"Reverse":{const r=Object(s["d"])("dims",t,e,n),a=[];for(let t=0;t<r.length;t++)r[t]&&a.push(t);const o=Object(s["d"])("x",t,e,n);return[i.reverse(o,a)]}case"ReverseV2":{const r=Object(s["d"])("axis",t,e,n),a=Object(s["d"])("x",t,e,n);return[i.reverse(a,r)]}case"Slice":{const r=Object(s["d"])("begin",t,e,n),a=Object(s["d"])("size",t,e,n);return[i.slice(Object(s["d"])("x",t,e,n),r,a)]}case"StridedSlice":{const r=Object(s["d"])("begin",t,e,n),a=Object(s["d"])("end",t,e,n),o=Object(s["d"])("strides",t,e,n),u=Object(s["d"])("beginMask",t,e,n),c=Object(s["d"])("endMask",t,e,n),l=Object(s["d"])("ellipsisMask",t,e,n),d=Object(s["d"])("newAxisMask",t,e,n),h=Object(s["d"])("shrinkAxisMask",t,e,n),p=Object(s["d"])("x",t,e,n);return[i.stridedSlice(p,r,a,o,u,c,l,d,h)]}case"Pack":return Object(a["tidy"])(()=>{const r=Object(s["d"])("axis",t,e,n),o=Object(s["d"])("tensors",t,e,n),u=o[0].shape,c=i.squeeze(o[0]).shape,l=o.map(t=>{const e=a["util"].arraysEqual(t.shape,u);if(!e&&!a["util"].arraysEqual(i.squeeze(t).shape,c))throw new Error("the input tensors shape does not match");return e?t:i.reshape(t,u)});return[i.stack(l,r)]});case"Unpack":{const r=Object(s["d"])("axis",t,e,n),a=Object(s["d"])("tensor",t,e,n);return i.unstack(a,r)}case"Tile":{const r=Object(s["d"])("reps",t,e,n);return[i.tile(Object(s["d"])("x",t,e,n),r)]}case"Split":case"SplitV":{const r=Object(s["d"])("axis",t,e,n),a=Object(s["d"])("numOrSizeSplits",t,e,n),o=Object(s["d"])("x",t,e,n);return i.split(o,a,r)}case"ScatterNd":{const r=Object(s["d"])("indices",t,e,n),a=Object(s["d"])("values",t,e,n),o=Object(s["d"])("shape",t,e,n);return[i.scatterND(r,a,o)]}case"GatherNd":{const r=Object(s["d"])("x",t,e,n),a=Object(s["d"])("indices",t,e,n);return[i.gatherND(r,a)]}case"SparseToDense":{const r=Object(s["d"])("sparseIndices",t,e,n),a=Object(s["d"])("outputShape",t,e,n),o=Object(s["d"])("sparseValues",t,e,n),u=Object(s["d"])("defaultValue",t,e,n);return[i.sparseToDense(r,o,a,o.dtype===u.dtype?u:i.cast(u,o.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},B=(t,e,n,a=r)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:u}=a.sparse.sparseFillEmptyRows(Object(s["d"])("indices",t,e,n),Object(s["d"])("values",t,e,n),Object(s["d"])("denseShape",t,e,n),Object(s["d"])("defaultValue",t,e,n));return[r,i,o,u]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=a.sparse.sparseReshape(Object(s["d"])("inputIndices",t,e,n),Object(s["d"])("inputShape",t,e,n),Object(s["d"])("newShape",t,e,n));return[r,i]}case"SparseSegmentMean":{const r=a.sparse.sparseSegmentMean(Object(s["d"])("data",t,e,n),Object(s["d"])("indices",t,e,n),Object(s["d"])("segmentIds",t,e,n));return[r]}case"SparseSegmentSum":{const r=a.sparse.sparseSegmentSum(Object(s["d"])("data",t,e,n),Object(s["d"])("indices",t,e,n),Object(s["d"])("segmentIds",t,e,n));return[r]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},z=(t,e,n,a=r)=>{switch(t.op){case"FFT":return[a.fft(Object(s["d"])("x",t,e,n))];case"IFFT":return[a.ifft(Object(s["d"])("x",t,e,n))];case"RFFT":return[a.rfft(Object(s["d"])("x",t,e,n))];case"IRFFT":return[a.irfft(Object(s["d"])("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}},W=(t,e,n,a=r)=>{switch(t.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=a.string.stringNGrams(Object(s["d"])("data",t,e,n),Object(s["d"])("dataSplits",t,e,n),Object(s["d"])("separator",t,e,n),Object(s["d"])("nGramWidths",t,e,n),Object(s["d"])("leftPad",t,e,n),Object(s["d"])("rightPad",t,e,n),Object(s["d"])("padWidth",t,e,n),Object(s["d"])("preserveShortSequences",t,e,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=a.string.stringSplit(Object(s["d"])("input",t,e,n),Object(s["d"])("delimiter",t,e,n),Object(s["d"])("skipEmpty",t,e,n));return[r,i,o]}case"StringToHashBucketFast":{const r=a.string.stringToHashBucketFast(Object(s["d"])("input",t,e,n),Object(s["d"])("numBuckets",t,e,n));return[r]}default:throw TypeError(`Node type ${t.op} is not implemented`)}},V=(t,e,n,a=r)=>{switch(t.op){case"Cast":return[a.cast(Object(s["d"])("x",t,e,n),Object(s["d"])("dtype",t,e,n))];case"ExpandDims":{const r=Object(s["d"])("axis",t,e,n);return[a.expandDims(Object(s["d"])("x",t,e,n),r)]}case"Squeeze":{const r=Object(s["d"])("axis",t,e,n);return[a.squeeze(Object(s["d"])("x",t,e,n),r)]}case"Reshape":return[a.reshape(Object(s["d"])("x",t,e,n),Object(s["d"])("shape",t,e,n))];case"MirrorPad":return[a.mirrorPad(Object(s["d"])("x",t,e,n),Object(s["d"])("padding",t,e,n),Object(s["d"])("mode",t,e,n))];case"PadV2":case"Pad":return[a.pad(Object(s["d"])("x",t,e,n),Object(s["d"])("padding",t,e,n),Object(s["d"])("constantValue",t,e,n))];case"SpaceToBatchND":{const r=Object(s["d"])("blockShape",t,e,n),i=Object(s["d"])("paddings",t,e,n);return[a.spaceToBatchND(Object(s["d"])("x",t,e,n),r,i)]}case"BatchToSpaceND":{const r=Object(s["d"])("blockShape",t,e,n),i=Object(s["d"])("crops",t,e,n);return[a.batchToSpaceND(Object(s["d"])("x",t,e,n),r,i)]}case"DepthToSpace":{const r=Object(s["d"])("blockSize",t,e,n),i=Object(s["d"])("dataFormat",t,e,n).toUpperCase();return[a.depthToSpace(Object(s["d"])("x",t,e,n),r,i)]}case"BroadcastTo":return[a.broadcastTo(Object(s["d"])("x",t,e,n),Object(s["d"])("shape",t,e,n))];case"BroadcastArgs":return[a.broadcastArgs(Object(s["d"])("s0",t,e,n),Object(s["d"])("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function U(t,e,n,r,i=a["tidy"]){const o=((t,e,n)=>{switch(t.category){case"arithmetic":return i(()=>d(t,e,n));case"basic_math":return i(()=>h(t,e,n));case"control":return S(t,e,n);case"convolution":return i(()=>_(t,e,n));case"creation":return i(()=>C(t,e,n));case"dynamic":return I(t,e,n);case"evaluation":return i(()=>N(t,e,n));case"image":return i(()=>D(t,e,n));case"graph":return i(()=>E(t,e,n));case"logical":return i(()=>F(t,e,n));case"matrices":return i(()=>M(t,e,n));case"normalization":return i(()=>P(t,e,n));case"reduction":return i(()=>$(t,e,n));case"slice_join":return i(()=>L(t,e,n));case"sparse":return i(()=>B(t,e,n));case"spectral":return i(()=>z(t,e,n));case"string":return i(()=>W(t,e,n));case"transformation":return i(()=>V(t,e,n));case"hash_table":return j(t,e,n,r);case"custom":const a=Object(c["b"])(t.op);if(a&&a.customExecutor)return a.customExecutor(new u(t,e,n));throw TypeError(`Custom op ${t.op} is not registered.`);default:throw TypeError(`Unknown op '${t.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return a["util"].isPromise(o)?o.then(t=>[].concat(t)):[].concat(o)}class G{constructor(t={},e={},n={},r={}){this.weightMap=t,this.tensorArrayMap=e,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(t,e){return{id:t,frameName:e,iterationId:0}}set currentContext(t){this.contexts!==t&&(this.contexts=t,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const t=[];for(let e=0;e<this.contexts.length-1;e++){const n=this.contexts.slice(0,this.contexts.length-e);t.push(this.contextIdforContexts(n))}t.push(""),this._currentContextIds=t}contextIdforContexts(t){return t?t.map(t=>0===t.id&&0===t.iterationId?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(t){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,t)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const t=Object.assign({},this.contexts[this.contexts.length-1]);t.iterationId+=1,t.id=this.lastId,this.contexts.splice(-1,1,t),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(t){return this.weightMap[t]}addTensorArray(t){this.tensorArrayMap[t.id]=t}getTensorArray(t){return this.tensorArrayMap[t]}addTensorList(t){this.tensorListMap[t.id]=t}getTensorList(t){return this.tensorListMap[t]}dispose(t){for(const e in this.tensorArrayMap)this.tensorArrayMap[e].clearAndClose(t);for(const e in this.tensorListMap)this.tensorListMap[e].clearAndClose(t)}}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H(t,e,n,r){const a=new Set,i=[];let o=null,u=null;const c=new Set,l=Object.keys(t).map(t=>Object(s["g"])(t)[0]);let d=[];null!=r&&(d=r.map(t=>Object(s["g"])(t.name)[0]));const h=[...e];while(h.length>0){const t=h.pop();(J(t)||Z(t)||Q(t))&&null==o&&(o=t,u=o.children.map(t=>t.name).filter(t=>a.has(t))),a.add(t.name),null==n[t.name]&&(-1===l.indexOf(t.name)&&-1===d.indexOf(t.name)&&(0!==t.inputs.length?t.inputs.forEach(t=>{c.has(t.name)||(c.add(t.name),h.push(t))}):i.push(t.name)))}return{inputs:t,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:u}}function q(t,e,n){const{usedNodes:r,inputs:a}=n,i=[],o=Object.keys(a).map(t=>Object(s["g"])(t)[0]).map(e=>t.nodes[e]),u=t.initNodes;o.forEach(t=>{r.has(t.name)&&i.push(t)}),t.weights.forEach(t=>{r.has(t.name)&&i.push(t)}),null!=u&&u.forEach(t=>{r.has(t.name)&&i.push(t)});const c=new Set,l=[];while(i.length>0){const t=i.pop();c.add(t.name),e[t.name]||l.push(t),t.children.forEach(t=>{!c.has(t.name)&&r.has(t.name)&&t.inputs.every(t=>c.has(t.name))&&i.push(t)})}return l}const K=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],X=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Y=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function J(t){return K.indexOf(t.op)>=0}function Z(t){return X.indexOf(t.op)>=0}function Q(t){return Y.indexOf(t.op)>=0}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tt{constructor(t,e){this.graph=t,this.parent=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach(e=>{this._functionExecutorMap[e]=new tt(t.functions[e],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(t){const e=Object.keys(t).map(e=>t[e].map(t=>t.id));this._weightIds=[].concat(...e),this._weightMap=t}set resourceManager(t){this._resourceManager=t}get inputs(){return this._inputs.map(t=>({name:t.name,shape:t.attrParams["shape"]?t.attrParams["shape"].value:void 0,dtype:t.attrParams["dtype"]?t.attrParams["dtype"].value:void 0}))}get outputs(){return this._outputs.map(t=>({name:t.name,shape:t.attrParams["shape"]?t.attrParams["shape"].value:void 0,dtype:t.attrParams["dtype"]?t.attrParams["dtype"].value:void 0}))}get inputNodes(){return this._inputs.map(t=>t.signatureKey||t.name)}get outputNodes(){return this._outputs.map(t=>{const e=t.signatureKey||t.name;return t.defaultOutput?`${e}:${t.defaultOutput}`:e})}get functions(){return Object.keys(this._functions).reduce((t,e)=>(t[e]=this._functions[e].signature,t),{})}getCompilationKey(t,e){const n=t.map(t=>t.name).sort(),r=e.map(t=>t.name).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(t,e){const n=H(t,e,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=n;if(null!=a)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const n=e.map(t=>t.name),a=Object.keys(t);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${a}]. Missing the following inputs: [${r}]`)}return q(this.graph,this.weightMap,n)}execute(t,e){t=this.mapInputs(t);const n=Object.keys(t).sort();this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e);const r=n.map(t=>this.graph.nodes[Object(s["g"])(t)[0]]),i=e.map(t=>Object(s["g"])(t)[0]);let o=i.map(t=>this.graph.nodes[t]);this.resetIntermediateTensors(),0===o.length&&(o=this._outputs);const u=this.getCompilationKey(r,o);let c=this.compiledMap.get(u);null==c&&(c=this.compile(t,o),this.compiledMap.set(u,c));const l={},d={};return Object(a["tidy"])(()=>{const n=new G(this.weightMap,l,d,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,a]=Object(s["g"])(e),i=[];i[a]=t[e],r[n]=i});const o=this.getFrozenTensorIds(r),u={};for(let t=0;t<c.length;t++){const e=c[t];if(!r[e.name]){const t=U(e,r,n,this._resourceManager);if(a["util"].isPromise(t))throw new Error(`The execution of the op '${e.op}' returned a promise. Please use model.executeAsync() instead.`);r[e.name]=t,this.checkTensorForDisposal(e.name,e,r,n,o,i,u)}}return null==this.parent&&n.dispose(o),e.map(t=>Object(s["e"])(t,r,n))})}getFrozenTensorIds(t){const e=[].concat.apply([],Object.keys(t).map(e=>t[e]).map(t=>t.map(t=>t.id)));return new Set(e)}checkTensorForDisposal(t,e,n,r,a,i,o){"control"!==e.category&&-1===i.indexOf(t)&&(n[t].forEach(t=>{null!=t&&(o[t.id]=(o[t.id]||0)+e.children.length)}),e.inputs.forEach(t=>{if("control"!==t.category){const i=Object(s["f"])(t.name,n,r);null!=i&&i.forEach(t=>{if(t&&!t.kept&&!a.has(t.id)){const n=o[t.id];if(1===n){if(this.keepTensorForDebug){const[n,a]=Object(s["b"])(e.name,r);this.intermediateTensors[n]||(this.intermediateTensors[n]=[]),this.intermediateTensors[n][a]=t}else t.dispose();delete o[t.id]}else null!=n&&o[t.id]--}})}}))}async executeAsync(t,e){return this._executeAsync(t,e)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(t=>this.intermediateTensors[t].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(t=>{const e=this.tensorsMap[t];e.forEach(t=>{!t||t.kept||t.isDisposed||this.keepIds.has(t.id)||t.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const t in this.intermediateTensors)this.intermediateTensors[t].forEach(t=>t.dispose()),delete this.intermediateTensors[t]}async _executeAsync(t,e,n=!1,r={},i={}){n||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),e=this.mapOutputs(e),this.checkOutputs(e));try{this.keepTensorForDebug=Object(a["env"])().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){console.warn(d.message)}this.resetIntermediateTensors();const o=new G(this.weightMap,r,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(t,o,e,n);const u=e.map(t=>Object(s["e"])(t,this.tensorsMap,o)),c=u.map(t=>t.id),l=Object.keys(t).map(e=>t[e].id);return this.keepIds=new Set([...c,...l,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),null==this.parent&&o.dispose(this.keepIds),u}async executeFunctionAsync(t,e,n){const r=t.reduce((t,e,n)=>(t[this.inputs[n].name]=e,t),{});return this._executeAsync(r,this.outputNodes,!0,e,n)}async executeWithControlFlow(t,e,n,r){const a=Object.keys(t),i=a.map(t=>this.graph.nodes[Object(s["g"])(t)[0]]),o=n.map(t=>Object(s["g"])(t)[0]);let u=o.map(t=>this.graph.nodes[t]);0===u.length&&(u=this._outputs);const{usedNodes:c,missingInputs:l,dynamicNode:d,syncInputs:h}=H(t,u,this.weightMap,this._initNodes),p=[...i,...this.graph.weights,...this._initNodes||[]].map(t=>({node:t,contexts:e.currentContext})),f=Object.assign({},this.weightMap);Object.keys(t).forEach(e=>{const[n,r]=Object(s["g"])(e),a=[];a[r]=t[e],f[n]=a});const m={},g=this.getFrozenTensorIds(f),b={};while(p.length>0){const t=this.processStack(i,p,e,f,b,g,o,m,c);await Promise.all(t)}null!=d||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const y=u.filter(t=>!J(t)&&!Object(s["e"])(t.name,f,e)).map(t=>t.name);if(y.length>0){let t="";throw null!=d&&(t=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${y}] from the provided inputs [${a}]. Consider providing the following inputs: [${l}]. ${t}`)}return f}processStack(t,e,n,r,i,o,u,c,l){const d=[];while(e.length>0){const t=e.pop();n.currentContext=t.contexts;let h="";if("Enter"===t.node.op&&Object(s["d"])("isConstant",t.node,r,n)&&([h]=Object(s["b"])(t.node.name,n)),null==r[t.node.name]){const p=U(t.node,r,n,this._resourceManager);h||([h]=Object(s["b"])(t.node.name,n));const f=n.currentContext;a["util"].isPromise(p)?d.push(p.then(a=>(r[h]=a,n.currentContext=f,this.checkTensorForDisposal(h,t.node,r,n,o,u,c),this.processChildNodes(t.node,e,n,r,i,l),a))):(r[h]=p,this.checkTensorForDisposal(h,t.node,r,n,o,u,c),this.processChildNodes(t.node,e,n,r,i,l))}else this.processChildNodes(t.node,e,n,r,i,l)}return d}processChildNodes(t,e,n,r,a,i){t.children.forEach(t=>{const[o]=Object(s["b"])(t.name,n);!a[o]&&i.has(t.name)&&("Merge"===t.op?t.inputNames.some(t=>!!Object(s["e"])(t,r,n))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})):t.inputNames.every(t=>!!Object(s["e"])(t,r,n))&&(a[o]=!0,e.push({contexts:n.currentContext,node:t})))})}dispose(){Object.keys(this.weightMap).forEach(t=>this.weightMap[t].forEach(t=>t.dispose()))}checkInputShapeAndType(t){Object.keys(t).forEach(e=>{const n=t[e],[r]=Object(s["g"])(e),i=this.graph.nodes[r];if(i.attrParams["shape"]&&i.attrParams["shape"].value){const t=i.attrParams["shape"].value,e=t.length===n.shape.length&&n.shape.every((e,n)=>-1===t[n]||t[n]===e);a["util"].assert(e,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${t}], but was [${n.shape}]`)}i.attrParams["dtype"]&&i.attrParams["dtype"].value&&a["util"].assert(n.dtype===i.attrParams["dtype"].value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams["dtype"].value}, but was ${n.dtype}`)})}mapInputs(t){const e={};for(const n in t)if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]){const r=this._signature.inputs[n];e[r.name]=t[n]}else e[n]=t[n];return e}checkInputs(t){const e=Object.keys(t).filter(t=>{const[e]=Object(s["g"])(t);return null==this.graph.nodes[e]});if(e.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${e}] that are not part of graph`)}mapOutputs(t){return t.map(t=>{if(null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[t]){const e=this._signature.outputs[t];return e.name}return t},{})}checkOutputs(t){t.forEach(t=>{const[e]=Object(s["g"])(t);if(!this.graph.nodes[e])throw new Error(`The output '${t}' is not found in the graph`)})}}class et{constructor(t={},e={}){this.hashTableNameToHandle=t,this.hashTableMap=e}addHashTable(t,e){this.hashTableNameToHandle[t]=e.handle,this.hashTableMap[e.id]=e}getHashTableHandleByName(t){return this.hashTableNameToHandle[t]}getHashTableById(t){return this.hashTableMap[t]}dispose(){for(const t in this.hashTableMap)this.hashTableMap[t].clearAndClose(),delete this.hashTableMap[t];for(const t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nt="?tfjs-format=file",rt="model.json";class at{constructor(t,e={},n=a["io"]){this.modelUrl=t,this.loadOptions=e,this.version="n/a",this.io=n,null==e&&(this.loadOptions={}),this.resourceManager=new et}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const t=this.modelUrl;if(null!=t.load)this.handler=t;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(t,this.loadOptions);else{const e=this.io.getLoadHandlers(t,this.loadOptions);if(0===e.length)e.push(this.io.browserHTTPRequest(t,this.loadOptions));else if(e.length>1)throw new Error(`Found more than one (${e.length}) load handlers for URL '${[t]}'`);this.handler=e[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const t=this.handler.load();return a["util"].isPromise(t)?t.then(t=>this.loadSync(t)):this.loadSync(t)}loadSync(t){this.artifacts=t;const e=this.artifacts.modelTopology;let n=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const t=this.artifacts.userDefinedMetadata;null!=t.signature&&(n=t.signature),null!=t.structuredOutputKeys&&(this.structuredOutputKeys=t.structuredOutputKeys)}this.signature=n,this.version=`${e.versions.producer}.${e.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new tt(o["a"].Instance.transformGraph(e,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=t.modelInitializer&&null!=t.modelInitializer.node){const e=o["a"].Instance.transformGraph(t.modelInitializer);this.initializer=new tt(e),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(t,e){if("string"===typeof t){const e=this.io.getSaveHandlers(t);if(0===e.length)throw new Error(`Cannot find any save handlers for URL '${t}'`);if(e.length>1)throw new Error(`Found more than one (${e.length}) save handlers for URL '${t}'`);t=e[0]}if(null==t.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return t.save(this.artifacts)}predict(t,e){const n=this.execute(t,this.outputNodes);if(this.structuredOutputKeys){const t=n instanceof a["Tensor"]?[n]:n,e={};return t.forEach((t,n)=>e[this.structuredOutputKeys[n]]=t),e}return n}normalizeInputs(t){if(!(t instanceof a["Tensor"])&&!Array.isArray(t))return t;if(t=Array.isArray(t)?t:[t],t.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${t.length} input tensors.`);return this.inputNodes.reduce((e,n,r)=>(e[n]=t[r],e),{})}normalizeOutputs(t){return t=t||this.outputNodes,Array.isArray(t)?t:[t]}execute(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=this.executor.execute(t,e);return n.length>1?n:n[0]}async executeAsync(t,e){t=this.normalizeInputs(t),e=this.normalizeOutputs(e);const n=await this.executor.executeAsync(t,e);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(t){return Object.keys(t).reduce((e,n)=>(e[n]=[t[n]],e),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function it(t,e={},n=a["io"]){if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==e&&(e={}),e.fromTFHub&&"string"===typeof t&&(t=st(t));const r=new at(t,e,n);return await r.load(),r}function ot(t){if(null==t)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[n,r]=t;if(!n)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in n))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in n))throw new Error("Model JSON is missing 'weightsManifest'");const i=a["io"].getWeightSpecs(n.weightsManifest),o=a["io"].getModelArtifactsForJSONSync(n,i,r);e=a["io"].fromMemorySync(o)}else if("load"in t)e=t;else{if(!("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t))throw new Error("Unknown model format");e=a["io"].fromMemorySync(t)}const n=new at(e);return n.load(),n}function st(t){return t.endsWith("/")||(t+="/"),`${t}${rt}${nt}`}
/** @license See the LICENSE file. */const ut="3.21.0";
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},e9cd:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n("2ca8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(t,e,n,a,i){const o=e.length,s=r["util"].sizeFromShape(e),u=r["util"].computeStrides(e),c=r["util"].computeStrides(i),l=r["util"].getTypedArrayFromDType(n,r["util"].sizeFromShape(i));for(let d=0;d<s;++d){const e=r["util"].indexToLoc(d,o,u),n=new Array(e.length);for(let t=0;t<n.length;t++)n[t]=e[a[t]];const i=r["util"].locToIndex(n,o,c);l[i]=t[d]}return l}},e9fa:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}]},ea03:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"x","neg"),n={x:e};return r["a"].runKernel(a["ac"],n)}const u=Object(o["b"])({neg_:s})},ea61:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Container=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("4971"),s=n("4546"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.children=new a.Collection,e}return r(e,t),e.prototype.getChildren=function(t){if(!t)return this.children;var e=new a.Collection;return this.children.each((function(n){t(n)&&e.push(n)})),e},e.prototype.hasChildren=function(){return this.getChildren().length>0},e.prototype.removeChildren=function(){for(var t,e=0;e<this.children.length;e++)t=this.children[e],t.parent=null,t.index=0,t.remove();return this.children=new a.Collection,this},e.prototype.destroyChildren=function(){for(var t,e=0;e<this.children.length;e++)t=this.children[e],t.parent=null,t.index=0,t.destroy();return this.children=new a.Collection,this},e.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}var r=t[0];if(r.getParent())return r.moveTo(this),this;var a=this.children;return this._validateAdd(r),r._clearCaches(),r.index=a.length,r.parent=this,a.push(r),this._fire("add",{child:r}),this},e.prototype.destroy=function(){return this.hasChildren()&&this.destroyChildren(),t.prototype.destroy.call(this),this},e.prototype.find=function(t){return this._generalFind(t,!1)},e.prototype.get=function(t){return a.Util.warn("collection.get() method is deprecated. Please use collection.find() instead."),this.find(t)},e.prototype.findOne=function(t){var e=this._generalFind(t,!0);return e.length>0?e[0]:void 0},e.prototype._generalFind=function(t,e){var n=[];return this._descendants((function(r){var a=r._isMatch(t);return a&&n.push(r),!(!a||!e)})),a.Collection.toCollection(n)},e.prototype._descendants=function(t){for(var e=!1,n=0;n<this.children.length;n++){var r=this.children[n];if(e=t(r),e)return!0;if(r.hasChildren()&&(e=r._descendants(t),e))return!0}return!1},e.prototype.toObject=function(){var t=o.Node.prototype.toObject.call(this);t.children=[];for(var e=this.getChildren(),n=e.length,r=0;r<n;r++){var a=e[r];t.children.push(a.toObject())}return t},e.prototype.isAncestorOf=function(t){var e=t.getParent();while(e){if(e._id===this._id)return!0;e=e.getParent()}return!1},e.prototype.clone=function(t){var e=o.Node.prototype.clone.call(this,t);return this.getChildren().each((function(t){e.add(t.clone())})),e},e.prototype.getAllIntersections=function(t){var e=[];return this.find("Shape").each((function(n){n.isVisible()&&n.intersects(t)&&e.push(n)})),e},e.prototype._setChildrenIndices=function(){this.children.each((function(t,e){t.index=e}))},e.prototype.drawScene=function(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas(),a=r&&r.getContext(),i=this._getCanvasCache(),o=i&&i.scene,s=r&&r.isCache;if(!this.isVisible()&&!s)return this;if(o){a.save();var u=this.getAbsoluteTransform(e).getMatrix();a.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren("drawScene",r,e);return this},e.prototype.drawHit=function(t,e){if(!this.shouldDrawHit(e))return this;var n=this.getLayer(),r=t||n&&n.hitCanvas,a=r&&r.getContext(),i=this._getCanvasCache(),o=i&&i.hit;if(o){a.save();var s=this.getAbsoluteTransform(e).getMatrix();a.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",r,e);return this},e.prototype._drawChildren=function(t,e,n){var r=e&&e.getContext(),a=this.clipWidth(),i=this.clipHeight(),o=this.clipFunc(),s=a&&i||o,u=n===this;if(s){r.save();var c=this.getAbsoluteTransform(n),l=c.getMatrix();if(r.transform(l[0],l[1],l[2],l[3],l[4],l[5]),r.beginPath(),o)o.call(this,r,this);else{var d=this.clipX(),h=this.clipY();r.rect(d,h,a,i)}r.clip(),l=c.copy().invert().getMatrix(),r.transform(l[0],l[1],l[2],l[3],l[4],l[5])}var p=!u&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===t;p&&(r.save(),r._applyGlobalCompositeOperation(this)),this.children.each((function(r){r[t](e,n)})),p&&r.restore(),s&&r.restore()},e.prototype.getClientRect=function(t){t=t||{};var e,n,r,a,i=t.skipTransform,o=t.relativeTo,s={x:1/0,y:1/0,width:0,height:0},u=this;this.children.each((function(i){if(i.visible()){var o=i.getClientRect({relativeTo:u,skipShadow:t.skipShadow,skipStroke:t.skipStroke});0===o.width&&0===o.height||(void 0===e?(e=o.x,n=o.y,r=o.x+o.width,a=o.y+o.height):(e=Math.min(e,o.x),n=Math.min(n,o.y),r=Math.max(r,o.x+o.width),a=Math.max(a,o.y+o.height)))}}));for(var c=this.find("Shape"),l=!1,d=0;d<c.length;d++){var h=c[d];if(h._isVisible(this)){l=!0;break}}return s=l&&void 0!==e?{x:e,y:n,width:r-e,height:a-n}:{x:0,y:0,width:0,height:0},i?s:this._transformedRect(s,o)},e}(o.Node);e.Container=u,i.Factory.addComponentsGetterSetter(u,"clip",["x","y","width","height"]),i.Factory.addGetterSetter(u,"clipX",void 0,s.getNumberValidator()),i.Factory.addGetterSetter(u,"clipY",void 0,s.getNumberValidator()),i.Factory.addGetterSetter(u,"clipWidth",void 0,s.getNumberValidator()),i.Factory.addGetterSetter(u,"clipHeight",void 0,s.getNumberValidator()),i.Factory.addGetterSetter(u,"clipFunc"),a.Collection.mapMethods(u)},eac5:function(t,e){var n=Object.prototype;function r(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||n;return t===r}t.exports=r},eb48:function(t,e){},eb66:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t){return(0,r.withParams)({type:"minValue",min:t},(function(e){return!(0,r.req)(e)||(!/\s/.test(e)||e instanceof Date)&&+e>=+t}))};e.default=a},eb91:function(t,e,n){},eba4:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;var a=n("9cb8"),i=n("f0b4"),o=n("ea61"),s=n("d777"),u=n("f655"),c=n("df93"),l=n("d777"),d=n("7d2a"),h="Stage",p="string",f="px",m="mouseout",g="mouseleave",b="mouseover",y="mouseenter",v="mousemove",x="mousedown",w="mouseup",k="pointermove",S="pointerdown",O="pointerup",_="pointercancel",C="lostpointercapture",T="contextmenu",I="click",N="dblclick",E="touchstart",A="touchend",R="tap",j="dbltap",D="touchmove",F="wheel",M="contentMouseout",P="contentMouseover",$="contentMousemove",L="contentMousedown",B="contentMouseup",z="contentContextmenu",W="contentClick",V="contentDblclick",U="contentTouchstart",G="contentTouchend",H="contentDbltap",q="contentTap",K="contentTouchmove",X="contentWheel",Y="relative",J="konvajs-content",Z="_",Q="container",tt=5,et="",nt=[y,x,v,w,g,E,D,A,b,F,T,S,k,O,_,C],rt=nt.length;function at(t,e){t.content.addEventListener(e,(function(n){t[Z+e](n)}),!1)}var it="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";function ot(t){return void 0===t&&(t={}),(t.clipFunc||t.clipWidth||t.clipHeight)&&a.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),t}e.stages=[];var st=function(t){function n(n){var r=t.call(this,ot(n))||this;return r._pointerPositions=[],r._changedPointerPositions=[],r._buildDOM(),r._bindContentEvents(),e.stages.push(r),r.on("widthChange.konva heightChange.konva",r._resizeDOM),r.on("visibleChange.konva",r._checkVisibility),r.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",(function(){ot(r.attrs)})),r._checkVisibility(),r}return r(n,t),n.prototype._validateAdd=function(t){var e="Layer"===t.getType(),n="FastLayer"===t.getType(),r=e||n;r||a.Util.throw("You may only add layers to the stage.")},n.prototype._checkVisibility=function(){if(this.content){var t=this.visible()?"":"none";this.content.style.display=t}},n.prototype.setContainer=function(t){if(typeof t===p){if("."===t.charAt(0)){var e=t.slice(1);t=document.getElementsByClassName(e)[0]}else{var n;n="#"!==t.charAt(0)?t:t.slice(1),t=document.getElementById(n)}if(!t)throw"Can not find container in document with id "+n}return this._setAttr(Q,t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this},n.prototype.shouldDrawHit=function(){return!0},n.prototype.clear=function(){var t,e=this.children,n=e.length;for(t=0;t<n;t++)e[t].clear();return this},n.prototype.clone=function(t){return t||(t={}),t.container=document.createElement("div"),o.Container.prototype.clone.call(this,t)},n.prototype.destroy=function(){t.prototype.destroy.call(this);var n=this.content;n&&a.Util._isInDocument(n)&&this.container().removeChild(n);var r=e.stages.indexOf(this);return r>-1&&e.stages.splice(r,1),this},n.prototype.getPointerPosition=function(){var t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(a.Util.warn(it),null)},n.prototype._getPointerById=function(t){return this._pointerPositions.find((function(e){return e.id===t}))},n.prototype.getPointersPositions=function(){return this._pointerPositions},n.prototype.getStage=function(){return this},n.prototype.getContent=function(){return this.content},n.prototype._toKonvaCanvas=function(t){t=t||{},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();var e=new u.SceneCanvas({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),n=e.getContext()._context,r=this.children;return(t.x||t.y)&&n.translate(-1*t.x,-1*t.y),r.each((function(e){if(e.isVisible()){var r=e._toKonvaCanvas(t);n.drawImage(r._canvas,t.x,t.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())}})),e},n.prototype.getIntersection=function(t,e){if(!t)return null;var n,r,a=this.children,i=a.length,o=i-1;for(n=o;n>=0;n--)if(r=a[n].getIntersection(t,e),r)return r;return null},n.prototype._resizeDOM=function(){var t=this.width(),e=this.height();this.content&&(this.content.style.width=t+f,this.content.style.height=e+f),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.each((function(n){n.setSize({width:t,height:e}),n.draw()}))},n.prototype.add=function(e){if(arguments.length>1){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this}t.prototype.add.call(this,e);var r=this.children.length;return r>tt&&a.Util.warn("The stage has "+r+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),e.setSize({width:this.width(),height:this.height()}),e.draw(),s.Konva.isBrowser&&this.content.appendChild(e.canvas._canvas),this},n.prototype.getParent=function(){return null},n.prototype.getLayer=function(){return null},n.prototype.hasPointerCapture=function(t){return d.hasPointerCapture(t,this)},n.prototype.setPointerCapture=function(t){d.setPointerCapture(t,this)},n.prototype.releaseCapture=function(t){d.releaseCapture(t,this)},n.prototype.getLayers=function(){return this.getChildren()},n.prototype._bindContentEvents=function(){if(s.Konva.isBrowser)for(var t=0;t<rt;t++)at(this,nt[t])},n.prototype._mouseenter=function(t){this.setPointersPositions(t),this._fire(y,{evt:t,target:this,currentTarget:this})},n.prototype._mouseover=function(t){this.setPointersPositions(t),this._fire(P,{evt:t}),this._fire(b,{evt:t,target:this,currentTarget:this})},n.prototype._mouseleave=function(t){var e;this.setPointersPositions(t);var n=(null===(e=this.targetShape)||void 0===e?void 0:e.getStage())?this.targetShape:null,r=!c.DD.isDragging||s.Konva.hitOnDragEnabled;n&&r?(n._fireAndBubble(m,{evt:t}),n._fireAndBubble(g,{evt:t}),this._fire(g,{evt:t,target:this,currentTarget:this}),this.targetShape=null):r&&(this._fire(g,{evt:t,target:this,currentTarget:this}),this._fire(m,{evt:t,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[],this._fire(M,{evt:t})},n.prototype._mousemove=function(t){var e;if(s.Konva.UA.ieMobile)return this._touchmove(t);this.setPointersPositions(t);var n,r=a.Util._getFirstPointerId(t),i=(null===(e=this.targetShape)||void 0===e?void 0:e.getStage())?this.targetShape:null,o=!c.DD.isDragging||s.Konva.hitOnDragEnabled;if(o){if(n=this.getIntersection(this.getPointerPosition()),n&&n.isListening()){var u=i!==n;o&&u?(i&&(i._fireAndBubble(m,{evt:t,pointerId:r},n),i._fireAndBubble(g,{evt:t,pointerId:r},n)),n._fireAndBubble(b,{evt:t,pointerId:r},i),n._fireAndBubble(y,{evt:t,pointerId:r},i),n._fireAndBubble(v,{evt:t,pointerId:r}),this.targetShape=n):n._fireAndBubble(v,{evt:t,pointerId:r})}else i&&o&&(i._fireAndBubble(m,{evt:t,pointerId:r}),i._fireAndBubble(g,{evt:t,pointerId:r}),this._fire(b,{evt:t,target:this,currentTarget:this,pointerId:r}),this.targetShape=null),this._fire(v,{evt:t,target:this,currentTarget:this,pointerId:r});this._fire($,{evt:t})}t.cancelable&&t.preventDefault()},n.prototype._mousedown=function(t){if(s.Konva.UA.ieMobile)return this._touchstart(t);this.setPointersPositions(t);var e=a.Util._getFirstPointerId(t),n=this.getIntersection(this.getPointerPosition());c.DD.justDragged=!1,s.Konva.listenClickTap=!0,n&&n.isListening()?(this.clickStartShape=n,n._fireAndBubble(x,{evt:t,pointerId:e})):this._fire(x,{evt:t,target:this,currentTarget:this,pointerId:e}),this._fire(L,{evt:t})},n.prototype._mouseup=function(t){if(s.Konva.UA.ieMobile)return this._touchend(t);this.setPointersPositions(t);var e=a.Util._getFirstPointerId(t),n=this.getIntersection(this.getPointerPosition()),r=this.clickStartShape,i=this.clickEndShape,o=!1;s.Konva.inDblClickWindow?(o=!0,clearTimeout(this.dblTimeout)):c.DD.justDragged||(s.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout((function(){s.Konva.inDblClickWindow=!1}),s.Konva.dblClickWindow),n&&n.isListening()?(this.clickEndShape=n,n._fireAndBubble(w,{evt:t,pointerId:e}),s.Konva.listenClickTap&&r&&r._id===n._id&&(n._fireAndBubble(I,{evt:t,pointerId:e}),o&&i&&i===n&&n._fireAndBubble(N,{evt:t,pointerId:e}))):(this.clickEndShape=null,this._fire(w,{evt:t,target:this,currentTarget:this,pointerId:e}),s.Konva.listenClickTap&&this._fire(I,{evt:t,target:this,currentTarget:this,pointerId:e}),o&&this._fire(N,{evt:t,target:this,currentTarget:this,pointerId:e})),this._fire(B,{evt:t}),s.Konva.listenClickTap&&(this._fire(W,{evt:t}),o&&this._fire(V,{evt:t})),s.Konva.listenClickTap=!1,t.cancelable&&t.preventDefault()},n.prototype._contextmenu=function(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(T,{evt:t}):this._fire(T,{evt:t,target:this,currentTarget:this}),this._fire(z,{evt:t})},n.prototype._touchstart=function(t){var e=this;this.setPointersPositions(t);var n=!1;this._changedPointerPositions.forEach((function(r){var a=e.getIntersection(r);s.Konva.listenClickTap=!0,c.DD.justDragged=!1;var i=a&&a.isListening();i&&(s.Konva.captureTouchEventsEnabled&&a.setPointerCapture(r.id),e.tapStartShape=a,a._fireAndBubble(E,{evt:t,pointerId:r.id},e),n=!0,a.isListening()&&a.preventDefault()&&t.cancelable&&t.preventDefault())})),n||this._fire(E,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(U,{evt:t})},n.prototype._touchmove=function(t){var e=this;this.setPointersPositions(t);var n=!c.DD.isDragging||s.Konva.hitOnDragEnabled;if(n){var r=!1,a={};this._changedPointerPositions.forEach((function(n){var i=d.getCapturedShape(n.id)||e.getIntersection(n),o=i&&i.isListening();o&&(a[i._id]||(a[i._id]=!0,i._fireAndBubble(D,{evt:t,pointerId:n.id}),r=!0,i.isListening()&&i.preventDefault()&&t.cancelable&&t.preventDefault()))})),r||this._fire(D,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(K,{evt:t})}c.DD.isDragging&&c.DD.node.preventDefault()&&t.cancelable&&t.preventDefault()},n.prototype._touchend=function(t){var e=this;this.setPointersPositions(t);var n=this.tapEndShape,r=!1;s.Konva.inDblClickWindow?(r=!0,clearTimeout(this.dblTimeout)):c.DD.justDragged||(s.Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout((function(){s.Konva.inDblClickWindow=!1}),s.Konva.dblClickWindow);var a=!1,i={},o=!1,u=!1;this._changedPointerPositions.forEach((function(c){var l=d.getCapturedShape(c.id)||e.getIntersection(c);l&&l.releaseCapture(c.id);var h=l&&l.isListening();h&&(i[l._id]||(i[l._id]=!0,e.tapEndShape=l,l._fireAndBubble(A,{evt:t,pointerId:c.id}),a=!0,s.Konva.listenClickTap&&l===e.tapStartShape&&(o=!0,l._fireAndBubble(R,{evt:t,pointerId:c.id}),r&&n&&n===l&&(u=!0,l._fireAndBubble(j,{evt:t,pointerId:c.id}))),l.isListening()&&l.preventDefault()&&t.cancelable&&t.preventDefault()))})),a||this._fire(A,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva.listenClickTap&&!o&&(this.tapEndShape=null,this._fire(R,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})),r&&!u&&this._fire(j,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire(G,{evt:t}),s.Konva.listenClickTap&&(this._fire(q,{evt:t}),r&&this._fire(H,{evt:t})),this.preventDefault()&&t.cancelable&&t.preventDefault(),s.Konva.listenClickTap=!1},n.prototype._wheel=function(t){this.setPointersPositions(t);var e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(F,{evt:t}):this._fire(F,{evt:t,target:this,currentTarget:this}),this._fire(X,{evt:t})},n.prototype._pointerdown=function(t){if(s.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=d.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(S,d.createEvent(t))}},n.prototype._pointermove=function(t){if(s.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=d.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(k,d.createEvent(t))}},n.prototype._pointerup=function(t){if(s.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=d.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(O,d.createEvent(t)),d.releaseCapture(t.pointerId)}},n.prototype._pointercancel=function(t){if(s.Konva._pointerEventsEnabled){this.setPointersPositions(t);var e=d.getCapturedShape(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(O,d.createEvent(t)),d.releaseCapture(t.pointerId)}},n.prototype._lostpointercapture=function(t){d.releaseCapture(t.pointerId)},n.prototype.setPointersPositions=function(t){var e=this,n=this._getContentPosition(),r=null,i=null;t=t||window.event,void 0!==t.touches?(this._pointerPositions=[],this._changedPointerPositions=[],a.Collection.prototype.each.call(t.touches,(function(t){e._pointerPositions.push({id:t.identifier,x:(t.clientX-n.left)/n.scaleX,y:(t.clientY-n.top)/n.scaleY})})),a.Collection.prototype.each.call(t.changedTouches||t.touches,(function(t){e._changedPointerPositions.push({id:t.identifier,x:(t.clientX-n.left)/n.scaleX,y:(t.clientY-n.top)/n.scaleY})}))):(r=(t.clientX-n.left)/n.scaleX,i=(t.clientY-n.top)/n.scaleY,this.pointerPos={x:r,y:i},this._pointerPositions=[{x:r,y:i,id:a.Util._getFirstPointerId(t)}],this._changedPointerPositions=[{x:r,y:i,id:a.Util._getFirstPointerId(t)}])},n.prototype._setPointerPosition=function(t){a.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)},n.prototype._getContentPosition=function(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}},n.prototype._buildDOM=function(){if(this.bufferCanvas=new u.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new u.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),s.Konva.isBrowser){var t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML=et,this.content=document.createElement("div"),this.content.style.position=Y,this.content.style.userSelect="none",this.content.className=J,this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}},n.prototype.cache=function(){return a.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this},n.prototype.clearCache=function(){return this},n.prototype.batchDraw=function(){return this.children.each((function(t){t.batchDraw()})),this},n}(o.Container);e.Stage=st,st.prototype.nodeType=h,l._registerNode(st),i.Factory.addGetterSetter(st,"container")},ebd5:function(t,e,n){"use strict";n.r(e),n.d(e,"json",(function(){return r}));
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},ec11:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=n("78ef"),a=function(t,e){return(0,r.withParams)({type:"between",min:t,max:e},(function(n){return!(0,r.req)(n)||(!/\s/.test(n)||n instanceof Date)&&+t<=+n&&+e>=+n}))};e.default=a},ec69:function(t,e,n){var r=n("6fcd"),a=n("03dd"),i=n("30c9");function o(t){return i(t)?r(t):a(t)}t.exports=o},ec7c:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const r=1e-7,a=1e-4;class i{constructor(t,e){this.backend=t,this.dataMover=e,this.data=new WeakMap,this.dataIdsCount=0}get(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)}set(t,e){this.dataIdsCount++,this.data.set(t,e)}has(t){return this.data.has(t)}delete(t){return this.dataIdsCount--,this.data.delete(t)}numDataIds(){return this.dataIdsCount}}class o{refCount(t){return s("refCount")}incRef(t){return s("incRef")}timerAvailable(){return!0}time(t){return s("time")}read(t){return s("read")}readSync(t){return s("readSync")}readToGPU(t,e){return s("readToGPU")}numDataIds(){return s("numDataIds")}disposeData(t,e){return s("disposeData")}write(t,e,n){return s("write")}move(t,e,n,r,a){return s("move")}memory(){return s("memory")}floatPrecision(){return s("floatPrecision")}epsilon(){return 32===this.floatPrecision()?r:a}dispose(){return s("dispose")}}function s(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}},ec8c:function(t,e){function n(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}t.exports=n},ed06:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n=0,o=0){const s=Object(i["a"])(t,"x","gather"),u=Object(i["a"])(e,"indices","gather","int32"),c={x:s,indices:u},l={axis:n,batchDims:o};return r["a"].runKernel(a["pb"],c,l)}const u=Object(o["b"])({gather_:s})},ed3d:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=void 0;var r=n("d777"),a=function(){return r.glob.performance&&r.glob.performance.now?function(){return r.glob.performance.now()}:function(){return(new Date).getTime()}}(),i=function(){function t(e,n){this.id=t.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:a(),frameRate:0},this.func=e,this.setLayers(n)}return t.prototype.setLayers=function(t){var e=[];return e=t?t.length>0?t:[t]:[],this.layers=e,this},t.prototype.getLayers=function(){return this.layers},t.prototype.addLayer=function(t){var e,n=this.layers,r=n.length;for(e=0;e<r;e++)if(n[e]._id===t._id)return!1;return this.layers.push(t),!0},t.prototype.isRunning=function(){var e,n=t,r=n.animations,a=r.length;for(e=0;e<a;e++)if(r[e].id===this.id)return!0;return!1},t.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=a(),t._addAnimation(this),this},t.prototype.stop=function(){return t._removeAnimation(this),this},t.prototype._updateFrameObject=function(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},t._addAnimation=function(t){this.animations.push(t),this._handleAnimation()},t._removeAnimation=function(t){var e,n=t.id,r=this.animations,a=r.length;for(e=0;e<a;e++)if(r[e].id===n){this.animations.splice(e,1);break}},t._runFrames=function(){var t,e,n,r,i,o,s,u,c,l={},d=this.animations;for(r=0;r<d.length;r++)if(t=d[r],e=t.layers,n=t.func,t._updateFrameObject(a()),o=e.length,c=!n||!1!==n.call(t,t.frame),c)for(i=0;i<o;i++)s=e[i],void 0!==s._id&&(l[s._id]=s);for(u in l)l.hasOwnProperty(u)&&l[u].draw()},t._animationLoop=function(){var e=t;e.animations.length?(e._runFrames(),requestAnimationFrame(e._animationLoop)):e.animRunning=!1},t._handleAnimation=function(){this.animRunning||(this.animRunning=!0,requestAnimationFrame(this._animationLoop))},t.animations=[],t.animIdCounter=0,t.animRunning=!1,t}();e.Animation=i},ed77:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n){const o=Object(i["a"])(t,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");const s={x:o},u={begin:e,size:n};return r["a"].runKernel(a["Mc"],s,u)}const u=Object(o["b"])({slice_:s})},ed9a:function(t,e,n){"use strict";n.r(e);var r=n("b5ae");for(var a in r)["default"].indexOf(a)<0&&function(t){n.d(e,t,(function(){return r[t]}))}(a)},edfa:function(t,e){function n(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}t.exports=n},ee10:function(t,e,n){(function(e){const r=n("5265"),{StringDecoder:a}=n("7d72");t.exports=function(t,n={}){const i=[];if(e.isBuffer(t)){const e=new a;t=e.write(t)}function o(t){t&&i.push(t.toString())}let s=new r.Stringifier(n);s.on("data",o);for(let e of t)s.write(e);return s.end(),s.off("data",o),i.join("")}}).call(this,n("b639").Buffer)},ee6e:function(t,e,n){(function(e,n){t.exports=n()})("undefined"!==typeof self&&self,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var a=e[r]={i:r,l:!1,exports:{}};return t[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(r,a,function(e){return t[e]}.bind(null,a));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fb15")}({"00ee":function(t,e,n){var r=n("b622"),a=r("toStringTag"),i={};i[a]="z",t.exports="[object z]"===String(i)},"057f":function(t,e,n){var r=n("fc6a"),a=n("241c").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return a(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==i.call(t)?s(t):a(r(t))}},"06cf":function(t,e,n){var r=n("83ab"),a=n("d1e7"),i=n("5c6c"),o=n("fc6a"),s=n("c04e"),u=n("5135"),c=n("0cfb"),l=Object.getOwnPropertyDescriptor;e.f=r?l:function(t,e){if(t=o(t),e=s(e,!0),c)try{return l(t,e)}catch(n){}if(u(t,e))return i(!a.f.call(t,e),t[e])}},"0cfb":function(t,e,n){var r=n("83ab"),a=n("d039"),i=n("cc12");t.exports=!r&&!a((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},"14c3":function(t,e,n){var r=n("c6b6"),a=n("9263");t.exports=function(t,e){var n=t.exec;if("function"===typeof n){var i=n.call(t,e);if("object"!==typeof i)throw TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return a.call(t,e)}},1839:function(t,e,n){e=t.exports=n("24fb")(!1),e.push([t.i,'.k-progress{margin:0;padding:0;color:#606266;font-size:14px;margin-right:8px;margin-bottom:8px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.k-progress,.k-progress-outer{-webkit-box-sizing:border-box;box-sizing:border-box}.k-progress-outer{width:100%;display:inline-block;vertical-align:middle;margin-right:-55px;padding-right:50px}.k-progress-outer-bg{width:100%;position:relative}.k-progress-outer-bg-border{border-radius:100px}.k-progress-outer-line{position:relative;background:#409eff;border-radius:100px;-webkit-transition:all .4s cubic-bezier(.08,.82,.17,1) 0s;transition:all .4s cubic-bezier(.08,.82,.17,1) 0s}.k-progress-outer-line-success{background:#67c23a}.k-progress-outer-line-warning{background:#e6a23c}.k-progress-outer-line-error{background:#f56c6c}.k-progress-outer-line-active{background:#fff;height:inherit;border-radius:10px;opacity:0;-webkit-animation:kp-active 2.4s cubic-bezier(0,0,.2,1) infinite;animation:kp-active 2.4s cubic-bezier(0,0,.2,1) infinite;content:""}.k-progress-outer-cut{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex}.k-progress-text{margin-left:10px;display:inline-block;vertical-align:middle;text-align:left;word-break:keep-all}@-webkit-keyframes kp-active{0%{width:0;opacity:.2}30%{width:0;opacity:.6}to{width:100%;opacity:0}}@keyframes kp-active{0%{width:0;opacity:.2}30%{width:0;opacity:.6}to{width:100%;opacity:0}}@-webkit-keyframes kp-flow{0%{-webkit-filter:hue-rotate(0deg);filter:hue-rotate(0deg)}to{-webkit-filter:hue-rotate(1turn);filter:hue-rotate(1turn)}}@keyframes kp-flow{0%{-webkit-filter:hue-rotate(0deg);filter:hue-rotate(0deg)}to{-webkit-filter:hue-rotate(1turn);filter:hue-rotate(1turn)}}',""])},"1be4":function(t,e,n){var r=n("d066");t.exports=r("document","documentElement")},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1c7e":function(t,e,n){var r=n("b622"),a=r("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[a]=function(){return this},Array.from(s,(function(){throw 2}))}catch(u){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var r={};r[a]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(u){}return n}},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"1dde":function(t,e,n){var r=n("d039"),a=n("b622"),i=n("60ae"),o=a("species");t.exports=function(t){return i>=51||!r((function(){var e=[],n=e.constructor={};return n[o]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"23cb":function(t,e,n){var r=n("a691"),a=Math.max,i=Math.min;t.exports=function(t,e){var n=r(t);return n<0?a(n+e,0):i(n,e)}},"23e7":function(t,e,n){var r=n("da84"),a=n("06cf").f,i=n("9112"),o=n("6eeb"),s=n("ce4e"),u=n("e893"),c=n("94ca");t.exports=function(t,e){var n,l,d,h,p,f,m=t.target,g=t.global,b=t.stat;if(l=g?r:b?r[m]||s(m,{}):(r[m]||{}).prototype,l)for(d in e){if(p=e[d],t.noTargetGet?(f=a(l,d),h=f&&f.value):h=l[d],n=c(g?d:m+(b?".":"#")+d,t.forced),!n&&void 0!==h){if(typeof p===typeof h)continue;u(p,h)}(t.sham||h&&h.sham)&&i(p,"sham",!0),o(l,d,p,t)}}},"241c":function(t,e,n){var r=n("ca84"),a=n("7839"),i=a.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},"24fb":function(t,e,n){"use strict";function r(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"===typeof btoa){var i=a(r),o=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot).concat(t," */")}));return[n].concat(o).concat([i]).join("\n")}return[n].join("\n")}function a(t){var e=btoa(unescape(encodeURIComponent(JSON.stringify(t)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(e);return"/*# ".concat(n," */")}t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=r(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"===typeof t&&(t=[[null,t,""]]);for(var r={},a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var o=0;o<t.length;o++){var s=t[o];null!=s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="(".concat(s[2],") and (").concat(n,")")),e.push(s))}},e}},"25f0":function(t,e,n){"use strict";var r=n("6eeb"),a=n("825a"),i=n("d039"),o=n("ad6d"),s="toString",u=RegExp.prototype,c=u[s],l=i((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),d=c.name!=s;(l||d)&&r(RegExp.prototype,s,(function(){var t=a(this),e=String(t.source),n=t.flags,r=String(void 0===n&&t instanceof RegExp&&!("flags"in u)?o.call(t):n);return"/"+e+"/"+r}),{unsafe:!0})},"35a1":function(t,e,n){var r=n("f5df"),a=n("3f8c"),i=n("b622"),o=i("iterator");t.exports=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||a[r(t)]}},"37e8":function(t,e,n){var r=n("83ab"),a=n("9bf2"),i=n("825a"),o=n("df75");t.exports=r?Object.defineProperties:function(t,e){i(t);var n,r=o(e),s=r.length,u=0;while(s>u)a.f(t,n=r[u++],e[n]);return t}},"3bbe":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},"3ca3":function(t,e,n){"use strict";var r=n("6547").charAt,a=n("69f3"),i=n("7dd0"),o="String Iterator",s=a.set,u=a.getterFor(o);i(String,"String",(function(t){s(this,{type:o,string:String(t),index:0})}),(function(){var t,e=u(this),n=e.string,a=e.index;return a>=n.length?{value:void 0,done:!0}:(t=r(n,a),e.index+=t.length,{value:t,done:!1})}))},"3f8c":function(t,e){t.exports={}},"428f":function(t,e,n){var r=n("da84");t.exports=r},"44ad":function(t,e,n){var r=n("d039"),a=n("c6b6"),i="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==a(t)?i.call(t,""):Object(t)}:Object},"44d2":function(t,e,n){var r=n("b622"),a=n("7c73"),i=n("9112"),o=r("unscopables"),s=Array.prototype;void 0==s[o]&&i(s,o,a(null)),t.exports=function(t){s[o][t]=!0}},4930:function(t,e,n){var r=n("d039");t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},"499e":function(t,e,n){"use strict";function r(t,e){for(var n=[],r={},a=0;a<e.length;a++){var i=e[a],o=i[0],s=i[1],u=i[2],c=i[3],l={id:t+":"+a,css:s,media:u,sourceMap:c};r[o]?r[o].parts.push(l):n.push(r[o]={id:o,parts:[l]})}return n}n.r(e),n.d(e,"default",(function(){return f}));var a="undefined"!==typeof document;if("undefined"!==typeof DEBUG&&DEBUG&&!a)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var i={},o=a&&(document.head||document.getElementsByTagName("head")[0]),s=null,u=0,c=!1,l=function(){},d=null,h="data-vue-ssr-id",p="undefined"!==typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(t,e,n,a){c=n,d=a||{};var o=r(t,e);return m(o),function(e){for(var n=[],a=0;a<o.length;a++){var s=o[a],u=i[s.id];u.refs--,n.push(u)}for(e?(o=r(t,e),m(o)):o=[],a=0;a<n.length;a++)if(u=n[a],0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete i[u.id]}}}function m(t){for(var e=0;e<t.length;e++){var n=t[e],r=i[n.id];if(r){r.refs++;for(var a=0;a<r.parts.length;a++)r.parts[a](n.parts[a]);for(;a<n.parts.length;a++)r.parts.push(b(n.parts[a]));r.parts.length>n.parts.length&&(r.parts.length=n.parts.length)}else{var o=[];for(a=0;a<n.parts.length;a++)o.push(b(n.parts[a]));i[n.id]={id:n.id,refs:1,parts:o}}}}function g(){var t=document.createElement("style");return t.type="text/css",o.appendChild(t),t}function b(t){var e,n,r=document.querySelector("style["+h+'~="'+t.id+'"]');if(r){if(c)return l;r.parentNode.removeChild(r)}if(p){var a=u++;r=s||(s=g()),e=v.bind(null,r,a,!1),n=v.bind(null,r,a,!0)}else r=g(),e=x.bind(null,r),n=function(){r.parentNode.removeChild(r)};return e(t),function(r){if(r){if(r.css===t.css&&r.media===t.media&&r.sourceMap===t.sourceMap)return;e(t=r)}else n()}}var y=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function v(t,e,n,r){var a=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=y(e,a);else{var i=document.createTextNode(a),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}function x(t,e){var n=e.css,r=e.media,a=e.sourceMap;if(r&&t.setAttribute("media",r),d.ssrId&&t.setAttribute(h,e.id),a&&(n+="\n/*# sourceURL="+a.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),t.styleSheet)t.styleSheet.cssText=n;else{while(t.firstChild)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}},"4d64":function(t,e,n){var r=n("fc6a"),a=n("50c4"),i=n("23cb"),o=function(t){return function(e,n,o){var s,u=r(e),c=a(u.length),l=i(o,c);if(t&&n!=n){while(c>l)if(s=u[l++],s!=s)return!0}else for(;c>l;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}};t.exports={includes:o(!0),indexOf:o(!1)}},"4df4":function(t,e,n){"use strict";var r=n("f8c2"),a=n("7b0b"),i=n("9bdd"),o=n("e95a"),s=n("50c4"),u=n("8418"),c=n("35a1");t.exports=function(t){var e,n,l,d,h,p=a(t),f="function"==typeof this?this:Array,m=arguments.length,g=m>1?arguments[1]:void 0,b=void 0!==g,y=0,v=c(p);if(b&&(g=r(g,m>2?arguments[2]:void 0,2)),void 0==v||f==Array&&o(v))for(e=s(p.length),n=new f(e);e>y;y++)u(n,y,b?g(p[y],y):p[y]);else for(d=v.call(p),h=d.next,n=new f;!(l=h.call(d)).done;y++)u(n,y,b?i(d,g,[l.value,y],!0):l.value);return n.length=y,n}},"50c4":function(t,e,n){var r=n("a691"),a=Math.min;t.exports=function(t){return t>0?a(r(t),9007199254740991):0}},5135:function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},5319:function(t,e,n){"use strict";var r=n("d784"),a=n("825a"),i=n("7b0b"),o=n("50c4"),s=n("a691"),u=n("1d80"),c=n("8aa5"),l=n("14c3"),d=Math.max,h=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g,g=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,n){return[function(n,r){var a=u(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,a,r):e.call(String(a),n,r)},function(t,i){var u=n(e,t,this,i);if(u.done)return u.value;var p=a(t),f=String(this),m="function"===typeof i;m||(i=String(i));var b=p.global;if(b){var y=p.unicode;p.lastIndex=0}var v=[];while(1){var x=l(p,f);if(null===x)break;if(v.push(x),!b)break;var w=String(x[0]);""===w&&(p.lastIndex=c(f,o(p.lastIndex),y))}for(var k="",S=0,O=0;O<v.length;O++){x=v[O];for(var _=String(x[0]),C=d(h(s(x.index),f.length),0),T=[],I=1;I<x.length;I++)T.push(g(x[I]));var N=x.groups;if(m){var E=[_].concat(T,C,f);void 0!==N&&E.push(N);var A=String(i.apply(void 0,E))}else A=r(_,f,C,T,N,i);C>=S&&(k+=f.slice(S,C)+A,S=C+_.length)}return k+f.slice(S)}];function r(t,n,r,a,o,s){var u=r+t.length,c=a.length,l=m;return void 0!==o&&(o=i(o),l=f),e.call(s,l,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(u);case"<":s=o[i.slice(1,-1)];break;default:var l=+i;if(0===l)return e;if(l>c){var d=p(l/10);return 0===d?e:d<=c?void 0===a[d-1]?i.charAt(1):a[d-1]+i.charAt(1):e}s=a[l-1]}return void 0===s?"":s}))}}))},5692:function(t,e,n){var r=n("c430"),a=n("c6cd");(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.5.0",mode:r?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,n){var r=n("d066"),a=n("241c"),i=n("7418"),o=n("825a");t.exports=r("Reflect","ownKeys")||function(t){var e=a.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var r=n("1d80"),a=n("5899"),i="["+a+"]",o=RegExp("^"+i+i+"*"),s=RegExp(i+i+"*$"),u=function(t){return function(e){var n=String(r(e));return 1&t&&(n=n.replace(o,"")),2&t&&(n=n.replace(s,"")),n}};t.exports={start:u(1),end:u(2),trim:u(3)}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"60ae":function(t,e,n){var r,a,i=n("da84"),o=n("b39a"),s=i.process,u=s&&s.versions,c=u&&u.v8;c?(r=c.split("."),a=r[0]+r[1]):o&&(r=o.match(/Edge\/(\d+)/),(!r||r[1]>=74)&&(r=o.match(/Chrome\/(\d+)/),r&&(a=r[1]))),t.exports=a&&+a},6547:function(t,e,n){var r=n("a691"),a=n("1d80"),i=function(t){return function(e,n){var i,o,s=String(a(e)),u=r(n),c=s.length;return u<0||u>=c?t?"":void 0:(i=s.charCodeAt(u),i<55296||i>56319||u+1===c||(o=s.charCodeAt(u+1))<56320||o>57343?t?s.charAt(u):i:t?s.slice(u,u+2):o-56320+(i-55296<<10)+65536)}};t.exports={codeAt:i(!1),charAt:i(!0)}},"65f0":function(t,e,n){var r=n("861d"),a=n("e8b5"),i=n("b622"),o=i("species");t.exports=function(t,e){var n;return a(t)&&(n=t.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?r(n)&&(n=n[o],null===n&&(n=void 0)):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}},"69f3":function(t,e,n){var r,a,i,o=n("7f9a"),s=n("da84"),u=n("861d"),c=n("9112"),l=n("5135"),d=n("f772"),h=n("d012"),p=s.WeakMap,f=function(t){return i(t)?a(t):r(t,{})},m=function(t){return function(e){var n;if(!u(e)||(n=a(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return n}};if(o){var g=new p,b=g.get,y=g.has,v=g.set;r=function(t,e){return v.call(g,t,e),e},a=function(t){return b.call(g,t)||{}},i=function(t){return y.call(g,t)}}else{var x=d("state");h[x]=!0,r=function(t,e){return c(t,x,e),e},a=function(t){return l(t,x)?t[x]:{}},i=function(t){return l(t,x)}}t.exports={set:r,get:a,has:i,enforce:f,getterFor:m}},"6eeb":function(t,e,n){var r=n("da84"),a=n("9112"),i=n("5135"),o=n("ce4e"),s=n("8925"),u=n("69f3"),c=u.get,l=u.enforce,d=String(String).split("String");(t.exports=function(t,e,n,s){var u=!!s&&!!s.unsafe,c=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof e||i(n,"name")||a(n,"name",e),l(n).source=d.join("string"==typeof e?e:"")),t!==r?(u?!h&&t[e]&&(c=!0):delete t[e],c?t[e]=n:a(t,e,n)):c?t[e]=n:o(e,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},7156:function(t,e,n){var r=n("861d"),a=n("d2bb");t.exports=function(t,e,n){var i,o;return a&&"function"==typeof(i=e.constructor)&&i!==n&&r(o=i.prototype)&&o!==n.prototype&&a(t,o),t}},7418:function(t,e){e.f=Object.getOwnPropertySymbols},"746f":function(t,e,n){var r=n("428f"),a=n("5135"),i=n("c032"),o=n("9bf2").f;t.exports=function(t){var e=r.Symbol||(r.Symbol={});a(e,t)||o(e,t,{value:i.f(t)})}},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(t,e,n){var r=n("1d80");t.exports=function(t){return Object(r(t))}},"7c73":function(t,e,n){var r=n("825a"),a=n("37e8"),i=n("7839"),o=n("d012"),s=n("1be4"),u=n("cc12"),c=n("f772"),l=c("IE_PROTO"),d="prototype",h=function(){},p=function(){var t,e=u("iframe"),n=i.length,r="<",a="script",o=">",c="java"+a+":";e.style.display="none",s.appendChild(e),e.src=String(c),t=e.contentWindow.document,t.open(),t.write(r+a+o+"document.F=Object"+r+"/"+a+o),t.close(),p=t.F;while(n--)delete p[d][i[n]];return p()};t.exports=Object.create||function(t,e){var n;return null!==t?(h[d]=r(t),n=new h,h[d]=null,n[l]=t):n=p(),void 0===e?n:a(n,e)},o[l]=!0},"7dd0":function(t,e,n){"use strict";var r=n("23e7"),a=n("9ed3"),i=n("e163"),o=n("d2bb"),s=n("d44e"),u=n("9112"),c=n("6eeb"),l=n("b622"),d=n("c430"),h=n("3f8c"),p=n("ae93"),f=p.IteratorPrototype,m=p.BUGGY_SAFARI_ITERATORS,g=l("iterator"),b="keys",y="values",v="entries",x=function(){return this};t.exports=function(t,e,n,l,p,w,k){a(n,e,l);var S,O,_,C=function(t){if(t===p&&A)return A;if(!m&&t in N)return N[t];switch(t){case b:return function(){return new n(this,t)};case y:return function(){return new n(this,t)};case v:return function(){return new n(this,t)}}return function(){return new n(this)}},T=e+" Iterator",I=!1,N=t.prototype,E=N[g]||N["@@iterator"]||p&&N[p],A=!m&&E||C(p),R="Array"==e&&N.entries||E;if(R&&(S=i(R.call(new t)),f!==Object.prototype&&S.next&&(d||i(S)===f||(o?o(S,f):"function"!=typeof S[g]&&u(S,g,x)),s(S,T,!0,!0),d&&(h[T]=x))),p==y&&E&&E.name!==y&&(I=!0,A=function(){return E.call(this)}),d&&!k||N[g]===A||u(N,g,A),h[e]=A,p)if(O={values:C(y),keys:w?A:C(b),entries:C(v)},k)for(_ in O)!m&&!I&&_ in N||c(N,_,O[_]);else r({target:e,proto:!0,forced:m||I},O);return O}},"7f9a":function(t,e,n){var r=n("da84"),a=n("8925"),i=r.WeakMap;t.exports="function"===typeof i&&/native code/.test(a(i))},"825a":function(t,e,n){var r=n("861d");t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,n){var r=n("d039");t.exports=!r((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},8418:function(t,e,n){"use strict";var r=n("c04e"),a=n("9bf2"),i=n("5c6c");t.exports=function(t,e,n){var o=r(e);o in t?a.f(t,o,i(0,n)):t[o]=n}},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8925:function(t,e,n){var r=n("c6cd"),a=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return a.call(t)}),t.exports=r.inspectSource},"8aa5":function(t,e,n){"use strict";var r=n("6547").charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"90e3":function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++n+r).toString(36)}},9112:function(t,e,n){var r=n("83ab"),a=n("9bf2"),i=n("5c6c");t.exports=r?function(t,e,n){return a.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},9263:function(t,e,n){"use strict";var r=n("ad6d"),a=RegExp.prototype.exec,i=String.prototype.replace,o=a,s=function(){var t=/a/,e=/b*/g;return a.call(t,"a"),a.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),u=void 0!==/()??/.exec("")[1],c=s||u;c&&(o=function(t){var e,n,o,c,l=this;return u&&(n=new RegExp("^"+l.source+"$(?!\\s)",r.call(l))),s&&(e=l.lastIndex),o=a.call(l,t),s&&o&&(l.lastIndex=l.global?o.index+o[0].length:e),u&&o&&o.length>1&&i.call(o[0],n,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(o[c]=void 0)})),o}),t.exports=o},"94ca":function(t,e,n){var r=n("d039"),a=/#|\.prototype\./,i=function(t,e){var n=s[o(t)];return n==c||n!=u&&("function"==typeof e?r(e):!!e)},o=i.normalize=function(t){return String(t).replace(a,".").toLowerCase()},s=i.data={},u=i.NATIVE="N",c=i.POLYFILL="P";t.exports=i},"99af":function(t,e,n){"use strict";var r=n("23e7"),a=n("d039"),i=n("e8b5"),o=n("861d"),s=n("7b0b"),u=n("50c4"),c=n("8418"),l=n("65f0"),d=n("1dde"),h=n("b622"),p=n("60ae"),f=h("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",b=p>=51||!a((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),y=d("concat"),v=function(t){if(!o(t))return!1;var e=t[f];return void 0!==e?!!e:i(t)},x=!b||!y;r({target:"Array",proto:!0,forced:x},{concat:function(t){var e,n,r,a,i,o=s(this),d=l(o,0),h=0;for(e=-1,r=arguments.length;e<r;e++)if(i=-1===e?o:arguments[e],v(i)){if(a=u(i.length),h+a>m)throw TypeError(g);for(n=0;n<a;n++,h++)n in i&&c(d,h,i[n])}else{if(h>=m)throw TypeError(g);c(d,h++,i)}return d.length=h,d}})},"9bdd":function(t,e,n){var r=n("825a");t.exports=function(t,e,n,a){try{return a?e(r(n)[0],n[1]):e(n)}catch(o){var i=t["return"];throw void 0!==i&&r(i.call(t)),o}}},"9bf2":function(t,e,n){var r=n("83ab"),a=n("0cfb"),i=n("825a"),o=n("c04e"),s=Object.defineProperty;e.f=r?s:function(t,e,n){if(i(t),e=o(e,!0),i(n),a)try{return s(t,e,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},"9ed3":function(t,e,n){"use strict";var r=n("ae93").IteratorPrototype,a=n("7c73"),i=n("5c6c"),o=n("d44e"),s=n("3f8c"),u=function(){return this};t.exports=function(t,e,n){var c=e+" Iterator";return t.prototype=a(r,{next:i(1,n)}),o(t,c,!1,!0),s[c]=u,t}},a4d3:function(t,e,n){"use strict";var r=n("23e7"),a=n("da84"),i=n("d066"),o=n("c430"),s=n("83ab"),u=n("4930"),c=n("fdbf"),l=n("d039"),d=n("5135"),h=n("e8b5"),p=n("861d"),f=n("825a"),m=n("7b0b"),g=n("fc6a"),b=n("c04e"),y=n("5c6c"),v=n("7c73"),x=n("df75"),w=n("241c"),k=n("057f"),S=n("7418"),O=n("06cf"),_=n("9bf2"),C=n("d1e7"),T=n("9112"),I=n("6eeb"),N=n("5692"),E=n("f772"),A=n("d012"),R=n("90e3"),j=n("b622"),D=n("c032"),F=n("746f"),M=n("d44e"),P=n("69f3"),$=n("b727").forEach,L=E("hidden"),B="Symbol",z="prototype",W=j("toPrimitive"),V=P.set,U=P.getterFor(B),G=Object[z],H=a.Symbol,q=i("JSON","stringify"),K=O.f,X=_.f,Y=k.f,J=C.f,Z=N("symbols"),Q=N("op-symbols"),tt=N("string-to-symbol-registry"),et=N("symbol-to-string-registry"),nt=N("wks"),rt=a.QObject,at=!rt||!rt[z]||!rt[z].findChild,it=s&&l((function(){return 7!=v(X({},"a",{get:function(){return X(this,"a",{value:7}).a}})).a}))?function(t,e,n){var r=K(G,e);r&&delete G[e],X(t,e,n),r&&t!==G&&X(G,e,r)}:X,ot=function(t,e){var n=Z[t]=v(H[z]);return V(n,{type:B,tag:t,description:e}),s||(n.description=e),n},st=u&&"symbol"==typeof H.iterator?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof H},ut=function(t,e,n){t===G&&ut(Q,e,n),f(t);var r=b(e,!0);return f(n),d(Z,r)?(n.enumerable?(d(t,L)&&t[L][r]&&(t[L][r]=!1),n=v(n,{enumerable:y(0,!1)})):(d(t,L)||X(t,L,y(1,{})),t[L][r]=!0),it(t,r,n)):X(t,r,n)},ct=function(t,e){f(t);var n=g(e),r=x(n).concat(ft(n));return $(r,(function(e){s&&!dt.call(n,e)||ut(t,e,n[e])})),t},lt=function(t,e){return void 0===e?v(t):ct(v(t),e)},dt=function(t){var e=b(t,!0),n=J.call(this,e);return!(this===G&&d(Z,e)&&!d(Q,e))&&(!(n||!d(this,e)||!d(Z,e)||d(this,L)&&this[L][e])||n)},ht=function(t,e){var n=g(t),r=b(e,!0);if(n!==G||!d(Z,r)||d(Q,r)){var a=K(n,r);return!a||!d(Z,r)||d(n,L)&&n[L][r]||(a.enumerable=!0),a}},pt=function(t){var e=Y(g(t)),n=[];return $(e,(function(t){d(Z,t)||d(A,t)||n.push(t)})),n},ft=function(t){var e=t===G,n=Y(e?Q:g(t)),r=[];return $(n,(function(t){!d(Z,t)||e&&!d(G,t)||r.push(Z[t])})),r};if(u||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=R(t),n=function(t){this===G&&n.call(Q,t),d(this,L)&&d(this[L],e)&&(this[L][e]=!1),it(this,e,y(1,t))};return s&&at&&it(G,e,{configurable:!0,set:n}),ot(e,t)},I(H[z],"toString",(function(){return U(this).tag})),C.f=dt,_.f=ut,O.f=ht,w.f=k.f=pt,S.f=ft,s&&(X(H[z],"description",{configurable:!0,get:function(){return U(this).description}}),o||I(G,"propertyIsEnumerable",dt,{unsafe:!0}))),c||(D.f=function(t){return ot(j(t),t)}),r({global:!0,wrap:!0,forced:!u,sham:!u},{Symbol:H}),$(x(nt),(function(t){F(t)})),r({target:B,stat:!0,forced:!u},{for:function(t){var e=String(t);if(d(tt,e))return tt[e];var n=H(e);return tt[e]=n,et[n]=e,n},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(d(et,t))return et[t]},useSetter:function(){at=!0},useSimple:function(){at=!1}}),r({target:"Object",stat:!0,forced:!u,sham:!s},{create:lt,defineProperty:ut,defineProperties:ct,getOwnPropertyDescriptor:ht}),r({target:"Object",stat:!0,forced:!u},{getOwnPropertyNames:pt,getOwnPropertySymbols:ft}),r({target:"Object",stat:!0,forced:l((function(){S.f(1)}))},{getOwnPropertySymbols:function(t){return S.f(m(t))}}),q){var mt=!u||l((function(){var t=H();return"[null]"!=q([t])||"{}"!=q({a:t})||"{}"!=q(Object(t))}));r({target:"JSON",stat:!0,forced:mt},{stringify:function(t,e,n){var r,a=[t],i=1;while(arguments.length>i)a.push(arguments[i++]);if(r=e,(p(e)||void 0!==t)&&!st(t))return h(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!st(e))return e}),a[1]=e,q.apply(null,a)}})}H[z][W]||T(H[z],W,H[z].valueOf),M(H,B),A[L]=!0},a630:function(t,e,n){var r=n("23e7"),a=n("4df4"),i=n("1c7e"),o=!i((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:a})},a691:function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},a9e3:function(t,e,n){"use strict";var r=n("83ab"),a=n("da84"),i=n("94ca"),o=n("6eeb"),s=n("5135"),u=n("c6b6"),c=n("7156"),l=n("c04e"),d=n("d039"),h=n("7c73"),p=n("241c").f,f=n("06cf").f,m=n("9bf2").f,g=n("58a8").trim,b="Number",y=a[b],v=y.prototype,x=u(h(v))==b,w=function(t){var e,n,r,a,i,o,s,u,c=l(t,!1);if("string"==typeof c&&c.length>2)if(c=g(c),e=c.charCodeAt(0),43===e||45===e){if(n=c.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(c.charCodeAt(1)){case 66:case 98:r=2,a=49;break;case 79:case 111:r=8,a=55;break;default:return+c}for(i=c.slice(2),o=i.length,s=0;s<o;s++)if(u=i.charCodeAt(s),u<48||u>a)return NaN;return parseInt(i,r)}return+c};if(i(b,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var k,S=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof S&&(x?d((function(){v.valueOf.call(n)})):u(n)!=b)?c(new y(w(e)),n,S):w(e)},O=r?p(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;O.length>_;_++)s(y,k=O[_])&&!s(S,k)&&m(S,k,f(y,k));S.prototype=v,v.constructor=S,o(a,b,S)}},ad6d:function(t,e,n){"use strict";var r=n("825a");t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},ae93:function(t,e,n){"use strict";var r,a,i,o=n("e163"),s=n("9112"),u=n("5135"),c=n("b622"),l=n("c430"),d=c("iterator"),h=!1,p=function(){return this};[].keys&&(i=[].keys(),"next"in i?(a=o(o(i)),a!==Object.prototype&&(r=a)):h=!0),void 0==r&&(r={}),l||u(r,d)||s(r,d,p),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:h}},b041:function(t,e,n){"use strict";var r=n("00ee"),a=n("f5df");t.exports=r?{}.toString:function(){return"[object "+a(this)+"]"}},b301:function(t,e,n){"use strict";var r=n("d039");t.exports=function(t,e){var n=[][t];return!n||!r((function(){n.call(null,e||function(){throw 1},1)}))}},b39a:function(t,e,n){var r=n("d066");t.exports=r("navigator","userAgent")||""},b622:function(t,e,n){var r=n("da84"),a=n("5692"),i=n("5135"),o=n("90e3"),s=n("4930"),u=n("fdbf"),c=a("wks"),l=r.Symbol,d=u?l:o;t.exports=function(t){return i(c,t)||(s&&i(l,t)?c[t]=l[t]:c[t]=d("Symbol."+t)),c[t]}},b727:function(t,e,n){var r=n("f8c2"),a=n("44ad"),i=n("7b0b"),o=n("50c4"),s=n("65f0"),u=[].push,c=function(t){var e=1==t,n=2==t,c=3==t,l=4==t,d=6==t,h=5==t||d;return function(p,f,m,g){for(var b,y,v=i(p),x=a(v),w=r(f,m,3),k=o(x.length),S=0,O=g||s,_=e?O(p,k):n?O(p,0):void 0;k>S;S++)if((h||S in x)&&(b=x[S],y=w(b,S,v),t))if(e)_[S]=y;else if(y)switch(t){case 3:return!0;case 5:return b;case 6:return S;case 2:u.call(_,b)}else if(l)return!1;return d?-1:c||l?l:_}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6)}},c032:function(t,e,n){var r=n("b622");e.f=r},c04e:function(t,e,n){var r=n("861d");t.exports=function(t,e){if(!r(t))return t;var n,a;if(e&&"function"==typeof(n=t.toString)&&!r(a=n.call(t)))return a;if("function"==typeof(n=t.valueOf)&&!r(a=n.call(t)))return a;if(!e&&"function"==typeof(n=t.toString)&&!r(a=n.call(t)))return a;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},c6cd:function(t,e,n){var r=n("da84"),a=n("ce4e"),i="__core-js_shared__",o=r[i]||a(i,{});t.exports=o},c8ba:function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}t.exports=n},c975:function(t,e,n){"use strict";var r=n("23e7"),a=n("4d64").indexOf,i=n("b301"),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0,u=i("indexOf");r({target:"Array",proto:!0,forced:s||u},{indexOf:function(t){return s?o.apply(this,arguments)||0:a(this,t,arguments.length>1?arguments[1]:void 0)}})},ca84:function(t,e,n){var r=n("5135"),a=n("fc6a"),i=n("4d64").indexOf,o=n("d012");t.exports=function(t,e){var n,s=a(t),u=0,c=[];for(n in s)!r(o,n)&&r(s,n)&&c.push(n);while(e.length>u)r(s,n=e[u++])&&(~i(c,n)||c.push(n));return c}},cc12:function(t,e,n){var r=n("da84"),a=n("861d"),i=r.document,o=a(i)&&a(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},ce4e:function(t,e,n){var r=n("da84"),a=n("9112");t.exports=function(t,e){try{a(r,t,e)}catch(n){r[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,n){var r=n("428f"),a=n("da84"),i=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?i(r[t])||i(a[t]):r[t]&&r[t][e]||a[t]&&a[t][e]}},d1e7:function(t,e,n){"use strict";var r={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,i=a&&!r.call({1:2},1);e.f=i?function(t){var e=a(this,t);return!!e&&e.enumerable}:r},d28b:function(t,e,n){var r=n("746f");r("iterator")},d2bb:function(t,e,n){var r=n("825a"),a=n("3bbe");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,n={};try{t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,t.call(n,[]),e=n instanceof Array}catch(i){}return function(n,i){return r(n),a(i),e?t.call(n,i):n.__proto__=i,n}}():void 0)},d3b7:function(t,e,n){var r=n("00ee"),a=n("6eeb"),i=n("b041");r||a(Object.prototype,"toString",i,{unsafe:!0})},d44e:function(t,e,n){var r=n("9bf2").f,a=n("5135"),i=n("b622"),o=i("toStringTag");t.exports=function(t,e,n){t&&!a(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},d67a:function(t,e,n){var r=n("1839");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("3bd4c2e8",r,!0,{sourceMap:!1,shadowMode:!1})},d784:function(t,e,n){"use strict";var r=n("9112"),a=n("6eeb"),i=n("d039"),o=n("b622"),s=n("9263"),u=o("species"),c=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),l=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));t.exports=function(t,e,n,d){var h=o(t),p=!i((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),f=p&&!i((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[u]=function(){return n},n.flags="",n[h]=/./[h]),n.exec=function(){return e=!0,null},n[h](""),!e}));if(!p||!f||"replace"===t&&!c||"split"===t&&!l){var m=/./[h],g=n(h,""[t],(function(t,e,n,r,a){return e.exec===s?p&&!a?{done:!0,value:m.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}})),b=g[0],y=g[1];a(String.prototype,t,b),a(RegExp.prototype,h,2==e?function(t,e){return y.call(t,this,e)}:function(t){return y.call(t,this)}),d&&r(RegExp.prototype[h],"sham",!0)}}},d81d:function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").map,i=n("d039"),o=n("1dde"),s=o("map"),u=s&&!i((function(){[].map.call({length:-1,0:1},(function(t){throw t}))}));r({target:"Array",proto:!0,forced:!s||!u},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},da84:function(t,e,n){(function(e){var n=function(t){return t&&t.Math==Math&&t};t.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof e&&e)||Function("return this")()}).call(this,n("c8ba"))},ddb0:function(t,e,n){var r=n("da84"),a=n("fdbc"),i=n("e260"),o=n("9112"),s=n("b622"),u=s("iterator"),c=s("toStringTag"),l=i.values;for(var d in a){var h=r[d],p=h&&h.prototype;if(p){if(p[u]!==l)try{o(p,u,l)}catch(m){p[u]=l}if(p[c]||o(p,c,d),a[d])for(var f in i)if(p[f]!==i[f])try{o(p,f,i[f])}catch(m){p[f]=i[f]}}}},df75:function(t,e,n){var r=n("ca84"),a=n("7839");t.exports=Object.keys||function(t){return r(t,a)}},e01a:function(t,e,n){"use strict";var r=n("23e7"),a=n("83ab"),i=n("da84"),o=n("5135"),s=n("861d"),u=n("9bf2").f,c=n("e893"),l=i.Symbol;if(a&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},h=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof h?new l(t):void 0===t?l():l(t);return""===t&&(d[e]=!0),e};c(h,l);var p=h.prototype=l.prototype;p.constructor=h;var f=p.toString,m="Symbol(test)"==String(l("test")),g=/^Symbol\((.*)\)[^)]+$/;u(p,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=f.call(t);if(o(d,t))return"";var n=m?e.slice(7,-1):e.replace(g,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:h})}},e163:function(t,e,n){var r=n("5135"),a=n("7b0b"),i=n("f772"),o=n("e177"),s=i("IE_PROTO"),u=Object.prototype;t.exports=o?Object.getPrototypeOf:function(t){return t=a(t),r(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?u:null}},e177:function(t,e,n){var r=n("d039");t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},e25e:function(t,e,n){var r=n("23e7"),a=n("e583");r({global:!0,forced:parseInt!=a},{parseInt:a})},e260:function(t,e,n){"use strict";var r=n("fc6a"),a=n("44d2"),i=n("3f8c"),o=n("69f3"),s=n("7dd0"),u="Array Iterator",c=o.set,l=o.getterFor(u);t.exports=s(Array,"Array",(function(t,e){c(this,{type:u,target:r(t),index:0,kind:e})}),(function(){var t=l(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),i.Arguments=i.Array,a("keys"),a("values"),a("entries")},e583:function(t,e,n){var r=n("da84"),a=n("58a8").trim,i=n("5899"),o=r.parseInt,s=/^[+-]?0[Xx]/,u=8!==o(i+"08")||22!==o(i+"0x16");t.exports=u?function(t,e){var n=a(String(t));return o(n,e>>>0||(s.test(n)?16:10))}:o},e893:function(t,e,n){var r=n("5135"),a=n("56ef"),i=n("06cf"),o=n("9bf2");t.exports=function(t,e){for(var n=a(e),s=o.f,u=i.f,c=0;c<n.length;c++){var l=n[c];r(t,l)||s(t,l,u(e,l))}}},e8b5:function(t,e,n){var r=n("c6b6");t.exports=Array.isArray||function(t){return"Array"==r(t)}},e95a:function(t,e,n){var r=n("b622"),a=n("3f8c"),i=r("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(a.Array===t||o[i]===t)}},f5df:function(t,e,n){var r=n("00ee"),a=n("c6b6"),i=n("b622"),o=i("toStringTag"),s="Arguments"==a(function(){return arguments}()),u=function(t,e){try{return t[e]}catch(n){}};t.exports=r?a:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=u(e=Object(t),o))?n:s?a(e):"Object"==(r=a(e))&&"function"==typeof e.callee?"Arguments":r}},f6fd:function(t,e){(function(t){var e="currentScript",n=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(r){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(r.stack)||[!1])[1];for(t in n)if(n[t].src==e||"interactive"==n[t].readyState)return n[t];return null}}})})(document)},f772:function(t,e,n){var r=n("5692"),a=n("90e3"),i=r("keys");t.exports=function(t){return i[t]||(i[t]=a(t))}},f8c2:function(t,e,n){var r=n("1c0b");t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 0:return function(){return t.call(e)};case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,a){return t.call(e,n,r,a)}}return function(){return t.apply(e,arguments)}}},fb15:function(t,e,n){"use strict";var r;n.r(e),"undefined"!==typeof window&&(n("f6fd"),(r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=r[1]));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"k-progress"},[n("div",{staticClass:"k-progress-outer"},[n("div",{staticClass:"k-progress-outer-bg",class:t.border?"k-progress-outer-bg-border":"",style:t.getOuterStyle()}),n("div",{staticClass:"k-progress-outer-line",class:t.status?"k-progress-outer-line-"+t.status:"",style:t.getLineStyle(),attrs:{id:"k-progress-line-"+t.idNow}},[t.active?n("div",{staticClass:"k-progress-outer-line-active",style:t.getActiveStyle()}):t._e()]),"lump"===t.type?n("div",{staticClass:"k-progress-outer-cut",style:t.getCutStyle()},t._l(t.items,(function(e){return n("div",{key:e,style:t.getCutBarStyle()})})),0):t._e()]),t.showText?n("div",{staticClass:"k-progress-text"},[t._v(t._s(t.content))]):t._e()])},i=[];function o(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function s(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(t){return o(t)||s(t)||u()}n("99af"),n("c975"),n("e260"),n("d81d"),n("a9e3"),n("d3b7"),n("e25e"),n("25f0"),n("5319"),n("ddb0"),n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("3ca3");var l={name:"KProgress",props:{percent:{type:Number,default:0,required:!0,validator:function(t){return t>=0&&t<=100}},showText:{type:Boolean,default:!0},active:{type:Boolean,default:!1},bgColor:{type:String,default:"#ebeef5"},cutColor:{type:String,default:"#ebeef5"},cutWidth:{type:Number,default:1},type:{type:String,default:"line",validator:function(t){return["line","lump"].indexOf(t)>-1}},border:{type:Boolean,default:!0},status:{type:String,validator:function(t){return["success","warning","error"].indexOf(t)>-1}},lineHeight:{type:Number,default:6},color:{type:[String,Array,Function],default:""},colorFlow:{type:Boolean,default:!1},flowSecond:{type:Number,default:5,validator:function(t){return function(t){return[1,2,3,4,5,6].indexOf(t)>-1}}},activeColor:{type:[String,Array],default:""},format:Function},data:function(){return{items:[],idNow:""}},computed:{content:function(){return"function"===typeof this.format?this.format(this.percent)||"":"".concat(this.percent,"%")}},mounted:function(){"lump"===this.type&&this.countCut(),this.idNow=this.getUUID()},methods:{getOuterStyle:function(){var t="";return t+="background: ".concat(this.bgColor,";"),t+="height: ".concat(this.lineHeight,"px;"),t},getLineStyle:function(){var t="";if(t+="width: ".concat(this.percent,"%;"),t+="height: ".concat(this.lineHeight,"px;margin-top: -").concat(this.lineHeight,"px;"),this.color)if("string"===typeof this.color)t+="background: ".concat(this.color,";");else if(Array.isArray(this.color)&&this.color.length<7){var e="",n=this.color.length;this.color.map((function(t,r){e+=r===n-1?t:t+", "})),t+="background: linear-gradient(to right, ".concat(e,");")}else"function"===typeof this.color&&(t+="background: ".concat(this.color(this.percent),";"));return this.border||(t+="border-radius: 0px"),this.colorFlow&&(t+="animation: kp-flow ".concat(this.flowSecond,"s linear infinite")),t},getActiveStyle:function(){var t="";return this.activeColor&&"string"===typeof this.activeColor&&(t="background: ".concat(this.activeColor,";")),t},countCut:function(){var t=this,e=this,n=document.getElementById("k-progress-line-".concat(this.idNow)),r=setInterval((function(){if(n=document.getElementById("k-progress-line-".concat(t.idNow)),n){clearInterval(r);var a=parseInt(n.offsetWidth/(e.lineHeight+e.cutWidth));e.items=c(Array(a).keys())}}),1)},getCutStyle:function(){var t="";return t+="height: ".concat(this.lineHeight,"px; margin-top: -").concat(this.lineHeight,"px;"),t},getCutBarStyle:function(){var t="";return t+="width: ".concat(this.lineHeight,"px;"),t+="border-right: ".concat(this.cutWidth,"px solid ").concat(this.cutColor,";"),t},getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){return("x"===t?16*Math.random()|0:8).toString(16)}))}}},d=l;function h(t,e,n,r,a,i,o,s){var u,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),o?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=u):a&&(u=s?function(){a.call(this,this.$root.$options.shadowRoot)}:a),u)if(c.functional){c._injectStyles=u;var l=c.render;c.render=function(t,e){return u.call(e),l(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,u):[u]}return{exports:t,options:c}}var p=h(d,a,i,!1,null,null,null),f=p.exports,m=(n("d67a"),f);e["default"]=m},fc6a:function(t,e,n){var r=n("44ad"),a=n("1d80");t.exports=function(t){return r(a(t))}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,n){var r=n("4930");t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol()}})}))},eea1:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return i}));var r=n("32fe");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a(...t){Object(r["c"])().getBool("IS_TEST")||Object(r["c"])().getBool("PROD")||console.warn(...t)}function i(...t){Object(r["c"])().getBool("IS_TEST")||Object(r["c"])().getBool("PROD")||console.log(...t)}},ef5d:function(t,e){function n(t){return function(e){return null==e?void 0:e[t]}}t.exports=n},efb6:function(t,e,n){var r=n("5e2e");function a(){this.__data__=new r,this.size=0}t.exports=a},f0b4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;var r=n("9cb8"),a=n("4546"),i="get",o="set";e.Factory={addGetterSetter:function(t,n,r,a,i){e.Factory.addGetter(t,n,r),e.Factory.addSetter(t,n,a,i),e.Factory.addOverloadedGetterSetter(t,n)},addGetter:function(t,e,n){var a=i+r.Util._capitalize(e);t.prototype[a]=t.prototype[a]||function(){var t=this.attrs[e];return void 0===t?n:t}},addSetter:function(t,n,a,i){var s=o+r.Util._capitalize(n);t.prototype[s]||e.Factory.overWriteSetter(t,n,a,i)},overWriteSetter:function(t,e,n,a){var i=o+r.Util._capitalize(e);t.prototype[i]=function(t){return n&&void 0!==t&&null!==t&&(t=n.call(this,t,e)),this._setAttr(e,t),a&&a.call(this),this}},addComponentsGetterSetter:function(t,n,s,u,c){var l,d,h=s.length,p=r.Util._capitalize,f=i+p(n),m=o+p(n);t.prototype[f]=function(){var t={};for(l=0;l<h;l++)d=s[l],t[d]=this.getAttr(n+p(d));return t};var g=a.getComponentValidator(s);t.prototype[m]=function(t){var e,r=this.attrs[n];for(e in u&&(t=u.call(this,t)),g&&g.call(this,t,n),t)t.hasOwnProperty(e)&&this._setAttr(n+p(e),t[e]);return this._fireChangeEvent(n,r,t),c&&c.call(this),this},e.Factory.addOverloadedGetterSetter(t,n)},addOverloadedGetterSetter:function(t,e){var n=r.Util._capitalize(e),a=o+n,s=i+n;t.prototype[e]=function(){return arguments.length?(this[a](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter:function(t,n,a,o){r.Util.error("Adding deprecated "+n);var s=i+r.Util._capitalize(n),u=n+" property is deprecated and will be removed soon. Look at Konva change log for more information.";t.prototype[s]=function(){r.Util.error(u);var t=this.attrs[n];return void 0===t?a:t},e.Factory.addSetter(t,n,o,(function(){r.Util.error(u)})),e.Factory.addOverloadedGetterSetter(t,n)},backCompat:function(t,e){r.Util.each(e,(function(e,n){var a=t.prototype[n],s=i+r.Util._capitalize(e),u=o+r.Util._capitalize(e);function c(){a.apply(this,arguments),r.Util.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+n+'" instead.')}t.prototype[e]=c,t.prototype[s]=c,t.prototype[u]=c}))},afterSetFilter:function(){this._filterUpToDate=!1}}},f137:function(t,e,n){"use strict";n.d(e,"d",(function(){return Dt})),n.d(e,"e",(function(){return Mt})),n.d(e,"f",(function(){return Lt})),n.d(e,"g",(function(){return Wt})),n.d(e,"gc",(function(){return Ut})),n.d(e,"rc",(function(){return jt})),n.d(e,"sc",(function(){return Ht})),n.d(e,"zc",(function(){return Gt})),n.d(e,"Tc",(function(){return Vt})),n.d(e,"yd",(function(){return rt["a"]})),n.d(e,"zd",(function(){return rt["b"]})),n.d(e,"Id",(function(){return rt["c"]})),n.d(e,"Dc",(function(){return qt["a"]})),n.d(e,"hi",(function(){return qt["b"]})),n.d(e,"Fi",(function(){return qt["c"]})),n.d(e,"Ld",(function(){return Kt["b"]})),n.d(e,"Md",(function(){return Kt["c"]})),n.d(e,"Nd",(function(){return Kt["d"]})),n.d(e,"Od",(function(){return Kt["e"]})),n.d(e,"Pd",(function(){return Kt["f"]})),n.d(e,"Qd",(function(){return Kt["g"]})),n.d(e,"Rd",(function(){return Kt["h"]})),n.d(e,"Sd",(function(){return Kt["i"]})),n.d(e,"Td",(function(){return Kt["j"]})),n.d(e,"Ud",(function(){return Kt["k"]})),n.d(e,"Vd",(function(){return Kt["l"]})),n.d(e,"Wd",(function(){return Kt["m"]})),n.d(e,"Xd",(function(){return Kt["n"]})),n.d(e,"Yd",(function(){return Kt["o"]})),n.d(e,"Zd",(function(){return Kt["p"]})),n.d(e,"ae",(function(){return Kt["q"]})),n.d(e,"de",(function(){return Kt["r"]})),n.d(e,"ie",(function(){return Kt["w"]})),n.d(e,"ee",(function(){return Kt["s"]})),n.d(e,"fe",(function(){return Kt["t"]})),n.d(e,"ge",(function(){return Kt["u"]})),n.d(e,"he",(function(){return Kt["v"]})),n.d(e,"je",(function(){return Kt["x"]})),n.d(e,"le",(function(){return Kt["z"]})),n.d(e,"me",(function(){return Kt["A"]})),n.d(e,"pe",(function(){return Kt["B"]})),n.d(e,"qe",(function(){return Kt["C"]})),n.d(e,"re",(function(){return Kt["D"]})),n.d(e,"se",(function(){return Kt["E"]})),n.d(e,"te",(function(){return Kt["F"]})),n.d(e,"ue",(function(){return Kt["G"]})),n.d(e,"ve",(function(){return Kt["H"]})),n.d(e,"we",(function(){return Kt["I"]})),n.d(e,"xe",(function(){return Kt["J"]})),n.d(e,"ye",(function(){return Kt["K"]})),n.d(e,"ze",(function(){return Kt["L"]})),n.d(e,"Ae",(function(){return Kt["M"]})),n.d(e,"Be",(function(){return Kt["N"]})),n.d(e,"Ce",(function(){return Kt["O"]})),n.d(e,"De",(function(){return Kt["P"]})),n.d(e,"Ee",(function(){return Kt["Q"]})),n.d(e,"Ge",(function(){return Kt["R"]})),n.d(e,"He",(function(){return Kt["S"]})),n.d(e,"Je",(function(){return Kt["U"]})),n.d(e,"Ke",(function(){return Kt["V"]})),n.d(e,"Me",(function(){return Kt["W"]})),n.d(e,"Oe",(function(){return Kt["X"]})),n.d(e,"Pe",(function(){return Kt["Y"]})),n.d(e,"Re",(function(){return Kt["Z"]})),n.d(e,"Se",(function(){return Kt["ab"]})),n.d(e,"We",(function(){return Kt["bb"]})),n.d(e,"Xe",(function(){return Kt["cb"]})),n.d(e,"Ye",(function(){return Kt["db"]})),n.d(e,"af",(function(){return Kt["fb"]})),n.d(e,"bf",(function(){return Kt["gb"]})),n.d(e,"hf",(function(){return Kt["ib"]})),n.d(e,"if",(function(){return Kt["jb"]})),n.d(e,"jf",(function(){return Kt["kb"]})),n.d(e,"kf",(function(){return Kt["lb"]})),n.d(e,"lf",(function(){return Kt["mb"]})),n.d(e,"mf",(function(){return Kt["nb"]})),n.d(e,"nf",(function(){return Kt["ob"]})),n.d(e,"pf",(function(){return Kt["qb"]})),n.d(e,"sf",(function(){return Kt["rb"]})),n.d(e,"tf",(function(){return Kt["sb"]})),n.d(e,"vf",(function(){return Kt["ub"]})),n.d(e,"Ef",(function(){return Kt["wb"]})),n.d(e,"Ff",(function(){return Kt["xb"]})),n.d(e,"Hf",(function(){return Kt["zb"]})),n.d(e,"Mf",(function(){return Kt["Db"]})),n.d(e,"Nf",(function(){return Kt["Eb"]})),n.d(e,"Of",(function(){return Kt["Fb"]})),n.d(e,"Rf",(function(){return Kt["Gb"]})),n.d(e,"Sf",(function(){return Kt["Hb"]})),n.d(e,"Tf",(function(){return Kt["Ib"]})),n.d(e,"Vf",(function(){return Kt["Kb"]})),n.d(e,"Wf",(function(){return Kt["Lb"]})),n.d(e,"Xf",(function(){return Kt["Mb"]})),n.d(e,"Yf",(function(){return Kt["Nb"]})),n.d(e,"Zf",(function(){return Kt["Ob"]})),n.d(e,"ag",(function(){return Kt["Pb"]})),n.d(e,"bg",(function(){return Kt["Qb"]})),n.d(e,"cg",(function(){return Kt["Rb"]})),n.d(e,"dg",(function(){return Kt["Sb"]})),n.d(e,"eg",(function(){return Kt["Tb"]})),n.d(e,"fg",(function(){return Kt["Ub"]})),n.d(e,"hg",(function(){return Kt["Wb"]})),n.d(e,"ig",(function(){return Kt["Xb"]})),n.d(e,"kg",(function(){return Kt["Yb"]})),n.d(e,"lg",(function(){return Kt["Zb"]})),n.d(e,"mg",(function(){return Kt["ac"]})),n.d(e,"ng",(function(){return Kt["bc"]})),n.d(e,"og",(function(){return Kt["cc"]})),n.d(e,"pg",(function(){return Kt["dc"]})),n.d(e,"rg",(function(){return Kt["ec"]})),n.d(e,"sg",(function(){return Kt["fc"]})),n.d(e,"tg",(function(){return Kt["gc"]})),n.d(e,"ug",(function(){return Kt["hc"]})),n.d(e,"vg",(function(){return Kt["ic"]})),n.d(e,"wg",(function(){return Kt["jc"]})),n.d(e,"yg",(function(){return Kt["lc"]})),n.d(e,"zg",(function(){return Kt["mc"]})),n.d(e,"Ag",(function(){return Kt["nc"]})),n.d(e,"Bg",(function(){return Kt["oc"]})),n.d(e,"Eg",(function(){return Kt["qc"]})),n.d(e,"Fg",(function(){return Kt["rc"]})),n.d(e,"Gg",(function(){return Kt["sc"]})),n.d(e,"Hg",(function(){return Kt["tc"]})),n.d(e,"Jg",(function(){return Kt["vc"]})),n.d(e,"Kg",(function(){return Kt["wc"]})),n.d(e,"Lg",(function(){return Kt["xc"]})),n.d(e,"Mg",(function(){return Kt["yc"]})),n.d(e,"Ng",(function(){return Kt["zc"]})),n.d(e,"Og",(function(){return Kt["Ac"]})),n.d(e,"Pg",(function(){return Kt["Bc"]})),n.d(e,"Qg",(function(){return Kt["Cc"]})),n.d(e,"Rg",(function(){return Kt["Dc"]})),n.d(e,"Sg",(function(){return Kt["Ec"]})),n.d(e,"Tg",(function(){return Kt["Fc"]})),n.d(e,"Vg",(function(){return Kt["Gc"]})),n.d(e,"Wg",(function(){return Kt["Hc"]})),n.d(e,"Xg",(function(){return Kt["Ic"]})),n.d(e,"Yg",(function(){return Kt["Jc"]})),n.d(e,"Zg",(function(){return Kt["Kc"]})),n.d(e,"ah",(function(){return Kt["Lc"]})),n.d(e,"bh",(function(){return Kt["Mc"]})),n.d(e,"ch",(function(){return Kt["Nc"]})),n.d(e,"eh",(function(){return Kt["Oc"]})),n.d(e,"fh",(function(){return Kt["Pc"]})),n.d(e,"jh",(function(){return Kt["Qc"]})),n.d(e,"kh",(function(){return Kt["Rc"]})),n.d(e,"mh",(function(){return Kt["Sc"]})),n.d(e,"nh",(function(){return Kt["Tc"]})),n.d(e,"oh",(function(){return Kt["Uc"]})),n.d(e,"ph",(function(){return Kt["Vc"]})),n.d(e,"qh",(function(){return Kt["Wc"]})),n.d(e,"rh",(function(){return Kt["Xc"]})),n.d(e,"th",(function(){return Kt["Zc"]})),n.d(e,"uh",(function(){return Kt["ad"]})),n.d(e,"vh",(function(){return Kt["bd"]})),n.d(e,"zh",(function(){return Kt["ed"]})),n.d(e,"Ah",(function(){return Kt["fd"]})),n.d(e,"Eh",(function(){return Kt["gd"]})),n.d(e,"Fh",(function(){return Kt["hd"]})),n.d(e,"Gh",(function(){return Kt["id"]})),n.d(e,"Ih",(function(){return Kt["kd"]})),n.d(e,"Jh",(function(){return Kt["ld"]})),n.d(e,"Kh",(function(){return Kt["md"]})),n.d(e,"Lh",(function(){return Kt["nd"]})),n.d(e,"Mh",(function(){return Kt["od"]})),n.d(e,"Nh",(function(){return Kt["pd"]})),n.d(e,"Oh",(function(){return Kt["qd"]})),n.d(e,"Qh",(function(){return Kt["rd"]})),n.d(e,"Rh",(function(){return Kt["sd"]})),n.d(e,"Sh",(function(){return Kt["td"]})),n.d(e,"of",(function(){return Kt["pb"]})),n.d(e,"Gf",(function(){return Kt["yb"]})),n.d(e,"Lf",(function(){return Kt["Cb"]})),n.d(e,"sh",(function(){return Kt["Yc"]})),n.d(e,"Wh",(function(){return Kt["xd"]})),n.d(e,"Xh",(function(){return Kt["yd"]})),n.d(e,"Yh",(function(){return Kt["zd"]})),n.d(e,"Zh",(function(){return Kt["Ad"]})),n.d(e,"ai",(function(){return Kt["Bd"]})),n.d(e,"bi",(function(){return Kt["Cd"]})),n.d(e,"ci",(function(){return Kt["Dd"]})),n.d(e,"di",(function(){return Kt["Ed"]})),n.d(e,"fi",(function(){return Kt["Gd"]})),n.d(e,"gi",(function(){return Kt["Hd"]})),n.d(e,"ii",(function(){return Kt["Id"]})),n.d(e,"ji",(function(){return Kt["Jd"]})),n.d(e,"ki",(function(){return Kt["Kd"]})),n.d(e,"li",(function(){return Kt["Ld"]})),n.d(e,"mi",(function(){return Kt["Md"]})),n.d(e,"ni",(function(){return Kt["Nd"]})),n.d(e,"oi",(function(){return Kt["Od"]})),n.d(e,"pi",(function(){return Kt["Pd"]})),n.d(e,"qi",(function(){return Kt["Qd"]})),n.d(e,"ui",(function(){return Kt["Rd"]})),n.d(e,"wi",(function(){return Kt["Sd"]})),n.d(e,"zi",(function(){return Kt["Ud"]})),n.d(e,"Ai",(function(){return Kt["Vd"]})),n.d(e,"Di",(function(){return Kt["Wd"]})),n.d(e,"Ei",(function(){return Kt["Xd"]})),n.d(e,"Gi",(function(){return Kt["Yd"]})),n.d(e,"Ki",(function(){return Kt["Zd"]})),n.d(e,"Ni",(function(){return Kt["ae"]})),n.d(e,"Oi",(function(){return Kt["be"]})),n.d(e,"Pi",(function(){return Kt["ce"]})),n.d(e,"Qi",(function(){return Kt["de"]})),n.d(e,"ke",(function(){return Kt["y"]})),n.d(e,"yi",(function(){return Kt["Td"]})),n.d(e,"Dg",(function(){return Kt["pc"]})),n.d(e,"xg",(function(){return Kt["kc"]})),n.d(e,"wh",(function(){return Kt["cd"]})),n.d(e,"yh",(function(){return Kt["dd"]})),n.d(e,"Uh",(function(){return Kt["vd"]})),n.d(e,"wf",(function(){return Kt["vb"]})),n.d(e,"Ze",(function(){return Kt["eb"]})),n.d(e,"ef",(function(){return Kt["hb"]})),n.d(e,"Ie",(function(){return Kt["T"]})),n.d(e,"Jf",(function(){return Kt["Bb"]})),n.d(e,"Ig",(function(){return Kt["uc"]})),n.d(e,"oc",(function(){return Kt["a"]})),n.d(e,"If",(function(){return Kt["Ab"]})),n.d(e,"Uf",(function(){return Kt["Jb"]})),n.d(e,"gg",(function(){return Kt["Vb"]})),n.d(e,"Vh",(function(){return Kt["wd"]})),n.d(e,"uf",(function(){return Kt["tb"]})),n.d(e,"Hh",(function(){return Kt["jd"]})),n.d(e,"Th",(function(){return Kt["ud"]})),n.d(e,"ei",(function(){return Kt["Fd"]})),n.d(e,"Hc",(function(){return Xt["a"]})),n.d(e,"xi",(function(){return Yt})),n.d(e,"df",(function(){return Ot["g"]})),n.d(e,"cf",(function(){return Ot["f"]})),n.d(e,"Te",(function(){return Ot["c"]})),n.d(e,"Ne",(function(){return Ot["b"]})),n.d(e,"Ve",(function(){return Ot["e"]})),n.d(e,"ff",(function(){return Ot["h"]})),n.d(e,"qg",(function(){return Ot["m"]})),n.d(e,"Ug",(function(){return Ot["n"]})),n.d(e,"ti",(function(){return Ot["t"]})),n.d(e,"Ue",(function(){return Ot["d"]})),n.d(e,"Pf",(function(){return Ot["l"]})),n.d(e,"vi",(function(){return Ot["u"]})),n.d(e,"Ch",(function(){return Ot["r"]})),n.d(e,"dh",(function(){return Ot["o"]})),n.d(e,"yf",(function(){return Ot["k"]})),n.d(e,"lh",(function(){return Ot["q"]})),n.d(e,"qf",(function(){return Ot["i"]})),n.d(e,"rf",(function(){return Ot["j"]})),n.d(e,"gh",(function(){return Ot["p"]})),n.d(e,"be",(function(){return Ot["a"]})),n.d(e,"Dh",(function(){return Ot["s"]})),n.d(e,"Af",(function(){return nt["c"]})),n.d(e,"zf",(function(){return nt["b"]})),n.d(e,"Bf",(function(){return nt["d"]})),n.d(e,"ih",(function(){return nt["f"]})),n.d(e,"hh",(function(){return nt["e"]})),n.d(e,"Ci",(function(){return nt["h"]})),n.d(e,"Bi",(function(){return nt["g"]})),n.d(e,"Fe",(function(){return nt["a"]})),n.d(e,"Le",(function(){return At["a"]})),n.d(e,"Cf",(function(){return At["b"]})),n.d(e,"Df",(function(){return At["c"]})),n.d(e,"Ii",(function(){return At["d"]})),n.d(e,"Ji",(function(){return At["e"]})),n.d(e,"Li",(function(){return At["f"]})),n.d(e,"gb",(function(){return d["b"]})),n.d(e,"gf",(function(){return d["c"]})),n.d(e,"cb",(function(){return d["a"]})),n.d(e,"Mi",(function(){return St})),n.d(e,"Cg",(function(){return Zt})),n.d(e,"oe",(function(){return i})),n.d(e,"Kf",(function(){return r})),n.d(e,"jg",(function(){return a})),n.d(e,"Bh",(function(){return s})),n.d(e,"si",(function(){return wt})),n.d(e,"Hi",(function(){return kt})),n.d(e,"ce",(function(){return c})),n.d(e,"ne",(function(){return Q})),n.d(e,"ri",(function(){return xt})),n.d(e,"Ph",(function(){return gt})),n.d(e,"xf",(function(){return o})),n.d(e,"xh",(function(){return mt})),n.d(e,"Qe",(function(){return un})),n.d(e,"Qf",(function(){return l})),n.d(e,"Fb",(function(){return dn["b"]})),n.d(e,"S",(function(){return dn["a"]})),n.d(e,"a",(function(){return et["a"]})),n.d(e,"b",(function(){return et["b"]})),n.d(e,"c",(function(){return et["c"]})),n.d(e,"h",(function(){return et["d"]})),n.d(e,"i",(function(){return et["e"]})),n.d(e,"j",(function(){return et["f"]})),n.d(e,"k",(function(){return et["g"]})),n.d(e,"l",(function(){return et["h"]})),n.d(e,"m",(function(){return et["i"]})),n.d(e,"n",(function(){return et["j"]})),n.d(e,"o",(function(){return et["k"]})),n.d(e,"p",(function(){return et["l"]})),n.d(e,"r",(function(){return et["n"]})),n.d(e,"q",(function(){return et["m"]})),n.d(e,"s",(function(){return et["o"]})),n.d(e,"v",(function(){return et["r"]})),n.d(e,"t",(function(){return et["p"]})),n.d(e,"u",(function(){return et["q"]})),n.d(e,"w",(function(){return et["s"]})),n.d(e,"x",(function(){return et["t"]})),n.d(e,"y",(function(){return et["u"]})),n.d(e,"A",(function(){return et["w"]})),n.d(e,"z",(function(){return et["v"]})),n.d(e,"B",(function(){return et["x"]})),n.d(e,"C",(function(){return et["y"]})),n.d(e,"D",(function(){return et["z"]})),n.d(e,"E",(function(){return et["A"]})),n.d(e,"F",(function(){return et["B"]})),n.d(e,"G",(function(){return et["C"]})),n.d(e,"H",(function(){return et["D"]})),n.d(e,"I",(function(){return et["E"]})),n.d(e,"J",(function(){return et["F"]})),n.d(e,"K",(function(){return et["G"]})),n.d(e,"L",(function(){return et["H"]})),n.d(e,"M",(function(){return et["I"]})),n.d(e,"N",(function(){return et["J"]})),n.d(e,"O",(function(){return et["K"]})),n.d(e,"Q",(function(){return et["M"]})),n.d(e,"R",(function(){return et["N"]})),n.d(e,"P",(function(){return et["L"]})),n.d(e,"T",(function(){return et["O"]})),n.d(e,"U",(function(){return et["P"]})),n.d(e,"V",(function(){return et["Q"]})),n.d(e,"W",(function(){return et["R"]})),n.d(e,"X",(function(){return et["S"]})),n.d(e,"Y",(function(){return et["T"]})),n.d(e,"Z",(function(){return et["U"]})),n.d(e,"bb",(function(){return et["W"]})),n.d(e,"ab",(function(){return et["V"]})),n.d(e,"Fc",(function(){return et["rc"]})),n.d(e,"db",(function(){return et["X"]})),n.d(e,"eb",(function(){return et["Y"]})),n.d(e,"fb",(function(){return et["Z"]})),n.d(e,"ib",(function(){return et["bb"]})),n.d(e,"hb",(function(){return et["ab"]})),n.d(e,"jb",(function(){return et["cb"]})),n.d(e,"kb",(function(){return et["db"]})),n.d(e,"lb",(function(){return et["eb"]})),n.d(e,"mb",(function(){return et["fb"]})),n.d(e,"nb",(function(){return et["gb"]})),n.d(e,"ob",(function(){return et["hb"]})),n.d(e,"pb",(function(){return et["ib"]})),n.d(e,"qb",(function(){return et["jb"]})),n.d(e,"sb",(function(){return et["lb"]})),n.d(e,"wb",(function(){return et["pb"]})),n.d(e,"vb",(function(){return et["ob"]})),n.d(e,"xb",(function(){return et["qb"]})),n.d(e,"yb",(function(){return et["rb"]})),n.d(e,"Ab",(function(){return et["tb"]})),n.d(e,"zb",(function(){return et["sb"]})),n.d(e,"Bb",(function(){return et["ub"]})),n.d(e,"Cb",(function(){return et["vb"]})),n.d(e,"Db",(function(){return et["wb"]})),n.d(e,"Eb",(function(){return et["xb"]})),n.d(e,"Ib",(function(){return et["Ab"]})),n.d(e,"Jb",(function(){return et["Bb"]})),n.d(e,"Kb",(function(){return et["Cb"]})),n.d(e,"Lb",(function(){return et["Db"]})),n.d(e,"Mb",(function(){return et["Eb"]})),n.d(e,"Nb",(function(){return et["Fb"]})),n.d(e,"Pb",(function(){return et["Hb"]})),n.d(e,"Qb",(function(){return et["Ib"]})),n.d(e,"Rb",(function(){return et["Jb"]})),n.d(e,"Sb",(function(){return et["Kb"]})),n.d(e,"Ob",(function(){return et["Gb"]})),n.d(e,"Tb",(function(){return et["Lb"]})),n.d(e,"Gb",(function(){return et["yb"]})),n.d(e,"Hb",(function(){return et["zb"]})),n.d(e,"Ub",(function(){return et["Mb"]})),n.d(e,"ac",(function(){return et["Sb"]})),n.d(e,"Vb",(function(){return et["Nb"]})),n.d(e,"Yb",(function(){return et["Qb"]})),n.d(e,"Wb",(function(){return et["Ob"]})),n.d(e,"Xb",(function(){return et["Pb"]})),n.d(e,"Zb",(function(){return et["Rb"]})),n.d(e,"bc",(function(){return et["Tb"]})),n.d(e,"cc",(function(){return et["Ub"]})),n.d(e,"dc",(function(){return et["Vb"]})),n.d(e,"ec",(function(){return et["Wb"]})),n.d(e,"fc",(function(){return et["Xb"]})),n.d(e,"hc",(function(){return et["Yb"]})),n.d(e,"ic",(function(){return et["Zb"]})),n.d(e,"jc",(function(){return et["ac"]})),n.d(e,"nc",(function(){return et["ec"]})),n.d(e,"kc",(function(){return et["bc"]})),n.d(e,"lc",(function(){return et["cc"]})),n.d(e,"mc",(function(){return et["dc"]})),n.d(e,"qc",(function(){return et["gc"]})),n.d(e,"pc",(function(){return et["fc"]})),n.d(e,"tc",(function(){return et["hc"]})),n.d(e,"uc",(function(){return et["ic"]})),n.d(e,"vc",(function(){return et["jc"]})),n.d(e,"wc",(function(){return et["kc"]})),n.d(e,"xc",(function(){return et["lc"]})),n.d(e,"yc",(function(){return et["mc"]})),n.d(e,"Ac",(function(){return et["nc"]})),n.d(e,"Bc",(function(){return et["oc"]})),n.d(e,"Cc",(function(){return et["pc"]})),n.d(e,"Ec",(function(){return et["qc"]})),n.d(e,"Gc",(function(){return et["sc"]})),n.d(e,"Ic",(function(){return et["tc"]})),n.d(e,"Kc",(function(){return et["vc"]})),n.d(e,"Nc",(function(){return et["yc"]})),n.d(e,"Oc",(function(){return et["zc"]})),n.d(e,"Lc",(function(){return et["wc"]})),n.d(e,"Mc",(function(){return et["xc"]})),n.d(e,"Jc",(function(){return et["uc"]})),n.d(e,"Pc",(function(){return et["Ac"]})),n.d(e,"Rc",(function(){return et["Cc"]})),n.d(e,"Sc",(function(){return et["Dc"]})),n.d(e,"Uc",(function(){return et["Ec"]})),n.d(e,"Vc",(function(){return et["Fc"]})),n.d(e,"Wc",(function(){return et["Gc"]})),n.d(e,"Xc",(function(){return et["Hc"]})),n.d(e,"cd",(function(){return et["Mc"]})),n.d(e,"ad",(function(){return et["Kc"]})),n.d(e,"bd",(function(){return et["Lc"]})),n.d(e,"Zc",(function(){return et["Jc"]})),n.d(e,"Yc",(function(){return et["Ic"]})),n.d(e,"ed",(function(){return et["Oc"]})),n.d(e,"md",(function(){return et["Wc"]})),n.d(e,"vd",(function(){return et["fd"]})),n.d(e,"fd",(function(){return et["Pc"]})),n.d(e,"ld",(function(){return et["Vc"]})),n.d(e,"dd",(function(){return et["Nc"]})),n.d(e,"gd",(function(){return et["Qc"]})),n.d(e,"hd",(function(){return et["Rc"]})),n.d(e,"id",(function(){return et["Sc"]})),n.d(e,"jd",(function(){return et["Tc"]})),n.d(e,"kd",(function(){return et["Uc"]})),n.d(e,"od",(function(){return et["Yc"]})),n.d(e,"nd",(function(){return et["Xc"]})),n.d(e,"qd",(function(){return et["ad"]})),n.d(e,"rd",(function(){return et["bd"]})),n.d(e,"sd",(function(){return et["cd"]})),n.d(e,"td",(function(){return et["dd"]})),n.d(e,"ud",(function(){return et["ed"]})),n.d(e,"wd",(function(){return et["gd"]})),n.d(e,"xd",(function(){return et["hd"]})),n.d(e,"Ad",(function(){return et["id"]})),n.d(e,"Bd",(function(){return et["jd"]})),n.d(e,"Cd",(function(){return et["kd"]})),n.d(e,"Dd",(function(){return et["ld"]})),n.d(e,"Ed",(function(){return et["md"]})),n.d(e,"Fd",(function(){return et["nd"]})),n.d(e,"Gd",(function(){return et["od"]})),n.d(e,"Hd",(function(){return et["pd"]})),n.d(e,"Jd",(function(){return et["qd"]})),n.d(e,"pd",(function(){return et["Zc"]})),n.d(e,"rb",(function(){return et["kb"]})),n.d(e,"Qc",(function(){return et["Bc"]})),n.d(e,"Kd",(function(){return et["rd"]})),n.d(e,"tb",(function(){return et["mb"]})),n.d(e,"ub",(function(){return et["nb"]}));var r={};n.r(r),n.d(r,"copyModel",(function(){return U["b"]})),n.d(r,"listModels",(function(){return U["c"]})),n.d(r,"moveModel",(function(){return U["d"]})),n.d(r,"removeModel",(function(){return U["e"]})),n.d(r,"browserFiles",(function(){return k})),n.d(r,"browserHTTPRequest",(function(){return M})),n.d(r,"concatenateArrayBuffers",(function(){return h["d"]})),n.d(r,"decodeWeights",(function(){return h["e"]})),n.d(r,"encodeWeights",(function(){return h["f"]})),n.d(r,"fromMemory",(function(){return B})),n.d(r,"fromMemorySync",(function(){return z})),n.d(r,"getLoadHandlers",(function(){return p["b"]})),n.d(r,"getModelArtifactsForJSON",(function(){return h["g"]})),n.d(r,"getModelArtifactsForJSONSync",(function(){return h["h"]})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return h["i"]})),n.d(r,"getSaveHandlers",(function(){return p["c"]})),n.d(r,"getWeightSpecs",(function(){return h["k"]})),n.d(r,"http",(function(){return F})),n.d(r,"isHTTPScheme",(function(){return j})),n.d(r,"loadWeights",(function(){return T})),n.d(r,"registerLoadRouter",(function(){return p["d"]})),n.d(r,"registerSaveRouter",(function(){return p["e"]})),n.d(r,"weightsLoaderFactory",(function(){return I})),n.d(r,"withSaveHandler",(function(){return W})),n.d(r,"withSaveHandlerSync",(function(){return V}));var a={};n.r(a),n.d(a,"confusionMatrix",(function(){return Z}));var i={};n.r(i),n.d(i,"fromPixelsAsync",(function(){return dt})),n.d(i,"toPixels",(function(){return ht})),n.d(i,"fromPixels",(function(){return pt}));var o={};n.r(o),n.d(o,"prepareAndValidate",(function(){return ft}));var s={};n.r(s),n.d(s,"Serializable",(function(){return bt})),n.d(s,"SerializationMap",(function(){return yt})),n.d(s,"registerClass",(function(){return vt}));var u={};n.r(u),n.d(u,"segOpComputeOptimalWindowSize",(function(){return nn})),n.d(u,"computeOutShape",(function(){return rn})),n.d(u,"collectGatherOpShapeInfo",(function(){return an}));var c={};n.r(c),n.d(c,"axesAreInnerMostDims",(function(){return Qt["b"]})),n.d(c,"combineLocations",(function(){return Qt["c"]})),n.d(c,"computeOutAndReduceShapes",(function(){return Qt["d"]})),n.d(c,"expandShapeToKeepDim",(function(){return Qt["e"]})),n.d(c,"assertAxesAreInnerMostDims",(function(){return Qt["a"]})),n.d(c,"getAxesPermutation",(function(){return Qt["f"]})),n.d(c,"getUndoAxesPermutation",(function(){return Qt["h"]})),n.d(c,"getInnerMostAxes",(function(){return Qt["g"]})),n.d(c,"getBroadcastDims",(function(){return Q["getBroadcastDims"]})),n.d(c,"getReductionAxes",(function(){return Q["getReductionAxes"]})),n.d(c,"assertAndGetBroadcastShape",(function(){return Q["assertAndGetBroadcastShape"]})),n.d(c,"assertParamsConsistent",(function(){return te})),n.d(c,"computeOutShape",(function(){return ee})),n.d(c,"computeDilation2DInfo",(function(){return re["e"]})),n.d(c,"computePool2DInfo",(function(){return re["f"]})),n.d(c,"computePool3DInfo",(function(){return re["g"]})),n.d(c,"computeConv2DInfo",(function(){return re["b"]})),n.d(c,"computeConv3DInfo",(function(){return re["c"]})),n.d(c,"computeDefaultPad",(function(){return re["d"]})),n.d(c,"tupleValuesAreOne",(function(){return re["j"]})),n.d(c,"eitherStridesOrDilationsAreOne",(function(){return re["i"]})),n.d(c,"convertConv2DDataFormat",(function(){return re["h"]})),n.d(c,"checkPadOnDimRoundingMode",(function(){return re["a"]})),n.d(c,"getFusedDyActivation",(function(){return ae["c"]})),n.d(c,"getFusedBiasGradient",(function(){return ae["b"]})),n.d(c,"applyActivation",(function(){return ae["a"]})),n.d(c,"shouldFuse",(function(){return ae["d"]})),n.d(c,"RowPartitionType",(function(){return ne})),n.d(c,"combineRaggedTensorToTensorShapes",(function(){return ie})),n.d(c,"getRowPartitionTypesHelper",(function(){return oe})),n.d(c,"getRaggedRank",(function(){return se})),n.d(c,"validateDefaultValueShape",(function(){return ue})),n.d(c,"PARALLELIZE_THRESHOLD",(function(){return ce})),n.d(c,"computeOptimalWindowSize",(function(){return le})),n.d(c,"slice_util",(function(){return gt})),n.d(c,"upcastType",(function(){return qt["c"]})),n.d(c,"getImageCenter",(function(){return de})),n.d(c,"getReshaped",(function(){return he})),n.d(c,"getPermuted",(function(){return pe})),n.d(c,"getReshapedPermuted",(function(){return fe})),n.d(c,"getSliceBeginCoords",(function(){return me})),n.d(c,"getSliceSize",(function(){return ge})),n.d(c,"prepareAndValidate",(function(){return ft})),n.d(c,"validateUpdateShape",(function(){return mt["validateUpdateShape"]})),n.d(c,"validateInput",(function(){return mt["validateInput"]})),n.d(c,"calculateShapes",(function(){return mt["calculateShapes"]})),n.d(c,"SELU_SCALEALPHA",(function(){return be["b"]})),n.d(c,"SELU_SCALE",(function(){return be["a"]})),n.d(c,"ERF_P",(function(){return ye})),n.d(c,"ERF_A1",(function(){return ve})),n.d(c,"ERF_A2",(function(){return xe})),n.d(c,"ERF_A3",(function(){return we})),n.d(c,"ERF_A4",(function(){return ke})),n.d(c,"ERF_A5",(function(){return Se})),n.d(c,"warn",(function(){return Oe["b"]})),n.d(c,"log",(function(){return Oe["a"]})),n.d(c,"mergeRealAndImagArrays",(function(){return _e})),n.d(c,"splitRealAndImagArrays",(function(){return Ce})),n.d(c,"complexWithEvenIndex",(function(){return Te})),n.d(c,"complexWithOddIndex",(function(){return Ie})),n.d(c,"getComplexWithIndex",(function(){return Ne})),n.d(c,"assignToTypedArray",(function(){return Ee})),n.d(c,"exponents",(function(){return Ae})),n.d(c,"exponent",(function(){return Re})),n.d(c,"decodeEinsumEquation",(function(){return Pe})),n.d(c,"getEinsumPermutation",(function(){return $e})),n.d(c,"checkEinsumDimSizes",(function(){return Le})),n.d(c,"getEinsumComputePath",(function(){return Be})),n.d(c,"isIdentityPermutation",(function(){return ze})),n.d(c,"prepareSplitSize",(function(){return Ve})),n.d(c,"getSparseFillEmptyRowsIndicesDenseShapeMismatch",(function(){return Ue})),n.d(c,"getSparseFillEmptyRowsNegativeIndexErrorMessage",(function(){return Ge})),n.d(c,"getSparseFillEmptyRowsOutOfRangeIndexErrorMessage",(function(){return He})),n.d(c,"getSparseReshapeMultipleNegativeOneOutputDimErrorMessage",(function(){return qe})),n.d(c,"getSparseReshapeNegativeOutputDimErrorMessage",(function(){return Ke})),n.d(c,"getSparseReshapeEmptyTensorZeroOutputDimErrorMessage",(function(){return Xe})),n.d(c,"getSparseReshapeInputOutputMultipleErrorMessage",(function(){return Ye})),n.d(c,"getSparseReshapeInputOutputMismatchErrorMessage",(function(){return Je})),n.d(c,"getSparseSegmentReductionNegativeSegmentIdsErrorMessage",(function(){return Ze})),n.d(c,"getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage",(function(){return Qe})),n.d(c,"getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage",(function(){return tn})),n.d(c,"getSparseSegmentReductionIndicesOutOfRangeErrorMessage",(function(){return en})),n.d(c,"segment_util",(function(){return u})),n.d(c,"fromUint8ToStringArray",(function(){return on})),n.d(c,"fromStringArrayToUint8",(function(){return sn}));var l={};n.r(l),n.d(l,"nonMaxSuppressionV3Impl",(function(){return cn["a"]})),n.d(l,"nonMaxSuppressionV4Impl",(function(){return cn["b"]})),n.d(l,"nonMaxSuppressionV5Impl",(function(){return cn["c"]})),n.d(l,"whereImpl",(function(){return ln["a"]}));n("222c"),n("58b9"),n("df3a");var d=n("32fe"),h=n("ad8e"),p=n("6a9b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const f="model",m=".json",g=".weights.bin";function b(t){return new Promise(t=>setTimeout(t)).then(t)}class y{constructor(t){if(!Object(d["c"])().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(y.URL_SCHEME)&&(t=t.slice(y.URL_SCHEME.length)),null!=t&&0!==t.length||(t=f),this.modelJsonFileName=t+m,this.weightDataFileName=t+g}async save(t){if("undefined"===typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const e=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"}));if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const n=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],r=Object(h["j"])(t,n),a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),i=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=a,await b(()=>i.dispatchEvent(new MouseEvent("click"))),null!=t.weightData){const t=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;t.download=this.weightDataFileName,t.href=e,await b(()=>t.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Object(h["i"])(t)}}}}y.URL_SCHEME="downloads://";class v{constructor(t){if(null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.jsonFile=t[0],this.weightsFiles=t.slice(1)}async load(){return new Promise((t,e)=>{const n=new FileReader;n.onload=n=>{const r=JSON.parse(n.target.result),a=r.modelTopology;if(null==a)return void e(new Error("modelTopology field is missing from file "+this.jsonFile.name));const i=r.weightsManifest;if(null==i)return void e(new Error("weightManifest field is missing from file "+this.jsonFile.name));if(0===this.weightsFiles.length)return void t({modelTopology:a});const o=Object(h["g"])(r,t=>this.loadWeights(t));t(o)},n.onerror=t=>e(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),n.readAsText(this.jsonFile)})}loadWeights(t){const e=[],n=[];for(const i of t)e.push(...i.weights),n.push(...i.paths);const r=this.checkManifestAndWeightFiles(t),a=n.map(t=>this.loadWeightsFile(t,r[t]));return Promise.all(a).then(t=>[e,Object(h["d"])(t)])}loadWeightsFile(t,e){return new Promise((n,r)=>{const a=new FileReader;a.onload=t=>{const e=t.target.result;n(e)},a.onerror=e=>r(`Failed to weights data from file of path '${t}'.`),a.readAsArrayBuffer(e)})}checkManifestAndWeightFiles(t){const e=[],n=this.weightsFiles.map(t=>Object(h["c"])(t.name)),r={};for(const a of t)a.paths.forEach(t=>{const a=Object(h["c"])(t);if(-1!==e.indexOf(a))throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(e.push(a),-1===n.indexOf(a))throw new Error(`Weight file with basename '${a}' is not provided.`);r[t]=this.weightsFiles[n.indexOf(a)]});if(e.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${e.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const x=t=>Object(d["c"])().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(y.URL_SCHEME)?w(t.slice(y.URL_SCHEME.length)):null;function w(t="model"){return new y(t)}function k(t){return new v(t)}p["a"].registerSaveRouter(x);var S=n("df00");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O(t,e,n,r){o(t),n=null==n?0:n,r=null==r?1:r,s(n,r);let a=0;const i=i=>(i.then(i=>{const o=n+ ++a/t.length*(r-n);return e(o),i}),i);function o(t){Object(S["b"])(null!=t&&Array.isArray(t)&&t.length>0,()=>"promises must be a none empty array")}function s(t,e){Object(S["b"])(t>=0&&t<=1,()=>"Progress fraction must be in range [0, 1], but got startFraction "+t),Object(S["b"])(e>=0&&e<=1,()=>"Progress fraction must be in range [0, 1], but got endFraction "+e),Object(S["b"])(e>=t,()=>`startFraction must be no more than endFraction, but got startFraction ${t} and endFraction `+e)}return Promise.all(t.map(i))}var _=n("20aa");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function C(t,e){null==e&&(e={});const n=null==e.fetchFunc?Object(d["c"])().platform.fetch:e.fetchFunc,r=t.map(t=>n(t,e.requestInit,{isBinary:!0})),a=0,i=.5,o=null==e.onProgress?await Promise.all(r):await O(r,e.onProgress,a,i),s=o.map(t=>t.arrayBuffer()),u=.5,c=1,l=null==e.onProgress?await Promise.all(s):await O(s,e.onProgress,u,c);return l}async function T(t,e="",n,r){const a=t=>C(t,{requestInit:r}),i=I(a);return i(t,e,n)}function I(t){return async(e,n="",r)=>{const a=e.map(()=>!1),i={},o=null!=r?r.map(()=>!1):[],s=[];if(e.forEach((t,e)=>{let n=0;t.weights.forEach(t=>{const u="quantization"in t?t.quantization.dtype:t.dtype,c=_["a"][u]*S["O"](t.shape),l=()=>{a[e]=!0,null==i[e]&&(i[e]=[]),i[e].push({manifestEntry:t,groupOffset:n,sizeBytes:c})};null!=r?r.forEach((e,n)=>{e===t.name&&(l(),o[n]=!0)}):l(),s.push(t.name),n+=c})}),!o.every(t=>t)){const t=r.filter((t,e)=>!o[e]);throw new Error("Could not find weights in manifest with names: "+t.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".")}const u=a.reduce((t,e,n)=>(e&&t.push(n),t),[]),c=[];u.forEach(t=>{e[t].paths.forEach(t=>{const e=n+(n.endsWith("/")?"":"/")+t;c.push(e)})});const l=await t(c),d={};let p=0;return u.forEach(t=>{const n=e[t].paths.length;let r=0;for(let e=0;e<n;e++)r+=l[p+e].byteLength;const a=new ArrayBuffer(r),o=new Uint8Array(a);let s=0;for(let e=0;e<n;e++){const t=new Uint8Array(l[p+e]);o.set(t,s),s+=t.byteLength}const u=i[t];u.forEach(t=>{const e=a.slice(t.groupOffset,t.groupOffset+t.sizeBytes),n=Object(h["e"])(e,[t.manifestEntry]);for(const r in n)d[r]=n[r]}),p+=n}),d}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N="application/octet-stream",E="application/json";class A{constructor(t,e){if(this.DEFAULT_METHOD="POST",null==e&&(e={}),this.weightPathPrefix=e.weightPathPrefix,this.onProgress=e.onProgress,this.weightUrlConverter=e.weightUrlConverter,null!=e.fetchFunc?(Object(S["b"])("function"===typeof e.fetchFunc,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=e.fetchFunc):this.fetch=Object(d["c"])().platform.fetch,Object(S["b"])(null!=t&&t.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(t)&&Object(S["b"])(2===t.length,()=>`URL paths for http must have a length of 2, (actual length is ${t.length}).`),this.path=t,null!=e.requestInit&&null!=e.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=e.requestInit||{}}async save(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const e=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);e.body=new FormData;const n=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],r=Object(h["j"])(t,n);e.body.append("model.json",new Blob([JSON.stringify(r)],{type:E}),"model.json"),null!=t.weightData&&e.body.append("model.weights.bin",new Blob([t.weightData],{type:N}),"model.weights.bin");const a=await this.fetch(this.path,e);if(a.ok)return{modelArtifactsInfo:Object(h["i"])(t),responses:[a]};throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}async load(){const t=await this.fetch(this.path,this.requestInit);if(!t.ok)throw new Error(`Request to ${this.path} failed with status code `+t.status+". Please verify this URL points to the model JSON of the model to load.");let e;try{e=await t.json()}catch(a){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=e.modelTopology,r=e.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return Object(h["g"])(e,t=>this.loadWeights(t))}async loadWeights(t){const e=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=R(e),a=this.weightPathPrefix||n,i=Object(h["k"])(t),o=[],s=[];for(const c of t)for(const t of c.paths)null!=this.weightUrlConverter?s.push(this.weightUrlConverter(t)):o.push(a+t+r);this.weightUrlConverter&&o.push(...await Promise.all(s));const u=await C(o,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,Object(h["d"])(u)]}}function R(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}function j(t){return null!=t.match(A.URL_SCHEME_REGEX)}A.URL_SCHEME_REGEX=/^https?:\/\//;const D=(t,e)=>{if("undefined"===typeof fetch&&(null==e||null==e.fetchFunc))return null;{let n=!0;if(n=Array.isArray(t)?t.every(t=>j(t)):j(t),n)return F(t,e)}return null};function F(t,e){return new A(t,e)}function M(t,e){return F(t,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */p["a"].registerSaveRouter(D),p["a"].registerLoadRouter(D);class P{constructor(t){this.modelArtifacts=t}load(){return this.modelArtifacts}}class ${constructor(t){this.saveHandler=t}save(t){return this.saveHandler(t)}}class L{constructor(t){t.load&&(this.load=()=>Promise.resolve(t.load())),t.save&&(this.save=e=>Promise.resolve(t.save(e)))}}function B(t,e,n,r){const a=arguments;return new L(z(...a))}function z(t,e,n,r){if(1===arguments.length){const e=null!=t.modelTopology||null!=t.weightSpecs;return e?new P(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new P({modelTopology:t}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new P({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r})}function W(t){return new $(t)}function V(t){return new $(t)}var U=n("6bfe"),G=n("4ffe"),H=n("7b50"),q=n("5727"),K=n("ff30"),X=n("f947"),Y=n("6cff");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function J(t,e,n){const r=Object(G["a"])(t,"labels","confusionMatrix"),a=Object(G["a"])(e,"predictions","confusionMatrix");S["b"](null==n||n>0&&Number.isInteger(n),()=>"If provided, numClasses must be a positive integer, but got "+n),S["b"](1===r.rank,()=>"Expected the rank of labels to be 1, but got "+r.rank),S["b"](1===a.rank,()=>"Expected the rank of predictions to be 1, but got "+a.rank),S["b"](r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),S["b"](n>0&&Number.isInteger(n),()=>"numClasses is required to be a positive integer, but got "+n);const i=Object(K["a"])(Object(H["a"])(r,"int32"),n),o=Object(K["a"])(Object(H["a"])(a,"int32"),n),s=Object(Y["a"])(i),u=Object(q["a"])(s,o);return Object(H["a"])(u,"int32")}const Z=Object(X["b"])({confusionMatrix_:J});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Q=n("ae86"),tt=n("219b"),et=n("388c"),nt=n("3182"),rt=n("4e56"),at=n("381a");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
let it;function ot(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==t)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&t instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement)i=!0;else if(null!=t.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+t.constructor.name);s=!0}const u=Object(nt["c"])(et["kb"],tt["a"].backendName);if(null!=u){const n={pixels:t},r={numChannels:e};return tt["a"].runKernel(et["kb"],n,r)}const[c,l]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d,h;if(o)d=t.getContext("2d").getImageData(0,0,c,l).data;else if(r||n)d=t.data;else if(i||a||s){if(null==it)if("undefined"===typeof document){if("undefined"===typeof OffscreenCanvas||"undefined"===typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");it=new OffscreenCanvas(1,1).getContext("2d")}else it=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});it.canvas.width=c,it.canvas.height=l,it.drawImage(t,0,0,c,l),d=it.getImageData(0,0,c,l).data}if(4===e)h=new Int32Array(d);else{const t=c*l;h=new Int32Array(t*e);for(let n=0;n<t;n++)for(let t=0;t<e;++t)h[n*e+t]=d[4*n+t]}const p=[l,c,e];return Object(at["a"])(h,p,"int32")}function st(t){return null!=t&&t.data instanceof Uint8Array}function ut(){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")}function ct(t){return null!=t&&0!==t.width&&0!==t.height}function lt(t){return ut()&&!(t instanceof ImageBitmap)&&ct(t)&&!st(t)}async function dt(t,e=3){let n=null;if(Object(d["c"])().getBool("WRAP_TO_IMAGEBITMAP")&&lt(t)){let e;try{e=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch(r){e=null}n=null!=e&&e.width===t.width&&e.height===t.height?e:t}else n=t;return ot(n,e)}async function ht(t,e){let n=Object(G["a"])(t,"img","toPixels");if(!(t instanceof rt["a"])){const t=n;n=Object(H["a"])(t,"int32"),t.dispose()}if(2!==n.rank&&3!==n.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,a]=n.shape.slice(0,2),i=2===n.rank?1:n.shape[2];if(i>4||2===i)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+i);if("float32"!==n.dtype&&"int32"!==n.dtype)throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const o=await n.data(),s="float32"===n.dtype?255:1,u=new Uint8ClampedArray(a*r*4);for(let c=0;c<r*a;++c){const t=[0,0,0,255];for(let r=0;r<i;r++){const e=o[c*i+r];if("float32"===n.dtype){if(e<0||e>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${e}.`)}else if("int32"===n.dtype&&(e<0||e>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${e}.`);1===i?(t[0]=e*s,t[1]=e*s,t[2]=e*s):t[r]=e*s}const e=4*c;u[e+0]=Math.round(t[0]),u[e+1]=Math.round(t[1]),u[e+2]=Math.round(t[2]),u[e+3]=Math.round(t[3])}if(null!=e){e.width=a,e.height=r;const t=e.getContext("2d"),n=new ImageData(u,a,r);t.putImageData(n,0,0)}return n!==t&&n.dispose(),u}const pt=Object(X["b"])({fromPixels_:ot});function ft(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==e.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(0===Object(S["O"])(t.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,i=a[a.length-1];let o=1;for(let d=0;d<a.length-1;++d)o*=a[d];const s=t.shape,u=a.slice();u.pop();let c=1;for(let d=i;d<n;++d)c*=s[d],u.push(s[d]);const l=[...Object(S["j"])(t.shape).map(t=>t/c),1].slice(0,i);return[u,o,c,l]}var mt=n("97b1"),gt=n("9b7a");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class bt{getClassName(){return this.constructor.className}static fromConfig(t,e){return new t(e)}}class yt{constructor(){this.classNameMap={}}static getMap(){return null==yt.instance&&(yt.instance=new yt),yt.instance}static register(t){yt.getMap().classNameMap[t.className]=[t,t.fromConfig]}}function vt(t){Object(S["b"])(null!=t.className,()=>"Class being registered does not have the static className property defined."),Object(S["b"])("string"===typeof t.className,()=>"className is required to be a string, but got type "+typeof t.className),Object(S["b"])(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),yt.register(t)}var xt=n("a6a7"),wt=n("509f"),kt=n("bb7b");
/** @license See the LICENSE file. */
const St="3.21.0";var Ot=n("fd3e"),_t=n("a08f"),Ct=n("fb3e"),Tt=n("0db7"),It=n("330c"),Nt=n("c794"),Et=n("96d8"),At=n("b181"),Rt=n("1ba2");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class jt extends bt{minimize(t,e=!1,n){const{value:r,grads:a}=this.computeGradients(t,n);if(null!=n){const t=n.map(t=>({name:t.name,tensor:a[t.name]}));this.applyGradients(t)}else this.applyGradients(a);return Object(Ot["d"])(a),e?r:(r.dispose(),null)}get iterations(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(t,e){return Object(At["f"])(t,e)}dispose(){null!=this.iterations_&&Object(Ot["d"])(this.iterations_)}async saveIterations(){return null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:Object(Rt["a"])(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}async extractIterations(t){return this.iterations_=(await t[0].tensor.data())[0],t.slice(1)}}Object.defineProperty(jt,Symbol.hasInstance,{value:t=>null!=t.minimize&&null!=t.computeGradients&&null!=t.applyGradients});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Dt extends jt{constructor(t,e,n=null){super(),this.learningRate=t,this.rho=e,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],null==n&&(this.epsilon=tt["a"].backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=tt["a"].registeredVariables[e],a=!1;null==this.accumulatedGrads[n]&&(this.accumulatedGrads[n]={originalName:e+"/accum_grad",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(a))}),null==this.accumulatedUpdates[n]&&(this.accumulatedUpdates[n]={originalName:e+"/accum_var",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedGrads[n].variable,s=this.accumulatedUpdates[n].variable;Object(Ot["t"])(()=>{const t=Object(_t["a"])(Object(Tt["a"])(o,this.rho),Object(Tt["a"])(Object(Nt["a"])(i),1-this.rho)),e=Object(Tt["a"])(Object(Ct["a"])(Object(It["a"])(Object(_t["a"])(s,this.epsilon)),Object(It["a"])(Object(_t["a"])(o,this.epsilon))),i),n=Object(_t["a"])(Object(Tt["a"])(s,this.rho),Object(Tt["a"])(Object(Nt["a"])(e),1-this.rho));o.assign(t),s.assign(n);const a=Object(_t["a"])(Object(Tt["a"])(e,-this.learningRate),r);r.assign(a)})}),this.incrementIterations()}dispose(){null!=this.accumulatedUpdates&&(Object(Ot["d"])(this.accumulatedGrads.map(t=>t.variable)),Object(Ot["d"])(this.accumulatedUpdates.map(t=>t.variable)))}async getWeights(){const t=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=t.length/2,n=!1;this.accumulatedGrads=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedUpdates=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["rho"],e["epsilon"])}}Dt.className="Adadelta",vt(Dt);var Ft=n("1469");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mt extends jt{constructor(t,e=.1){super(),this.learningRate=t,this.initialAccumulatorValue=e,this.accumulatedGrads=[]}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=tt["a"].registeredVariables[e];if(null==this.accumulatedGrads[n]){const t=!1;this.accumulatedGrads[n]={originalName:e+"/accumulator",variable:Object(Ot["t"])(()=>Object(Ft["a"])(r.shape,this.initialAccumulatorValue).variable(t))}}const a=Array.isArray(t)?t[n].tensor:t[e];if(null==a)return;const i=this.accumulatedGrads[n].variable;Object(Ot["t"])(()=>{const t=Object(_t["a"])(i,Object(Nt["a"])(a));i.assign(t);const e=Object(_t["a"])(Object(Tt["a"])(Object(Ct["a"])(a,Object(It["a"])(Object(_t["a"])(t,tt["a"].backend.epsilon()))),-this.learningRate),r);r.assign(e)})}),this.incrementIterations()}dispose(){null!=this.accumulatedGrads&&Object(Ot["d"])(this.accumulatedGrads.map(t=>t.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulatedGrads=t.map(t=>({originalName:t.name,variable:t.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(t,e){return new t(e["learningRate"],e["initialAccumulatorValue"])}}Mt.className="Adagrad",vt(Mt);var Pt=n("5e33"),$t=n("0233");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Lt extends jt{constructor(t,e,n,r=null){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Object(Ot["t"])(()=>{this.accBeta1=Object(Rt["a"])(e).variable(),this.accBeta2=Object(Rt["a"])(n).variable()}),null==r&&(this.epsilon=tt["a"].backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Object(Ot["t"])(()=>{const n=Object($t["a"])(1,this.accBeta1),r=Object($t["a"])(1,this.accBeta2);e.forEach((e,a)=>{const i=tt["a"].registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:e+"/m",variable:Object(Ot["t"])(()=>Object(Et["a"])(i).variable(o))}),null==this.accumulatedSecondMoment[a]&&(this.accumulatedSecondMoment[a]={originalName:e+"/v",variable:Object(Ot["t"])(()=>Object(Et["a"])(i).variable(o))});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedSecondMoment[a].variable,l=Object(_t["a"])(Object(Tt["a"])(u,this.beta1),Object(Tt["a"])(s,1-this.beta1)),d=Object(_t["a"])(Object(Tt["a"])(c,this.beta2),Object(Tt["a"])(Object(Nt["a"])(s),1-this.beta2)),h=Object(Ct["a"])(l,n),p=Object(Ct["a"])(d,r);u.assign(l),c.assign(d);const f=Object(_t["a"])(Object(Tt["a"])(Object(Ct["a"])(h,Object(_t["a"])(Object(It["a"])(p),this.epsilon)),-this.learningRate),i);i.assign(f)}),this.accBeta1.assign(Object(Tt["a"])(this.accBeta1,this.beta1)),this.accBeta2.assign(Object(Tt["a"])(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&Object(Ot["d"])(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedSecondMoment&&Object(Ot["d"])(this.accumulatedSecondMoment.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t),Object(Ot["t"])(()=>{this.accBeta1.assign(Object(Pt["a"])(this.beta1,this.iterations_+1)),this.accBeta2.assign(Object(Pt["a"])(this.beta2,this.iterations_+1))});const e=t.length/2,n=!1;this.accumulatedFirstMoment=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedSecondMoment=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"])}}Lt.className="Adam",vt(Lt);var Bt=n("a9d7"),zt=n("353b");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Wt extends jt{constructor(t,e,n,r=null,a=0){super(),this.learningRate=t,this.beta1=e,this.beta2=n,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Object(Ot["t"])(()=>{this.iteration=Object(Rt["a"])(0).variable(),this.accBeta1=Object(Rt["a"])(e).variable()}),null==r&&(this.epsilon=tt["a"].backend.epsilon())}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);Object(Ot["t"])(()=>{const n=Object($t["a"])(1,this.accBeta1),r=Object(Ct["a"])(-this.learningRate,Object(_t["a"])(Object(Tt["a"])(this.iteration,this.decay),1));e.forEach((e,a)=>{const i=tt["a"].registeredVariables[e],o=!1;null==this.accumulatedFirstMoment[a]&&(this.accumulatedFirstMoment[a]={originalName:e+"/m",variable:Object(Et["a"])(i).variable(o)}),null==this.accumulatedWeightedInfNorm[a]&&(this.accumulatedWeightedInfNorm[a]={originalName:e+"/v",variable:Object(Et["a"])(i).variable(o)});const s=Array.isArray(t)?t[a].tensor:t[e];if(null==s)return;const u=this.accumulatedFirstMoment[a].variable,c=this.accumulatedWeightedInfNorm[a].variable,l=Object(_t["a"])(Object(Tt["a"])(u,this.beta1),Object(Tt["a"])(s,1-this.beta1)),d=Object(Tt["a"])(c,this.beta2),h=Object(Bt["a"])(s),p=Object(zt["a"])(d,h);u.assign(l),c.assign(p);const f=Object(_t["a"])(Object(Tt["a"])(Object(Ct["a"])(r,n),Object(Ct["a"])(l,Object(_t["a"])(p,this.epsilon))),i);i.assign(f)}),this.iteration.assign(Object(_t["a"])(this.iteration,1)),this.accBeta1.assign(Object(Tt["a"])(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&Object(Ot["d"])(this.accumulatedFirstMoment.map(t=>t.variable)),null!=this.accumulatedWeightedInfNorm&&Object(Ot["d"])(this.accumulatedWeightedInfNorm.map(t=>t.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(t){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(t,e){return new t(e["learningRate"],e["beta1"],e["beta2"],e["epsilon"],e["decay"])}}Wt.className="Adamax",vt(Wt);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Vt extends jt{constructor(t){super(),this.learningRate=t,this.setLearningRate(t)}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=Array.isArray(t)?t[n].tensor:t[e];if(null==r)return;const a=tt["a"].registeredVariables[e];Object(Ot["t"])(()=>{const t=Object(_t["a"])(Object(Tt["a"])(this.c,r),a);a.assign(t)})}),this.incrementIterations()}setLearningRate(t){this.learningRate=t,null!=this.c&&this.c.dispose(),this.c=Object(Ot["l"])(Object(Rt["a"])(-t))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(t){if(t=await this.extractIterations(t),0!==t.length)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(t,e){return new t(e["learningRate"])}}Vt.className="SGD",vt(Vt);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ut extends Vt{constructor(t,e,n=!1){super(t),this.learningRate=t,this.momentum=e,this.useNesterov=n,this.accumulations=[],this.m=Object(Rt["a"])(this.momentum)}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=tt["a"].registeredVariables[e];if(null==this.accumulations[n]){const t=!1;this.accumulations[n]={originalName:e+"/momentum",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(t))}}const a=this.accumulations[n].variable,i=Array.isArray(t)?t[n].tensor:t[e];null!=i&&Object(Ot["t"])(()=>{let t;const e=Object(_t["a"])(Object(Tt["a"])(this.m,a),i);t=this.useNesterov?Object(_t["a"])(Object(Tt["a"])(this.c,Object(_t["a"])(i,Object(Tt["a"])(e,this.m))),r):Object(_t["a"])(Object(Tt["a"])(this.c,e),r),a.assign(e),r.assign(t)})}),this.incrementIterations()}dispose(){this.m.dispose(),null!=this.accumulations&&Object(Ot["d"])(this.accumulations.map(t=>t.variable))}setMomentum(t){this.momentum=t}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=!1;this.accumulations=t.map(t=>({originalName:t.name,variable:t.tensor.variable(e)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(t,e){return new t(e["learningRate"],e["momentum"],e["useNesterov"])}}Ut.className="Momentum",vt(Ut);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Gt extends jt{constructor(t,e=.9,n=0,r=null,a=!1){if(super(),this.learningRate=t,this.decay=e,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,null==r&&(this.epsilon=tt["a"].backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(t){const e=Array.isArray(t)?t.map(t=>t.name):Object.keys(t);e.forEach((e,n)=>{const r=tt["a"].registeredVariables[e],a=!1;null==this.accumulatedMeanSquares[n]&&(this.accumulatedMeanSquares[n]={originalName:e+"/rms",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(a))}),null==this.accumulatedMoments[n]&&(this.accumulatedMoments[n]={originalName:e+"/momentum",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(a))}),null==this.accumulatedMeanGrads[n]&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:e+"/mg",variable:Object(Ot["t"])(()=>Object(Et["a"])(r).variable(a))});const i=Array.isArray(t)?t[n].tensor:t[e];if(null==i)return;const o=this.accumulatedMeanSquares[n].variable,s=this.accumulatedMoments[n].variable;Object(Ot["t"])(()=>{const t=Object(_t["a"])(Object(Tt["a"])(o,this.decay),Object(Tt["a"])(Object(Nt["a"])(i),1-this.decay));if(this.centered){const e=this.accumulatedMeanGrads[n].variable,a=Object(_t["a"])(Object(Tt["a"])(e,this.decay),Object(Tt["a"])(i,1-this.decay)),u=Object(Ct["a"])(Object(Tt["a"])(i,this.learningRate),Object(It["a"])(Object($t["a"])(t,Object(_t["a"])(Object(Nt["a"])(a),this.epsilon)))),c=Object(_t["a"])(Object(Tt["a"])(s,this.momentum),u);o.assign(t),e.assign(a),s.assign(c);const l=Object($t["a"])(r,c);r.assign(l)}else{const t=Object(_t["a"])(Object(Tt["a"])(o,this.decay),Object(Tt["a"])(Object(Nt["a"])(i),1-this.decay)),e=Object(_t["a"])(Object(Tt["a"])(s,this.momentum),Object(Ct["a"])(Object(Tt["a"])(i,this.learningRate),Object(It["a"])(Object(_t["a"])(t,this.epsilon))));o.assign(t),s.assign(e);const n=Object($t["a"])(r,e);r.assign(n)}})}),this.incrementIterations()}dispose(){null!=this.accumulatedMeanSquares&&Object(Ot["d"])(this.accumulatedMeanSquares.map(t=>t.variable)),null!=this.accumulatedMeanGrads&&this.centered&&Object(Ot["d"])(this.accumulatedMeanGrads.map(t=>t.variable)),null!=this.accumulatedMoments&&Object(Ot["d"])(this.accumulatedMoments.map(t=>t.variable))}async getWeights(){const t=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&t.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(t.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(t){t=await this.extractIterations(t);const e=this.centered?t.length/3:t.length/2,n=!1;this.accumulatedMeanSquares=t.slice(0,e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.accumulatedMoments=t.slice(e,2*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*e,3*e).map(t=>({originalName:t.name,variable:t.tensor.variable(n)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(t,e){return new t(e["learningRate"],e["decay"],e["momentum"],e["epsilon"],e["centered"])}}Gt.className="RMSProp",vt(Gt);
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Ht{static sgd(t){return new Vt(t)}static momentum(t,e,n=!1){return new Ut(t,e,n)}static rmsprop(t,e=.9,n=0,r=null,a=!1){return new Gt(t,e,n,r,a)}static adam(t=.001,e=.9,n=.999,r=null){return new Lt(t,e,n,r)}static adadelta(t=.001,e=.95,n=null){return new Dt(t,e,n)}static adamax(t=.002,e=.9,n=.999,r=null,a=0){return new Wt(t,e,n,r,a)}static adagrad(t,e=.1){return new Mt(t,e)}}var qt=n("79ec"),Kt=n("f562"),Xt=n("64db");const Yt={sgd:Ht.sgd,momentum:Ht.momentum,adadelta:Ht.adadelta,adagrad:Ht.adagrad,rmsprop:Ht.rmsprop,adamax:Ht.adamax,adam:Ht.adam},Jt=(()=>"undefined"!==typeof requestAnimationFrame?requestAnimationFrame:"undefined"!==typeof setImmediate?setImmediate:t=>t())();
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(){return new Promise(t=>Jt(()=>t()))}var Qt=n("97ca");
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function te(t,e){const n=t[0].length;t.forEach((t,e)=>{S["b"](t.length===n,()=>`Error in concat${n}D: rank of tensors[${e}] must be the same as the rank of the rest (${n})`)}),S["b"](e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((t,a)=>{for(let i=0;i<n;i++)S["b"](i===e||t[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${a}] (${t}) does not match the shape of the rest (${r}) along the non-concatenated axis ${a}.`)})}function ee(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}var ne,re=n("086c"),ae=n("641f");function ie(t,e,n){let r=new Array;if(null==n&&null==e)return r;if(null==e)while(r.length<t+n.length)r.push(-1);else r=e.slice();if(null==n)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${i} but shape[${a+t}] = ${s}`)}else r[o]=i}return r}function oe(t){const e={FIRST_DIM_SIZE:ne.FIRST_DIM_SIZE,VALUE_ROWIDS:ne.VALUE_ROWIDS,ROW_LENGTHS:ne.ROW_LENGTHS,ROW_SPLITS:ne.ROW_SPLITS,ROW_LIMITS:ne.ROW_LIMITS,ROW_STARTS:ne.ROW_STARTS},n=[];for(const r of t){if(!(r in e))break;n.push(e[r])}return n}function se(t){return 0===t.length?0:t[0]===ne.FIRST_DIM_SIZE?t.length-1:t.length}function ue(t,e){if(null==t||null==e)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){const n=t[a],r=e[a+1];if(n>=0&&r>=0&&1!==n&&n!==r)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${n} but ragged tensor input.flatValues.shape[${a-t.length}] = ${r}`)}}
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */(function(t){t[t["FIRST_DIM_SIZE"]=0]="FIRST_DIM_SIZE",t[t["VALUE_ROWIDS"]=1]="VALUE_ROWIDS",t[t["ROW_LENGTHS"]=2]="ROW_LENGTHS",t[t["ROW_SPLITS"]=3]="ROW_SPLITS",t[t["ROW_LIMITS"]=4]="ROW_LIMITS",t[t["ROW_STARTS"]=5]="ROW_STARTS"})(ne||(ne={}));const ce=30;function le(t){return t<=ce?t:Object(S["G"])(t,Math.floor(Math.sqrt(t)))}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(t,e,n){const r=n*("number"===typeof t?t:t[0]),a=e*("number"===typeof t?t:t[1]);return[r,a]}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function he(t,e,n,r=!0){let a=[];if(r)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const n=e.length;for(let r=0;r<n;++r)a=a.concat([t[r+1]/e[r],e[r]]);a=a.concat(t.slice(n+1))}return a}function pe(t,e,n=!0){const r=[];if(n){r.push(e);for(let n=e+1;n<t;++n)n<=2*e?(r.push(n),r.push(n-(e+1))):r.push(n)}else{const n=[],a=[];for(let r=1;r<t;++r)r>=2*e+1||r%2===1?a.push(r):n.push(r);r.push(...n),r.push(0),r.push(...a)}return r}function fe(t,e,n,r=!0){const a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function me(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function ge(t,e,n){const r=t.slice(0,1);for(let a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}var be=n("1cc6");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ye=.3275911,ve=.254829592,xe=-.284496736,we=1.421413741,ke=-1.453152027,Se=1.061405429;var Oe=n("eea1");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _e(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(2*t.length);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Ce(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Te(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function Ie(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function Ne(t,e){const n=t[2*e],r=t[2*e+1];return{real:n,imag:r}}function Ee(t,e,n,r){t[2*r]=e,t[2*r+1]=n}function Ae(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function Re(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const je="->",De=/->/g,Fe=",",Me="...";function Pe(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(De,"").length)/je.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${je}").`);const[r,a]=t.split(je);Object(S["b"])(-1===r.indexOf(Me),()=>`The ellipsis notation ("${Me}") is not supported yet.`);const i=r.split(Fe),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let h=0;h<a.length;++h){const t=a[h];if(!i.some(e=>-1!==e.indexOf(t)))throw new Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===s.indexOf(t)&&s.push(t)}for(let h=0;h<r.length;++h){const t=r[h];-1===s.indexOf(t)&&t!==Fe&&s.push(t)}const u=new Array(i.length);for(let h=0;h<o;++h){if(new Set(i[h].split("")).size!==i[h].length)throw new Error(`Found duplicate axes in input component ${i[h]}. Support for duplicate axes in input is not implemented yet.`);u[h]=[];for(let t=0;t<i[h].length;++t)u[h].push(s.indexOf(i[h][t]))}const c=s.length,l=a.length,d=[];for(let h=l;h<c;++h)d.push(h);return{allDims:s,summedDims:d,idDims:u}}function $e(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const r=[];for(let a=0;a<t;++a)-1===n[a]&&r.push(a);return n=n.filter(t=>-1!==t),{permutationIndices:n,expandDims:r}}function Le(t,e,n){const r=new Array(t);for(let a=0;a<n.length;++a){const t=n[a].shape;for(let n=0;n<e[a].length;++n)void 0===r[e[a][n]]?r[e[a][n]]=t[n]:Object(S["b"])(r[e[a][n]]===t[n],()=>`Expected dimension ${r[e[a][n]]} at axis ${n} of input shaped ${JSON.stringify(t)}, but got dimension `+t[n])}}function Be(t,e){const n=t,r=[];let a=0;0===t.length&&n.push(-1),a=t.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const t=n[o],a=We(e,t);for(const e of a)-1===i.indexOf(e)&&(r[o].push(e),i.push(e))}return{path:n,steps:r}}function ze(t){return t.every((t,e)=>t===e)}function We(t,e){const n=[];for(let r=0;r<t.length;++r)0!==t[r].length&&-1===t[r].indexOf(e)&&-1!==e||n.push(r);return n}function Ve(t,e,n=0){let r=[];if("number"===typeof e)Object(S["b"])(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((t,e)=>(-1===e&&(t+=1),t),0);Object(S["b"])(a<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(-1!==i){const r=e.reduce((t,e)=>e>0?t+e:t);e[i]=t.shape[n]-r}Object(S["b"])(t.shape[n]===e.reduce((t,e)=>t+e),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ue(t){return"Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = "+t}function Ge(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function He(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Ke(t,e){return`size ${t} must be non-negative, not ${e}`}function Xe(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Ye(t,e){const n=Object(S["O"])(t),r=Object(S["O"])(e);return`Input to reshape is a SparseTensor with ${n}\n  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function Je(t,e){const n=Object(S["O"])(t),r=Object(S["O"])(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(){return"segment ids must be >= 0"}function Qe(){return"segment ids are not increasing"}function tn(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function en(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t,e){let n,r=!1;t<=ce?(n=t,r=!0):n=Object(S["G"])(t,Math.floor(Math.sqrt(t)));while(!r)n>e||n===t?r=!0:n=Object(S["G"])(t,n+1);return n}function rn(t,e,n){const r=[],a=t.length;for(let i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}function an(t,e,n,r){const a=e.shape.length,i=t.shape.length;if(0!==r&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],s=[];let u=1,c=1,l=1;for(let d=0;d<r;++d)s.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<n;d++)s.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<a;d++)s.push(e.shape[d]);for(let d=n+1;d<i;d++)s.push(t.shape[d]),l*=t.shape[d];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:o,outputShape:s}}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function on(t){try{return t.map(t=>Object(kt["decodeString"])(t))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8, error: "+e)}}function sn(t){return t.map(t=>Object(kt["encodeString"])(t))}var un=n("86ab"),cn=n("1194"),ln=n("afd2"),dn=n("ec7c")},f239:function(t,e,n){"use strict";n("a695")},f35c:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;var a=n("9cb8"),i=n("ea61"),o=n("d777"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._validateAdd=function(t){var e=t.getType();"Group"!==e&&"Shape"!==e&&a.Util.throw("You may only add groups and shapes to groups.")},e}(i.Container);e.Group=s,s.prototype.nodeType="Group",o._registerNode(s),a.Collection.mapMethods(s)},f378:function(t,e,n){"use strict";n("fc7a")},f388:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("df00"),s=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function u(t,e,n){const s=Object(i["a"])(t,"x","unsortedSegmentSum"),u=Object(i["a"])(e,"segmentIds","unsortedSegmentSum","int32");Object(o["b"])(Object(o["v"])(n),()=>"numSegments must be of dtype int");const c={x:s,segmentIds:u},l={numSegments:n};return r["a"].runKernel(a["od"],c,l)}const c=Object(s["b"])({unsortedSegmentSum_:u})},f3c1:function(t,e){var n=800,r=16,a=Date.now;function i(t){var e=0,i=0;return function(){var o=a(),s=r-(o-i);if(i=o,s>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}t.exports=i},f4d6:function(t,e,n){var r=n("ffd6"),a=1/0;function i(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-a?"-0":e}t.exports=i},f4ee:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t){const e=Object(i["a"])(t,"input","real"),n={input:e};return r["a"].runKernel(a["qc"],n)}const u=Object(o["b"])({real_:s})},f560:function(t,e,n){var r=n("225e"),a=n("3956"),i=n("6747");function o(t){var e=i(t)?r:a;return e(t)}t.exports=o},f562:function(t,e,n){"use strict";n.d(e,"b",(function(){return a["a"]})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"e",(function(){return p["a"]})),n.d(e,"f",(function(){return g})),n.d(e,"g",(function(){return y})),n.d(e,"h",(function(){return x})),n.d(e,"i",(function(){return k})),n.d(e,"j",(function(){return O})),n.d(e,"k",(function(){return C})),n.d(e,"l",(function(){return I})),n.d(e,"m",(function(){return E})),n.d(e,"n",(function(){return j})),n.d(e,"o",(function(){return F})),n.d(e,"p",(function(){return B})),n.d(e,"q",(function(){return W})),n.d(e,"r",(function(){return J})),n.d(e,"w",(function(){return Z["a"]})),n.d(e,"s",(function(){return et})),n.d(e,"t",(function(){return rt})),n.d(e,"u",(function(){return it})),n.d(e,"v",(function(){return st})),n.d(e,"x",(function(){return ct})),n.d(e,"z",(function(){return dt})),n.d(e,"A",(function(){return ht["a"]})),n.d(e,"B",(function(){return pt["a"]})),n.d(e,"C",(function(){return M["a"]})),n.d(e,"D",(function(){return mt})),n.d(e,"E",(function(){return yt})),n.d(e,"F",(function(){return vt["a"]})),n.d(e,"G",(function(){return xt["a"]})),n.d(e,"H",(function(){return V["a"]})),n.d(e,"I",(function(){return kt})),n.d(e,"J",(function(){return Ot})),n.d(e,"K",(function(){return Ct})),n.d(e,"L",(function(){return It})),n.d(e,"M",(function(){return At})),n.d(e,"N",(function(){return Nt["a"]})),n.d(e,"O",(function(){return Dt})),n.d(e,"P",(function(){return Mt})),n.d(e,"Q",(function(){return Lt})),n.d(e,"R",(function(){return Bt["a"]})),n.d(e,"S",(function(){return zt["a"]})),n.d(e,"U",(function(){return Wt["a"]})),n.d(e,"V",(function(){return Vt["a"]})),n.d(e,"W",(function(){return Gt})),n.d(e,"X",(function(){return qt})),n.d(e,"Y",(function(){return Xt})),n.d(e,"Z",(function(){return Jt})),n.d(e,"ab",(function(){return Qt})),n.d(e,"bb",(function(){return te["a"]})),n.d(e,"cb",(function(){return ie})),n.d(e,"db",(function(){return se})),n.d(e,"fb",(function(){return ce})),n.d(e,"gb",(function(){return le["a"]})),n.d(e,"ib",(function(){return ee["a"]})),n.d(e,"jb",(function(){return he})),n.d(e,"kb",(function(){return Te})),n.d(e,"lb",(function(){return Ie["a"]})),n.d(e,"mb",(function(){return Ne["a"]})),n.d(e,"nb",(function(){return Ae})),n.d(e,"ob",(function(){return De})),n.d(e,"qb",(function(){return gt["a"]})),n.d(e,"rb",(function(){return Fe["a"]})),n.d(e,"sb",(function(){return Me["a"]})),n.d(e,"ub",(function(){return Pe["a"]})),n.d(e,"wb",(function(){return $e["a"]})),n.d(e,"xb",(function(){return Le["a"]})),n.d(e,"zb",(function(){return Be["a"]})),n.d(e,"Db",(function(){return We})),n.d(e,"Eb",(function(){return Ue})),n.d(e,"Fb",(function(){return He})),n.d(e,"Gb",(function(){return qe["a"]})),n.d(e,"Hb",(function(){return Ke["a"]})),n.d(e,"Ib",(function(){return Xe["a"]})),n.d(e,"Kb",(function(){return Ye})),n.d(e,"Lb",(function(){return Ze})),n.d(e,"Mb",(function(){return Qe["a"]})),n.d(e,"Nb",(function(){return en})),n.d(e,"Ob",(function(){return un})),n.d(e,"Pb",(function(){return dn})),n.d(e,"Qb",(function(){return pn})),n.d(e,"Rb",(function(){return fn["a"]})),n.d(e,"Sb",(function(){return mn["a"]})),n.d(e,"Tb",(function(){return yn})),n.d(e,"Ub",(function(){return xn})),n.d(e,"Wb",(function(){return On})),n.d(e,"Xb",(function(){return U["a"]})),n.d(e,"Yb",(function(){return me})),n.d(e,"Zb",(function(){return Cn})),n.d(e,"ac",(function(){return In})),n.d(e,"bc",(function(){return En})),n.d(e,"cc",(function(){return An["a"]})),n.d(e,"dc",(function(){return jn})),n.d(e,"ec",(function(){return Mn})),n.d(e,"fc",(function(){return be})),n.d(e,"gc",(function(){return $n})),n.d(e,"hc",(function(){return Bn})),n.d(e,"ic",(function(){return Wn})),n.d(e,"jc",(function(){return Un})),n.d(e,"lc",(function(){return G["a"]})),n.d(e,"mc",(function(){return Hn})),n.d(e,"nc",(function(){return Kn})),n.d(e,"oc",(function(){return rn["a"]})),n.d(e,"qc",(function(){return Yn})),n.d(e,"rc",(function(){return Jn["a"]})),n.d(e,"sc",(function(){return Dn["a"]})),n.d(e,"tc",(function(){return Qn})),n.d(e,"vc",(function(){return er})),n.d(e,"wc",(function(){return nr["a"]})),n.d(e,"xc",(function(){return ar})),n.d(e,"yc",(function(){return or})),n.d(e,"zc",(function(){return ur})),n.d(e,"Ac",(function(){return lr})),n.d(e,"Bc",(function(){return mr})),n.d(e,"Cc",(function(){return ye["a"]})),n.d(e,"Dc",(function(){return gr["a"]})),n.d(e,"Ec",(function(){return br["a"]})),n.d(e,"Fc",(function(){return vr})),n.d(e,"Gc",(function(){return wr})),n.d(e,"Hc",(function(){return Sr})),n.d(e,"Ic",(function(){return _r})),n.d(e,"Jc",(function(){return Ar})),n.d(e,"Kc",(function(){return jr})),n.d(e,"Lc",(function(){return Fr})),n.d(e,"Mc",(function(){return Pr})),n.d(e,"Nc",(function(){return $r})),n.d(e,"Oc",(function(){return Lr["a"]})),n.d(e,"Pc",(function(){return zr})),n.d(e,"Qc",(function(){return Wr["a"]})),n.d(e,"Rc",(function(){return Vr["a"]})),n.d(e,"Sc",(function(){return $["a"]})),n.d(e,"Tc",(function(){return Ur["a"]})),n.d(e,"Uc",(function(){return Hr})),n.d(e,"Vc",(function(){return Kr})),n.d(e,"Wc",(function(){return Yr})),n.d(e,"Xc",(function(){return Zr})),n.d(e,"Zc",(function(){return ta})),n.d(e,"ad",(function(){return ea["a"]})),n.d(e,"bd",(function(){return ve["a"]})),n.d(e,"ed",(function(){return ra})),n.d(e,"fd",(function(){return ia})),n.d(e,"gd",(function(){return sa})),n.d(e,"hd",(function(){return H["a"]})),n.d(e,"id",(function(){return ca})),n.d(e,"kd",(function(){return la["a"]})),n.d(e,"ld",(function(){return da["a"]})),n.d(e,"md",(function(){return q["a"]})),n.d(e,"nd",(function(){return pa})),n.d(e,"od",(function(){return ma})),n.d(e,"pd",(function(){return ba})),n.d(e,"qd",(function(){return va})),n.d(e,"rd",(function(){return wa})),n.d(e,"sd",(function(){return on})),n.d(e,"td",(function(){return dr["a"]})),n.d(e,"pb",(function(){return Sa})),n.d(e,"yb",(function(){return _a})),n.d(e,"Cb",(function(){return Ta})),n.d(e,"Yc",(function(){return Aa})),n.d(e,"xd",(function(){return Ia["a"]})),n.d(e,"yd",(function(){return xe["a"]})),n.d(e,"zd",(function(){return we["a"]})),n.d(e,"Ad",(function(){return ja})),n.d(e,"Bd",(function(){return Fa})),n.d(e,"Cd",(function(){return Ma["a"]})),n.d(e,"Dd",(function(){return Pa["a"]})),n.d(e,"Ed",(function(){return La})),n.d(e,"Gd",(function(){return cn["a"]})),n.d(e,"Hd",(function(){return ke["a"]})),n.d(e,"Id",(function(){return za})),n.d(e,"Jd",(function(){return X})),n.d(e,"Kd",(function(){return Wa["a"]})),n.d(e,"Ld",(function(){return Ua})),n.d(e,"Md",(function(){return Ga})),n.d(e,"Nd",(function(){return Ha["a"]})),n.d(e,"Od",(function(){return qa})),n.d(e,"Pd",(function(){return Ka})),n.d(e,"Qd",(function(){return Xa})),n.d(e,"Rd",(function(){return Re["a"]})),n.d(e,"Sd",(function(){return Ja})),n.d(e,"Ud",(function(){return Qa})),n.d(e,"Vd",(function(){return ei})),n.d(e,"Wd",(function(){return ni["a"]})),n.d(e,"Xd",(function(){return ri["a"]})),n.d(e,"Yd",(function(){return ai})),n.d(e,"Zd",(function(){return ii})),n.d(e,"ae",(function(){return ne["a"]})),n.d(e,"be",(function(){return ui})),n.d(e,"ce",(function(){return Na["a"]})),n.d(e,"de",(function(){return re["a"]})),n.d(e,"y",(function(){return li})),n.d(e,"Td",(function(){return di["a"]})),n.d(e,"pc",(function(){return _e})),n.d(e,"kc",(function(){return pi})),n.d(e,"cd",(function(){return gi})),n.d(e,"dd",(function(){return Sn})),n.d(e,"vd",(function(){return vi})),n.d(e,"vb",(function(){return wi})),n.d(e,"eb",(function(){return Oi})),n.d(e,"hb",(function(){return _i})),n.d(e,"T",(function(){return Ci})),n.d(e,"Bb",(function(){return Ii})),n.d(e,"uc",(function(){return u["b"]})),n.d(e,"a",(function(){return u["a"]})),n.d(e,"Ab",(function(){return gs})),n.d(e,"Jb",(function(){return bs})),n.d(e,"Vb",(function(){return ys})),n.d(e,"wd",(function(){return fs})),n.d(e,"tb",(function(){return r})),n.d(e,"jd",(function(){return ms})),n.d(e,"ud",(function(){return vs})),n.d(e,"Fd",(function(){return xs}));var r={};n.r(r),n.d(r,"conv2d",(function(){return Ri})),n.d(r,"depthwiseConv2d",(function(){return Mi})),n.d(r,"matMul",(function(){return $i}));var a=n("a9d7"),i=n("219b"),o=n("388c"),s=n("4ffe"),u=n("f947");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t){const e=Object(s["a"])(t,"x","acos"),n={x:e};return i["a"].runKernel(o["b"],n)}const l=Object(u["b"])({acos_:c});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d(t){const e=Object(s["a"])(t,"x","acosh"),n={x:e};return i["a"].runKernel(o["c"],n)}const h=Object(u["b"])({acosh_:d});var p=n("a08f"),f=n("df00");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function m(t){f["b"](Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),f["b"](t.length>=1,()=>"Must pass at least one tensor to tf.addN(), but got "+t.length);const e=t.map((t,e)=>Object(s["a"])(t,"tensors"+e,"addN")),n=e[0];e.forEach(t=>{if(t.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(t=>{if(!f["a"](t.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return i["a"].runKernel(o["e"],r)}const g=Object(u["b"])({addN_:m});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b(t,e=null,n=!1){const r=Object(s["a"])(t,"x","all","bool"),a={x:r},u={axis:e,keepDims:n};return i["a"].runKernel(o["f"],a,u)}const y=Object(u["b"])({all_:b});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v(t,e=null,n=!1){const r=Object(s["a"])(t,"x","any","bool"),a={x:r},u={axis:e,keepDims:n};return i["a"].runKernel(o["g"],a,u)}const x=Object(u["b"])({any_:v});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w(t,e=0){const n=Object(s["a"])(t,"x","argMax"),r={x:n},a={axis:e};return i["a"].runKernel(o["h"],r,a)}const k=Object(u["b"])({argMax_:w});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S(t,e=0){const n=Object(s["a"])(t,"x","argMin"),r={x:n},a={axis:e};return i["a"].runKernel(o["i"],r,a)}const O=Object(u["b"])({argMin_:S});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _(t){const e=Object(s["a"])(t,"x","asin"),n={x:e};return i["a"].runKernel(o["j"],n)}const C=Object(u["b"])({asin_:_});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T(t){const e=Object(s["a"])(t,"x","asinh"),n={x:e};return i["a"].runKernel(o["k"],n)}const I=Object(u["b"])({asinh_:T});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N(t){const e=Object(s["a"])(t,"x","atan"),n={x:e};return i["a"].runKernel(o["l"],n)}const E=Object(u["b"])({atan_:N});var A=n("a6a7");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R(t,e){let n=Object(s["a"])(t,"a","atan2"),r=Object(s["a"])(e,"b","atan2");[n,r]=Object(A["makeTypesMatch"])(n,r);const a={a:n,b:r};return i["a"].runKernel(o["m"],a)}const j=Object(u["b"])({atan2_:R});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D(t){const e=Object(s["a"])(t,"x","atanh"),n={x:e};return i["a"].runKernel(o["n"],n)}const F=Object(u["b"])({atanh_:D});var M=n("7b50"),P=n("086c"),$=n("3a0f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function L(t,e,n,r,a){const u=Object(s["a"])(t,"x","avgPool","float32"),c=1;f["b"](P["i"](n,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${c}'`);let l=u,d=!1;3===u.rank&&(d=!0,l=Object($["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f["b"](4===l.rank,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),P["a"]("avgPool",r,a);const h={x:l},p={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let m=i["a"].runKernel(o["o"],h,p);return m=Object(M["a"])(m,u.dtype),d?Object($["a"])(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const B=Object(u["b"])({avgPool_:L});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z(t,e,n,r,a,u="NDHWC"){const c=Object(s["a"])(t,"x","avgPool3d","float32");let l=c,d=!1;4===c.rank&&(d=!0,l=Object($["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f["b"](5===l.rank,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),f["b"]("NDHWC"===u,()=>"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+u),Object(P["a"])("avgPool3d",r,a);const h={x:l},p={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:u};let m=i["a"].runKernel(o["p"],h,p);return m=Object(M["a"])(m,l.dtype),d?Object($["a"])(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const W=Object(u["b"])({avgPool3d_:z});var V=n("19d5"),U=n("5727"),G=n("0db7"),H=n("8ab3"),q=n("ed77");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function K(t){const e=Object(s["a"])(t,"x","tanh","float32"),n={x:e};return i["a"].runKernel(o["hd"],n)}const X=Object(u["b"])({tanh_:K});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y(t,e,n,r,a,i){const o=Object(s["a"])(t,"forgetBias","basicLSTMCell"),u=Object(s["a"])(e,"lstmKernel","basicLSTMCell"),c=Object(s["a"])(n,"lstmBias","basicLSTMCell"),l=Object(s["a"])(r,"data","basicLSTMCell"),d=Object(s["a"])(a,"c","basicLSTMCell"),h=Object(s["a"])(i,"h","basicLSTMCell"),f=Object(V["a"])([l,h],1),m=Object(U["a"])(f,u),g=Object(p["a"])(m,c),b=g.shape[0],y=g.shape[1]/4,v=[b,y],x=Object(q["a"])(g,[0,0],v),w=Object(q["a"])(g,[0,y],v),k=Object(q["a"])(g,[0,2*y],v),S=Object(q["a"])(g,[0,3*y],v),O=Object(p["a"])(Object(G["a"])(Object(H["a"])(x),X(w)),Object(G["a"])(d,Object(H["a"])(Object(p["a"])(o,k)))),_=Object(G["a"])(X(O),Object(H["a"])(S));return[O,_]}const J=Object(u["b"])({basicLSTMCell_:Y});var Z=n("70be");function Q(t){let e;return e=0===t.rank||1===t.rank?Object($["a"])(t,[1,1,1,t.size]):2===t.rank?Object($["a"])(t,[1,1,t.shape[0],t.shape[1]]):3===t.rank?Object($["a"])(t,[1,t.shape[0],t.shape[1],t.shape[2]]):t,e}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tt(t,e,n,r,a,u){null==u&&(u=.001);const c=Object(s["a"])(t,"x","batchNorm"),l=Object(s["a"])(e,"mean","batchNorm"),d=Object(s["a"])(n,"variance","batchNorm");let h,p;null!=a&&(h=Object(s["a"])(a,"scale","batchNorm")),null!=r&&(p=Object(s["a"])(r,"offset","batchNorm")),f["b"](l.rank===d.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),f["b"](null==p||l.rank===p.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),f["b"](null==h||l.rank===h.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const m=Q(c),g={x:m,scale:h,offset:p,mean:l,variance:d},b={varianceEpsilon:u},y=i["a"].runKernel(o["lb"],g,b);return Object($["a"])(y,c.shape)}const et=Object(u["b"])({batchNorm_:tt});function nt(t,e,n,r,a,i){const o=Object(s["a"])(t,"x","batchNorm"),u=Object(s["a"])(e,"mean","batchNorm"),c=Object(s["a"])(n,"variance","batchNorm");let l,d;return null!=a&&(l=Object(s["a"])(a,"scale","batchNorm")),null!=r&&(d=Object(s["a"])(r,"offset","batchNorm")),f["b"](2===o.rank,()=>"Error in batchNorm2D: x must be rank 2 but got rank "+o.rank+"."),f["b"](2===u.rank||1===u.rank,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${u.rank}.`),f["b"](2===c.rank||1===c.rank,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),null!=l&&f["b"](2===l.rank||1===l.rank,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),null!=d&&f["b"](2===d.rank||1===d.rank,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),et(o,u,c,d,l,i)}const rt=Object(u["b"])({batchNorm2d_:nt});function at(t,e,n,r,a,i){const o=Object(s["a"])(t,"x","batchNorm"),u=Object(s["a"])(e,"mean","batchNorm"),c=Object(s["a"])(n,"variance","batchNorm");let l,d;return null!=a&&(l=Object(s["a"])(a,"scale","batchNorm")),null!=r&&(d=Object(s["a"])(r,"offset","batchNorm")),f["b"](3===o.rank,()=>"Error in batchNorm3D: x must be rank 3 but got rank "+o.rank+"."),f["b"](3===u.rank||1===u.rank,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${u.rank}.`),f["b"](3===c.rank||1===c.rank,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),null!=l&&f["b"](3===l.rank||1===l.rank,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),null!=d&&f["b"](3===d.rank||1===d.rank,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),et(o,u,c,d,l,i)}const it=Object(u["b"])({batchNorm3d_:at});function ot(t,e,n,r,a,i){const o=Object(s["a"])(t,"x","batchNorm"),u=Object(s["a"])(e,"mean","batchNorm"),c=Object(s["a"])(n,"variance","batchNorm");let l,d;return null!=a&&(l=Object(s["a"])(a,"scale","batchNorm")),null!=r&&(d=Object(s["a"])(r,"offset","batchNorm")),f["b"](4===o.rank,()=>"Error in batchNorm4D: x must be rank 4 but got rank "+o.rank+"."),f["b"](4===u.rank||1===u.rank,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${u.rank}.`),f["b"](4===c.rank||1===c.rank,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),null!=l&&f["b"](4===l.rank||1===l.rank,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),null!=d&&f["b"](4===d.rank||1===d.rank,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),et(o,u,c,d,l,i)}const st=Object(u["b"])({batchNorm4d_:ot});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ut(t,e,n){const r=Object(s["a"])(t,"x","bincount"),a=Object(s["a"])(e,"weights","bincount");f["b"]("int32"===r.dtype,()=>"Error in bincount: input dtype must be int32, but got "+r.dtype),f["b"](n>=0,()=>`size must be non-negative, but got ${n}.`),f["b"](a.size===r.size||0===a.size,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: `+a.shape+".");const u={x:r,weights:a},c={size:n};return i["a"].runKernel(o["u"],u,c)}const ct=Object(u["b"])({bincount_:ut});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lt(t,e){const n=Object(s["a"])(t,"s0","broadcastArgs","int32"),r=Object(s["a"])(e,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error("broadcastArgs(): first input must be a vector (rank=1). Has rank "+n.rank);if(1!==r.rank)throw new Error("broadcastArgs(): second input must be a vector (rank=1). Has rank "+r.rank);const a={s0:n,s1:r};return i["a"].runKernel(o["v"],a)}const dt=Object(u["b"])({broadcastArgs_:lt});var ht=n("0b61"),pt=n("6128");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ft(t){const e=Object(s["a"])(t,"x","ceil","float32"),n={x:e};return i["a"].runKernel(o["y"],n)}const mt=Object(u["b"])({ceil_:ft});var gt=n("1469");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bt(t,e,n){const r=Object(s["a"])(t,"x","clipByValue");if(f["b"](e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Object(gt["a"])(r.shape,e,r.dtype);const a={x:r},u={clipValueMin:e,clipValueMax:n};return i["a"].runKernel(o["z"],a,u)}const yt=Object(u["b"])({clipByValue_:bt});var vt=n("4e1f"),xt=n("d579");function wt(t){return Object(V["a"])(t,0)}const kt=Object(u["b"])({concat1d_:wt});function St(t,e){return Object(V["a"])(t,e)}const Ot=Object(u["b"])({concat2d_:St});function _t(t,e){return Object(V["a"])(t,e)}const Ct=Object(u["b"])({concat3d_:_t});function Tt(t,e){return Object(V["a"])(t,e)}const It=Object(u["b"])({concat4d_:Tt});var Nt=n("4b53");function Et(t,e,n,r,a="NWC",i=1,o){const u=Object(s["a"])(t,"x","conv1d"),c=Object(s["a"])(e,"filter","conv1d");let l=u,d=!1;2===u.rank&&(d=!0,l=Object($["a"])(u,[1,u.shape[0],u.shape[1]])),f["b"](3===l.rank,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),f["b"](3===c.rank,()=>"Error in conv1d: filter must be rank 3, but got rank "+c.rank+"."),P["a"]("conv1d",r,o),f["b"](l.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${c.shape[1]}.`),f["b"](P["i"](n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),f["b"]("NWC"===a,()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const h=Object($["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2]]),p=Object($["a"])(l,[l.shape[0],1,l.shape[1],l.shape[2]]),m=[1,n],g=[1,i],b="NHWC",y=Object(Nt["a"])(p,h,m,r,b,g,o);return d?Object($["a"])(y,[y.shape[2],y.shape[3]]):Object($["a"])(y,[y.shape[0],y.shape[2],y.shape[3]])}const At=Object(u["b"])({conv1d_:Et});var Rt=n("609e");function jt(t,e,n,r,a,i){const o=Object(s["a"])(t,"x","conv2dTranspose"),u=Object(s["a"])(e,"filter","conv2dTranspose");return Object(Rt["a"])(n,o,u,r,a,"NHWC",i)}const Dt=Object(u["b"])({conv2dTranspose_:jt});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ft(t,e,n,r,a="NDHWC",u=[1,1,1]){const c=Object(s["a"])(t,"x","conv3d"),l=Object(s["a"])(e,"filter","conv3d");let d=c,h=!1;4===c.rank&&(h=!0,d=Object($["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f["b"](5===d.rank,()=>`Error in conv3d: input must be rank 5, but got rank ${d.rank}.`),f["b"](5===l.rank,()=>"Error in conv3d: filter must be rank 5, but got rank "+l.rank+"."),f["b"](d.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${d.shape[4]}) must match input depth for filter ${l.shape[3]}.`),f["b"](Object(P["i"])(n,u),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${u}'`),f["b"]("NDHWC"===a,()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`);const p={x:d,filter:l},m={strides:n,pad:r,dataFormat:a,dilations:u},g=i["a"].runKernel(o["G"],p,m);return h?Object($["a"])(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const Mt=Object(u["b"])({conv3d_:Ft});var Pt=n("3d68");function $t(t,e,n,r,a){const i=Object(s["a"])(t,"x","conv3dTranspose"),o=Object(s["a"])(e,"filter","conv3dTranspose");return Object(Pt["a"])(n,i,o,r,a)}const Lt=Object(u["b"])({conv3dTranspose_:$t});var Bt=n("8df9"),zt=n("050a"),Wt=n("c76e"),Vt=n("1c95");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ut(t,e,n,r=!1){const a=Object(s["a"])(t,"x","denseBincount"),u=Object(s["a"])(e,"weights","denseBincount");f["b"]("int32"===a.dtype,()=>"Error in denseBincount: input dtype must be int32, but got "+a.dtype),f["b"](a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),f["b"](n>=0,()=>`size must be non-negative, but got ${n}.`),f["b"](u.size===a.size||0===u.size,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: `+u.shape+".");const c={x:a,weights:u},l={size:n,binaryOutput:r};return i["a"].runKernel(o["O"],c,l)}const Gt=Object(u["b"])({denseBincount_:Ut});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(t,e,n="NHWC"){const r=Object(s["a"])(t,"x","depthToSpace","float32"),a="NHWC"===n?r.shape[1]:r.shape[2],u="NHWC"===n?r.shape[2]:r.shape[3],c="NHWC"===n?r.shape[3]:r.shape[1];f["b"](e>1,()=>"blockSize should be > 1 for depthToSpace, but was: "+e),f["b"](a*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${a} and ${e}  for depthToSpace with input shape\n    ${r.shape}`),f["b"](u*e>=0,()=>`Negative dimension size caused by overflow when multiplying\n    ${u} and ${e} for depthToSpace with input shape\n        ${r.shape}`),f["b"](c%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${c} for depthToSpace with input shape ${r.shape}`);const l={x:r},d={blockSize:e,dataFormat:n};return i["a"].runKernel(o["P"],l,d)}const qt=Object(u["b"])({depthToSpace_:Ht});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kt(t,e,n,r,a="NHWC",u=[1,1],c){const l=Object(s["a"])(t,"x","depthwiseConv2d","float32"),d=Object(s["a"])(e,"filter","depthwiseConv2d","float32");let h=l,p=!1;3===l.rank&&(p=!0,h=Object($["a"])(l,[1,l.shape[0],l.shape[1],l.shape[2]])),f["b"](4===h.rank,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),f["b"](4===d.rank,()=>"Error in depthwiseConv2d: filter must be rank 4, but got rank "+d.rank+".");const m="NHWC"===a?h.shape[3]:h.shape[1];f["b"](m===d.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${m}) must match the inChannels dimension in filter ${d.shape[2]}.`),P["a"]("depthwiseConv2d",r,c);const g={x:h,filter:d},b={strides:n,pad:r,dataFormat:a,dilations:u,dimRoundingMode:c},y=i["a"].runKernel(o["Q"],g,b);return p?Object($["a"])(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Xt=Object(u["b"])({depthwiseConv2d_:Kt});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yt(t){const e=Object(s["a"])(t,"x","diag"),n={x:e};return i["a"].runKernel(o["T"],n)}const Jt=Object(u["b"])({diag_:Yt});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zt(t,e,n,r,a=[1,1],u="NHWC"){const c=Object(s["a"])(t,"x","dilation2d"),l=Object(s["a"])(e,"filter","dilation2d");f["b"](3===c.rank||4===c.rank,()=>"Error in dilation2d: input must be rank 3 or 4, but got rank "+c.rank+"."),f["b"](3===l.rank,()=>"Error in dilation2d: filter must be rank 3, but got rank "+l.rank+"."),f["b"]("NHWC"===u,()=>"Error in dilation2d: Only NHWC is currently supported, but got dataFormat of "+u);let d=c,h=!1;3===c.rank&&(d=Object($["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=!0);const p={x:d,filter:l},m={strides:n,pad:r,dilations:a},g=i["a"].runKernel(o["U"],p,m);return h?Object($["a"])(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Qt=Object(u["b"])({dilation2d_:Zt});var te=n("fb3e"),ee=n("bfff"),ne=n("f9cd"),re=n("96d8");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ae(t,e){let n=Object(s["a"])(t,"a","div"),r=Object(s["a"])(e,"b","div");[n,r]=Object(A["makeTypesMatch"])(n,r);const a=Object(te["a"])(n,r),i=Object(re["a"])(a),o=Object(ee["a"])(r,i);return Object(ne["a"])(o,i,a)}const ie=Object(u["b"])({divNoNan_:ae});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oe(t,e){const n=Object(s["a"])(t,"t1","dot"),r=Object(s["a"])(e,"t2","dot");f["b"]((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(f["b"](a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),1===n.rank&&1===r.rank){const t=Object($["a"])(n,[1,-1]),e=Object($["a"])(r,[-1,1]),a=Object(U["a"])(t,e);return Object($["a"])(a,[])}if(1===n.rank&&2===r.rank){const t=Object($["a"])(n,[1,-1]),e=Object($["a"])(r,[r.shape[0],r.shape[1]]),a=Object(U["a"])(t,e);return Object($["a"])(a,[a.size])}if(2===n.rank&&1===r.rank){const t=Object($["a"])(r,[-1,1]),e=Object(U["a"])(n,t);return Object($["a"])(e,[e.size])}{const t=Object($["a"])(r,[r.shape[0],r.shape[1]]),e=Object(U["a"])(n,t);return e}}const se=Object(u["b"])({dot_:oe});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t,...e){const n=e.map((t,e)=>Object(s["a"])(t,"tensors"+e,"einsum")),r={equation:t};return i["a"].runKernel(o["X"],n,r)}const ce=Object(u["b"])({einsum_:ue});var le=n("85d9");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function de(t){let e=Object(s["a"])(t,"x","erf");f["b"]("int32"===e.dtype||"float32"===e.dtype,()=>"Input dtype must be `int32` or `float32`."),"int32"===e.dtype&&(e=Object(M["a"])(e,"float32"));const n={x:e};return i["a"].runKernel(o["bb"],n)}const he=Object(u["b"])({erf_:de});var pe=n("97ca");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fe(t,e=null,n=!1){const r=Object(s["a"])(t,"x","max"),a={x:r},u={reductionIndices:e,keepDims:n};return i["a"].runKernel(o["Mb"],a,u)}const me=Object(u["b"])({max_:fe});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ge(t,e=null,n=!1){const r=Object(s["a"])(t,"x","min"),a={x:r},u={axis:e,keepDims:n};return i["a"].runKernel(o["Ub"],a,u)}const be=Object(u["b"])({min_:ge});var ye=n("5e33"),ve=n("1ba2"),xe=n("330c"),we=n("c794"),ke=n("6c52");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Se(t,e="euclidean",n=null,r=!1){t=Object(s["a"])(t,"x","norm");const a=Oe(t,e,n);let i=a.shape;if(r){const e=Object(f["I"])(n,t.shape);i=pe["e"](a.shape,e)}return Object($["a"])(a,i)}function Oe(t,e,n=null){if(0===t.rank)return Object(a["a"])(t);if(1!==t.rank&&null===n)return Oe(Object($["a"])(t,[-1]),e,n);if(1===t.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===e)return Object(ke["a"])(Object(a["a"])(t),n);if(e===1/0)return me(Object(a["a"])(t),n);if(e===-1/0)return be(Object(a["a"])(t),n);if("euclidean"===e||2===e)return Object(xe["a"])(Object(ke["a"])(Object(ye["a"])(Object(a["a"])(t),Object(ve["a"])(2,"int32")),n));throw new Error("Error in norm: invalid ord value: "+e)}if(Array.isArray(n)&&2===n.length){if(1===e)return me(Object(ke["a"])(Object(a["a"])(t),n[0]),n[1]-1);if(e===1/0)return me(Object(ke["a"])(Object(a["a"])(t),n[1]),n[0]);if(e===-1/0)return be(Object(ke["a"])(Object(a["a"])(t),n[1]),n[0]);if("fro"===e||"euclidean"===e)return Object(xe["a"])(Object(ke["a"])(Object(we["a"])(t),n));throw new Error("Error in norm: invalid ord value: "+e)}throw new Error("Error in norm: invalid axis: "+n)}const _e=Object(u["b"])({norm_:Se});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(t,e=null,n=!1){return _e(t,"euclidean",e,n)}const Te=Object(u["b"])({euclideanNorm_:Ce});var Ie=n("54eb"),Ne=n("0d7e");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ee(t){const e=Object(s["a"])(t,"x","expm1"),n={x:e};return i["a"].runKernel(o["eb"],n)}const Ae=Object(u["b"])({expm1_:Ee});var Re=n("565f");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function je(t,e,n,r="float32"){null==e&&(e=t);const a=Object(pt["a"])([t,e],r),i=t<=e?t:e;for(let s=0;s<i;++s)a.set(1,s,s);const o=Object($["a"])(a.toTensor(),[t,e]);if(null==n)return o;if(1===n.length)return Object(Re["a"])(Object(Ne["a"])(o,0),[n[0],1,1]);if(2===n.length)return Object(Re["a"])(Object(Ne["a"])(Object(Ne["a"])(o,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(Re["a"])(Object(Ne["a"])(Object(Ne["a"])(Object(Ne["a"])(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const De=Object(u["b"])({eye_:je});var Fe=n("c779"),Me=n("2fce"),Pe=n("ed06"),$e=n("744c"),Le=n("b970"),Be=n("2337");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ze(t){const e=Object(s["a"])(t,"x","isFinite"),n={x:e};return i["a"].runKernel(o["vb"],n)}const We=Object(u["b"])({isFinite_:ze});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(t){const e=Object(s["a"])(t,"x","isInf"),n={x:e};return i["a"].runKernel(o["wb"],n)}const Ue=Object(u["b"])({isInf_:Ve});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(t){const e=Object(s["a"])(t,"x","isNaN"),n={x:e};return i["a"].runKernel(o["xb"],n)}const He=Object(u["b"])({isNaN_:Ge});var qe=n("fbe2"),Ke=n("bd11"),Xe=n("469c");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ye(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return i["a"].runKernel(o["Db"],{},r)}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Je(t,e=5,n=1,r=1,a=.5){const u=Object(s["a"])(t,"x","localResponseNormalization");f["b"](4===u.rank||3===u.rank,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${u.rank}.`),f["b"](f["v"](e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let c=u,l=!1;3===u.rank&&(l=!0,c=Object($["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2]]));const d={x:c},h={depthRadius:e,bias:n,alpha:r,beta:a},p=i["a"].runKernel(o["yb"],d,h);return l?Object($["a"])(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Ze=Object(u["b"])({localResponseNormalization_:Je});var Qe=n("5470");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(t){const e=Object(s["a"])(t,"x","log1p"),n={x:e};return i["a"].runKernel(o["Fb"],n)}const en=Object(u["b"])({log1p_:tn});var nn=n("b181"),rn=n("ea03");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function an(t){const e=Object(s["a"])(t,"x","softplus"),n={x:e};return i["a"].runKernel(o["Oc"],n)}const on=Object(u["b"])({softplus_:an});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sn(t){const e=Object(s["a"])(t,"x","logSigmoid"),n=Object(nn["a"])(t=>{const e=Object(rn["a"])(on(Object(rn["a"])(t))),n=e=>{const n=Object(G["a"])(e,Object(H["a"])(Object(rn["a"])(t)));return n};return{value:e,gradFunc:n}});return n(e)}const un=Object(u["b"])({logSigmoid_:sn});var cn=n("0233");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ln(t,e=-1){const n=Object(s["a"])(t,"logits","logSoftmax");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);const r=Object(nn["a"])((t,n)=>{const r=!0,a=me(t,e,!0),i=Object(cn["a"])(t,a),o=Object(cn["a"])(Object(M["a"])(i,"float32"),Object(Qe["a"])(Object(ke["a"])(Object(Ie["a"])(i),e,r)));n([o]);const s=(t,n)=>{const[r]=n,a=!0,i=Object(Ie["a"])(r);return Object(cn["a"])(t,Object(G["a"])(Object(ke["a"])(t,e,a),i))};return{value:o,gradFunc:s}});return r(n)}const dn=Object(u["b"])({logSoftmax_:ln});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hn(t,e=null,n=!1){const r=Object(s["a"])(t,"x","logSumExp"),a=Object(f["I"])(e,r.shape),i=me(r,a,!0),o=Object(cn["a"])(r,i),u=Object(Ie["a"])(o),c=Object(ke["a"])(u,a),l=Object(Qe["a"])(c),d=Object(p["a"])(Object($["a"])(i,l.shape),l);if(n){const t=Object(pe["e"])(d.shape,a);return Object($["a"])(d,t)}return d}const pn=Object(u["b"])({logSumExp_:hn});var fn=n("5dbe"),mn=n("4db8"),gn=n("ae86");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function bn(t,e){const n=Object(s["a"])(t,"a","logicalOr","bool"),r=Object(s["a"])(e,"b","logicalOr","bool");Object(gn["assertAndGetBroadcastShape"])(n.shape,r.shape);const a={a:n,b:r};return i["a"].runKernel(o["Jb"],a)}const yn=Object(u["b"])({logicalOr_:bn});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(t,e){const n=Object(s["a"])(t,"a","logicalXor","bool"),r=Object(s["a"])(e,"b","logicalXor","bool");return Object(gn["assertAndGetBroadcastShape"])(n.shape,r.shape),Object(fn["a"])(yn(t,e),Object(mn["a"])(Object(fn["a"])(t,e)))}const xn=Object(u["b"])({logicalXor_:vn}),wn=2147483648;
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(t,e,n="left"){const r=Object(s["a"])(t,"sortedSequence","searchSorted"),a=Object(s["a"])(e,"values","searchSorted"),u=r.shape[r.shape.length-1],c=a.shape[a.shape.length-1],l=Object($["a"])(r,[-1,u]),d=Object($["a"])(a,[-1,c]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==d.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Object(f["O"])(d.shape)>=wn)throw new Error("values tensor size must less than "+wn);if(l.shape[1]>=wn)throw new Error(`trailing dim_size must less than ${wn} for int32 output type, was ${l.shape[1]}`);const h={sortedSequence:l,values:d},p={side:n};return i["a"].runKernel(o["Fc"],h,p)}const Sn=Object(u["b"])({searchSorted_:kn});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function On(t,e){return Sn(t,e,"left")}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(t,e,n,r,a){const u=Object(s["a"])(t,"x","maxPool"),c=1;let l=u,d=!1;3===u.rank&&(d=!0,l=Object($["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f["b"](4===l.rank,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),f["b"](P["i"](n,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${c}'`),P["a"]("maxPool",r,a);const h={x:l},p={filterSize:e,strides:n,pad:r,dimRoundingMode:a},m=i["a"].runKernel(o["Nb"],h,p);return d?Object($["a"])(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const Cn=Object(u["b"])({maxPool_:_n});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tn(t,e=[1,1,1],n,r,a,u="NDHWC"){const c=Object(s["a"])(t,"x","maxPool3d");let l=c,d=!1;4===c.rank&&(d=!0,l=Object($["a"])(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),f["b"](5===l.rank,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),f["b"]("NDHWC"===u,()=>"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+u),Object(P["a"])("maxPool3d",r,a);const h={x:l},p={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:u},m=i["a"].runKernel(o["Ob"],h,p);return d?Object($["a"])(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const In=Object(u["b"])({maxPool3d_:Tn});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(t,e,n,r,a=!1){const u=Object(s["a"])(t,"x","maxPoolWithArgmax"),c={x:u},l={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},d=i["a"].runKernel(o["Rb"],c,l);return{result:d[0],indexes:d[1]}}const En=Object(u["b"])({maxPoolWithArgmax_:Nn});var An=n("353b");
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rn(t,e=null,n=!1){const r=Object(s["a"])(t,"x","mean"),a={x:r},u={axis:e,keepDims:n};return i["a"].runKernel(o["Tb"],a,u)}const jn=Object(u["b"])({mean_:Rn});var Dn=n("858d"),Fn=n("4e56");
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Mn(t,e,{indexing:n="xy"}={}){if("xy"!==n&&"ij"!==n)throw new TypeError(n+" is not a valid third argument to meshgrid");if(void 0===t)return[];let r=Object(s["a"])(t,"x","meshgrid",t instanceof Fn["a"]?t.dtype:"float32");if(void 0===e)return[r];let a=Object(s["a"])(e,"y","meshgrid",e instanceof Fn["a"]?e.dtype:"float32");const i=Object(f["O"])(r.shape),o=Object(f["O"])(a.shape);return"xy"===n?(r=Object($["a"])(r,[1,-1]),a=Object($["a"])(a,[-1,1]),[Object(U["a"])(Object(Dn["a"])([o,1],r.dtype),r),Object(U["a"])(a,Object(Dn["a"])([1,i],a.dtype))]):(r=Object($["a"])(r,[-1,1]),a=Object($["a"])(a,[1,-1]),[Object(U["a"])(r,Object(Dn["a"])([1,o],r.dtype)),Object(U["a"])(Object(Dn["a"])([i,1],a.dtype),a)])}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pn(t,e){let n=Object(s["a"])(t,"a","minimum"),r=Object(s["a"])(e,"b","minimum");[n,r]=Object(A["makeTypesMatch"])(n,r),"bool"===n.dtype&&(n=Object(M["a"])(n,"int32"),r=Object(M["a"])(r,"int32")),Object(gn["assertAndGetBroadcastShape"])(n.shape,r.shape);const a={a:n,b:r};return i["a"].runKernel(o["Vb"],a)}const $n=Object(u["b"])({minimum_:Pn});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ln(t,e,n){f["b"]("reflect"===n||"symmetric"===n,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=Object(s["a"])(t,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");f["b"](e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a="reflect"===n?1:0;for(let i=0;i<r.rank;i++)f["b"](2===e[i].length,()=>"Invalid number of paddings. Must be length of 2 each."),f["b"](e[i][0]>=0&&e[i][0]<=r.shape[i]-a&&e[i][1]>=0&&e[i][1]<=r.shape[i]-a,()=>`Padding in dimension ${i} cannot be greater than or equal to ${r.shape[i]-a} or less than 0 for input of shape `+r.shape);const u={paddings:e,mode:n},c={x:r};return i["a"].runKernel(o["Wb"],c,u)}const Bn=Object(u["b"])({mirrorPad_:Ln});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zn(t,e){let n=Object(s["a"])(t,"a","mod"),r=Object(s["a"])(e,"b","mod");[n,r]=Object(A["makeTypesMatch"])(n,r);const a={a:n,b:r};return i["a"].runKernel(o["Xb"],a)}const Wn=Object(u["b"])({mod_:zn});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vn(t,e=null,n=!1){t=Object(s["a"])(t,"x","moments");const r=Object(f["I"])(e,t.shape),a=jn(t,r,n);let i=a.shape;n||(i=Object(pe["e"])(a.shape,r));const o=Object(we["a"])(Object(cn["a"])(Object(M["a"])(t,"float32"),Object($["a"])(a,i))),u=jn(o,r,n);return{mean:a,variance:u}}const Un=Object(u["b"])({moments_:Vn});function Gn(t,e,n,r){const a=Object(s["a"])(e,"data","multiRNNCell"),i=Object(s["b"])(n,"c","multiRNNCell"),o=Object(s["b"])(r,"h","multiRNNCell");let u=a;const c=[];for(let s=0;s<t.length;s++){const e=t[s](u,i[s],o[s]);c.push(e[0]),c.push(e[1]),u=e[1]}const l=[],d=[];for(let s=0;s<c.length;s+=2)l.push(c[s]),d.push(c[s+1]);return[l,d]}const Hn=Object(u["b"])({multiRNNCell_:Gn});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(t,e,n,r=!1){const a=Object(s["a"])(t,"logits","multinomial"),u=a.size,c=a.rank;if(u<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+u+".");if(c>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+c);n=n||Math.random();const l=1===c?Object($["a"])(a,[1,-1]):a,d={logits:l},h={numSamples:e,seed:n,normalized:r},p=i["a"].runKernel(o["Yb"],d,h);return 1===c?Object($["a"])(p,[p.size]):p}const Kn=Object(u["b"])({multinomial_:qn});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xn(t,e){let n=Object(s["a"])(t,"a","notEqual","string_or_numeric"),r=Object(s["a"])(e,"b","notEqual","string_or_numeric");[n,r]=Object(A["makeTypesMatch"])(n,r),Object(gn["assertAndGetBroadcastShape"])(n.shape,r.shape);const a={a:n,b:r};return i["a"].runKernel(o["ec"],a)}const Yn=Object(u["b"])({notEqual_:Xn});var Jn=n("ff30");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zn(t){const e=Object(s["a"])(t,"x","onesLike"),n={x:e};return i["a"].runKernel(o["gc"],n)}const Qn=Object(u["b"])({onesLike_:Zn});function tr(t,e){const n=Object(s["a"])(t,"v1","outerProduct"),r=Object(s["a"])(e,"v2","outerProduct");f["b"](1===n.rank&&1===r.rank,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const a=Object($["a"])(n,[-1,1]),i=Object($["a"])(r,[1,-1]);return Object(U["a"])(a,i)}const er=Object(u["b"])({outerProduct_:tr});var nr=n("3f84");function rr(t,e,n=0){return Object(f["b"])(2===e.length,()=>"Invalid number of paddings. Must be length of 2."),Object(nr["a"])(t,[e],n)}const ar=Object(u["b"])({pad1d_:rr});function ir(t,e,n=0){return Object(f["b"])(2===e.length&&2===e[0].length&&2===e[1].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(nr["a"])(t,e,n)}const or=Object(u["b"])({pad2d_:ir});function sr(t,e,n=0){return Object(f["b"])(3===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(nr["a"])(t,e,n)}const ur=Object(u["b"])({pad3d_:sr});function cr(t,e,n=0){return Object(f["b"])(4===e.length&&2===e[0].length&&2===e[1].length&&2===e[2].length&&2===e[3].length,()=>"Invalid number of paddings. Must be length of 2 each."),Object(nr["a"])(t,e,n)}const lr=Object(u["b"])({pad4d_:cr});var dr=n("cd00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(t,e,n,r,a,i,o){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");const u=Object(s["a"])(t,"x","maxPool");let c=u,l=!1;3===u.rank&&(l=!0,c=Object($["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2]])),f["b"](P["i"](i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);const d=P["f"](c.shape,e,i,a,r),h=[d.dilationHeight,d.dilationWidth];let p;p="same"===r?fr([d.filterHeight,d.filterWidth],h):[[0,0],[0,0]];const m=1===h[0]&&1===h[1],[g,b]=pr([d.inHeight,d.inWidth],h,p),y=m?r:"valid",v=m?c:Object(dr["a"])(c,h,g),x="avg"===n?()=>B(v,e,i,y,o):()=>Cn(v,e,i,y,o),w=x(),k=m?w:Object(Z["a"])(w,h,b);return l?Object($["a"])(k,[k.shape[1],k.shape[2],k.shape[3]]):k}function pr(t,e,n){const r=n.map(t=>t[0]),a=n.map(t=>t[1]),i=t.concat(r,a),o=e.map((t,e)=>(t-i[e]%t)%t),s=a.map((t,e)=>t+o[e]),u=e.map((t,e)=>[r[e],s[e]]),c=e.map((t,e)=>[0,o[e]]);return[u,c]}function fr(t,e){const n=t.map((t,n)=>t+(t-1)*(e[n]-1)),r=n.map(t=>t-1),a=r.map(t=>Math.floor(t/2)),i=r.map((t,e)=>t-a[e]);return r.map((t,e)=>[a[e],i[e]])}const mr=Object(u["b"])({pool_:hr});var gr=n("d76f"),br=n("ca58");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function yr(t,e=null,n=!1){let r=Object(s["a"])(t,"x","prod");"bool"===r.dtype&&(r=Object(M["a"])(r,"int32"));const a={x:r},u={axis:e,keepDims:n};return i["a"].runKernel(o["mc"],a,u)}const vr=Object(u["b"])({prod_:yr});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xr(t,e,n,r){const a=t.map((t,e)=>Object(s["a"])(t,"tensors"+e,"raggedGather","int32")),u=Object(s["a"])(e,"paramsDenseValues","raggedGather"),c=Object(s["a"])(n,"indices","raggedGather","int32"),l={paramsNestedSplits:a,paramsDenseValues:u,indices:c},d={outputRaggedRank:r},h=i["a"].runKernel(o["nc"],l,d);return{outputNestedSplits:h.slice(0,h.length-1),outputDenseValues:h[h.length-1]}}const wr=Object(u["b"])({raggedGather_:xr});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kr(t,e,n,r,a){const u=Object(s["a"])(t,"shape","raggedTensorToTensor","int32"),c=Object(s["a"])(e,"values","raggedTensorToTensor"),l=Object(s["a"])(n,"defaultValue","raggedTensorToTensor",c.dtype),d=r.map((t,e)=>Object(s["a"])(t,"tensors"+e,"raggedTensorToTensor","int32")),h={shape:u,values:c,defaultValue:l,rowPartitionTensors:d},p={rowPartitionTypes:a};return i["a"].runKernel(o["oc"],h,p)}const Sr=Object(u["b"])({raggedTensorToTensor_:kr});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Or(t,e,n){const r=Object(f["O"])(t);let a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(let i=0;i<r;i++)a[i]=e();return i["a"].makeTensor(a,t,n)}const _r=Object(u["b"])({rand_:Or});var Cr=n("6125");n("509f");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
class Tr{constructor(t,e,n,r,a){this.mean=t,this.stdDev=e,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const i=a||Math.random();this.random=Cr["alea"](i.toString())}nextValue(){if(!isNaN(this.nextVal)){const t=this.nextVal;return this.nextVal=NaN,t}let t,e,n=!1;while(!n){let r,a,i;do{r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a}while(i>=1||0===i);const o=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*r*o,e=this.mean+this.stdDev*a*o,this.truncated&&!this.isValidTruncated(t)||(n=!0)}return this.truncated&&!this.isValidTruncated(e)||(this.nextVal=this.convertValue(e)),this.convertValue(t)}convertValue(t){return null==this.dtype||"float32"===this.dtype?t:Math.round(t)}isValidTruncated(t){return t<=this.upper&&t>=this.lower}}class Ir{constructor(t,e,n,r){this.alpha=t,this.beta=1/e,this.dtype=n;const a=r||Math.random();this.randu=Cr["alea"](a.toString()),this.randn=new Tr(0,1,n,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let t,e,n,r,a,i;while(1){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=r*r,e=1-.331*t*t,n=.5*t+this.d*(1-i+Math.log(i)),a=this.randu(),a<e||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(t){return"float32"===this.dtype?t:Math.round(t)}}class Nr{constructor(t=0,e=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=t,this.range=e-t,this.dtype=n,null==r&&(r=Math.random()),"number"===typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${t} - ${e} <= 1 and dtype is not float`);this.random=Cr["alea"](r)}convertValue(t){return this.canReturnFloat()?t:Math.round(t)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Er(t,e,n=1,r="float32",a){if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);const i=new Ir(e,n,r,a),o=Object(pt["a"])(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const Ar=Object(u["b"])({randomGamma_:Er});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rr(t,e=0,n=1,r,a){if(null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);const i=new Tr(e,n,r,!1,a),o=Object(pt["a"])(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const jr=Object(u["b"])({randomNormal_:Rr});
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(t,e,n){if(null!=e&&"bool"===e)throw new Error("Unsupported data type "+e);return jr(t,0,1,e,n)}const Fr=Object(u["b"])({randomStandardNormal_:Dr});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mr(t,e=0,n=1,r="float32",a){const i=Object(pt["a"])(t,r),o=new Nr(e,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}const Pr=Object(u["b"])({randomUniform_:Mr});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $r(t,e,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return i["a"].runKernel(o["pc"],{},a)}var Lr=n("f4ee");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Br(t){const e=Object(s["a"])(t,"x","reciprocal"),n={x:e};return i["a"].runKernel(o["sc"],n)}const zr=Object(u["b"])({reciprocal_:Br});var Wr=n("0ae3"),Vr=n("b0f1"),Ur=n("16d4");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Gr(t){const e=Object(s["a"])(t,"x","reverse");return f["b"](1===e.rank,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Object(Ur["a"])(e,0)}const Hr=Object(u["b"])({reverse1d_:Gr});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(t,e){const n=Object(s["a"])(t,"x","reverse");return f["b"](2===n.rank,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Object(Ur["a"])(n,e)}const Kr=Object(u["b"])({reverse2d_:qr});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xr(t,e){const n=Object(s["a"])(t,"x","reverse");return f["b"](3===n.rank,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Object(Ur["a"])(n,e)}const Yr=Object(u["b"])({reverse3d_:Xr});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jr(t,e){const n=Object(s["a"])(t,"x","reverse");return f["b"](4===n.rank,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Object(Ur["a"])(n,e)}const Zr=Object(u["b"])({reverse4d_:Jr});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qr(t){const e=Object(s["a"])(t,"x","round"),n={x:e};return i["a"].runKernel(o["Cc"],n)}const ta=Object(u["b"])({round_:Qr});var ea=n("a02a");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function na(t){const e=Object(s["a"])(t,"x","selu"),n={x:e};return i["a"].runKernel(o["Hc"],n)}const ra=Object(u["b"])({selu_:na});function aa(t,e,n,r,a,i=[1,1],o="NHWC"){const u=Object(s["a"])(t,"x","separableConv2d"),c=Object(s["a"])(e,"depthwiseFilter","separableConv2d"),l=Object(s["a"])(n,"pointwiseFilter","separableConv2d");let d=u,h=!1;if(3===u.rank&&(h=!0,d=Object($["a"])(u,[1,u.shape[0],u.shape[1],u.shape[2]])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");f["b"](4===d.rank,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),f["b"](4===c.rank,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),f["b"](4===l.rank,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),f["b"](1===l.shape[0],()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),f["b"](1===l.shape[1],()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);const p=c.shape[2],m=c.shape[3];f["b"](l.shape[2]===p*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*m}, but got ${l.shape[2]}.`);const g=Xt(d,c,r,a,o,i),b=1,y=Object(Nt["a"])(g,l,b,"valid",o);return h?Object($["a"])(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const ia=Object(u["b"])({separableConv2d_:aa});
/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function oa(t,e){const n=Object(s["a"])(t,"x","setdiff1d"),r=Object(s["a"])(e,"y","setdiff1d");f["b"](n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),f["b"](1===n.rank,()=>`x should be 1D tensor, but got x (${n.shape}).`),f["b"](1===r.rank,()=>`y should be 1D tensor, but got y (${r.shape}).`);const a=await n.data(),i=await r.data(),o=new Set(i);let u=0;for(let s=0;s<a.length;s++)o.has(a[s])||u++;const c=new Fn["b"]([u],n.dtype),l=new Fn["b"]([u],"int32");for(let s=0,d=0;s<a.length;s++)o.has(a[s])||(c.values[d]=a[s],l.values[d]=s,d++);return[c.toTensor(),l.toTensor()]}const sa=oa;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ua(t){const e=Object(s["a"])(t,"x","sign"),n={x:e};return i["a"].runKernel(o["Jc"],n)}const ca=Object(u["b"])({sign_:ua});var la=n("8820"),da=n("d7b7");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ha(t,e,n){const r=Object(s["a"])(t,"x","slice1d");return f["b"](1===r.rank,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Object(q["a"])(r,[e],[n])}const pa=Object(u["b"])({slice1d_:ha});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fa(t,e,n){const r=Object(s["a"])(t,"x","slice2d");return f["b"](2===r.rank,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Object(q["a"])(r,e,n)}const ma=Object(u["b"])({slice2d_:fa});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(t,e,n){const r=Object(s["a"])(t,"x","slice3d");return f["b"](3===r.rank,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Object(q["a"])(r,e,n)}const ba=Object(u["b"])({slice3d_:ga});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(t,e,n){const r=Object(s["a"])(t,"x","slice4d");return f["b"](4===r.rank,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Object(q["a"])(r,e,n)}const va=Object(u["b"])({slice4d_:ya});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(t,e=-1){const n=Object(s["a"])(t,"logits","softmax","float32");if(-1===e&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},a={dim:e};return i["a"].runKernel(o["Nc"],r,a)}const wa=Object(u["b"])({softmax_:xa});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ka(t){Object(f["b"])("complex64"===t.dtype,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return i["a"].runKernel(o["fb"],e)}const Sa=Object(u["b"])({fft_:ka});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(t){Object(f["b"])("complex64"===t.dtype,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return i["a"].runKernel(o["sb"],e)}const _a=Object(u["b"])({ifft_:Oa});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=Object($["a"])(t,[n,e]);r=_a(a)}else{const a=[n,2*(e-1)],i=Object($["a"])(Object(Lr["a"])(t),[n,e]),o=Object($["a"])(Object(Be["a"])(t),[n,e]),s=Object(Ur["a"])(Object(q["a"])(i,[0,1],[n,e-2]),1),u=Object(G["a"])(Object(Ur["a"])(Object(q["a"])(o,[0,1],[n,e-2]),1),Object(ve["a"])(-1)),c=Object(V["a"])([i,s],1),l=Object(V["a"])([o,u],1),d=Object($["a"])(Object(xt["a"])(c,l),[a[0],a[1]]);r=_a(d)}if(r=Object(Lr["a"])(r),3===t.rank&&0!==t.shape[0]){const e=r,n=t.shape[0];r=Object($["a"])(r,[n,r.shape[0]/n,r.shape[1]]),e.dispose()}return r}const Ta=Object(u["b"])({irfft_:Ca});var Ia=n("8453"),Na=n("c879");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ea(t,e){Object(f["b"])("float32"===t.dtype,()=>"The dtype for rfft() must be real value but got "+t.dtype);let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(null!=e&&e<n){const r=t.shape.map(t=>0),i=t.shape.map(t=>t);i[t.shape.length-1]=e,a=Object(q["a"])(t,r,i),n=e}else if(null!=e&&e>n){const r=t.shape.map(t=>t);r[t.shape.length-1]=e-n,a=Object(V["a"])([t,Object(Na["a"])(r)],t.shape.length-1),n=e}else a=t;const i=Object(re["a"])(a),o=Object($["a"])(Object(xt["a"])(a,i),[r,n]),s=Sa(o),u=Math.floor(n/2)+1,c=Object(Lr["a"])(s),l=Object(Be["a"])(s),d=Object(Ia["a"])(c,[u,n-u],c.shape.length-1),h=Object(Ia["a"])(l,[u,n-u],l.shape.length-1),p=a.shape.slice();return p[a.shape.length-1]=u,Object($["a"])(Object(xt["a"])(d[0],h[0]),p)}const Aa=Object(u["b"])({rfft_:Ea});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t,e){let n=Object(s["a"])(t,"a","squaredDifference"),r=Object(s["a"])(e,"b","squaredDifference");[n,r]=Object(A["makeTypesMatch"])(n,r),Object(gn["assertAndGetBroadcastShape"])(n.shape,r.shape);const a={a:n,b:r},u={};return i["a"].runKernel(o["Yc"],a,u)}const ja=Object(u["b"])({squaredDifference_:Ra});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Da(t,e){const n=Object(s["a"])(t,"x","squeeze","string_or_numeric");return Object($["a"])(n,Object(f["Q"])(n.shape,e).newShape)}const Fa=Object(u["b"])({squeeze_:Da});var Ma=n("3e50"),Pa=n("aeae");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function $a(t,e,n,r,a=0,u=0,c=0,l=0,d=0){const h=Object(s["a"])(t,"x","stridedSlice","string_or_numeric"),p={x:h},f={begin:e,end:n,strides:r,beginMask:a,endMask:u,ellipsisMask:c,newAxisMask:l,shrinkAxisMask:d};return i["a"].runKernel(o["ad"],p,f)}const La=Object(u["b"])({stridedSlice_:$a});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ba(t){const e=Object(s["a"])(t,"x","tan","float32"),n={x:e};return i["a"].runKernel(o["gd"],n)}const za=Object(u["b"])({tan_:Ba});var Wa=n("bd82"),Va=n("e136");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ua(t,e){Object(f["d"])(t);const n=Object(s["c"])(t,e);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");const r=null;return Object(Va["a"])(t,r,n,e)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ga(t,e,n){if(Object(f["d"])(t),null!=e&&2!==e.length)throw new Error("tensor2d() requires shape to have two numbers");const r=Object(s["c"])(t,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(Va["a"])(t,e,r,n)}var Ha=n("381a");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qa(t,e,n){if(Object(f["d"])(t),null!=e&&4!==e.length)throw new Error("tensor4d() requires shape to have four numbers");const r=Object(s["c"])(t,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Object(Va["a"])(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ka(t,e,n){if(Object(f["d"])(t),null!=e&&5!==e.length)throw new Error("tensor5d() requires shape to have five numbers");const r=Object(s["c"])(t,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Object(Va["a"])(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(t,e,n){if(Object(f["d"])(t),null!=e&&6!==e.length)throw new Error("tensor6d() requires shape to have six numbers");const r=Object(s["c"])(t,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==e)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Object(Va["a"])(t,e,r,n)}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ya(t,e=1,n=!0){const r=Object(s["a"])(t,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error("'k' passed to topk() must be >= 0 but got "+e);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got `+e);const u={x:r},c={k:e,sorted:n},[l,d]=i["a"].runKernel(o["jd"],u,c);return{values:l,indices:d}}const Ja=Object(u["b"])({topk_:Ya});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Za(t,e=0,n=1,r,a){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const i=new Tr(e,n,r,!0,a),o=Object(pt["a"])(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const Qa=Object(u["b"])({truncatedNormal_:Za});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ti(t,e=0){const n=Object(s["a"])(t,"x","unique","string_or_numeric");Object(f["b"])(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[u,c]=i["a"].runKernel(o["md"],r,a);return{values:u,indices:c}}const ei=Object(u["b"])({unique_:ti});var ni=n("f388"),ri=n("7eec");
/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function ai(t,e){return Sn(t,e,"right")}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ii(t,e=!0,n,r){return i["a"].makeVariable(t,e,n,r)}var oi=n("afd2");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function si(t){const e=Object(s["a"])(t,"condition","whereAsync","bool"),n=await e.data(),r=Object(oi["a"])(e.shape,n);return t!==e&&e.dispose(),r}const ui=si;
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function ci(t,e,n){const r=Object(s["a"])(t,"tensor","boolMask"),a=Object(s["a"])(e,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,u=r.shape;f["b"](o>0,()=>"mask cannot be scalar"),f["e"](u.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let s=i;s<i+o;s++)c*=u[s];const l=u.slice(0,i).concat([c],u.slice(i+o)),d=Object($["a"])(r,l),h=Object($["a"])(a,[-1]),p=await ui(h),m=Fa(p,[1]),g=Object(Pe["a"])(d,m,i);return t!==r&&r.dispose(),e!==a&&a.dispose(),m.dispose(),d.dispose(),h.dispose(),p.dispose(),g}const li=ci;var di=n("6cff");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hi(t,e,n,r,a=!0){const i=Object(s["a"])(t,"v","movingAverage"),o=Object(s["a"])(e,"x","movingAverage"),u=Object(s["a"])(n,"decay","movingAverage");Object(A["assertTypesMatch"])(i,o),f["b"](f["a"](i.shape,o.shape),()=>"Shape mismatch in v and x");const c=Object(ve["a"])(1),l=Object(cn["a"])(c,u);let d=Object(G["a"])(Object(cn["a"])(o,i),l);if(a){f["b"](null!=r,()=>"When using zeroDebias: true, step is required.");const t=Object(s["a"])(r,"step","movingAverage");d=Object(te["a"])(d,Object(cn["a"])(c,Object(ye["a"])(u,t)))}return Object(p["a"])(i,d)}const pi=Object(u["b"])({movingAverage_:hi});var fi=n("97b1");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mi(t,e,n){const r=Object(s["a"])(t,"indices","scatterND","int32"),a=Object(s["a"])(e,"updates","scatterND");fi["validateInput"](a,r,n);const u={indices:r,updates:a},c={shape:n};return i["a"].runKernel(o["Ec"],u,c)}const gi=Object(u["b"])({scatterND_:mi});function bi(t,e,n,r){if("int32"!==t.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(0!==e.rank&&(1!==e.rank||o!==a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yi(t,e,n,r=0){const a=Object(s["a"])(t,"sparseIndices","sparseToDense","int32"),u=Object(s["a"])(e,"sparseValues","sparseToDense","string_or_numeric"),c=Object(s["a"])(r,"defaultValue","sparseToDense",u.dtype);bi(a,u,n,c);const l={sparseIndices:a,sparseValues:u,defaultValue:c},d={outputShape:n};return i["a"].runKernel(o["Uc"],l,d)}const vi=Object(u["b"])({sparseToDense_:yi});
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xi(t,e){const n=Object(s["a"])(e,"indices","gatherND","int32"),r=Object(s["a"])(t,"x","gatherND","string_or_numeric"),a={params:r,indices:n};return i["a"].runKernel(o["ob"],a)}const wi=Object(u["b"])({gatherND_:xi});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ki(t,e){if(null==e)return t.shape.slice();if(f["a"](t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)null==e[r]&&null!=t.shape[r]?n.push(t.shape[r]):n.push(e[r]);return n}return e}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(t,e,n,r){const a=Object(s["a"])(t,"x","dropout");if(f["b"]("float32"===a.dtype,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),f["b"](e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),0===e)return t instanceof Fn["a"]?a.clone():a;const i=ki(a,n),o=1-e,u=Object(te["a"])(Object(Fe["a"])(Object(p["a"])(Pr(i,0,1,"float32",r),o)),o);return Object(G["a"])(a,u)}const Oi=Object(u["b"])({dropout_:Si});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Ci(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return Ua(a,"float32")}
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ti(t,e,n=1){const r=Object(s["a"])(t,"predictions","inTopK"),a=Object(s["a"])(e,"targets","inTopK");Object(f["b"])(r.rank>1,()=>"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank),Object(f["b"])(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),Object(f["e"])(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];Object(f["b"])(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),u=await a.data(),[c,l]=[o.length/i,i],d=Object(f["o"])("bool",c);for(let s=0;s<c;s++){const t=s*l,e=o.subarray(t,t+l),r=[];for(let n=0;n<e.length;n++)r.push({value:e[n],index:n});r.sort((t,e)=>e.value-t.value),d[s]=0;for(let a=0;a<n;a++)if(r[a].index===u[s]){d[s]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),Object(Wa["a"])(d,a.shape,"bool")}const Ii=Ti;var Ni=n("322b"),Ei=n("641f");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Ai({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:u=[1,1],dimRoundingMode:c,bias:l,activation:d="linear",preluActivationWeights:h,leakyreluAlpha:m}){if(d=d||"linear",!1===Object(Ei["d"])(i["a"].state.gradientDepth,d)){f["b"]("NHWC"===a,()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let i=Object(Nt["a"])(t,e,n,r,a,u,c);return null!=l&&(i=Object(p["a"])(i,l)),Object(Ei["a"])(i,d,h,m)}const g=Object(s["a"])(t,"x","conv2d","float32"),b=Object(s["a"])(e,"filter","conv2d","float32");let y=g,v=!1;3===g.rank&&(v=!0,y=Object($["a"])(g,[1,g.shape[0],g.shape[1],g.shape[2]])),f["b"](4===y.rank,()=>"Error in fused conv2d: input must be rank 4, but got rank "+y.rank+"."),f["b"](4===b.rank,()=>"Error in fused conv2d: filter must be rank 4, but got rank "+b.rank+"."),P["a"]("fused conv2d",r,c);const x="NHWC"===a?y.shape[3]:y.shape[1];f["b"](b.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${b.shape[2]}.`),f["b"](P["i"](n,u),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${u}'`);const w=P["b"](y.shape,b.shape,n,u,r,c);let k,S;if(null!=l&&(k=Object(s["a"])(l,"bias","fused conv2d"),[k]=Object(A["makeTypesMatch"])(k,g),"NHWC"===a?gn["assertAndGetBroadcastShape"](w.outShape,k.shape):(f["b"](k.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${k.shape.length}.`),f["b"](0===k.shape.length||k.shape[0]===w.outChannels||1===k.shape[0],()=>`Error in fused conv2d: bias shape (${k.shape}) is not compatible with the number of output channels (${w.outChannels})`))),null!=h){const t=h.shape;if(f["b"](t.length<=1||3===t.length,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${t.length}.`),1===t.length)f["b"](1===t[0]||t[0]===w.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the number of output channels (${w.outChannels}).`);else if(3===t.length)try{gn["assertAndGetBroadcastShape"](t,w.outShape)}catch(T){const e=`Error in fused conv2d: PReLU activation weights (${t}) is not compatible with the output shape of the conv2d (${w.outShape}).`;throw Error(e)}S=Object(s["a"])(h,"prelu weights","fused conv2d")}const O=(t,e)=>{f["b"]("NHWC"===a,()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[i,o,s,c]=e,l=Object(Ei["c"])(t,s,d);f["b"](P["j"](u),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${u}'`);const h=Object(Rt["a"])(o.shape,l,i,n,r),p=Object(Ni["a"])(o,l,i.shape,n,r),m=[h,p];if(null!=c){const t=Object(Ei["b"])(c,l);m.push(t)}return m},_={x:y,filter:b,bias:k,preluActivationWeights:S},C={strides:n,pad:r,dataFormat:a,dilations:u,dimRoundingMode:c,activation:d,leakyreluAlpha:m};if(null==l){const t=Object(nn["a"])((t,e,n)=>{let r=i["a"].runKernel(o["mb"],_,C);return n([e,t,r]),v&&(r=Object($["a"])(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:O}});return t(y,b)}{const t=Object(nn["a"])((t,e,n,r)=>{let a=i["a"].runKernel(o["mb"],_,C);return r([e,t,a,n]),v&&(a=Object($["a"])(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:O}});return t(y,b,k)}}const Ri=Object(u["b"])({fusedConv2d_:Ai});var ji=n("1be3"),Di=n("7aed");
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Fi({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:u=[1,1],dimRoundingMode:c,bias:l,activation:d="linear",preluActivationWeights:h,leakyreluAlpha:m}){if(!1===Object(Ei["d"])(i["a"].state.gradientDepth,d)){let i=Xt(t,e,n,r,a,u,c);return null!=l&&(i=Object(p["a"])(i,l)),Object(Ei["a"])(i,d,h,m)}const g=Object(s["a"])(t,"x","depthwiseConv2d","float32"),b=Object(s["a"])(e,"filter","depthwiseConv2d","float32");let y=g,v=!1;3===g.rank&&(v=!0,y=Object($["a"])(g,[1,g.shape[0],g.shape[1],g.shape[2]])),f["b"](4===y.rank,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),f["b"](4===b.rank,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${b.rank}.`),f["b"](y.shape[3]===b.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${b.shape[2]}.`),null==u&&(u=[1,1]),f["b"](P["i"](n,u),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${u}'`),P["a"]("fused depthwiseConv2d",r,c);const x=P["b"](y.shape,b.shape,n,u,r,c,!0);let w,k;null!=l&&(w=Object(s["a"])(l,"bias","fused conv2d"),[w]=Object(A["makeTypesMatch"])(w,g),gn["assertAndGetBroadcastShape"](x.outShape,w.shape)),null!=h&&(k=Object(s["a"])(h,"prelu weights","fused depthwiseConv2d"));const S=(t,e)=>{f["b"](P["j"](u),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${u}'`);const[a,i,o,s]=e,l=Object(Ei["c"])(t,o,d),h=Object(Di["a"])(i.shape,l,a,n,r,u,c),p=Object(ji["a"])(i,l,a.shape,n,r,u,c);if(null!=s){const t=Object(Ei["b"])(w,l);return[h,p,t]}return[h,p]},O={x:y,filter:b,bias:w,preluActivationWeights:k},_={strides:n,pad:r,dataFormat:a,dilations:u,dimRoundingMode:c,activation:d,leakyreluAlpha:m};if(null==l){const t=Object(nn["a"])((t,e,n)=>{let r=i["a"].runKernel(o["nb"],O,_);return n([e,t,r]),v&&(r=Object($["a"])(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:S}});return t(y,b)}{const t=Object(nn["a"])((t,e,n,r)=>{let a=i["a"].runKernel(o["nb"],O,_);return r([e,t,a,n]),v&&(a=Object($["a"])(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:S}});return t(y,b,w)}}const Mi=Object(u["b"])({fusedDepthwiseConv2d_:Fi});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:a,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l=.2}){if(!1===Object(Ei["d"])(i["a"].state.gradientDepth,u)){let i=Object(U["a"])(t,e,n,r);return null!=a&&(i=Object(p["a"])(i,a)),Object(Ei["a"])(i,u,c,l)}let d=Object(s["a"])(t,"a","fused matMul"),h=Object(s["a"])(e,"b","fused matMul");[d,h]=Object(A["makeTypesMatch"])(d,h);const m=n?d.shape[d.rank-2]:d.shape[d.rank-1],g=r?h.shape[h.rank-1]:h.shape[h.rank-2],b=n?d.shape[d.rank-1]:d.shape[d.rank-2],y=r?h.shape[h.rank-2]:h.shape[h.rank-1],v=d.shape.slice(0,-2),x=h.shape.slice(0,-2),w=f["O"](v),k=f["O"](x);f["b"](m===g,()=>`Error in fused matMul: inner shapes (${m}) and (${g}) of Tensors with shapes ${d.shape} and ${h.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=gn["assertAndGetBroadcastShape"](d.shape.slice(0,-2),h.shape.slice(0,-2)),O=S.concat([b,y]),_=n?Object($["a"])(d,[w,m,b]):Object($["a"])(d,[w,b,m]),C=r?Object($["a"])(h,[k,y,g]):Object($["a"])(h,[k,g,y]);let T,I;null!=a&&(T=Object(s["a"])(a,"bias","fused matMul"),[T]=Object(A["makeTypesMatch"])(T,d),gn["assertAndGetBroadcastShape"](O,T.shape)),null!=c&&(I=Object(s["a"])(c,"prelu weights","fused matMul"));const N=(t,e)=>{const[i,o,s,c]=e,l=Object(Ei["c"])(Object($["a"])(t,s.shape),s,u);let d,h;if(n||r?!n&&r?(d=Object(U["a"])(l,o,!1,!1),h=Object(U["a"])(l,i,!0,!1)):n&&!r?(d=Object(U["a"])(o,l,!1,!0),h=Object(U["a"])(i,l,!1,!1)):(d=Object(U["a"])(o,l,!0,!0),h=Object(U["a"])(l,i,!0,!0)):(d=Object(U["a"])(l,o,!1,!0),h=Object(U["a"])(i,l,!0,!1)),null!=a){const t=Object(Ei["b"])(c,l);return[d,h,t]}return[d,h]},E={a:_,b:C,bias:T,preluActivationWeights:I},R={transposeA:n,transposeB:r,activation:u,leakyreluAlpha:l};if(null==a){const t=Object(nn["a"])((t,e,n)=>{const r=i["a"].runKernel(o["rd"],E,R);return n([t,e,r]),{value:Object($["a"])(r,O),gradFunc:N}});return t(_,C)}{const t=Object(nn["a"])((t,e,n,r)=>{const a=i["a"].runKernel(o["rd"],E,R);return r([t,e,a,n]),{value:Object($["a"])(a,O),gradFunc:N}});return t(_,C,T)}}const $i=Object(u["b"])({fusedMatMul_:Pi});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Li(t){return Ci(t,.54,.46)}const Bi=Object(u["b"])({hammingWindow_:Li});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(t){return Ci(t,.5,.5)}const Wi=Object(u["b"])({hannWindow_:zi});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vi(t,e,n,r=!1,a=0){let i=0;const o=[];while(i+e<=t.size)o.push(Object(q["a"])(t,i,e)),i+=n;if(r)while(i<t.size){const r=i+e-t.size,s=Object(V["a"])([Object(q["a"])(t,i,e-r),Object(gt["a"])([r],a)]);o.push(s),i+=n}return 0===o.length?Ga([],[0,e]):Object($["a"])(Object(V["a"])(o),[o.length,e])}const Ui=Object(u["b"])({frame_:Vi});
/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gi(t,e,n,r,a=Wi){null==r&&(r=_i(e));const i=Ui(t,e,n),o=Object(G["a"])(i,a(e));return Aa(o,r)}const Hi=Object(u["b"])({stft_:Gi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qi(t,e,n,r,a="bilinear",u=0){const c=Object(s["a"])(t,"image","cropAndResize"),l=Object(s["a"])(e,"boxes","cropAndResize","float32"),d=Object(s["a"])(n,"boxInd","cropAndResize","int32"),h=l.shape[0];f["b"](4===c.rank,()=>`Error in cropAndResize: image must be rank 4,but got rank ${c.rank}.`),f["b"](2===l.rank&&4===l.shape[1],()=>`Error in cropAndResize: boxes must be have size [${h},4] but had shape ${l.shape}.`),f["b"](1===d.rank&&d.shape[0]===h,()=>`Error in cropAndResize: boxInd must be have size [${h}] but had shape ${l.shape}.`),f["b"](2===r.length,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),f["b"](r[0]>=1&&r[1]>=1,()=>"cropSize must be atleast [1,1], but was "+r),f["b"]("bilinear"===a||"nearest"===a,()=>"method must be bilinear or nearest, but was "+a);const p={image:c,boxes:l,boxInd:d},m={method:a,extrapolationValue:u,cropSize:r},g=i["a"].runKernel(o["L"],p,m);return g}const Ki=Object(u["b"])({cropAndResize_:qi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xi(t){const e=Object(s["a"])(t,"image","flipLeftRight","float32");f["b"](4===e.rank,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e},r=i["a"].runKernel(o["hb"],n,{});return r}const Yi=Object(u["b"])({flipLeftRight_:Xi});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ji(t){const e=Object(s["a"])(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];f["b"](e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),f["b"](1===r,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,Object(Re["a"])(e,a)}const Zi=Object(u["b"])({grayscaleToRGB_:Ji});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qi(t,e,n=0,r=.5){const a=Object(s["a"])(t,"image","rotateWithOffset","float32");f["b"](4===a.rank,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const u={image:a},c={radians:e,fillValue:n,center:r},l=i["a"].runKernel(o["Bc"],u,c);return l}const to=Object(u["b"])({rotateWithOffset_:Qi});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eo(t,e,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);const o=t.shape[0];return n=Math.min(n,o),f["b"](0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),f["b"](2===t.rank,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),f["b"](4===t.shape[1],()=>"boxes must have 4 columns, but 2nd dimension was "+t.shape[1]),f["b"](1===e.rank,()=>"scores must be a 1D tensor"),f["b"](e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was `+e.shape[0]),f["b"](0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function no(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const u=Object(s["a"])(t,"boxes","nonMaxSuppression","float32"),c=Object(s["a"])(e,"scores","nonMaxSuppression","float32"),l=eo(u,c,n,r,a);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold;const d={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return i["a"].runKernel(o["bc"],{boxes:u,scores:c},d)}const ro=Object(u["b"])({nonMaxSuppression_:no});var ao=n("1194");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function io(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=Object(s["a"])(t,"boxes","nonMaxSuppressionAsync"),o=Object(s["a"])(e,"scores","nonMaxSuppressionAsync"),u=eo(i,o,n,r,a);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold;const c=await Promise.all([i.data(),o.data()]),l=c[0],d=c[1],{selectedIndices:h}=Object(ao["a"])(l,d,n,r,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),Ua(h,"int32")}const oo=io;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function so(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,u=0){const c=Object(s["a"])(t,"boxes","nonMaxSuppression"),l=Object(s["a"])(e,"scores","nonMaxSuppression"),d=eo(c,l,n,r,a,u);n=d.maxOutputSize,r=d.iouThreshold,a=d.scoreThreshold,u=d.softNmsSigma;const h={boxes:c,scores:l},p={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:u},f=i["a"].runKernel(o["dc"],h,p);return{selectedIndices:f[0],selectedScores:f[1]}}const uo=Object(u["b"])({nonMaxSuppressionWithScore_:so});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function co(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=Object(s["a"])(t,"boxes","nonMaxSuppressionAsync"),u=Object(s["a"])(e,"scores","nonMaxSuppressionAsync"),c=eo(o,u,n,r,a,i);n=c.maxOutputSize,r=c.iouThreshold,a=c.scoreThreshold,i=c.softNmsSigma;const l=await Promise.all([o.data(),u.data()]),d=l[0],h=l[1],{selectedIndices:p,selectedScores:f}=Object(ao["c"])(d,h,n,r,a,i);return o!==t&&o.dispose(),u!==e&&u.dispose(),{selectedIndices:Ua(p,"int32"),selectedScores:Ua(f)}}const lo=co;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ho(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,u=!1){const c=Object(s["a"])(t,"boxes","nonMaxSuppression"),l=Object(s["a"])(e,"scores","nonMaxSuppression"),d=eo(c,l,n,r,a,null),h=d.maxOutputSize,p=d.iouThreshold,f=d.scoreThreshold,m={boxes:c,scores:l},g={maxOutputSize:h,iouThreshold:p,scoreThreshold:f,padToMaxOutputSize:u},b=i["a"].runKernel(o["cc"],m,g);return{selectedIndices:b[0],validOutputs:b[1]}}const po=Object(u["b"])({nonMaxSuppressionPadded_:ho});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function fo(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=Object(s["a"])(t,"boxes","nonMaxSuppressionAsync"),u=Object(s["a"])(e,"scores","nonMaxSuppressionAsync"),c=eo(o,u,n,r,a,null),l=c.maxOutputSize,d=c.iouThreshold,h=c.scoreThreshold,[p,f]=await Promise.all([o.data(),u.data()]),{selectedIndices:m,validOutputs:g}=Object(ao["b"])(p,f,l,d,h,i);return o!==t&&o.dispose(),u!==e&&u.dispose(),{selectedIndices:Ua(m,"int32"),validOutputs:Object(ve["a"])(g,"int32")}}const mo=fo;
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function go(t,e,n=!1,r=!1){const a=Object(s["a"])(t,"images","resizeBilinear");f["b"](3===a.rank||4===a.rank,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),f["b"](2===e.length,()=>"Error in resizeBilinear: new shape must 2D, but got shape "+e+"."),f["b"](!1===r||!1===n,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let u=a,c=!1;3===a.rank&&(c=!0,u=Object($["a"])(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,l={images:u},d={alignCorners:n,halfPixelCenters:r,size:e},h=i["a"].runKernel(o["wc"],l,d);return c?Object($["a"])(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const bo=Object(u["b"])({resizeBilinear_:go});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yo(t,e,n=!1,r=!1){const a=Object(s["a"])(t,"images","resizeNearestNeighbor");f["b"](3===a.rank||4===a.rank,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),f["b"](2===e.length,()=>"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+e+"."),f["b"]("float32"===a.dtype||"int32"===a.dtype,()=>"`images` must have `int32` or `float32` as dtype"),f["b"](!1===r||!1===n,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let u=a,c=!1;3===a.rank&&(c=!0,u=Object($["a"])(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const[]=e,l={images:u},d={alignCorners:n,halfPixelCenters:r,size:e},h=i["a"].runKernel(o["yc"],l,d);return c?Object($["a"])(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const vo=Object(u["b"])({resizeNearestNeighbor_:yo});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xo(t,e="binary",n=!1,r=.5){const a=Object(s["a"])(t,"image","threshold"),i=.2989,o=.587,u=.114,c=a.shape[0]*a.shape[1];let l,d,h,m,g=Object(G["a"])(Ua([r]),255);if(f["b"](3===a.rank,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),f["b"](3===a.shape[2]||1===a.shape[2],()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),f["b"]("int32"===a.dtype||"float32"===a.dtype,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),f["b"]("otsu"===e||"binary"===e,()=>"Method must be binary or otsu, but was "+e),3===a.shape[2]){[l,d,h]=Object(Ia["a"])(a,[1,1,1],-1);const t=Object(G["a"])(l,i),e=Object(G["a"])(d,o),n=Object(G["a"])(h,u);m=Object(p["a"])(Object(p["a"])(t,e),n)}else m=t;if("otsu"===e){const t=ct(Object(M["a"])(ta(m),"int32"),Object(Wa["a"])([]),256);g=wo(t,c)}const b=n?Object(Xe["a"])(m,g):Object($e["a"])(m,g),y=Object(M["a"])(Object(G["a"])(b,255),"int32");return y}function wo(t,e){let n,r,a,i,o,s,u=Ua([-1]),c=Ua([0]),l=Ua([0]);for(let d=0;d<t.size-1;d++){n=Object(q["a"])(t,0,d+1),r=Object(q["a"])(t,d+1),o=Object(te["a"])(Object(ke["a"])(n),e),s=Object(te["a"])(Object(ke["a"])(r),e);const h=Object(ke["a"])(Object(G["a"])(n,$r(0,n.size)));a=Object(te["a"])(h,Object(ke["a"])(n));const f=Object(gt["a"])(r.shape,n.size),m=Object(p["a"])($r(0,r.size),f),g=Object(G["a"])(r,m);i=Object(te["a"])(Object(ke["a"])(g),Object(ke["a"])(r));const b=Object(cn["a"])(a,i),y=Object(cn["a"])(a,i),v=Object(G["a"])(o,s);l=Object(G["a"])(Object(G["a"])(v,b),y);const x=Object($e["a"])(l,c);c=Object(ne["a"])(x,l,c),u=Object(ne["a"])(x,Ua([d]),u)}return u}const ko=Object(u["b"])({threshold_:xo});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(t,e,n="nearest",r="constant",a=0,u){const c=Object(s["a"])(t,"image","transform","float32"),l=Object(s["a"])(e,"transforms","transform","float32");f["b"](4===c.rank,()=>`Error in transform: image must be rank 4,but got rank ${c.rank}.`),f["b"](2===l.rank&&(l.shape[0]===c.shape[0]||1===l.shape[0])&&8===l.shape[1],()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),f["b"](null==u||2===u.length,()=>`Error in transform: outputShape must be [height, width] or null, but got ${u}.`);const d={image:c,transforms:l},h={interpolation:n,fillMode:r,fillValue:a,outputShape:u};return i["a"].runKernel(o["kd"],d,h)}const Oo=Object(u["b"])({transform_:So});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _o(t,e,n){Object(f["b"])(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Object(f["b"])(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=Object(s["a"])(t,"a","bandPart");Object(f["b"])(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[i,o]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=i),n<0&&(n=o);const u=Object($["a"])($r(0,i,1,"int32"),[-1,1]),c=$r(0,o,1,"int32"),l=Object(cn["a"])(u,c),d=Object(fn["a"])(Object(Xe["a"])(l,Object(ve["a"])(+e,"int32")),Object(Le["a"])(l,Object(ve["a"])(-n,"int32"))),h=Object(Na["a"])([i,o],r.dtype);return Object($["a"])(Object(Ma["a"])(Object(ri["a"])(Object($["a"])(r,[-1,i,o])).map(t=>Object(ne["a"])(d,t,h))),a)}const Co=Object(u["b"])({bandPart_:_o});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function To(t){let e;if(Array.isArray(t)){e=!1,Object(f["b"])(null!=t&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const n=t[0].shape[0];for(let e=1;e<t.length;++e)Object(f["b"])(t[e].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[e].shape[0]} vs. ${n})`)}else e=!0,t=Object(Ia["a"])(t,t.shape[0],0).map(t=>Fa(t,[0]));Object(f["b"])(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let a=0;a<t.length;++a)n.push(i["a"].tidy(()=>{let t=r[a];if(a>0)for(let e=0;e<a;++e){const r=Object(G["a"])(Object(ke["a"])(Object(G["a"])(n[e],t)),n[e]);t=Object(cn["a"])(t,r)}return Object(te["a"])(t,_e(t,"euclidean"))}));return e?Object(Ma["a"])(n,0):n}const Io=Object(u["b"])({gramSchmidt_:To});var No=n("fd3e");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eo(t,e=!1){if(Object(f["b"])(t.rank>=2,()=>"qr() requires input tensor to have a rank >= 2, but got rank "+t.rank),2===t.rank)return Ao(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((t,e)=>t*e),r=Object(ri["a"])(Object($["a"])(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach(t=>{const[n,r]=Ao(t,e);a.push(n),i.push(r)});const o=Object($["a"])(Object(Ma["a"])(a,0),t.shape),s=Object($["a"])(Object(Ma["a"])(i,0),t.shape);return[o,s]}}function Ao(t,e=!1){return i["a"].tidy(()=>{Object(f["b"])(2===t.shape.length,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let a=De(n),o=Object(vt["a"])(t);const s=Ga([[1]],[1,1]);let u=Object(vt["a"])(s);const c=n>=r?r:n;for(let t=0;t<c;++t){const e=o,c=u,l=a;[u,o,a]=i["a"].tidy(()=>{const e=Object(q["a"])(o,[t,t],[n-t,1]),i=_e(e),c=Object(q["a"])(o,[t,t],[1,1]),l=Object(ne["a"])(Object($e["a"])(c,0),Ga([[-1]]),Ga([[1]])),d=Object(cn["a"])(c,Object(G["a"])(l,i)),h=Object(te["a"])(e,d);u=1===h.shape[0]?Object(vt["a"])(s):Object(V["a"])([s,Object(q["a"])(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=Object(rn["a"])(Object(te["a"])(Object(U["a"])(l,d),i)),f=Object(q["a"])(o,[t,0],[n-t,r]),m=Object(G["a"])(p,u),g=Object(di["a"])(u);if(0===t)o=Object(cn["a"])(f,Object(U["a"])(m,Object(U["a"])(g,f)));else{const e=Object(cn["a"])(f,Object(U["a"])(m,Object(U["a"])(g,f)));o=Object(V["a"])([Object(q["a"])(o,[0,0],[t,r]),e],0)}const b=Object(di["a"])(m),y=Object(q["a"])(a,[0,t],[n,a.shape[1]-t]);if(0===t)a=Object(cn["a"])(y,Object(U["a"])(Object(U["a"])(y,u),b));else{const e=Object(cn["a"])(y,Object(U["a"])(Object(U["a"])(y,u),b));a=Object(V["a"])([Object(q["a"])(a,[0,0],[n,t]),e],1)}return[u,o,a]}),Object(No["d"])([e,c,l])}return!e&&n>r&&(a=Object(q["a"])(a,[0,0],[n,r]),o=Object(q["a"])(o,[0,0],[r,r])),[a,o]})}const Ro=Object(u["b"])({qr_:Eo});var jo=n("64db");function Do(t,e,n=jo["a"].SUM_BY_NONZERO_WEIGHTS){const r=Object(s["a"])(t,"losses","computeWeightedLoss");let a=null;null!=e&&(a=Object(s["a"])(e,"weights","computeWeightedLoss"));const i=null==a?r:Object(G["a"])(r,a);if(n===jo["a"].NONE)return i;if(n===jo["a"].SUM)return Object(ke["a"])(i);if(n===jo["a"].MEAN){if(null==a)return jn(i);{const t=r.size/a.size,e=Object(te["a"])(Object(ke["a"])(i),Object(ke["a"])(a));return t>1?Object(te["a"])(e,Object(ve["a"])(t)):e}}if(n===jo["a"].SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(te["a"])(Object(ke["a"])(i),Object(ve["a"])(r.size));{const t=Object(G["a"])(a,Object(Dn["a"])(r.shape)),e=Object(M["a"])(Object(ke["a"])(Yn(t,Object(ve["a"])(0))),"float32");return Object(te["a"])(Object(ke["a"])(i),e)}}throw Error("Unknown reduction: "+n)}const Fo=Object(u["b"])({computeWeightedLoss_:Do});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(t,e,n,r=jo["a"].SUM_BY_NONZERO_WEIGHTS){const i=Object(s["a"])(t,"labels","absoluteDifference"),o=Object(s["a"])(e,"predictions","absoluteDifference");let u=null;null!=n&&(u=Object(s["a"])(n,"weights","absoluteDifference")),Object(f["e"])(i.shape,o.shape,"Error in absoluteDifference: ");const c=Object(a["a"])(Object(cn["a"])(i,o));return Fo(c,u,r)}const Po=Object(u["b"])({absoluteDifference_:Mo});function $o(t,e,n,r,a=jo["a"].SUM_BY_NONZERO_WEIGHTS){const i=Object(s["a"])(t,"labels","cosineDistance"),o=Object(s["a"])(e,"predictions","cosineDistance");let u=null;null!=r&&(u=Object(s["a"])(r,"weights","cosineDistance")),Object(f["e"])(i.shape,o.shape,"Error in cosineDistance: ");const c=Object(ve["a"])(1),l=Object(cn["a"])(c,Object(ke["a"])(Object(G["a"])(i,o),n,!0));return Fo(l,u,a)}const Lo=Object(u["b"])({cosineDistance_:$o});function Bo(t,e,n,r=jo["a"].SUM_BY_NONZERO_WEIGHTS){let a=Object(s["a"])(t,"labels","hingeLoss");const i=Object(s["a"])(e,"predictions","hingeLoss");let o=null;null!=n&&(o=Object(s["a"])(n,"weights","hingeLoss")),Object(f["e"])(a.shape,i.shape,"Error in hingeLoss: ");const u=Object(ve["a"])(1);a=Object(cn["a"])(Object(G["a"])(Object(ve["a"])(2),a),u);const c=Object(Wr["a"])(Object(cn["a"])(u,Object(G["a"])(a,i)));return Fo(c,o,r)}const zo=Object(u["b"])({hingeLoss_:Bo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wo(t,e,n,r=1,i=jo["a"].SUM_BY_NONZERO_WEIGHTS){const o=Object(s["a"])(t,"labels","huberLoss"),u=Object(s["a"])(e,"predictions","huberLoss");let c=null;null!=n&&(c=Object(s["a"])(n,"weights","huberLoss")),Object(f["e"])(o.shape,u.shape,"Error in huberLoss: ");const l=Object(ve["a"])(r),d=Object(a["a"])(Object(cn["a"])(u,o)),h=$n(d,l),m=Object(cn["a"])(d,h),g=Object(p["a"])(Object(G["a"])(Object(ve["a"])(.5),Object(we["a"])(h)),Object(G["a"])(l,m));return Fo(g,c,i)}const Vo=Object(u["b"])({huberLoss_:Wo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(t,e,n,r=1e-7,a=jo["a"].SUM_BY_NONZERO_WEIGHTS){const i=Object(s["a"])(t,"labels","logLoss"),o=Object(s["a"])(e,"predictions","logLoss");let u=null;null!=n&&(u=Object(s["a"])(n,"weights","logLoss")),Object(f["e"])(i.shape,o.shape,"Error in logLoss: ");const c=Object(ve["a"])(1),l=Object(ve["a"])(r),d=Object(rn["a"])(Object(G["a"])(i,Object(Qe["a"])(Object(p["a"])(o,l)))),h=Object(G["a"])(Object(cn["a"])(c,i),Object(Qe["a"])(Object(p["a"])(Object(cn["a"])(c,o),l))),m=Object(cn["a"])(d,h);return Fo(m,u,a)}const Go=Object(u["b"])({logLoss_:Uo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ho(t,e,n,r=jo["a"].SUM_BY_NONZERO_WEIGHTS){const a=Object(s["a"])(t,"labels","meanSquaredError"),i=Object(s["a"])(e,"predictions","meanSquaredError");let o=null;null!=n&&(o=Object(s["a"])(n,"weights","meanSquaredError")),Object(f["e"])(a.shape,i.shape,"Error in meanSquaredError: ");const u=ja(a,i);return Fo(u,o,r)}const qo=Object(u["b"])({meanSquaredError_:Ho});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ko(t,e){const n=Object(s["a"])(t,"labels","sigmoidCrossEntropyWithLogits"),r=Object(s["a"])(e,"logits","sigmoidCrossEntropyWithLogits");Object(f["e"])(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=Object(Wr["a"])(r),o=Object(G["a"])(r,n),u=en(Object(Ie["a"])(Object(rn["a"])(Object(a["a"])(r))));return Object(p["a"])(Object(cn["a"])(i,o),u)}function Xo(t,e,n,r=0,a=jo["a"].SUM_BY_NONZERO_WEIGHTS){let i=Object(s["a"])(t,"multiClassLabels","sigmoidCrossEntropy");const o=Object(s["a"])(e,"logits","sigmoidCrossEntropy");let u=null;if(null!=n&&(u=Object(s["a"])(n,"weights","sigmoidCrossEntropy")),Object(f["e"])(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const t=Object(ve["a"])(r),e=Object(ve["a"])(1),n=Object(ve["a"])(.5);i=Object(p["a"])(Object(G["a"])(i,Object(cn["a"])(e,t)),Object(G["a"])(n,t))}const c=Ko(i,o);return Fo(c,u,a)}const Yo=Object(u["b"])({sigmoidCrossEntropy_:Xo});
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jo(t,e,n=-1){if(-1===n&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was `+n);const r=Object(nn["a"])((t,e,r)=>{const a=!0,i=pn(e,[n],a),o=Object(cn["a"])(Object(M["a"])(e,"float32"),i);r([t,o]);const s=Object(rn["a"])(Object(G["a"])(o,t)),u=Object(ke["a"])(s,[n]),c=(t,e)=>{const[r,a]=e,i=Object(pe["e"])(t.shape,[n]);return[Object(G["a"])(Object($["a"])(t,i),Object(cn["a"])(Object(M["a"])(r,"float32"),Object(Ie["a"])(a))),Object(G["a"])(Object($["a"])(t,i),Object(cn["a"])(Object(Ie["a"])(a),Object(M["a"])(r,"float32")))]};return{value:u,gradFunc:c}});return r(t,e)}function Zo(t,e,n,r=0,a=jo["a"].SUM_BY_NONZERO_WEIGHTS){let i=Object(s["a"])(t,"onehotLabels","softmaxCrossEntropy");const o=Object(s["a"])(e,"logits","softmaxCrossEntropy");let u=null;if(null!=n&&(u=Object(s["a"])(n,"weights","softmaxCrossEntropy")),Object(f["e"])(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const t=Object(ve["a"])(r),e=Object(ve["a"])(1),n=Object(ve["a"])(i.shape[1]);i=Object(p["a"])(Object(G["a"])(i,Object(cn["a"])(e,t)),Object(te["a"])(t,n))}const c=Jo(i,o);return Fo(c,u,a)}const Qo=Object(u["b"])({softmaxCrossEntropy_:Zo});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ts(t,e,n,r){const a=Object(s["a"])(t,"indices","sparseFillEmptyRows","int32"),u=Object(s["a"])(e,"values","sparseFillEmptyRows"),c=Object(s["a"])(n,"denseShape","sparseFillEmptyRows","int32"),l=Object(s["a"])(r,"defaultValue","sparseFillEmptyRows",u.dtype);if(2!==a.rank)throw new Error("Indices should be Tensor2D but received shape\n        "+a.shape);if(1!==u.rank)throw new Error("Values should be Tensor1D but received shape "+u.shape);if(1!==c.rank)throw new Error("Dense shape should be Tensor1D but received shape "+c.shape);if(0!==l.rank)throw new Error("Default value should be a scalar but received shape "+l.shape);const d={indices:a,values:u,denseShape:c,defaultValue:l},h=i["a"].runKernel(o["Qc"],d);return{outputIndices:h[0],outputValues:h[1],emptyRowIndicator:h[2],reverseIndexMap:h[3]}}const es=Object(u["b"])({sparseFillEmptyRows_:ts});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ns(t,e,n){const r=Object(s["a"])(t,"inputIndices","sparseReshape","int32"),a=Object(s["a"])(e,"inputShape","sparseReshape","int32"),u=Object(s["a"])(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error("Input indices should be Tensor2D but received shape\n        "+r.shape);if(1!==a.rank)throw new Error("Input shape should be Tensor1D but received shape "+a.shape);if(1!==u.rank)throw new Error("New shape should be Tensor1D but received shape "+u.shape);const c={inputIndices:r,inputShape:a,newShape:u},l=i["a"].runKernel(o["Rc"],c);return{outputIndices:l[0],outputShape:l[1]}}const rs=Object(u["b"])({sparseReshape_:ns});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function as(t,e,n){const r=Object(s["a"])(t,"data","sparseSegmentMean"),a=Object(s["a"])(e,"indices","sparseSegmentMean","int32"),u=Object(s["a"])(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n          "+a.shape);if(1!==u.rank)throw new Error("Segment ids should be Tensor1D but received shape\n          "+u.shape);const c={data:r,indices:a,segmentIds:u};return i["a"].runKernel(o["Sc"],c)}const is=Object(u["b"])({sparseSegmentMean_:as});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function os(t,e,n){const r=Object(s["a"])(t,"data","sparseSegmentSum"),a=Object(s["a"])(e,"indices","sparseSegmentSum","int32"),u=Object(s["a"])(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==a.rank)throw new Error("Indices should be Tensor1D but received shape\n         "+a.shape);if(1!==u.rank)throw new Error("Segment ids should be Tensor1D but received shape\n         "+u.shape);const c={data:r,indices:a,segmentIds:u};return i["a"].runKernel(o["Tc"],c)}const ss=Object(u["b"])({sparseSegmentSum_:os});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function us(t,e,n,r,a,u,c,l){const d=Object(s["a"])(t,"data","stringNGrams","string");if("string"!==d.dtype)throw new Error("Data must be of datatype string");if(1!==d.shape.length)throw new Error("Data must be a vector, saw: "+d.shape);const h=Object(s["a"])(e,"dataSplits","stringNGrams");if("int32"!==h.dtype)throw new Error("Data splits must be of datatype int32");const p={separator:n,nGramWidths:r,leftPad:a,rightPad:u,padWidth:c,preserveShortSequences:l},f={data:d,dataSplits:h},m=i["a"].runKernel(o["bd"],f,p);return{nGrams:m[0],nGramsSplits:m[1]}}const cs=Object(u["b"])({stringNGrams_:us});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ls(t,e,n=!0){const r=Object(s["a"])(t,"input","stringSplit","string"),a=Object(s["a"])(e,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error("Input should be Tensor1D but received shape "+r.shape);if(0!==a.rank)throw new Error("Delimiter should be a scalar but received shape "+a.shape);const u={skipEmpty:n},c={input:r,delimiter:a},l=i["a"].runKernel(o["cd"],c,u);return{indices:l[0],values:l[1],shape:l[2]}}const ds=Object(u["b"])({stringSplit_:ls});
/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hs(t,e){const n=Object(s["a"])(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return i["a"].runKernel(o["dd"],a,r)}const ps=Object(u["b"])({stringToHashBucketFast_:hs}),fs={fft:Sa,ifft:_a,rfft:Aa,irfft:Ta},ms={hammingWindow:Bi,hannWindow:Wi,frame:Ui,stft:Hi},gs={flipLeftRight:Yi,grayscaleToRGB:Zi,resizeNearestNeighbor:vo,resizeBilinear:bo,rotateWithOffset:to,cropAndResize:Ki,nonMaxSuppression:ro,nonMaxSuppressionAsync:oo,nonMaxSuppressionWithScore:uo,nonMaxSuppressionWithScoreAsync:lo,nonMaxSuppressionPadded:po,nonMaxSuppressionPaddedAsync:mo,threshold:ko,transform:Oo},bs={bandPart:Co,gramSchmidt:Io,qr:Ro},ys={absoluteDifference:Po,computeWeightedLoss:Fo,cosineDistance:Lo,hingeLoss:zo,huberLoss:Vo,logLoss:Go,meanSquaredError:qo,sigmoidCrossEntropy:Yo,softmaxCrossEntropy:Qo},vs={sparseFillEmptyRows:es,sparseReshape:rs,sparseSegmentMean:is,sparseSegmentSum:ss},xs={stringNGrams:cs,stringSplit:ds,stringToHashBucketFast:ps};
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */},f59f:function(t,e,n){"use strict";n("b76e")},f608:function(t,e,n){var r=n("6747"),a=n("ffd6"),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;function s(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!a(t))||(o.test(t)||!i.test(t)||null!=e&&t in Object(e))}t.exports=s},f655:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.HitCanvas=e.SceneCanvas=e.Canvas=void 0;var a,i=n("9cb8"),o=n("c527"),s=n("d777"),u=n("f0b4"),c=n("4546");function l(){if(a)return a;var t=i.Util.createCanvasElement(),e=t.getContext("2d");return a=function(){var t=s.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return t/n}(),a}var d=function(){function t(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},n=e.pixelRatio||s.Konva.pixelRatio||l();this.pixelRatio=n,this._canvas=i.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}return t.prototype.getContext=function(){return this.context},t.prototype.getPixelRatio=function(){return this.pixelRatio},t.prototype.setPixelRatio=function(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)},t.prototype.setWidth=function(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)},t.prototype.setHeight=function(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.setSize=function(t,e){this.setWidth(t||0),this.setHeight(e||0)},t.prototype.toDataURL=function(t,e){try{return this._canvas.toDataURL(t,e)}catch(n){try{return this._canvas.toDataURL()}catch(r){return i.Util.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}},t}();e.Canvas=d,u.Factory.addGetterSetter(d,"pixelRatio",void 0,c.getNumberValidator());var h=function(t){function e(e){void 0===e&&(e={width:0,height:0});var n=t.call(this,e)||this;return n.context=new o.SceneContext(n),n.setSize(e.width,e.height),n}return r(e,t),e}(d);e.SceneCanvas=h;var p=function(t){function e(e){void 0===e&&(e={width:0,height:0});var n=t.call(this,e)||this;return n.hitCanvas=!0,n.context=new o.HitContext(n),n.setSize(e.width,e.height),n}return r(e,t),e}(d);e.HitCanvas=p},f709:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),a=0;for(e=0;e<n;e++)for(var i=arguments[e],o=0,s=i.length;o<s;o++,a++)r[a]=i[o];return r};Object.defineProperty(e,"__esModule",{value:!0}),e.Line=void 0;var i=n("9cb8"),o=n("f0b4"),s=n("fce6"),u=n("4546"),c=n("d777"),l=function(t){function e(e){var n=t.call(this,e)||this;return n.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",(function(){this._clearCache("tensionPoints")})),n}return r(e,t),e.prototype._sceneFunc=function(t){var e,n,r,a=this.points(),i=a.length,o=this.tension(),s=this.closed(),u=this.bezier();if(i){if(t.beginPath(),t.moveTo(a[0],a[1]),0!==o&&i>4){e=this.getTensionPoints(),n=e.length,r=s?0:4,s||t.quadraticCurveTo(e[0],e[1],e[2],e[3]);while(r<n-2)t.bezierCurveTo(e[r++],e[r++],e[r++],e[r++],e[r++],e[r++]);s||t.quadraticCurveTo(e[n-2],e[n-1],a[i-2],a[i-1])}else if(u){r=2;while(r<i)t.bezierCurveTo(a[r++],a[r++],a[r++],a[r++],a[r++],a[r++])}else for(r=2;r<i;r+=2)t.lineTo(a[r],a[r+1]);s?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}},e.prototype.getTensionPoints=function(){return this._getCache("tensionPoints",this._getTensionPoints)},e.prototype._getTensionPoints=function(){return this.closed()?this._getTensionPointsClosed():i.Util._expandPoints(this.points(),this.tension())},e.prototype._getTensionPointsClosed=function(){var t=this.points(),e=t.length,n=this.tension(),r=i.Util._getControlPoints(t[e-2],t[e-1],t[0],t[1],t[2],t[3],n),a=i.Util._getControlPoints(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],n),o=i.Util._expandPoints(t,n),s=[r[2],r[3]].concat(o).concat([a[0],a[1],t[e-2],t[e-1],a[2],a[3],r[0],r[1],t[0],t[1]]);return s},e.prototype.getWidth=function(){return this.getSelfRect().width},e.prototype.getHeight=function(){return this.getSelfRect().height},e.prototype.getSelfRect=function(){var t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};t=0!==this.tension()?a([t[0],t[1]],this._getTensionPoints(),[t[t.length-2],t[t.length-1]]):this.points();for(var e,n,r=t[0],i=t[0],o=t[1],s=t[1],u=0;u<t.length/2;u++)e=t[2*u],n=t[2*u+1],r=Math.min(r,e),i=Math.max(i,e),o=Math.min(o,n),s=Math.max(s,n);return{x:r,y:o,width:i-r,height:s-o}},e}(s.Shape);e.Line=l,l.prototype.className="Line",l.prototype._attrsAffectingSize=["points","bezier","tension"],c._registerNode(l),o.Factory.addGetterSetter(l,"closed",!1),o.Factory.addGetterSetter(l,"bezier",!1),o.Factory.addGetterSetter(l,"tension",0,u.getNumberValidator()),o.Factory.addGetterSetter(l,"points",[],u.getNumberArrayValidator()),i.Collection.mapMethods(l)},f7b7:function(t,e){},f88f:function(t,e){},f8af:function(t,e,n){var r=n("2474");function a(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}t.exports=a},f909:function(t,e,n){var r=n("7e64"),a=n("b760"),i=n("72af"),o=n("4f50"),s=n("1a8c"),u=n("9934"),c=n("8adb");function l(t,e,n,d,h){t!==e&&i(e,(function(i,u){if(h||(h=new r),s(i))o(t,e,u,n,l,d,h);else{var p=d?d(c(t,u),i,u+"",t,e,h):void 0;void 0===p&&(p=i),a(t,u,p)}}),u)}t.exports=l},f947:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o}));var r=n("219b"),a=n("df00");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
const i="__op";function o(t){const e=Object.keys(t);if(1!==e.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+e.length+" keys.");let n=e[0];const o=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;const s=(...t)=>{r["a"].startScope(n);try{const e=o(...t);return Object(a["x"])(e)&&console.error("Cannot return a Promise inside of tidy."),r["a"].endScope(e),e}catch(e){throw r["a"].endScope(null),e}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}},f9cd:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("0b61"),s=n("ae86"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e,n){const u=Object(i["a"])(e,"a","where"),c=Object(i["a"])(n,"b","where"),l=Object(i["a"])(t,"condition","where","bool"),d=Object(s["assertAndGetBroadcastShape"])(Object(s["assertAndGetBroadcastShape"])(l.shape,u.shape),c.shape),h=Object(o["a"])(l,d),p=Object(o["a"])(u,d),f=Object(o["a"])(c,d),m={condition:h,t:p,e:f};return r["a"].runKernel(a["Gc"],m)}const l=Object(u["b"])({where_:c})},f9ce:function(t,e,n){var r=n("ef5d"),a=n("e3f8"),i=n("f608"),o=n("f4d6");function s(t){return i(t)?r(o(t)):a(t)}t.exports=s},fa21:function(t,e,n){var r=n("7530"),a=n("2dcb"),i=n("eac5");function o(t){return"function"!=typeof t.constructor||i(t)?{}:r(a(t))}t.exports=o},faa1:function(t,e,n){"use strict";var r,a="object"===typeof Reflect?Reflect:null,i=a&&"function"===typeof a.apply?a.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};function o(t){console&&console.warn&&console.warn(t)}r=a&&"function"===typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!==t};function u(){u.init.call(this)}t.exports=u,t.exports.once=x,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var c=10;function l(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function d(t){return void 0===t._maxListeners?u.defaultMaxListeners:t._maxListeners}function h(t,e,n,r){var a,i,s;if(l(n),i=t._events,void 0===i?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"===typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),a=d(t),a>0&&s.length>a&&!s.warned){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=s.length,o(u)}return t}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},a=p.bind(r);return a.listener=n,r.wrapFn=a,a}function m(t,e,n){var r=t._events;if(void 0===r)return[];var a=r[e];return void 0===a?[]:"function"===typeof a?n?[a.listener||a]:[a]:n?v(a):b(a,a.length)}function g(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function b(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function y(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function v(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function x(t,e){return new Promise((function(n,r){function a(n){t.removeListener(e,i),r(n)}function i(){"function"===typeof t.removeListener&&t.removeListener("error",a),n([].slice.call(arguments))}k(t,e,i,{once:!0}),"error"!==e&&w(t,a,{once:!0})}))}function w(t,e,n){"function"===typeof t.on&&k(t,"error",e,n)}function k(t,e,n,r){if("function"===typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function a(i){r.once&&t.removeEventListener(e,a),n(i)}))}}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");c=t}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},u.prototype.getMaxListeners=function(){return d(this)},u.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=a[t];if(void 0===u)return!1;if("function"===typeof u)i(u,this,e);else{var c=u.length,l=b(u,c);for(n=0;n<c;++n)i(l[n],this,e)}return!0},u.prototype.addListener=function(t,e){return h(this,t,e,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(t,e){return h(this,t,e,!0)},u.prototype.once=function(t,e){return l(e),this.on(t,f(this,t,e)),this},u.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,f(this,t,e)),this},u.prototype.removeListener=function(t,e){var n,r,a,i,o;if(l(e),r=this._events,void 0===r)return this;if(n=r[t],void 0===n)return this;if(n===e||n.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!==typeof n){for(a=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){o=n[i].listener,a=i;break}if(a<0)return this;0===a?n.shift():y(n,a),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,o||e)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(t){var e,n,r;if(n=this._events,void 0===n)return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var a,i=Object.keys(n);for(r=0;r<i.length;++r)a=i[r],"removeListener"!==a&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=n[t],"function"===typeof e)this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},u.prototype.listeners=function(t){return m(this,t,!0)},u.prototype.rawListeners=function(t){return m(this,t,!1)},u.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},u.prototype.listenerCount=g,u.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},fb3e:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("219b"),a=n("388c"),i=n("a6a7"),o=n("4ffe"),s=n("2fce"),u=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function c(t,e){let n=Object(o["a"])(t,"a","div"),u=Object(o["a"])(e,"b","div");if([n,u]=Object(i["makeTypesMatch"])(n,u),"int32"===n.dtype&&"int32"===u.dtype)return Object(s["a"])(n,u);const c={a:n,b:u},l={};return r["a"].runKernel(a["rc"],c,l)}const l=Object(u["b"])({div_:c})},fb49:function(t,e){},fba5:function(t,e,n){var r=n("cb5a");function a(t){return r(this.__data__,t)>-1}t.exports=a},fbe0:function(t,e,n){},fbe2:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e=.2){const n=Object(i["a"])(t,"x","leakyRelu"),o={x:n},s={alpha:e};return r["a"].runKernel(a["Ab"],o,s)}const u=Object(o["b"])({leakyRelu_:s})},fbf4:function(t,e,n){"use strict";function r(t){return null===t||void 0===t}function a(t){return null!==t&&void 0!==t}function i(t,e){return e.tag===t.tag&&e.key===t.key}function o(t){var e=t.tag;t.vm=new e({data:t.args})}function s(t){for(var e=Object.keys(t.args),n=0;n<e.length;n++)e.forEach((function(e){t.vm[e]=t.args[e]}))}function u(t,e,n){var r,i,o={};for(r=e;r<=n;++r)i=t[r].key,a(i)&&(o[i]=r);return o}function c(t,e){var n,s,c,p=0,f=0,m=t.length-1,g=t[0],b=t[m],y=e.length-1,v=e[0],x=e[y];while(p<=m&&f<=y)r(g)?g=t[++p]:r(b)?b=t[--m]:i(g,v)?(h(g,v),g=t[++p],v=e[++f]):i(b,x)?(h(b,x),b=t[--m],x=e[--y]):i(g,x)?(h(g,x),g=t[++p],x=e[--y]):i(b,v)?(h(b,v),b=t[--m],v=e[++f]):(r(n)&&(n=u(t,p,m)),s=a(v.key)?n[v.key]:null,r(s)?(o(v),v=e[++f]):(c=t[s],i(c,v)?(h(c,v),t[s]=void 0,v=e[++f]):(o(v),v=e[++f])));p>m?l(e,f,y):f>y&&d(t,p,m)}function l(t,e,n){for(;e<=n;++e)o(t[e])}function d(t,e,n){for(;e<=n;++e){var r=t[e];a(r)&&(r.vm.$destroy(),r.vm=null)}}function h(t,e){t!==e&&(e.vm=t.vm,s(e))}function p(t,e){a(t)&&a(e)?t!==e&&c(t,e):a(e)?l(e,0,e.length-1):a(t)&&d(t,0,t.length-1)}function f(t,e,n){return{tag:t,key:e,args:n}}Object.defineProperty(e,"__esModule",{value:!0}),e.h=f,e.patchChildren=p},fc7a:function(t,e,n){},fce6:function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;var a,i=n("9cb8"),o=n("f0b4"),s=n("4971"),u=n("4546"),c=n("d777"),l=n("7d2a"),d="hasShadow",h="shadowRGBA",p="patternImage",f="linearGradient",m="radialGradient";function g(){return a||(a=i.Util.createCanvasElement().getContext("2d"),a)}function b(t){t.fill()}function y(t){t.stroke()}function v(t){t.fill()}function x(t){t.stroke()}function w(){this._clearCache(d)}function k(){this._clearCache(h)}function S(){this._clearCache(p)}function O(){this._clearCache(f)}function _(){this._clearCache(m)}e.shapes={};var C=function(t){function n(n){var r,a=t.call(this,n)||this;while(1)if(r=i.Util.getRandomColor(),r&&!(r in e.shapes))break;return a.colorKey=r,e.shapes[r]=a,a}return r(n,t),n.prototype.getContext=function(){return this.getLayer().getContext()},n.prototype.getCanvas=function(){return this.getLayer().getCanvas()},n.prototype.getSceneFunc=function(){return this.attrs.sceneFunc||this["_sceneFunc"]},n.prototype.getHitFunc=function(){return this.attrs.hitFunc||this["_hitFunc"]},n.prototype.hasShadow=function(){return this._getCache(d,this._hasShadow)},n.prototype._hasShadow=function(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())},n.prototype._getFillPattern=function(){return this._getCache(p,this.__getFillPattern)},n.prototype.__getFillPattern=function(){if(this.fillPatternImage()){var t=g(),e=t.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");return e&&e.setTransform&&e.setTransform({a:this.fillPatternScaleX(),b:0,c:0,d:this.fillPatternScaleY(),e:0,f:0}),e}},n.prototype._getLinearGradient=function(){return this._getCache(f,this.__getLinearGradient)},n.prototype.__getLinearGradient=function(){var t=this.fillLinearGradientColorStops();if(t){for(var e=g(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),a=e.createLinearGradient(n.x,n.y,r.x,r.y),i=0;i<t.length;i+=2)a.addColorStop(t[i],t[i+1]);return a}},n.prototype._getRadialGradient=function(){return this._getCache(m,this.__getRadialGradient)},n.prototype.__getRadialGradient=function(){var t=this.fillRadialGradientColorStops();if(t){for(var e=g(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),a=e.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius()),i=0;i<t.length;i+=2)a.addColorStop(t[i],t[i+1]);return a}},n.prototype.getShadowRGBA=function(){return this._getCache(h,this._getShadowRGBA)},n.prototype._getShadowRGBA=function(){if(this.hasShadow()){var t=i.Util.colorToRGBA(this.shadowColor());return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}},n.prototype.hasFill=function(){var t=this;return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],(function(){return t.fillEnabled()&&!!(t.fill()||t.fillPatternImage()||t.fillLinearGradientColorStops()||t.fillRadialGradientColorStops())}))},n.prototype.hasStroke=function(){var t=this;return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],(function(){return t.strokeEnabled()&&t.strokeWidth()&&!(!t.stroke()&&!t.strokeLinearGradientColorStops())}))},n.prototype.hasHitStroke=function(){var t=this.hitStrokeWidth();return"auto"===t?this.hasStroke():this.strokeEnabled()&&!!t},n.prototype.intersects=function(t){var e,n=this.getStage(),r=n.bufferHitCanvas;return r.getContext().clear(),this.drawHit(r,null,!0),e=r.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data,e[3]>0},n.prototype.destroy=function(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this},n.prototype._useBufferCanvas=function(t){var e;if(!this.getStage())return!1;var n=null===(e=this.attrs.perfectDrawEnabled)||void 0===e||e;if(!n)return!1;var r=t||this.hasFill(),a=this.hasStroke(),i=1!==this.getAbsoluteOpacity();if(r&&a&&i)return!0;var o=this.hasShadow(),s=this.shadowForStrokeEnabled();return!!(r&&a&&o&&s)},n.prototype.setStrokeHitEnabled=function(t){i.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)},n.prototype.getStrokeHitEnabled=function(){return 0!==this.hitStrokeWidth()},n.prototype.getSelfRect=function(){var t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}},n.prototype.getClientRect=function(t){void 0===t&&(t={});var e=t.skipTransform,n=t.relativeTo,r=this.getSelfRect(),a=!t.skipStroke&&this.hasStroke(),i=a&&this.strokeWidth()||0,o=r.width+i,s=r.height+i,u=!t.skipShadow&&this.hasShadow(),c=u?this.shadowOffsetX():0,l=u?this.shadowOffsetY():0,d=o+Math.abs(c),h=s+Math.abs(l),p=u&&this.shadowBlur()||0,f=d+2*p,m=h+2*p,g=0;Math.round(i/2)!==i/2&&(g=1);var b={width:f+g,height:m+g,x:-Math.round(i/2+p)+Math.min(c,0)+r.x,y:-Math.round(i/2+p)+Math.min(l,0)+r.y};return e?b:this._transformedRect(b,n)},n.prototype.drawScene=function(t,e){var n,r,a,i=this.getLayer(),o=t||i.getCanvas(),s=o.getContext(),u=this._getCanvasCache(),c=this.getSceneFunc(),l=this.hasShadow(),d=o.isCache,h=o.isCache,p=e===this;if(!this.isVisible()&&!d)return this;if(u){s.save();var f=this.getAbsoluteTransform(e).getMatrix();return s.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this._drawCachedSceneCanvas(s),s.restore(),this}if(!c)return this;if(s.save(),this._useBufferCanvas()&&!h){n=this.getStage(),r=n.bufferCanvas,a=r.getContext(),a.clear(),a.save(),a._applyLineJoin(this);var m=this.getAbsoluteTransform(e).getMatrix();a.transform(m[0],m[1],m[2],m[3],m[4],m[5]),c.call(this,a,this),a.restore();var g=r.pixelRatio;l&&s._applyShadow(this),s._applyOpacity(this),s._applyGlobalCompositeOperation(this),s.drawImage(r._canvas,0,0,r.width/g,r.height/g)}else{if(s._applyLineJoin(this),!p){m=this.getAbsoluteTransform(e).getMatrix();s.transform(m[0],m[1],m[2],m[3],m[4],m[5]),s._applyOpacity(this),s._applyGlobalCompositeOperation(this)}l&&s._applyShadow(this),c.call(this,s,this)}return s.restore(),this},n.prototype.drawHit=function(t,e,n){if(void 0===n&&(n=!1),!this.shouldDrawHit(e,n))return this;var r=this.getLayer(),a=t||r.hitCanvas,o=a&&a.getContext(),s=this.hitFunc()||this.sceneFunc(),u=this._getCanvasCache(),c=u&&u.hit;if(this.colorKey||(console.log(this),i.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. See the shape in logs above. If you want to reuse shape you should call remove() instead of destroy()")),c){o.save();var l=this.getAbsoluteTransform(e).getMatrix();return o.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!s)return this;o.save(),o._applyLineJoin(this);var d=this===e;if(!d){var h=this.getAbsoluteTransform(e).getMatrix();o.transform(h[0],h[1],h[2],h[3],h[4],h[5])}return s.call(this,o,this),o.restore(),this},n.prototype.drawHitFromCache=function(t){void 0===t&&(t=0);var e,n,r,a,o,s,u=this._getCanvasCache(),c=this._getCachedSceneCanvas(),l=u.hit,d=l.getContext(),h=l.getWidth(),p=l.getHeight();d.clear(),d.drawImage(c._canvas,0,0,h,p);try{for(e=d.getImageData(0,0,h,p),n=e.data,r=n.length,a=i.Util._hexToRgb(this.colorKey),o=0;o<r;o+=4)s=n[o+3],s>t?(n[o]=a.r,n[o+1]=a.g,n[o+2]=a.b,n[o+3]=255):n[o+3]=0;d.putImageData(e,0,0)}catch(f){i.Util.error("Unable to draw hit graph from cached scene canvas. "+f.message)}return this},n.prototype.hasPointerCapture=function(t){return l.hasPointerCapture(t,this)},n.prototype.setPointerCapture=function(t){l.setPointerCapture(t,this)},n.prototype.releaseCapture=function(t){l.releaseCapture(t,this)},n}(s.Node);e.Shape=C,C.prototype._fillFunc=b,C.prototype._strokeFunc=y,C.prototype._fillFuncHit=v,C.prototype._strokeFuncHit=x,C.prototype._centroid=!1,C.prototype.nodeType="Shape",c._registerNode(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva",S),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",O),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",_),o.Factory.addGetterSetter(C,"stroke",void 0,u.getStringOrGradientValidator()),o.Factory.addGetterSetter(C,"strokeWidth",2,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),o.Factory.addGetterSetter(C,"hitStrokeWidth","auto",u.getNumberOrAutoValidator()),o.Factory.addGetterSetter(C,"strokeHitEnabled",!0,u.getBooleanValidator()),o.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,u.getBooleanValidator()),o.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,u.getBooleanValidator()),o.Factory.addGetterSetter(C,"lineJoin"),o.Factory.addGetterSetter(C,"lineCap"),o.Factory.addGetterSetter(C,"sceneFunc"),o.Factory.addGetterSetter(C,"hitFunc"),o.Factory.addGetterSetter(C,"dash"),o.Factory.addGetterSetter(C,"dashOffset",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"shadowColor",void 0,u.getStringValidator()),o.Factory.addGetterSetter(C,"shadowBlur",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"shadowOpacity",1,u.getNumberValidator()),o.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),o.Factory.addGetterSetter(C,"shadowOffsetX",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"shadowOffsetY",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillPatternImage"),o.Factory.addGetterSetter(C,"fill",void 0,u.getStringOrGradientValidator()),o.Factory.addGetterSetter(C,"fillPatternX",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillPatternY",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),o.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),o.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),o.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),o.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),o.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),o.Factory.addGetterSetter(C,"fillEnabled",!0),o.Factory.addGetterSetter(C,"strokeEnabled",!0),o.Factory.addGetterSetter(C,"shadowEnabled",!0),o.Factory.addGetterSetter(C,"dashEnabled",!0),o.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),o.Factory.addGetterSetter(C,"fillPriority","color"),o.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),o.Factory.addGetterSetter(C,"fillPatternOffsetX",0,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillPatternOffsetY",0,u.getNumberValidator()),o.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),o.Factory.addGetterSetter(C,"fillPatternScaleX",1,u.getNumberValidator()),o.Factory.addGetterSetter(C,"fillPatternScaleY",1,u.getNumberValidator()),o.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),o.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),o.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),o.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),o.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),o.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),o.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),o.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),o.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),o.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),o.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),o.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),o.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),o.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),o.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),o.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),o.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),o.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),o.Factory.addGetterSetter(C,"fillPatternRotation",0),o.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),i.Collection.mapMethods(C)},fd15:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=n("36da"),a=n("8603"),i=n("1bd8"),o=n("1f21"),s=n("383f"),u=n("229a"),c=n("da04"),l=n("f709"),d=n("8c18"),h=n("5d5a"),p=n("26c8"),f=n("bf11"),m=n("a34e"),g=n("e3af"),b=n("5414"),y=n("2a01"),v=n("d488"),x=n("96ee"),w=n("bdee"),k=n("6b7e"),S=n("c742"),O=n("e4b0"),_=n("bcb1"),C=n("cf29"),T=n("926b"),I=n("461e"),N=n("89c1"),E=n("1c49"),A=n("9470"),R=n("bbce"),j=n("405a"),D=n("2013"),F=n("8e84"),M=n("b33b"),P=n("769d"),$=n("7cc1"),L=n("122f");e.Konva=r.Konva.Util._assign(r.Konva,{Arc:a.Arc,Arrow:i.Arrow,Circle:o.Circle,Ellipse:s.Ellipse,Image:u.Image,Label:c.Label,Tag:c.Tag,Line:l.Line,Path:d.Path,Rect:h.Rect,RegularPolygon:p.RegularPolygon,Ring:f.Ring,Sprite:m.Sprite,Star:g.Star,Text:b.Text,TextPath:y.TextPath,Transformer:v.Transformer,Wedge:x.Wedge,Filters:{Blur:w.Blur,Brighten:k.Brighten,Contrast:S.Contrast,Emboss:O.Emboss,Enhance:_.Enhance,Grayscale:C.Grayscale,HSL:T.HSL,HSV:I.HSV,Invert:N.Invert,Kaleidoscope:E.Kaleidoscope,Mask:A.Mask,Noise:R.Noise,Pixelate:j.Pixelate,Posterize:D.Posterize,RGB:F.RGB,RGBA:M.RGBA,Sepia:P.Sepia,Solarize:$.Solarize,Threshold:L.Threshold}})},fd3e:function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return d})),n.d(e,"h",(function(){return h})),n.d(e,"m",(function(){return p})),n.d(e,"n",(function(){return f})),n.d(e,"t",(function(){return m})),n.d(e,"d",(function(){return g})),n.d(e,"l",(function(){return b})),n.d(e,"u",(function(){return y})),n.d(e,"r",(function(){return v})),n.d(e,"o",(function(){return x})),n.d(e,"k",(function(){return w})),n.d(e,"q",(function(){return k})),n.d(e,"i",(function(){return S})),n.d(e,"j",(function(){return O})),n.d(e,"p",(function(){return _})),n.d(e,"a",(function(){return C})),n.d(e,"s",(function(){return T}));var r=n("219b"),a=n("32fe"),i=n("4e56"),o=n("a6a7");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(){Object(a["c"])().set("PROD",!0)}function u(){Object(a["c"])().set("DEBUG",!0)}function c(){Object(a["c"])().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function l(t){Object(a["c"])().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d(){r["a"].disposeVariables()}function h(){return r["a"]}function p(){return r["a"].memory()}function f(t){return r["a"].profile(t)}function m(t,e){return r["a"].tidy(t,e)}function g(t){const e=Object(o["getTensorsInContainer"])(t);e.forEach(t=>t.dispose())}function b(t){return r["a"].keep(t)}function y(t){return r["a"].time(t)}function v(t){return r["a"].setBackend(t)}function x(){return r["a"].ready()}function w(){return r["a"].backendName}function k(t){r["a"].removeBackend(t)}function S(t){return r["a"].findBackend(t)}function O(t){return r["a"].findBackendFactory(t)}function _(t,e,n=1){return r["a"].registerBackend(t,e,n)}function C(){return r["a"].backend}function T(t,e){Object(a["c"])().setPlatform(t,e)}Object(i["d"])(l)},ff30:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var r=n("219b"),a=n("388c"),i=n("4ffe"),o=n("f947");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function s(t,e,n=1,o=0,s="int32"){if(e<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+e);const u=Object(i["a"])(t,"indices","oneHot","int32"),c={indices:u},l={dtype:s,depth:e,onValue:n,offValue:o};return r["a"].runKernel(a["fc"],c,l)}const u=Object(o["b"])({oneHot_:s})},ffd6:function(t,e,n){var r=n("3729"),a=n("1310"),i="[object Symbol]";function o(t){return"symbol"==typeof t||a(t)&&r(t)==i}t.exports=o}}]);
//# sourceMappingURL=chunk-vendors.f9e3569c.js.map